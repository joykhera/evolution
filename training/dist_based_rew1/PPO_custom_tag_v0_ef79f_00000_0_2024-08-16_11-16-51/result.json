{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9883283050760391, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.53598138087641, "policy_loss": -0.00713015932191863, "vf_loss": 6.541733837632275, "vf_explained_var": 0.00987570150188668, "kl": 0.006888500682418126, "entropy": 1.6026553712193927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9540544864204195, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.979167921076376, "policy_loss": -0.002417919283397693, "vf_loss": 4.980531215036987, "vf_explained_var": 0.0007085428666816187, "kl": 0.005273094708178496, "entropy": 1.6042462955706964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 137.08551712311748, "episode_reward_min": 4.420270007967547, "episode_reward_mean": 52.44321096072185, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -184.8990546179336, "predator_policy": 1.2265968552292326}, "policy_reward_max": {"prey_policy": 101.6029166670172, "predator_policy": 169.91058843244159}, "policy_reward_mean": {"prey_policy": -5.5758560798251215, "predator_policy": 31.797461560185948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.00999999999998, 24.07928538004352, 137.08551712311748, 61.91508709280088, 8.191936168250335, 27.690193440591838, 99.81101806137164, 48.51108822419906, 28.684573566296827, 61.70999999999988, 4.420270007967547, 13.829999999999973, 92.10237750796254, 72.61321826377284, 77.28000000000023, 4.7961391244821305, 6.316477031309282, 136.93061630082724], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0098551886181149, -81.12007965014196, 12.43470796749486, -11.295031321350885, 25.956713036213756, 72.28999999999984, 10.814816054823554, 7.1554726464017975, -32.44653744387355, -18.468643221155, 23.780000000000047, -39.7398340020328, 18.775020843636604, 47.92390307702781, -13.314270147668891, 37.4181523285277, -184.8990546179336, 2.0000000000000013, 25.869662297441376, 14.412642931679349, -28.74654349589813, -25.028998316698452, -35.97877352666648, -19.79126085210854, 4.690090783562599, 43.76357382290648, 52.48999999999971, -63.50740919697631, 50.45541724543055, -73.44937687773822, -0.4023363476883932, -50.898341331461516, -4.747609486021292, -59.77095427414133, 101.6029166670172, -9.96870965493041], "policy_predator_policy_reward": [29.870144811381977, 88.2500796501425, 12.178446971523082, 10.761161762376412, 33.60014700651862, 5.2386570803843835, 41.43369149454844, 2.5111068970271315, 12.458291733776024, 46.6488250995028, 27.7106958034027, 15.939331639221672, 31.885497285477186, 1.2265968552292326, 11.039294606044141, 13.367911437296154, 169.91058843244159, 41.67303975178865, 16.82735706832062, 4.600337702558798, 32.30064046259507, 25.895171357969456, 36.89877352666649, 32.701260852108604, 14.453045322617184, 29.195667578875394, 34.97738407692326, 48.65324338382487, 26.29458275456936, 73.97937687773828, 15.90148087324012, 40.19533593039194, 4.726315606636746, 66.10872518483515, 8.028072982985156, 37.26833630575524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6090450120554317, "mean_inference_ms": 1.51248475554838, "mean_action_processing_ms": 0.23916314627042373, "mean_env_wait_ms": 0.1956062714172071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01162952846950955, "StateBufferConnector_ms": 0.007828076680501303, "ViewRequirementAgentConnector_ms": 0.10438495212131077}, "num_episodes": 18, "episode_return_max": 137.08551712311748, "episode_return_min": 4.420270007967547, "episode_return_mean": 52.44321096072185, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.6277412234304, "num_env_steps_trained_throughput_per_sec": 374.6277412234304, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10677.275, "restore_workers_time_ms": 0.026, "training_step_time_ms": 10677.216, "sample_time_ms": 1224.7, "learn_time_ms": 9438.058, "learn_throughput": 423.816, "synch_weights_time_ms": 13.101}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "ef79f_00000", "date": "2024-08-16_11-17-10", "timestamp": 1723787230, "time_this_iter_s": 10.705785036087036, "time_total_s": 10.705785036087036, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b8b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.705785036087036, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.15625, "ram_util_percent": 78.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4350860274027264, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.504412066999566, "policy_loss": -0.009153203155214666, "vf_loss": 7.5115280608020765, "vf_explained_var": 0.06658152297691063, "kl": 0.010186082078029474, "entropy": 1.5801708554464673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.055895778962544, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.49740119548071, "policy_loss": -0.006783314655342746, "vf_loss": 4.501899021138589, "vf_explained_var": 0.06982707702924335, "kl": 0.011427465756754667, "entropy": 1.5939629995633686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 332.73077638192336, "episode_reward_min": 4.420270007967547, "episode_reward_mean": 96.67945516277672, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -184.8990546179336, "predator_policy": 1.2265968552292326}, "policy_reward_max": {"prey_policy": 185.15000000000003, "predator_policy": 169.91058843244159}, "policy_reward_mean": {"prey_policy": 16.045095415248053, "predator_policy": 32.29463216614027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.00999999999998, 24.07928538004352, 137.08551712311748, 61.91508709280088, 8.191936168250335, 27.690193440591838, 99.81101806137164, 48.51108822419906, 28.684573566296827, 61.70999999999988, 4.420270007967547, 13.829999999999973, 92.10237750796254, 72.61321826377284, 77.28000000000023, 4.7961391244821305, 6.316477031309282, 136.93061630082724, 80.86227469204567, 52.70815973462554, 192.0999999999999, 162.70329968965802, 184.65660171643287, 56.150836641179424, 129.16647852636896, 115.31933743437662, 117.91287237808257, 67.54437083432211, 86.0088574960995, 67.21570900252806, 110.31520935417004, 157.72449132011238, 332.73077638192336, 83.7268951861285, 234.55684736373217, 305.0795708151826], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0098551886181149, -81.12007965014196, 12.43470796749486, -11.295031321350885, 25.956713036213756, 72.28999999999984, 10.814816054823554, 7.1554726464017975, -32.44653744387355, -18.468643221155, 23.780000000000047, -39.7398340020328, 18.775020843636604, 47.92390307702781, -13.314270147668891, 37.4181523285277, -184.8990546179336, 2.0000000000000013, 25.869662297441376, 14.412642931679349, -28.74654349589813, -25.028998316698452, -35.97877352666648, -19.79126085210854, 4.690090783562599, 43.76357382290648, 52.48999999999971, -63.50740919697631, 50.45541724543055, -73.44937687773822, -0.4023363476883932, -50.898341331461516, -4.747609486021292, -59.77095427414133, 101.6029166670172, -9.96870965493041, -115.58708474747264, 0.5071335200260672, 8.698739473526464, -14.6455949837832, 59.37525368405119, 102.88077458159145, -2.307754190875248, 96.55339799913382, 70.68788575591257, 96.05, 7.946168532545948, -2.587268671795957, -33.88210495289333, 90.19481105169461, -52.13018851616117, 97.48471949524928, 43.58, 12.842625104022318, 1.6066397885135255, -6.100018217632002, 36.40074800376558, -29.6335684219279, -15.728087810000055, -15.431227473313307, 48.50369806769654, 2.0000000000000013, 124.55749776375474, -29.96553198482213, 185.15000000000003, 127.57188209170766, 32.22687408753933, -49.925606537891944, 101.23954439113217, 94.4360172811906, 137.62999999999977, 145.77731460707963], "policy_predator_policy_reward": [29.870144811381977, 88.2500796501425, 12.178446971523082, 10.761161762376412, 33.60014700651862, 5.2386570803843835, 41.43369149454844, 2.5111068970271315, 12.458291733776024, 46.6488250995028, 27.7106958034027, 15.939331639221672, 31.885497285477186, 1.2265968552292326, 11.039294606044141, 13.367911437296154, 169.91058843244159, 41.67303975178865, 16.82735706832062, 4.600337702558798, 32.30064046259507, 25.895171357969456, 36.89877352666649, 32.701260852108604, 14.453045322617184, 29.195667578875394, 34.97738407692326, 48.65324338382487, 26.29458275456936, 73.97937687773828, 15.90148087324012, 40.19533593039194, 4.726315606636746, 66.10872518483515, 8.028072982985156, 37.26833630575524, 116.10478259812996, 79.83744332136213, 14.010971959749307, 44.64404328513306, 12.39474631594867, 17.449225418408588, 52.4029322667272, 16.054723614673218, 13.204369484320711, 4.7143464762003795, 27.419787776012118, 23.372149004417473, 13.8529289806133, 59.000843446954036, 18.66343163325592, 51.3013748220317, 18.34000336984253, 43.150243904217696, 26.798993345841613, 45.238755917598894, 50.565195212537354, 28.67648270172438, 39.060961882736734, 59.314062403104714, 39.499148774360464, 20.31236251211279, 22.590916316612123, 40.54160922456795, 7.742151489622566, 12.26674280059348, 69.41148101666406, 32.01414661981709, 18.25734090873985, 20.62394478266943, 14.0100378824974, 7.662218325606096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5909714184036636, "mean_inference_ms": 1.4759570333588699, "mean_action_processing_ms": 0.2367382175295551, "mean_env_wait_ms": 0.19276090487520453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008336040708753798, "StateBufferConnector_ms": 0.005199511845906575, "ViewRequirementAgentConnector_ms": 0.08836885293324788}, "num_episodes": 18, "episode_return_max": 332.73077638192336, "episode_return_min": 4.420270007967547, "episode_return_mean": 96.67945516277672, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 417.89387734443306, "num_env_steps_trained_throughput_per_sec": 417.89387734443306, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 10124.545, "restore_workers_time_ms": 0.02, "training_step_time_ms": 10124.5, "sample_time_ms": 1168.395, "learn_time_ms": 8942.486, "learn_throughput": 447.303, "synch_weights_time_ms": 12.541}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "ef79f_00000", "date": "2024-08-16_11-17-22", "timestamp": 1723787242, "time_this_iter_s": 9.575561046600342, "time_total_s": 20.281346082687378, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321285280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.281346082687378, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.40588235294118, "ram_util_percent": 80.12352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.504909443350696, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.120520612424013, "policy_loss": -0.008227893059935282, "vf_loss": 9.126640631155993, "vf_explained_var": 0.05385786276015024, "kl": 0.01053949364543468, "entropy": 1.5610044837628723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.887755461817696, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.145540739619543, "policy_loss": -0.007899816283492973, "vf_loss": 4.1516365514230475, "vf_explained_var": 0.10707206423320467, "kl": 0.00901998921887455, "entropy": 1.589624422757083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 332.73077638192336, "episode_reward_min": 4.420270007967547, "episode_reward_mean": 131.15228902617477, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -184.8990546179336, "predator_policy": 1.2265968552292326}, "policy_reward_max": {"prey_policy": 185.15000000000003, "predator_policy": 169.91058843244159}, "policy_reward_mean": {"prey_policy": 34.96315459646934, "predator_policy": 30.61298991661804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.00999999999998, 24.07928538004352, 137.08551712311748, 61.91508709280088, 8.191936168250335, 27.690193440591838, 99.81101806137164, 48.51108822419906, 28.684573566296827, 61.70999999999988, 4.420270007967547, 13.829999999999973, 92.10237750796254, 72.61321826377284, 77.28000000000023, 4.7961391244821305, 6.316477031309282, 136.93061630082724, 80.86227469204567, 52.70815973462554, 192.0999999999999, 162.70329968965802, 184.65660171643287, 56.150836641179424, 129.16647852636896, 115.31933743437662, 117.91287237808257, 67.54437083432211, 86.0088574960995, 67.21570900252806, 110.31520935417004, 157.72449132011238, 332.73077638192336, 83.7268951861285, 234.55684736373217, 305.0795708151826, 236.31512137986778, 61.40653666257316, 79.57001234009425, 213.63416849935263, 256.77999999999986, 241.89999999999998, 137.17653879348856, 316.1720995736289, 185.54524005825056, 86.80361916874041, 223.8049442917074, 282.0628901029355, 47.42165204637335, 236.70999999999975, 275.53, 226.93161004295956, 271.7999999999997, 222.19878859350442], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0098551886181149, -81.12007965014196, 12.43470796749486, -11.295031321350885, 25.956713036213756, 72.28999999999984, 10.814816054823554, 7.1554726464017975, -32.44653744387355, -18.468643221155, 23.780000000000047, -39.7398340020328, 18.775020843636604, 47.92390307702781, -13.314270147668891, 37.4181523285277, -184.8990546179336, 2.0000000000000013, 25.869662297441376, 14.412642931679349, -28.74654349589813, -25.028998316698452, -35.97877352666648, -19.79126085210854, 4.690090783562599, 43.76357382290648, 52.48999999999971, -63.50740919697631, 50.45541724543055, -73.44937687773822, -0.4023363476883932, -50.898341331461516, -4.747609486021292, -59.77095427414133, 101.6029166670172, -9.96870965493041, -115.58708474747264, 0.5071335200260672, 8.698739473526464, -14.6455949837832, 59.37525368405119, 102.88077458159145, -2.307754190875248, 96.55339799913382, 70.68788575591257, 96.05, 7.946168532545948, -2.587268671795957, -33.88210495289333, 90.19481105169461, -52.13018851616117, 97.48471949524928, 43.58, 12.842625104022318, 1.6066397885135255, -6.100018217632002, 36.40074800376558, -29.6335684219279, -15.728087810000055, -15.431227473313307, 48.50369806769654, 2.0000000000000013, 124.55749776375474, -29.96553198482213, 185.15000000000003, 127.57188209170766, 32.22687408753933, -49.925606537891944, 101.23954439113217, 94.4360172811906, 137.62999999999977, 145.77731460707963, 117.82856483492652, -26.232157474480964, 20.699777188143948, -60.55395148268664, -30.383478943296073, 44.975888628636284, 135.3459397922538, 62.1964231578069, 86.3082264279212, 150.4926415641257, 89.03580617164559, 123.56365262081967, -41.250866025065385, 85.58744043784907, 156.70043348206826, 148.52000000000004, 6.021540345410265, 137.17456698955323, -26.78902834237308, -9.273820565038402, -16.617554421866245, 180.4582581676706, 163.37, 106.5894967931283, 16.6024996495397, -22.94923240116495, 93.80912584179359, 112.55810249417821, 130.95554720691655, 77.20955574763684, 166.8719812074213, 14.049759751827642, 146.4039508293939, 106.66768385432268, 39.80896512413158, 135.0180878676785], "policy_predator_policy_reward": [29.870144811381977, 88.2500796501425, 12.178446971523082, 10.761161762376412, 33.60014700651862, 5.2386570803843835, 41.43369149454844, 2.5111068970271315, 12.458291733776024, 46.6488250995028, 27.7106958034027, 15.939331639221672, 31.885497285477186, 1.2265968552292326, 11.039294606044141, 13.367911437296154, 169.91058843244159, 41.67303975178865, 16.82735706832062, 4.600337702558798, 32.30064046259507, 25.895171357969456, 36.89877352666649, 32.701260852108604, 14.453045322617184, 29.195667578875394, 34.97738407692326, 48.65324338382487, 26.29458275456936, 73.97937687773828, 15.90148087324012, 40.19533593039194, 4.726315606636746, 66.10872518483515, 8.028072982985156, 37.26833630575524, 116.10478259812996, 79.83744332136213, 14.010971959749307, 44.64404328513306, 12.39474631594867, 17.449225418408588, 52.4029322667272, 16.054723614673218, 13.204369484320711, 4.7143464762003795, 27.419787776012118, 23.372149004417473, 13.8529289806133, 59.000843446954036, 18.66343163325592, 51.3013748220317, 18.34000336984253, 43.150243904217696, 26.798993345841613, 45.238755917598894, 50.565195212537354, 28.67648270172438, 39.060961882736734, 59.314062403104714, 39.499148774360464, 20.31236251211279, 22.590916316612123, 40.54160922456795, 7.742151489622566, 12.26674280059348, 69.41148101666406, 32.01414661981709, 18.25734090873985, 20.62394478266943, 14.0100378824974, 7.662218325606096, 76.22859583549578, 68.49011818392623, 53.29222348427889, 47.968487472837104, 23.778844798442297, 41.19875785631178, 2.0355963628959444, 14.05620918639565, 16.151773572078756, 3.8273584358742956, 15.846347379180333, 13.454193828354393, 70.71530277085515, 22.124661609849685, 2.189562012559145, 8.76210407900153, 40.648459654589814, 1.7006730686977403, 75.8461996507159, 47.02026842543601, 36.73828006463931, 23.22596048126364, 10.55652750494387, 1.5468658048634147, 47.08544521077815, 6.68293958722039, 18.71488944663102, 11.627882217397385, 55.02044425236316, 12.344452793083505, 23.07547011842822, 22.934398965282547, 7.002316145677475, 11.72604917060612, 26.647195352816055, 20.724540248878455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5771502013651522, "mean_inference_ms": 1.446427326502302, "mean_action_processing_ms": 0.2333962653876662, "mean_env_wait_ms": 0.190046780370158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007405104460539641, "StateBufferConnector_ms": 0.004391979288171839, "ViewRequirementAgentConnector_ms": 0.08794334199693468}, "num_episodes": 18, "episode_return_max": 332.73077638192336, "episode_return_min": 4.420270007967547, "episode_return_mean": 131.15228902617477, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.4843466035321, "num_env_steps_trained_throughput_per_sec": 400.4843466035321, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 10079.003, "restore_workers_time_ms": 0.022, "training_step_time_ms": 10078.952, "sample_time_ms": 1123.14, "learn_time_ms": 8942.26, "learn_throughput": 447.314, "synch_weights_time_ms": 12.362}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "ef79f_00000", "date": "2024-08-16_11-17-32", "timestamp": 1723787252, "time_this_iter_s": 10.017483949661255, "time_total_s": 30.298830032348633, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b8310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.298830032348633, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 36.800000000000004, "ram_util_percent": 80.67857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1458700492583884, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.8139938218253, "policy_loss": -0.008022772774800027, "vf_loss": 8.819525480018092, "vf_explained_var": 0.02143189307873842, "kl": 0.012455666464155515, "entropy": 1.5594603819821877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9484128408961825, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.515502719273643, "policy_loss": -0.010304678453098017, "vf_loss": 6.523443180921848, "vf_explained_var": 0.09499775199663071, "kl": 0.011821083977663998, "entropy": 1.56060216250243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 332.73077638192336, "episode_reward_min": 4.420270007967547, "episode_reward_mean": 130.9507427868583, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -184.8990546179336, "predator_policy": 0.6715135358036912}, "policy_reward_max": {"prey_policy": 185.15000000000003, "predator_policy": 169.91058843244159}, "policy_reward_mean": {"prey_policy": 32.56135967419856, "predator_policy": 32.914011719230594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.00999999999998, 24.07928538004352, 137.08551712311748, 61.91508709280088, 8.191936168250335, 27.690193440591838, 99.81101806137164, 48.51108822419906, 28.684573566296827, 61.70999999999988, 4.420270007967547, 13.829999999999973, 92.10237750796254, 72.61321826377284, 77.28000000000023, 4.7961391244821305, 6.316477031309282, 136.93061630082724, 80.86227469204567, 52.70815973462554, 192.0999999999999, 162.70329968965802, 184.65660171643287, 56.150836641179424, 129.16647852636896, 115.31933743437662, 117.91287237808257, 67.54437083432211, 86.0088574960995, 67.21570900252806, 110.31520935417004, 157.72449132011238, 332.73077638192336, 83.7268951861285, 234.55684736373217, 305.0795708151826, 236.31512137986778, 61.40653666257316, 79.57001234009425, 213.63416849935263, 256.77999999999986, 241.89999999999998, 137.17653879348856, 316.1720995736289, 185.54524005825056, 86.80361916874041, 223.8049442917074, 282.0628901029355, 47.42165204637335, 236.70999999999975, 275.53, 226.93161004295956, 271.7999999999997, 222.19878859350442, 143.3322177505449, 111.44034560966386, 155.70605549028272, 26.695528549856128, 211.28000000000017, 87.49116106390264, 98.44240239956642, 123.64142576644846, 99.49490875920647, 151.83866820097418, 68.29949395436718, 109.8959828482198, 184.13845645269288, 45.98652791090617, 256.84571445451115, 124.60160796376398, 254.97675506094646, 92.12262100450815], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0098551886181149, -81.12007965014196, 12.43470796749486, -11.295031321350885, 25.956713036213756, 72.28999999999984, 10.814816054823554, 7.1554726464017975, -32.44653744387355, -18.468643221155, 23.780000000000047, -39.7398340020328, 18.775020843636604, 47.92390307702781, -13.314270147668891, 37.4181523285277, -184.8990546179336, 2.0000000000000013, 25.869662297441376, 14.412642931679349, -28.74654349589813, -25.028998316698452, -35.97877352666648, -19.79126085210854, 4.690090783562599, 43.76357382290648, 52.48999999999971, -63.50740919697631, 50.45541724543055, -73.44937687773822, -0.4023363476883932, -50.898341331461516, -4.747609486021292, -59.77095427414133, 101.6029166670172, -9.96870965493041, -115.58708474747264, 0.5071335200260672, 8.698739473526464, -14.6455949837832, 59.37525368405119, 102.88077458159145, -2.307754190875248, 96.55339799913382, 70.68788575591257, 96.05, 7.946168532545948, -2.587268671795957, -33.88210495289333, 90.19481105169461, -52.13018851616117, 97.48471949524928, 43.58, 12.842625104022318, 1.6066397885135255, -6.100018217632002, 36.40074800376558, -29.6335684219279, -15.728087810000055, -15.431227473313307, 48.50369806769654, 2.0000000000000013, 124.55749776375474, -29.96553198482213, 185.15000000000003, 127.57188209170766, 32.22687408753933, -49.925606537891944, 101.23954439113217, 94.4360172811906, 137.62999999999977, 145.77731460707963, 117.82856483492652, -26.232157474480964, 20.699777188143948, -60.55395148268664, -30.383478943296073, 44.975888628636284, 135.3459397922538, 62.1964231578069, 86.3082264279212, 150.4926415641257, 89.03580617164559, 123.56365262081967, -41.250866025065385, 85.58744043784907, 156.70043348206826, 148.52000000000004, 6.021540345410265, 137.17456698955323, -26.78902834237308, -9.273820565038402, -16.617554421866245, 180.4582581676706, 163.37, 106.5894967931283, 16.6024996495397, -22.94923240116495, 93.80912584179359, 112.55810249417821, 130.95554720691655, 77.20955574763684, 166.8719812074213, 14.049759751827642, 146.4039508293939, 106.66768385432268, 39.80896512413158, 135.0180878676785, 5.812350540722542, 78.74475737860104, -57.28206932588511, 56.180593078602115, 146.8077172023683, -85.45093015774808, -34.65153929242504, -66.39631827341817, 157.53058366347184, 37.21417329927138, -17.828108641332385, -23.32153273153716, 43.480986228750155, 15.419787177599515, 49.18297003926539, -28.239539143312037, -4.289104073611674, 27.279937317011456, -6.868043519858917, 72.35202278616224, 37.15733456967633, -67.56648308327136, -4.758218870088665, 12.586877567030525, 111.18708457593416, 41.71847114761071, -34.13730135775231, -24.335281872863092, 111.41448460947595, 119.45984450986062, 29.005901768731427, 8.180340989526124, 125.85241852684688, 81.3943264233775, -23.294520978626863, 23.27112458773984], "policy_predator_policy_reward": [29.870144811381977, 88.2500796501425, 12.178446971523082, 10.761161762376412, 33.60014700651862, 5.2386570803843835, 41.43369149454844, 2.5111068970271315, 12.458291733776024, 46.6488250995028, 27.7106958034027, 15.939331639221672, 31.885497285477186, 1.2265968552292326, 11.039294606044141, 13.367911437296154, 169.91058843244159, 41.67303975178865, 16.82735706832062, 4.600337702558798, 32.30064046259507, 25.895171357969456, 36.89877352666649, 32.701260852108604, 14.453045322617184, 29.195667578875394, 34.97738407692326, 48.65324338382487, 26.29458275456936, 73.97937687773828, 15.90148087324012, 40.19533593039194, 4.726315606636746, 66.10872518483515, 8.028072982985156, 37.26833630575524, 116.10478259812996, 79.83744332136213, 14.010971959749307, 44.64404328513306, 12.39474631594867, 17.449225418408588, 52.4029322667272, 16.054723614673218, 13.204369484320711, 4.7143464762003795, 27.419787776012118, 23.372149004417473, 13.8529289806133, 59.000843446954036, 18.66343163325592, 51.3013748220317, 18.34000336984253, 43.150243904217696, 26.798993345841613, 45.238755917598894, 50.565195212537354, 28.67648270172438, 39.060961882736734, 59.314062403104714, 39.499148774360464, 20.31236251211279, 22.590916316612123, 40.54160922456795, 7.742151489622566, 12.26674280059348, 69.41148101666406, 32.01414661981709, 18.25734090873985, 20.62394478266943, 14.0100378824974, 7.662218325606096, 76.22859583549578, 68.49011818392623, 53.29222348427889, 47.968487472837104, 23.778844798442297, 41.19875785631178, 2.0355963628959444, 14.05620918639565, 16.151773572078756, 3.8273584358742956, 15.846347379180333, 13.454193828354393, 70.71530277085515, 22.124661609849685, 2.189562012559145, 8.76210407900153, 40.648459654589814, 1.7006730686977403, 75.8461996507159, 47.02026842543601, 36.73828006463931, 23.22596048126364, 10.55652750494387, 1.5468658048634147, 47.08544521077815, 6.68293958722039, 18.71488944663102, 11.627882217397385, 55.02044425236316, 12.344452793083505, 23.07547011842822, 22.934398965282547, 7.002316145677475, 11.72604917060612, 26.647195352816055, 20.724540248878455, 19.572426797778338, 39.20268303344302, 68.0314769358853, 44.510344921061595, 93.20858588305346, 1.140682562608974, 41.55260010443385, 86.19078601126544, 9.925826700728601, 6.609416336528192, 45.35861970087741, 83.28218273589484, 33.57147168106213, 5.9701573121548925, 72.50111830688856, 30.196876563606576, 5.490938199449681, 71.01313731635699, 56.48968723592808, 29.86500169874263, 83.59097905592859, 15.117663412033416, 34.88101202094244, 67.18631213033554, 19.55394861027304, 11.67895211887514, 102.29807182277754, 2.1610393187439993, 0.6715135358036912, 25.29987179937111, 6.576396080706094, 80.8389691248002, 26.064379762822856, 21.665630347899707, 7.560050839342841, 84.58596655605236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5671059499853365, "mean_inference_ms": 1.4245676529328002, "mean_action_processing_ms": 0.2307865762652499, "mean_env_wait_ms": 0.18810856034132017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007183353106180827, "StateBufferConnector_ms": 0.004040201505025228, "ViewRequirementAgentConnector_ms": 0.08802877532111274}, "num_episodes": 18, "episode_return_max": 332.73077638192336, "episode_return_min": 4.420270007967547, "episode_return_mean": 130.9507427868583, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 421.3019496509343, "num_env_steps_trained_throughput_per_sec": 421.3019496509343, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 9932.85, "restore_workers_time_ms": 0.02, "training_step_time_ms": 9932.802, "sample_time_ms": 1093.66, "learn_time_ms": 8825.697, "learn_throughput": 453.222, "synch_weights_time_ms": 12.313}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "ef79f_00000", "date": "2024-08-16_11-17-42", "timestamp": 1723787262, "time_this_iter_s": 9.498281002044678, "time_total_s": 39.79711103439331, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b8550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.79711103439331, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.750000000000007, "ram_util_percent": 80.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3336439010012087, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.858643425078618, "policy_loss": -0.009617587936569064, "vf_loss": 8.86528699915245, "vf_explained_var": 0.03114367269334339, "kl": 0.014870126486786608, "entropy": 1.5534911069920454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0596313955291867, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.361935736893345, "policy_loss": -0.01044780426109259, "vf_loss": 8.369204516133303, "vf_explained_var": 0.08208403581033939, "kl": 0.01589511604415714, "entropy": 1.5354867382655069, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 332.73077638192336, "episode_reward_min": 4.420270007967547, "episode_reward_mean": 123.2304397186374, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -227.25906490761253, "predator_policy": 0.6715135358036912}, "policy_reward_max": {"prey_policy": 185.15000000000003, "predator_policy": 214.39603121739415}, "policy_reward_mean": {"prey_policy": 18.9054000333901, "predator_policy": 42.70981982592859}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.00999999999998, 24.07928538004352, 137.08551712311748, 61.91508709280088, 8.191936168250335, 27.690193440591838, 99.81101806137164, 48.51108822419906, 28.684573566296827, 61.70999999999988, 4.420270007967547, 13.829999999999973, 92.10237750796254, 72.61321826377284, 77.28000000000023, 4.7961391244821305, 6.316477031309282, 136.93061630082724, 80.86227469204567, 52.70815973462554, 192.0999999999999, 162.70329968965802, 184.65660171643287, 56.150836641179424, 129.16647852636896, 115.31933743437662, 117.91287237808257, 67.54437083432211, 86.0088574960995, 67.21570900252806, 110.31520935417004, 157.72449132011238, 332.73077638192336, 83.7268951861285, 234.55684736373217, 305.0795708151826, 236.31512137986778, 61.40653666257316, 79.57001234009425, 213.63416849935263, 256.77999999999986, 241.89999999999998, 137.17653879348856, 316.1720995736289, 185.54524005825056, 86.80361916874041, 223.8049442917074, 282.0628901029355, 47.42165204637335, 236.70999999999975, 275.53, 226.93161004295956, 271.7999999999997, 222.19878859350442, 143.3322177505449, 111.44034560966386, 155.70605549028272, 26.695528549856128, 211.28000000000017, 87.49116106390264, 98.44240239956642, 123.64142576644846, 99.49490875920647, 151.83866820097418, 68.29949395436718, 109.8959828482198, 184.13845645269288, 45.98652791090617, 256.84571445451115, 124.60160796376398, 254.97675506094646, 92.12262100450815, 149.81849147141165, 106.66790939345904, 130.25564678516125, 286.49753355405636, 82.99142267591952, 26.97212656774561, 229.55309583460092, 103.58000000000008, 125.42555362873053, 42.822439267364665, 67.95228854992133, 107.86808536923508, 139.10475560166307, 99.68423179310157, 36.73779416110816, 34.25044964217494, 51.516833019835516, 83.81951209340296, 138.56203464418738, 39.85001014109832, 67.84221228773951, 138.52068302514928, 119.00256705657775, 177.46148543457355, 44.937252101794506, 91.53519670590049, 48.13044068538986], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0098551886181149, -81.12007965014196, 12.43470796749486, -11.295031321350885, 25.956713036213756, 72.28999999999984, 10.814816054823554, 7.1554726464017975, -32.44653744387355, -18.468643221155, 23.780000000000047, -39.7398340020328, 18.775020843636604, 47.92390307702781, -13.314270147668891, 37.4181523285277, -184.8990546179336, 2.0000000000000013, 25.869662297441376, 14.412642931679349, -28.74654349589813, -25.028998316698452, -35.97877352666648, -19.79126085210854, 4.690090783562599, 43.76357382290648, 52.48999999999971, -63.50740919697631, 50.45541724543055, -73.44937687773822, -0.4023363476883932, -50.898341331461516, -4.747609486021292, -59.77095427414133, 101.6029166670172, -9.96870965493041, -115.58708474747264, 0.5071335200260672, 8.698739473526464, -14.6455949837832, 59.37525368405119, 102.88077458159145, -2.307754190875248, 96.55339799913382, 70.68788575591257, 96.05, 7.946168532545948, -2.587268671795957, -33.88210495289333, 90.19481105169461, -52.13018851616117, 97.48471949524928, 43.58, 12.842625104022318, 1.6066397885135255, -6.100018217632002, 36.40074800376558, -29.6335684219279, -15.728087810000055, -15.431227473313307, 48.50369806769654, 2.0000000000000013, 124.55749776375474, -29.96553198482213, 185.15000000000003, 127.57188209170766, 32.22687408753933, -49.925606537891944, 101.23954439113217, 94.4360172811906, 137.62999999999977, 145.77731460707963, 117.82856483492652, -26.232157474480964, 20.699777188143948, -60.55395148268664, -30.383478943296073, 44.975888628636284, 135.3459397922538, 62.1964231578069, 86.3082264279212, 150.4926415641257, 89.03580617164559, 123.56365262081967, -41.250866025065385, 85.58744043784907, 156.70043348206826, 148.52000000000004, 6.021540345410265, 137.17456698955323, -26.78902834237308, -9.273820565038402, -16.617554421866245, 180.4582581676706, 163.37, 106.5894967931283, 16.6024996495397, -22.94923240116495, 93.80912584179359, 112.55810249417821, 130.95554720691655, 77.20955574763684, 166.8719812074213, 14.049759751827642, 146.4039508293939, 106.66768385432268, 39.80896512413158, 135.0180878676785, 5.812350540722542, 78.74475737860104, -57.28206932588511, 56.180593078602115, 146.8077172023683, -85.45093015774808, -34.65153929242504, -66.39631827341817, 157.53058366347184, 37.21417329927138, -17.828108641332385, -23.32153273153716, 43.480986228750155, 15.419787177599515, 49.18297003926539, -28.239539143312037, -4.289104073611674, 27.279937317011456, -6.868043519858917, 72.35202278616224, 37.15733456967633, -67.56648308327136, -4.758218870088665, 12.586877567030525, 111.18708457593416, 41.71847114761071, -34.13730135775231, -24.335281872863092, 111.41448460947595, 119.45984450986062, 29.005901768731427, 8.180340989526124, 125.85241852684688, 81.3943264233775, -23.294520978626863, 23.27112458773984, 17.18030542146921, 59.75563472867356, -30.16793329440452, -4.750595419217714, 67.23235814646466, -80.15051487925915, 117.24698426893757, 143.38744242012385, -3.128548443238361, -49.70501733055096, -84.30444246128093, -72.63330471878972, 91.83395522018438, 95.08398548711679, 63.5158839358453, -79.54514599547798, 16.832670256752646, -16.165211676203935, -49.22005126874542, -76.65818412056888, 38.30303135522475, -81.5043739587024, -79.94933472697075, 16.709139966979997, 21.19441887594751, 6.272470318145428, -31.955275197494956, -87.11150915664263, -67.01181013698314, -63.210735143367096, -37.532982034849816, -74.80238929996268, -56.01284354981676, -61.85692920494178, -31.88946823641943, -117.44295202744615, 43.07428116046866, 30.58745054918653, 3.7644900018915877, -94.4642573085683, -85.96965033888658, 8.550143581125118, -58.59198591968335, 93.70363992465288, -43.15519244036627, 83.39927465034302, 61.21362758108635, 30.439277075010192, -21.474828360926388, -61.66049218404973, -10.670761733151867, -2.3017601688589506, -227.25906490761253, -112.58950575554368], "policy_predator_policy_reward": [29.870144811381977, 88.2500796501425, 12.178446971523082, 10.761161762376412, 33.60014700651862, 5.2386570803843835, 41.43369149454844, 2.5111068970271315, 12.458291733776024, 46.6488250995028, 27.7106958034027, 15.939331639221672, 31.885497285477186, 1.2265968552292326, 11.039294606044141, 13.367911437296154, 169.91058843244159, 41.67303975178865, 16.82735706832062, 4.600337702558798, 32.30064046259507, 25.895171357969456, 36.89877352666649, 32.701260852108604, 14.453045322617184, 29.195667578875394, 34.97738407692326, 48.65324338382487, 26.29458275456936, 73.97937687773828, 15.90148087324012, 40.19533593039194, 4.726315606636746, 66.10872518483515, 8.028072982985156, 37.26833630575524, 116.10478259812996, 79.83744332136213, 14.010971959749307, 44.64404328513306, 12.39474631594867, 17.449225418408588, 52.4029322667272, 16.054723614673218, 13.204369484320711, 4.7143464762003795, 27.419787776012118, 23.372149004417473, 13.8529289806133, 59.000843446954036, 18.66343163325592, 51.3013748220317, 18.34000336984253, 43.150243904217696, 26.798993345841613, 45.238755917598894, 50.565195212537354, 28.67648270172438, 39.060961882736734, 59.314062403104714, 39.499148774360464, 20.31236251211279, 22.590916316612123, 40.54160922456795, 7.742151489622566, 12.26674280059348, 69.41148101666406, 32.01414661981709, 18.25734090873985, 20.62394478266943, 14.0100378824974, 7.662218325606096, 76.22859583549578, 68.49011818392623, 53.29222348427889, 47.968487472837104, 23.778844798442297, 41.19875785631178, 2.0355963628959444, 14.05620918639565, 16.151773572078756, 3.8273584358742956, 15.846347379180333, 13.454193828354393, 70.71530277085515, 22.124661609849685, 2.189562012559145, 8.76210407900153, 40.648459654589814, 1.7006730686977403, 75.8461996507159, 47.02026842543601, 36.73828006463931, 23.22596048126364, 10.55652750494387, 1.5468658048634147, 47.08544521077815, 6.68293958722039, 18.71488944663102, 11.627882217397385, 55.02044425236316, 12.344452793083505, 23.07547011842822, 22.934398965282547, 7.002316145677475, 11.72604917060612, 26.647195352816055, 20.724540248878455, 19.572426797778338, 39.20268303344302, 68.0314769358853, 44.510344921061595, 93.20858588305346, 1.140682562608974, 41.55260010443385, 86.19078601126544, 9.925826700728601, 6.609416336528192, 45.35861970087741, 83.28218273589484, 33.57147168106213, 5.9701573121548925, 72.50111830688856, 30.196876563606576, 5.490938199449681, 71.01313731635699, 56.48968723592808, 29.86500169874263, 83.59097905592859, 15.117663412033416, 34.88101202094244, 67.18631213033554, 19.55394861027304, 11.67895211887514, 102.29807182277754, 2.1610393187439993, 0.6715135358036912, 25.29987179937111, 6.576396080706094, 80.8389691248002, 26.064379762822856, 21.665630347899707, 7.560050839342841, 84.58596655605236, 18.95545239618806, 53.92709892508076, 75.5194635989564, 66.06697450812483, 98.80604082808254, 44.36776268987304, 4.277086385619621, 21.586020479375318, 80.13762384292886, 55.68736460678012, 75.53715497812036, 108.37271876969591, 23.778677773160393, 18.856477354139315, 52.016684092742885, 67.59257796688979, 51.55753653730326, 73.20055851087854, 83.67183808940534, 85.02883656727367, 77.98814669436145, 33.16548445903751, 68.50284665403292, 102.60543347519287, 93.7757637850425, 17.862102622527605, 123.61301815312629, 95.13799799411278, 93.97513493158648, 72.9852045098719, 68.5385628618575, 78.04725811512995, 90.40511017907214, 78.98149559552205, 106.45416848053634, 126.69776387673213, 20.174483904680233, 44.72581902985199, 26.3441183660396, 104.20565908173549, 66.1214943764478, 79.14022466905317, 18.121797621451456, 85.28723139872837, 75.98955519885749, 2.768929647743463, 45.0835945683228, 40.724986210154256, 98.91491869350347, 29.15765395326713, 86.10621271796659, 18.401505889944662, 173.5829801311523, 214.39603121739415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5592439038260117, "mean_inference_ms": 1.4044672116544152, "mean_action_processing_ms": 0.22854050628801487, "mean_env_wait_ms": 0.1868127593715704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006469211193046185, "StateBufferConnector_ms": 0.003685734488747337, "ViewRequirementAgentConnector_ms": 0.08553748178963709}, "num_episodes": 27, "episode_return_max": 332.73077638192336, "episode_return_min": 4.420270007967547, "episode_return_mean": 123.2304397186374, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.2923872426553, "num_env_steps_trained_throughput_per_sec": 414.2923872426553, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 9877.285, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9877.239, "sample_time_ms": 1088.097, "learn_time_ms": 8775.651, "learn_throughput": 455.807, "synch_weights_time_ms": 12.424}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "ef79f_00000", "date": "2024-08-16_11-17-51", "timestamp": 1723787271, "time_this_iter_s": 9.658746242523193, "time_total_s": 49.455857276916504, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321456310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.455857276916504, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 31.930769230769233, "ram_util_percent": 80.9076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1843496458555656, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.379324934722254, "policy_loss": -0.01499040116378594, "vf_loss": 8.390514236783224, "vf_explained_var": 0.01967904772708025, "kl": 0.019005623943058606, "entropy": 1.5594805446882096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4029482191517237, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.137290705574884, "policy_loss": -0.008024794031821545, "vf_loss": 8.142629706418072, "vf_explained_var": -0.0307701430308125, "kl": 0.013428908905611341, "entropy": 1.5072968306995573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 332.73077638192336, "episode_reward_min": 1.5582128869735565, "episode_reward_mean": 129.98012636106753, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -227.25906490761253, "predator_policy": 0.6715135358036912}, "policy_reward_max": {"prey_policy": 185.15000000000003, "predator_policy": 214.39603121739415}, "policy_reward_mean": {"prey_policy": 17.050276392417036, "predator_policy": 47.93978678811674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.93061630082724, 80.86227469204567, 52.70815973462554, 192.0999999999999, 162.70329968965802, 184.65660171643287, 56.150836641179424, 129.16647852636896, 115.31933743437662, 117.91287237808257, 67.54437083432211, 86.0088574960995, 67.21570900252806, 110.31520935417004, 157.72449132011238, 332.73077638192336, 83.7268951861285, 234.55684736373217, 305.0795708151826, 236.31512137986778, 61.40653666257316, 79.57001234009425, 213.63416849935263, 256.77999999999986, 241.89999999999998, 137.17653879348856, 316.1720995736289, 185.54524005825056, 86.80361916874041, 223.8049442917074, 282.0628901029355, 47.42165204637335, 236.70999999999975, 275.53, 226.93161004295956, 271.7999999999997, 222.19878859350442, 143.3322177505449, 111.44034560966386, 155.70605549028272, 26.695528549856128, 211.28000000000017, 87.49116106390264, 98.44240239956642, 123.64142576644846, 99.49490875920647, 151.83866820097418, 68.29949395436718, 109.8959828482198, 184.13845645269288, 45.98652791090617, 256.84571445451115, 124.60160796376398, 254.97675506094646, 92.12262100450815, 149.81849147141165, 106.66790939345904, 130.25564678516125, 286.49753355405636, 82.99142267591952, 26.97212656774561, 229.55309583460092, 103.58000000000008, 125.42555362873053, 42.822439267364665, 67.95228854992133, 107.86808536923508, 139.10475560166307, 99.68423179310157, 36.73779416110816, 34.25044964217494, 51.516833019835516, 83.81951209340296, 138.56203464418738, 39.85001014109832, 67.84221228773951, 138.52068302514928, 119.00256705657775, 177.46148543457355, 44.937252101794506, 91.53519670590049, 48.13044068538986, 96.03942663904844, 127.53568771531371, 24.052746190808907, 239.5753865606415, 26.779295842286853, 71.49196938830325, 216.05672261573542, 64.3808888092209, 55.09846801340338, 64.97164026985355, 50.845203430720694, 103.66720705586056, 57.43599439961769, 61.9681953906283, 1.5582128869735565, 128.45169193799742, 137.92644863365362, 77.4110991737503], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.6029166670172, -9.96870965493041, -115.58708474747264, 0.5071335200260672, 8.698739473526464, -14.6455949837832, 59.37525368405119, 102.88077458159145, -2.307754190875248, 96.55339799913382, 70.68788575591257, 96.05, 7.946168532545948, -2.587268671795957, -33.88210495289333, 90.19481105169461, -52.13018851616117, 97.48471949524928, 43.58, 12.842625104022318, 1.6066397885135255, -6.100018217632002, 36.40074800376558, -29.6335684219279, -15.728087810000055, -15.431227473313307, 48.50369806769654, 2.0000000000000013, 124.55749776375474, -29.96553198482213, 185.15000000000003, 127.57188209170766, 32.22687408753933, -49.925606537891944, 101.23954439113217, 94.4360172811906, 137.62999999999977, 145.77731460707963, 117.82856483492652, -26.232157474480964, 20.699777188143948, -60.55395148268664, -30.383478943296073, 44.975888628636284, 135.3459397922538, 62.1964231578069, 86.3082264279212, 150.4926415641257, 89.03580617164559, 123.56365262081967, -41.250866025065385, 85.58744043784907, 156.70043348206826, 148.52000000000004, 6.021540345410265, 137.17456698955323, -26.78902834237308, -9.273820565038402, -16.617554421866245, 180.4582581676706, 163.37, 106.5894967931283, 16.6024996495397, -22.94923240116495, 93.80912584179359, 112.55810249417821, 130.95554720691655, 77.20955574763684, 166.8719812074213, 14.049759751827642, 146.4039508293939, 106.66768385432268, 39.80896512413158, 135.0180878676785, 5.812350540722542, 78.74475737860104, -57.28206932588511, 56.180593078602115, 146.8077172023683, -85.45093015774808, -34.65153929242504, -66.39631827341817, 157.53058366347184, 37.21417329927138, -17.828108641332385, -23.32153273153716, 43.480986228750155, 15.419787177599515, 49.18297003926539, -28.239539143312037, -4.289104073611674, 27.279937317011456, -6.868043519858917, 72.35202278616224, 37.15733456967633, -67.56648308327136, -4.758218870088665, 12.586877567030525, 111.18708457593416, 41.71847114761071, -34.13730135775231, -24.335281872863092, 111.41448460947595, 119.45984450986062, 29.005901768731427, 8.180340989526124, 125.85241852684688, 81.3943264233775, -23.294520978626863, 23.27112458773984, 17.18030542146921, 59.75563472867356, -30.16793329440452, -4.750595419217714, 67.23235814646466, -80.15051487925915, 117.24698426893757, 143.38744242012385, -3.128548443238361, -49.70501733055096, -84.30444246128093, -72.63330471878972, 91.83395522018438, 95.08398548711679, 63.5158839358453, -79.54514599547798, 16.832670256752646, -16.165211676203935, -49.22005126874542, -76.65818412056888, 38.30303135522475, -81.5043739587024, -79.94933472697075, 16.709139966979997, 21.19441887594751, 6.272470318145428, -31.955275197494956, -87.11150915664263, -67.01181013698314, -63.210735143367096, -37.532982034849816, -74.80238929996268, -56.01284354981676, -61.85692920494178, -31.88946823641943, -117.44295202744615, 43.07428116046866, 30.58745054918653, 3.7644900018915877, -94.4642573085683, -85.96965033888658, 8.550143581125118, -58.59198591968335, 93.70363992465288, -43.15519244036627, 83.39927465034302, 61.21362758108635, 30.439277075010192, -21.474828360926388, -61.66049218404973, -10.670761733151867, -2.3017601688589506, -227.25906490761253, -112.58950575554368, -32.706210115913876, -10.623885601588377, -48.38723946756305, 53.54972308373901, -117.09580914961764, -48.89312643734763, 132.52663709514064, 44.79703885234832, -69.87650873694157, -1.5712074366681306, -41.380916597965985, 11.749894016888591, -4.964951133347027, 132.60474756402118, -2.208674335674962, -162.03599612220034, -88.1833472401603, -18.570010416834464, -61.435931127357776, -8.554972213718377, -37.10121075053573, 0.9456645540431069, 35.7518053590024, -18.453195059276965, -54.373799800054975, -27.967643173842244, -21.76644959365833, -41.82420634111617, -6.046978847475827, -74.22428391243874, 62.58713029306447, -51.714444430158245, 16.959722392859888, -35.249753918429604, -47.01334822026823, 15.17278295542204], "policy_predator_policy_reward": [8.028072982985156, 37.26833630575524, 116.10478259812996, 79.83744332136213, 14.010971959749307, 44.64404328513306, 12.39474631594867, 17.449225418408588, 52.4029322667272, 16.054723614673218, 13.204369484320711, 4.7143464762003795, 27.419787776012118, 23.372149004417473, 13.8529289806133, 59.000843446954036, 18.66343163325592, 51.3013748220317, 18.34000336984253, 43.150243904217696, 26.798993345841613, 45.238755917598894, 50.565195212537354, 28.67648270172438, 39.060961882736734, 59.314062403104714, 39.499148774360464, 20.31236251211279, 22.590916316612123, 40.54160922456795, 7.742151489622566, 12.26674280059348, 69.41148101666406, 32.01414661981709, 18.25734090873985, 20.62394478266943, 14.0100378824974, 7.662218325606096, 76.22859583549578, 68.49011818392623, 53.29222348427889, 47.968487472837104, 23.778844798442297, 41.19875785631178, 2.0355963628959444, 14.05620918639565, 16.151773572078756, 3.8273584358742956, 15.846347379180333, 13.454193828354393, 70.71530277085515, 22.124661609849685, 2.189562012559145, 8.76210407900153, 40.648459654589814, 1.7006730686977403, 75.8461996507159, 47.02026842543601, 36.73828006463931, 23.22596048126364, 10.55652750494387, 1.5468658048634147, 47.08544521077815, 6.68293958722039, 18.71488944663102, 11.627882217397385, 55.02044425236316, 12.344452793083505, 23.07547011842822, 22.934398965282547, 7.002316145677475, 11.72604917060612, 26.647195352816055, 20.724540248878455, 19.572426797778338, 39.20268303344302, 68.0314769358853, 44.510344921061595, 93.20858588305346, 1.140682562608974, 41.55260010443385, 86.19078601126544, 9.925826700728601, 6.609416336528192, 45.35861970087741, 83.28218273589484, 33.57147168106213, 5.9701573121548925, 72.50111830688856, 30.196876563606576, 5.490938199449681, 71.01313731635699, 56.48968723592808, 29.86500169874263, 83.59097905592859, 15.117663412033416, 34.88101202094244, 67.18631213033554, 19.55394861027304, 11.67895211887514, 102.29807182277754, 2.1610393187439993, 0.6715135358036912, 25.29987179937111, 6.576396080706094, 80.8389691248002, 26.064379762822856, 21.665630347899707, 7.560050839342841, 84.58596655605236, 18.95545239618806, 53.92709892508076, 75.5194635989564, 66.06697450812483, 98.80604082808254, 44.36776268987304, 4.277086385619621, 21.586020479375318, 80.13762384292886, 55.68736460678012, 75.53715497812036, 108.37271876969591, 23.778677773160393, 18.856477354139315, 52.016684092742885, 67.59257796688979, 51.55753653730326, 73.20055851087854, 83.67183808940534, 85.02883656727367, 77.98814669436145, 33.16548445903751, 68.50284665403292, 102.60543347519287, 93.7757637850425, 17.862102622527605, 123.61301815312629, 95.13799799411278, 93.97513493158648, 72.9852045098719, 68.5385628618575, 78.04725811512995, 90.40511017907214, 78.98149559552205, 106.45416848053634, 126.69776387673213, 20.174483904680233, 44.72581902985199, 26.3441183660396, 104.20565908173549, 66.1214943764478, 79.14022466905317, 18.121797621451456, 85.28723139872837, 75.98955519885749, 2.768929647743463, 45.0835945683228, 40.724986210154256, 98.91491869350347, 29.15765395326713, 86.10621271796659, 18.401505889944662, 173.5829801311523, 214.39603121739415, 69.17241890012112, 70.19710345642939, 74.70691680073101, 47.66628729840688, 127.15396093474207, 62.88772084303176, 12.26841203147252, 49.983298581679975, 57.67144705347657, 40.55556496241989, 68.33780922253774, 32.78518274684296, 37.66287846987231, 50.75404771518897, 137.15856180214124, 91.46699746495479, 58.82295382151623, 103.02887184888189, 47.87178249202854, 87.09076111890121, 41.052000200058195, 45.94874942715505, 27.297970459879842, 59.07062629625521, 54.43486716261202, 85.34257021090295, 41.36786635021798, 84.19098497518489, 21.40917191719905, 60.42030372968933, 51.753197623194005, 65.82580845189662, 87.1649967122744, 69.05148344694892, 69.46396875811774, 39.787695680478755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5465671068804435, "mean_inference_ms": 1.3734597858335145, "mean_action_processing_ms": 0.2249685660543073, "mean_env_wait_ms": 0.18435608294077033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049707889556884766, "StateBufferConnector_ms": 0.0027769804000854492, "ViewRequirementAgentConnector_ms": 0.08138620853424072}, "num_episodes": 18, "episode_return_max": 332.73077638192336, "episode_return_min": 1.5582128869735565, "episode_return_mean": 129.98012636106753, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.9244538138512, "num_env_steps_trained_throughput_per_sec": 422.9244538138512, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9807.397, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9807.354, "sample_time_ms": 1084.727, "learn_time_ms": 8709.512, "learn_throughput": 459.268, "synch_weights_time_ms": 12.118}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "ef79f_00000", "date": "2024-08-16_11-18-01", "timestamp": 1723787281, "time_this_iter_s": 9.461236953735352, "time_total_s": 58.917094230651855, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321456a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.917094230651855, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.12857142857143, "ram_util_percent": 80.97142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8533433328545283, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.007358979169654, "policy_loss": -0.011219320891218052, "vf_loss": 8.016093897188782, "vf_explained_var": 0.018475220380006013, "kl": 0.012421995921975139, "entropy": 1.5517346484320504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.56496939025228, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.014385179993967, "policy_loss": -0.007395079280077307, "vf_loss": 8.018860638330853, "vf_explained_var": -0.0387281613375144, "kl": 0.014598181103667413, "entropy": 1.4950371776308333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 316.1720995736289, "episode_reward_min": -21.457975914943468, "episode_reward_mean": 120.01659975190742, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -227.25906490761253, "predator_policy": 0.6715135358036912}, "policy_reward_max": {"prey_policy": 180.4582581676706, "predator_policy": 214.39603121739415}, "policy_reward_mean": {"prey_policy": 6.430061067590516, "predator_policy": 53.57823880836318}, "custom_metrics": {}, "hist_stats": {"episode_reward": [305.0795708151826, 236.31512137986778, 61.40653666257316, 79.57001234009425, 213.63416849935263, 256.77999999999986, 241.89999999999998, 137.17653879348856, 316.1720995736289, 185.54524005825056, 86.80361916874041, 223.8049442917074, 282.0628901029355, 47.42165204637335, 236.70999999999975, 275.53, 226.93161004295956, 271.7999999999997, 222.19878859350442, 143.3322177505449, 111.44034560966386, 155.70605549028272, 26.695528549856128, 211.28000000000017, 87.49116106390264, 98.44240239956642, 123.64142576644846, 99.49490875920647, 151.83866820097418, 68.29949395436718, 109.8959828482198, 184.13845645269288, 45.98652791090617, 256.84571445451115, 124.60160796376398, 254.97675506094646, 92.12262100450815, 149.81849147141165, 106.66790939345904, 130.25564678516125, 286.49753355405636, 82.99142267591952, 26.97212656774561, 229.55309583460092, 103.58000000000008, 125.42555362873053, 42.822439267364665, 67.95228854992133, 107.86808536923508, 139.10475560166307, 99.68423179310157, 36.73779416110816, 34.25044964217494, 51.516833019835516, 83.81951209340296, 138.56203464418738, 39.85001014109832, 67.84221228773951, 138.52068302514928, 119.00256705657775, 177.46148543457355, 44.937252101794506, 91.53519670590049, 48.13044068538986, 96.03942663904844, 127.53568771531371, 24.052746190808907, 239.5753865606415, 26.779295842286853, 71.49196938830325, 216.05672261573542, 64.3808888092209, 55.09846801340338, 64.97164026985355, 50.845203430720694, 103.66720705586056, 57.43599439961769, 61.9681953906283, 1.5582128869735565, 128.45169193799742, 137.92644863365362, 77.4110991737503, 57.5695199337415, -21.457975914943468, 57.19385756648177, 152.8988784443786, 163.12591982532564, 95.37406264119387, 36.38187197485676, 30.417193691192107, 75.99681006363993, 138.93129866444093, 145.21076902405548, 5.113729308795665, 12.449855942850355, 137.60197110607882, 75.40237720874607, 47.769878224389274, 58.94058874126042, 103.06036669011525], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [137.62999999999977, 145.77731460707963, 117.82856483492652, -26.232157474480964, 20.699777188143948, -60.55395148268664, -30.383478943296073, 44.975888628636284, 135.3459397922538, 62.1964231578069, 86.3082264279212, 150.4926415641257, 89.03580617164559, 123.56365262081967, -41.250866025065385, 85.58744043784907, 156.70043348206826, 148.52000000000004, 6.021540345410265, 137.17456698955323, -26.78902834237308, -9.273820565038402, -16.617554421866245, 180.4582581676706, 163.37, 106.5894967931283, 16.6024996495397, -22.94923240116495, 93.80912584179359, 112.55810249417821, 130.95554720691655, 77.20955574763684, 166.8719812074213, 14.049759751827642, 146.4039508293939, 106.66768385432268, 39.80896512413158, 135.0180878676785, 5.812350540722542, 78.74475737860104, -57.28206932588511, 56.180593078602115, 146.8077172023683, -85.45093015774808, -34.65153929242504, -66.39631827341817, 157.53058366347184, 37.21417329927138, -17.828108641332385, -23.32153273153716, 43.480986228750155, 15.419787177599515, 49.18297003926539, -28.239539143312037, -4.289104073611674, 27.279937317011456, -6.868043519858917, 72.35202278616224, 37.15733456967633, -67.56648308327136, -4.758218870088665, 12.586877567030525, 111.18708457593416, 41.71847114761071, -34.13730135775231, -24.335281872863092, 111.41448460947595, 119.45984450986062, 29.005901768731427, 8.180340989526124, 125.85241852684688, 81.3943264233775, -23.294520978626863, 23.27112458773984, 17.18030542146921, 59.75563472867356, -30.16793329440452, -4.750595419217714, 67.23235814646466, -80.15051487925915, 117.24698426893757, 143.38744242012385, -3.128548443238361, -49.70501733055096, -84.30444246128093, -72.63330471878972, 91.83395522018438, 95.08398548711679, 63.5158839358453, -79.54514599547798, 16.832670256752646, -16.165211676203935, -49.22005126874542, -76.65818412056888, 38.30303135522475, -81.5043739587024, -79.94933472697075, 16.709139966979997, 21.19441887594751, 6.272470318145428, -31.955275197494956, -87.11150915664263, -67.01181013698314, -63.210735143367096, -37.532982034849816, -74.80238929996268, -56.01284354981676, -61.85692920494178, -31.88946823641943, -117.44295202744615, 43.07428116046866, 30.58745054918653, 3.7644900018915877, -94.4642573085683, -85.96965033888658, 8.550143581125118, -58.59198591968335, 93.70363992465288, -43.15519244036627, 83.39927465034302, 61.21362758108635, 30.439277075010192, -21.474828360926388, -61.66049218404973, -10.670761733151867, -2.3017601688589506, -227.25906490761253, -112.58950575554368, -32.706210115913876, -10.623885601588377, -48.38723946756305, 53.54972308373901, -117.09580914961764, -48.89312643734763, 132.52663709514064, 44.79703885234832, -69.87650873694157, -1.5712074366681306, -41.380916597965985, 11.749894016888591, -4.964951133347027, 132.60474756402118, -2.208674335674962, -162.03599612220034, -88.1833472401603, -18.570010416834464, -61.435931127357776, -8.554972213718377, -37.10121075053573, 0.9456645540431069, 35.7518053590024, -18.453195059276965, -54.373799800054975, -27.967643173842244, -21.76644959365833, -41.82420634111617, -6.046978847475827, -74.22428391243874, 62.58713029306447, -51.714444430158245, 16.959722392859888, -35.249753918429604, -47.01334822026823, 15.17278295542204, -60.814407116823865, -67.46468764706353, -67.1891731946978, -99.48441337476453, -0.3713262146977556, 13.27835386028651, -56.08829613067284, 47.0083345301405, 30.197502542039686, -11.962073780532904, 28.172239926087343, -43.76595452457237, -4.869574557675751, -52.014487822538705, -70.02633984395622, -63.02208582161492, -20.58470432315573, 0.9338424752790286, 53.81353061209249, -31.65824880855077, 0.6074749916950449, 32.55729350592458, -99.62936149103743, -74.53202443840267, -75.95820374580752, -64.29955864368361, 96.73402167553316, -21.349881686352727, -120.0191764811307, -14.06383682484553, -47.88735549738849, 5.294181704222666, -54.98705861109778, 22.17219853006532, -103.89555124600412, 35.33032368497057], "policy_predator_policy_reward": [14.0100378824974, 7.662218325606096, 76.22859583549578, 68.49011818392623, 53.29222348427889, 47.968487472837104, 23.778844798442297, 41.19875785631178, 2.0355963628959444, 14.05620918639565, 16.151773572078756, 3.8273584358742956, 15.846347379180333, 13.454193828354393, 70.71530277085515, 22.124661609849685, 2.189562012559145, 8.76210407900153, 40.648459654589814, 1.7006730686977403, 75.8461996507159, 47.02026842543601, 36.73828006463931, 23.22596048126364, 10.55652750494387, 1.5468658048634147, 47.08544521077815, 6.68293958722039, 18.71488944663102, 11.627882217397385, 55.02044425236316, 12.344452793083505, 23.07547011842822, 22.934398965282547, 7.002316145677475, 11.72604917060612, 26.647195352816055, 20.724540248878455, 19.572426797778338, 39.20268303344302, 68.0314769358853, 44.510344921061595, 93.20858588305346, 1.140682562608974, 41.55260010443385, 86.19078601126544, 9.925826700728601, 6.609416336528192, 45.35861970087741, 83.28218273589484, 33.57147168106213, 5.9701573121548925, 72.50111830688856, 30.196876563606576, 5.490938199449681, 71.01313731635699, 56.48968723592808, 29.86500169874263, 83.59097905592859, 15.117663412033416, 34.88101202094244, 67.18631213033554, 19.55394861027304, 11.67895211887514, 102.29807182277754, 2.1610393187439993, 0.6715135358036912, 25.29987179937111, 6.576396080706094, 80.8389691248002, 26.064379762822856, 21.665630347899707, 7.560050839342841, 84.58596655605236, 18.95545239618806, 53.92709892508076, 75.5194635989564, 66.06697450812483, 98.80604082808254, 44.36776268987304, 4.277086385619621, 21.586020479375318, 80.13762384292886, 55.68736460678012, 75.53715497812036, 108.37271876969591, 23.778677773160393, 18.856477354139315, 52.016684092742885, 67.59257796688979, 51.55753653730326, 73.20055851087854, 83.67183808940534, 85.02883656727367, 77.98814669436145, 33.16548445903751, 68.50284665403292, 102.60543347519287, 93.7757637850425, 17.862102622527605, 123.61301815312629, 95.13799799411278, 93.97513493158648, 72.9852045098719, 68.5385628618575, 78.04725811512995, 90.40511017907214, 78.98149559552205, 106.45416848053634, 126.69776387673213, 20.174483904680233, 44.72581902985199, 26.3441183660396, 104.20565908173549, 66.1214943764478, 79.14022466905317, 18.121797621451456, 85.28723139872837, 75.98955519885749, 2.768929647743463, 45.0835945683228, 40.724986210154256, 98.91491869350347, 29.15765395326713, 86.10621271796659, 18.401505889944662, 173.5829801311523, 214.39603121739415, 69.17241890012112, 70.19710345642939, 74.70691680073101, 47.66628729840688, 127.15396093474207, 62.88772084303176, 12.26841203147252, 49.983298581679975, 57.67144705347657, 40.55556496241989, 68.33780922253774, 32.78518274684296, 37.66287846987231, 50.75404771518897, 137.15856180214124, 91.46699746495479, 58.82295382151623, 103.02887184888189, 47.87178249202854, 87.09076111890121, 41.052000200058195, 45.94874942715505, 27.297970459879842, 59.07062629625521, 54.43486716261202, 85.34257021090295, 41.36786635021798, 84.19098497518489, 21.40917191719905, 60.42030372968933, 51.753197623194005, 65.82580845189662, 87.1649967122744, 69.05148344694892, 69.46396875811774, 39.787695680478755, 87.89794243058057, 97.95067226704809, 111.96521374868313, 33.250396905835764, 8.409489827366087, 35.87734009352694, 74.35853634529755, 87.62030369961317, 51.0564574543696, 93.83403360944918, 53.01014786531194, 57.957629374366874, 67.15856979627394, 26.1073645587971, 98.53001639201858, 64.93560296474475, 49.13765497912229, 46.5100169323938, 71.37912179134413, 45.39689506955506, 76.27269431591714, 35.77330621051868, 99.7244860626655, 79.55062917557034, 74.12267311655414, 78.58494521578737, 28.718778248899987, 33.49905286799914, 100.22513481276046, 109.26025570196185, 76.03726939134869, 14.32578262620632, 46.37656453532247, 45.37888428697059, 106.1370375205246, 65.48855673062418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.538086423376335, "mean_inference_ms": 1.3530079580122496, "mean_action_processing_ms": 0.2222940993160263, "mean_env_wait_ms": 0.18271084052858402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004630684852600098, "StateBufferConnector_ms": 0.0037349462509155273, "ViewRequirementAgentConnector_ms": 0.08247613906860352}, "num_episodes": 18, "episode_return_max": 316.1720995736289, "episode_return_min": -21.457975914943468, "episode_return_mean": 120.01659975190742, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.5438287781503, "num_env_steps_trained_throughput_per_sec": 426.5438287781503, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 9746.013, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9745.971, "sample_time_ms": 1073.222, "learn_time_ms": 8659.629, "learn_throughput": 461.914, "synch_weights_time_ms": 12.182}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "ef79f_00000", "date": "2024-08-16_11-18-10", "timestamp": 1723787290, "time_this_iter_s": 9.381411790847778, "time_total_s": 68.29850602149963, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32144f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.29850602149963, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 27.507692307692306, "ram_util_percent": 81.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.732665664556796, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.471024300560119, "policy_loss": -0.014124077889038418, "vf_loss": 6.482303727366937, "vf_explained_var": 0.035685656783442016, "kl": 0.014223189689356599, "entropy": 1.5475149146463505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.717657640119078, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.443384418790303, "policy_loss": -0.009904972432186167, "vf_loss": 7.450361484699148, "vf_explained_var": 0.005619439372309932, "kl": 0.014639542297305599, "entropy": 1.4439072605163332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 286.49753355405636, "episode_reward_min": -21.457975914943468, "episode_reward_mean": 98.63582948438528, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -227.25906490761253, "predator_policy": 0.6715135358036912}, "policy_reward_max": {"prey_policy": 157.53058366347184, "predator_policy": 214.39603121739415}, "policy_reward_mean": {"prey_policy": -11.288219000712589, "predator_policy": 60.606133742905214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.19878859350442, 143.3322177505449, 111.44034560966386, 155.70605549028272, 26.695528549856128, 211.28000000000017, 87.49116106390264, 98.44240239956642, 123.64142576644846, 99.49490875920647, 151.83866820097418, 68.29949395436718, 109.8959828482198, 184.13845645269288, 45.98652791090617, 256.84571445451115, 124.60160796376398, 254.97675506094646, 92.12262100450815, 149.81849147141165, 106.66790939345904, 130.25564678516125, 286.49753355405636, 82.99142267591952, 26.97212656774561, 229.55309583460092, 103.58000000000008, 125.42555362873053, 42.822439267364665, 67.95228854992133, 107.86808536923508, 139.10475560166307, 99.68423179310157, 36.73779416110816, 34.25044964217494, 51.516833019835516, 83.81951209340296, 138.56203464418738, 39.85001014109832, 67.84221228773951, 138.52068302514928, 119.00256705657775, 177.46148543457355, 44.937252101794506, 91.53519670590049, 48.13044068538986, 96.03942663904844, 127.53568771531371, 24.052746190808907, 239.5753865606415, 26.779295842286853, 71.49196938830325, 216.05672261573542, 64.3808888092209, 55.09846801340338, 64.97164026985355, 50.845203430720694, 103.66720705586056, 57.43599439961769, 61.9681953906283, 1.5582128869735565, 128.45169193799742, 137.92644863365362, 77.4110991737503, 57.5695199337415, -21.457975914943468, 57.19385756648177, 152.8988784443786, 163.12591982532564, 95.37406264119387, 36.38187197485676, 30.417193691192107, 75.99681006363993, 138.93129866444093, 145.21076902405548, 5.113729308795665, 12.449855942850355, 137.60197110607882, 75.40237720874607, 47.769878224389274, 58.94058874126042, 103.06036669011525, 22.188694431957728, 43.243919999621575, 32.531145184533734, 140.15566298739535, 158.40727205897784, 37.06637400119699, 47.133205036622016, 131.57306395113906, 25.62911159854722, 107.3168386143342, 168.7663244812935, 70.50915914822274, 91.36048300907022, 160.04072513602225, 31.756961909767817, 67.27036339322696, 108.57870173599943, 103.0389703450133], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [39.80896512413158, 135.0180878676785, 5.812350540722542, 78.74475737860104, -57.28206932588511, 56.180593078602115, 146.8077172023683, -85.45093015774808, -34.65153929242504, -66.39631827341817, 157.53058366347184, 37.21417329927138, -17.828108641332385, -23.32153273153716, 43.480986228750155, 15.419787177599515, 49.18297003926539, -28.239539143312037, -4.289104073611674, 27.279937317011456, -6.868043519858917, 72.35202278616224, 37.15733456967633, -67.56648308327136, -4.758218870088665, 12.586877567030525, 111.18708457593416, 41.71847114761071, -34.13730135775231, -24.335281872863092, 111.41448460947595, 119.45984450986062, 29.005901768731427, 8.180340989526124, 125.85241852684688, 81.3943264233775, -23.294520978626863, 23.27112458773984, 17.18030542146921, 59.75563472867356, -30.16793329440452, -4.750595419217714, 67.23235814646466, -80.15051487925915, 117.24698426893757, 143.38744242012385, -3.128548443238361, -49.70501733055096, -84.30444246128093, -72.63330471878972, 91.83395522018438, 95.08398548711679, 63.5158839358453, -79.54514599547798, 16.832670256752646, -16.165211676203935, -49.22005126874542, -76.65818412056888, 38.30303135522475, -81.5043739587024, -79.94933472697075, 16.709139966979997, 21.19441887594751, 6.272470318145428, -31.955275197494956, -87.11150915664263, -67.01181013698314, -63.210735143367096, -37.532982034849816, -74.80238929996268, -56.01284354981676, -61.85692920494178, -31.88946823641943, -117.44295202744615, 43.07428116046866, 30.58745054918653, 3.7644900018915877, -94.4642573085683, -85.96965033888658, 8.550143581125118, -58.59198591968335, 93.70363992465288, -43.15519244036627, 83.39927465034302, 61.21362758108635, 30.439277075010192, -21.474828360926388, -61.66049218404973, -10.670761733151867, -2.3017601688589506, -227.25906490761253, -112.58950575554368, -32.706210115913876, -10.623885601588377, -48.38723946756305, 53.54972308373901, -117.09580914961764, -48.89312643734763, 132.52663709514064, 44.79703885234832, -69.87650873694157, -1.5712074366681306, -41.380916597965985, 11.749894016888591, -4.964951133347027, 132.60474756402118, -2.208674335674962, -162.03599612220034, -88.1833472401603, -18.570010416834464, -61.435931127357776, -8.554972213718377, -37.10121075053573, 0.9456645540431069, 35.7518053590024, -18.453195059276965, -54.373799800054975, -27.967643173842244, -21.76644959365833, -41.82420634111617, -6.046978847475827, -74.22428391243874, 62.58713029306447, -51.714444430158245, 16.959722392859888, -35.249753918429604, -47.01334822026823, 15.17278295542204, -60.814407116823865, -67.46468764706353, -67.1891731946978, -99.48441337476453, -0.3713262146977556, 13.27835386028651, -56.08829613067284, 47.0083345301405, 30.197502542039686, -11.962073780532904, 28.172239926087343, -43.76595452457237, -4.869574557675751, -52.014487822538705, -70.02633984395622, -63.02208582161492, -20.58470432315573, 0.9338424752790286, 53.81353061209249, -31.65824880855077, 0.6074749916950449, 32.55729350592458, -99.62936149103743, -74.53202443840267, -75.95820374580752, -64.29955864368361, 96.73402167553316, -21.349881686352727, -120.0191764811307, -14.06383682484553, -47.88735549738849, 5.294181704222666, -54.98705861109778, 22.17219853006532, -103.89555124600412, 35.33032368497057, -33.72193904419018, -102.90332999405894, -97.9803243166522, -30.11917067457096, 1.1578962703437603, -64.34589072973287, 29.704571144877907, -26.569872952481106, -126.38279993572806, 94.07175650265627, -98.69325762832915, -38.51793881387132, -29.51783601071808, -55.551449559830246, 7.5339601988409415, 74.84339328127247, -45.42754741579753, 2.0000000000000013, 64.90490775853164, -133.40813387379467, 60.40427287582172, -20.99082663469373, -111.43834704137247, -15.173334810769479, 42.87142831253266, 23.813107518247893, -11.208780341546799, 40.557627027411165, -63.87826719221756, -48.619593151419444, -51.66810158285384, -35.52748078882698, 72.2466030005941, -98.48789368457265, 27.181947859245632, -15.461281096871515], "policy_predator_policy_reward": [26.647195352816055, 20.724540248878455, 19.572426797778338, 39.20268303344302, 68.0314769358853, 44.510344921061595, 93.20858588305346, 1.140682562608974, 41.55260010443385, 86.19078601126544, 9.925826700728601, 6.609416336528192, 45.35861970087741, 83.28218273589484, 33.57147168106213, 5.9701573121548925, 72.50111830688856, 30.196876563606576, 5.490938199449681, 71.01313731635699, 56.48968723592808, 29.86500169874263, 83.59097905592859, 15.117663412033416, 34.88101202094244, 67.18631213033554, 19.55394861027304, 11.67895211887514, 102.29807182277754, 2.1610393187439993, 0.6715135358036912, 25.29987179937111, 6.576396080706094, 80.8389691248002, 26.064379762822856, 21.665630347899707, 7.560050839342841, 84.58596655605236, 18.95545239618806, 53.92709892508076, 75.5194635989564, 66.06697450812483, 98.80604082808254, 44.36776268987304, 4.277086385619621, 21.586020479375318, 80.13762384292886, 55.68736460678012, 75.53715497812036, 108.37271876969591, 23.778677773160393, 18.856477354139315, 52.016684092742885, 67.59257796688979, 51.55753653730326, 73.20055851087854, 83.67183808940534, 85.02883656727367, 77.98814669436145, 33.16548445903751, 68.50284665403292, 102.60543347519287, 93.7757637850425, 17.862102622527605, 123.61301815312629, 95.13799799411278, 93.97513493158648, 72.9852045098719, 68.5385628618575, 78.04725811512995, 90.40511017907214, 78.98149559552205, 106.45416848053634, 126.69776387673213, 20.174483904680233, 44.72581902985199, 26.3441183660396, 104.20565908173549, 66.1214943764478, 79.14022466905317, 18.121797621451456, 85.28723139872837, 75.98955519885749, 2.768929647743463, 45.0835945683228, 40.724986210154256, 98.91491869350347, 29.15765395326713, 86.10621271796659, 18.401505889944662, 173.5829801311523, 214.39603121739415, 69.17241890012112, 70.19710345642939, 74.70691680073101, 47.66628729840688, 127.15396093474207, 62.88772084303176, 12.26841203147252, 49.983298581679975, 57.67144705347657, 40.55556496241989, 68.33780922253774, 32.78518274684296, 37.66287846987231, 50.75404771518897, 137.15856180214124, 91.46699746495479, 58.82295382151623, 103.02887184888189, 47.87178249202854, 87.09076111890121, 41.052000200058195, 45.94874942715505, 27.297970459879842, 59.07062629625521, 54.43486716261202, 85.34257021090295, 41.36786635021798, 84.19098497518489, 21.40917191719905, 60.42030372968933, 51.753197623194005, 65.82580845189662, 87.1649967122744, 69.05148344694892, 69.46396875811774, 39.787695680478755, 87.89794243058057, 97.95067226704809, 111.96521374868313, 33.250396905835764, 8.409489827366087, 35.87734009352694, 74.35853634529755, 87.62030369961317, 51.0564574543696, 93.83403360944918, 53.01014786531194, 57.957629374366874, 67.15856979627394, 26.1073645587971, 98.53001639201858, 64.93560296474475, 49.13765497912229, 46.5100169323938, 71.37912179134413, 45.39689506955506, 76.27269431591714, 35.77330621051868, 99.7244860626655, 79.55062917557034, 74.12267311655414, 78.58494521578737, 28.718778248899987, 33.49905286799914, 100.22513481276046, 109.26025570196185, 76.03726939134869, 14.32578262620632, 46.37656453532247, 45.37888428697059, 106.1370375205246, 65.48855673062418, 108.20324075392958, 50.61072271627696, 92.27290520991852, 79.0705097809263, 34.99887246003497, 60.72026718388786, 70.59330511373673, 66.42765968126182, 94.32114495318164, 96.39717053886801, 75.3474248508426, 98.93014559255502, 86.35863636267118, 45.843854244499276, 25.03004203497184, 24.165668436053757, 26.120000697550104, 42.93665831679428, 46.308468395064224, 129.51159633453292, 71.98673576024811, 57.36614247991761, 77.67850062772973, 119.44234037263483, 21.348135131646977, 3.3278120466417676, 81.01697160980608, 49.674906840351866, 70.86502095551249, 73.38980129789199, 57.31181040562867, 97.15413535927894, 40.42019926019277, 94.39979315978526, 37.59641919464741, 53.721884387991615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5328142301017151, "mean_inference_ms": 1.339589017402339, "mean_action_processing_ms": 0.2204035687807618, "mean_env_wait_ms": 0.18163118630999492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004357457160949707, "StateBufferConnector_ms": 0.0037821531295776367, "ViewRequirementAgentConnector_ms": 0.08255982398986816}, "num_episodes": 18, "episode_return_max": 286.49753355405636, "episode_return_min": -21.457975914943468, "episode_return_mean": 98.63582948438528, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.6001183550307, "num_env_steps_trained_throughput_per_sec": 423.6001183550307, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 9708.121, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9708.08, "sample_time_ms": 1065.256, "learn_time_ms": 8629.683, "learn_throughput": 463.516, "synch_weights_time_ms": 12.215}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "ef79f_00000", "date": "2024-08-16_11-18-20", "timestamp": 1723787300, "time_this_iter_s": 9.445678234100342, "time_total_s": 77.74418425559998, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321456940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 77.74418425559998, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.661538461538463, "ram_util_percent": 81.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4651821803478968, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.175535589551169, "policy_loss": -0.007272387601720987, "vf_loss": 7.181218918038423, "vf_explained_var": 0.019066062743070895, "kl": 0.00794536527530442, "entropy": 1.5366833862173495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.773346660534541, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.280635787065698, "policy_loss": -0.000855281998073219, "vf_loss": 6.2802438158206835, "vf_explained_var": 0.025014330344225365, "kl": 0.006236242652748385, "entropy": 1.419083129665839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 336.5035613122608, "episode_reward_min": -21.457975914943468, "episode_reward_mean": 99.2007502266556, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1058.1786125122683, "predator_policy": 0.8637004385149925}, "policy_reward_max": {"prey_policy": 175.71177922312305, "predator_policy": 1111.9827249792925}, "policy_reward_mean": {"prey_policy": -14.411373664670846, "predator_policy": 64.01174877799862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [286.49753355405636, 82.99142267591952, 26.97212656774561, 229.55309583460092, 103.58000000000008, 125.42555362873053, 42.822439267364665, 67.95228854992133, 107.86808536923508, 139.10475560166307, 99.68423179310157, 36.73779416110816, 34.25044964217494, 51.516833019835516, 83.81951209340296, 138.56203464418738, 39.85001014109832, 67.84221228773951, 138.52068302514928, 119.00256705657775, 177.46148543457355, 44.937252101794506, 91.53519670590049, 48.13044068538986, 96.03942663904844, 127.53568771531371, 24.052746190808907, 239.5753865606415, 26.779295842286853, 71.49196938830325, 216.05672261573542, 64.3808888092209, 55.09846801340338, 64.97164026985355, 50.845203430720694, 103.66720705586056, 57.43599439961769, 61.9681953906283, 1.5582128869735565, 128.45169193799742, 137.92644863365362, 77.4110991737503, 57.5695199337415, -21.457975914943468, 57.19385756648177, 152.8988784443786, 163.12591982532564, 95.37406264119387, 36.38187197485676, 30.417193691192107, 75.99681006363993, 138.93129866444093, 145.21076902405548, 5.113729308795665, 12.449855942850355, 137.60197110607882, 75.40237720874607, 47.769878224389274, 58.94058874126042, 103.06036669011525, 22.188694431957728, 43.243919999621575, 32.531145184533734, 140.15566298739535, 158.40727205897784, 37.06637400119699, 47.133205036622016, 131.57306395113906, 25.62911159854722, 107.3168386143342, 168.7663244812935, 70.50915914822274, 91.36048300907022, 160.04072513602225, 31.756961909767817, 67.27036339322696, 108.57870173599943, 103.0389703450133, 131.35089651194932, 200.0246990938332, 300.078780730361, 67.40305605378566, 77.80438486181386, 111.98000000000026, 57.003281272046195, 283.414338138938, 36.731932794157174, 132.29529089489438, 180.3180762684612, 3.6999999999999655, 109.92034416897846, 286.1479513858678, 58.05774906254798, 336.5035613122608, 17.80310795087608, 112.3187915585042, 34.569032168275044, 175.84999999999974, 12.49003686015795, 285.8974726232205], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [117.24698426893757, 143.38744242012385, -3.128548443238361, -49.70501733055096, -84.30444246128093, -72.63330471878972, 91.83395522018438, 95.08398548711679, 63.5158839358453, -79.54514599547798, 16.832670256752646, -16.165211676203935, -49.22005126874542, -76.65818412056888, 38.30303135522475, -81.5043739587024, -79.94933472697075, 16.709139966979997, 21.19441887594751, 6.272470318145428, -31.955275197494956, -87.11150915664263, -67.01181013698314, -63.210735143367096, -37.532982034849816, -74.80238929996268, -56.01284354981676, -61.85692920494178, -31.88946823641943, -117.44295202744615, 43.07428116046866, 30.58745054918653, 3.7644900018915877, -94.4642573085683, -85.96965033888658, 8.550143581125118, -58.59198591968335, 93.70363992465288, -43.15519244036627, 83.39927465034302, 61.21362758108635, 30.439277075010192, -21.474828360926388, -61.66049218404973, -10.670761733151867, -2.3017601688589506, -227.25906490761253, -112.58950575554368, -32.706210115913876, -10.623885601588377, -48.38723946756305, 53.54972308373901, -117.09580914961764, -48.89312643734763, 132.52663709514064, 44.79703885234832, -69.87650873694157, -1.5712074366681306, -41.380916597965985, 11.749894016888591, -4.964951133347027, 132.60474756402118, -2.208674335674962, -162.03599612220034, -88.1833472401603, -18.570010416834464, -61.435931127357776, -8.554972213718377, -37.10121075053573, 0.9456645540431069, 35.7518053590024, -18.453195059276965, -54.373799800054975, -27.967643173842244, -21.76644959365833, -41.82420634111617, -6.046978847475827, -74.22428391243874, 62.58713029306447, -51.714444430158245, 16.959722392859888, -35.249753918429604, -47.01334822026823, 15.17278295542204, -60.814407116823865, -67.46468764706353, -67.1891731946978, -99.48441337476453, -0.3713262146977556, 13.27835386028651, -56.08829613067284, 47.0083345301405, 30.197502542039686, -11.962073780532904, 28.172239926087343, -43.76595452457237, -4.869574557675751, -52.014487822538705, -70.02633984395622, -63.02208582161492, -20.58470432315573, 0.9338424752790286, 53.81353061209249, -31.65824880855077, 0.6074749916950449, 32.55729350592458, -99.62936149103743, -74.53202443840267, -75.95820374580752, -64.29955864368361, 96.73402167553316, -21.349881686352727, -120.0191764811307, -14.06383682484553, -47.88735549738849, 5.294181704222666, -54.98705861109778, 22.17219853006532, -103.89555124600412, 35.33032368497057, -33.72193904419018, -102.90332999405894, -97.9803243166522, -30.11917067457096, 1.1578962703437603, -64.34589072973287, 29.704571144877907, -26.569872952481106, -126.38279993572806, 94.07175650265627, -98.69325762832915, -38.51793881387132, -29.51783601071808, -55.551449559830246, 7.5339601988409415, 74.84339328127247, -45.42754741579753, 2.0000000000000013, 64.90490775853164, -133.40813387379467, 60.40427287582172, -20.99082663469373, -111.43834704137247, -15.173334810769479, 42.87142831253266, 23.813107518247893, -11.208780341546799, 40.557627027411165, -63.87826719221756, -48.619593151419444, -51.66810158285384, -35.52748078882698, 72.2466030005941, -98.48789368457265, 27.181947859245632, -15.461281096871515, 105.36519105013792, -26.054091884346917, 64.54224772496201, 21.200608388600877, 149.21133499060068, 114.72352553887177, 8.037807752042262, -25.101407153946912, 22.473374706431834, -25.68348631531158, 1.0962995614850088, 79.6435408922829, -37.01487088255488, -65.62205955146997, 110.31486418551034, 136.53584305424897, -1.9112219741803453, -42.48449437287631, 89.49485039884667, 0.07797554779573625, 37.3297358349574, 54.21886908989832, 0.9143327569886132, -4.3205068651748775, 0.166052801235339, 50.934727679148764, 64.64035204865327, 152.29141079374904, 28.4322641420161, -5.98084560549838, 140.50545003365426, 175.71177922312305, -10.497127228351884, -27.40747486208365, 21.047147174730334, -1058.1786125122683, -81.32451215847685, -21.62029778855453, -2.7115184500086515, 167.91852393883042, -70.63458529958642, -11.651001987280177, 84.33361712618145, 129.14686002677712], "policy_predator_policy_reward": [4.277086385619621, 21.586020479375318, 80.13762384292886, 55.68736460678012, 75.53715497812036, 108.37271876969591, 23.778677773160393, 18.856477354139315, 52.016684092742885, 67.59257796688979, 51.55753653730326, 73.20055851087854, 83.67183808940534, 85.02883656727367, 77.98814669436145, 33.16548445903751, 68.50284665403292, 102.60543347519287, 93.7757637850425, 17.862102622527605, 123.61301815312629, 95.13799799411278, 93.97513493158648, 72.9852045098719, 68.5385628618575, 78.04725811512995, 90.40511017907214, 78.98149559552205, 106.45416848053634, 126.69776387673213, 20.174483904680233, 44.72581902985199, 26.3441183660396, 104.20565908173549, 66.1214943764478, 79.14022466905317, 18.121797621451456, 85.28723139872837, 75.98955519885749, 2.768929647743463, 45.0835945683228, 40.724986210154256, 98.91491869350347, 29.15765395326713, 86.10621271796659, 18.401505889944662, 173.5829801311523, 214.39603121739415, 69.17241890012112, 70.19710345642939, 74.70691680073101, 47.66628729840688, 127.15396093474207, 62.88772084303176, 12.26841203147252, 49.983298581679975, 57.67144705347657, 40.55556496241989, 68.33780922253774, 32.78518274684296, 37.66287846987231, 50.75404771518897, 137.15856180214124, 91.46699746495479, 58.82295382151623, 103.02887184888189, 47.87178249202854, 87.09076111890121, 41.052000200058195, 45.94874942715505, 27.297970459879842, 59.07062629625521, 54.43486716261202, 85.34257021090295, 41.36786635021798, 84.19098497518489, 21.40917191719905, 60.42030372968933, 51.753197623194005, 65.82580845189662, 87.1649967122744, 69.05148344694892, 69.46396875811774, 39.787695680478755, 87.89794243058057, 97.95067226704809, 111.96521374868313, 33.250396905835764, 8.409489827366087, 35.87734009352694, 74.35853634529755, 87.62030369961317, 51.0564574543696, 93.83403360944918, 53.01014786531194, 57.957629374366874, 67.15856979627394, 26.1073645587971, 98.53001639201858, 64.93560296474475, 49.13765497912229, 46.5100169323938, 71.37912179134413, 45.39689506955506, 76.27269431591714, 35.77330621051868, 99.7244860626655, 79.55062917557034, 74.12267311655414, 78.58494521578737, 28.718778248899987, 33.49905286799914, 100.22513481276046, 109.26025570196185, 76.03726939134869, 14.32578262620632, 46.37656453532247, 45.37888428697059, 106.1370375205246, 65.48855673062418, 108.20324075392958, 50.61072271627696, 92.27290520991852, 79.0705097809263, 34.99887246003497, 60.72026718388786, 70.59330511373673, 66.42765968126182, 94.32114495318164, 96.39717053886801, 75.3474248508426, 98.93014559255502, 86.35863636267118, 45.843854244499276, 25.03004203497184, 24.165668436053757, 26.120000697550104, 42.93665831679428, 46.308468395064224, 129.51159633453292, 71.98673576024811, 57.36614247991761, 77.67850062772973, 119.44234037263483, 21.348135131646977, 3.3278120466417676, 81.01697160980608, 49.674906840351866, 70.86502095551249, 73.38980129789199, 57.31181040562867, 97.15413535927894, 40.42019926019277, 94.39979315978526, 37.59641919464741, 53.721884387991615, 33.76353022654351, 18.276267119614527, 60.98388023939638, 53.29796274087392, 16.70031992625164, 19.44360027463692, 42.22035244443601, 42.24630301125452, 42.85570191030779, 38.15879456038592, 30.37645910771713, 0.8637004385149925, 76.94950149349876, 82.69071021257237, 14.847963701990725, 21.71566719718793, 72.90409233290963, 8.223556808304155, 26.667271430793004, 16.05519351745883, 21.039425434378515, 67.73004590922706, 2.1245556335282156, 4.981618474658013, 14.65439427889154, 44.16516940970191, 30.45475864012771, 38.76142990333784, 14.157212956212136, 21.44911756981878, 5.067205480417156, 15.219126575066442, 22.375484677080536, 33.332225364230915, 1111.9827249792925, 37.46753191674933, 54.860682228808024, 82.65315988649813, 6.579145659781161, 4.063848851397056, 69.00992149987223, 25.76570264715261, 14.16070145415373, 58.25629401610827]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5292877841410549, "mean_inference_ms": 1.3314329406152825, "mean_action_processing_ms": 0.2184661072662383, "mean_env_wait_ms": 0.18060980841781663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037069320678710938, "StateBufferConnector_ms": 0.003772139549255371, "ViewRequirementAgentConnector_ms": 0.08055651187896729}, "num_episodes": 22, "episode_return_max": 336.5035613122608, "episode_return_min": -21.457975914943468, "episode_return_mean": 99.2007502266556, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.949853824215, "num_env_steps_trained_throughput_per_sec": 423.949853824215, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 9677.783, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9677.744, "sample_time_ms": 1065.363, "learn_time_ms": 8599.194, "learn_throughput": 465.16, "synch_weights_time_ms": 12.278}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "ef79f_00000", "date": "2024-08-16_11-18-29", "timestamp": 1723787309, "time_this_iter_s": 9.4446439743042, "time_total_s": 87.18882822990417, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321456820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.18882822990417, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.628571428571426, "ram_util_percent": 81.22142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9404850917203085, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.241239134218327, "policy_loss": -0.009627593304868294, "vf_loss": 8.248136682611294, "vf_explained_var": 0.008961317305842405, "kl": 0.013650355982661958, "entropy": 1.5087709910655147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.838598905070118, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.281787281944638, "policy_loss": -0.004738964541278109, "vf_loss": 6.28480702279106, "vf_explained_var": 0.06700308199912783, "kl": 0.008596069307297088, "entropy": 1.3763760422272657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 349.3237964677198, "episode_reward_min": -21.457975914943468, "episode_reward_mean": 121.4848142251884, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1058.1786125122683, "predator_policy": 0.8637004385149925}, "policy_reward_max": {"prey_policy": 187.04143179477006, "predator_policy": 1111.9827249792925}, "policy_reward_mean": {"prey_policy": 2.638354318461304, "predator_policy": 58.104052794132876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.13044068538986, 96.03942663904844, 127.53568771531371, 24.052746190808907, 239.5753865606415, 26.779295842286853, 71.49196938830325, 216.05672261573542, 64.3808888092209, 55.09846801340338, 64.97164026985355, 50.845203430720694, 103.66720705586056, 57.43599439961769, 61.9681953906283, 1.5582128869735565, 128.45169193799742, 137.92644863365362, 77.4110991737503, 57.5695199337415, -21.457975914943468, 57.19385756648177, 152.8988784443786, 163.12591982532564, 95.37406264119387, 36.38187197485676, 30.417193691192107, 75.99681006363993, 138.93129866444093, 145.21076902405548, 5.113729308795665, 12.449855942850355, 137.60197110607882, 75.40237720874607, 47.769878224389274, 58.94058874126042, 103.06036669011525, 22.188694431957728, 43.243919999621575, 32.531145184533734, 140.15566298739535, 158.40727205897784, 37.06637400119699, 47.133205036622016, 131.57306395113906, 25.62911159854722, 107.3168386143342, 168.7663244812935, 70.50915914822274, 91.36048300907022, 160.04072513602225, 31.756961909767817, 67.27036339322696, 108.57870173599943, 103.0389703450133, 131.35089651194932, 200.0246990938332, 300.078780730361, 67.40305605378566, 77.80438486181386, 111.98000000000026, 57.003281272046195, 283.414338138938, 36.731932794157174, 132.29529089489438, 180.3180762684612, 3.6999999999999655, 109.92034416897846, 286.1479513858678, 58.05774906254798, 336.5035613122608, 17.80310795087608, 112.3187915585042, 34.569032168275044, 175.84999999999974, 12.49003686015795, 285.8974726232205, 165.2897684953954, 158.6924224753855, 320.99842016462384, 139.64088416737206, 142.8584045802878, 178.6572859545432, 166.10128610010275, 36.11807164221776, 270.1187387981829, 97.491736141566, 92.77783425289024, 311.8665301132406, 279.8624890877227, 177.2340121123071, 127.05654763205746, 349.3237964677198, 151.17000127043124, 334.42390666090205, 229.45024433107713, 89.0377032161561, 324.31, 255.00288575063593, 167.41099359434608], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-227.25906490761253, -112.58950575554368, -32.706210115913876, -10.623885601588377, -48.38723946756305, 53.54972308373901, -117.09580914961764, -48.89312643734763, 132.52663709514064, 44.79703885234832, -69.87650873694157, -1.5712074366681306, -41.380916597965985, 11.749894016888591, -4.964951133347027, 132.60474756402118, -2.208674335674962, -162.03599612220034, -88.1833472401603, -18.570010416834464, -61.435931127357776, -8.554972213718377, -37.10121075053573, 0.9456645540431069, 35.7518053590024, -18.453195059276965, -54.373799800054975, -27.967643173842244, -21.76644959365833, -41.82420634111617, -6.046978847475827, -74.22428391243874, 62.58713029306447, -51.714444430158245, 16.959722392859888, -35.249753918429604, -47.01334822026823, 15.17278295542204, -60.814407116823865, -67.46468764706353, -67.1891731946978, -99.48441337476453, -0.3713262146977556, 13.27835386028651, -56.08829613067284, 47.0083345301405, 30.197502542039686, -11.962073780532904, 28.172239926087343, -43.76595452457237, -4.869574557675751, -52.014487822538705, -70.02633984395622, -63.02208582161492, -20.58470432315573, 0.9338424752790286, 53.81353061209249, -31.65824880855077, 0.6074749916950449, 32.55729350592458, -99.62936149103743, -74.53202443840267, -75.95820374580752, -64.29955864368361, 96.73402167553316, -21.349881686352727, -120.0191764811307, -14.06383682484553, -47.88735549738849, 5.294181704222666, -54.98705861109778, 22.17219853006532, -103.89555124600412, 35.33032368497057, -33.72193904419018, -102.90332999405894, -97.9803243166522, -30.11917067457096, 1.1578962703437603, -64.34589072973287, 29.704571144877907, -26.569872952481106, -126.38279993572806, 94.07175650265627, -98.69325762832915, -38.51793881387132, -29.51783601071808, -55.551449559830246, 7.5339601988409415, 74.84339328127247, -45.42754741579753, 2.0000000000000013, 64.90490775853164, -133.40813387379467, 60.40427287582172, -20.99082663469373, -111.43834704137247, -15.173334810769479, 42.87142831253266, 23.813107518247893, -11.208780341546799, 40.557627027411165, -63.87826719221756, -48.619593151419444, -51.66810158285384, -35.52748078882698, 72.2466030005941, -98.48789368457265, 27.181947859245632, -15.461281096871515, 105.36519105013792, -26.054091884346917, 64.54224772496201, 21.200608388600877, 149.21133499060068, 114.72352553887177, 8.037807752042262, -25.101407153946912, 22.473374706431834, -25.68348631531158, 1.0962995614850088, 79.6435408922829, -37.01487088255488, -65.62205955146997, 110.31486418551034, 136.53584305424897, -1.9112219741803453, -42.48449437287631, 89.49485039884667, 0.07797554779573625, 37.3297358349574, 54.21886908989832, 0.9143327569886132, -4.3205068651748775, 0.166052801235339, 50.934727679148764, 64.64035204865327, 152.29141079374904, 28.4322641420161, -5.98084560549838, 140.50545003365426, 175.71177922312305, -10.497127228351884, -27.40747486208365, 21.047147174730334, -1058.1786125122683, -81.32451215847685, -21.62029778855453, -2.7115184500086515, 167.91852393883042, -70.63458529958642, -11.651001987280177, 84.33361712618145, 129.14686002677712, 155.00062080571632, -11.19763685029812, 77.98476340255839, 24.310266789065302, 169.3960387255471, 120.70147870291137, 54.30908404886215, 9.954963749540974, 29.328477927174255, 21.467497190387824, 54.3787769501988, 76.26286943313893, 148.7801688971019, -5.101914129177952, -29.58379507161331, -470.5387196700928, 162.4122232181399, 63.31323527427212, -22.191964659333834, -22.125455270222574, 62.29575427957897, -12.269579911597154, 163.93358414374546, 129.1632006506461, 153.97691354683616, 90.4676891834997, 11.857760538343886, 53.3278149909132, -8.057448100258611, 94.46991168373499, 178.47200577394864, 148.44715836142774, 0.4766320260412513, 70.73907894433427, 158.29152186568854, 135.06745596554913, 108.11027422288952, 86.52808304452259, -12.636849255243703, 2.6584547275073263, 149.55567475565664, 164.03110848876963, -10.475145867286649, 187.04143179477006, 43.87150469567902, 18.92335609893397], "policy_predator_policy_reward": [173.5829801311523, 214.39603121739415, 69.17241890012112, 70.19710345642939, 74.70691680073101, 47.66628729840688, 127.15396093474207, 62.88772084303176, 12.26841203147252, 49.983298581679975, 57.67144705347657, 40.55556496241989, 68.33780922253774, 32.78518274684296, 37.66287846987231, 50.75404771518897, 137.15856180214124, 91.46699746495479, 58.82295382151623, 103.02887184888189, 47.87178249202854, 87.09076111890121, 41.052000200058195, 45.94874942715505, 27.297970459879842, 59.07062629625521, 54.43486716261202, 85.34257021090295, 41.36786635021798, 84.19098497518489, 21.40917191719905, 60.42030372968933, 51.753197623194005, 65.82580845189662, 87.1649967122744, 69.05148344694892, 69.46396875811774, 39.787695680478755, 87.89794243058057, 97.95067226704809, 111.96521374868313, 33.250396905835764, 8.409489827366087, 35.87734009352694, 74.35853634529755, 87.62030369961317, 51.0564574543696, 93.83403360944918, 53.01014786531194, 57.957629374366874, 67.15856979627394, 26.1073645587971, 98.53001639201858, 64.93560296474475, 49.13765497912229, 46.5100169323938, 71.37912179134413, 45.39689506955506, 76.27269431591714, 35.77330621051868, 99.7244860626655, 79.55062917557034, 74.12267311655414, 78.58494521578737, 28.718778248899987, 33.49905286799914, 100.22513481276046, 109.26025570196185, 76.03726939134869, 14.32578262620632, 46.37656453532247, 45.37888428697059, 106.1370375205246, 65.48855673062418, 108.20324075392958, 50.61072271627696, 92.27290520991852, 79.0705097809263, 34.99887246003497, 60.72026718388786, 70.59330511373673, 66.42765968126182, 94.32114495318164, 96.39717053886801, 75.3474248508426, 98.93014559255502, 86.35863636267118, 45.843854244499276, 25.03004203497184, 24.165668436053757, 26.120000697550104, 42.93665831679428, 46.308468395064224, 129.51159633453292, 71.98673576024811, 57.36614247991761, 77.67850062772973, 119.44234037263483, 21.348135131646977, 3.3278120466417676, 81.01697160980608, 49.674906840351866, 70.86502095551249, 73.38980129789199, 57.31181040562867, 97.15413535927894, 40.42019926019277, 94.39979315978526, 37.59641919464741, 53.721884387991615, 33.76353022654351, 18.276267119614527, 60.98388023939638, 53.29796274087392, 16.70031992625164, 19.44360027463692, 42.22035244443601, 42.24630301125452, 42.85570191030779, 38.15879456038592, 30.37645910771713, 0.8637004385149925, 76.94950149349876, 82.69071021257237, 14.847963701990725, 21.71566719718793, 72.90409233290963, 8.223556808304155, 26.667271430793004, 16.05519351745883, 21.039425434378515, 67.73004590922706, 2.1245556335282156, 4.981618474658013, 14.65439427889154, 44.16516940970191, 30.45475864012771, 38.76142990333784, 14.157212956212136, 21.44911756981878, 5.067205480417156, 15.219126575066442, 22.375484677080536, 33.332225364230915, 1111.9827249792925, 37.46753191674933, 54.860682228808024, 82.65315988649813, 6.579145659781161, 4.063848851397056, 69.00992149987223, 25.76570264715261, 14.16070145415373, 58.25629401610827, 13.464436620453325, 8.022347919523934, 43.60043271923861, 12.796959564523181, 21.18982371709619, 9.711079019069322, 51.40487819131766, 23.971958177651246, 53.66381513124756, 38.3986143314781, 9.07712699642044, 38.938512574785165, 7.806234492672767, 14.616796839506087, 523.4710887311957, 12.769497652727841, 30.32574462785097, 14.06753567791982, 110.84734454986375, 30.96181152125869, 24.940798032076867, 17.810861852831426, 12.011595276759376, 6.7581500420897065, 14.353131250515924, 21.064755106870624, 50.68644048686459, 61.36199609618542, 16.391432665899625, 24.252651382680945, 11.266915570654831, 11.137716761688562, 18.631440545735888, 61.32284975431988, 28.900119902130495, 12.164808927533903, 27.395465232282305, 7.416421831382679, 66.15083095079055, 32.86526679310183, 5.383213797643234, 5.340002957930475, 12.863323870914652, 65.57327595223781, 58.31909227162595, 46.29704052810716]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5252943935079838, "mean_inference_ms": 1.3233640681565444, "mean_action_processing_ms": 0.2170620508852731, "mean_env_wait_ms": 0.17934039956777992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003476262092590332, "StateBufferConnector_ms": 0.0037925243377685547, "ViewRequirementAgentConnector_ms": 0.0836101770401001}, "num_episodes": 23, "episode_return_max": 349.3237964677198, "episode_return_min": -21.457975914943468, "episode_return_mean": 121.4848142251884, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.1585839982377, "num_env_steps_trained_throughput_per_sec": 428.1585839982377, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 9644.239, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9644.2, "sample_time_ms": 1057.596, "learn_time_ms": 8573.571, "learn_throughput": 466.55, "synch_weights_time_ms": 12.141}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "ef79f_00000", "date": "2024-08-16_11-18-39", "timestamp": 1723787319, "time_this_iter_s": 9.345253229141235, "time_total_s": 96.53408145904541, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b83a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 96.53408145904541, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.59230769230769, "ram_util_percent": 81.06923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1449181103832506, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.683916016482803, "policy_loss": -0.013051349832060397, "vf_loss": 7.693517790395747, "vf_explained_var": 0.05961645595611088, "kl": 0.01724787846659025, "entropy": 1.503243785245078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.250609493760205, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.386587455537584, "policy_loss": -0.008755735166385652, "vf_loss": 5.3928010153392005, "vf_explained_var": 0.2139178481682268, "kl": 0.0127109703666387, "entropy": 1.2744164949371701, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 381.09000000000003, "episode_reward_min": -21.457975914943468, "episode_reward_mean": 140.50423486136918, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1058.1786125122683, "predator_policy": 0.4041357144799014}, "policy_reward_max": {"prey_policy": 192.52996921898705, "predator_policy": 1111.9827249792925}, "policy_reward_mean": {"prey_policy": 20.435689437479905, "predator_policy": 49.81642799320468}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.4110991737503, 57.5695199337415, -21.457975914943468, 57.19385756648177, 152.8988784443786, 163.12591982532564, 95.37406264119387, 36.38187197485676, 30.417193691192107, 75.99681006363993, 138.93129866444093, 145.21076902405548, 5.113729308795665, 12.449855942850355, 137.60197110607882, 75.40237720874607, 47.769878224389274, 58.94058874126042, 103.06036669011525, 22.188694431957728, 43.243919999621575, 32.531145184533734, 140.15566298739535, 158.40727205897784, 37.06637400119699, 47.133205036622016, 131.57306395113906, 25.62911159854722, 107.3168386143342, 168.7663244812935, 70.50915914822274, 91.36048300907022, 160.04072513602225, 31.756961909767817, 67.27036339322696, 108.57870173599943, 103.0389703450133, 131.35089651194932, 200.0246990938332, 300.078780730361, 67.40305605378566, 77.80438486181386, 111.98000000000026, 57.003281272046195, 283.414338138938, 36.731932794157174, 132.29529089489438, 180.3180762684612, 3.6999999999999655, 109.92034416897846, 286.1479513858678, 58.05774906254798, 336.5035613122608, 17.80310795087608, 112.3187915585042, 34.569032168275044, 175.84999999999974, 12.49003686015795, 285.8974726232205, 165.2897684953954, 158.6924224753855, 320.99842016462384, 139.64088416737206, 142.8584045802878, 178.6572859545432, 166.10128610010275, 36.11807164221776, 270.1187387981829, 97.491736141566, 92.77783425289024, 311.8665301132406, 279.8624890877227, 177.2340121123071, 127.05654763205746, 349.3237964677198, 151.17000127043124, 334.42390666090205, 229.45024433107713, 89.0377032161561, 324.31, 255.00288575063593, 167.41099359434608, 117.07000000000038, 228.37986321453778, 140.31421287885857, 183.2777706344915, 111.40983343904679, 88.09472374039314, 252.85635319346648, 292.82507519523404, 214.39000000000004, 259.90208728814366, 315.4658960143182, 195.7199999999997, 381.09000000000003, 152.9416564589435, 278.58471352553613, 26.38568616113285, 79.67002823536313, 159.5297901040698], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-47.01334822026823, 15.17278295542204, -60.814407116823865, -67.46468764706353, -67.1891731946978, -99.48441337476453, -0.3713262146977556, 13.27835386028651, -56.08829613067284, 47.0083345301405, 30.197502542039686, -11.962073780532904, 28.172239926087343, -43.76595452457237, -4.869574557675751, -52.014487822538705, -70.02633984395622, -63.02208582161492, -20.58470432315573, 0.9338424752790286, 53.81353061209249, -31.65824880855077, 0.6074749916950449, 32.55729350592458, -99.62936149103743, -74.53202443840267, -75.95820374580752, -64.29955864368361, 96.73402167553316, -21.349881686352727, -120.0191764811307, -14.06383682484553, -47.88735549738849, 5.294181704222666, -54.98705861109778, 22.17219853006532, -103.89555124600412, 35.33032368497057, -33.72193904419018, -102.90332999405894, -97.9803243166522, -30.11917067457096, 1.1578962703437603, -64.34589072973287, 29.704571144877907, -26.569872952481106, -126.38279993572806, 94.07175650265627, -98.69325762832915, -38.51793881387132, -29.51783601071808, -55.551449559830246, 7.5339601988409415, 74.84339328127247, -45.42754741579753, 2.0000000000000013, 64.90490775853164, -133.40813387379467, 60.40427287582172, -20.99082663469373, -111.43834704137247, -15.173334810769479, 42.87142831253266, 23.813107518247893, -11.208780341546799, 40.557627027411165, -63.87826719221756, -48.619593151419444, -51.66810158285384, -35.52748078882698, 72.2466030005941, -98.48789368457265, 27.181947859245632, -15.461281096871515, 105.36519105013792, -26.054091884346917, 64.54224772496201, 21.200608388600877, 149.21133499060068, 114.72352553887177, 8.037807752042262, -25.101407153946912, 22.473374706431834, -25.68348631531158, 1.0962995614850088, 79.6435408922829, -37.01487088255488, -65.62205955146997, 110.31486418551034, 136.53584305424897, -1.9112219741803453, -42.48449437287631, 89.49485039884667, 0.07797554779573625, 37.3297358349574, 54.21886908989832, 0.9143327569886132, -4.3205068651748775, 0.166052801235339, 50.934727679148764, 64.64035204865327, 152.29141079374904, 28.4322641420161, -5.98084560549838, 140.50545003365426, 175.71177922312305, -10.497127228351884, -27.40747486208365, 21.047147174730334, -1058.1786125122683, -81.32451215847685, -21.62029778855453, -2.7115184500086515, 167.91852393883042, -70.63458529958642, -11.651001987280177, 84.33361712618145, 129.14686002677712, 155.00062080571632, -11.19763685029812, 77.98476340255839, 24.310266789065302, 169.3960387255471, 120.70147870291137, 54.30908404886215, 9.954963749540974, 29.328477927174255, 21.467497190387824, 54.3787769501988, 76.26286943313893, 148.7801688971019, -5.101914129177952, -29.58379507161331, -470.5387196700928, 162.4122232181399, 63.31323527427212, -22.191964659333834, -22.125455270222574, 62.29575427957897, -12.269579911597154, 163.93358414374546, 129.1632006506461, 153.97691354683616, 90.4676891834997, 11.857760538343886, 53.3278149909132, -8.057448100258611, 94.46991168373499, 178.47200577394864, 148.44715836142774, 0.4766320260412513, 70.73907894433427, 158.29152186568854, 135.06745596554913, 108.11027422288952, 86.52808304452259, -12.636849255243703, 2.6584547275073263, 149.55567475565664, 164.03110848876963, -10.475145867286649, 187.04143179477006, 43.87150469567902, 18.92335609893397, 1.7787352176480502, 81.51888894419244, 81.67014337924256, 79.33766238384908, -17.424953521205882, 9.782241269754236, 166.34087220864484, 2.0000000000000013, 78.62079281564884, -0.1048305405290371, -17.453731242867622, 45.93092331459645, 82.76551438968846, 134.37744316869612, 111.37215050660053, 150.67604095967144, 140.59208506213116, 58.83944993228525, 132.67128723699807, 60.47001800623056, 163.8834941937324, 138.31213284323385, -7.2632624370862935, 192.52996921898705, 190.55440046881287, 188.6858642855201, 94.48881942384759, 7.089591418363607, 123.86137173996059, 124.83351991930112, -46.36507441038532, -46.72939267170423, -2.97645175951608, 25.02810836109561, 65.02874428618621, 31.15749602016004], "policy_predator_policy_reward": [69.46396875811774, 39.787695680478755, 87.89794243058057, 97.95067226704809, 111.96521374868313, 33.250396905835764, 8.409489827366087, 35.87734009352694, 74.35853634529755, 87.62030369961317, 51.0564574543696, 93.83403360944918, 53.01014786531194, 57.957629374366874, 67.15856979627394, 26.1073645587971, 98.53001639201858, 64.93560296474475, 49.13765497912229, 46.5100169323938, 71.37912179134413, 45.39689506955506, 76.27269431591714, 35.77330621051868, 99.7244860626655, 79.55062917557034, 74.12267311655414, 78.58494521578737, 28.718778248899987, 33.49905286799914, 100.22513481276046, 109.26025570196185, 76.03726939134869, 14.32578262620632, 46.37656453532247, 45.37888428697059, 106.1370375205246, 65.48855673062418, 108.20324075392958, 50.61072271627696, 92.27290520991852, 79.0705097809263, 34.99887246003497, 60.72026718388786, 70.59330511373673, 66.42765968126182, 94.32114495318164, 96.39717053886801, 75.3474248508426, 98.93014559255502, 86.35863636267118, 45.843854244499276, 25.03004203497184, 24.165668436053757, 26.120000697550104, 42.93665831679428, 46.308468395064224, 129.51159633453292, 71.98673576024811, 57.36614247991761, 77.67850062772973, 119.44234037263483, 21.348135131646977, 3.3278120466417676, 81.01697160980608, 49.674906840351866, 70.86502095551249, 73.38980129789199, 57.31181040562867, 97.15413535927894, 40.42019926019277, 94.39979315978526, 37.59641919464741, 53.721884387991615, 33.76353022654351, 18.276267119614527, 60.98388023939638, 53.29796274087392, 16.70031992625164, 19.44360027463692, 42.22035244443601, 42.24630301125452, 42.85570191030779, 38.15879456038592, 30.37645910771713, 0.8637004385149925, 76.94950149349876, 82.69071021257237, 14.847963701990725, 21.71566719718793, 72.90409233290963, 8.223556808304155, 26.667271430793004, 16.05519351745883, 21.039425434378515, 67.73004590922706, 2.1245556335282156, 4.981618474658013, 14.65439427889154, 44.16516940970191, 30.45475864012771, 38.76142990333784, 14.157212956212136, 21.44911756981878, 5.067205480417156, 15.219126575066442, 22.375484677080536, 33.332225364230915, 1111.9827249792925, 37.46753191674933, 54.860682228808024, 82.65315988649813, 6.579145659781161, 4.063848851397056, 69.00992149987223, 25.76570264715261, 14.16070145415373, 58.25629401610827, 13.464436620453325, 8.022347919523934, 43.60043271923861, 12.796959564523181, 21.18982371709619, 9.711079019069322, 51.40487819131766, 23.971958177651246, 53.66381513124756, 38.3986143314781, 9.07712699642044, 38.938512574785165, 7.806234492672767, 14.616796839506087, 523.4710887311957, 12.769497652727841, 30.32574462785097, 14.06753567791982, 110.84734454986375, 30.96181152125869, 24.940798032076867, 17.810861852831426, 12.011595276759376, 6.7581500420897065, 14.353131250515924, 21.064755106870624, 50.68644048686459, 61.36199609618542, 16.391432665899625, 24.252651382680945, 11.266915570654831, 11.137716761688562, 18.631440545735888, 61.32284975431988, 28.900119902130495, 12.164808927533903, 27.395465232282305, 7.416421831382679, 66.15083095079055, 32.86526679310183, 5.383213797643234, 5.340002957930475, 12.863323870914652, 65.57327595223781, 58.31909227162595, 46.29704052810716, 8.863888399153435, 24.90848743900612, 27.863158009899024, 39.50889944154713, 65.91709161961847, 82.0398335106919, 9.484415110299825, 5.452483315547066, 19.47403281933284, 13.419838344593936, 36.521740958121576, 23.095790710542964, 2.831378570533136, 32.882017064548734, 19.355279932135065, 11.421603796827332, 13.655998020041034, 1.302466985542537, 37.51332380130663, 29.24745824360848, 7.4242922771756055, 5.845976700176604, 8.983262437086257, 1.4700307810129378, 0.4041357144799014, 1.4455995311871115, 6.455189448644682, 44.90805616808751, 5.536128486018846, 24.353693380255404, 57.892610259100564, 61.58754298412184, 24.775224283593378, 32.84314735019015, 49.07430841599744, 14.269241381726179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5230410343235289, "mean_inference_ms": 1.3203085546514162, "mean_action_processing_ms": 0.21679424016900412, "mean_env_wait_ms": 0.1783692222921693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034961700439453125, "StateBufferConnector_ms": 0.0038079023361206055, "ViewRequirementAgentConnector_ms": 0.08968746662139893}, "num_episodes": 18, "episode_return_max": 381.09000000000003, "episode_return_min": -21.457975914943468, "episode_return_mean": 140.50423486136918, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.65086162937456, "num_env_steps_trained_throughput_per_sec": 418.65086162937456, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9531.962, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9531.926, "sample_time_ms": 1047.908, "learn_time_ms": 8470.752, "learn_throughput": 472.213, "synch_weights_time_ms": 12.438}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "ef79f_00000", "date": "2024-08-16_11-18-48", "timestamp": 1723787328, "time_this_iter_s": 9.558490991592407, "time_total_s": 106.09257245063782, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321437160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.09257245063782, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 28.514285714285712, "ram_util_percent": 80.74285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.969416936396291, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.319897343368126, "policy_loss": -0.012078036590622216, "vf_loss": 8.329355223216707, "vf_explained_var": 0.020016392955073604, "kl": 0.013100784291396854, "entropy": 1.4781933539758914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.450426497093584, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.636008651798995, "policy_loss": -0.010269638804950451, "vf_loss": 4.643989284580978, "vf_explained_var": 0.3713629767692909, "kl": 0.01144503178140401, "entropy": 1.2827337329349822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 381.09000000000003, "episode_reward_min": 3.6999999999999655, "episode_reward_mean": 164.56606249633708, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1058.1786125122683, "predator_policy": 0.1903090154994291}, "policy_reward_max": {"prey_policy": 192.52996921898705, "predator_policy": 1111.9827249792925}, "policy_reward_mean": {"prey_policy": 40.08254614596286, "predator_policy": 42.200485102205676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.06036669011525, 22.188694431957728, 43.243919999621575, 32.531145184533734, 140.15566298739535, 158.40727205897784, 37.06637400119699, 47.133205036622016, 131.57306395113906, 25.62911159854722, 107.3168386143342, 168.7663244812935, 70.50915914822274, 91.36048300907022, 160.04072513602225, 31.756961909767817, 67.27036339322696, 108.57870173599943, 103.0389703450133, 131.35089651194932, 200.0246990938332, 300.078780730361, 67.40305605378566, 77.80438486181386, 111.98000000000026, 57.003281272046195, 283.414338138938, 36.731932794157174, 132.29529089489438, 180.3180762684612, 3.6999999999999655, 109.92034416897846, 286.1479513858678, 58.05774906254798, 336.5035613122608, 17.80310795087608, 112.3187915585042, 34.569032168275044, 175.84999999999974, 12.49003686015795, 285.8974726232205, 165.2897684953954, 158.6924224753855, 320.99842016462384, 139.64088416737206, 142.8584045802878, 178.6572859545432, 166.10128610010275, 36.11807164221776, 270.1187387981829, 97.491736141566, 92.77783425289024, 311.8665301132406, 279.8624890877227, 177.2340121123071, 127.05654763205746, 349.3237964677198, 151.17000127043124, 334.42390666090205, 229.45024433107713, 89.0377032161561, 324.31, 255.00288575063593, 167.41099359434608, 117.07000000000038, 228.37986321453778, 140.31421287885857, 183.2777706344915, 111.40983343904679, 88.09472374039314, 252.85635319346648, 292.82507519523404, 214.39000000000004, 259.90208728814366, 315.4658960143182, 195.7199999999997, 381.09000000000003, 152.9416564589435, 278.58471352553613, 26.38568616113285, 79.67002823536313, 159.5297901040698, 199.30881498383923, 109.70654274960074, 104.19676751226937, 327.6503090154993, 149.41999999999928, 239.99617309575376, 5.567306369576833, 288.2539998710364, 321.4027048271216, 205.0363303668197, 248.95734005998872, 270.63398740584796, 224.988191815658, 180.71972804819393, 253.7311010312103, 204.2721032611982, 112.61117619425283, 306.06189250915634], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.89555124600412, 35.33032368497057, -33.72193904419018, -102.90332999405894, -97.9803243166522, -30.11917067457096, 1.1578962703437603, -64.34589072973287, 29.704571144877907, -26.569872952481106, -126.38279993572806, 94.07175650265627, -98.69325762832915, -38.51793881387132, -29.51783601071808, -55.551449559830246, 7.5339601988409415, 74.84339328127247, -45.42754741579753, 2.0000000000000013, 64.90490775853164, -133.40813387379467, 60.40427287582172, -20.99082663469373, -111.43834704137247, -15.173334810769479, 42.87142831253266, 23.813107518247893, -11.208780341546799, 40.557627027411165, -63.87826719221756, -48.619593151419444, -51.66810158285384, -35.52748078882698, 72.2466030005941, -98.48789368457265, 27.181947859245632, -15.461281096871515, 105.36519105013792, -26.054091884346917, 64.54224772496201, 21.200608388600877, 149.21133499060068, 114.72352553887177, 8.037807752042262, -25.101407153946912, 22.473374706431834, -25.68348631531158, 1.0962995614850088, 79.6435408922829, -37.01487088255488, -65.62205955146997, 110.31486418551034, 136.53584305424897, -1.9112219741803453, -42.48449437287631, 89.49485039884667, 0.07797554779573625, 37.3297358349574, 54.21886908989832, 0.9143327569886132, -4.3205068651748775, 0.166052801235339, 50.934727679148764, 64.64035204865327, 152.29141079374904, 28.4322641420161, -5.98084560549838, 140.50545003365426, 175.71177922312305, -10.497127228351884, -27.40747486208365, 21.047147174730334, -1058.1786125122683, -81.32451215847685, -21.62029778855453, -2.7115184500086515, 167.91852393883042, -70.63458529958642, -11.651001987280177, 84.33361712618145, 129.14686002677712, 155.00062080571632, -11.19763685029812, 77.98476340255839, 24.310266789065302, 169.3960387255471, 120.70147870291137, 54.30908404886215, 9.954963749540974, 29.328477927174255, 21.467497190387824, 54.3787769501988, 76.26286943313893, 148.7801688971019, -5.101914129177952, -29.58379507161331, -470.5387196700928, 162.4122232181399, 63.31323527427212, -22.191964659333834, -22.125455270222574, 62.29575427957897, -12.269579911597154, 163.93358414374546, 129.1632006506461, 153.97691354683616, 90.4676891834997, 11.857760538343886, 53.3278149909132, -8.057448100258611, 94.46991168373499, 178.47200577394864, 148.44715836142774, 0.4766320260412513, 70.73907894433427, 158.29152186568854, 135.06745596554913, 108.11027422288952, 86.52808304452259, -12.636849255243703, 2.6584547275073263, 149.55567475565664, 164.03110848876963, -10.475145867286649, 187.04143179477006, 43.87150469567902, 18.92335609893397, 1.7787352176480502, 81.51888894419244, 81.67014337924256, 79.33766238384908, -17.424953521205882, 9.782241269754236, 166.34087220864484, 2.0000000000000013, 78.62079281564884, -0.1048305405290371, -17.453731242867622, 45.93092331459645, 82.76551438968846, 134.37744316869612, 111.37215050660053, 150.67604095967144, 140.59208506213116, 58.83944993228525, 132.67128723699807, 60.47001800623056, 163.8834941937324, 138.31213284323385, -7.2632624370862935, 192.52996921898705, 190.55440046881287, 188.6858642855201, 94.48881942384759, 7.089591418363607, 123.86137173996059, 124.83351991930112, -46.36507441038532, -46.72939267170423, -2.97645175951608, 25.02810836109561, 65.02874428618621, 31.15749602016004, 95.96620131027396, 56.45029415061946, 35.14535904836418, 2.0000000000000013, -16.181049366722817, 78.89573029185051, 165.1155770943969, 154.45999999999992, 145.9679466778492, 1.4396964810397326, 103.42068079444091, 101.98775331110507, 2.0000000000000013, -1.810691124411686, 155.93402770368695, 93.77315750641374, 121.334399545446, 179.3531544099755, 52.59035647002378, 90.30163216733852, 76.16837667024781, 127.39583856637356, 78.62794825346994, 145.71042689880096, 44.11270155909925, 143.28028429528376, 86.24507047388721, 21.750577630672314, 99.77541130921927, 90.83925431592705, 67.3544414093435, 108.54641953819649, 35.0467350136787, -27.616124873606136, 164.21600955170737, 126.65992312005595], "policy_predator_policy_reward": [106.1370375205246, 65.48855673062418, 108.20324075392958, 50.61072271627696, 92.27290520991852, 79.0705097809263, 34.99887246003497, 60.72026718388786, 70.59330511373673, 66.42765968126182, 94.32114495318164, 96.39717053886801, 75.3474248508426, 98.93014559255502, 86.35863636267118, 45.843854244499276, 25.03004203497184, 24.165668436053757, 26.120000697550104, 42.93665831679428, 46.308468395064224, 129.51159633453292, 71.98673576024811, 57.36614247991761, 77.67850062772973, 119.44234037263483, 21.348135131646977, 3.3278120466417676, 81.01697160980608, 49.674906840351866, 70.86502095551249, 73.38980129789199, 57.31181040562867, 97.15413535927894, 40.42019926019277, 94.39979315978526, 37.59641919464741, 53.721884387991615, 33.76353022654351, 18.276267119614527, 60.98388023939638, 53.29796274087392, 16.70031992625164, 19.44360027463692, 42.22035244443601, 42.24630301125452, 42.85570191030779, 38.15879456038592, 30.37645910771713, 0.8637004385149925, 76.94950149349876, 82.69071021257237, 14.847963701990725, 21.71566719718793, 72.90409233290963, 8.223556808304155, 26.667271430793004, 16.05519351745883, 21.039425434378515, 67.73004590922706, 2.1245556335282156, 4.981618474658013, 14.65439427889154, 44.16516940970191, 30.45475864012771, 38.76142990333784, 14.157212956212136, 21.44911756981878, 5.067205480417156, 15.219126575066442, 22.375484677080536, 33.332225364230915, 1111.9827249792925, 37.46753191674933, 54.860682228808024, 82.65315988649813, 6.579145659781161, 4.063848851397056, 69.00992149987223, 25.76570264715261, 14.16070145415373, 58.25629401610827, 13.464436620453325, 8.022347919523934, 43.60043271923861, 12.796959564523181, 21.18982371709619, 9.711079019069322, 51.40487819131766, 23.971958177651246, 53.66381513124756, 38.3986143314781, 9.07712699642044, 38.938512574785165, 7.806234492672767, 14.616796839506087, 523.4710887311957, 12.769497652727841, 30.32574462785097, 14.06753567791982, 110.84734454986375, 30.96181152125869, 24.940798032076867, 17.810861852831426, 12.011595276759376, 6.7581500420897065, 14.353131250515924, 21.064755106870624, 50.68644048686459, 61.36199609618542, 16.391432665899625, 24.252651382680945, 11.266915570654831, 11.137716761688562, 18.631440545735888, 61.32284975431988, 28.900119902130495, 12.164808927533903, 27.395465232282305, 7.416421831382679, 66.15083095079055, 32.86526679310183, 5.383213797643234, 5.340002957930475, 12.863323870914652, 65.57327595223781, 58.31909227162595, 46.29704052810716, 8.863888399153435, 24.90848743900612, 27.863158009899024, 39.50889944154713, 65.91709161961847, 82.0398335106919, 9.484415110299825, 5.452483315547066, 19.47403281933284, 13.419838344593936, 36.521740958121576, 23.095790710542964, 2.831378570533136, 32.882017064548734, 19.355279932135065, 11.421603796827332, 13.655998020041034, 1.302466985542537, 37.51332380130663, 29.24745824360848, 7.4242922771756055, 5.845976700176604, 8.983262437086257, 1.4700307810129378, 0.4041357144799014, 1.4455995311871115, 6.455189448644682, 44.90805616808751, 5.536128486018846, 24.353693380255404, 57.892610259100564, 61.58754298412184, 24.775224283593378, 32.84314735019015, 49.07430841599744, 14.269241381726179, 3.675406043655463, 43.21691347929027, 48.34752513157406, 24.21365856966216, 16.26375223253972, 25.218334354602003, 7.884422905603084, 0.1903090154994291, 1.4312684355716567, 0.5810884055390217, 21.09398601361577, 13.493752976592358, 1.7073063695769086, 3.6706911244116505, 27.821253420410898, 10.725561240525035, 5.589255426660301, 15.125895445039907, 13.947671841480018, 48.19666988797748, 23.03034498742577, 22.36277983594155, 35.93311865741785, 10.362493596159258, 16.71814307774411, 20.87706288353121, 65.95387288216966, 6.770207061464805, 27.57325945715263, 35.54317594891133, 5.816175151814917, 22.5550671618433, 61.763574278548454, 43.41699177563178, 14.05700125163274, 1.1289585857602167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5220671868824381, "mean_inference_ms": 1.326332777647014, "mean_action_processing_ms": 0.2169241314026481, "mean_env_wait_ms": 0.17778011610055167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003610849380493164, "StateBufferConnector_ms": 0.003098011016845703, "ViewRequirementAgentConnector_ms": 0.09225523471832275}, "num_episodes": 18, "episode_return_max": 381.09000000000003, "episode_return_min": 3.6999999999999655, "episode_return_mean": 164.56606249633708, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.19852013303904, "num_env_steps_trained_throughput_per_sec": 385.19852013303904, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 9613.207, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9613.171, "sample_time_ms": 1061.015, "learn_time_ms": 8539.026, "learn_throughput": 468.437, "synch_weights_time_ms": 12.317}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "ef79f_00000", "date": "2024-08-16_11-18-59", "timestamp": 1723787339, "time_this_iter_s": 10.391134977340698, "time_total_s": 116.48370742797852, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32140f040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.48370742797852, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 26.60666666666667, "ram_util_percent": 80.54666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1247332952956044, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.207569341810922, "policy_loss": -0.0051223720670258875, "vf_loss": 9.211218654289448, "vf_explained_var": -0.023163368651475856, "kl": 0.007365377611461101, "entropy": 1.4716037239977922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.609430304532329, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.951506063673231, "policy_loss": -0.012302751845566841, "vf_loss": 5.96111343096173, "vf_explained_var": 0.1864580581427882, "kl": 0.013476858281466868, "entropy": 1.2963783570067593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 381.09000000000003, "episode_reward_min": 3.0376367964456135, "episode_reward_mean": 179.441610863742, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1058.1786125122683, "predator_policy": 0.1903090154994291}, "policy_reward_max": {"prey_policy": 193.0228440441304, "predator_policy": 1111.9827249792925}, "policy_reward_mean": {"prey_policy": 53.694206086651555, "predator_policy": 36.026599345219445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.0389703450133, 131.35089651194932, 200.0246990938332, 300.078780730361, 67.40305605378566, 77.80438486181386, 111.98000000000026, 57.003281272046195, 283.414338138938, 36.731932794157174, 132.29529089489438, 180.3180762684612, 3.6999999999999655, 109.92034416897846, 286.1479513858678, 58.05774906254798, 336.5035613122608, 17.80310795087608, 112.3187915585042, 34.569032168275044, 175.84999999999974, 12.49003686015795, 285.8974726232205, 165.2897684953954, 158.6924224753855, 320.99842016462384, 139.64088416737206, 142.8584045802878, 178.6572859545432, 166.10128610010275, 36.11807164221776, 270.1187387981829, 97.491736141566, 92.77783425289024, 311.8665301132406, 279.8624890877227, 177.2340121123071, 127.05654763205746, 349.3237964677198, 151.17000127043124, 334.42390666090205, 229.45024433107713, 89.0377032161561, 324.31, 255.00288575063593, 167.41099359434608, 117.07000000000038, 228.37986321453778, 140.31421287885857, 183.2777706344915, 111.40983343904679, 88.09472374039314, 252.85635319346648, 292.82507519523404, 214.39000000000004, 259.90208728814366, 315.4658960143182, 195.7199999999997, 381.09000000000003, 152.9416564589435, 278.58471352553613, 26.38568616113285, 79.67002823536313, 159.5297901040698, 199.30881498383923, 109.70654274960074, 104.19676751226937, 327.6503090154993, 149.41999999999928, 239.99617309575376, 5.567306369576833, 288.2539998710364, 321.4027048271216, 205.0363303668197, 248.95734005998872, 270.63398740584796, 224.988191815658, 180.71972804819393, 253.7311010312103, 204.2721032611982, 112.61117619425283, 306.06189250915634, 90.67130697932313, 362.18867830506036, 31.89819510494692, 79.58229736756728, 244.6759170285989, 304.02491313341847, 362.5047467913389, 218.7535409938474, 213.9933476271126, 3.0376367964456135, 77.74456338263715, 158.13431518298518, 128.07559132154557, 72.18539099555494, 192.00729937115716, 206.09321957321683, 266.8114388742174, 21.76081127956061], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [27.181947859245632, -15.461281096871515, 105.36519105013792, -26.054091884346917, 64.54224772496201, 21.200608388600877, 149.21133499060068, 114.72352553887177, 8.037807752042262, -25.101407153946912, 22.473374706431834, -25.68348631531158, 1.0962995614850088, 79.6435408922829, -37.01487088255488, -65.62205955146997, 110.31486418551034, 136.53584305424897, -1.9112219741803453, -42.48449437287631, 89.49485039884667, 0.07797554779573625, 37.3297358349574, 54.21886908989832, 0.9143327569886132, -4.3205068651748775, 0.166052801235339, 50.934727679148764, 64.64035204865327, 152.29141079374904, 28.4322641420161, -5.98084560549838, 140.50545003365426, 175.71177922312305, -10.497127228351884, -27.40747486208365, 21.047147174730334, -1058.1786125122683, -81.32451215847685, -21.62029778855453, -2.7115184500086515, 167.91852393883042, -70.63458529958642, -11.651001987280177, 84.33361712618145, 129.14686002677712, 155.00062080571632, -11.19763685029812, 77.98476340255839, 24.310266789065302, 169.3960387255471, 120.70147870291137, 54.30908404886215, 9.954963749540974, 29.328477927174255, 21.467497190387824, 54.3787769501988, 76.26286943313893, 148.7801688971019, -5.101914129177952, -29.58379507161331, -470.5387196700928, 162.4122232181399, 63.31323527427212, -22.191964659333834, -22.125455270222574, 62.29575427957897, -12.269579911597154, 163.93358414374546, 129.1632006506461, 153.97691354683616, 90.4676891834997, 11.857760538343886, 53.3278149909132, -8.057448100258611, 94.46991168373499, 178.47200577394864, 148.44715836142774, 0.4766320260412513, 70.73907894433427, 158.29152186568854, 135.06745596554913, 108.11027422288952, 86.52808304452259, -12.636849255243703, 2.6584547275073263, 149.55567475565664, 164.03110848876963, -10.475145867286649, 187.04143179477006, 43.87150469567902, 18.92335609893397, 1.7787352176480502, 81.51888894419244, 81.67014337924256, 79.33766238384908, -17.424953521205882, 9.782241269754236, 166.34087220864484, 2.0000000000000013, 78.62079281564884, -0.1048305405290371, -17.453731242867622, 45.93092331459645, 82.76551438968846, 134.37744316869612, 111.37215050660053, 150.67604095967144, 140.59208506213116, 58.83944993228525, 132.67128723699807, 60.47001800623056, 163.8834941937324, 138.31213284323385, -7.2632624370862935, 192.52996921898705, 190.55440046881287, 188.6858642855201, 94.48881942384759, 7.089591418363607, 123.86137173996059, 124.83351991930112, -46.36507441038532, -46.72939267170423, -2.97645175951608, 25.02810836109561, 65.02874428618621, 31.15749602016004, 95.96620131027396, 56.45029415061946, 35.14535904836418, 2.0000000000000013, -16.181049366722817, 78.89573029185051, 165.1155770943969, 154.45999999999992, 145.9679466778492, 1.4396964810397326, 103.42068079444091, 101.98775331110507, 2.0000000000000013, -1.810691124411686, 155.93402770368695, 93.77315750641374, 121.334399545446, 179.3531544099755, 52.59035647002378, 90.30163216733852, 76.16837667024781, 127.39583856637356, 78.62794825346994, 145.71042689880096, 44.11270155909925, 143.28028429528376, 86.24507047388721, 21.750577630672314, 99.77541130921927, 90.83925431592705, 67.3544414093435, 108.54641953819649, 35.0467350136787, -27.616124873606136, 164.21600955170737, 126.65992312005595, 32.60131858856687, 2.0000000000000013, 189.3130185411783, 169.56299173834964, -52.12228018072277, -33.748938913773145, 6.300621640263228, -51.96353434035274, 115.46503746728655, 118.27793115733049, 51.434949798121266, 151.39145768221385, 193.0228440441304, 160.60130971048778, 110.63621598043929, 66.79230152509143, 68.94378445169949, 117.13461221457409, -44.06679040674478, -94.29836688167885, -66.76300507109865, 12.024212553520247, 6.120071483343072, 81.489326484802, 71.5707149467408, -7.826983439537116, -27.69523046491888, 4.088727231224837, 15.441117586186989, 122.97864195528757, 117.54168644204938, 60.47818851238103, 86.76760873686817, 148.9227758148361, -27.625379427635387, -47.04678887070297], "policy_predator_policy_reward": [37.59641919464741, 53.721884387991615, 33.76353022654351, 18.276267119614527, 60.98388023939638, 53.29796274087392, 16.70031992625164, 19.44360027463692, 42.22035244443601, 42.24630301125452, 42.85570191030779, 38.15879456038592, 30.37645910771713, 0.8637004385149925, 76.94950149349876, 82.69071021257237, 14.847963701990725, 21.71566719718793, 72.90409233290963, 8.223556808304155, 26.667271430793004, 16.05519351745883, 21.039425434378515, 67.73004590922706, 2.1245556335282156, 4.981618474658013, 14.65439427889154, 44.16516940970191, 30.45475864012771, 38.76142990333784, 14.157212956212136, 21.44911756981878, 5.067205480417156, 15.219126575066442, 22.375484677080536, 33.332225364230915, 1111.9827249792925, 37.46753191674933, 54.860682228808024, 82.65315988649813, 6.579145659781161, 4.063848851397056, 69.00992149987223, 25.76570264715261, 14.16070145415373, 58.25629401610827, 13.464436620453325, 8.022347919523934, 43.60043271923861, 12.796959564523181, 21.18982371709619, 9.711079019069322, 51.40487819131766, 23.971958177651246, 53.66381513124756, 38.3986143314781, 9.07712699642044, 38.938512574785165, 7.806234492672767, 14.616796839506087, 523.4710887311957, 12.769497652727841, 30.32574462785097, 14.06753567791982, 110.84734454986375, 30.96181152125869, 24.940798032076867, 17.810861852831426, 12.011595276759376, 6.7581500420897065, 14.353131250515924, 21.064755106870624, 50.68644048686459, 61.36199609618542, 16.391432665899625, 24.252651382680945, 11.266915570654831, 11.137716761688562, 18.631440545735888, 61.32284975431988, 28.900119902130495, 12.164808927533903, 27.395465232282305, 7.416421831382679, 66.15083095079055, 32.86526679310183, 5.383213797643234, 5.340002957930475, 12.863323870914652, 65.57327595223781, 58.31909227162595, 46.29704052810716, 8.863888399153435, 24.90848743900612, 27.863158009899024, 39.50889944154713, 65.91709161961847, 82.0398335106919, 9.484415110299825, 5.452483315547066, 19.47403281933284, 13.419838344593936, 36.521740958121576, 23.095790710542964, 2.831378570533136, 32.882017064548734, 19.355279932135065, 11.421603796827332, 13.655998020041034, 1.302466985542537, 37.51332380130663, 29.24745824360848, 7.4242922771756055, 5.845976700176604, 8.983262437086257, 1.4700307810129378, 0.4041357144799014, 1.4455995311871115, 6.455189448644682, 44.90805616808751, 5.536128486018846, 24.353693380255404, 57.892610259100564, 61.58754298412184, 24.775224283593378, 32.84314735019015, 49.07430841599744, 14.269241381726179, 3.675406043655463, 43.21691347929027, 48.34752513157406, 24.21365856966216, 16.26375223253972, 25.218334354602003, 7.884422905603084, 0.1903090154994291, 1.4312684355716567, 0.5810884055390217, 21.09398601361577, 13.493752976592358, 1.7073063695769086, 3.6706911244116505, 27.821253420410898, 10.725561240525035, 5.589255426660301, 15.125895445039907, 13.947671841480018, 48.19666988797748, 23.03034498742577, 22.36277983594155, 35.93311865741785, 10.362493596159258, 16.71814307774411, 20.87706288353121, 65.95387288216966, 6.770207061464805, 27.57325945715263, 35.54317594891133, 5.816175151814917, 22.5550671618433, 61.763574278548454, 43.41699177563178, 14.05700125163274, 1.1289585857602167, 18.878679349489747, 37.191309041266365, 1.8618988768253089, 1.4507691487071115, 78.5639822341321, 39.20543196531077, 98.78283996220082, 26.462370105456024, 7.9533501095107155, 2.979598294471609, 80.07111991608949, 21.127385736994064, 3.5320662179039606, 5.348526818816671, 22.84569317888928, 18.47933030942783, 11.559517190061063, 16.355433770778053, 105.41311593544376, 35.98967814942557, 94.18070761883584, 38.302648281379724, 45.018254908777116, 25.506662306062985, 31.869256536035785, 32.462603278306176, 5.031666382813178, 90.76022784643577, 15.518981506341802, 38.06855832334083, 0.7997575663019043, 27.273587052484782, 20.377367171169563, 10.743687151343536, 32.22278189237746, 64.21019768552146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5215562918437356, "mean_inference_ms": 1.3383451460391456, "mean_action_processing_ms": 0.21727193246766752, "mean_env_wait_ms": 0.1774395663737218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035619735717773438, "StateBufferConnector_ms": 0.0030595064163208008, "ViewRequirementAgentConnector_ms": 0.09101927280426025}, "num_episodes": 18, "episode_return_max": 381.09000000000003, "episode_return_min": 3.0376367964456135, "episode_return_mean": 179.441610863742, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 403.1466806895923, "num_env_steps_trained_throughput_per_sec": 403.1466806895923, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 9606.61, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9606.577, "sample_time_ms": 1082.771, "learn_time_ms": 8510.673, "learn_throughput": 469.998, "synch_weights_time_ms": 12.392}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "ef79f_00000", "date": "2024-08-16_11-19-09", "timestamp": 1723787349, "time_this_iter_s": 9.926290035247803, "time_total_s": 126.40999746322632, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32140f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.40999746322632, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.25, "ram_util_percent": 80.37857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3101358259165727, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.8879742501274, "policy_loss": -0.00853329747471781, "vf_loss": 8.894082605271112, "vf_explained_var": -0.06518679444121306, "kl": 0.01212470479582821, "entropy": 1.4384975683121455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8292112514455483, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.376632651828585, "policy_loss": -0.00947037921829159, "vf_loss": 8.38361608162128, "vf_explained_var": 0.14310850103696188, "kl": 0.012434578077124418, "entropy": 1.3198601795252038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 381.09000000000003, "episode_reward_min": -26.202642859096844, "episode_reward_mean": 162.0209812111776, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -470.5387196700928, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.43032526456608, "predator_policy": 523.4710887311957}, "policy_reward_mean": {"prey_policy": 41.17071400021768, "predator_policy": 39.83977660537114}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.8584045802878, 178.6572859545432, 166.10128610010275, 36.11807164221776, 270.1187387981829, 97.491736141566, 92.77783425289024, 311.8665301132406, 279.8624890877227, 177.2340121123071, 127.05654763205746, 349.3237964677198, 151.17000127043124, 334.42390666090205, 229.45024433107713, 89.0377032161561, 324.31, 255.00288575063593, 167.41099359434608, 117.07000000000038, 228.37986321453778, 140.31421287885857, 183.2777706344915, 111.40983343904679, 88.09472374039314, 252.85635319346648, 292.82507519523404, 214.39000000000004, 259.90208728814366, 315.4658960143182, 195.7199999999997, 381.09000000000003, 152.9416564589435, 278.58471352553613, 26.38568616113285, 79.67002823536313, 159.5297901040698, 199.30881498383923, 109.70654274960074, 104.19676751226937, 327.6503090154993, 149.41999999999928, 239.99617309575376, 5.567306369576833, 288.2539998710364, 321.4027048271216, 205.0363303668197, 248.95734005998872, 270.63398740584796, 224.988191815658, 180.71972804819393, 253.7311010312103, 204.2721032611982, 112.61117619425283, 306.06189250915634, 90.67130697932313, 362.18867830506036, 31.89819510494692, 79.58229736756728, 244.6759170285989, 304.02491313341847, 362.5047467913389, 218.7535409938474, 213.9933476271126, 3.0376367964456135, 77.74456338263715, 158.13431518298518, 128.07559132154557, 72.18539099555494, 192.00729937115716, 206.09321957321683, 266.8114388742174, 21.76081127956061, 198.23559625101495, -22.697994319668194, 76.77937670831902, 197.39820185188452, 72.96886546316685, 34.05272773562076, 53.22125963164146, -5.723471218179216, 94.54742716447991, 20.697905378283185, -17.40592029267931, -4.8686417589238, 106.0780074908864, 17.58861009677706, 10.513520192953433, 347.9408603727344, 21.464376783262466, -26.202642859096844, 68.14936562846506, 62.45395832063131, -4.213016169281901, 249.69003038827756, 183.72213679241997, -4.542426095665086, 193.26651500715093, 92.6062148427359, 141.53944071507073], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [29.328477927174255, 21.467497190387824, 54.3787769501988, 76.26286943313893, 148.7801688971019, -5.101914129177952, -29.58379507161331, -470.5387196700928, 162.4122232181399, 63.31323527427212, -22.191964659333834, -22.125455270222574, 62.29575427957897, -12.269579911597154, 163.93358414374546, 129.1632006506461, 153.97691354683616, 90.4676891834997, 11.857760538343886, 53.3278149909132, -8.057448100258611, 94.46991168373499, 178.47200577394864, 148.44715836142774, 0.4766320260412513, 70.73907894433427, 158.29152186568854, 135.06745596554913, 108.11027422288952, 86.52808304452259, -12.636849255243703, 2.6584547275073263, 149.55567475565664, 164.03110848876963, -10.475145867286649, 187.04143179477006, 43.87150469567902, 18.92335609893397, 1.7787352176480502, 81.51888894419244, 81.67014337924256, 79.33766238384908, -17.424953521205882, 9.782241269754236, 166.34087220864484, 2.0000000000000013, 78.62079281564884, -0.1048305405290371, -17.453731242867622, 45.93092331459645, 82.76551438968846, 134.37744316869612, 111.37215050660053, 150.67604095967144, 140.59208506213116, 58.83944993228525, 132.67128723699807, 60.47001800623056, 163.8834941937324, 138.31213284323385, -7.2632624370862935, 192.52996921898705, 190.55440046881287, 188.6858642855201, 94.48881942384759, 7.089591418363607, 123.86137173996059, 124.83351991930112, -46.36507441038532, -46.72939267170423, -2.97645175951608, 25.02810836109561, 65.02874428618621, 31.15749602016004, 95.96620131027396, 56.45029415061946, 35.14535904836418, 2.0000000000000013, -16.181049366722817, 78.89573029185051, 165.1155770943969, 154.45999999999992, 145.9679466778492, 1.4396964810397326, 103.42068079444091, 101.98775331110507, 2.0000000000000013, -1.810691124411686, 155.93402770368695, 93.77315750641374, 121.334399545446, 179.3531544099755, 52.59035647002378, 90.30163216733852, 76.16837667024781, 127.39583856637356, 78.62794825346994, 145.71042689880096, 44.11270155909925, 143.28028429528376, 86.24507047388721, 21.750577630672314, 99.77541130921927, 90.83925431592705, 67.3544414093435, 108.54641953819649, 35.0467350136787, -27.616124873606136, 164.21600955170737, 126.65992312005595, 32.60131858856687, 2.0000000000000013, 189.3130185411783, 169.56299173834964, -52.12228018072277, -33.748938913773145, 6.300621640263228, -51.96353434035274, 115.46503746728655, 118.27793115733049, 51.434949798121266, 151.39145768221385, 193.0228440441304, 160.60130971048778, 110.63621598043929, 66.79230152509143, 68.94378445169949, 117.13461221457409, -44.06679040674478, -94.29836688167885, -66.76300507109865, 12.024212553520247, 6.120071483343072, 81.489326484802, 71.5707149467408, -7.826983439537116, -27.69523046491888, 4.088727231224837, 15.441117586186989, 122.97864195528757, 117.54168644204938, 60.47818851238103, 86.76760873686817, 148.9227758148361, -27.625379427635387, -47.04678887070297, 117.96526248140428, 59.70375746048714, -87.23288898862656, -109.0165728740847, -27.627323243903565, -94.93004372054081, 97.69306181188546, 16.64048132092395, -3.5459662874354425, -3.8254546171561508, -56.852590640286344, -76.8596309076254, -69.1877663445434, -36.73599507370313, -41.67126514477664, -94.45860951638042, -78.04688436701518, 16.3498132598289, -42.63479560955343, -44.2046336488064, -71.07158919692189, -105.28757392987708, -86.539225871653, -100.75211922829342, 10.954244304988512, 6.147600719439247, -104.41125075085397, -199.58649065519248, -116.37666710285791, -50.152949185494016, 194.43032526456608, 136.20796832103952, -71.41422777928096, -12.81742520083934, -109.98876644668043, -96.91410617460235, -35.67357537507634, 13.320368041310347, -10.235196606444385, -13.534948096200955, -87.80154335869787, -85.32350896085444, 112.41427234156195, 102.58814578997585, 56.02260861682479, 65.43776871430646, -122.93027994334263, -132.79707954963868, 2.437182836375996, 72.87405573178594, -90.21071101994245, 41.27632918322197, 34.58974684626112, 13.188962790287299], "policy_predator_policy_reward": [53.66381513124756, 38.3986143314781, 9.07712699642044, 38.938512574785165, 7.806234492672767, 14.616796839506087, 523.4710887311957, 12.769497652727841, 30.32574462785097, 14.06753567791982, 110.84734454986375, 30.96181152125869, 24.940798032076867, 17.810861852831426, 12.011595276759376, 6.7581500420897065, 14.353131250515924, 21.064755106870624, 50.68644048686459, 61.36199609618542, 16.391432665899625, 24.252651382680945, 11.266915570654831, 11.137716761688562, 18.631440545735888, 61.32284975431988, 28.900119902130495, 12.164808927533903, 27.395465232282305, 7.416421831382679, 66.15083095079055, 32.86526679310183, 5.383213797643234, 5.340002957930475, 12.863323870914652, 65.57327595223781, 58.31909227162595, 46.29704052810716, 8.863888399153435, 24.90848743900612, 27.863158009899024, 39.50889944154713, 65.91709161961847, 82.0398335106919, 9.484415110299825, 5.452483315547066, 19.47403281933284, 13.419838344593936, 36.521740958121576, 23.095790710542964, 2.831378570533136, 32.882017064548734, 19.355279932135065, 11.421603796827332, 13.655998020041034, 1.302466985542537, 37.51332380130663, 29.24745824360848, 7.4242922771756055, 5.845976700176604, 8.983262437086257, 1.4700307810129378, 0.4041357144799014, 1.4455995311871115, 6.455189448644682, 44.90805616808751, 5.536128486018846, 24.353693380255404, 57.892610259100564, 61.58754298412184, 24.775224283593378, 32.84314735019015, 49.07430841599744, 14.269241381726179, 3.675406043655463, 43.21691347929027, 48.34752513157406, 24.21365856966216, 16.26375223253972, 25.218334354602003, 7.884422905603084, 0.1903090154994291, 1.4312684355716567, 0.5810884055390217, 21.09398601361577, 13.493752976592358, 1.7073063695769086, 3.6706911244116505, 27.821253420410898, 10.725561240525035, 5.589255426660301, 15.125895445039907, 13.947671841480018, 48.19666988797748, 23.03034498742577, 22.36277983594155, 35.93311865741785, 10.362493596159258, 16.71814307774411, 20.87706288353121, 65.95387288216966, 6.770207061464805, 27.57325945715263, 35.54317594891133, 5.816175151814917, 22.5550671618433, 61.763574278548454, 43.41699177563178, 14.05700125163274, 1.1289585857602167, 18.878679349489747, 37.191309041266365, 1.8618988768253089, 1.4507691487071115, 78.5639822341321, 39.20543196531077, 98.78283996220082, 26.462370105456024, 7.9533501095107155, 2.979598294471609, 80.07111991608949, 21.127385736994064, 3.5320662179039606, 5.348526818816671, 22.84569317888928, 18.47933030942783, 11.559517190061063, 16.355433770778053, 105.41311593544376, 35.98967814942557, 94.18070761883584, 38.302648281379724, 45.018254908777116, 25.506662306062985, 31.869256536035785, 32.462603278306176, 5.031666382813178, 90.76022784643577, 15.518981506341802, 38.06855832334083, 0.7997575663019043, 27.273587052484782, 20.377367171169563, 10.743687151343536, 32.22278189237746, 64.21019768552146, 20.566576309123437, 0.0, 102.01158168511196, 71.53988585793124, 111.94586388967477, 87.3908797830887, 63.44305492541842, 19.621603793656647, 43.152763604356764, 37.18752276340157, 64.99695314710927, 102.7679961364232, 48.91144961321571, 110.23357143667216, 16.641779047542844, 113.76462439543495, 68.47812920258468, 87.76636906908142, 34.76584597349498, 72.77148866314799, 57.235372095401075, 101.71787073871855, 91.62542807365065, 90.79727526737193, 19.83159352304512, 69.14456894341359, 186.0740534347316, 135.51229806809178, 133.8112986646675, 43.23183781663792, 0.35053510816844125, 16.95203167896042, 37.045990668867105, 68.65003909451569, 111.04403911579101, 69.65619064639495, 69.09264846170994, 21.40992450052112, 54.54589747805804, 31.67820554521867, 61.77095792965963, 107.14107822061075, 20.204417074755167, 14.483195181984689, 33.27856320065508, 28.983196260633918, 146.1328055565175, 105.05212784079859, 83.46590764999523, 34.48936878899367, 85.07073329901965, 56.469863380436756, 34.57914523683755, 59.18158584168473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5203726668347881, "mean_inference_ms": 1.3607407549355586, "mean_action_processing_ms": 0.2178718325525338, "mean_env_wait_ms": 0.17740053369259443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036334991455078125, "StateBufferConnector_ms": 0.0031012296676635742, "ViewRequirementAgentConnector_ms": 0.09327638149261475}, "num_episodes": 27, "episode_return_max": 381.09000000000003, "episode_return_min": -26.202642859096844, "episode_return_mean": 162.0209812111776, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 404.2945811873408, "num_env_steps_trained_throughput_per_sec": 404.2945811873408, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 9646.549, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9646.517, "sample_time_ms": 1108.453, "learn_time_ms": 8524.916, "learn_throughput": 469.213, "synch_weights_time_ms": 12.441}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "ef79f_00000", "date": "2024-08-16_11-19-18", "timestamp": 1723787358, "time_this_iter_s": 9.898633003234863, "time_total_s": 136.30863046646118, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212ae310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.30863046646118, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.61428571428572, "ram_util_percent": 80.24285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2175630535713577, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.013777251722951, "policy_loss": -0.005719598635498966, "vf_loss": 9.017298054568982, "vf_explained_var": -0.038740049941199166, "kl": 0.010993993393567143, "entropy": 1.4480664859373102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.317347892062374, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.77151311465672, "policy_loss": -0.007066399062535277, "vf_loss": 8.776430742828934, "vf_explained_var": 0.11068242264803124, "kl": 0.010744042716608443, "entropy": 1.3568034145567152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 381.09000000000003, "episode_reward_min": -26.202642859096844, "episode_reward_mean": 134.04297027231564, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -199.58649065519248, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.43032526456608, "predator_policy": 186.0740534347316}, "policy_reward_mean": {"prey_policy": 19.27187943115765, "predator_policy": 47.749605705000185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.41099359434608, 117.07000000000038, 228.37986321453778, 140.31421287885857, 183.2777706344915, 111.40983343904679, 88.09472374039314, 252.85635319346648, 292.82507519523404, 214.39000000000004, 259.90208728814366, 315.4658960143182, 195.7199999999997, 381.09000000000003, 152.9416564589435, 278.58471352553613, 26.38568616113285, 79.67002823536313, 159.5297901040698, 199.30881498383923, 109.70654274960074, 104.19676751226937, 327.6503090154993, 149.41999999999928, 239.99617309575376, 5.567306369576833, 288.2539998710364, 321.4027048271216, 205.0363303668197, 248.95734005998872, 270.63398740584796, 224.988191815658, 180.71972804819393, 253.7311010312103, 204.2721032611982, 112.61117619425283, 306.06189250915634, 90.67130697932313, 362.18867830506036, 31.89819510494692, 79.58229736756728, 244.6759170285989, 304.02491313341847, 362.5047467913389, 218.7535409938474, 213.9933476271126, 3.0376367964456135, 77.74456338263715, 158.13431518298518, 128.07559132154557, 72.18539099555494, 192.00729937115716, 206.09321957321683, 266.8114388742174, 21.76081127956061, 198.23559625101495, -22.697994319668194, 76.77937670831902, 197.39820185188452, 72.96886546316685, 34.05272773562076, 53.22125963164146, -5.723471218179216, 94.54742716447991, 20.697905378283185, -17.40592029267931, -4.8686417589238, 106.0780074908864, 17.58861009677706, 10.513520192953433, 347.9408603727344, 21.464376783262466, -26.202642859096844, 68.14936562846506, 62.45395832063131, -4.213016169281901, 249.69003038827756, 183.72213679241997, -4.542426095665086, 193.26651500715093, 92.6062148427359, 141.53944071507073, 58.01619698751037, -16.262169951843433, 35.654562748761144, -2.6441446564764464, 134.0522626265244, -9.714376190527213, 20.556907603384428, 46.3042313228554, 73.34867002557014, -2.152062617439133, 3.252381160404039, 154.12129038078933, 44.95301859007042, -11.313954140104599, 65.858587085759, 63.296838054555195, 133.74403642055643, 23.988104775495195], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [43.87150469567902, 18.92335609893397, 1.7787352176480502, 81.51888894419244, 81.67014337924256, 79.33766238384908, -17.424953521205882, 9.782241269754236, 166.34087220864484, 2.0000000000000013, 78.62079281564884, -0.1048305405290371, -17.453731242867622, 45.93092331459645, 82.76551438968846, 134.37744316869612, 111.37215050660053, 150.67604095967144, 140.59208506213116, 58.83944993228525, 132.67128723699807, 60.47001800623056, 163.8834941937324, 138.31213284323385, -7.2632624370862935, 192.52996921898705, 190.55440046881287, 188.6858642855201, 94.48881942384759, 7.089591418363607, 123.86137173996059, 124.83351991930112, -46.36507441038532, -46.72939267170423, -2.97645175951608, 25.02810836109561, 65.02874428618621, 31.15749602016004, 95.96620131027396, 56.45029415061946, 35.14535904836418, 2.0000000000000013, -16.181049366722817, 78.89573029185051, 165.1155770943969, 154.45999999999992, 145.9679466778492, 1.4396964810397326, 103.42068079444091, 101.98775331110507, 2.0000000000000013, -1.810691124411686, 155.93402770368695, 93.77315750641374, 121.334399545446, 179.3531544099755, 52.59035647002378, 90.30163216733852, 76.16837667024781, 127.39583856637356, 78.62794825346994, 145.71042689880096, 44.11270155909925, 143.28028429528376, 86.24507047388721, 21.750577630672314, 99.77541130921927, 90.83925431592705, 67.3544414093435, 108.54641953819649, 35.0467350136787, -27.616124873606136, 164.21600955170737, 126.65992312005595, 32.60131858856687, 2.0000000000000013, 189.3130185411783, 169.56299173834964, -52.12228018072277, -33.748938913773145, 6.300621640263228, -51.96353434035274, 115.46503746728655, 118.27793115733049, 51.434949798121266, 151.39145768221385, 193.0228440441304, 160.60130971048778, 110.63621598043929, 66.79230152509143, 68.94378445169949, 117.13461221457409, -44.06679040674478, -94.29836688167885, -66.76300507109865, 12.024212553520247, 6.120071483343072, 81.489326484802, 71.5707149467408, -7.826983439537116, -27.69523046491888, 4.088727231224837, 15.441117586186989, 122.97864195528757, 117.54168644204938, 60.47818851238103, 86.76760873686817, 148.9227758148361, -27.625379427635387, -47.04678887070297, 117.96526248140428, 59.70375746048714, -87.23288898862656, -109.0165728740847, -27.627323243903565, -94.93004372054081, 97.69306181188546, 16.64048132092395, -3.5459662874354425, -3.8254546171561508, -56.852590640286344, -76.8596309076254, -69.1877663445434, -36.73599507370313, -41.67126514477664, -94.45860951638042, -78.04688436701518, 16.3498132598289, -42.63479560955343, -44.2046336488064, -71.07158919692189, -105.28757392987708, -86.539225871653, -100.75211922829342, 10.954244304988512, 6.147600719439247, -104.41125075085397, -199.58649065519248, -116.37666710285791, -50.152949185494016, 194.43032526456608, 136.20796832103952, -71.41422777928096, -12.81742520083934, -109.98876644668043, -96.91410617460235, -35.67357537507634, 13.320368041310347, -10.235196606444385, -13.534948096200955, -87.80154335869787, -85.32350896085444, 112.41427234156195, 102.58814578997585, 56.02260861682479, 65.43776871430646, -122.93027994334263, -132.79707954963868, 2.437182836375996, 72.87405573178594, -90.21071101994245, 41.27632918322197, 34.58974684626112, 13.188962790287299, -74.71378923037386, -16.7452231054455, -128.737055026141, -105.89790770905049, -57.91096423051858, -46.45793540489874, -78.57280783906081, -71.62182074408483, 26.642361706997203, -5.155934473031852, -86.18818560734303, -102.09956311635968, -81.79527340354399, -97.52221266699613, -30.56256538286153, -94.53016169490726, -142.5440516774165, -19.493814436933363, -132.27507476413228, -93.939932583119, -127.50392149178744, -132.92392988792852, 22.550845498142536, 7.508290805822821, 2.0000000000000013, -58.399939692035595, -111.979141990916, -98.6270000806529, -32.49544553093908, -21.19644487502558, -128.0170389347745, -38.74008606293295, 33.760002773865075, 11.940651133728746, -60.02677450087537, -95.62118364248484], "policy_predator_policy_reward": [58.31909227162595, 46.29704052810716, 8.863888399153435, 24.90848743900612, 27.863158009899024, 39.50889944154713, 65.91709161961847, 82.0398335106919, 9.484415110299825, 5.452483315547066, 19.47403281933284, 13.419838344593936, 36.521740958121576, 23.095790710542964, 2.831378570533136, 32.882017064548734, 19.355279932135065, 11.421603796827332, 13.655998020041034, 1.302466985542537, 37.51332380130663, 29.24745824360848, 7.4242922771756055, 5.845976700176604, 8.983262437086257, 1.4700307810129378, 0.4041357144799014, 1.4455995311871115, 6.455189448644682, 44.90805616808751, 5.536128486018846, 24.353693380255404, 57.892610259100564, 61.58754298412184, 24.775224283593378, 32.84314735019015, 49.07430841599744, 14.269241381726179, 3.675406043655463, 43.21691347929027, 48.34752513157406, 24.21365856966216, 16.26375223253972, 25.218334354602003, 7.884422905603084, 0.1903090154994291, 1.4312684355716567, 0.5810884055390217, 21.09398601361577, 13.493752976592358, 1.7073063695769086, 3.6706911244116505, 27.821253420410898, 10.725561240525035, 5.589255426660301, 15.125895445039907, 13.947671841480018, 48.19666988797748, 23.03034498742577, 22.36277983594155, 35.93311865741785, 10.362493596159258, 16.71814307774411, 20.87706288353121, 65.95387288216966, 6.770207061464805, 27.57325945715263, 35.54317594891133, 5.816175151814917, 22.5550671618433, 61.763574278548454, 43.41699177563178, 14.05700125163274, 1.1289585857602167, 18.878679349489747, 37.191309041266365, 1.8618988768253089, 1.4507691487071115, 78.5639822341321, 39.20543196531077, 98.78283996220082, 26.462370105456024, 7.9533501095107155, 2.979598294471609, 80.07111991608949, 21.127385736994064, 3.5320662179039606, 5.348526818816671, 22.84569317888928, 18.47933030942783, 11.559517190061063, 16.355433770778053, 105.41311593544376, 35.98967814942557, 94.18070761883584, 38.302648281379724, 45.018254908777116, 25.506662306062985, 31.869256536035785, 32.462603278306176, 5.031666382813178, 90.76022784643577, 15.518981506341802, 38.06855832334083, 0.7997575663019043, 27.273587052484782, 20.377367171169563, 10.743687151343536, 32.22278189237746, 64.21019768552146, 20.566576309123437, 0.0, 102.01158168511196, 71.53988585793124, 111.94586388967477, 87.3908797830887, 63.44305492541842, 19.621603793656647, 43.152763604356764, 37.18752276340157, 64.99695314710927, 102.7679961364232, 48.91144961321571, 110.23357143667216, 16.641779047542844, 113.76462439543495, 68.47812920258468, 87.76636906908142, 34.76584597349498, 72.77148866314799, 57.235372095401075, 101.71787073871855, 91.62542807365065, 90.79727526737193, 19.83159352304512, 69.14456894341359, 186.0740534347316, 135.51229806809178, 133.8112986646675, 43.23183781663792, 0.35053510816844125, 16.95203167896042, 37.045990668867105, 68.65003909451569, 111.04403911579101, 69.65619064639495, 69.09264846170994, 21.40992450052112, 54.54589747805804, 31.67820554521867, 61.77095792965963, 107.14107822061075, 20.204417074755167, 14.483195181984689, 33.27856320065508, 28.983196260633918, 146.1328055565175, 105.05212784079859, 83.46590764999523, 34.48936878899367, 85.07073329901965, 56.469863380436756, 34.57914523683755, 59.18158584168473, 74.23794098715933, 75.23726833617026, 78.99604483668963, 139.37674794665867, 111.217738635045, 28.80572374913349, 41.284092338110234, 106.26639158855897, 50.139773431622075, 62.42606196093674, 79.68151505354989, 98.89185747962557, 105.34809089324438, 94.52630278068018, 90.70788000637098, 80.68907839425314, 149.78499261377547, 85.60154352614447, 148.11613052706835, 75.94681420274381, 143.74477045578598, 119.93546208433409, 49.520511269074184, 74.54164280774994, 23.033743635568538, 78.31921464653746, 119.00734335746048, 80.2848445740039, 76.24521909805141, 43.30525839367206, 122.74282485066536, 107.31113820159736, 59.10774330781375, 28.93563920514887, 114.72804037982173, 64.9080225390336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5208263731358492, "mean_inference_ms": 1.3808337070711403, "mean_action_processing_ms": 0.21865908172892162, "mean_env_wait_ms": 0.17770184785273352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003625035285949707, "StateBufferConnector_ms": 0.0031446218490600586, "ViewRequirementAgentConnector_ms": 0.09411108493804932}, "num_episodes": 18, "episode_return_max": 381.09000000000003, "episode_return_min": -26.202642859096844, "episode_return_mean": 134.04297027231564, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.63629704723365, "num_env_steps_trained_throughput_per_sec": 396.63629704723365, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 9689.528, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9689.496, "sample_time_ms": 1125.8, "learn_time_ms": 8550.353, "learn_throughput": 467.817, "synch_weights_time_ms": 12.602}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "ef79f_00000", "date": "2024-08-16_11-19-29", "timestamp": 1723787369, "time_this_iter_s": 10.089653968811035, "time_total_s": 146.39828443527222, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212ae550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 146.39828443527222, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 28.400000000000006, "ram_util_percent": 80.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9432967881677012, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.332589592000165, "policy_loss": -0.007779032224296499, "vf_loss": 9.337691335324887, "vf_explained_var": -0.009871894310391139, "kl": 0.013386479449743104, "entropy": 1.4596054313674807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1579844648560518, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.79932623969184, "policy_loss": -0.005904376852971615, "vf_loss": 8.803469239340888, "vf_explained_var": 0.02969296823733698, "kl": 0.008806940420300453, "entropy": 1.3769416008676802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 362.5047467913389, "episode_reward_min": -30.25463160761035, "episode_reward_mean": 101.32629567830756, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -199.58649065519248, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.43032526456608, "predator_policy": 186.0740534347316}, "policy_reward_mean": {"prey_policy": -11.099342468379763, "predator_policy": 61.76249030753357}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.5297901040698, 199.30881498383923, 109.70654274960074, 104.19676751226937, 327.6503090154993, 149.41999999999928, 239.99617309575376, 5.567306369576833, 288.2539998710364, 321.4027048271216, 205.0363303668197, 248.95734005998872, 270.63398740584796, 224.988191815658, 180.71972804819393, 253.7311010312103, 204.2721032611982, 112.61117619425283, 306.06189250915634, 90.67130697932313, 362.18867830506036, 31.89819510494692, 79.58229736756728, 244.6759170285989, 304.02491313341847, 362.5047467913389, 218.7535409938474, 213.9933476271126, 3.0376367964456135, 77.74456338263715, 158.13431518298518, 128.07559132154557, 72.18539099555494, 192.00729937115716, 206.09321957321683, 266.8114388742174, 21.76081127956061, 198.23559625101495, -22.697994319668194, 76.77937670831902, 197.39820185188452, 72.96886546316685, 34.05272773562076, 53.22125963164146, -5.723471218179216, 94.54742716447991, 20.697905378283185, -17.40592029267931, -4.8686417589238, 106.0780074908864, 17.58861009677706, 10.513520192953433, 347.9408603727344, 21.464376783262466, -26.202642859096844, 68.14936562846506, 62.45395832063131, -4.213016169281901, 249.69003038827756, 183.72213679241997, -4.542426095665086, 193.26651500715093, 92.6062148427359, 141.53944071507073, 58.01619698751037, -16.262169951843433, 35.654562748761144, -2.6441446564764464, 134.0522626265244, -9.714376190527213, 20.556907603384428, 46.3042313228554, 73.34867002557014, -2.152062617439133, 3.252381160404039, 154.12129038078933, 44.95301859007042, -11.313954140104599, 65.858587085759, 63.296838054555195, 133.74403642055643, 23.988104775495195, -11.924059855418152, -23.863500823236144, 40.62814136872654, 37.815225696929915, -6.227954707989389, -13.474359713852847, 76.34803788457766, -16.332697248058583, 3.4730588361752472, 2.313534338693225, 106.2949247218002, 30.02967556648179, 6.508640729939128, 21.908455271551563, -30.25463160761035, -11.90647377634656, -16.19894313223563, 18.984360622877766], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [65.02874428618621, 31.15749602016004, 95.96620131027396, 56.45029415061946, 35.14535904836418, 2.0000000000000013, -16.181049366722817, 78.89573029185051, 165.1155770943969, 154.45999999999992, 145.9679466778492, 1.4396964810397326, 103.42068079444091, 101.98775331110507, 2.0000000000000013, -1.810691124411686, 155.93402770368695, 93.77315750641374, 121.334399545446, 179.3531544099755, 52.59035647002378, 90.30163216733852, 76.16837667024781, 127.39583856637356, 78.62794825346994, 145.71042689880096, 44.11270155909925, 143.28028429528376, 86.24507047388721, 21.750577630672314, 99.77541130921927, 90.83925431592705, 67.3544414093435, 108.54641953819649, 35.0467350136787, -27.616124873606136, 164.21600955170737, 126.65992312005595, 32.60131858856687, 2.0000000000000013, 189.3130185411783, 169.56299173834964, -52.12228018072277, -33.748938913773145, 6.300621640263228, -51.96353434035274, 115.46503746728655, 118.27793115733049, 51.434949798121266, 151.39145768221385, 193.0228440441304, 160.60130971048778, 110.63621598043929, 66.79230152509143, 68.94378445169949, 117.13461221457409, -44.06679040674478, -94.29836688167885, -66.76300507109865, 12.024212553520247, 6.120071483343072, 81.489326484802, 71.5707149467408, -7.826983439537116, -27.69523046491888, 4.088727231224837, 15.441117586186989, 122.97864195528757, 117.54168644204938, 60.47818851238103, 86.76760873686817, 148.9227758148361, -27.625379427635387, -47.04678887070297, 117.96526248140428, 59.70375746048714, -87.23288898862656, -109.0165728740847, -27.627323243903565, -94.93004372054081, 97.69306181188546, 16.64048132092395, -3.5459662874354425, -3.8254546171561508, -56.852590640286344, -76.8596309076254, -69.1877663445434, -36.73599507370313, -41.67126514477664, -94.45860951638042, -78.04688436701518, 16.3498132598289, -42.63479560955343, -44.2046336488064, -71.07158919692189, -105.28757392987708, -86.539225871653, -100.75211922829342, 10.954244304988512, 6.147600719439247, -104.41125075085397, -199.58649065519248, -116.37666710285791, -50.152949185494016, 194.43032526456608, 136.20796832103952, -71.41422777928096, -12.81742520083934, -109.98876644668043, -96.91410617460235, -35.67357537507634, 13.320368041310347, -10.235196606444385, -13.534948096200955, -87.80154335869787, -85.32350896085444, 112.41427234156195, 102.58814578997585, 56.02260861682479, 65.43776871430646, -122.93027994334263, -132.79707954963868, 2.437182836375996, 72.87405573178594, -90.21071101994245, 41.27632918322197, 34.58974684626112, 13.188962790287299, -74.71378923037386, -16.7452231054455, -128.737055026141, -105.89790770905049, -57.91096423051858, -46.45793540489874, -78.57280783906081, -71.62182074408483, 26.642361706997203, -5.155934473031852, -86.18818560734303, -102.09956311635968, -81.79527340354399, -97.52221266699613, -30.56256538286153, -94.53016169490726, -142.5440516774165, -19.493814436933363, -132.27507476413228, -93.939932583119, -127.50392149178744, -132.92392988792852, 22.550845498142536, 7.508290805822821, 2.0000000000000013, -58.399939692035595, -111.979141990916, -98.6270000806529, -32.49544553093908, -21.19644487502558, -128.0170389347745, -38.74008606293295, 33.760002773865075, 11.940651133728746, -60.02677450087537, -95.62118364248484, -97.67455688239987, -86.26533316759902, -120.18471876170301, -94.2397229544898, -151.24760944232315, -65.48654660621874, -103.27096764166347, -23.114597775065935, -101.90139655222897, -109.37791503295102, -108.99166559918275, -75.4850014116122, -59.842235806939065, -59.519995205808506, -108.02205208504617, -104.90106102380241, -121.97667729076672, -106.81318234082329, -105.11796682469884, -149.46112726413023, -66.42533891846381, -33.17292843744614, -135.3948354190219, -122.92131630765284, -69.51339269679443, -115.76646213093892, -31.34199661154434, -84.672294959263, -129.45478010464626, -84.67915555221185, -124.73912211728218, -97.04095587234099, -119.38134330880943, -156.1938442459152, -106.90176357322558, -51.26183510242091], "policy_predator_policy_reward": [49.07430841599744, 14.269241381726179, 3.675406043655463, 43.21691347929027, 48.34752513157406, 24.21365856966216, 16.26375223253972, 25.218334354602003, 7.884422905603084, 0.1903090154994291, 1.4312684355716567, 0.5810884055390217, 21.09398601361577, 13.493752976592358, 1.7073063695769086, 3.6706911244116505, 27.821253420410898, 10.725561240525035, 5.589255426660301, 15.125895445039907, 13.947671841480018, 48.19666988797748, 23.03034498742577, 22.36277983594155, 35.93311865741785, 10.362493596159258, 16.71814307774411, 20.87706288353121, 65.95387288216966, 6.770207061464805, 27.57325945715263, 35.54317594891133, 5.816175151814917, 22.5550671618433, 61.763574278548454, 43.41699177563178, 14.05700125163274, 1.1289585857602167, 18.878679349489747, 37.191309041266365, 1.8618988768253089, 1.4507691487071115, 78.5639822341321, 39.20543196531077, 98.78283996220082, 26.462370105456024, 7.9533501095107155, 2.979598294471609, 80.07111991608949, 21.127385736994064, 3.5320662179039606, 5.348526818816671, 22.84569317888928, 18.47933030942783, 11.559517190061063, 16.355433770778053, 105.41311593544376, 35.98967814942557, 94.18070761883584, 38.302648281379724, 45.018254908777116, 25.506662306062985, 31.869256536035785, 32.462603278306176, 5.031666382813178, 90.76022784643577, 15.518981506341802, 38.06855832334083, 0.7997575663019043, 27.273587052484782, 20.377367171169563, 10.743687151343536, 32.22278189237746, 64.21019768552146, 20.566576309123437, 0.0, 102.01158168511196, 71.53988585793124, 111.94586388967477, 87.3908797830887, 63.44305492541842, 19.621603793656647, 43.152763604356764, 37.18752276340157, 64.99695314710927, 102.7679961364232, 48.91144961321571, 110.23357143667216, 16.641779047542844, 113.76462439543495, 68.47812920258468, 87.76636906908142, 34.76584597349498, 72.77148866314799, 57.235372095401075, 101.71787073871855, 91.62542807365065, 90.79727526737193, 19.83159352304512, 69.14456894341359, 186.0740534347316, 135.51229806809178, 133.8112986646675, 43.23183781663792, 0.35053510816844125, 16.95203167896042, 37.045990668867105, 68.65003909451569, 111.04403911579101, 69.65619064639495, 69.09264846170994, 21.40992450052112, 54.54589747805804, 31.67820554521867, 61.77095792965963, 107.14107822061075, 20.204417074755167, 14.483195181984689, 33.27856320065508, 28.983196260633918, 146.1328055565175, 105.05212784079859, 83.46590764999523, 34.48936878899367, 85.07073329901965, 56.469863380436756, 34.57914523683755, 59.18158584168473, 74.23794098715933, 75.23726833617026, 78.99604483668963, 139.37674794665867, 111.217738635045, 28.80572374913349, 41.284092338110234, 106.26639158855897, 50.139773431622075, 62.42606196093674, 79.68151505354989, 98.89185747962557, 105.34809089324438, 94.52630278068018, 90.70788000637098, 80.68907839425314, 149.78499261377547, 85.60154352614447, 148.11613052706835, 75.94681420274381, 143.74477045578598, 119.93546208433409, 49.520511269074184, 74.54164280774994, 23.033743635568538, 78.31921464653746, 119.00734335746048, 80.2848445740039, 76.24521909805141, 43.30525839367206, 122.74282485066536, 107.31113820159736, 59.10774330781375, 28.93563920514887, 114.72804037982173, 64.9080225390336, 41.63116631395109, 130.38466388062966, 96.51134702984523, 94.04959386311157, 86.3762906339636, 170.98600678330493, 116.07736295376647, 48.12342815989298, 98.5863810535674, 106.46497582362319, 103.65281096645799, 67.34949633048413, 99.27108953964112, 96.43917935768408, 107.00212536670405, 89.58829049408595, 93.09746996795998, 139.16544849980522, 111.42732893964558, 145.46529948787648, 106.99859746259861, 98.89459461511147, 130.91751487100444, 157.42831242215232, 76.6698288654526, 115.11866669221983, 84.48785694883513, 53.434889893523696, 56.08981179193397, 127.78949225731391, 157.20306455233018, 52.67053966094649, 157.32992675651343, 102.0463176659756, 91.77038247590528, 85.37757682261892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5206746174414039, "mean_inference_ms": 1.4024901513652543, "mean_action_processing_ms": 0.21873531317168157, "mean_env_wait_ms": 0.17827499957266174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037059783935546875, "StateBufferConnector_ms": 0.003188610076904297, "ViewRequirementAgentConnector_ms": 0.08769834041595459}, "num_episodes": 18, "episode_return_max": 362.5047467913389, "episode_return_min": -30.25463160761035, "episode_return_mean": 101.32629567830756, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 396.10984858018276, "num_env_steps_trained_throughput_per_sec": 396.10984858018276, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 9753.554, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9753.521, "sample_time_ms": 1147.909, "learn_time_ms": 8592.136, "learn_throughput": 465.542, "synch_weights_time_ms": 12.676}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "ef79f_00000", "date": "2024-08-16_11-19-39", "timestamp": 1723787379, "time_this_iter_s": 10.1029372215271, "time_total_s": 156.50122165679932, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214371f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 156.50122165679932, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.478571428571435, "ram_util_percent": 80.20714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.022645412866401, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.994272686438586, "policy_loss": -0.0073394754519636824, "vf_loss": 8.999399402658776, "vf_explained_var": 0.045198501575560796, "kl": 0.011063685482783307, "entropy": 1.5045851327124096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0730489162225574, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.960836535156089, "policy_loss": -0.0023274567998236135, "vf_loss": 8.96106513139432, "vf_explained_var": 0.012389987896359157, "kl": 0.010494364916509223, "entropy": 1.352644530869035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 362.5047467913389, "episode_reward_min": -30.25463160761035, "episode_reward_mean": 69.64587316282942, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -210.96525239487306, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.43032526456608, "predator_policy": 186.0740534347316}, "policy_reward_mean": {"prey_policy": -42.79435304228472, "predator_policy": 77.61728962369943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.06189250915634, 90.67130697932313, 362.18867830506036, 31.89819510494692, 79.58229736756728, 244.6759170285989, 304.02491313341847, 362.5047467913389, 218.7535409938474, 213.9933476271126, 3.0376367964456135, 77.74456338263715, 158.13431518298518, 128.07559132154557, 72.18539099555494, 192.00729937115716, 206.09321957321683, 266.8114388742174, 21.76081127956061, 198.23559625101495, -22.697994319668194, 76.77937670831902, 197.39820185188452, 72.96886546316685, 34.05272773562076, 53.22125963164146, -5.723471218179216, 94.54742716447991, 20.697905378283185, -17.40592029267931, -4.8686417589238, 106.0780074908864, 17.58861009677706, 10.513520192953433, 347.9408603727344, 21.464376783262466, -26.202642859096844, 68.14936562846506, 62.45395832063131, -4.213016169281901, 249.69003038827756, 183.72213679241997, -4.542426095665086, 193.26651500715093, 92.6062148427359, 141.53944071507073, 58.01619698751037, -16.262169951843433, 35.654562748761144, -2.6441446564764464, 134.0522626265244, -9.714376190527213, 20.556907603384428, 46.3042313228554, 73.34867002557014, -2.152062617439133, 3.252381160404039, 154.12129038078933, 44.95301859007042, -11.313954140104599, 65.858587085759, 63.296838054555195, 133.74403642055643, 23.988104775495195, -11.924059855418152, -23.863500823236144, 40.62814136872654, 37.815225696929915, -6.227954707989389, -13.474359713852847, 76.34803788457766, -16.332697248058583, 3.4730588361752472, 2.313534338693225, 106.2949247218002, 30.02967556648179, 6.508640729939128, 21.908455271551563, -30.25463160761035, -11.90647377634656, -16.19894313223563, 18.984360622877766, 0.2965780698940287, 43.91173251665321, 40.887089253160035, 9.597804319503908, 2.6053247096748384, 34.82354956406396, 27.046940947018413, 11.066667889361195, 57.06582235520867, 55.292167772814764, 21.196248891528235, 22.53451990362665, -11.04630017875829, 57.90070283048712, -10.04706290284736, 45.72446483307622, 11.0710866043282, 18.012777785325675], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [164.21600955170737, 126.65992312005595, 32.60131858856687, 2.0000000000000013, 189.3130185411783, 169.56299173834964, -52.12228018072277, -33.748938913773145, 6.300621640263228, -51.96353434035274, 115.46503746728655, 118.27793115733049, 51.434949798121266, 151.39145768221385, 193.0228440441304, 160.60130971048778, 110.63621598043929, 66.79230152509143, 68.94378445169949, 117.13461221457409, -44.06679040674478, -94.29836688167885, -66.76300507109865, 12.024212553520247, 6.120071483343072, 81.489326484802, 71.5707149467408, -7.826983439537116, -27.69523046491888, 4.088727231224837, 15.441117586186989, 122.97864195528757, 117.54168644204938, 60.47818851238103, 86.76760873686817, 148.9227758148361, -27.625379427635387, -47.04678887070297, 117.96526248140428, 59.70375746048714, -87.23288898862656, -109.0165728740847, -27.627323243903565, -94.93004372054081, 97.69306181188546, 16.64048132092395, -3.5459662874354425, -3.8254546171561508, -56.852590640286344, -76.8596309076254, -69.1877663445434, -36.73599507370313, -41.67126514477664, -94.45860951638042, -78.04688436701518, 16.3498132598289, -42.63479560955343, -44.2046336488064, -71.07158919692189, -105.28757392987708, -86.539225871653, -100.75211922829342, 10.954244304988512, 6.147600719439247, -104.41125075085397, -199.58649065519248, -116.37666710285791, -50.152949185494016, 194.43032526456608, 136.20796832103952, -71.41422777928096, -12.81742520083934, -109.98876644668043, -96.91410617460235, -35.67357537507634, 13.320368041310347, -10.235196606444385, -13.534948096200955, -87.80154335869787, -85.32350896085444, 112.41427234156195, 102.58814578997585, 56.02260861682479, 65.43776871430646, -122.93027994334263, -132.79707954963868, 2.437182836375996, 72.87405573178594, -90.21071101994245, 41.27632918322197, 34.58974684626112, 13.188962790287299, -74.71378923037386, -16.7452231054455, -128.737055026141, -105.89790770905049, -57.91096423051858, -46.45793540489874, -78.57280783906081, -71.62182074408483, 26.642361706997203, -5.155934473031852, -86.18818560734303, -102.09956311635968, -81.79527340354399, -97.52221266699613, -30.56256538286153, -94.53016169490726, -142.5440516774165, -19.493814436933363, -132.27507476413228, -93.939932583119, -127.50392149178744, -132.92392988792852, 22.550845498142536, 7.508290805822821, 2.0000000000000013, -58.399939692035595, -111.979141990916, -98.6270000806529, -32.49544553093908, -21.19644487502558, -128.0170389347745, -38.74008606293295, 33.760002773865075, 11.940651133728746, -60.02677450087537, -95.62118364248484, -97.67455688239987, -86.26533316759902, -120.18471876170301, -94.2397229544898, -151.24760944232315, -65.48654660621874, -103.27096764166347, -23.114597775065935, -101.90139655222897, -109.37791503295102, -108.99166559918275, -75.4850014116122, -59.842235806939065, -59.519995205808506, -108.02205208504617, -104.90106102380241, -121.97667729076672, -106.81318234082329, -105.11796682469884, -149.46112726413023, -66.42533891846381, -33.17292843744614, -135.3948354190219, -122.92131630765284, -69.51339269679443, -115.76646213093892, -31.34199661154434, -84.672294959263, -129.45478010464626, -84.67915555221185, -124.73912211728218, -97.04095587234099, -119.38134330880943, -156.1938442459152, -106.90176357322558, -51.26183510242091, -210.96525239487306, -78.76466565116822, -70.76969825679882, -67.91508274978315, -89.60044356919884, -113.1362487411781, -63.322655751137205, -105.54688933505093, -68.13514234968197, -110.29097498994132, -50.936166295573244, -91.73747722504113, -110.29024799468243, -86.19023970049055, -72.25607910590509, -90.03213367346194, -91.72927649004129, -93.15729703756524, -27.82664800524574, -71.80053426505272, -77.36287664750475, -126.97150236538414, -112.39201076350606, -199.7702163440932, -113.52805169870629, -107.4756846862744, -34.27080399008705, -51.770970761794125, -148.02913124662192, -118.85274853706944, -151.94890950598696, -60.416500192418184, -81.15133115221745, -98.15799281000176, -127.60594511991448, -153.32645753891063], "policy_predator_policy_reward": [14.05700125163274, 1.1289585857602167, 18.878679349489747, 37.191309041266365, 1.8618988768253089, 1.4507691487071115, 78.5639822341321, 39.20543196531077, 98.78283996220082, 26.462370105456024, 7.9533501095107155, 2.979598294471609, 80.07111991608949, 21.127385736994064, 3.5320662179039606, 5.348526818816671, 22.84569317888928, 18.47933030942783, 11.559517190061063, 16.355433770778053, 105.41311593544376, 35.98967814942557, 94.18070761883584, 38.302648281379724, 45.018254908777116, 25.506662306062985, 31.869256536035785, 32.462603278306176, 5.031666382813178, 90.76022784643577, 15.518981506341802, 38.06855832334083, 0.7997575663019043, 27.273587052484782, 20.377367171169563, 10.743687151343536, 32.22278189237746, 64.21019768552146, 20.566576309123437, 0.0, 102.01158168511196, 71.53988585793124, 111.94586388967477, 87.3908797830887, 63.44305492541842, 19.621603793656647, 43.152763604356764, 37.18752276340157, 64.99695314710927, 102.7679961364232, 48.91144961321571, 110.23357143667216, 16.641779047542844, 113.76462439543495, 68.47812920258468, 87.76636906908142, 34.76584597349498, 72.77148866314799, 57.235372095401075, 101.71787073871855, 91.62542807365065, 90.79727526737193, 19.83159352304512, 69.14456894341359, 186.0740534347316, 135.51229806809178, 133.8112986646675, 43.23183781663792, 0.35053510816844125, 16.95203167896042, 37.045990668867105, 68.65003909451569, 111.04403911579101, 69.65619064639495, 69.09264846170994, 21.40992450052112, 54.54589747805804, 31.67820554521867, 61.77095792965963, 107.14107822061075, 20.204417074755167, 14.483195181984689, 33.27856320065508, 28.983196260633918, 146.1328055565175, 105.05212784079859, 83.46590764999523, 34.48936878899367, 85.07073329901965, 56.469863380436756, 34.57914523683755, 59.18158584168473, 74.23794098715933, 75.23726833617026, 78.99604483668963, 139.37674794665867, 111.217738635045, 28.80572374913349, 41.284092338110234, 106.26639158855897, 50.139773431622075, 62.42606196093674, 79.68151505354989, 98.89185747962557, 105.34809089324438, 94.52630278068018, 90.70788000637098, 80.68907839425314, 149.78499261377547, 85.60154352614447, 148.11613052706835, 75.94681420274381, 143.74477045578598, 119.93546208433409, 49.520511269074184, 74.54164280774994, 23.033743635568538, 78.31921464653746, 119.00734335746048, 80.2848445740039, 76.24521909805141, 43.30525839367206, 122.74282485066536, 107.31113820159736, 59.10774330781375, 28.93563920514887, 114.72804037982173, 64.9080225390336, 41.63116631395109, 130.38466388062966, 96.51134702984523, 94.04959386311157, 86.3762906339636, 170.98600678330493, 116.07736295376647, 48.12342815989298, 98.5863810535674, 106.46497582362319, 103.65281096645799, 67.34949633048413, 99.27108953964112, 96.43917935768408, 107.00212536670405, 89.58829049408595, 93.09746996795998, 139.16544849980522, 111.42732893964558, 145.46529948787648, 106.99859746259861, 98.89459461511147, 130.91751487100444, 157.42831242215232, 76.6698288654526, 115.11866669221983, 84.48785694883513, 53.434889893523696, 56.08981179193397, 127.78949225731391, 157.20306455233018, 52.67053966094649, 157.32992675651343, 102.0463176659756, 91.77038247590528, 85.37757682261892, 135.59279376466438, 154.4337023512712, 60.56398440890084, 122.03252911433421, 125.46895581772624, 118.15482574581077, 87.21508770496239, 91.25226170072966, 103.46514765604933, 77.56629439324901, 102.77004820584803, 74.72714487883029, 116.23432341312433, 107.2931052290673, 66.63328630827603, 106.72159436045216, 115.70835734526251, 126.24403853755302, 102.57687896529353, 52.34247107781979, 84.66357867827878, 140.86704922613842, 153.61216402979298, 181.08458298143324, 119.9107309581114, 90.04670524811101, 71.33338129923128, 72.60909628313705, 163.97791087388893, 92.85690600695536, 134.26855807244493, 123.82131645903654, 115.95023501852133, 74.43017554802591, 164.33829215046333, 134.60688829368743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5203491549146284, "mean_inference_ms": 1.4204136880241847, "mean_action_processing_ms": 0.21867686637274553, "mean_env_wait_ms": 0.17887287328635004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037459135055541992, "StateBufferConnector_ms": 0.003033757209777832, "ViewRequirementAgentConnector_ms": 0.08752870559692383}, "num_episodes": 18, "episode_return_max": 362.5047467913389, "episode_return_min": -30.25463160761035, "episode_return_mean": 69.64587316282942, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.1997432042982, "num_env_steps_trained_throughput_per_sec": 406.1997432042982, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 9800.521, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9800.489, "sample_time_ms": 1175.444, "learn_time_ms": 8611.708, "learn_throughput": 464.484, "synch_weights_time_ms": 12.528}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "ef79f_00000", "date": "2024-08-16_11-19-49", "timestamp": 1723787389, "time_this_iter_s": 9.851263999938965, "time_total_s": 166.35248565673828, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214561f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166.35248565673828, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.98571428571429, "ram_util_percent": 80.19285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5201465289428753, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.3096271252506, "policy_loss": -0.017278435165506034, "vf_loss": 8.323500484890408, "vf_explained_var": 0.19260303680858915, "kl": 0.017025365835911903, "entropy": 1.5165821405314894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.295842744307543, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.52048211299553, "policy_loss": -0.0027387513878272362, "vf_loss": 8.521646961080965, "vf_explained_var": 0.013901765132076525, "kl": 0.007869517690317362, "entropy": 1.3186497384278233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 347.9408603727344, "episode_reward_min": -30.25463160761035, "episode_reward_mean": 41.18302119176879, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -340.26779033777626, "predator_policy": 0.35053510816844125}, "policy_reward_max": {"prey_policy": 194.43032526456608, "predator_policy": 279.95709453763095}, "policy_reward_mean": {"prey_policy": -72.87958894299364, "predator_policy": 93.47109953887804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [197.39820185188452, 72.96886546316685, 34.05272773562076, 53.22125963164146, -5.723471218179216, 94.54742716447991, 20.697905378283185, -17.40592029267931, -4.8686417589238, 106.0780074908864, 17.58861009677706, 10.513520192953433, 347.9408603727344, 21.464376783262466, -26.202642859096844, 68.14936562846506, 62.45395832063131, -4.213016169281901, 249.69003038827756, 183.72213679241997, -4.542426095665086, 193.26651500715093, 92.6062148427359, 141.53944071507073, 58.01619698751037, -16.262169951843433, 35.654562748761144, -2.6441446564764464, 134.0522626265244, -9.714376190527213, 20.556907603384428, 46.3042313228554, 73.34867002557014, -2.152062617439133, 3.252381160404039, 154.12129038078933, 44.95301859007042, -11.313954140104599, 65.858587085759, 63.296838054555195, 133.74403642055643, 23.988104775495195, -11.924059855418152, -23.863500823236144, 40.62814136872654, 37.815225696929915, -6.227954707989389, -13.474359713852847, 76.34803788457766, -16.332697248058583, 3.4730588361752472, 2.313534338693225, 106.2949247218002, 30.02967556648179, 6.508640729939128, 21.908455271551563, -30.25463160761035, -11.90647377634656, -16.19894313223563, 18.984360622877766, 0.2965780698940287, 43.91173251665321, 40.887089253160035, 9.597804319503908, 2.6053247096748384, 34.82354956406396, 27.046940947018413, 11.066667889361195, 57.06582235520867, 55.292167772814764, 21.196248891528235, 22.53451990362665, -11.04630017875829, 57.90070283048712, -10.04706290284736, 45.72446483307622, 11.0710866043282, 18.012777785325675, 30.54952143045292, 30.711135490244896, 61.81723217476738, 62.49366630701235, 27.18058182047126, -0.46467653073372117, 43.348851452462235, 72.25991889549555, 25.136112133163657, 11.60355647543368, 11.237523330649049, 29.04150716734914, 20.30611660050062, 32.52081318684098, 17.83344516599348, 33.63241955541589, 56.452876485867, 108.24668338777613, 16.325976810468426, 19.26231499447266, 21.448709134970237, 15.292598682219495], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [97.69306181188546, 16.64048132092395, -3.5459662874354425, -3.8254546171561508, -56.852590640286344, -76.8596309076254, -69.1877663445434, -36.73599507370313, -41.67126514477664, -94.45860951638042, -78.04688436701518, 16.3498132598289, -42.63479560955343, -44.2046336488064, -71.07158919692189, -105.28757392987708, -86.539225871653, -100.75211922829342, 10.954244304988512, 6.147600719439247, -104.41125075085397, -199.58649065519248, -116.37666710285791, -50.152949185494016, 194.43032526456608, 136.20796832103952, -71.41422777928096, -12.81742520083934, -109.98876644668043, -96.91410617460235, -35.67357537507634, 13.320368041310347, -10.235196606444385, -13.534948096200955, -87.80154335869787, -85.32350896085444, 112.41427234156195, 102.58814578997585, 56.02260861682479, 65.43776871430646, -122.93027994334263, -132.79707954963868, 2.437182836375996, 72.87405573178594, -90.21071101994245, 41.27632918322197, 34.58974684626112, 13.188962790287299, -74.71378923037386, -16.7452231054455, -128.737055026141, -105.89790770905049, -57.91096423051858, -46.45793540489874, -78.57280783906081, -71.62182074408483, 26.642361706997203, -5.155934473031852, -86.18818560734303, -102.09956311635968, -81.79527340354399, -97.52221266699613, -30.56256538286153, -94.53016169490726, -142.5440516774165, -19.493814436933363, -132.27507476413228, -93.939932583119, -127.50392149178744, -132.92392988792852, 22.550845498142536, 7.508290805822821, 2.0000000000000013, -58.399939692035595, -111.979141990916, -98.6270000806529, -32.49544553093908, -21.19644487502558, -128.0170389347745, -38.74008606293295, 33.760002773865075, 11.940651133728746, -60.02677450087537, -95.62118364248484, -97.67455688239987, -86.26533316759902, -120.18471876170301, -94.2397229544898, -151.24760944232315, -65.48654660621874, -103.27096764166347, -23.114597775065935, -101.90139655222897, -109.37791503295102, -108.99166559918275, -75.4850014116122, -59.842235806939065, -59.519995205808506, -108.02205208504617, -104.90106102380241, -121.97667729076672, -106.81318234082329, -105.11796682469884, -149.46112726413023, -66.42533891846381, -33.17292843744614, -135.3948354190219, -122.92131630765284, -69.51339269679443, -115.76646213093892, -31.34199661154434, -84.672294959263, -129.45478010464626, -84.67915555221185, -124.73912211728218, -97.04095587234099, -119.38134330880943, -156.1938442459152, -106.90176357322558, -51.26183510242091, -210.96525239487306, -78.76466565116822, -70.76969825679882, -67.91508274978315, -89.60044356919884, -113.1362487411781, -63.322655751137205, -105.54688933505093, -68.13514234968197, -110.29097498994132, -50.936166295573244, -91.73747722504113, -110.29024799468243, -86.19023970049055, -72.25607910590509, -90.03213367346194, -91.72927649004129, -93.15729703756524, -27.82664800524574, -71.80053426505272, -77.36287664750475, -126.97150236538414, -112.39201076350606, -199.7702163440932, -113.52805169870629, -107.4756846862744, -34.27080399008705, -51.770970761794125, -148.02913124662192, -118.85274853706944, -151.94890950598696, -60.416500192418184, -81.15133115221745, -98.15799281000176, -127.60594511991448, -153.32645753891063, -165.98065794217126, -101.53159251269153, -14.804769142944368, -79.87827134769203, -64.9279849958396, -7.07350007261242, -63.43394217812679, -116.57701370538219, -92.2424144945947, -110.32937511702167, -213.07384703231787, -118.99191414238537, -27.037931984285255, -61.73987183871316, -11.853448919288404, -77.89414034405894, -39.13314593856669, -75.61665892726234, -169.68922406090243, -284.85158041412416, -78.80235225127701, -52.41140372779334, -45.23310801187165, -104.83878145828912, -86.66875229208829, -122.85368434436283, -63.26717541234345, -46.48362874157808, -30.789280121841493, -16.043548511391084, 0.24707969994238538, -60.07045783483854, -76.75620436458858, -132.71123288138696, -109.38583148263446, 17.35435934214546, -111.45905011469411, -340.26779033777626, -147.88662803055684, -152.10852575871942, -92.4390782506927, -148.86684669374813, -79.16572796574822, -61.99595340836174], "policy_predator_policy_reward": [63.44305492541842, 19.621603793656647, 43.152763604356764, 37.18752276340157, 64.99695314710927, 102.7679961364232, 48.91144961321571, 110.23357143667216, 16.641779047542844, 113.76462439543495, 68.47812920258468, 87.76636906908142, 34.76584597349498, 72.77148866314799, 57.235372095401075, 101.71787073871855, 91.62542807365065, 90.79727526737193, 19.83159352304512, 69.14456894341359, 186.0740534347316, 135.51229806809178, 133.8112986646675, 43.23183781663792, 0.35053510816844125, 16.95203167896042, 37.045990668867105, 68.65003909451569, 111.04403911579101, 69.65619064639495, 69.09264846170994, 21.40992450052112, 54.54589747805804, 31.67820554521867, 61.77095792965963, 107.14107822061075, 20.204417074755167, 14.483195181984689, 33.27856320065508, 28.983196260633918, 146.1328055565175, 105.05212784079859, 83.46590764999523, 34.48936878899367, 85.07073329901965, 56.469863380436756, 34.57914523683755, 59.18158584168473, 74.23794098715933, 75.23726833617026, 78.99604483668963, 139.37674794665867, 111.217738635045, 28.80572374913349, 41.284092338110234, 106.26639158855897, 50.139773431622075, 62.42606196093674, 79.68151505354989, 98.89185747962557, 105.34809089324438, 94.52630278068018, 90.70788000637098, 80.68907839425314, 149.78499261377547, 85.60154352614447, 148.11613052706835, 75.94681420274381, 143.74477045578598, 119.93546208433409, 49.520511269074184, 74.54164280774994, 23.033743635568538, 78.31921464653746, 119.00734335746048, 80.2848445740039, 76.24521909805141, 43.30525839367206, 122.74282485066536, 107.31113820159736, 59.10774330781375, 28.93563920514887, 114.72804037982173, 64.9080225390336, 41.63116631395109, 130.38466388062966, 96.51134702984523, 94.04959386311157, 86.3762906339636, 170.98600678330493, 116.07736295376647, 48.12342815989298, 98.5863810535674, 106.46497582362319, 103.65281096645799, 67.34949633048413, 99.27108953964112, 96.43917935768408, 107.00212536670405, 89.58829049408595, 93.09746996795998, 139.16544849980522, 111.42732893964558, 145.46529948787648, 106.99859746259861, 98.89459461511147, 130.91751487100444, 157.42831242215232, 76.6698288654526, 115.11866669221983, 84.48785694883513, 53.434889893523696, 56.08981179193397, 127.78949225731391, 157.20306455233018, 52.67053966094649, 157.32992675651343, 102.0463176659756, 91.77038247590528, 85.37757682261892, 135.59279376466438, 154.4337023512712, 60.56398440890084, 122.03252911433421, 125.46895581772624, 118.15482574581077, 87.21508770496239, 91.25226170072966, 103.46514765604933, 77.56629439324901, 102.77004820584803, 74.72714487883029, 116.23432341312433, 107.2931052290673, 66.63328630827603, 106.72159436045216, 115.70835734526251, 126.24403853755302, 102.57687896529353, 52.34247107781979, 84.66357867827878, 140.86704922613842, 153.61216402979298, 181.08458298143324, 119.9107309581114, 90.04670524811101, 71.33338129923128, 72.60909628313705, 163.97791087388893, 92.85690600695536, 134.26855807244493, 123.82131645903654, 115.95023501852133, 74.43017554802591, 164.33829215046333, 134.60688829368743, 135.8363591891927, 162.22541269612285, 88.19898287465641, 37.195193106224984, 52.927922767729534, 80.8907944754898, 114.45247432551112, 128.05214786501023, 107.37942557652651, 122.37294585556108, 149.32516510889081, 182.27591953507877, 49.87980726864835, 82.24684800681229, 76.3253048461932, 85.68220331264965, 74.3353983763369, 65.55051862265555, 218.46876049733487, 247.67560045312547, 60.204492287925596, 82.24678702179398, 94.31049274790531, 84.80290388960464, 118.25813637502567, 111.57041686192586, 56.56936834042891, 85.7022490003333, 31.113529504173222, 33.55274429505287, 43.6985752848485, 49.75722240546319, 140.6248309197258, 125.29548281211684, 124.49824268347436, 75.77991284479077, 279.95709453763095, 188.09572272530755, 169.83472650120302, 149.42274228254598, 138.4000177571655, 124.35461632224568, 86.02667746716968, 70.4276025891596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5196794525897824, "mean_inference_ms": 1.4407170272337624, "mean_action_processing_ms": 0.21854817539045507, "mean_env_wait_ms": 0.17959544184767928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038564205169677734, "StateBufferConnector_ms": 0.0030781030654907227, "ViewRequirementAgentConnector_ms": 0.08894896507263184}, "num_episodes": 22, "episode_return_max": 347.9408603727344, "episode_return_min": -30.25463160761035, "episode_return_mean": 41.18302119176879, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.5844075546658, "num_env_steps_trained_throughput_per_sec": 412.5844075546658, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 9825.733, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9825.7, "sample_time_ms": 1198.223, "learn_time_ms": 8613.921, "learn_throughput": 464.365, "synch_weights_time_ms": 12.759}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "ef79f_00000", "date": "2024-08-16_11-19-58", "timestamp": 1723787398, "time_this_iter_s": 9.700432062149048, "time_total_s": 176.05291771888733, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32144f940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176.05291771888733, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.357142857142858, "ram_util_percent": 80.15714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7270475285078484, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.324460392149668, "policy_loss": -0.009798321687177848, "vf_loss": 7.331822772000833, "vf_explained_var": -0.03027229558223139, "kl": 0.012179711695198325, "entropy": 1.4903451390367337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.515712399173666, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.9022794554473235, "policy_loss": -0.006543466308839107, "vf_loss": 7.90637614108898, "vf_explained_var": 0.017598706893819982, "kl": 0.01223391864283946, "entropy": 1.3109579899954418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 154.12129038078933, "episode_reward_min": -30.25463160761035, "episode_reward_mean": 32.63748443308128, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -340.26779033777626, "predator_policy": 12.529129016367937}, "policy_reward_max": {"prey_policy": 48.05576957013789, "predator_policy": 279.95709453763095}, "policy_reward_mean": {"prey_policy": -78.40843245523422, "predator_policy": 94.72717467177485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.53944071507073, 58.01619698751037, -16.262169951843433, 35.654562748761144, -2.6441446564764464, 134.0522626265244, -9.714376190527213, 20.556907603384428, 46.3042313228554, 73.34867002557014, -2.152062617439133, 3.252381160404039, 154.12129038078933, 44.95301859007042, -11.313954140104599, 65.858587085759, 63.296838054555195, 133.74403642055643, 23.988104775495195, -11.924059855418152, -23.863500823236144, 40.62814136872654, 37.815225696929915, -6.227954707989389, -13.474359713852847, 76.34803788457766, -16.332697248058583, 3.4730588361752472, 2.313534338693225, 106.2949247218002, 30.02967556648179, 6.508640729939128, 21.908455271551563, -30.25463160761035, -11.90647377634656, -16.19894313223563, 18.984360622877766, 0.2965780698940287, 43.91173251665321, 40.887089253160035, 9.597804319503908, 2.6053247096748384, 34.82354956406396, 27.046940947018413, 11.066667889361195, 57.06582235520867, 55.292167772814764, 21.196248891528235, 22.53451990362665, -11.04630017875829, 57.90070283048712, -10.04706290284736, 45.72446483307622, 11.0710866043282, 18.012777785325675, 30.54952143045292, 30.711135490244896, 61.81723217476738, 62.49366630701235, 27.18058182047126, -0.46467653073372117, 43.348851452462235, 72.25991889549555, 25.136112133163657, 11.60355647543368, 11.237523330649049, 29.04150716734914, 20.30611660050062, 32.52081318684098, 17.83344516599348, 33.63241955541589, 56.452876485867, 108.24668338777613, 16.325976810468426, 19.26231499447266, 21.448709134970237, 15.292598682219495, 1.1406411937003331, -17.10634763109787, 97.59767401584332, 5.6571351146448405, 66.53876486884933, 16.252049162735755, 45.89080714336129, 75.42959641128228, 5.908855109148882, 11.51229779612529, 47.90351171904673, 9.66332815418633, 97.46602284558247, 12.927397549063976, 104.28543368831907, 72.75826622241149, 61.72639342995854, 74.22567303819746, 62.95922574227699, 35.029739518435896, 33.605941256716, 1.1506075350292, -13.672825005023086], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [34.58974684626112, 13.188962790287299, -74.71378923037386, -16.7452231054455, -128.737055026141, -105.89790770905049, -57.91096423051858, -46.45793540489874, -78.57280783906081, -71.62182074408483, 26.642361706997203, -5.155934473031852, -86.18818560734303, -102.09956311635968, -81.79527340354399, -97.52221266699613, -30.56256538286153, -94.53016169490726, -142.5440516774165, -19.493814436933363, -132.27507476413228, -93.939932583119, -127.50392149178744, -132.92392988792852, 22.550845498142536, 7.508290805822821, 2.0000000000000013, -58.399939692035595, -111.979141990916, -98.6270000806529, -32.49544553093908, -21.19644487502558, -128.0170389347745, -38.74008606293295, 33.760002773865075, 11.940651133728746, -60.02677450087537, -95.62118364248484, -97.67455688239987, -86.26533316759902, -120.18471876170301, -94.2397229544898, -151.24760944232315, -65.48654660621874, -103.27096764166347, -23.114597775065935, -101.90139655222897, -109.37791503295102, -108.99166559918275, -75.4850014116122, -59.842235806939065, -59.519995205808506, -108.02205208504617, -104.90106102380241, -121.97667729076672, -106.81318234082329, -105.11796682469884, -149.46112726413023, -66.42533891846381, -33.17292843744614, -135.3948354190219, -122.92131630765284, -69.51339269679443, -115.76646213093892, -31.34199661154434, -84.672294959263, -129.45478010464626, -84.67915555221185, -124.73912211728218, -97.04095587234099, -119.38134330880943, -156.1938442459152, -106.90176357322558, -51.26183510242091, -210.96525239487306, -78.76466565116822, -70.76969825679882, -67.91508274978315, -89.60044356919884, -113.1362487411781, -63.322655751137205, -105.54688933505093, -68.13514234968197, -110.29097498994132, -50.936166295573244, -91.73747722504113, -110.29024799468243, -86.19023970049055, -72.25607910590509, -90.03213367346194, -91.72927649004129, -93.15729703756524, -27.82664800524574, -71.80053426505272, -77.36287664750475, -126.97150236538414, -112.39201076350606, -199.7702163440932, -113.52805169870629, -107.4756846862744, -34.27080399008705, -51.770970761794125, -148.02913124662192, -118.85274853706944, -151.94890950598696, -60.416500192418184, -81.15133115221745, -98.15799281000176, -127.60594511991448, -153.32645753891063, -165.98065794217126, -101.53159251269153, -14.804769142944368, -79.87827134769203, -64.9279849958396, -7.07350007261242, -63.43394217812679, -116.57701370538219, -92.2424144945947, -110.32937511702167, -213.07384703231787, -118.99191414238537, -27.037931984285255, -61.73987183871316, -11.853448919288404, -77.89414034405894, -39.13314593856669, -75.61665892726234, -169.68922406090243, -284.85158041412416, -78.80235225127701, -52.41140372779334, -45.23310801187165, -104.83878145828912, -86.66875229208829, -122.85368434436283, -63.26717541234345, -46.48362874157808, -30.789280121841493, -16.043548511391084, 0.24707969994238538, -60.07045783483854, -76.75620436458858, -132.71123288138696, -109.38583148263446, 17.35435934214546, -111.45905011469411, -340.26779033777626, -147.88662803055684, -152.10852575871942, -92.4390782506927, -148.86684669374813, -79.16572796574822, -61.99595340836174, -25.742680858252143, -22.763501820503386, -164.93674337490287, -202.6824541393402, -107.49060897062519, 28.652291216620366, -36.671732703740496, -13.743799957200412, 48.05576957013789, -22.497972042274544, -19.995034032795257, -31.061923350137, -17.54994419468338, -32.61586930879654, -4.217282590998284, -63.61965840384386, -105.79478858503212, -124.95753171753375, -22.95455533795829, -25.7722339842891, -13.854537313689784, -19.49684621442178, -31.143934077928666, -82.16971006406894, 41.73479498521752, -57.33053608074953, -38.6617865749674, -65.76445518976834, -153.52704572589886, 16.885842335380232, -71.62258471008825, 45.12094568144123, -75.20639592400656, -8.77303603480414, -20.816058253267748, -132.77667365936344, -6.543839141830958, 14.107036135881202, -213.4355074235365, -142.25070369650075, -167.63016174676287, -78.54281687951702, -40.53096599768204, -37.89622227237869, -71.21160878796799, -33.12024156267977], "policy_predator_policy_reward": [34.57914523683755, 59.18158584168473, 74.23794098715933, 75.23726833617026, 78.99604483668963, 139.37674794665867, 111.217738635045, 28.80572374913349, 41.284092338110234, 106.26639158855897, 50.139773431622075, 62.42606196093674, 79.68151505354989, 98.89185747962557, 105.34809089324438, 94.52630278068018, 90.70788000637098, 80.68907839425314, 149.78499261377547, 85.60154352614447, 148.11613052706835, 75.94681420274381, 143.74477045578598, 119.93546208433409, 49.520511269074184, 74.54164280774994, 23.033743635568538, 78.31921464653746, 119.00734335746048, 80.2848445740039, 76.24521909805141, 43.30525839367206, 122.74282485066536, 107.31113820159736, 59.10774330781375, 28.93563920514887, 114.72804037982173, 64.9080225390336, 41.63116631395109, 130.38466388062966, 96.51134702984523, 94.04959386311157, 86.3762906339636, 170.98600678330493, 116.07736295376647, 48.12342815989298, 98.5863810535674, 106.46497582362319, 103.65281096645799, 67.34949633048413, 99.27108953964112, 96.43917935768408, 107.00212536670405, 89.58829049408595, 93.09746996795998, 139.16544849980522, 111.42732893964558, 145.46529948787648, 106.99859746259861, 98.89459461511147, 130.91751487100444, 157.42831242215232, 76.6698288654526, 115.11866669221983, 84.48785694883513, 53.434889893523696, 56.08981179193397, 127.78949225731391, 157.20306455233018, 52.67053966094649, 157.32992675651343, 102.0463176659756, 91.77038247590528, 85.37757682261892, 135.59279376466438, 154.4337023512712, 60.56398440890084, 122.03252911433421, 125.46895581772624, 118.15482574581077, 87.21508770496239, 91.25226170072966, 103.46514765604933, 77.56629439324901, 102.77004820584803, 74.72714487883029, 116.23432341312433, 107.2931052290673, 66.63328630827603, 106.72159436045216, 115.70835734526251, 126.24403853755302, 102.57687896529353, 52.34247107781979, 84.66357867827878, 140.86704922613842, 153.61216402979298, 181.08458298143324, 119.9107309581114, 90.04670524811101, 71.33338129923128, 72.60909628313705, 163.97791087388893, 92.85690600695536, 134.26855807244493, 123.82131645903654, 115.95023501852133, 74.43017554802591, 164.33829215046333, 134.60688829368743, 135.8363591891927, 162.22541269612285, 88.19898287465641, 37.195193106224984, 52.927922767729534, 80.8907944754898, 114.45247432551112, 128.05214786501023, 107.37942557652651, 122.37294585556108, 149.32516510889081, 182.27591953507877, 49.87980726864835, 82.24684800681229, 76.3253048461932, 85.68220331264965, 74.3353983763369, 65.55051862265555, 218.46876049733487, 247.67560045312547, 60.204492287925596, 82.24678702179398, 94.31049274790531, 84.80290388960464, 118.25813637502567, 111.57041686192586, 56.56936834042891, 85.7022490003333, 31.113529504173222, 33.55274429505287, 43.6985752848485, 49.75722240546319, 140.6248309197258, 125.29548281211684, 124.49824268347436, 75.77991284479077, 279.95709453763095, 188.09572272530755, 169.83472650120302, 149.42274228254598, 138.4000177571655, 124.35461632224568, 86.02667746716968, 70.4276025891596, 30.815467195724246, 18.831356676732046, 202.80451709878542, 147.7083327843601, 78.66777427404935, 97.76821749579877, 12.529129016367937, 43.54353875921775, 24.772160381592077, 16.20880695939282, 36.12098029465698, 31.188026251011284, 67.10207515525667, 28.95454549158471, 73.23245389373676, 70.03408351238737, 126.69890150021874, 109.96227391149607, 33.543038358777146, 26.69604875959554, 45.204987447094744, 36.04990780006383, 35.22934503762919, 87.7476272585546, 47.74571217161996, 65.31605176949346, 79.49153411859828, 37.862105195201686, 135.8493748392284, 105.07726223960907, 19.94820750399087, 79.3116977470676, 74.98126789957989, 70.72455748918945, 117.31586236935263, 110.50254258147544, 35.576909913563846, 19.81911883466276, 214.49157300638655, 176.2243776320868, 105.9695240657049, 173.80939581729106, 35.52209321291359, 44.05570259217634, 63.27035005567351, 27.388675289951234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.520933990282389, "mean_inference_ms": 1.4586142644721056, "mean_action_processing_ms": 0.2189425681587063, "mean_env_wait_ms": 0.18063211200603368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038709640502929688, "StateBufferConnector_ms": 0.0031899213790893555, "ViewRequirementAgentConnector_ms": 0.09158062934875488}, "num_episodes": 23, "episode_return_max": 154.12129038078933, "episode_return_min": -30.25463160761035, "episode_return_mean": 32.63748443308128, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.3781057831351, "num_env_steps_trained_throughput_per_sec": 346.3781057831351, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 10037.033, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10037.0, "sample_time_ms": 1231.821, "learn_time_ms": 8791.315, "learn_throughput": 454.995, "synch_weights_time_ms": 13.074}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "ef79f_00000", "date": "2024-08-16_11-20-10", "timestamp": 1723787410, "time_this_iter_s": 11.55435299873352, "time_total_s": 187.60727071762085, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214b59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 187.60727071762085, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 35.12352941176471, "ram_util_percent": 79.58235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.32852607268505, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.416109609603882, "policy_loss": -0.006327097837335218, "vf_loss": 7.420985015233358, "vf_explained_var": -0.06300946748445904, "kl": 0.007258486446341201, "entropy": 1.5048312502563315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.489097936412014, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.164094158455178, "policy_loss": -0.0049391721975225854, "vf_loss": 8.166550444547461, "vf_explained_var": 0.08066848213710483, "kl": 0.012414423324128489, "entropy": 1.322199484847841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 110.27815604189753, "episode_reward_min": -40.10939940228738, "episode_reward_mean": 27.388821275198126, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -340.26779033777626, "predator_policy": 2.835006973933478}, "policy_reward_max": {"prey_policy": 48.05576957013789, "predator_policy": 279.95709453763095}, "policy_reward_mean": {"prey_policy": -78.75544183460286, "predator_policy": 92.44985247220191}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.988104775495195, -11.924059855418152, -23.863500823236144, 40.62814136872654, 37.815225696929915, -6.227954707989389, -13.474359713852847, 76.34803788457766, -16.332697248058583, 3.4730588361752472, 2.313534338693225, 106.2949247218002, 30.02967556648179, 6.508640729939128, 21.908455271551563, -30.25463160761035, -11.90647377634656, -16.19894313223563, 18.984360622877766, 0.2965780698940287, 43.91173251665321, 40.887089253160035, 9.597804319503908, 2.6053247096748384, 34.82354956406396, 27.046940947018413, 11.066667889361195, 57.06582235520867, 55.292167772814764, 21.196248891528235, 22.53451990362665, -11.04630017875829, 57.90070283048712, -10.04706290284736, 45.72446483307622, 11.0710866043282, 18.012777785325675, 30.54952143045292, 30.711135490244896, 61.81723217476738, 62.49366630701235, 27.18058182047126, -0.46467653073372117, 43.348851452462235, 72.25991889549555, 25.136112133163657, 11.60355647543368, 11.237523330649049, 29.04150716734914, 20.30611660050062, 32.52081318684098, 17.83344516599348, 33.63241955541589, 56.452876485867, 108.24668338777613, 16.325976810468426, 19.26231499447266, 21.448709134970237, 15.292598682219495, 1.1406411937003331, -17.10634763109787, 97.59767401584332, 5.6571351146448405, 66.53876486884933, 16.252049162735755, 45.89080714336129, 75.42959641128228, 5.908855109148882, 11.51229779612529, 47.90351171904673, 9.66332815418633, 97.46602284558247, 12.927397549063976, 104.28543368831907, 72.75826622241149, 61.72639342995854, 74.22567303819746, 62.95922574227699, 35.029739518435896, 33.605941256716, 1.1506075350292, -13.672825005023086, 17.078652506576343, -26.23769821354216, 8.747017425928188, 5.146645965158338, -27.637502215509937, 37.95212870745959, 53.543734704822754, 52.26737258238145, 110.27815604189753, -40.10939940228738, 36.22808745190649, 26.258702936698473, 38.608939559637534, 12.154776560505791, 78.83414655684429, 17.81902048020904, 1.867316898507242, 4.945301829911317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-60.02677450087537, -95.62118364248484, -97.67455688239987, -86.26533316759902, -120.18471876170301, -94.2397229544898, -151.24760944232315, -65.48654660621874, -103.27096764166347, -23.114597775065935, -101.90139655222897, -109.37791503295102, -108.99166559918275, -75.4850014116122, -59.842235806939065, -59.519995205808506, -108.02205208504617, -104.90106102380241, -121.97667729076672, -106.81318234082329, -105.11796682469884, -149.46112726413023, -66.42533891846381, -33.17292843744614, -135.3948354190219, -122.92131630765284, -69.51339269679443, -115.76646213093892, -31.34199661154434, -84.672294959263, -129.45478010464626, -84.67915555221185, -124.73912211728218, -97.04095587234099, -119.38134330880943, -156.1938442459152, -106.90176357322558, -51.26183510242091, -210.96525239487306, -78.76466565116822, -70.76969825679882, -67.91508274978315, -89.60044356919884, -113.1362487411781, -63.322655751137205, -105.54688933505093, -68.13514234968197, -110.29097498994132, -50.936166295573244, -91.73747722504113, -110.29024799468243, -86.19023970049055, -72.25607910590509, -90.03213367346194, -91.72927649004129, -93.15729703756524, -27.82664800524574, -71.80053426505272, -77.36287664750475, -126.97150236538414, -112.39201076350606, -199.7702163440932, -113.52805169870629, -107.4756846862744, -34.27080399008705, -51.770970761794125, -148.02913124662192, -118.85274853706944, -151.94890950598696, -60.416500192418184, -81.15133115221745, -98.15799281000176, -127.60594511991448, -153.32645753891063, -165.98065794217126, -101.53159251269153, -14.804769142944368, -79.87827134769203, -64.9279849958396, -7.07350007261242, -63.43394217812679, -116.57701370538219, -92.2424144945947, -110.32937511702167, -213.07384703231787, -118.99191414238537, -27.037931984285255, -61.73987183871316, -11.853448919288404, -77.89414034405894, -39.13314593856669, -75.61665892726234, -169.68922406090243, -284.85158041412416, -78.80235225127701, -52.41140372779334, -45.23310801187165, -104.83878145828912, -86.66875229208829, -122.85368434436283, -63.26717541234345, -46.48362874157808, -30.789280121841493, -16.043548511391084, 0.24707969994238538, -60.07045783483854, -76.75620436458858, -132.71123288138696, -109.38583148263446, 17.35435934214546, -111.45905011469411, -340.26779033777626, -147.88662803055684, -152.10852575871942, -92.4390782506927, -148.86684669374813, -79.16572796574822, -61.99595340836174, -25.742680858252143, -22.763501820503386, -164.93674337490287, -202.6824541393402, -107.49060897062519, 28.652291216620366, -36.671732703740496, -13.743799957200412, 48.05576957013789, -22.497972042274544, -19.995034032795257, -31.061923350137, -17.54994419468338, -32.61586930879654, -4.217282590998284, -63.61965840384386, -105.79478858503212, -124.95753171753375, -22.95455533795829, -25.7722339842891, -13.854537313689784, -19.49684621442178, -31.143934077928666, -82.16971006406894, 41.73479498521752, -57.33053608074953, -38.6617865749674, -65.76445518976834, -153.52704572589886, 16.885842335380232, -71.62258471008825, 45.12094568144123, -75.20639592400656, -8.77303603480414, -20.816058253267748, -132.77667365936344, -6.543839141830958, 14.107036135881202, -213.4355074235365, -142.25070369650075, -167.63016174676287, -78.54281687951702, -40.53096599768204, -37.89622227237869, -71.21160878796799, -33.12024156267977, -222.0421491340751, -1.35308396296266, -134.61469136822788, -77.63770053144756, -89.35514481929314, -69.86032891968074, -102.85470521637681, -70.37415500402032, -66.6889903050157, -140.95779728805775, -18.834962538717463, -20.621788893767512, -55.677982391660414, -0.9223665342775429, -59.08621953339345, -147.7883063742628, 17.234192701710775, -15.594569485072725, -99.6404065152121, -88.61227358287813, -69.86375377448068, -19.438475450035035, 3.3282264744973022, -18.802898963662035, -66.37752480373054, -46.02990490795187, -233.1045053167009, -7.793647672079683, -15.34436536362151, -105.70989881998962, -8.772713718320492, -34.2339642686652, -19.519676146265923, -25.56380789673298, 0.0647066015169565, -1.4226022389248918], "policy_predator_policy_reward": [114.72804037982173, 64.9080225390336, 41.63116631395109, 130.38466388062966, 96.51134702984523, 94.04959386311157, 86.3762906339636, 170.98600678330493, 116.07736295376647, 48.12342815989298, 98.5863810535674, 106.46497582362319, 103.65281096645799, 67.34949633048413, 99.27108953964112, 96.43917935768408, 107.00212536670405, 89.58829049408595, 93.09746996795998, 139.16544849980522, 111.42732893964558, 145.46529948787648, 106.99859746259861, 98.89459461511147, 130.91751487100444, 157.42831242215232, 76.6698288654526, 115.11866669221983, 84.48785694883513, 53.434889893523696, 56.08981179193397, 127.78949225731391, 157.20306455233018, 52.67053966094649, 157.32992675651343, 102.0463176659756, 91.77038247590528, 85.37757682261892, 135.59279376466438, 154.4337023512712, 60.56398440890084, 122.03252911433421, 125.46895581772624, 118.15482574581077, 87.21508770496239, 91.25226170072966, 103.46514765604933, 77.56629439324901, 102.77004820584803, 74.72714487883029, 116.23432341312433, 107.2931052290673, 66.63328630827603, 106.72159436045216, 115.70835734526251, 126.24403853755302, 102.57687896529353, 52.34247107781979, 84.66357867827878, 140.86704922613842, 153.61216402979298, 181.08458298143324, 119.9107309581114, 90.04670524811101, 71.33338129923128, 72.60909628313705, 163.97791087388893, 92.85690600695536, 134.26855807244493, 123.82131645903654, 115.95023501852133, 74.43017554802591, 164.33829215046333, 134.60688829368743, 135.8363591891927, 162.22541269612285, 88.19898287465641, 37.195193106224984, 52.927922767729534, 80.8907944754898, 114.45247432551112, 128.05214786501023, 107.37942557652651, 122.37294585556108, 149.32516510889081, 182.27591953507877, 49.87980726864835, 82.24684800681229, 76.3253048461932, 85.68220331264965, 74.3353983763369, 65.55051862265555, 218.46876049733487, 247.67560045312547, 60.204492287925596, 82.24678702179398, 94.31049274790531, 84.80290388960464, 118.25813637502567, 111.57041686192586, 56.56936834042891, 85.7022490003333, 31.113529504173222, 33.55274429505287, 43.6985752848485, 49.75722240546319, 140.6248309197258, 125.29548281211684, 124.49824268347436, 75.77991284479077, 279.95709453763095, 188.09572272530755, 169.83472650120302, 149.42274228254598, 138.4000177571655, 124.35461632224568, 86.02667746716968, 70.4276025891596, 30.815467195724246, 18.831356676732046, 202.80451709878542, 147.7083327843601, 78.66777427404935, 97.76821749579877, 12.529129016367937, 43.54353875921775, 24.772160381592077, 16.20880695939282, 36.12098029465698, 31.188026251011284, 67.10207515525667, 28.95454549158471, 73.23245389373676, 70.03408351238737, 126.69890150021874, 109.96227391149607, 33.543038358777146, 26.69604875959554, 45.204987447094744, 36.04990780006383, 35.22934503762919, 87.7476272585546, 47.74571217161996, 65.31605176949346, 79.49153411859828, 37.862105195201686, 135.8493748392284, 105.07726223960907, 19.94820750399087, 79.3116977470676, 74.98126789957989, 70.72455748918945, 117.31586236935263, 110.50254258147544, 35.576909913563846, 19.81911883466276, 214.49157300638655, 176.2243776320868, 105.9695240657049, 173.80939581729106, 35.52209321291359, 44.05570259217634, 63.27035005567351, 27.388675289951234, 230.6960156831675, 9.777869920446586, 3.577349941715902, 182.43734374441743, 88.763176908246, 79.19931425665611, 52.713444368672654, 125.66206181688287, 13.889986341076296, 166.11929903648712, 25.54221509442843, 51.866665045516214, 43.382483863771405, 66.76159976698916, 97.37040569938775, 161.77149279064986, 51.816130406840266, 56.8224024184185, 121.44498897583111, 26.698291719971632, 74.59869092836222, 50.93162574806014, 21.355929840309724, 20.377445585553197, 70.61975711808608, 80.39661215323372, 19.433763821324156, 233.61916572796216, 99.89524236018332, 99.99316838027202, 27.02522861811195, 33.80046984908242, 17.694989243541837, 29.255811697964766, 2.835006973933478, 3.4681904933858236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5215993214844689, "mean_inference_ms": 1.4722249726892032, "mean_action_processing_ms": 0.2192387089105545, "mean_env_wait_ms": 0.18131955785030815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00392913818359375, "StateBufferConnector_ms": 0.003247976303100586, "ViewRequirementAgentConnector_ms": 0.09250485897064209}, "num_episodes": 18, "episode_return_max": 110.27815604189753, "episode_return_min": -40.10939940228738, "episode_return_mean": 27.388821275198126, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.41978621736854, "num_env_steps_trained_throughput_per_sec": 383.41978621736854, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 10146.042, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10146.009, "sample_time_ms": 1259.307, "learn_time_ms": 8872.392, "learn_throughput": 450.837, "synch_weights_time_ms": 13.526}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "ef79f_00000", "date": "2024-08-16_11-20-20", "timestamp": 1723787420, "time_this_iter_s": 10.438374042510986, "time_total_s": 198.04564476013184, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32144f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 198.04564476013184, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 28.73333333333333, "ram_util_percent": 79.46000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.234455722223514, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.07391586253252, "policy_loss": -0.007835193238807497, "vf_loss": 8.079847777835907, "vf_explained_var": -0.04313102064940034, "kl": 0.009516362103158645, "entropy": 1.5217957939420428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5341860052769776, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.20624766223645, "policy_loss": -0.00940448242761983, "vf_loss": 8.212741399694371, "vf_explained_var": 0.13444064278451223, "kl": 0.014553761467495865, "entropy": 1.3644481590815953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 110.27815604189753, "episode_reward_min": -40.10939940228738, "episode_reward_mean": 30.5684611013884, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.31101828866747, "predator_policy": 2.835006973933478}, "policy_reward_max": {"prey_policy": 65.63910324449601, "predator_policy": 379.59665044429505}, "policy_reward_mean": {"prey_policy": -76.39498529627139, "predator_policy": 91.67921584696556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.984360622877766, 0.2965780698940287, 43.91173251665321, 40.887089253160035, 9.597804319503908, 2.6053247096748384, 34.82354956406396, 27.046940947018413, 11.066667889361195, 57.06582235520867, 55.292167772814764, 21.196248891528235, 22.53451990362665, -11.04630017875829, 57.90070283048712, -10.04706290284736, 45.72446483307622, 11.0710866043282, 18.012777785325675, 30.54952143045292, 30.711135490244896, 61.81723217476738, 62.49366630701235, 27.18058182047126, -0.46467653073372117, 43.348851452462235, 72.25991889549555, 25.136112133163657, 11.60355647543368, 11.237523330649049, 29.04150716734914, 20.30611660050062, 32.52081318684098, 17.83344516599348, 33.63241955541589, 56.452876485867, 108.24668338777613, 16.325976810468426, 19.26231499447266, 21.448709134970237, 15.292598682219495, 1.1406411937003331, -17.10634763109787, 97.59767401584332, 5.6571351146448405, 66.53876486884933, 16.252049162735755, 45.89080714336129, 75.42959641128228, 5.908855109148882, 11.51229779612529, 47.90351171904673, 9.66332815418633, 97.46602284558247, 12.927397549063976, 104.28543368831907, 72.75826622241149, 61.72639342995854, 74.22567303819746, 62.95922574227699, 35.029739518435896, 33.605941256716, 1.1506075350292, -13.672825005023086, 17.078652506576343, -26.23769821354216, 8.747017425928188, 5.146645965158338, -27.637502215509937, 37.95212870745959, 53.543734704822754, 52.26737258238145, 110.27815604189753, -40.10939940228738, 36.22808745190649, 26.258702936698473, 38.608939559637534, 12.154776560505791, 78.83414655684429, 17.81902048020904, 1.867316898507242, 4.945301829911317, -4.795644607797754, 34.963616897110285, 107.22511250080048, 29.378646844749507, 93.34043469035127, 23.257699786842718, 58.3182056642639, -14.575929882951677, -1.6567853740581575, -8.926702952360138, 29.20266234212025, 9.519437911797771, 46.357459779976246, 47.940950988561596, -14.312673054633455, 29.29718919072596, 60.02669684622102, 12.528783372930151], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-106.90176357322558, -51.26183510242091, -210.96525239487306, -78.76466565116822, -70.76969825679882, -67.91508274978315, -89.60044356919884, -113.1362487411781, -63.322655751137205, -105.54688933505093, -68.13514234968197, -110.29097498994132, -50.936166295573244, -91.73747722504113, -110.29024799468243, -86.19023970049055, -72.25607910590509, -90.03213367346194, -91.72927649004129, -93.15729703756524, -27.82664800524574, -71.80053426505272, -77.36287664750475, -126.97150236538414, -112.39201076350606, -199.7702163440932, -113.52805169870629, -107.4756846862744, -34.27080399008705, -51.770970761794125, -148.02913124662192, -118.85274853706944, -151.94890950598696, -60.416500192418184, -81.15133115221745, -98.15799281000176, -127.60594511991448, -153.32645753891063, -165.98065794217126, -101.53159251269153, -14.804769142944368, -79.87827134769203, -64.9279849958396, -7.07350007261242, -63.43394217812679, -116.57701370538219, -92.2424144945947, -110.32937511702167, -213.07384703231787, -118.99191414238537, -27.037931984285255, -61.73987183871316, -11.853448919288404, -77.89414034405894, -39.13314593856669, -75.61665892726234, -169.68922406090243, -284.85158041412416, -78.80235225127701, -52.41140372779334, -45.23310801187165, -104.83878145828912, -86.66875229208829, -122.85368434436283, -63.26717541234345, -46.48362874157808, -30.789280121841493, -16.043548511391084, 0.24707969994238538, -60.07045783483854, -76.75620436458858, -132.71123288138696, -109.38583148263446, 17.35435934214546, -111.45905011469411, -340.26779033777626, -147.88662803055684, -152.10852575871942, -92.4390782506927, -148.86684669374813, -79.16572796574822, -61.99595340836174, -25.742680858252143, -22.763501820503386, -164.93674337490287, -202.6824541393402, -107.49060897062519, 28.652291216620366, -36.671732703740496, -13.743799957200412, 48.05576957013789, -22.497972042274544, -19.995034032795257, -31.061923350137, -17.54994419468338, -32.61586930879654, -4.217282590998284, -63.61965840384386, -105.79478858503212, -124.95753171753375, -22.95455533795829, -25.7722339842891, -13.854537313689784, -19.49684621442178, -31.143934077928666, -82.16971006406894, 41.73479498521752, -57.33053608074953, -38.6617865749674, -65.76445518976834, -153.52704572589886, 16.885842335380232, -71.62258471008825, 45.12094568144123, -75.20639592400656, -8.77303603480414, -20.816058253267748, -132.77667365936344, -6.543839141830958, 14.107036135881202, -213.4355074235365, -142.25070369650075, -167.63016174676287, -78.54281687951702, -40.53096599768204, -37.89622227237869, -71.21160878796799, -33.12024156267977, -222.0421491340751, -1.35308396296266, -134.61469136822788, -77.63770053144756, -89.35514481929314, -69.86032891968074, -102.85470521637681, -70.37415500402032, -66.6889903050157, -140.95779728805775, -18.834962538717463, -20.621788893767512, -55.677982391660414, -0.9223665342775429, -59.08621953339345, -147.7883063742628, 17.234192701710775, -15.594569485072725, -99.6404065152121, -88.61227358287813, -69.86375377448068, -19.438475450035035, 3.3282264744973022, -18.802898963662035, -66.37752480373054, -46.02990490795187, -233.1045053167009, -7.793647672079683, -15.34436536362151, -105.70989881998962, -8.772713718320492, -34.2339642686652, -19.519676146265923, -25.56380789673298, 0.0647066015169565, -1.4226022389248918, -374.31101828866747, -153.32575470292667, -120.58760162200345, -88.08109704110217, -52.022503394781566, -298.2851917459697, 5.025047098798764, -29.539975677085145, -57.62014478933083, 65.63910324449601, -20.24071741031541, -23.801315197856717, 21.8, -18.37507037106535, -89.37560471279465, -156.42428422965773, -100.69849386892541, -86.93718948757443, -134.52019563703612, -229.40066227548775, -102.09677676810385, -70.104302671377, -8.652290460998476, -43.1632630510994, -111.63265612206821, -154.91374345006597, -27.935135936894945, -46.491780505792384, -81.5572817538124, -75.1656627424964, -98.23058541619693, -68.15903719163117, -14.386899588663129, 3.7007841124066005, -118.41601725397334, -48.86142791879482], "policy_predator_policy_reward": [91.77038247590528, 85.37757682261892, 135.59279376466438, 154.4337023512712, 60.56398440890084, 122.03252911433421, 125.46895581772624, 118.15482574581077, 87.21508770496239, 91.25226170072966, 103.46514765604933, 77.56629439324901, 102.77004820584803, 74.72714487883029, 116.23432341312433, 107.2931052290673, 66.63328630827603, 106.72159436045216, 115.70835734526251, 126.24403853755302, 102.57687896529353, 52.34247107781979, 84.66357867827878, 140.86704922613842, 153.61216402979298, 181.08458298143324, 119.9107309581114, 90.04670524811101, 71.33338129923128, 72.60909628313705, 163.97791087388893, 92.85690600695536, 134.26855807244493, 123.82131645903654, 115.95023501852133, 74.43017554802591, 164.33829215046333, 134.60688829368743, 135.8363591891927, 162.22541269612285, 88.19898287465641, 37.195193106224984, 52.927922767729534, 80.8907944754898, 114.45247432551112, 128.05214786501023, 107.37942557652651, 122.37294585556108, 149.32516510889081, 182.27591953507877, 49.87980726864835, 82.24684800681229, 76.3253048461932, 85.68220331264965, 74.3353983763369, 65.55051862265555, 218.46876049733487, 247.67560045312547, 60.204492287925596, 82.24678702179398, 94.31049274790531, 84.80290388960464, 118.25813637502567, 111.57041686192586, 56.56936834042891, 85.7022490003333, 31.113529504173222, 33.55274429505287, 43.6985752848485, 49.75722240546319, 140.6248309197258, 125.29548281211684, 124.49824268347436, 75.77991284479077, 279.95709453763095, 188.09572272530755, 169.83472650120302, 149.42274228254598, 138.4000177571655, 124.35461632224568, 86.02667746716968, 70.4276025891596, 30.815467195724246, 18.831356676732046, 202.80451709878542, 147.7083327843601, 78.66777427404935, 97.76821749579877, 12.529129016367937, 43.54353875921775, 24.772160381592077, 16.20880695939282, 36.12098029465698, 31.188026251011284, 67.10207515525667, 28.95454549158471, 73.23245389373676, 70.03408351238737, 126.69890150021874, 109.96227391149607, 33.543038358777146, 26.69604875959554, 45.204987447094744, 36.04990780006383, 35.22934503762919, 87.7476272585546, 47.74571217161996, 65.31605176949346, 79.49153411859828, 37.862105195201686, 135.8493748392284, 105.07726223960907, 19.94820750399087, 79.3116977470676, 74.98126789957989, 70.72455748918945, 117.31586236935263, 110.50254258147544, 35.576909913563846, 19.81911883466276, 214.49157300638655, 176.2243776320868, 105.9695240657049, 173.80939581729106, 35.52209321291359, 44.05570259217634, 63.27035005567351, 27.388675289951234, 230.6960156831675, 9.777869920446586, 3.577349941715902, 182.43734374441743, 88.763176908246, 79.19931425665611, 52.713444368672654, 125.66206181688287, 13.889986341076296, 166.11929903648712, 25.54221509442843, 51.866665045516214, 43.382483863771405, 66.76159976698916, 97.37040569938775, 161.77149279064986, 51.816130406840266, 56.8224024184185, 121.44498897583111, 26.698291719971632, 74.59869092836222, 50.93162574806014, 21.355929840309724, 20.377445585553197, 70.61975711808608, 80.39661215323372, 19.433763821324156, 233.61916572796216, 99.89524236018332, 99.99316838027202, 27.02522861811195, 33.80046984908242, 17.694989243541837, 29.255811697964766, 2.835006973933478, 3.4681904933858236, 143.24447793950173, 379.59665044429505, 118.26071821889025, 125.37159734132557, 253.84784856933635, 203.68495907221518, 35.308316957973304, 18.585258465062363, 59.3294569218562, 25.992019313330097, 20.901952322405975, 46.39778007260892, 28.500223387977663, 26.393052647351436, 174.01011343507494, 57.21384562442569, 97.81493831696196, 88.16395966547968, 150.64467243924884, 204.349482520915, 91.43823718414106, 109.96550459746007, 34.54797499392087, 26.7870164299745, 162.49015496142832, 150.41370439068208, 30.172396987296544, 92.19547044395244, 107.49065789496221, 34.919613546713194, 74.71959361585257, 120.9672181827015, 26.802737857227548, 43.91007446525009, 90.13198254097574, 89.67424600472248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5223280183296038, "mean_inference_ms": 1.485347091570813, "mean_action_processing_ms": 0.21960453305350544, "mean_env_wait_ms": 0.18198099149508556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00396120548248291, "StateBufferConnector_ms": 0.0032576322555541992, "ViewRequirementAgentConnector_ms": 0.09343183040618896}, "num_episodes": 18, "episode_return_max": 110.27815604189753, "episode_return_min": -40.10939940228738, "episode_return_mean": 30.5684611013884, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.64272268705855, "num_env_steps_trained_throughput_per_sec": 376.64272268705855, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 10252.606, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10252.574, "sample_time_ms": 1281.882, "learn_time_ms": 8956.532, "learn_throughput": 446.601, "synch_weights_time_ms": 13.34}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "ef79f_00000", "date": "2024-08-16_11-20-31", "timestamp": 1723787431, "time_this_iter_s": 10.627674102783203, "time_total_s": 208.67331886291504, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32144f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 208.67331886291504, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.973333333333336, "ram_util_percent": 79.47999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3562181285764807, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.436722312402473, "policy_loss": -0.012809697591709515, "vf_loss": 8.446154405452587, "vf_explained_var": 0.06949157809454297, "kl": 0.01688825223944329, "entropy": 1.5221422976286954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.285557045097704, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.570726581856057, "policy_loss": -0.001273532841655194, "vf_loss": 8.570556686038064, "vf_explained_var": 0.041554783355622064, "kl": 0.007217168765911028, "entropy": 1.3908792170267257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 122.46188591861473, "episode_reward_min": -40.10939940228738, "episode_reward_mean": 32.782971153246876, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -374.31101828866747, "predator_policy": 2.835006973933478}, "policy_reward_max": {"prey_policy": 65.63910324449601, "predator_policy": 379.59665044429505}, "policy_reward_mean": {"prey_policy": -75.99931337008422, "predator_policy": 92.39079894670762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.012777785325675, 30.54952143045292, 30.711135490244896, 61.81723217476738, 62.49366630701235, 27.18058182047126, -0.46467653073372117, 43.348851452462235, 72.25991889549555, 25.136112133163657, 11.60355647543368, 11.237523330649049, 29.04150716734914, 20.30611660050062, 32.52081318684098, 17.83344516599348, 33.63241955541589, 56.452876485867, 108.24668338777613, 16.325976810468426, 19.26231499447266, 21.448709134970237, 15.292598682219495, 1.1406411937003331, -17.10634763109787, 97.59767401584332, 5.6571351146448405, 66.53876486884933, 16.252049162735755, 45.89080714336129, 75.42959641128228, 5.908855109148882, 11.51229779612529, 47.90351171904673, 9.66332815418633, 97.46602284558247, 12.927397549063976, 104.28543368831907, 72.75826622241149, 61.72639342995854, 74.22567303819746, 62.95922574227699, 35.029739518435896, 33.605941256716, 1.1506075350292, -13.672825005023086, 17.078652506576343, -26.23769821354216, 8.747017425928188, 5.146645965158338, -27.637502215509937, 37.95212870745959, 53.543734704822754, 52.26737258238145, 110.27815604189753, -40.10939940228738, 36.22808745190649, 26.258702936698473, 38.608939559637534, 12.154776560505791, 78.83414655684429, 17.81902048020904, 1.867316898507242, 4.945301829911317, -4.795644607797754, 34.963616897110285, 107.22511250080048, 29.378646844749507, 93.34043469035127, 23.257699786842718, 58.3182056642639, -14.575929882951677, -1.6567853740581575, -8.926702952360138, 29.20266234212025, 9.519437911797771, 46.357459779976246, 47.940950988561596, -14.312673054633455, 29.29718919072596, 60.02669684622102, 12.528783372930151, 13.178770183796477, 2.4294723771935707, 19.436379853688912, 79.62846081936013, 0.526882456803012, 42.0150073687365, 51.686386496703435, 51.09468287079655, -17.619707674126445, 10.704837563702634, 19.056657987158445, 77.52889888291318, -16.43073352844385, 80.4358390612764, 41.08076914326406, 122.46188591861473, 47.07780854937749, 36.07040485670383], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-127.60594511991448, -153.32645753891063, -165.98065794217126, -101.53159251269153, -14.804769142944368, -79.87827134769203, -64.9279849958396, -7.07350007261242, -63.43394217812679, -116.57701370538219, -92.2424144945947, -110.32937511702167, -213.07384703231787, -118.99191414238537, -27.037931984285255, -61.73987183871316, -11.853448919288404, -77.89414034405894, -39.13314593856669, -75.61665892726234, -169.68922406090243, -284.85158041412416, -78.80235225127701, -52.41140372779334, -45.23310801187165, -104.83878145828912, -86.66875229208829, -122.85368434436283, -63.26717541234345, -46.48362874157808, -30.789280121841493, -16.043548511391084, 0.24707969994238538, -60.07045783483854, -76.75620436458858, -132.71123288138696, -109.38583148263446, 17.35435934214546, -111.45905011469411, -340.26779033777626, -147.88662803055684, -152.10852575871942, -92.4390782506927, -148.86684669374813, -79.16572796574822, -61.99595340836174, -25.742680858252143, -22.763501820503386, -164.93674337490287, -202.6824541393402, -107.49060897062519, 28.652291216620366, -36.671732703740496, -13.743799957200412, 48.05576957013789, -22.497972042274544, -19.995034032795257, -31.061923350137, -17.54994419468338, -32.61586930879654, -4.217282590998284, -63.61965840384386, -105.79478858503212, -124.95753171753375, -22.95455533795829, -25.7722339842891, -13.854537313689784, -19.49684621442178, -31.143934077928666, -82.16971006406894, 41.73479498521752, -57.33053608074953, -38.6617865749674, -65.76445518976834, -153.52704572589886, 16.885842335380232, -71.62258471008825, 45.12094568144123, -75.20639592400656, -8.77303603480414, -20.816058253267748, -132.77667365936344, -6.543839141830958, 14.107036135881202, -213.4355074235365, -142.25070369650075, -167.63016174676287, -78.54281687951702, -40.53096599768204, -37.89622227237869, -71.21160878796799, -33.12024156267977, -222.0421491340751, -1.35308396296266, -134.61469136822788, -77.63770053144756, -89.35514481929314, -69.86032891968074, -102.85470521637681, -70.37415500402032, -66.6889903050157, -140.95779728805775, -18.834962538717463, -20.621788893767512, -55.677982391660414, -0.9223665342775429, -59.08621953339345, -147.7883063742628, 17.234192701710775, -15.594569485072725, -99.6404065152121, -88.61227358287813, -69.86375377448068, -19.438475450035035, 3.3282264744973022, -18.802898963662035, -66.37752480373054, -46.02990490795187, -233.1045053167009, -7.793647672079683, -15.34436536362151, -105.70989881998962, -8.772713718320492, -34.2339642686652, -19.519676146265923, -25.56380789673298, 0.0647066015169565, -1.4226022389248918, -374.31101828866747, -153.32575470292667, -120.58760162200345, -88.08109704110217, -52.022503394781566, -298.2851917459697, 5.025047098798764, -29.539975677085145, -57.62014478933083, 65.63910324449601, -20.24071741031541, -23.801315197856717, 21.8, -18.37507037106535, -89.37560471279465, -156.42428422965773, -100.69849386892541, -86.93718948757443, -134.52019563703612, -229.40066227548775, -102.09677676810385, -70.104302671377, -8.652290460998476, -43.1632630510994, -111.63265612206821, -154.91374345006597, -27.935135936894945, -46.491780505792384, -81.5572817538124, -75.1656627424964, -98.23058541619693, -68.15903719163117, -14.386899588663129, 3.7007841124066005, -118.41601725397334, -48.86142791879482, -213.08563745297465, -316.41863679807, -77.55679943943127, -86.15803640919745, -311.24536382571245, -123.98803461087351, -179.73674462810612, -40.67574459002955, -37.41975858044732, -66.00221970898241, 21.93027494411368, -56.067767702960076, 36.134026207091175, -27.906388068994907, -93.87732247402012, -107.65198418688342, -133.71204614270698, -95.71433091424704, -110.94759067531156, -178.05847203257792, -71.1990687567127, -215.69844152687915, -34.15336362726928, 30.26743193863061, -147.729685039589, -113.98700981135062, -111.48863603691576, 33.218172796737775, -62.30914618421612, -114.66365611884802, -30.759834648768525, -32.415601997165986, -109.31615613896594, 4.5645781680018755, -113.06789962368381, -38.6342040244323], "policy_predator_policy_reward": [164.33829215046333, 134.60688829368743, 135.8363591891927, 162.22541269612285, 88.19898287465641, 37.195193106224984, 52.927922767729534, 80.8907944754898, 114.45247432551112, 128.05214786501023, 107.37942557652651, 122.37294585556108, 149.32516510889081, 182.27591953507877, 49.87980726864835, 82.24684800681229, 76.3253048461932, 85.68220331264965, 74.3353983763369, 65.55051862265555, 218.46876049733487, 247.67560045312547, 60.204492287925596, 82.24678702179398, 94.31049274790531, 84.80290388960464, 118.25813637502567, 111.57041686192586, 56.56936834042891, 85.7022490003333, 31.113529504173222, 33.55274429505287, 43.6985752848485, 49.75722240546319, 140.6248309197258, 125.29548281211684, 124.49824268347436, 75.77991284479077, 279.95709453763095, 188.09572272530755, 169.83472650120302, 149.42274228254598, 138.4000177571655, 124.35461632224568, 86.02667746716968, 70.4276025891596, 30.815467195724246, 18.831356676732046, 202.80451709878542, 147.7083327843601, 78.66777427404935, 97.76821749579877, 12.529129016367937, 43.54353875921775, 24.772160381592077, 16.20880695939282, 36.12098029465698, 31.188026251011284, 67.10207515525667, 28.95454549158471, 73.23245389373676, 70.03408351238737, 126.69890150021874, 109.96227391149607, 33.543038358777146, 26.69604875959554, 45.204987447094744, 36.04990780006383, 35.22934503762919, 87.7476272585546, 47.74571217161996, 65.31605176949346, 79.49153411859828, 37.862105195201686, 135.8493748392284, 105.07726223960907, 19.94820750399087, 79.3116977470676, 74.98126789957989, 70.72455748918945, 117.31586236935263, 110.50254258147544, 35.576909913563846, 19.81911883466276, 214.49157300638655, 176.2243776320868, 105.9695240657049, 173.80939581729106, 35.52209321291359, 44.05570259217634, 63.27035005567351, 27.388675289951234, 230.6960156831675, 9.777869920446586, 3.577349941715902, 182.43734374441743, 88.763176908246, 79.19931425665611, 52.713444368672654, 125.66206181688287, 13.889986341076296, 166.11929903648712, 25.54221509442843, 51.866665045516214, 43.382483863771405, 66.76159976698916, 97.37040569938775, 161.77149279064986, 51.816130406840266, 56.8224024184185, 121.44498897583111, 26.698291719971632, 74.59869092836222, 50.93162574806014, 21.355929840309724, 20.377445585553197, 70.61975711808608, 80.39661215323372, 19.433763821324156, 233.61916572796216, 99.89524236018332, 99.99316838027202, 27.02522861811195, 33.80046984908242, 17.694989243541837, 29.255811697964766, 2.835006973933478, 3.4681904933858236, 143.24447793950173, 379.59665044429505, 118.26071821889025, 125.37159734132557, 253.84784856933635, 203.68495907221518, 35.308316957973304, 18.585258465062363, 59.3294569218562, 25.992019313330097, 20.901952322405975, 46.39778007260892, 28.500223387977663, 26.393052647351436, 174.01011343507494, 57.21384562442569, 97.81493831696196, 88.16395966547968, 150.64467243924884, 204.349482520915, 91.43823718414106, 109.96550459746007, 34.54797499392087, 26.7870164299745, 162.49015496142832, 150.41370439068208, 30.172396987296544, 92.19547044395244, 107.49065789496221, 34.919613546713194, 74.71959361585257, 120.9672181827015, 26.802737857227548, 43.91007446525009, 90.13198254097574, 89.67424600472248, 230.48026238939434, 312.2027820454467, 80.10887456622612, 86.0354336595961, 209.44859371029037, 245.22118457998448, 138.9311161535583, 161.1098338839373, 25.719249361199093, 78.2296113850338, 14.889252524513113, 61.26324760306977, 15.04597379290881, 28.412774565698488, 134.99410860363042, 117.62988092806988, 71.43471596395354, 140.37195341887397, 177.3419323300859, 122.36896794150623, 154.62562754819967, 151.3285407225506, 39.98787708135447, 41.42695349019701, 206.9265856193532, 38.35937570314245, 63.151516698825674, 95.55478560262854, 130.69447286719947, 87.3590985791287, 92.12765315465872, 93.50966940989026, 46.12696008388015, 105.70242643646138, 66.20439740153024, 121.56811110328964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5229802809906949, "mean_inference_ms": 1.4975234377654036, "mean_action_processing_ms": 0.2200450984994994, "mean_env_wait_ms": 0.18258503185944214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003948569297790527, "StateBufferConnector_ms": 0.00325930118560791, "ViewRequirementAgentConnector_ms": 0.09463644027709961}, "num_episodes": 18, "episode_return_max": 122.46188591861473, "episode_return_min": -40.10939940228738, "episode_return_mean": 32.782971153246876, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.60890933222464, "num_env_steps_trained_throughput_per_sec": 384.60890933222464, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 10254.198, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10254.166, "sample_time_ms": 1287.355, "learn_time_ms": 8952.208, "learn_throughput": 446.817, "synch_weights_time_ms": 13.783}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "ef79f_00000", "date": "2024-08-16_11-20-41", "timestamp": 1723787441, "time_this_iter_s": 10.404165983200073, "time_total_s": 219.0774848461151, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b8a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 219.0774848461151, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 27.278571428571432, "ram_util_percent": 79.62857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0749194255581607, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.629236946408711, "policy_loss": -0.006767382509587579, "vf_loss": 6.633298937984245, "vf_explained_var": 0.022602719920022146, "kl": 0.013526939617264803, "entropy": 1.5291311954695082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8137623461781356, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.55343892687843, "policy_loss": -0.006764763733618474, "vf_loss": 7.557838888521547, "vf_explained_var": 0.005832467760358538, "kl": 0.011824065174380179, "entropy": 1.3613530179810902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 122.46188591861473, "episode_reward_min": -40.10939940228738, "episode_reward_mean": 36.8394380585315, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -414.17811624655855, "predator_policy": 0.16555294915474036}, "policy_reward_max": {"prey_policy": 69.06135303286783, "predator_policy": 379.59665044429505}, "policy_reward_mean": {"prey_policy": -63.17257279459785, "predator_policy": 81.59229182386355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.53876486884933, 16.252049162735755, 45.89080714336129, 75.42959641128228, 5.908855109148882, 11.51229779612529, 47.90351171904673, 9.66332815418633, 97.46602284558247, 12.927397549063976, 104.28543368831907, 72.75826622241149, 61.72639342995854, 74.22567303819746, 62.95922574227699, 35.029739518435896, 33.605941256716, 1.1506075350292, -13.672825005023086, 17.078652506576343, -26.23769821354216, 8.747017425928188, 5.146645965158338, -27.637502215509937, 37.95212870745959, 53.543734704822754, 52.26737258238145, 110.27815604189753, -40.10939940228738, 36.22808745190649, 26.258702936698473, 38.608939559637534, 12.154776560505791, 78.83414655684429, 17.81902048020904, 1.867316898507242, 4.945301829911317, -4.795644607797754, 34.963616897110285, 107.22511250080048, 29.378646844749507, 93.34043469035127, 23.257699786842718, 58.3182056642639, -14.575929882951677, -1.6567853740581575, -8.926702952360138, 29.20266234212025, 9.519437911797771, 46.357459779976246, 47.940950988561596, -14.312673054633455, 29.29718919072596, 60.02669684622102, 12.528783372930151, 13.178770183796477, 2.4294723771935707, 19.436379853688912, 79.62846081936013, 0.526882456803012, 42.0150073687365, 51.686386496703435, 51.09468287079655, -17.619707674126445, 10.704837563702634, 19.056657987158445, 77.52889888291318, -16.43073352844385, 80.4358390612764, 41.08076914326406, 122.46188591861473, 47.07780854937749, 36.07040485670383, 116.86848116527163, 97.45089985099273, -13.82621983730394, 59.101628230319314, 0.4711159472700208, 66.18000000000035, 23.7305556191738, 30.802379466489413, 63.11101273337226, 57.035049298396544, 20.247631615896506, 46.6516404136661, 51.97794828547279, 36.885564929129266, 59.490778081205455, 35.60125318736702, 57.08532687394709, 69.01017870299971, 19.125671246507668, 27.5582299128111, 23.737519988667, 61.735082153631744, 96.43873215969936, 14.893690769826291, 22.676102778199336, 87.36698638210052, 25.778215203062892], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [48.05576957013789, -22.497972042274544, -19.995034032795257, -31.061923350137, -17.54994419468338, -32.61586930879654, -4.217282590998284, -63.61965840384386, -105.79478858503212, -124.95753171753375, -22.95455533795829, -25.7722339842891, -13.854537313689784, -19.49684621442178, -31.143934077928666, -82.16971006406894, 41.73479498521752, -57.33053608074953, -38.6617865749674, -65.76445518976834, -153.52704572589886, 16.885842335380232, -71.62258471008825, 45.12094568144123, -75.20639592400656, -8.77303603480414, -20.816058253267748, -132.77667365936344, -6.543839141830958, 14.107036135881202, -213.4355074235365, -142.25070369650075, -167.63016174676287, -78.54281687951702, -40.53096599768204, -37.89622227237869, -71.21160878796799, -33.12024156267977, -222.0421491340751, -1.35308396296266, -134.61469136822788, -77.63770053144756, -89.35514481929314, -69.86032891968074, -102.85470521637681, -70.37415500402032, -66.6889903050157, -140.95779728805775, -18.834962538717463, -20.621788893767512, -55.677982391660414, -0.9223665342775429, -59.08621953339345, -147.7883063742628, 17.234192701710775, -15.594569485072725, -99.6404065152121, -88.61227358287813, -69.86375377448068, -19.438475450035035, 3.3282264744973022, -18.802898963662035, -66.37752480373054, -46.02990490795187, -233.1045053167009, -7.793647672079683, -15.34436536362151, -105.70989881998962, -8.772713718320492, -34.2339642686652, -19.519676146265923, -25.56380789673298, 0.0647066015169565, -1.4226022389248918, -374.31101828866747, -153.32575470292667, -120.58760162200345, -88.08109704110217, -52.022503394781566, -298.2851917459697, 5.025047098798764, -29.539975677085145, -57.62014478933083, 65.63910324449601, -20.24071741031541, -23.801315197856717, 21.8, -18.37507037106535, -89.37560471279465, -156.42428422965773, -100.69849386892541, -86.93718948757443, -134.52019563703612, -229.40066227548775, -102.09677676810385, -70.104302671377, -8.652290460998476, -43.1632630510994, -111.63265612206821, -154.91374345006597, -27.935135936894945, -46.491780505792384, -81.5572817538124, -75.1656627424964, -98.23058541619693, -68.15903719163117, -14.386899588663129, 3.7007841124066005, -118.41601725397334, -48.86142791879482, -213.08563745297465, -316.41863679807, -77.55679943943127, -86.15803640919745, -311.24536382571245, -123.98803461087351, -179.73674462810612, -40.67574459002955, -37.41975858044732, -66.00221970898241, 21.93027494411368, -56.067767702960076, 36.134026207091175, -27.906388068994907, -93.87732247402012, -107.65198418688342, -133.71204614270698, -95.71433091424704, -110.94759067531156, -178.05847203257792, -71.1990687567127, -215.69844152687915, -34.15336362726928, 30.26743193863061, -147.729685039589, -113.98700981135062, -111.48863603691576, 33.218172796737775, -62.30914618421612, -114.66365611884802, -30.759834648768525, -32.415601997165986, -109.31615613896594, 4.5645781680018755, -113.06789962368381, -38.6342040244323, 20.260124180153344, -329.452282836327, 56.70112511512701, -46.05141950474218, -88.25632624714832, -82.58140995549127, -156.82908590792303, -24.338848416898156, -37.82043835459272, -42.01462308988002, 2.0000000000000013, 57.01184942706094, -47.3246027157277, -22.80232702626125, 1.9722985420172041, -82.17675314561127, -26.180122751795793, -414.17811624655855, -54.00494331605997, -275.3472565827332, -2.262415051136327, -16.929517869281668, -39.746130828740185, 16.317146812057583, 8.999856150742103, -41.29992656678578, -58.64187373142024, -21.723932376874096, -29.905328390895523, -30.860558145636986, -99.48180823230504, -22.55974848753281, 2.86247671694759, -61.83536163027973, -2.1237942570476003, -42.6631864139433, -51.32449654974987, -31.284926969902127, -34.560383083581534, 0.9415395618250485, -4.163519992608864, -26.759605648701292, 1.0524143699534723, -97.38134639372892, -24.096920873873625, 69.06135303286783, -53.95532023982146, -15.465241385728289, 2.0000000000000013, -38.94223008708133, 59.10839106253508, 17.807304720357735, -13.788706886747201, -25.509449735462653], "policy_predator_policy_reward": [24.772160381592077, 16.20880695939282, 36.12098029465698, 31.188026251011284, 67.10207515525667, 28.95454549158471, 73.23245389373676, 70.03408351238737, 126.69890150021874, 109.96227391149607, 33.543038358777146, 26.69604875959554, 45.204987447094744, 36.04990780006383, 35.22934503762919, 87.7476272585546, 47.74571217161996, 65.31605176949346, 79.49153411859828, 37.862105195201686, 135.8493748392284, 105.07726223960907, 19.94820750399087, 79.3116977470676, 74.98126789957989, 70.72455748918945, 117.31586236935263, 110.50254258147544, 35.576909913563846, 19.81911883466276, 214.49157300638655, 176.2243776320868, 105.9695240657049, 173.80939581729106, 35.52209321291359, 44.05570259217634, 63.27035005567351, 27.388675289951234, 230.6960156831675, 9.777869920446586, 3.577349941715902, 182.43734374441743, 88.763176908246, 79.19931425665611, 52.713444368672654, 125.66206181688287, 13.889986341076296, 166.11929903648712, 25.54221509442843, 51.866665045516214, 43.382483863771405, 66.76159976698916, 97.37040569938775, 161.77149279064986, 51.816130406840266, 56.8224024184185, 121.44498897583111, 26.698291719971632, 74.59869092836222, 50.93162574806014, 21.355929840309724, 20.377445585553197, 70.61975711808608, 80.39661215323372, 19.433763821324156, 233.61916572796216, 99.89524236018332, 99.99316838027202, 27.02522861811195, 33.80046984908242, 17.694989243541837, 29.255811697964766, 2.835006973933478, 3.4681904933858236, 143.24447793950173, 379.59665044429505, 118.26071821889025, 125.37159734132557, 253.84784856933635, 203.68495907221518, 35.308316957973304, 18.585258465062363, 59.3294569218562, 25.992019313330097, 20.901952322405975, 46.39778007260892, 28.500223387977663, 26.393052647351436, 174.01011343507494, 57.21384562442569, 97.81493831696196, 88.16395966547968, 150.64467243924884, 204.349482520915, 91.43823718414106, 109.96550459746007, 34.54797499392087, 26.7870164299745, 162.49015496142832, 150.41370439068208, 30.172396987296544, 92.19547044395244, 107.49065789496221, 34.919613546713194, 74.71959361585257, 120.9672181827015, 26.802737857227548, 43.91007446525009, 90.13198254097574, 89.67424600472248, 230.48026238939434, 312.2027820454467, 80.10887456622612, 86.0354336595961, 209.44859371029037, 245.22118457998448, 138.9311161535583, 161.1098338839373, 25.719249361199093, 78.2296113850338, 14.889252524513113, 61.26324760306977, 15.04597379290881, 28.412774565698488, 134.99410860363042, 117.62988092806988, 71.43471596395354, 140.37195341887397, 177.3419323300859, 122.36896794150623, 154.62562754819967, 151.3285407225506, 39.98787708135447, 41.42695349019701, 206.9265856193532, 38.35937570314245, 63.151516698825674, 95.55478560262854, 130.69447286719947, 87.3590985791287, 92.12765315465872, 93.50966940989026, 46.12696008388015, 105.70242643646138, 66.20439740153024, 121.56811110328964, 207.4000186596439, 218.66062116180032, 34.0407957441833, 52.76039849642358, 114.25426383618274, 42.75725252915303, 131.52566749601303, 108.74389505912757, 49.394877108051986, 30.911300283690363, 0.16555294915474036, 7.002597623784199, 46.87670256791702, 46.98078279324563, 33.758144546689266, 77.24868952339398, 176.19878665485, 327.27046507687606, 203.63772476669897, 182.74952443049074, 4.38385616513947, 35.05570837117485, 21.020291651331284, 49.06033277901752, 49.17259743645939, 35.105421265057245, 55.48751019801959, 61.763860839403925, 51.31720312311195, 68.93946149462623, 67.03187563332948, 90.61093427387544, 53.92354270407771, 62.13466908320159, 76.75001958842574, 37.04713978556504, 50.78851779832247, 50.94657696783725, 46.9589418174139, 14.218131617153457, 24.84708403939209, 29.813561590584875, 81.8180720095581, 76.24594216784934, 28.52106850529886, 22.953231495405948, 60.36129425591127, 23.95295813946469, 33.95103437295123, 25.667298492329508, 4.188978762361888, 6.262311836845323, 41.07470645237023, 24.00166537290253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5236493827160466, "mean_inference_ms": 1.5151927517610404, "mean_action_processing_ms": 0.22086388994515635, "mean_env_wait_ms": 0.18348586418835353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004119515419006348, "StateBufferConnector_ms": 0.0032171010971069336, "ViewRequirementAgentConnector_ms": 0.09565269947052002}, "num_episodes": 27, "episode_return_max": 122.46188591861473, "episode_return_min": -40.10939940228738, "episode_return_mean": 36.8394380585315, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 371.1494350236804, "num_env_steps_trained_throughput_per_sec": 371.1494350236804, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 10339.737, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10339.704, "sample_time_ms": 1292.114, "learn_time_ms": 9032.881, "learn_throughput": 442.827, "synch_weights_time_ms": 13.89}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "ef79f_00000", "date": "2024-08-16_11-20-52", "timestamp": 1723787452, "time_this_iter_s": 10.78240704536438, "time_total_s": 229.8598918914795, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321437820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 229.8598918914795, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 30.64375, "ram_util_percent": 79.64375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6641846972798544, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.206654087197844, "policy_loss": -0.007414067310906907, "vf_loss": 5.212396931774402, "vf_explained_var": -0.09440014406486794, "kl": 0.008356058082130977, "entropy": 1.5132220360967847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.318599222072218, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.468881923433334, "policy_loss": -0.0038841369165176593, "vf_loss": 7.470406756829963, "vf_explained_var": -0.16223960544066454, "kl": 0.011796472731321518, "entropy": 1.33891592574498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 151.50378871830054, "episode_reward_min": -40.10939940228738, "episode_reward_mean": 38.260224375676714, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -414.17811624655855, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 93.26621027176392, "predator_policy": 379.59665044429505}, "policy_reward_mean": {"prey_policy": -54.515007091933974, "predator_policy": 73.64511927977232}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.672825005023086, 17.078652506576343, -26.23769821354216, 8.747017425928188, 5.146645965158338, -27.637502215509937, 37.95212870745959, 53.543734704822754, 52.26737258238145, 110.27815604189753, -40.10939940228738, 36.22808745190649, 26.258702936698473, 38.608939559637534, 12.154776560505791, 78.83414655684429, 17.81902048020904, 1.867316898507242, 4.945301829911317, -4.795644607797754, 34.963616897110285, 107.22511250080048, 29.378646844749507, 93.34043469035127, 23.257699786842718, 58.3182056642639, -14.575929882951677, -1.6567853740581575, -8.926702952360138, 29.20266234212025, 9.519437911797771, 46.357459779976246, 47.940950988561596, -14.312673054633455, 29.29718919072596, 60.02669684622102, 12.528783372930151, 13.178770183796477, 2.4294723771935707, 19.436379853688912, 79.62846081936013, 0.526882456803012, 42.0150073687365, 51.686386496703435, 51.09468287079655, -17.619707674126445, 10.704837563702634, 19.056657987158445, 77.52889888291318, -16.43073352844385, 80.4358390612764, 41.08076914326406, 122.46188591861473, 47.07780854937749, 36.07040485670383, 116.86848116527163, 97.45089985099273, -13.82621983730394, 59.101628230319314, 0.4711159472700208, 66.18000000000035, 23.7305556191738, 30.802379466489413, 63.11101273337226, 57.035049298396544, 20.247631615896506, 46.6516404136661, 51.97794828547279, 36.885564929129266, 59.490778081205455, 35.60125318736702, 57.08532687394709, 69.01017870299971, 19.125671246507668, 27.5582299128111, 23.737519988667, 61.735082153631744, 96.43873215969936, 14.893690769826291, 22.676102778199336, 87.36698638210052, 25.778215203062892, 17.320156768626774, 93.39318684584637, 37.316981314201186, 59.97021925717048, 149.03493522489853, 111.51226812825132, 15.13851422269179, 60.92104743083911, 0.9553558618363615, 8.246198450963979, 3.839999999999962, 19.2867615178449, 3.751896532829819, 55.88272802206436, 3.989999999999959, 101.76852689515229, 151.50378871830054, 83.47997771373059], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-71.21160878796799, -33.12024156267977, -222.0421491340751, -1.35308396296266, -134.61469136822788, -77.63770053144756, -89.35514481929314, -69.86032891968074, -102.85470521637681, -70.37415500402032, -66.6889903050157, -140.95779728805775, -18.834962538717463, -20.621788893767512, -55.677982391660414, -0.9223665342775429, -59.08621953339345, -147.7883063742628, 17.234192701710775, -15.594569485072725, -99.6404065152121, -88.61227358287813, -69.86375377448068, -19.438475450035035, 3.3282264744973022, -18.802898963662035, -66.37752480373054, -46.02990490795187, -233.1045053167009, -7.793647672079683, -15.34436536362151, -105.70989881998962, -8.772713718320492, -34.2339642686652, -19.519676146265923, -25.56380789673298, 0.0647066015169565, -1.4226022389248918, -374.31101828866747, -153.32575470292667, -120.58760162200345, -88.08109704110217, -52.022503394781566, -298.2851917459697, 5.025047098798764, -29.539975677085145, -57.62014478933083, 65.63910324449601, -20.24071741031541, -23.801315197856717, 21.8, -18.37507037106535, -89.37560471279465, -156.42428422965773, -100.69849386892541, -86.93718948757443, -134.52019563703612, -229.40066227548775, -102.09677676810385, -70.104302671377, -8.652290460998476, -43.1632630510994, -111.63265612206821, -154.91374345006597, -27.935135936894945, -46.491780505792384, -81.5572817538124, -75.1656627424964, -98.23058541619693, -68.15903719163117, -14.386899588663129, 3.7007841124066005, -118.41601725397334, -48.86142791879482, -213.08563745297465, -316.41863679807, -77.55679943943127, -86.15803640919745, -311.24536382571245, -123.98803461087351, -179.73674462810612, -40.67574459002955, -37.41975858044732, -66.00221970898241, 21.93027494411368, -56.067767702960076, 36.134026207091175, -27.906388068994907, -93.87732247402012, -107.65198418688342, -133.71204614270698, -95.71433091424704, -110.94759067531156, -178.05847203257792, -71.1990687567127, -215.69844152687915, -34.15336362726928, 30.26743193863061, -147.729685039589, -113.98700981135062, -111.48863603691576, 33.218172796737775, -62.30914618421612, -114.66365611884802, -30.759834648768525, -32.415601997165986, -109.31615613896594, 4.5645781680018755, -113.06789962368381, -38.6342040244323, 20.260124180153344, -329.452282836327, 56.70112511512701, -46.05141950474218, -88.25632624714832, -82.58140995549127, -156.82908590792303, -24.338848416898156, -37.82043835459272, -42.01462308988002, 2.0000000000000013, 57.01184942706094, -47.3246027157277, -22.80232702626125, 1.9722985420172041, -82.17675314561127, -26.180122751795793, -414.17811624655855, -54.00494331605997, -275.3472565827332, -2.262415051136327, -16.929517869281668, -39.746130828740185, 16.317146812057583, 8.999856150742103, -41.29992656678578, -58.64187373142024, -21.723932376874096, -29.905328390895523, -30.860558145636986, -99.48180823230504, -22.55974848753281, 2.86247671694759, -61.83536163027973, -2.1237942570476003, -42.6631864139433, -51.32449654974987, -31.284926969902127, -34.560383083581534, 0.9415395618250485, -4.163519992608864, -26.759605648701292, 1.0524143699534723, -97.38134639372892, -24.096920873873625, 69.06135303286783, -53.95532023982146, -15.465241385728289, 2.0000000000000013, -38.94223008708133, 59.10839106253508, 17.807304720357735, -13.788706886747201, -25.509449735462653, -48.60252410647024, 3.958963659799181, 39.01282659171498, 1.806615079967069, 2.0000000000000013, -15.915772838461196, -0.06285454647835348, -22.716209966867957, -62.12974496076676, 93.26621027176392, 2.0000000000000013, 89.45007709255437, 2.0000000000000013, 8.713002484567227, -70.18657980331947, 0.8194496781090951, -4.1159828217809675, -1.8297000271876458, -21.341709633558427, -25.93632396246769, -2.112932440401243, 1.0269712202633432, -73.14895942952096, -12.300198479978887, -19.210147782756586, -0.14017373022556257, 2.040581573528552, -4.243018258777963, 2.0000000000000013, 1.802687320508176, 63.69371418749237, -29.592012570348732, 19.543932144289982, 65.15769388673257, 55.36324946610912, -71.66421058677449], "policy_predator_policy_reward": [63.27035005567351, 27.388675289951234, 230.6960156831675, 9.777869920446586, 3.577349941715902, 182.43734374441743, 88.763176908246, 79.19931425665611, 52.713444368672654, 125.66206181688287, 13.889986341076296, 166.11929903648712, 25.54221509442843, 51.866665045516214, 43.382483863771405, 66.76159976698916, 97.37040569938775, 161.77149279064986, 51.816130406840266, 56.8224024184185, 121.44498897583111, 26.698291719971632, 74.59869092836222, 50.93162574806014, 21.355929840309724, 20.377445585553197, 70.61975711808608, 80.39661215323372, 19.433763821324156, 233.61916572796216, 99.89524236018332, 99.99316838027202, 27.02522861811195, 33.80046984908242, 17.694989243541837, 29.255811697964766, 2.835006973933478, 3.4681904933858236, 143.24447793950173, 379.59665044429505, 118.26071821889025, 125.37159734132557, 253.84784856933635, 203.68495907221518, 35.308316957973304, 18.585258465062363, 59.3294569218562, 25.992019313330097, 20.901952322405975, 46.39778007260892, 28.500223387977663, 26.393052647351436, 174.01011343507494, 57.21384562442569, 97.81493831696196, 88.16395966547968, 150.64467243924884, 204.349482520915, 91.43823718414106, 109.96550459746007, 34.54797499392087, 26.7870164299745, 162.49015496142832, 150.41370439068208, 30.172396987296544, 92.19547044395244, 107.49065789496221, 34.919613546713194, 74.71959361585257, 120.9672181827015, 26.802737857227548, 43.91007446525009, 90.13198254097574, 89.67424600472248, 230.48026238939434, 312.2027820454467, 80.10887456622612, 86.0354336595961, 209.44859371029037, 245.22118457998448, 138.9311161535583, 161.1098338839373, 25.719249361199093, 78.2296113850338, 14.889252524513113, 61.26324760306977, 15.04597379290881, 28.412774565698488, 134.99410860363042, 117.62988092806988, 71.43471596395354, 140.37195341887397, 177.3419323300859, 122.36896794150623, 154.62562754819967, 151.3285407225506, 39.98787708135447, 41.42695349019701, 206.9265856193532, 38.35937570314245, 63.151516698825674, 95.55478560262854, 130.69447286719947, 87.3590985791287, 92.12765315465872, 93.50966940989026, 46.12696008388015, 105.70242643646138, 66.20439740153024, 121.56811110328964, 207.4000186596439, 218.66062116180032, 34.0407957441833, 52.76039849642358, 114.25426383618274, 42.75725252915303, 131.52566749601303, 108.74389505912757, 49.394877108051986, 30.911300283690363, 0.16555294915474036, 7.002597623784199, 46.87670256791702, 46.98078279324563, 33.758144546689266, 77.24868952339398, 176.19878665485, 327.27046507687606, 203.63772476669897, 182.74952443049074, 4.38385616513947, 35.05570837117485, 21.020291651331284, 49.06033277901752, 49.17259743645939, 35.105421265057245, 55.48751019801959, 61.763860839403925, 51.31720312311195, 68.93946149462623, 67.03187563332948, 90.61093427387544, 53.92354270407771, 62.13466908320159, 76.75001958842574, 37.04713978556504, 50.78851779832247, 50.94657696783725, 46.9589418174139, 14.218131617153457, 24.84708403939209, 29.813561590584875, 81.8180720095581, 76.24594216784934, 28.52106850529886, 22.953231495405948, 60.36129425591127, 23.95295813946469, 33.95103437295123, 25.667298492329508, 4.188978762361888, 6.262311836845323, 41.07470645237023, 24.00166537290253, 34.19377706284502, 27.769940152452744, 30.475121613277363, 22.09862356088684, 21.268254790872398, 29.964499361789965, 29.763173002018597, 52.98611076849858, 69.58860640619433, 48.30986350770699, 16.31302628872149, 3.749164746975273, 2.7830186688519016, 1.642493069272706, 66.14071743783012, 64.14746011821954, 6.504683601090218, 0.3963551097146964, 26.153931690162157, 29.370300356828334, 0.9330287797366581, 3.9929324404012028, 55.60003546775196, 49.135883959592675, 2.452070263055417, 20.65014778275681, 30.920433448870995, 27.16473125844269, 0.1873126794918254, 0.0, 36.37867155138191, 31.288153726626295, 38.311948613734906, 28.490214073543964, 47.24287716203573, 52.53806167236044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5251697805888909, "mean_inference_ms": 1.5253399064205586, "mean_action_processing_ms": 0.2211908742329095, "mean_env_wait_ms": 0.18387817170328155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066106319427490234, "StateBufferConnector_ms": 0.003686189651489258, "ViewRequirementAgentConnector_ms": 0.10751724243164062}, "num_episodes": 18, "episode_return_max": 151.50378871830054, "episode_return_min": -40.10939940228738, "episode_return_mean": 38.260224375676714, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.93025095263914, "num_env_steps_trained_throughput_per_sec": 383.93025095263914, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 10392.215, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10392.182, "sample_time_ms": 1307.374, "learn_time_ms": 9070.232, "learn_throughput": 441.003, "synch_weights_time_ms": 13.71}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "ef79f_00000", "date": "2024-08-16_11-21-03", "timestamp": 1723787463, "time_this_iter_s": 10.423427104949951, "time_total_s": 240.28331899642944, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32140fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 240.28331899642944, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 30.62666666666667, "ram_util_percent": 79.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.540037546775959, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.946308891356938, "policy_loss": -0.009580068022416776, "vf_loss": 6.9537566644174085, "vf_explained_var": -0.08761972611543363, "kl": 0.010661549965864, "entropy": 1.4886785866091492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8055881579086264, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.10781883486995, "policy_loss": -0.00630461863573473, "vf_loss": 7.112011758107988, "vf_explained_var": -0.024270479609726597, "kl": 0.010558498962155013, "entropy": 1.3629916700105817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 323.10151509118685, "episode_reward_min": -17.619707674126445, "episode_reward_mean": 60.154557527468235, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -414.17811624655855, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 165.23012522408985, "predator_policy": 379.59665044429505}, "policy_reward_mean": {"prey_policy": -34.14353047544121, "predator_policy": 64.22080923917531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.945301829911317, -4.795644607797754, 34.963616897110285, 107.22511250080048, 29.378646844749507, 93.34043469035127, 23.257699786842718, 58.3182056642639, -14.575929882951677, -1.6567853740581575, -8.926702952360138, 29.20266234212025, 9.519437911797771, 46.357459779976246, 47.940950988561596, -14.312673054633455, 29.29718919072596, 60.02669684622102, 12.528783372930151, 13.178770183796477, 2.4294723771935707, 19.436379853688912, 79.62846081936013, 0.526882456803012, 42.0150073687365, 51.686386496703435, 51.09468287079655, -17.619707674126445, 10.704837563702634, 19.056657987158445, 77.52889888291318, -16.43073352844385, 80.4358390612764, 41.08076914326406, 122.46188591861473, 47.07780854937749, 36.07040485670383, 116.86848116527163, 97.45089985099273, -13.82621983730394, 59.101628230319314, 0.4711159472700208, 66.18000000000035, 23.7305556191738, 30.802379466489413, 63.11101273337226, 57.035049298396544, 20.247631615896506, 46.6516404136661, 51.97794828547279, 36.885564929129266, 59.490778081205455, 35.60125318736702, 57.08532687394709, 69.01017870299971, 19.125671246507668, 27.5582299128111, 23.737519988667, 61.735082153631744, 96.43873215969936, 14.893690769826291, 22.676102778199336, 87.36698638210052, 25.778215203062892, 17.320156768626774, 93.39318684584637, 37.316981314201186, 59.97021925717048, 149.03493522489853, 111.51226812825132, 15.13851422269179, 60.92104743083911, 0.9553558618363615, 8.246198450963979, 3.839999999999962, 19.2867615178449, 3.751896532829819, 55.88272802206436, 3.989999999999959, 101.76852689515229, 151.50378871830054, 83.47997771373059, 41.93569080759955, 62.839004223193704, 288.26314971358306, 27.45450970220827, 167.32432752528152, 304.1712089659169, 207.22999999999996, 126.75112044997638, 136.49871416505843, 51.0688676668848, 20.42213778154173, 323.10151509118685, 11.27402404902417, 233.12917111887424, 148.52287693111526, 23.804165426968428, 132.58817832237486, 272.18192678053504], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0647066015169565, -1.4226022389248918, -374.31101828866747, -153.32575470292667, -120.58760162200345, -88.08109704110217, -52.022503394781566, -298.2851917459697, 5.025047098798764, -29.539975677085145, -57.62014478933083, 65.63910324449601, -20.24071741031541, -23.801315197856717, 21.8, -18.37507037106535, -89.37560471279465, -156.42428422965773, -100.69849386892541, -86.93718948757443, -134.52019563703612, -229.40066227548775, -102.09677676810385, -70.104302671377, -8.652290460998476, -43.1632630510994, -111.63265612206821, -154.91374345006597, -27.935135936894945, -46.491780505792384, -81.5572817538124, -75.1656627424964, -98.23058541619693, -68.15903719163117, -14.386899588663129, 3.7007841124066005, -118.41601725397334, -48.86142791879482, -213.08563745297465, -316.41863679807, -77.55679943943127, -86.15803640919745, -311.24536382571245, -123.98803461087351, -179.73674462810612, -40.67574459002955, -37.41975858044732, -66.00221970898241, 21.93027494411368, -56.067767702960076, 36.134026207091175, -27.906388068994907, -93.87732247402012, -107.65198418688342, -133.71204614270698, -95.71433091424704, -110.94759067531156, -178.05847203257792, -71.1990687567127, -215.69844152687915, -34.15336362726928, 30.26743193863061, -147.729685039589, -113.98700981135062, -111.48863603691576, 33.218172796737775, -62.30914618421612, -114.66365611884802, -30.759834648768525, -32.415601997165986, -109.31615613896594, 4.5645781680018755, -113.06789962368381, -38.6342040244323, 20.260124180153344, -329.452282836327, 56.70112511512701, -46.05141950474218, -88.25632624714832, -82.58140995549127, -156.82908590792303, -24.338848416898156, -37.82043835459272, -42.01462308988002, 2.0000000000000013, 57.01184942706094, -47.3246027157277, -22.80232702626125, 1.9722985420172041, -82.17675314561127, -26.180122751795793, -414.17811624655855, -54.00494331605997, -275.3472565827332, -2.262415051136327, -16.929517869281668, -39.746130828740185, 16.317146812057583, 8.999856150742103, -41.29992656678578, -58.64187373142024, -21.723932376874096, -29.905328390895523, -30.860558145636986, -99.48180823230504, -22.55974848753281, 2.86247671694759, -61.83536163027973, -2.1237942570476003, -42.6631864139433, -51.32449654974987, -31.284926969902127, -34.560383083581534, 0.9415395618250485, -4.163519992608864, -26.759605648701292, 1.0524143699534723, -97.38134639372892, -24.096920873873625, 69.06135303286783, -53.95532023982146, -15.465241385728289, 2.0000000000000013, -38.94223008708133, 59.10839106253508, 17.807304720357735, -13.788706886747201, -25.509449735462653, -48.60252410647024, 3.958963659799181, 39.01282659171498, 1.806615079967069, 2.0000000000000013, -15.915772838461196, -0.06285454647835348, -22.716209966867957, -62.12974496076676, 93.26621027176392, 2.0000000000000013, 89.45007709255437, 2.0000000000000013, 8.713002484567227, -70.18657980331947, 0.8194496781090951, -4.1159828217809675, -1.8297000271876458, -21.341709633558427, -25.93632396246769, -2.112932440401243, 1.0269712202633432, -73.14895942952096, -12.300198479978887, -19.210147782756586, -0.14017373022556257, 2.040581573528552, -4.243018258777963, 2.0000000000000013, 1.802687320508176, 63.69371418749237, -29.592012570348732, 19.543932144289982, 65.15769388673257, 55.36324946610912, -71.66421058677449, 30.521224735493714, 1.0807051995323793, 32.70152535563561, -2.4957933503599197, 136.69354143357089, 139.52124619657133, 21.462153520552846, -12.88254982579114, 50.26562794916344, 45.361084962199875, 165.23012522408985, 130.0948284218364, 78.71639298240918, 104.60022980746781, -4.062432868220459, 102.53415813537276, 15.633587213202738, -15.446582832618653, 1.3884257513833953, 25.688403131185844, -29.213843539754095, -25.354756106017426, 160.33132927329737, 155.25834548670608, -34.457142542111306, 3.980000000000001, 80.38391162091773, 92.0518199156473, -14.362147311888926, 40.31027410525152, 2.0000000000000013, 3.786670802018971, -0.6227692145486219, 107.81554740996214, 133.10478447968805, 115.83520710163073], "policy_predator_policy_reward": [2.835006973933478, 3.4681904933858236, 143.24447793950173, 379.59665044429505, 118.26071821889025, 125.37159734132557, 253.84784856933635, 203.68495907221518, 35.308316957973304, 18.585258465062363, 59.3294569218562, 25.992019313330097, 20.901952322405975, 46.39778007260892, 28.500223387977663, 26.393052647351436, 174.01011343507494, 57.21384562442569, 97.81493831696196, 88.16395966547968, 150.64467243924884, 204.349482520915, 91.43823718414106, 109.96550459746007, 34.54797499392087, 26.7870164299745, 162.49015496142832, 150.41370439068208, 30.172396987296544, 92.19547044395244, 107.49065789496221, 34.919613546713194, 74.71959361585257, 120.9672181827015, 26.802737857227548, 43.91007446525009, 90.13198254097574, 89.67424600472248, 230.48026238939434, 312.2027820454467, 80.10887456622612, 86.0354336595961, 209.44859371029037, 245.22118457998448, 138.9311161535583, 161.1098338839373, 25.719249361199093, 78.2296113850338, 14.889252524513113, 61.26324760306977, 15.04597379290881, 28.412774565698488, 134.99410860363042, 117.62988092806988, 71.43471596395354, 140.37195341887397, 177.3419323300859, 122.36896794150623, 154.62562754819967, 151.3285407225506, 39.98787708135447, 41.42695349019701, 206.9265856193532, 38.35937570314245, 63.151516698825674, 95.55478560262854, 130.69447286719947, 87.3590985791287, 92.12765315465872, 93.50966940989026, 46.12696008388015, 105.70242643646138, 66.20439740153024, 121.56811110328964, 207.4000186596439, 218.66062116180032, 34.0407957441833, 52.76039849642358, 114.25426383618274, 42.75725252915303, 131.52566749601303, 108.74389505912757, 49.394877108051986, 30.911300283690363, 0.16555294915474036, 7.002597623784199, 46.87670256791702, 46.98078279324563, 33.758144546689266, 77.24868952339398, 176.19878665485, 327.27046507687606, 203.63772476669897, 182.74952443049074, 4.38385616513947, 35.05570837117485, 21.020291651331284, 49.06033277901752, 49.17259743645939, 35.105421265057245, 55.48751019801959, 61.763860839403925, 51.31720312311195, 68.93946149462623, 67.03187563332948, 90.61093427387544, 53.92354270407771, 62.13466908320159, 76.75001958842574, 37.04713978556504, 50.78851779832247, 50.94657696783725, 46.9589418174139, 14.218131617153457, 24.84708403939209, 29.813561590584875, 81.8180720095581, 76.24594216784934, 28.52106850529886, 22.953231495405948, 60.36129425591127, 23.95295813946469, 33.95103437295123, 25.667298492329508, 4.188978762361888, 6.262311836845323, 41.07470645237023, 24.00166537290253, 34.19377706284502, 27.769940152452744, 30.475121613277363, 22.09862356088684, 21.268254790872398, 29.964499361789965, 29.763173002018597, 52.98611076849858, 69.58860640619433, 48.30986350770699, 16.31302628872149, 3.749164746975273, 2.7830186688519016, 1.642493069272706, 66.14071743783012, 64.14746011821954, 6.504683601090218, 0.3963551097146964, 26.153931690162157, 29.370300356828334, 0.9330287797366581, 3.9929324404012028, 55.60003546775196, 49.135883959592675, 2.452070263055417, 20.65014778275681, 30.920433448870995, 27.16473125844269, 0.1873126794918254, 0.0, 36.37867155138191, 31.288153726626295, 38.311948613734906, 28.490214073543964, 47.24287716203573, 52.53806167236044, 7.825001172571923, 2.508759700001653, 1.6124872514984383, 31.020784966419615, 7.89892791363924, 4.1494341698018244, 16.085771068957968, 2.789134938488334, 57.56136926338238, 14.13624535053586, 5.258556053457845, 3.5876992665336163, 9.429964001590387, 14.483413208532637, 11.232680051044666, 17.046715131779155, 41.953570800754015, 94.35813898372032, 2.7505419975349077, 21.241496786780854, 22.42126049534606, 52.56947693196721, 6.8327414197971565, 0.6790989113864054, 16.083628701756236, 25.667537889379375, 55.557591706463874, 5.13584787584535, 36.06715664648208, 86.50759349127053, 4.306411568527873, 13.711083056421613, 18.65196438266256, 6.743435744298604, 9.488979281009255, 13.75295591820731]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526076451125657, "mean_inference_ms": 1.536185974299811, "mean_action_processing_ms": 0.22627338511867784, "mean_env_wait_ms": 0.18428995674849105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007070064544677734, "StateBufferConnector_ms": 0.0036919116973876953, "ViewRequirementAgentConnector_ms": 0.10671055316925049}, "num_episodes": 18, "episode_return_max": 323.10151509118685, "episode_return_min": -17.619707674126445, "episode_return_mean": 60.154557527468235, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.32133229020735, "num_env_steps_trained_throughput_per_sec": 306.32133229020735, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 10689.553, "restore_workers_time_ms": 0.012, "training_step_time_ms": 10689.52, "sample_time_ms": 1343.9, "learn_time_ms": 9330.986, "learn_throughput": 428.679, "synch_weights_time_ms": 13.803}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "ef79f_00000", "date": "2024-08-16_11-21-16", "timestamp": 1723787476, "time_this_iter_s": 13.179265975952148, "time_total_s": 253.4625849723816, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32147f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 253.4625849723816, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 49.12222222222223, "ram_util_percent": 80.16111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4972058312602776, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.942787615205876, "policy_loss": -0.009454718953190697, "vf_loss": 5.949712785085042, "vf_explained_var": -0.09544221512855046, "kl": 0.012647781386765184, "entropy": 1.4676926211705283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.704208057078104, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.522724342598486, "policy_loss": -0.009715971868317673, "vf_loss": 6.529380058359217, "vf_explained_var": -0.10570536457672321, "kl": 0.015301315642236437, "entropy": 1.352219620015886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 323.10151509118685, "episode_reward_min": -17.619707674126445, "episode_reward_mean": 74.40694670210821, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -414.17811624655855, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 165.23012522408985, "predator_policy": 327.27046507687606}, "policy_reward_mean": {"prey_policy": -16.85345064390275, "predator_policy": 54.056923994956854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.528783372930151, 13.178770183796477, 2.4294723771935707, 19.436379853688912, 79.62846081936013, 0.526882456803012, 42.0150073687365, 51.686386496703435, 51.09468287079655, -17.619707674126445, 10.704837563702634, 19.056657987158445, 77.52889888291318, -16.43073352844385, 80.4358390612764, 41.08076914326406, 122.46188591861473, 47.07780854937749, 36.07040485670383, 116.86848116527163, 97.45089985099273, -13.82621983730394, 59.101628230319314, 0.4711159472700208, 66.18000000000035, 23.7305556191738, 30.802379466489413, 63.11101273337226, 57.035049298396544, 20.247631615896506, 46.6516404136661, 51.97794828547279, 36.885564929129266, 59.490778081205455, 35.60125318736702, 57.08532687394709, 69.01017870299971, 19.125671246507668, 27.5582299128111, 23.737519988667, 61.735082153631744, 96.43873215969936, 14.893690769826291, 22.676102778199336, 87.36698638210052, 25.778215203062892, 17.320156768626774, 93.39318684584637, 37.316981314201186, 59.97021925717048, 149.03493522489853, 111.51226812825132, 15.13851422269179, 60.92104743083911, 0.9553558618363615, 8.246198450963979, 3.839999999999962, 19.2867615178449, 3.751896532829819, 55.88272802206436, 3.989999999999959, 101.76852689515229, 151.50378871830054, 83.47997771373059, 41.93569080759955, 62.839004223193704, 288.26314971358306, 27.45450970220827, 167.32432752528152, 304.1712089659169, 207.22999999999996, 126.75112044997638, 136.49871416505843, 51.0688676668848, 20.42213778154173, 323.10151509118685, 11.27402404902417, 233.12917111887424, 148.52287693111526, 23.804165426968428, 132.58817832237486, 272.18192678053504, 154.7553811704584, 43.306829830321604, 166.2826767396123, 55.660304989613174, 4.38235420870035, 86.87559594466792, 68.4493150155726, 125.37874196032833, 99.27223008412616, 1.7515097913374722, 248.08216958504602, 125.87712244033538, 247.73540950183468, 105.12134532555415, 212.72739177807014, 156.9869454514521, 54.11924626132458, -2.0199732127257377], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-118.41601725397334, -48.86142791879482, -213.08563745297465, -316.41863679807, -77.55679943943127, -86.15803640919745, -311.24536382571245, -123.98803461087351, -179.73674462810612, -40.67574459002955, -37.41975858044732, -66.00221970898241, 21.93027494411368, -56.067767702960076, 36.134026207091175, -27.906388068994907, -93.87732247402012, -107.65198418688342, -133.71204614270698, -95.71433091424704, -110.94759067531156, -178.05847203257792, -71.1990687567127, -215.69844152687915, -34.15336362726928, 30.26743193863061, -147.729685039589, -113.98700981135062, -111.48863603691576, 33.218172796737775, -62.30914618421612, -114.66365611884802, -30.759834648768525, -32.415601997165986, -109.31615613896594, 4.5645781680018755, -113.06789962368381, -38.6342040244323, 20.260124180153344, -329.452282836327, 56.70112511512701, -46.05141950474218, -88.25632624714832, -82.58140995549127, -156.82908590792303, -24.338848416898156, -37.82043835459272, -42.01462308988002, 2.0000000000000013, 57.01184942706094, -47.3246027157277, -22.80232702626125, 1.9722985420172041, -82.17675314561127, -26.180122751795793, -414.17811624655855, -54.00494331605997, -275.3472565827332, -2.262415051136327, -16.929517869281668, -39.746130828740185, 16.317146812057583, 8.999856150742103, -41.29992656678578, -58.64187373142024, -21.723932376874096, -29.905328390895523, -30.860558145636986, -99.48180823230504, -22.55974848753281, 2.86247671694759, -61.83536163027973, -2.1237942570476003, -42.6631864139433, -51.32449654974987, -31.284926969902127, -34.560383083581534, 0.9415395618250485, -4.163519992608864, -26.759605648701292, 1.0524143699534723, -97.38134639372892, -24.096920873873625, 69.06135303286783, -53.95532023982146, -15.465241385728289, 2.0000000000000013, -38.94223008708133, 59.10839106253508, 17.807304720357735, -13.788706886747201, -25.509449735462653, -48.60252410647024, 3.958963659799181, 39.01282659171498, 1.806615079967069, 2.0000000000000013, -15.915772838461196, -0.06285454647835348, -22.716209966867957, -62.12974496076676, 93.26621027176392, 2.0000000000000013, 89.45007709255437, 2.0000000000000013, 8.713002484567227, -70.18657980331947, 0.8194496781090951, -4.1159828217809675, -1.8297000271876458, -21.341709633558427, -25.93632396246769, -2.112932440401243, 1.0269712202633432, -73.14895942952096, -12.300198479978887, -19.210147782756586, -0.14017373022556257, 2.040581573528552, -4.243018258777963, 2.0000000000000013, 1.802687320508176, 63.69371418749237, -29.592012570348732, 19.543932144289982, 65.15769388673257, 55.36324946610912, -71.66421058677449, 30.521224735493714, 1.0807051995323793, 32.70152535563561, -2.4957933503599197, 136.69354143357089, 139.52124619657133, 21.462153520552846, -12.88254982579114, 50.26562794916344, 45.361084962199875, 165.23012522408985, 130.0948284218364, 78.71639298240918, 104.60022980746781, -4.062432868220459, 102.53415813537276, 15.633587213202738, -15.446582832618653, 1.3884257513833953, 25.688403131185844, -29.213843539754095, -25.354756106017426, 160.33132927329737, 155.25834548670608, -34.457142542111306, 3.980000000000001, 80.38391162091773, 92.0518199156473, -14.362147311888926, 40.31027410525152, 2.0000000000000013, 3.786670802018971, -0.6227692145486219, 107.81554740996214, 133.10478447968805, 115.83520710163073, 29.38770722988292, -15.357271550193158, -12.905365102140056, -5.703027534797705, 40.82733148128051, 38.30969331619272, -57.42789277740803, 13.265274266671625, 1.7972642237643857, 0.2918062523729105, 25.326744406988993, 23.72678292810102, -8.619618103080214, -7.750757952518571, -21.837329577057933, -11.508385190926713, -7.692209170536034, 43.49949377732676, -1.8216733966205152, -3.6135806627016587, 118.20639218935851, 47.7760113326523, 2.0000000000000013, 81.81764267374197, 139.40769006579774, 36.51248001527121, -15.007583137362062, 67.37314083463284, 106.9461047780926, 73.67076082155083, -9.751152664435212, 12.93438452449396, -48.99140458384822, -39.31082662970041, -11.001728357818406, -7.990129712824224], "policy_predator_policy_reward": [90.13198254097574, 89.67424600472248, 230.48026238939434, 312.2027820454467, 80.10887456622612, 86.0354336595961, 209.44859371029037, 245.22118457998448, 138.9311161535583, 161.1098338839373, 25.719249361199093, 78.2296113850338, 14.889252524513113, 61.26324760306977, 15.04597379290881, 28.412774565698488, 134.99410860363042, 117.62988092806988, 71.43471596395354, 140.37195341887397, 177.3419323300859, 122.36896794150623, 154.62562754819967, 151.3285407225506, 39.98787708135447, 41.42695349019701, 206.9265856193532, 38.35937570314245, 63.151516698825674, 95.55478560262854, 130.69447286719947, 87.3590985791287, 92.12765315465872, 93.50966940989026, 46.12696008388015, 105.70242643646138, 66.20439740153024, 121.56811110328964, 207.4000186596439, 218.66062116180032, 34.0407957441833, 52.76039849642358, 114.25426383618274, 42.75725252915303, 131.52566749601303, 108.74389505912757, 49.394877108051986, 30.911300283690363, 0.16555294915474036, 7.002597623784199, 46.87670256791702, 46.98078279324563, 33.758144546689266, 77.24868952339398, 176.19878665485, 327.27046507687606, 203.63772476669897, 182.74952443049074, 4.38385616513947, 35.05570837117485, 21.020291651331284, 49.06033277901752, 49.17259743645939, 35.105421265057245, 55.48751019801959, 61.763860839403925, 51.31720312311195, 68.93946149462623, 67.03187563332948, 90.61093427387544, 53.92354270407771, 62.13466908320159, 76.75001958842574, 37.04713978556504, 50.78851779832247, 50.94657696783725, 46.9589418174139, 14.218131617153457, 24.84708403939209, 29.813561590584875, 81.8180720095581, 76.24594216784934, 28.52106850529886, 22.953231495405948, 60.36129425591127, 23.95295813946469, 33.95103437295123, 25.667298492329508, 4.188978762361888, 6.262311836845323, 41.07470645237023, 24.00166537290253, 34.19377706284502, 27.769940152452744, 30.475121613277363, 22.09862356088684, 21.268254790872398, 29.964499361789965, 29.763173002018597, 52.98611076849858, 69.58860640619433, 48.30986350770699, 16.31302628872149, 3.749164746975273, 2.7830186688519016, 1.642493069272706, 66.14071743783012, 64.14746011821954, 6.504683601090218, 0.3963551097146964, 26.153931690162157, 29.370300356828334, 0.9330287797366581, 3.9929324404012028, 55.60003546775196, 49.135883959592675, 2.452070263055417, 20.65014778275681, 30.920433448870995, 27.16473125844269, 0.1873126794918254, 0.0, 36.37867155138191, 31.288153726626295, 38.311948613734906, 28.490214073543964, 47.24287716203573, 52.53806167236044, 7.825001172571923, 2.508759700001653, 1.6124872514984383, 31.020784966419615, 7.89892791363924, 4.1494341698018244, 16.085771068957968, 2.789134938488334, 57.56136926338238, 14.13624535053586, 5.258556053457845, 3.5876992665336163, 9.429964001590387, 14.483413208532637, 11.232680051044666, 17.046715131779155, 41.953570800754015, 94.35813898372032, 2.7505419975349077, 21.241496786780854, 22.42126049534606, 52.56947693196721, 6.8327414197971565, 0.6790989113864054, 16.083628701756236, 25.667537889379375, 55.557591706463874, 5.13584787584535, 36.06715664648208, 86.50759349127053, 4.306411568527873, 13.711083056421613, 18.65196438266256, 6.743435744298604, 9.488979281009255, 13.75295591820731, 87.16443111484604, 53.560514375922665, 38.9919042897768, 22.92331817748259, 55.767055103952806, 31.378596838186155, 41.75357168482999, 58.069351815519816, 1.298652469705462, 0.9946312628576438, 12.996292743210473, 24.825775866367717, 82.12539726122121, 2.694293809950225, 80.57782341730002, 78.14663331101293, 36.394672686305405, 27.070272791030074, 1.1164926160195359, 6.070271234640034, 35.8183380010842, 46.28142806195097, 27.145057071337682, 14.9144226952555, 42.89745855109825, 28.91778086966738, 9.110015066976507, 43.64577256130687, 11.775893266035048, 20.334632912391836, 64.37138227328194, 89.43233131811148, 111.43767857937993, 30.983798895493212, 1.0923175176133264, 15.879567340303563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5331375530268291, "mean_inference_ms": 1.562246928049801, "mean_action_processing_ms": 0.2330155614464128, "mean_env_wait_ms": 0.18688248053202475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007606148719787598, "StateBufferConnector_ms": 0.0037004947662353516, "ViewRequirementAgentConnector_ms": 0.14145994186401367}, "num_episodes": 18, "episode_return_max": 323.10151509118685, "episode_return_min": -17.619707674126445, "episode_return_mean": 74.40694670210821, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.21878170521396, "num_env_steps_trained_throughput_per_sec": 235.21878170521396, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 11380.277, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11380.242, "sample_time_ms": 1528.589, "learn_time_ms": 9836.715, "learn_throughput": 406.64, "synch_weights_time_ms": 14.111}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "ef79f_00000", "date": "2024-08-16_11-21-33", "timestamp": 1723787493, "time_this_iter_s": 17.030976057052612, "time_total_s": 270.4935610294342, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32140f040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 270.4935610294342, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 73.808, "ram_util_percent": 82.88}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.749582590344091, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.150033900599, "policy_loss": -0.021453170652289397, "vf_loss": 7.167331611794769, "vf_explained_var": 0.015483424556318414, "kl": 0.02077730503740645, "entropy": 1.4381008365797618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.459027383567164, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4992175652236535, "policy_loss": -0.00518761968841313, "vf_loss": 7.502622424231635, "vf_explained_var": -0.029230441744365388, "kl": 0.008913776401196548, "entropy": 1.2176890614802245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 323.10151509118685, "episode_reward_min": -2.0199732127257377, "episode_reward_mean": 88.24997342931532, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -414.17811624655855, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 165.23012522408985, "predator_policy": 327.27046507687606}, "policy_reward_mean": {"prey_policy": 3.790429492512636, "predator_policy": 40.33455722214502}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.101628230319314, 0.4711159472700208, 66.18000000000035, 23.7305556191738, 30.802379466489413, 63.11101273337226, 57.035049298396544, 20.247631615896506, 46.6516404136661, 51.97794828547279, 36.885564929129266, 59.490778081205455, 35.60125318736702, 57.08532687394709, 69.01017870299971, 19.125671246507668, 27.5582299128111, 23.737519988667, 61.735082153631744, 96.43873215969936, 14.893690769826291, 22.676102778199336, 87.36698638210052, 25.778215203062892, 17.320156768626774, 93.39318684584637, 37.316981314201186, 59.97021925717048, 149.03493522489853, 111.51226812825132, 15.13851422269179, 60.92104743083911, 0.9553558618363615, 8.246198450963979, 3.839999999999962, 19.2867615178449, 3.751896532829819, 55.88272802206436, 3.989999999999959, 101.76852689515229, 151.50378871830054, 83.47997771373059, 41.93569080759955, 62.839004223193704, 288.26314971358306, 27.45450970220827, 167.32432752528152, 304.1712089659169, 207.22999999999996, 126.75112044997638, 136.49871416505843, 51.0688676668848, 20.42213778154173, 323.10151509118685, 11.27402404902417, 233.12917111887424, 148.52287693111526, 23.804165426968428, 132.58817832237486, 272.18192678053504, 154.7553811704584, 43.306829830321604, 166.2826767396123, 55.660304989613174, 4.38235420870035, 86.87559594466792, 68.4493150155726, 125.37874196032833, 99.27223008412616, 1.7515097913374722, 248.08216958504602, 125.87712244033538, 247.73540950183468, 105.12134532555415, 212.72739177807014, 156.9869454514521, 54.11924626132458, -2.0199732127257377, 102.75199432178248, 41.64325121169125, 128.3473327802372, 6.873667480334443, 60.47995400099633, 48.83728771705813, 214.7260089256133, 196.29996566827265, 102.62026335756016, 38.284385323580935, 75.65852463428511, 130.31605898433097, 136.2735810368046, 96.97050689438369, 201.55983442163046, 164.24140016203572, 80.28777755823793, 55.828867646925126, 99.04735204753737, 3.9999999999999587, 75.22194750876108, 197.4173587780612], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-156.82908590792303, -24.338848416898156, -37.82043835459272, -42.01462308988002, 2.0000000000000013, 57.01184942706094, -47.3246027157277, -22.80232702626125, 1.9722985420172041, -82.17675314561127, -26.180122751795793, -414.17811624655855, -54.00494331605997, -275.3472565827332, -2.262415051136327, -16.929517869281668, -39.746130828740185, 16.317146812057583, 8.999856150742103, -41.29992656678578, -58.64187373142024, -21.723932376874096, -29.905328390895523, -30.860558145636986, -99.48180823230504, -22.55974848753281, 2.86247671694759, -61.83536163027973, -2.1237942570476003, -42.6631864139433, -51.32449654974987, -31.284926969902127, -34.560383083581534, 0.9415395618250485, -4.163519992608864, -26.759605648701292, 1.0524143699534723, -97.38134639372892, -24.096920873873625, 69.06135303286783, -53.95532023982146, -15.465241385728289, 2.0000000000000013, -38.94223008708133, 59.10839106253508, 17.807304720357735, -13.788706886747201, -25.509449735462653, -48.60252410647024, 3.958963659799181, 39.01282659171498, 1.806615079967069, 2.0000000000000013, -15.915772838461196, -0.06285454647835348, -22.716209966867957, -62.12974496076676, 93.26621027176392, 2.0000000000000013, 89.45007709255437, 2.0000000000000013, 8.713002484567227, -70.18657980331947, 0.8194496781090951, -4.1159828217809675, -1.8297000271876458, -21.341709633558427, -25.93632396246769, -2.112932440401243, 1.0269712202633432, -73.14895942952096, -12.300198479978887, -19.210147782756586, -0.14017373022556257, 2.040581573528552, -4.243018258777963, 2.0000000000000013, 1.802687320508176, 63.69371418749237, -29.592012570348732, 19.543932144289982, 65.15769388673257, 55.36324946610912, -71.66421058677449, 30.521224735493714, 1.0807051995323793, 32.70152535563561, -2.4957933503599197, 136.69354143357089, 139.52124619657133, 21.462153520552846, -12.88254982579114, 50.26562794916344, 45.361084962199875, 165.23012522408985, 130.0948284218364, 78.71639298240918, 104.60022980746781, -4.062432868220459, 102.53415813537276, 15.633587213202738, -15.446582832618653, 1.3884257513833953, 25.688403131185844, -29.213843539754095, -25.354756106017426, 160.33132927329737, 155.25834548670608, -34.457142542111306, 3.980000000000001, 80.38391162091773, 92.0518199156473, -14.362147311888926, 40.31027410525152, 2.0000000000000013, 3.786670802018971, -0.6227692145486219, 107.81554740996214, 133.10478447968805, 115.83520710163073, 29.38770722988292, -15.357271550193158, -12.905365102140056, -5.703027534797705, 40.82733148128051, 38.30969331619272, -57.42789277740803, 13.265274266671625, 1.7972642237643857, 0.2918062523729105, 25.326744406988993, 23.72678292810102, -8.619618103080214, -7.750757952518571, -21.837329577057933, -11.508385190926713, -7.692209170536034, 43.49949377732676, -1.8216733966205152, -3.6135806627016587, 118.20639218935851, 47.7760113326523, 2.0000000000000013, 81.81764267374197, 139.40769006579774, 36.51248001527121, -15.007583137362062, 67.37314083463284, 106.9461047780926, 73.67076082155083, -9.751152664435212, 12.93438452449396, -48.99140458384822, -39.31082662970041, -11.001728357818406, -7.990129712824224, 46.29814518592599, 1.8289414947476488, -16.861333545705744, -30.07229443199069, 81.22750185822788, -53.9196334457242, -14.729909593806461, 0.8821332486186543, -5.211121746260502, 11.346492328545999, -115.13867782784486, -43.2728300797008, 80.28927984542376, 67.96839132614659, 17.85537491606047, 101.16401390877326, -69.48212089921016, 42.589999999999684, -3.3370830179687356, -68.32742660825005, 9.696460675995958, -58.6789654255838, 0.041330863601265644, 43.42515560780397, 56.80031965424176, 20.205806786414556, 14.55821259292028, -8.007719390636165, 13.86958320652221, 102.6173809399568, 77.20243991538922, -149.41136353758822, -11.683887879161162, 0.7279515018498197, -11.330792171662697, -88.10432570171551, -8.869850704056905, -6.2797170211074045, 2.0000000000000013, 2.0000000000000013, 1.3714837046642219, 33.56677574342339, 87.72971632401261, 12.043456538839811], "policy_predator_policy_reward": [131.52566749601303, 108.74389505912757, 49.394877108051986, 30.911300283690363, 0.16555294915474036, 7.002597623784199, 46.87670256791702, 46.98078279324563, 33.758144546689266, 77.24868952339398, 176.19878665485, 327.27046507687606, 203.63772476669897, 182.74952443049074, 4.38385616513947, 35.05570837117485, 21.020291651331284, 49.06033277901752, 49.17259743645939, 35.105421265057245, 55.48751019801959, 61.763860839403925, 51.31720312311195, 68.93946149462623, 67.03187563332948, 90.61093427387544, 53.92354270407771, 62.13466908320159, 76.75001958842574, 37.04713978556504, 50.78851779832247, 50.94657696783725, 46.9589418174139, 14.218131617153457, 24.84708403939209, 29.813561590584875, 81.8180720095581, 76.24594216784934, 28.52106850529886, 22.953231495405948, 60.36129425591127, 23.95295813946469, 33.95103437295123, 25.667298492329508, 4.188978762361888, 6.262311836845323, 41.07470645237023, 24.00166537290253, 34.19377706284502, 27.769940152452744, 30.475121613277363, 22.09862356088684, 21.268254790872398, 29.964499361789965, 29.763173002018597, 52.98611076849858, 69.58860640619433, 48.30986350770699, 16.31302628872149, 3.749164746975273, 2.7830186688519016, 1.642493069272706, 66.14071743783012, 64.14746011821954, 6.504683601090218, 0.3963551097146964, 26.153931690162157, 29.370300356828334, 0.9330287797366581, 3.9929324404012028, 55.60003546775196, 49.135883959592675, 2.452070263055417, 20.65014778275681, 30.920433448870995, 27.16473125844269, 0.1873126794918254, 0.0, 36.37867155138191, 31.288153726626295, 38.311948613734906, 28.490214073543964, 47.24287716203573, 52.53806167236044, 7.825001172571923, 2.508759700001653, 1.6124872514984383, 31.020784966419615, 7.89892791363924, 4.1494341698018244, 16.085771068957968, 2.789134938488334, 57.56136926338238, 14.13624535053586, 5.258556053457845, 3.5876992665336163, 9.429964001590387, 14.483413208532637, 11.232680051044666, 17.046715131779155, 41.953570800754015, 94.35813898372032, 2.7505419975349077, 21.241496786780854, 22.42126049534606, 52.56947693196721, 6.8327414197971565, 0.6790989113864054, 16.083628701756236, 25.667537889379375, 55.557591706463874, 5.13584787584535, 36.06715664648208, 86.50759349127053, 4.306411568527873, 13.711083056421613, 18.65196438266256, 6.743435744298604, 9.488979281009255, 13.75295591820731, 87.16443111484604, 53.560514375922665, 38.9919042897768, 22.92331817748259, 55.767055103952806, 31.378596838186155, 41.75357168482999, 58.069351815519816, 1.298652469705462, 0.9946312628576438, 12.996292743210473, 24.825775866367717, 82.12539726122121, 2.694293809950225, 80.57782341730002, 78.14663331101293, 36.394672686305405, 27.070272791030074, 1.1164926160195359, 6.070271234640034, 35.8183380010842, 46.28142806195097, 27.145057071337682, 14.9144226952555, 42.89745855109825, 28.91778086966738, 9.110015066976507, 43.64577256130687, 11.775893266035048, 20.334632912391836, 64.37138227328194, 89.43233131811148, 111.43767857937993, 30.983798895493212, 1.0923175176133264, 15.879567340303563, 41.25286081535625, 13.372046825752335, 43.24196035038009, 45.33491883900727, 41.5790845006956, 59.46037986703774, 4.251534231715866, 16.469909593806502, 39.20231366190592, 15.14226975680488, 117.94042386669372, 89.30837175791007, 35.217391683427934, 31.25094607061503, 25.99578803111919, 51.28478881232005, 69.04759170555224, 60.464792551217656, 53.90872868503731, 56.04016626476219, 42.83833376715932, 81.80269561671352, 53.40335337369862, 33.446219139227225, 16.087787299472573, 43.179667296675746, 43.968452704414034, 46.45156098768535, 25.052777819542154, 60.020092455609145, 144.43252181177803, 92.01780197245662, 21.685277812899688, 69.55843612264944, 72.90195027629571, 82.36203524400773, 64.66096501704409, 49.535954755657585, 0.0, 0.0, 11.990441992403486, 28.293246068269355, 44.472504512839265, 53.17168140236953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5415833271127688, "mean_inference_ms": 1.597148955587734, "mean_action_processing_ms": 0.24085205764574535, "mean_env_wait_ms": 0.19030804490721454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008408427238464355, "StateBufferConnector_ms": 0.0036687850952148438, "ViewRequirementAgentConnector_ms": 0.14027047157287598}, "num_episodes": 22, "episode_return_max": 323.10151509118685, "episode_return_min": -2.0199732127257377, "episode_return_mean": 88.24997342931532, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.41758001121764, "num_env_steps_trained_throughput_per_sec": 338.41758001121764, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 11577.512, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11577.476, "sample_time_ms": 1542.6, "learn_time_ms": 10019.716, "learn_throughput": 399.213, "synch_weights_time_ms": 14.328}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "ef79f_00000", "date": "2024-08-16_11-21-45", "timestamp": 1723787505, "time_this_iter_s": 11.826077938079834, "time_total_s": 282.31963896751404, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 282.31963896751404, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 46.525, "ram_util_percent": 81.88749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.063859828723171, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.927426639561931, "policy_loss": -0.0055641862889012645, "vf_loss": 4.931150898353133, "vf_explained_var": -0.004125888259322555, "kl": 0.006133083762116884, "entropy": 1.417531894628333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9685472266383903, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.350356498218718, "policy_loss": -0.004928504009164436, "vf_loss": 3.3535515795309077, "vf_explained_var": 0.013463492589022116, "kl": 0.008667124085545102, "entropy": 1.1927226484767974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 323.10151509118685, "episode_reward_min": -2.0199732127257377, "episode_reward_mean": 110.1577054626885, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -149.41136353758822, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.31858458253288, "predator_policy": 144.43252181177803}, "policy_reward_mean": {"prey_policy": 25.11373596617377, "predator_policy": 29.965116765170478}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.778215203062892, 17.320156768626774, 93.39318684584637, 37.316981314201186, 59.97021925717048, 149.03493522489853, 111.51226812825132, 15.13851422269179, 60.92104743083911, 0.9553558618363615, 8.246198450963979, 3.839999999999962, 19.2867615178449, 3.751896532829819, 55.88272802206436, 3.989999999999959, 101.76852689515229, 151.50378871830054, 83.47997771373059, 41.93569080759955, 62.839004223193704, 288.26314971358306, 27.45450970220827, 167.32432752528152, 304.1712089659169, 207.22999999999996, 126.75112044997638, 136.49871416505843, 51.0688676668848, 20.42213778154173, 323.10151509118685, 11.27402404902417, 233.12917111887424, 148.52287693111526, 23.804165426968428, 132.58817832237486, 272.18192678053504, 154.7553811704584, 43.306829830321604, 166.2826767396123, 55.660304989613174, 4.38235420870035, 86.87559594466792, 68.4493150155726, 125.37874196032833, 99.27223008412616, 1.7515097913374722, 248.08216958504602, 125.87712244033538, 247.73540950183468, 105.12134532555415, 212.72739177807014, 156.9869454514521, 54.11924626132458, -2.0199732127257377, 102.75199432178248, 41.64325121169125, 128.3473327802372, 6.873667480334443, 60.47995400099633, 48.83728771705813, 214.7260089256133, 196.29996566827265, 102.62026335756016, 38.284385323580935, 75.65852463428511, 130.31605898433097, 136.2735810368046, 96.97050689438369, 201.55983442163046, 164.24140016203572, 80.28777755823793, 55.828867646925126, 99.04735204753737, 3.9999999999999587, 75.22194750876108, 197.4173587780612, 245.98106833855493, 105.01099758399901, 6.241338390962366, 150.6292801065247, 49.30456487247325, 4.709888353918843, 168.42923493064822, 307.2013220462263, 116.4756597016634, 313.7191341640656, 160.43717863432323, 183.11085786851737, 183.53225949179796, 60.75138998229329, 135.78566718426364, 132.9959958425127, 5.2307991131141085, 87.85068986983282, 56.29999999999996, 142.498485230347, 144.30000000000024, 283.2820971527947, 177.90937325463116], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.788706886747201, -25.509449735462653, -48.60252410647024, 3.958963659799181, 39.01282659171498, 1.806615079967069, 2.0000000000000013, -15.915772838461196, -0.06285454647835348, -22.716209966867957, -62.12974496076676, 93.26621027176392, 2.0000000000000013, 89.45007709255437, 2.0000000000000013, 8.713002484567227, -70.18657980331947, 0.8194496781090951, -4.1159828217809675, -1.8297000271876458, -21.341709633558427, -25.93632396246769, -2.112932440401243, 1.0269712202633432, -73.14895942952096, -12.300198479978887, -19.210147782756586, -0.14017373022556257, 2.040581573528552, -4.243018258777963, 2.0000000000000013, 1.802687320508176, 63.69371418749237, -29.592012570348732, 19.543932144289982, 65.15769388673257, 55.36324946610912, -71.66421058677449, 30.521224735493714, 1.0807051995323793, 32.70152535563561, -2.4957933503599197, 136.69354143357089, 139.52124619657133, 21.462153520552846, -12.88254982579114, 50.26562794916344, 45.361084962199875, 165.23012522408985, 130.0948284218364, 78.71639298240918, 104.60022980746781, -4.062432868220459, 102.53415813537276, 15.633587213202738, -15.446582832618653, 1.3884257513833953, 25.688403131185844, -29.213843539754095, -25.354756106017426, 160.33132927329737, 155.25834548670608, -34.457142542111306, 3.980000000000001, 80.38391162091773, 92.0518199156473, -14.362147311888926, 40.31027410525152, 2.0000000000000013, 3.786670802018971, -0.6227692145486219, 107.81554740996214, 133.10478447968805, 115.83520710163073, 29.38770722988292, -15.357271550193158, -12.905365102140056, -5.703027534797705, 40.82733148128051, 38.30969331619272, -57.42789277740803, 13.265274266671625, 1.7972642237643857, 0.2918062523729105, 25.326744406988993, 23.72678292810102, -8.619618103080214, -7.750757952518571, -21.837329577057933, -11.508385190926713, -7.692209170536034, 43.49949377732676, -1.8216733966205152, -3.6135806627016587, 118.20639218935851, 47.7760113326523, 2.0000000000000013, 81.81764267374197, 139.40769006579774, 36.51248001527121, -15.007583137362062, 67.37314083463284, 106.9461047780926, 73.67076082155083, -9.751152664435212, 12.93438452449396, -48.99140458384822, -39.31082662970041, -11.001728357818406, -7.990129712824224, 46.29814518592599, 1.8289414947476488, -16.861333545705744, -30.07229443199069, 81.22750185822788, -53.9196334457242, -14.729909593806461, 0.8821332486186543, -5.211121746260502, 11.346492328545999, -115.13867782784486, -43.2728300797008, 80.28927984542376, 67.96839132614659, 17.85537491606047, 101.16401390877326, -69.48212089921016, 42.589999999999684, -3.3370830179687356, -68.32742660825005, 9.696460675995958, -58.6789654255838, 0.041330863601265644, 43.42515560780397, 56.80031965424176, 20.205806786414556, 14.55821259292028, -8.007719390636165, 13.86958320652221, 102.6173809399568, 77.20243991538922, -149.41136353758822, -11.683887879161162, 0.7279515018498197, -11.330792171662697, -88.10432570171551, -8.869850704056905, -6.2797170211074045, 2.0000000000000013, 2.0000000000000013, 1.3714837046642219, 33.56677574342339, 87.72971632401261, 12.043456538839811, 125.8146697680928, 33.23743540692013, 67.78913577230607, -23.841156683299978, -8.664781201566262, 0.23531984875779627, 2.0000000000000013, 137.8534375218067, 8.523911378355947, 27.051033037179167, 2.0000000000000013, -0.6568533413515476, -4.792846613941189, 157.34192695722749, 92.61515258814757, 167.70343505092444, 35.719556651147755, -48.380913898289435, 164.45979853752135, 126.98664778136505, 135.53712526970878, 2.0000000000000013, 176.31858458253288, -6.599670991989932, 146.0878927565335, 27.74000000000027, 31.592653872196873, 2.0000000000000013, -51.90659360247001, 81.4603932774022, 0.5398240836064726, 120.21908869246987, -11.230348704058033, -3.0773300089653866, -1.2132282484907086, 43.00058297892582, 48.992852456788526, 1.8422618188741733, 2.0000000000000013, 133.72143791829973, 121.51872522509144, 14.374084026375197, 139.79099206458224, 100.55145367198558, 162.0812496399291, -7.525704972738454], "policy_predator_policy_reward": [41.07470645237023, 24.00166537290253, 34.19377706284502, 27.769940152452744, 30.475121613277363, 22.09862356088684, 21.268254790872398, 29.964499361789965, 29.763173002018597, 52.98611076849858, 69.58860640619433, 48.30986350770699, 16.31302628872149, 3.749164746975273, 2.7830186688519016, 1.642493069272706, 66.14071743783012, 64.14746011821954, 6.504683601090218, 0.3963551097146964, 26.153931690162157, 29.370300356828334, 0.9330287797366581, 3.9929324404012028, 55.60003546775196, 49.135883959592675, 2.452070263055417, 20.65014778275681, 30.920433448870995, 27.16473125844269, 0.1873126794918254, 0.0, 36.37867155138191, 31.288153726626295, 38.311948613734906, 28.490214073543964, 47.24287716203573, 52.53806167236044, 7.825001172571923, 2.508759700001653, 1.6124872514984383, 31.020784966419615, 7.89892791363924, 4.1494341698018244, 16.085771068957968, 2.789134938488334, 57.56136926338238, 14.13624535053586, 5.258556053457845, 3.5876992665336163, 9.429964001590387, 14.483413208532637, 11.232680051044666, 17.046715131779155, 41.953570800754015, 94.35813898372032, 2.7505419975349077, 21.241496786780854, 22.42126049534606, 52.56947693196721, 6.8327414197971565, 0.6790989113864054, 16.083628701756236, 25.667537889379375, 55.557591706463874, 5.13584787584535, 36.06715664648208, 86.50759349127053, 4.306411568527873, 13.711083056421613, 18.65196438266256, 6.743435744298604, 9.488979281009255, 13.75295591820731, 87.16443111484604, 53.560514375922665, 38.9919042897768, 22.92331817748259, 55.767055103952806, 31.378596838186155, 41.75357168482999, 58.069351815519816, 1.298652469705462, 0.9946312628576438, 12.996292743210473, 24.825775866367717, 82.12539726122121, 2.694293809950225, 80.57782341730002, 78.14663331101293, 36.394672686305405, 27.070272791030074, 1.1164926160195359, 6.070271234640034, 35.8183380010842, 46.28142806195097, 27.145057071337682, 14.9144226952555, 42.89745855109825, 28.91778086966738, 9.110015066976507, 43.64577256130687, 11.775893266035048, 20.334632912391836, 64.37138227328194, 89.43233131811148, 111.43767857937993, 30.983798895493212, 1.0923175176133264, 15.879567340303563, 41.25286081535625, 13.372046825752335, 43.24196035038009, 45.33491883900727, 41.5790845006956, 59.46037986703774, 4.251534231715866, 16.469909593806502, 39.20231366190592, 15.14226975680488, 117.94042386669372, 89.30837175791007, 35.217391683427934, 31.25094607061503, 25.99578803111919, 51.28478881232005, 69.04759170555224, 60.464792551217656, 53.90872868503731, 56.04016626476219, 42.83833376715932, 81.80269561671352, 53.40335337369862, 33.446219139227225, 16.087787299472573, 43.179667296675746, 43.968452704414034, 46.45156098768535, 25.052777819542154, 60.020092455609145, 144.43252181177803, 92.01780197245662, 21.685277812899688, 69.55843612264944, 72.90195027629571, 82.36203524400773, 64.66096501704409, 49.535954755657585, 0.0, 0.0, 11.990441992403486, 28.293246068269355, 44.472504512839265, 53.17168140236953, 41.24133009306041, 45.687633070481645, 31.43269293160345, 29.630325563389395, 2.3760185422046463, 12.294781201566229, 4.909483187605141, 5.866359397112824, 9.788394431802324, 3.941226025136601, 2.1032324061237957, 1.2635092891466404, 9.879915906364774, 6.0002386809972315, 16.218524169686134, 30.664210237468268, 46.55816963536074, 82.57884731344417, 6.484962682153073, 15.787725163026124, 17.15613955895309, 5.743913805661299, 2.526113895060149, 10.865830382914384, 1.7777504147886716, 7.9266163204759525, 15.624656951209058, 11.53407915888784, 39.43141782778722, 66.80044968154392, 8.587627724164642, 3.6494553422714597, 11.872525858219946, 7.6659519679175725, 20.36538373312399, 25.69795140627365, 0.147738181125828, 5.317147543211448, 3.122624861147566, 3.654422450899553, 2.1712747749085457, 6.235915973624769, 17.263346489243514, 25.67630492698333, 3.120149746828329, 20.23367884061223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526622287284105, "mean_inference_ms": 1.6298160031374342, "mean_action_processing_ms": 0.24982772172510917, "mean_env_wait_ms": 0.19413831481130928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008571267127990723, "StateBufferConnector_ms": 0.009363889694213867, "ViewRequirementAgentConnector_ms": 0.14515972137451172}, "num_episodes": 23, "episode_return_max": 323.10151509118685, "episode_return_min": -2.0199732127257377, "episode_return_mean": 110.1577054626885, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.8545753584182, "num_env_steps_trained_throughput_per_sec": 323.8545753584182, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 11843.135, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11843.1, "sample_time_ms": 1582.444, "learn_time_ms": 10245.281, "learn_throughput": 390.424, "synch_weights_time_ms": 14.486}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "ef79f_00000", "date": "2024-08-16_11-21-57", "timestamp": 1723787517, "time_this_iter_s": 12.35880184173584, "time_total_s": 294.6784408092499, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b85e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 294.6784408092499, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 47.84444444444445, "ram_util_percent": 81.71666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6567116688483607, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.246717595297193, "policy_loss": -0.005686234658160223, "vf_loss": 5.250346153375333, "vf_explained_var": 0.09144689491186192, "kl": 0.006858960151500381, "entropy": 1.3972261619315576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0799707601940822, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.372646231972982, "policy_loss": -0.006448332002391378, "vf_loss": 1.3778236773278978, "vf_explained_var": 0.1062318051618243, "kl": 0.006354422536325305, "entropy": 1.1440941927924988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 343.50274423122795, "episode_reward_min": -2.0199732127257377, "episode_reward_mean": 129.64751591115228, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -149.41136353758822, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 181.05354871689383, "predator_policy": 144.43252181177803}, "policy_reward_mean": {"prey_policy": 38.22267442639426, "predator_policy": 26.601083529181896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.47997771373059, 41.93569080759955, 62.839004223193704, 288.26314971358306, 27.45450970220827, 167.32432752528152, 304.1712089659169, 207.22999999999996, 126.75112044997638, 136.49871416505843, 51.0688676668848, 20.42213778154173, 323.10151509118685, 11.27402404902417, 233.12917111887424, 148.52287693111526, 23.804165426968428, 132.58817832237486, 272.18192678053504, 154.7553811704584, 43.306829830321604, 166.2826767396123, 55.660304989613174, 4.38235420870035, 86.87559594466792, 68.4493150155726, 125.37874196032833, 99.27223008412616, 1.7515097913374722, 248.08216958504602, 125.87712244033538, 247.73540950183468, 105.12134532555415, 212.72739177807014, 156.9869454514521, 54.11924626132458, -2.0199732127257377, 102.75199432178248, 41.64325121169125, 128.3473327802372, 6.873667480334443, 60.47995400099633, 48.83728771705813, 214.7260089256133, 196.29996566827265, 102.62026335756016, 38.284385323580935, 75.65852463428511, 130.31605898433097, 136.2735810368046, 96.97050689438369, 201.55983442163046, 164.24140016203572, 80.28777755823793, 55.828867646925126, 99.04735204753737, 3.9999999999999587, 75.22194750876108, 197.4173587780612, 245.98106833855493, 105.01099758399901, 6.241338390962366, 150.6292801065247, 49.30456487247325, 4.709888353918843, 168.42923493064822, 307.2013220462263, 116.4756597016634, 313.7191341640656, 160.43717863432323, 183.11085786851737, 183.53225949179796, 60.75138998229329, 135.78566718426364, 132.9959958425127, 5.2307991131141085, 87.85068986983282, 56.29999999999996, 142.498485230347, 144.30000000000024, 283.2820971527947, 177.90937325463116, 173.0839097167914, 298.43993237445835, 181.2566611967756, 86.4784296768763, 4.448434976625767, 176.42753587279643, 3.9099999999999606, 343.50274423122795, 109.3710262916089, 52.35420931302589, 5.132490550892701, 189.17655395424214, 331.09453347621854, 317.31619706450965, 6.032563281892023, 135.99276331070172, 196.78778669015014, 257.7860532621678], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [55.36324946610912, -71.66421058677449, 30.521224735493714, 1.0807051995323793, 32.70152535563561, -2.4957933503599197, 136.69354143357089, 139.52124619657133, 21.462153520552846, -12.88254982579114, 50.26562794916344, 45.361084962199875, 165.23012522408985, 130.0948284218364, 78.71639298240918, 104.60022980746781, -4.062432868220459, 102.53415813537276, 15.633587213202738, -15.446582832618653, 1.3884257513833953, 25.688403131185844, -29.213843539754095, -25.354756106017426, 160.33132927329737, 155.25834548670608, -34.457142542111306, 3.980000000000001, 80.38391162091773, 92.0518199156473, -14.362147311888926, 40.31027410525152, 2.0000000000000013, 3.786670802018971, -0.6227692145486219, 107.81554740996214, 133.10478447968805, 115.83520710163073, 29.38770722988292, -15.357271550193158, -12.905365102140056, -5.703027534797705, 40.82733148128051, 38.30969331619272, -57.42789277740803, 13.265274266671625, 1.7972642237643857, 0.2918062523729105, 25.326744406988993, 23.72678292810102, -8.619618103080214, -7.750757952518571, -21.837329577057933, -11.508385190926713, -7.692209170536034, 43.49949377732676, -1.8216733966205152, -3.6135806627016587, 118.20639218935851, 47.7760113326523, 2.0000000000000013, 81.81764267374197, 139.40769006579774, 36.51248001527121, -15.007583137362062, 67.37314083463284, 106.9461047780926, 73.67076082155083, -9.751152664435212, 12.93438452449396, -48.99140458384822, -39.31082662970041, -11.001728357818406, -7.990129712824224, 46.29814518592599, 1.8289414947476488, -16.861333545705744, -30.07229443199069, 81.22750185822788, -53.9196334457242, -14.729909593806461, 0.8821332486186543, -5.211121746260502, 11.346492328545999, -115.13867782784486, -43.2728300797008, 80.28927984542376, 67.96839132614659, 17.85537491606047, 101.16401390877326, -69.48212089921016, 42.589999999999684, -3.3370830179687356, -68.32742660825005, 9.696460675995958, -58.6789654255838, 0.041330863601265644, 43.42515560780397, 56.80031965424176, 20.205806786414556, 14.55821259292028, -8.007719390636165, 13.86958320652221, 102.6173809399568, 77.20243991538922, -149.41136353758822, -11.683887879161162, 0.7279515018498197, -11.330792171662697, -88.10432570171551, -8.869850704056905, -6.2797170211074045, 2.0000000000000013, 2.0000000000000013, 1.3714837046642219, 33.56677574342339, 87.72971632401261, 12.043456538839811, 125.8146697680928, 33.23743540692013, 67.78913577230607, -23.841156683299978, -8.664781201566262, 0.23531984875779627, 2.0000000000000013, 137.8534375218067, 8.523911378355947, 27.051033037179167, 2.0000000000000013, -0.6568533413515476, -4.792846613941189, 157.34192695722749, 92.61515258814757, 167.70343505092444, 35.719556651147755, -48.380913898289435, 164.45979853752135, 126.98664778136505, 135.53712526970878, 2.0000000000000013, 176.31858458253288, -6.599670991989932, 146.0878927565335, 27.74000000000027, 31.592653872196873, 2.0000000000000013, -51.90659360247001, 81.4603932774022, 0.5398240836064726, 120.21908869246987, -11.230348704058033, -3.0773300089653866, -1.2132282484907086, 43.00058297892582, 48.992852456788526, 1.8422618188741733, 2.0000000000000013, 133.72143791829973, 121.51872522509144, 14.374084026375197, 139.79099206458224, 100.55145367198558, 162.0812496399291, -7.525704972738454, 130.7311879802716, 29.558024884221688, 131.30352579525504, 153.92854345552863, 172.44386809463623, -0.36940266917826525, -4.935639879322511, 78.94235062634147, 2.0000000000000013, -3.191146214107204, 1.8070789588973624, 166.48651981742694, -0.16259297474985068, 1.7497725751402229, 139.91677768587567, 180.48984309674034, 47.269366570226985, 1.2353427796759833, 0.7867368530877689, 47.72469014502723, -5.929093127839438, 2.0000000000000013, 2.0000000000000013, 181.05354871689383, 178.60537073197077, 144.34204100340094, 146.42979381173254, 157.21621328249643, 3.6290717648368043, -4.5790963625134795, 2.0000000000000013, 73.54803502516575, 160.7681470151059, 15.859999999999973, 73.8477530008632, 158.69078281070168], "policy_predator_policy_reward": [47.24287716203573, 52.53806167236044, 7.825001172571923, 2.508759700001653, 1.6124872514984383, 31.020784966419615, 7.89892791363924, 4.1494341698018244, 16.085771068957968, 2.789134938488334, 57.56136926338238, 14.13624535053586, 5.258556053457845, 3.5876992665336163, 9.429964001590387, 14.483413208532637, 11.232680051044666, 17.046715131779155, 41.953570800754015, 94.35813898372032, 2.7505419975349077, 21.241496786780854, 22.42126049534606, 52.56947693196721, 6.8327414197971565, 0.6790989113864054, 16.083628701756236, 25.667537889379375, 55.557591706463874, 5.13584787584535, 36.06715664648208, 86.50759349127053, 4.306411568527873, 13.711083056421613, 18.65196438266256, 6.743435744298604, 9.488979281009255, 13.75295591820731, 87.16443111484604, 53.560514375922665, 38.9919042897768, 22.92331817748259, 55.767055103952806, 31.378596838186155, 41.75357168482999, 58.069351815519816, 1.298652469705462, 0.9946312628576438, 12.996292743210473, 24.825775866367717, 82.12539726122121, 2.694293809950225, 80.57782341730002, 78.14663331101293, 36.394672686305405, 27.070272791030074, 1.1164926160195359, 6.070271234640034, 35.8183380010842, 46.28142806195097, 27.145057071337682, 14.9144226952555, 42.89745855109825, 28.91778086966738, 9.110015066976507, 43.64577256130687, 11.775893266035048, 20.334632912391836, 64.37138227328194, 89.43233131811148, 111.43767857937993, 30.983798895493212, 1.0923175176133264, 15.879567340303563, 41.25286081535625, 13.372046825752335, 43.24196035038009, 45.33491883900727, 41.5790845006956, 59.46037986703774, 4.251534231715866, 16.469909593806502, 39.20231366190592, 15.14226975680488, 117.94042386669372, 89.30837175791007, 35.217391683427934, 31.25094607061503, 25.99578803111919, 51.28478881232005, 69.04759170555224, 60.464792551217656, 53.90872868503731, 56.04016626476219, 42.83833376715932, 81.80269561671352, 53.40335337369862, 33.446219139227225, 16.087787299472573, 43.179667296675746, 43.968452704414034, 46.45156098768535, 25.052777819542154, 60.020092455609145, 144.43252181177803, 92.01780197245662, 21.685277812899688, 69.55843612264944, 72.90195027629571, 82.36203524400773, 64.66096501704409, 49.535954755657585, 0.0, 0.0, 11.990441992403486, 28.293246068269355, 44.472504512839265, 53.17168140236953, 41.24133009306041, 45.687633070481645, 31.43269293160345, 29.630325563389395, 2.3760185422046463, 12.294781201566229, 4.909483187605141, 5.866359397112824, 9.788394431802324, 3.941226025136601, 2.1032324061237957, 1.2635092891466404, 9.879915906364774, 6.0002386809972315, 16.218524169686134, 30.664210237468268, 46.55816963536074, 82.57884731344417, 6.484962682153073, 15.787725163026124, 17.15613955895309, 5.743913805661299, 2.526113895060149, 10.865830382914384, 1.7777504147886716, 7.9266163204759525, 15.624656951209058, 11.53407915888784, 39.43141782778722, 66.80044968154392, 8.587627724164642, 3.6494553422714597, 11.872525858219946, 7.6659519679175725, 20.36538373312399, 25.69795140627365, 0.147738181125828, 5.317147543211448, 3.122624861147566, 3.654422450899553, 2.1712747749085457, 6.235915973624769, 17.263346489243514, 25.67630492698333, 3.120149746828329, 20.23367884061223, 3.6944123741943775, 9.100284478104085, 6.889108261921602, 6.3187548617530735, 5.970140410661213, 3.2120553606566107, 7.230035492479095, 5.241683437377603, 0.6084349766258175, 5.031146214107165, 7.110485253343183, 1.0234518431290835, 2.0825929747498506, 0.24022742485977855, 12.070101178372775, 11.026022270239197, 45.69766485371601, 15.168652087989738, 1.4835453310905515, 2.3592369838206264, 7.6890931278394, 1.3724905508927672, 5.946451283106179, 0.1765539542423797, 1.4946919795131575, 6.652429761333684, 9.121066627348437, 4.549123342932196, 0.0, 6.982587879568684, 24.069199565639746, 36.37552871989599, 16.06796400303814, 4.091675672006569, 15.443301120190178, 9.804216330413594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5602850582445371, "mean_inference_ms": 1.656372124182471, "mean_action_processing_ms": 0.25641907136059544, "mean_env_wait_ms": 0.19711755662828714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006086111068725586, "StateBufferConnector_ms": 0.008849859237670898, "ViewRequirementAgentConnector_ms": 0.13164079189300537}, "num_episodes": 18, "episode_return_max": 343.50274423122795, "episode_return_min": -2.0199732127257377, "episode_return_mean": 129.64751591115228, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.53552333798586, "num_env_steps_trained_throughput_per_sec": 324.53552333798586, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 11920.859, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11920.823, "sample_time_ms": 1582.337, "learn_time_ms": 10323.212, "learn_throughput": 387.476, "synch_weights_time_ms": 14.348}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "ef79f_00000", "date": "2024-08-16_11-22-10", "timestamp": 1723787530, "time_this_iter_s": 12.330703973770142, "time_total_s": 307.00914478302, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214563a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 307.00914478302, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 46.61666666666667, "ram_util_percent": 82.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9869425182304685, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.71877033647406, "policy_loss": -0.006649948854280252, "vf_loss": 6.722980268165548, "vf_explained_var": 0.18263559246820116, "kl": 0.008133364157598452, "entropy": 1.3698966833649489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.940769225516647, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.569229848359628, "policy_loss": -0.005482190853063628, "vf_loss": 2.573491357306324, "vf_explained_var": 0.14931053367872088, "kl": 0.006103404259061879, "entropy": 1.1034859948688083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 362.17, "episode_reward_min": -2.0199732127257377, "episode_reward_mean": 140.53822178565605, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -149.41136353758822, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 182.36358049161979, "predator_policy": 144.43252181177803}, "policy_reward_mean": {"prey_policy": 45.32558612580256, "predator_policy": 24.943524767025472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [272.18192678053504, 154.7553811704584, 43.306829830321604, 166.2826767396123, 55.660304989613174, 4.38235420870035, 86.87559594466792, 68.4493150155726, 125.37874196032833, 99.27223008412616, 1.7515097913374722, 248.08216958504602, 125.87712244033538, 247.73540950183468, 105.12134532555415, 212.72739177807014, 156.9869454514521, 54.11924626132458, -2.0199732127257377, 102.75199432178248, 41.64325121169125, 128.3473327802372, 6.873667480334443, 60.47995400099633, 48.83728771705813, 214.7260089256133, 196.29996566827265, 102.62026335756016, 38.284385323580935, 75.65852463428511, 130.31605898433097, 136.2735810368046, 96.97050689438369, 201.55983442163046, 164.24140016203572, 80.28777755823793, 55.828867646925126, 99.04735204753737, 3.9999999999999587, 75.22194750876108, 197.4173587780612, 245.98106833855493, 105.01099758399901, 6.241338390962366, 150.6292801065247, 49.30456487247325, 4.709888353918843, 168.42923493064822, 307.2013220462263, 116.4756597016634, 313.7191341640656, 160.43717863432323, 183.11085786851737, 183.53225949179796, 60.75138998229329, 135.78566718426364, 132.9959958425127, 5.2307991131141085, 87.85068986983282, 56.29999999999996, 142.498485230347, 144.30000000000024, 283.2820971527947, 177.90937325463116, 173.0839097167914, 298.43993237445835, 181.2566611967756, 86.4784296768763, 4.448434976625767, 176.42753587279643, 3.9099999999999606, 343.50274423122795, 109.3710262916089, 52.35420931302589, 5.132490550892701, 189.17655395424214, 331.09453347621854, 317.31619706450965, 6.032563281892023, 135.99276331070172, 196.78778669015014, 257.7860532621678, 238.34479877723828, 172.4948674547906, 175.46158998774064, 161.260760588807, 174.0499999999998, 301.4235721990724, 103.082752241941, 136.83000000000007, 56.00395900321798, 154.6091225164489, 362.17, 318.6005437889692, 188.29635974789701, 26.64161345090609, 253.974592517344, 228.50464502325462, 259.23222721797686, 167.9478225892887], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [133.10478447968805, 115.83520710163073, 29.38770722988292, -15.357271550193158, -12.905365102140056, -5.703027534797705, 40.82733148128051, 38.30969331619272, -57.42789277740803, 13.265274266671625, 1.7972642237643857, 0.2918062523729105, 25.326744406988993, 23.72678292810102, -8.619618103080214, -7.750757952518571, -21.837329577057933, -11.508385190926713, -7.692209170536034, 43.49949377732676, -1.8216733966205152, -3.6135806627016587, 118.20639218935851, 47.7760113326523, 2.0000000000000013, 81.81764267374197, 139.40769006579774, 36.51248001527121, -15.007583137362062, 67.37314083463284, 106.9461047780926, 73.67076082155083, -9.751152664435212, 12.93438452449396, -48.99140458384822, -39.31082662970041, -11.001728357818406, -7.990129712824224, 46.29814518592599, 1.8289414947476488, -16.861333545705744, -30.07229443199069, 81.22750185822788, -53.9196334457242, -14.729909593806461, 0.8821332486186543, -5.211121746260502, 11.346492328545999, -115.13867782784486, -43.2728300797008, 80.28927984542376, 67.96839132614659, 17.85537491606047, 101.16401390877326, -69.48212089921016, 42.589999999999684, -3.3370830179687356, -68.32742660825005, 9.696460675995958, -58.6789654255838, 0.041330863601265644, 43.42515560780397, 56.80031965424176, 20.205806786414556, 14.55821259292028, -8.007719390636165, 13.86958320652221, 102.6173809399568, 77.20243991538922, -149.41136353758822, -11.683887879161162, 0.7279515018498197, -11.330792171662697, -88.10432570171551, -8.869850704056905, -6.2797170211074045, 2.0000000000000013, 2.0000000000000013, 1.3714837046642219, 33.56677574342339, 87.72971632401261, 12.043456538839811, 125.8146697680928, 33.23743540692013, 67.78913577230607, -23.841156683299978, -8.664781201566262, 0.23531984875779627, 2.0000000000000013, 137.8534375218067, 8.523911378355947, 27.051033037179167, 2.0000000000000013, -0.6568533413515476, -4.792846613941189, 157.34192695722749, 92.61515258814757, 167.70343505092444, 35.719556651147755, -48.380913898289435, 164.45979853752135, 126.98664778136505, 135.53712526970878, 2.0000000000000013, 176.31858458253288, -6.599670991989932, 146.0878927565335, 27.74000000000027, 31.592653872196873, 2.0000000000000013, -51.90659360247001, 81.4603932774022, 0.5398240836064726, 120.21908869246987, -11.230348704058033, -3.0773300089653866, -1.2132282484907086, 43.00058297892582, 48.992852456788526, 1.8422618188741733, 2.0000000000000013, 133.72143791829973, 121.51872522509144, 14.374084026375197, 139.79099206458224, 100.55145367198558, 162.0812496399291, -7.525704972738454, 130.7311879802716, 29.558024884221688, 131.30352579525504, 153.92854345552863, 172.44386809463623, -0.36940266917826525, -4.935639879322511, 78.94235062634147, 2.0000000000000013, -3.191146214107204, 1.8070789588973624, 166.48651981742694, -0.16259297474985068, 1.7497725751402229, 139.91677768587567, 180.48984309674034, 47.269366570226985, 1.2353427796759833, 0.7867368530877689, 47.72469014502723, -5.929093127839438, 2.0000000000000013, 2.0000000000000013, 181.05354871689383, 178.60537073197077, 144.34204100340094, 146.42979381173254, 157.21621328249643, 3.6290717648368043, -4.5790963625134795, 2.0000000000000013, 73.54803502516575, 160.7681470151059, 15.859999999999973, 73.8477530008632, 158.69078281070168, 80.09820858558841, 131.84276412234877, 152.47999999999996, 13.000237831336717, 116.59078907361554, 26.750000000000274, 2.0000000000000013, 138.71709659983708, 2.0000000000000013, 155.44873687920244, 117.74277092383576, 129.91078783738834, 0.5442577214702023, 95.13469068161211, 55.46, 31.318025111974112, -4.421125347931814, 52.49, -1.060693973349553, 128.34216793107575, 182.36358049161979, 162.0899730510671, 105.3993040412071, 156.1921542919459, 2.0000000000000013, 181.76422762855384, 24.29018776974456, -0.1021177628957242, 98.50111238866648, 104.76173488007491, 152.76218453694648, 33.99470576545511, 106.94, 124.3471988036725, 23.155130038103227, 109.94642990098642], "policy_predator_policy_reward": [9.488979281009255, 13.75295591820731, 87.16443111484604, 53.560514375922665, 38.9919042897768, 22.92331817748259, 55.767055103952806, 31.378596838186155, 41.75357168482999, 58.069351815519816, 1.298652469705462, 0.9946312628576438, 12.996292743210473, 24.825775866367717, 82.12539726122121, 2.694293809950225, 80.57782341730002, 78.14663331101293, 36.394672686305405, 27.070272791030074, 1.1164926160195359, 6.070271234640034, 35.8183380010842, 46.28142806195097, 27.145057071337682, 14.9144226952555, 42.89745855109825, 28.91778086966738, 9.110015066976507, 43.64577256130687, 11.775893266035048, 20.334632912391836, 64.37138227328194, 89.43233131811148, 111.43767857937993, 30.983798895493212, 1.0923175176133264, 15.879567340303563, 41.25286081535625, 13.372046825752335, 43.24196035038009, 45.33491883900727, 41.5790845006956, 59.46037986703774, 4.251534231715866, 16.469909593806502, 39.20231366190592, 15.14226975680488, 117.94042386669372, 89.30837175791007, 35.217391683427934, 31.25094607061503, 25.99578803111919, 51.28478881232005, 69.04759170555224, 60.464792551217656, 53.90872868503731, 56.04016626476219, 42.83833376715932, 81.80269561671352, 53.40335337369862, 33.446219139227225, 16.087787299472573, 43.179667296675746, 43.968452704414034, 46.45156098768535, 25.052777819542154, 60.020092455609145, 144.43252181177803, 92.01780197245662, 21.685277812899688, 69.55843612264944, 72.90195027629571, 82.36203524400773, 64.66096501704409, 49.535954755657585, 0.0, 0.0, 11.990441992403486, 28.293246068269355, 44.472504512839265, 53.17168140236953, 41.24133009306041, 45.687633070481645, 31.43269293160345, 29.630325563389395, 2.3760185422046463, 12.294781201566229, 4.909483187605141, 5.866359397112824, 9.788394431802324, 3.941226025136601, 2.1032324061237957, 1.2635092891466404, 9.879915906364774, 6.0002386809972315, 16.218524169686134, 30.664210237468268, 46.55816963536074, 82.57884731344417, 6.484962682153073, 15.787725163026124, 17.15613955895309, 5.743913805661299, 2.526113895060149, 10.865830382914384, 1.7777504147886716, 7.9266163204759525, 15.624656951209058, 11.53407915888784, 39.43141782778722, 66.80044968154392, 8.587627724164642, 3.6494553422714597, 11.872525858219946, 7.6659519679175725, 20.36538373312399, 25.69795140627365, 0.147738181125828, 5.317147543211448, 3.122624861147566, 3.654422450899553, 2.1712747749085457, 6.235915973624769, 17.263346489243514, 25.67630492698333, 3.120149746828329, 20.23367884061223, 3.6944123741943775, 9.100284478104085, 6.889108261921602, 6.3187548617530735, 5.970140410661213, 3.2120553606566107, 7.230035492479095, 5.241683437377603, 0.6084349766258175, 5.031146214107165, 7.110485253343183, 1.0234518431290835, 2.0825929747498506, 0.24022742485977855, 12.070101178372775, 11.026022270239197, 45.69766485371601, 15.168652087989738, 1.4835453310905515, 2.3592369838206264, 7.6890931278394, 1.3724905508927672, 5.946451283106179, 0.1765539542423797, 1.4946919795131575, 6.652429761333684, 9.121066627348437, 4.549123342932196, 0.0, 6.982587879568684, 24.069199565639746, 36.37552871989599, 16.06796400303814, 4.091675672006569, 15.443301120190178, 9.804216330413594, 14.082714914482818, 12.321111154819112, 2.566591423527412, 4.448038199926638, 7.40176526679123, 24.71903564733405, 13.022769434819242, 7.520894554150688, 0.0, 16.60126312079751, 23.054429876543466, 30.71558356130486, 4.477323070395638, 2.9264807684628766, 48.56412956351102, 1.4878453245148335, 1.6939590032180558, 6.241125347931775, 16.014565378706337, 11.313083180016308, 17.498688383614688, 0.2177580736984664, 32.25942568603524, 24.749659769780973, 2.217265908314883, 2.3148662110285243, 0.1960779975058855, 2.257465446551095, 20.387470366207815, 30.32427488239489, 19.28577963603513, 22.461975084817798, 11.12691489278585, 16.8181135215185, 24.32270541693669, 10.523557233262775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5683248332399248, "mean_inference_ms": 1.6837282098425321, "mean_action_processing_ms": 0.2588123212187264, "mean_env_wait_ms": 0.20026683096956835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005738615989685059, "StateBufferConnector_ms": 0.009294390678405762, "ViewRequirementAgentConnector_ms": 0.15070021152496338}, "num_episodes": 18, "episode_return_max": 362.17, "episode_return_min": -2.0199732127257377, "episode_return_mean": 140.53822178565605, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.40591342756545, "num_env_steps_trained_throughput_per_sec": 308.40591342756545, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 12174.608, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12174.568, "sample_time_ms": 1617.243, "learn_time_ms": 10540.86, "learn_throughput": 379.476, "synch_weights_time_ms": 15.247}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "ef79f_00000", "date": "2024-08-16_11-22-23", "timestamp": 1723787543, "time_this_iter_s": 13.004422903060913, "time_total_s": 320.01356768608093, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214b51f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 320.01356768608093, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 57.8111111111111, "ram_util_percent": 81.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.876232208398284, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.122104467159857, "policy_loss": -0.0036337753388261985, "vf_loss": 7.123955795500014, "vf_explained_var": 0.2961899938406768, "kl": 0.005941483446164864, "entropy": 1.3639930804570517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.738061389279744, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3710843435040228, "policy_loss": -0.005083364986558322, "vf_loss": 2.3747986791625855, "vf_explained_var": 0.026306890179871253, "kl": 0.00684514813323091, "entropy": 1.0994994097916537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 362.17, "episode_reward_min": -2.0199732127257377, "episode_reward_mean": 156.85821464112564, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -149.41136353758822, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.84299656277625, "predator_policy": 144.43252181177803}, "policy_reward_mean": {"prey_policy": 57.86013795790363, "predator_policy": 20.568969362659185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0199732127257377, 102.75199432178248, 41.64325121169125, 128.3473327802372, 6.873667480334443, 60.47995400099633, 48.83728771705813, 214.7260089256133, 196.29996566827265, 102.62026335756016, 38.284385323580935, 75.65852463428511, 130.31605898433097, 136.2735810368046, 96.97050689438369, 201.55983442163046, 164.24140016203572, 80.28777755823793, 55.828867646925126, 99.04735204753737, 3.9999999999999587, 75.22194750876108, 197.4173587780612, 245.98106833855493, 105.01099758399901, 6.241338390962366, 150.6292801065247, 49.30456487247325, 4.709888353918843, 168.42923493064822, 307.2013220462263, 116.4756597016634, 313.7191341640656, 160.43717863432323, 183.11085786851737, 183.53225949179796, 60.75138998229329, 135.78566718426364, 132.9959958425127, 5.2307991131141085, 87.85068986983282, 56.29999999999996, 142.498485230347, 144.30000000000024, 283.2820971527947, 177.90937325463116, 173.0839097167914, 298.43993237445835, 181.2566611967756, 86.4784296768763, 4.448434976625767, 176.42753587279643, 3.9099999999999606, 343.50274423122795, 109.3710262916089, 52.35420931302589, 5.132490550892701, 189.17655395424214, 331.09453347621854, 317.31619706450965, 6.032563281892023, 135.99276331070172, 196.78778669015014, 257.7860532621678, 238.34479877723828, 172.4948674547906, 175.46158998774064, 161.260760588807, 174.0499999999998, 301.4235721990724, 103.082752241941, 136.83000000000007, 56.00395900321798, 154.6091225164489, 362.17, 318.6005437889692, 188.29635974789701, 26.64161345090609, 253.974592517344, 228.50464502325462, 259.23222721797686, 167.9478225892887, 159.11453382763625, 354.71473410736303, 304.3289838594477, 295.6499414422425, 103.18134911666662, 80.89663817283439, 353.11490012104093, 208.5261462696379, 178.04616162808725, 117.46000000000032, 124.76311195525805, 339.6217377335214, 304.11, 4.356429382585569, 148.61152336844592, 220.76000000000005, 265.3098665139049, 298.3797249071754], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.001728357818406, -7.990129712824224, 46.29814518592599, 1.8289414947476488, -16.861333545705744, -30.07229443199069, 81.22750185822788, -53.9196334457242, -14.729909593806461, 0.8821332486186543, -5.211121746260502, 11.346492328545999, -115.13867782784486, -43.2728300797008, 80.28927984542376, 67.96839132614659, 17.85537491606047, 101.16401390877326, -69.48212089921016, 42.589999999999684, -3.3370830179687356, -68.32742660825005, 9.696460675995958, -58.6789654255838, 0.041330863601265644, 43.42515560780397, 56.80031965424176, 20.205806786414556, 14.55821259292028, -8.007719390636165, 13.86958320652221, 102.6173809399568, 77.20243991538922, -149.41136353758822, -11.683887879161162, 0.7279515018498197, -11.330792171662697, -88.10432570171551, -8.869850704056905, -6.2797170211074045, 2.0000000000000013, 2.0000000000000013, 1.3714837046642219, 33.56677574342339, 87.72971632401261, 12.043456538839811, 125.8146697680928, 33.23743540692013, 67.78913577230607, -23.841156683299978, -8.664781201566262, 0.23531984875779627, 2.0000000000000013, 137.8534375218067, 8.523911378355947, 27.051033037179167, 2.0000000000000013, -0.6568533413515476, -4.792846613941189, 157.34192695722749, 92.61515258814757, 167.70343505092444, 35.719556651147755, -48.380913898289435, 164.45979853752135, 126.98664778136505, 135.53712526970878, 2.0000000000000013, 176.31858458253288, -6.599670991989932, 146.0878927565335, 27.74000000000027, 31.592653872196873, 2.0000000000000013, -51.90659360247001, 81.4603932774022, 0.5398240836064726, 120.21908869246987, -11.230348704058033, -3.0773300089653866, -1.2132282484907086, 43.00058297892582, 48.992852456788526, 1.8422618188741733, 2.0000000000000013, 133.72143791829973, 121.51872522509144, 14.374084026375197, 139.79099206458224, 100.55145367198558, 162.0812496399291, -7.525704972738454, 130.7311879802716, 29.558024884221688, 131.30352579525504, 153.92854345552863, 172.44386809463623, -0.36940266917826525, -4.935639879322511, 78.94235062634147, 2.0000000000000013, -3.191146214107204, 1.8070789588973624, 166.48651981742694, -0.16259297474985068, 1.7497725751402229, 139.91677768587567, 180.48984309674034, 47.269366570226985, 1.2353427796759833, 0.7867368530877689, 47.72469014502723, -5.929093127839438, 2.0000000000000013, 2.0000000000000013, 181.05354871689383, 178.60537073197077, 144.34204100340094, 146.42979381173254, 157.21621328249643, 3.6290717648368043, -4.5790963625134795, 2.0000000000000013, 73.54803502516575, 160.7681470151059, 15.859999999999973, 73.8477530008632, 158.69078281070168, 80.09820858558841, 131.84276412234877, 152.47999999999996, 13.000237831336717, 116.59078907361554, 26.750000000000274, 2.0000000000000013, 138.71709659983708, 2.0000000000000013, 155.44873687920244, 117.74277092383576, 129.91078783738834, 0.5442577214702023, 95.13469068161211, 55.46, 31.318025111974112, -4.421125347931814, 52.49, -1.060693973349553, 128.34216793107575, 182.36358049161979, 162.0899730510671, 105.3993040412071, 156.1921542919459, 2.0000000000000013, 181.76422762855384, 24.29018776974456, -0.1021177628957242, 98.50111238866648, 104.76173488007491, 152.76218453694648, 33.99470576545511, 106.94, 124.3471988036725, 23.155130038103227, 109.94642990098642, 2.0000000000000013, 112.7712232040579, 163.4522156889247, 183.74786573296757, 196.6427257833139, 72.55055025377413, 108.39431925866836, 131.30297063601319, 50.3384920827136, 2.0000000000000013, 46.653620046304326, -0.7482956528004261, 136.37207614458598, 197.84299656277625, 40.008149016829144, 159.5905256656786, 160.92116101304575, 2.0000000000000013, 4.813545843921662, 99.35755659091193, 1.5674932492597085, 101.45432802536408, 172.71396628530243, 123.98783280625301, 176.1654736988786, 98.80799444822753, 1.0579895673355069, 2.0000000000000013, 0.9494148224965018, 133.8704333722376, 183.2695976752073, 36.650000000000006, 76.48889083514368, 144.99546205938307, 142.12502127996623, 125.51338908963828], "policy_predator_policy_reward": [1.0923175176133264, 15.879567340303563, 41.25286081535625, 13.372046825752335, 43.24196035038009, 45.33491883900727, 41.5790845006956, 59.46037986703774, 4.251534231715866, 16.469909593806502, 39.20231366190592, 15.14226975680488, 117.94042386669372, 89.30837175791007, 35.217391683427934, 31.25094607061503, 25.99578803111919, 51.28478881232005, 69.04759170555224, 60.464792551217656, 53.90872868503731, 56.04016626476219, 42.83833376715932, 81.80269561671352, 53.40335337369862, 33.446219139227225, 16.087787299472573, 43.179667296675746, 43.968452704414034, 46.45156098768535, 25.052777819542154, 60.020092455609145, 144.43252181177803, 92.01780197245662, 21.685277812899688, 69.55843612264944, 72.90195027629571, 82.36203524400773, 64.66096501704409, 49.535954755657585, 0.0, 0.0, 11.990441992403486, 28.293246068269355, 44.472504512839265, 53.17168140236953, 41.24133009306041, 45.687633070481645, 31.43269293160345, 29.630325563389395, 2.3760185422046463, 12.294781201566229, 4.909483187605141, 5.866359397112824, 9.788394431802324, 3.941226025136601, 2.1032324061237957, 1.2635092891466404, 9.879915906364774, 6.0002386809972315, 16.218524169686134, 30.664210237468268, 46.55816963536074, 82.57884731344417, 6.484962682153073, 15.787725163026124, 17.15613955895309, 5.743913805661299, 2.526113895060149, 10.865830382914384, 1.7777504147886716, 7.9266163204759525, 15.624656951209058, 11.53407915888784, 39.43141782778722, 66.80044968154392, 8.587627724164642, 3.6494553422714597, 11.872525858219946, 7.6659519679175725, 20.36538373312399, 25.69795140627365, 0.147738181125828, 5.317147543211448, 3.122624861147566, 3.654422450899553, 2.1712747749085457, 6.235915973624769, 17.263346489243514, 25.67630492698333, 3.120149746828329, 20.23367884061223, 3.6944123741943775, 9.100284478104085, 6.889108261921602, 6.3187548617530735, 5.970140410661213, 3.2120553606566107, 7.230035492479095, 5.241683437377603, 0.6084349766258175, 5.031146214107165, 7.110485253343183, 1.0234518431290835, 2.0825929747498506, 0.24022742485977855, 12.070101178372775, 11.026022270239197, 45.69766485371601, 15.168652087989738, 1.4835453310905515, 2.3592369838206264, 7.6890931278394, 1.3724905508927672, 5.946451283106179, 0.1765539542423797, 1.4946919795131575, 6.652429761333684, 9.121066627348437, 4.549123342932196, 0.0, 6.982587879568684, 24.069199565639746, 36.37552871989599, 16.06796400303814, 4.091675672006569, 15.443301120190178, 9.804216330413594, 14.082714914482818, 12.321111154819112, 2.566591423527412, 4.448038199926638, 7.40176526679123, 24.71903564733405, 13.022769434819242, 7.520894554150688, 0.0, 16.60126312079751, 23.054429876543466, 30.71558356130486, 4.477323070395638, 2.9264807684628766, 48.56412956351102, 1.4878453245148335, 1.6939590032180558, 6.241125347931775, 16.014565378706337, 11.313083180016308, 17.498688383614688, 0.2177580736984664, 32.25942568603524, 24.749659769780973, 2.217265908314883, 2.3148662110285243, 0.1960779975058855, 2.257465446551095, 20.387470366207815, 30.32427488239489, 19.28577963603513, 22.461975084817798, 11.12691489278585, 16.8181135215185, 24.32270541693669, 10.523557233262775, 20.825578122905235, 23.517732500673073, 4.723150274840002, 2.7915024106307933, 17.276340181750825, 17.85936764060882, 33.62710675082641, 22.32554479673467, 25.659897215730286, 25.18295981822261, 22.651440429412713, 12.339873349917722, 11.783864858834557, 7.115962554844204, 6.199110951643399, 2.728360635486537, 9.95121317706001, 5.173787437981781, 0.0, 13.28889756516646, 12.762584307249666, 8.978706373384192, 17.420738395803845, 25.49920024616211, 13.21312103450884, 15.92341081838499, 0.9020104326644944, 0.39642938258561755, 1.4078674132797109, 12.383807760432063, 0.8404023247927033, 0.0, 25.636694220158166, 18.188819399219916, 3.596699552797575, 27.1446149847733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5710829252466214, "mean_inference_ms": 1.698733075761408, "mean_action_processing_ms": 0.2594981178297525, "mean_env_wait_ms": 0.2017220407605707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005557060241699219, "StateBufferConnector_ms": 0.009368538856506348, "ViewRequirementAgentConnector_ms": 0.11818718910217285}, "num_episodes": 18, "episode_return_max": 362.17, "episode_return_min": -2.0199732127257377, "episode_return_mean": 156.85821464112564, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.44423704598876, "num_env_steps_trained_throughput_per_sec": 201.44423704598876, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 13098.255, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13098.214, "sample_time_ms": 1665.102, "learn_time_ms": 11415.188, "learn_throughput": 350.41, "synch_weights_time_ms": 16.097}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "ef79f_00000", "date": "2024-08-16_11-22-43", "timestamp": 1723787563, "time_this_iter_s": 19.916584014892578, "time_total_s": 339.9301517009735, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32147fe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 339.9301517009735, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 93.17857142857142, "ram_util_percent": 82.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8120930760941178, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.199121832973743, "policy_loss": -0.0034264477324627693, "vf_loss": 8.200520038352442, "vf_explained_var": 0.3116492886391897, "kl": 0.006760702851060997, "entropy": 1.3425650338647226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3351172935395015, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.279053345622209, "policy_loss": -0.008756799083548011, "vf_loss": 2.2860093049271395, "vf_explained_var": 0.22917363523806214, "kl": 0.009004199631093468, "entropy": 1.0837638692250326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 363.72730851395187, "episode_reward_min": 3.9099999999999606, "episode_reward_mean": 192.05025331260163, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -51.90659360247001, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.84299656277625, "predator_policy": 82.57884731344417}, "policy_reward_mean": {"prey_policy": 82.74005504807498, "predator_policy": 13.28507160822583}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.30456487247325, 4.709888353918843, 168.42923493064822, 307.2013220462263, 116.4756597016634, 313.7191341640656, 160.43717863432323, 183.11085786851737, 183.53225949179796, 60.75138998229329, 135.78566718426364, 132.9959958425127, 5.2307991131141085, 87.85068986983282, 56.29999999999996, 142.498485230347, 144.30000000000024, 283.2820971527947, 177.90937325463116, 173.0839097167914, 298.43993237445835, 181.2566611967756, 86.4784296768763, 4.448434976625767, 176.42753587279643, 3.9099999999999606, 343.50274423122795, 109.3710262916089, 52.35420931302589, 5.132490550892701, 189.17655395424214, 331.09453347621854, 317.31619706450965, 6.032563281892023, 135.99276331070172, 196.78778669015014, 257.7860532621678, 238.34479877723828, 172.4948674547906, 175.46158998774064, 161.260760588807, 174.0499999999998, 301.4235721990724, 103.082752241941, 136.83000000000007, 56.00395900321798, 154.6091225164489, 362.17, 318.6005437889692, 188.29635974789701, 26.64161345090609, 253.974592517344, 228.50464502325462, 259.23222721797686, 167.9478225892887, 159.11453382763625, 354.71473410736303, 304.3289838594477, 295.6499414422425, 103.18134911666662, 80.89663817283439, 353.11490012104093, 208.5261462696379, 178.04616162808725, 117.46000000000032, 124.76311195525805, 339.6217377335214, 304.11, 4.356429382585569, 148.61152336844592, 220.76000000000005, 265.3098665139049, 298.3797249071754, 25.689999999999984, 363.72730851395187, 309.6965657925481, 270.9803544666111, 293.67857382672616, 164.1704797772331, 124.63000000000028, 145.27559317233857, 336.7342951813484, 145.5359630865264, 141.59429507690757, 323.84595917126984, 81.17443518488604, 339.6561918872693, 298.8605786434646, 156.86102240552776, 179.10122211752784, 126.75139536744926, 313.9960420809687, 196.22415448602297, 243.18051783486095, 244.17353297207382, 168.19724905866093, 296.19349115018684, 329.1884321351683, 306.062281516449, 357.55396390905537], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8.523911378355947, 27.051033037179167, 2.0000000000000013, -0.6568533413515476, -4.792846613941189, 157.34192695722749, 92.61515258814757, 167.70343505092444, 35.719556651147755, -48.380913898289435, 164.45979853752135, 126.98664778136505, 135.53712526970878, 2.0000000000000013, 176.31858458253288, -6.599670991989932, 146.0878927565335, 27.74000000000027, 31.592653872196873, 2.0000000000000013, -51.90659360247001, 81.4603932774022, 0.5398240836064726, 120.21908869246987, -11.230348704058033, -3.0773300089653866, -1.2132282484907086, 43.00058297892582, 48.992852456788526, 1.8422618188741733, 2.0000000000000013, 133.72143791829973, 121.51872522509144, 14.374084026375197, 139.79099206458224, 100.55145367198558, 162.0812496399291, -7.525704972738454, 130.7311879802716, 29.558024884221688, 131.30352579525504, 153.92854345552863, 172.44386809463623, -0.36940266917826525, -4.935639879322511, 78.94235062634147, 2.0000000000000013, -3.191146214107204, 1.8070789588973624, 166.48651981742694, -0.16259297474985068, 1.7497725751402229, 139.91677768587567, 180.48984309674034, 47.269366570226985, 1.2353427796759833, 0.7867368530877689, 47.72469014502723, -5.929093127839438, 2.0000000000000013, 2.0000000000000013, 181.05354871689383, 178.60537073197077, 144.34204100340094, 146.42979381173254, 157.21621328249643, 3.6290717648368043, -4.5790963625134795, 2.0000000000000013, 73.54803502516575, 160.7681470151059, 15.859999999999973, 73.8477530008632, 158.69078281070168, 80.09820858558841, 131.84276412234877, 152.47999999999996, 13.000237831336717, 116.59078907361554, 26.750000000000274, 2.0000000000000013, 138.71709659983708, 2.0000000000000013, 155.44873687920244, 117.74277092383576, 129.91078783738834, 0.5442577214702023, 95.13469068161211, 55.46, 31.318025111974112, -4.421125347931814, 52.49, -1.060693973349553, 128.34216793107575, 182.36358049161979, 162.0899730510671, 105.3993040412071, 156.1921542919459, 2.0000000000000013, 181.76422762855384, 24.29018776974456, -0.1021177628957242, 98.50111238866648, 104.76173488007491, 152.76218453694648, 33.99470576545511, 106.94, 124.3471988036725, 23.155130038103227, 109.94642990098642, 2.0000000000000013, 112.7712232040579, 163.4522156889247, 183.74786573296757, 196.6427257833139, 72.55055025377413, 108.39431925866836, 131.30297063601319, 50.3384920827136, 2.0000000000000013, 46.653620046304326, -0.7482956528004261, 136.37207614458598, 197.84299656277625, 40.008149016829144, 159.5905256656786, 160.92116101304575, 2.0000000000000013, 4.813545843921662, 99.35755659091193, 1.5674932492597085, 101.45432802536408, 172.71396628530243, 123.98783280625301, 176.1654736988786, 98.80799444822753, 1.0579895673355069, 2.0000000000000013, 0.9494148224965018, 133.8704333722376, 183.2695976752073, 36.650000000000006, 76.48889083514368, 144.99546205938307, 142.12502127996623, 125.51338908963828, 21.82784846534046, 1.5431100638806576, 175.6757371603826, 180.5963105022553, 125.83442261031054, 141.96269950315846, 83.351239262872, 106.67003984524187, 174.68276781460116, 82.5667247736688, 140.66192553888223, 4.969999999999958, 0.4498480348603126, 119.33830257888918, 111.26121156842939, 0.9984810389110945, 142.5230468606104, 168.40703457108265, 96.68368337446026, 2.0000000000000013, 85.45426023806043, 8.690040068814039, 161.57076867101023, 142.76870476072068, 2.0000000000000013, 75.01548569803774, 157.2374896329402, 165.3779307846864, 127.77632162239001, 147.53, 116.57572798268951, 1.6184842116270677, -0.49303534772984814, 172.04680525091473, 76.49461301854829, -1.0786526957776255, 143.3492588917912, 124.1480889832427, 133.52781123363064, 40.435658393244154, 73.91888705184088, 136.38994387237727, 65.08412877627391, 117.56093921241475, 154.56181920541877, 1.3427795743518707, 119.84234593864667, 152.33041662187668, 121.8762211854433, 166.09631766350304, 94.99150248424533, 150.33132517732096, 165.69071509309128, 175.93537871329394], "policy_predator_policy_reward": [9.788394431802324, 3.941226025136601, 2.1032324061237957, 1.2635092891466404, 9.879915906364774, 6.0002386809972315, 16.218524169686134, 30.664210237468268, 46.55816963536074, 82.57884731344417, 6.484962682153073, 15.787725163026124, 17.15613955895309, 5.743913805661299, 2.526113895060149, 10.865830382914384, 1.7777504147886716, 7.9266163204759525, 15.624656951209058, 11.53407915888784, 39.43141782778722, 66.80044968154392, 8.587627724164642, 3.6494553422714597, 11.872525858219946, 7.6659519679175725, 20.36538373312399, 25.69795140627365, 0.147738181125828, 5.317147543211448, 3.122624861147566, 3.654422450899553, 2.1712747749085457, 6.235915973624769, 17.263346489243514, 25.67630492698333, 3.120149746828329, 20.23367884061223, 3.6944123741943775, 9.100284478104085, 6.889108261921602, 6.3187548617530735, 5.970140410661213, 3.2120553606566107, 7.230035492479095, 5.241683437377603, 0.6084349766258175, 5.031146214107165, 7.110485253343183, 1.0234518431290835, 2.0825929747498506, 0.24022742485977855, 12.070101178372775, 11.026022270239197, 45.69766485371601, 15.168652087989738, 1.4835453310905515, 2.3592369838206264, 7.6890931278394, 1.3724905508927672, 5.946451283106179, 0.1765539542423797, 1.4946919795131575, 6.652429761333684, 9.121066627348437, 4.549123342932196, 0.0, 6.982587879568684, 24.069199565639746, 36.37552871989599, 16.06796400303814, 4.091675672006569, 15.443301120190178, 9.804216330413594, 14.082714914482818, 12.321111154819112, 2.566591423527412, 4.448038199926638, 7.40176526679123, 24.71903564733405, 13.022769434819242, 7.520894554150688, 0.0, 16.60126312079751, 23.054429876543466, 30.71558356130486, 4.477323070395638, 2.9264807684628766, 48.56412956351102, 1.4878453245148335, 1.6939590032180558, 6.241125347931775, 16.014565378706337, 11.313083180016308, 17.498688383614688, 0.2177580736984664, 32.25942568603524, 24.749659769780973, 2.217265908314883, 2.3148662110285243, 0.1960779975058855, 2.257465446551095, 20.387470366207815, 30.32427488239489, 19.28577963603513, 22.461975084817798, 11.12691489278585, 16.8181135215185, 24.32270541693669, 10.523557233262775, 20.825578122905235, 23.517732500673073, 4.723150274840002, 2.7915024106307933, 17.276340181750825, 17.85936764060882, 33.62710675082641, 22.32554479673467, 25.659897215730286, 25.18295981822261, 22.651440429412713, 12.339873349917722, 11.783864858834557, 7.115962554844204, 6.199110951643399, 2.728360635486537, 9.95121317706001, 5.173787437981781, 0.0, 13.28889756516646, 12.762584307249666, 8.978706373384192, 17.420738395803845, 25.49920024616211, 13.21312103450884, 15.92341081838499, 0.9020104326644944, 0.39642938258561755, 1.4078674132797109, 12.383807760432063, 0.8404023247927033, 0.0, 25.636694220158166, 18.188819399219916, 3.596699552797575, 27.1446149847733, 1.8821515346595408, 0.43688993611934374, 2.7261312458133644, 4.729129605500661, 27.217182238913722, 14.682261440165274, 40.18746411886857, 40.77161123962878, 29.75699433634875, 6.672086902107445, 17.34993308882982, 1.1886211495210963, 1.4801519651396888, 3.3616974211108053, 10.24111291099626, 22.774787654001713, 14.300548062398416, 11.503665687256962, 33.1826122001548, 13.669667511911205, 14.212772501248281, 33.23722226878454, 10.850117557917525, 8.656368181621408, 2.8340439500717878, 1.3249055367764737, 12.667182073022959, 4.373589396619696, 19.162632285402516, 4.391624735672084, 26.26465173885727, 12.402158472353861, 3.189842419842453, 4.3576097945008225, 47.306890693451145, 4.0285443512270955, 28.10358951790719, 18.395104688027583, 11.769301747003212, 10.491383112144817, 14.539166345993232, 18.332520564649556, 31.985871223726082, 29.542593759659002, 6.989283596739099, 5.303366682151265, 14.11999581641463, 9.900732773248665, 33.123778814556694, 8.092114471665225, 29.479525550385254, 31.259928304497656, 8.109887266984204, 7.817982835685991]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5770829408599888, "mean_inference_ms": 1.725440269385027, "mean_action_processing_ms": 0.26178993198619227, "mean_env_wait_ms": 0.203917979021805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004931092262268066, "StateBufferConnector_ms": 0.011207222938537598, "ViewRequirementAgentConnector_ms": 0.1346043348312378}, "num_episodes": 27, "episode_return_max": 363.72730851395187, "episode_return_min": 3.9099999999999606, "episode_return_mean": 192.05025331260163, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.0185952911887, "num_env_steps_trained_throughput_per_sec": 319.0185952911887, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 13312.083, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13312.041, "sample_time_ms": 1738.052, "learn_time_ms": 11555.785, "learn_throughput": 346.147, "synch_weights_time_ms": 16.34}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "ef79f_00000", "date": "2024-08-16_11-22-55", "timestamp": 1723787575, "time_this_iter_s": 12.590097188949585, "time_total_s": 352.5202488899231, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214b51f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 352.5202488899231, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 55.27777777777778, "ram_util_percent": 82.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9288883583886283, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.507660096032279, "policy_loss": -0.004691800541027631, "vf_loss": 8.509080709477582, "vf_explained_var": 0.379951108479626, "kl": 0.010904014043573442, "entropy": 1.3200534215049138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4022615602407504, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.944392073659039, "policy_loss": -0.006097020845239361, "vf_loss": 2.9490893105350473, "vf_explained_var": 0.20116544394266037, "kl": 0.006998915751109051, "entropy": 1.00821310016844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 363.72730851395187, "episode_reward_min": 3.9099999999999606, "episode_reward_mean": 214.13316246982552, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -7.525704972738454, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.84299656277625, "predator_policy": 48.56412956351102}, "policy_reward_mean": {"prey_policy": 92.61103470860922, "predator_policy": 14.455546526303545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [177.90937325463116, 173.0839097167914, 298.43993237445835, 181.2566611967756, 86.4784296768763, 4.448434976625767, 176.42753587279643, 3.9099999999999606, 343.50274423122795, 109.3710262916089, 52.35420931302589, 5.132490550892701, 189.17655395424214, 331.09453347621854, 317.31619706450965, 6.032563281892023, 135.99276331070172, 196.78778669015014, 257.7860532621678, 238.34479877723828, 172.4948674547906, 175.46158998774064, 161.260760588807, 174.0499999999998, 301.4235721990724, 103.082752241941, 136.83000000000007, 56.00395900321798, 154.6091225164489, 362.17, 318.6005437889692, 188.29635974789701, 26.64161345090609, 253.974592517344, 228.50464502325462, 259.23222721797686, 167.9478225892887, 159.11453382763625, 354.71473410736303, 304.3289838594477, 295.6499414422425, 103.18134911666662, 80.89663817283439, 353.11490012104093, 208.5261462696379, 178.04616162808725, 117.46000000000032, 124.76311195525805, 339.6217377335214, 304.11, 4.356429382585569, 148.61152336844592, 220.76000000000005, 265.3098665139049, 298.3797249071754, 25.689999999999984, 363.72730851395187, 309.6965657925481, 270.9803544666111, 293.67857382672616, 164.1704797772331, 124.63000000000028, 145.27559317233857, 336.7342951813484, 145.5359630865264, 141.59429507690757, 323.84595917126984, 81.17443518488604, 339.6561918872693, 298.8605786434646, 156.86102240552776, 179.10122211752784, 126.75139536744926, 313.9960420809687, 196.22415448602297, 243.18051783486095, 244.17353297207382, 168.19724905866093, 296.19349115018684, 329.1884321351683, 306.062281516449, 357.55396390905537, 296.58920648461947, 246.25929368653334, 271.2189412586795, 300.44428622775774, 335.72629631330915, 303.7667792103148, 308.2971075477484, 149.96679831691267, 123.4413183058922, 248.3665126910215, 272.8240365325242, 352.36359017009954, 286.7798555485679, 151.37127412675287, 311.3913024214745, 267.0414117484044, 270.4539816030333, 247.9041479675407], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [162.0812496399291, -7.525704972738454, 130.7311879802716, 29.558024884221688, 131.30352579525504, 153.92854345552863, 172.44386809463623, -0.36940266917826525, -4.935639879322511, 78.94235062634147, 2.0000000000000013, -3.191146214107204, 1.8070789588973624, 166.48651981742694, -0.16259297474985068, 1.7497725751402229, 139.91677768587567, 180.48984309674034, 47.269366570226985, 1.2353427796759833, 0.7867368530877689, 47.72469014502723, -5.929093127839438, 2.0000000000000013, 2.0000000000000013, 181.05354871689383, 178.60537073197077, 144.34204100340094, 146.42979381173254, 157.21621328249643, 3.6290717648368043, -4.5790963625134795, 2.0000000000000013, 73.54803502516575, 160.7681470151059, 15.859999999999973, 73.8477530008632, 158.69078281070168, 80.09820858558841, 131.84276412234877, 152.47999999999996, 13.000237831336717, 116.59078907361554, 26.750000000000274, 2.0000000000000013, 138.71709659983708, 2.0000000000000013, 155.44873687920244, 117.74277092383576, 129.91078783738834, 0.5442577214702023, 95.13469068161211, 55.46, 31.318025111974112, -4.421125347931814, 52.49, -1.060693973349553, 128.34216793107575, 182.36358049161979, 162.0899730510671, 105.3993040412071, 156.1921542919459, 2.0000000000000013, 181.76422762855384, 24.29018776974456, -0.1021177628957242, 98.50111238866648, 104.76173488007491, 152.76218453694648, 33.99470576545511, 106.94, 124.3471988036725, 23.155130038103227, 109.94642990098642, 2.0000000000000013, 112.7712232040579, 163.4522156889247, 183.74786573296757, 196.6427257833139, 72.55055025377413, 108.39431925866836, 131.30297063601319, 50.3384920827136, 2.0000000000000013, 46.653620046304326, -0.7482956528004261, 136.37207614458598, 197.84299656277625, 40.008149016829144, 159.5905256656786, 160.92116101304575, 2.0000000000000013, 4.813545843921662, 99.35755659091193, 1.5674932492597085, 101.45432802536408, 172.71396628530243, 123.98783280625301, 176.1654736988786, 98.80799444822753, 1.0579895673355069, 2.0000000000000013, 0.9494148224965018, 133.8704333722376, 183.2695976752073, 36.650000000000006, 76.48889083514368, 144.99546205938307, 142.12502127996623, 125.51338908963828, 21.82784846534046, 1.5431100638806576, 175.6757371603826, 180.5963105022553, 125.83442261031054, 141.96269950315846, 83.351239262872, 106.67003984524187, 174.68276781460116, 82.5667247736688, 140.66192553888223, 4.969999999999958, 0.4498480348603126, 119.33830257888918, 111.26121156842939, 0.9984810389110945, 142.5230468606104, 168.40703457108265, 96.68368337446026, 2.0000000000000013, 85.45426023806043, 8.690040068814039, 161.57076867101023, 142.76870476072068, 2.0000000000000013, 75.01548569803774, 157.2374896329402, 165.3779307846864, 127.77632162239001, 147.53, 116.57572798268951, 1.6184842116270677, -0.49303534772984814, 172.04680525091473, 76.49461301854829, -1.0786526957776255, 143.3492588917912, 124.1480889832427, 133.52781123363064, 40.435658393244154, 73.91888705184088, 136.38994387237727, 65.08412877627391, 117.56093921241475, 154.56181920541877, 1.3427795743518707, 119.84234593864667, 152.33041662187668, 121.8762211854433, 166.09631766350304, 94.99150248424533, 150.33132517732096, 165.69071509309128, 175.93537871329394, 105.57407821773604, 129.9461798888077, 123.35736104257384, 81.85157133782965, 109.86810726809698, 122.73073671707178, 118.67184232415894, 136.03816495796858, 154.2308520634167, 158.9390827186501, 134.3066973944749, 93.54618487661399, 176.21348991992357, 94.17846311936536, 119.86972437882501, 2.0000000000000013, 85.3341123816333, 2.0000000000000013, 67.46095523746003, 118.5262999687363, 128.29444367007926, 107.35018595257665, 166.39810425575973, 171.8042418917404, 135.94544493054252, 130.58339069728277, -6.869804100702924, 127.86047955592052, 115.87751230241588, 142.13717212895014, 109.44899302157474, 124.82592651519748, 36.31578900767103, 161.68771628449008, 92.6429129127705, 79.0811485349241], "policy_predator_policy_reward": [3.120149746828329, 20.23367884061223, 3.6944123741943775, 9.100284478104085, 6.889108261921602, 6.3187548617530735, 5.970140410661213, 3.2120553606566107, 7.230035492479095, 5.241683437377603, 0.6084349766258175, 5.031146214107165, 7.110485253343183, 1.0234518431290835, 2.0825929747498506, 0.24022742485977855, 12.070101178372775, 11.026022270239197, 45.69766485371601, 15.168652087989738, 1.4835453310905515, 2.3592369838206264, 7.6890931278394, 1.3724905508927672, 5.946451283106179, 0.1765539542423797, 1.4946919795131575, 6.652429761333684, 9.121066627348437, 4.549123342932196, 0.0, 6.982587879568684, 24.069199565639746, 36.37552871989599, 16.06796400303814, 4.091675672006569, 15.443301120190178, 9.804216330413594, 14.082714914482818, 12.321111154819112, 2.566591423527412, 4.448038199926638, 7.40176526679123, 24.71903564733405, 13.022769434819242, 7.520894554150688, 0.0, 16.60126312079751, 23.054429876543466, 30.71558356130486, 4.477323070395638, 2.9264807684628766, 48.56412956351102, 1.4878453245148335, 1.6939590032180558, 6.241125347931775, 16.014565378706337, 11.313083180016308, 17.498688383614688, 0.2177580736984664, 32.25942568603524, 24.749659769780973, 2.217265908314883, 2.3148662110285243, 0.1960779975058855, 2.257465446551095, 20.387470366207815, 30.32427488239489, 19.28577963603513, 22.461975084817798, 11.12691489278585, 16.8181135215185, 24.32270541693669, 10.523557233262775, 20.825578122905235, 23.517732500673073, 4.723150274840002, 2.7915024106307933, 17.276340181750825, 17.85936764060882, 33.62710675082641, 22.32554479673467, 25.659897215730286, 25.18295981822261, 22.651440429412713, 12.339873349917722, 11.783864858834557, 7.115962554844204, 6.199110951643399, 2.728360635486537, 9.95121317706001, 5.173787437981781, 0.0, 13.28889756516646, 12.762584307249666, 8.978706373384192, 17.420738395803845, 25.49920024616211, 13.21312103450884, 15.92341081838499, 0.9020104326644944, 0.39642938258561755, 1.4078674132797109, 12.383807760432063, 0.8404023247927033, 0.0, 25.636694220158166, 18.188819399219916, 3.596699552797575, 27.1446149847733, 1.8821515346595408, 0.43688993611934374, 2.7261312458133644, 4.729129605500661, 27.217182238913722, 14.682261440165274, 40.18746411886857, 40.77161123962878, 29.75699433634875, 6.672086902107445, 17.34993308882982, 1.1886211495210963, 1.4801519651396888, 3.3616974211108053, 10.24111291099626, 22.774787654001713, 14.300548062398416, 11.503665687256962, 33.1826122001548, 13.669667511911205, 14.212772501248281, 33.23722226878454, 10.850117557917525, 8.656368181621408, 2.8340439500717878, 1.3249055367764737, 12.667182073022959, 4.373589396619696, 19.162632285402516, 4.391624735672084, 26.26465173885727, 12.402158472353861, 3.189842419842453, 4.3576097945008225, 47.306890693451145, 4.0285443512270955, 28.10358951790719, 18.395104688027583, 11.769301747003212, 10.491383112144817, 14.539166345993232, 18.332520564649556, 31.985871223726082, 29.542593759659002, 6.989283596739099, 5.303366682151265, 14.11999581641463, 9.900732773248665, 33.123778814556694, 8.092114471665225, 29.479525550385254, 31.259928304497656, 8.109887266984204, 7.817982835685991, 37.355058161343734, 23.71389021673197, 29.24650240545825, 11.8038589006716, 23.198982694321398, 15.421114579189341, 19.795874718571906, 25.938404227058253, 13.610883874354947, 8.945477656887425, 40.84876917953546, 35.06512775969037, 20.633440923660004, 17.27171358479943, 11.58013076926412, 16.516943168823584, 22.7960070936994, 13.311198830559231, 34.09581776992074, 28.283439714904514, 4.680544528489992, 32.498862381378295, 7.984986756025324, 6.176257266574079, 9.81600746207612, 10.435012458666458, 13.141507541153903, 17.23909113038122, 33.06871368299374, 20.307904307114782, 16.222077604612295, 16.544414607019945, 44.69972935260656, 27.750746958265648, 28.360998003122997, 47.81908851672308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5800892190881322, "mean_inference_ms": 1.7419652432075574, "mean_action_processing_ms": 0.262434848716421, "mean_env_wait_ms": 0.20605903299441175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004726767539978027, "StateBufferConnector_ms": 0.0061484575271606445, "ViewRequirementAgentConnector_ms": 0.1375347375869751}, "num_episodes": 18, "episode_return_max": 363.72730851395187, "episode_return_min": 3.9099999999999606, "episode_return_mean": 214.13316246982552, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.09440294024, "num_env_steps_trained_throughput_per_sec": 299.09440294024, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 13571.721, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13571.678, "sample_time_ms": 1761.605, "learn_time_ms": 11791.497, "learn_throughput": 339.227, "synch_weights_time_ms": 16.71}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "ef79f_00000", "date": "2024-08-16_11-23-09", "timestamp": 1723787589, "time_this_iter_s": 13.379340887069702, "time_total_s": 365.8995897769928, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214b50d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 365.8995897769928, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 57.10526315789474, "ram_util_percent": 75.78947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3855615132069463, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.838128567751122, "policy_loss": -0.003506069005560623, "vf_loss": 8.839005219494855, "vf_explained_var": 0.22169129693949663, "kl": 0.008764698267558402, "entropy": 1.2813305555828034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8674451012144644, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.027910019985582, "policy_loss": -0.007321672618793196, "vf_loss": 4.033266688654662, "vf_explained_var": 0.16990222643922875, "kl": 0.009825042305622766, "entropy": 0.9628685963216913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 363.72730851395187, "episode_reward_min": 4.356429382585569, "episode_reward_mean": 228.52159751357263, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6.869804100702924, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.84299656277625, "predator_policy": 87.54261894870562}, "policy_reward_mean": {"prey_policy": 96.04282004098194, "predator_policy": 18.217978715804385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [257.7860532621678, 238.34479877723828, 172.4948674547906, 175.46158998774064, 161.260760588807, 174.0499999999998, 301.4235721990724, 103.082752241941, 136.83000000000007, 56.00395900321798, 154.6091225164489, 362.17, 318.6005437889692, 188.29635974789701, 26.64161345090609, 253.974592517344, 228.50464502325462, 259.23222721797686, 167.9478225892887, 159.11453382763625, 354.71473410736303, 304.3289838594477, 295.6499414422425, 103.18134911666662, 80.89663817283439, 353.11490012104093, 208.5261462696379, 178.04616162808725, 117.46000000000032, 124.76311195525805, 339.6217377335214, 304.11, 4.356429382585569, 148.61152336844592, 220.76000000000005, 265.3098665139049, 298.3797249071754, 25.689999999999984, 363.72730851395187, 309.6965657925481, 270.9803544666111, 293.67857382672616, 164.1704797772331, 124.63000000000028, 145.27559317233857, 336.7342951813484, 145.5359630865264, 141.59429507690757, 323.84595917126984, 81.17443518488604, 339.6561918872693, 298.8605786434646, 156.86102240552776, 179.10122211752784, 126.75139536744926, 313.9960420809687, 196.22415448602297, 243.18051783486095, 244.17353297207382, 168.19724905866093, 296.19349115018684, 329.1884321351683, 306.062281516449, 357.55396390905537, 296.58920648461947, 246.25929368653334, 271.2189412586795, 300.44428622775774, 335.72629631330915, 303.7667792103148, 308.2971075477484, 149.96679831691267, 123.4413183058922, 248.3665126910215, 272.8240365325242, 352.36359017009954, 286.7798555485679, 151.37127412675287, 311.3913024214745, 267.0414117484044, 270.4539816030333, 247.9041479675407, 251.65947116192876, 223.36573418651582, 153.30955845306357, 271.53748824254234, 351.05785935093985, 195.04230312213443, 280.52090447895233, 238.04010791861015, 144.41651729360314, 143.19143381135888, 168.55669340542298, 255.93618119600754, 288.41560234966977, 286.4310517343898, 225.63418850412754, 198.28665531371286, 259.8900654845746, 292.2668336005785], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [73.8477530008632, 158.69078281070168, 80.09820858558841, 131.84276412234877, 152.47999999999996, 13.000237831336717, 116.59078907361554, 26.750000000000274, 2.0000000000000013, 138.71709659983708, 2.0000000000000013, 155.44873687920244, 117.74277092383576, 129.91078783738834, 0.5442577214702023, 95.13469068161211, 55.46, 31.318025111974112, -4.421125347931814, 52.49, -1.060693973349553, 128.34216793107575, 182.36358049161979, 162.0899730510671, 105.3993040412071, 156.1921542919459, 2.0000000000000013, 181.76422762855384, 24.29018776974456, -0.1021177628957242, 98.50111238866648, 104.76173488007491, 152.76218453694648, 33.99470576545511, 106.94, 124.3471988036725, 23.155130038103227, 109.94642990098642, 2.0000000000000013, 112.7712232040579, 163.4522156889247, 183.74786573296757, 196.6427257833139, 72.55055025377413, 108.39431925866836, 131.30297063601319, 50.3384920827136, 2.0000000000000013, 46.653620046304326, -0.7482956528004261, 136.37207614458598, 197.84299656277625, 40.008149016829144, 159.5905256656786, 160.92116101304575, 2.0000000000000013, 4.813545843921662, 99.35755659091193, 1.5674932492597085, 101.45432802536408, 172.71396628530243, 123.98783280625301, 176.1654736988786, 98.80799444822753, 1.0579895673355069, 2.0000000000000013, 0.9494148224965018, 133.8704333722376, 183.2695976752073, 36.650000000000006, 76.48889083514368, 144.99546205938307, 142.12502127996623, 125.51338908963828, 21.82784846534046, 1.5431100638806576, 175.6757371603826, 180.5963105022553, 125.83442261031054, 141.96269950315846, 83.351239262872, 106.67003984524187, 174.68276781460116, 82.5667247736688, 140.66192553888223, 4.969999999999958, 0.4498480348603126, 119.33830257888918, 111.26121156842939, 0.9984810389110945, 142.5230468606104, 168.40703457108265, 96.68368337446026, 2.0000000000000013, 85.45426023806043, 8.690040068814039, 161.57076867101023, 142.76870476072068, 2.0000000000000013, 75.01548569803774, 157.2374896329402, 165.3779307846864, 127.77632162239001, 147.53, 116.57572798268951, 1.6184842116270677, -0.49303534772984814, 172.04680525091473, 76.49461301854829, -1.0786526957776255, 143.3492588917912, 124.1480889832427, 133.52781123363064, 40.435658393244154, 73.91888705184088, 136.38994387237727, 65.08412877627391, 117.56093921241475, 154.56181920541877, 1.3427795743518707, 119.84234593864667, 152.33041662187668, 121.8762211854433, 166.09631766350304, 94.99150248424533, 150.33132517732096, 165.69071509309128, 175.93537871329394, 105.57407821773604, 129.9461798888077, 123.35736104257384, 81.85157133782965, 109.86810726809698, 122.73073671707178, 118.67184232415894, 136.03816495796858, 154.2308520634167, 158.9390827186501, 134.3066973944749, 93.54618487661399, 176.21348991992357, 94.17846311936536, 119.86972437882501, 2.0000000000000013, 85.3341123816333, 2.0000000000000013, 67.46095523746003, 118.5262999687363, 128.29444367007926, 107.35018595257665, 166.39810425575973, 171.8042418917404, 135.94544493054252, 130.58339069728277, -6.869804100702924, 127.86047955592052, 115.87751230241588, 142.13717212895014, 109.44899302157474, 124.82592651519748, 36.31578900767103, 161.68771628449008, 92.6429129127705, 79.0811485349241, 96.98145047456899, 94.0092284127758, 104.32863116850459, 31.07845497792868, 14.117134420428197, 69.28946357531638, 104.51071401539214, 124.94563990954484, 137.50494730169586, 175.7879213315944, 79.27600558216467, 38.926293055816046, 138.55683782579393, 102.40717123445346, 93.20193156304444, 75.70421585118937, 105.09495338111329, -0.5859832127907967, 13.46579216888162, 64.75069196661286, 130.17845901182085, -0.20419986717614946, 117.10663916699049, 114.85286993283844, 111.67793330679055, 126.6401254374348, 120.42329831163504, 124.66180367323383, 108.37951562630533, 41.8444429024087, 34.6634816940666, 42.59512184195714, 82.68016496433748, 116.44443952283092, 124.22685502590444, 116.04904502856807], "policy_predator_policy_reward": [15.443301120190178, 9.804216330413594, 14.082714914482818, 12.321111154819112, 2.566591423527412, 4.448038199926638, 7.40176526679123, 24.71903564733405, 13.022769434819242, 7.520894554150688, 0.0, 16.60126312079751, 23.054429876543466, 30.71558356130486, 4.477323070395638, 2.9264807684628766, 48.56412956351102, 1.4878453245148335, 1.6939590032180558, 6.241125347931775, 16.014565378706337, 11.313083180016308, 17.498688383614688, 0.2177580736984664, 32.25942568603524, 24.749659769780973, 2.217265908314883, 2.3148662110285243, 0.1960779975058855, 2.257465446551095, 20.387470366207815, 30.32427488239489, 19.28577963603513, 22.461975084817798, 11.12691489278585, 16.8181135215185, 24.32270541693669, 10.523557233262775, 20.825578122905235, 23.517732500673073, 4.723150274840002, 2.7915024106307933, 17.276340181750825, 17.85936764060882, 33.62710675082641, 22.32554479673467, 25.659897215730286, 25.18295981822261, 22.651440429412713, 12.339873349917722, 11.783864858834557, 7.115962554844204, 6.199110951643399, 2.728360635486537, 9.95121317706001, 5.173787437981781, 0.0, 13.28889756516646, 12.762584307249666, 8.978706373384192, 17.420738395803845, 25.49920024616211, 13.21312103450884, 15.92341081838499, 0.9020104326644944, 0.39642938258561755, 1.4078674132797109, 12.383807760432063, 0.8404023247927033, 0.0, 25.636694220158166, 18.188819399219916, 3.596699552797575, 27.1446149847733, 1.8821515346595408, 0.43688993611934374, 2.7261312458133644, 4.729129605500661, 27.217182238913722, 14.682261440165274, 40.18746411886857, 40.77161123962878, 29.75699433634875, 6.672086902107445, 17.34993308882982, 1.1886211495210963, 1.4801519651396888, 3.3616974211108053, 10.24111291099626, 22.774787654001713, 14.300548062398416, 11.503665687256962, 33.1826122001548, 13.669667511911205, 14.212772501248281, 33.23722226878454, 10.850117557917525, 8.656368181621408, 2.8340439500717878, 1.3249055367764737, 12.667182073022959, 4.373589396619696, 19.162632285402516, 4.391624735672084, 26.26465173885727, 12.402158472353861, 3.189842419842453, 4.3576097945008225, 47.306890693451145, 4.0285443512270955, 28.10358951790719, 18.395104688027583, 11.769301747003212, 10.491383112144817, 14.539166345993232, 18.332520564649556, 31.985871223726082, 29.542593759659002, 6.989283596739099, 5.303366682151265, 14.11999581641463, 9.900732773248665, 33.123778814556694, 8.092114471665225, 29.479525550385254, 31.259928304497656, 8.109887266984204, 7.817982835685991, 37.355058161343734, 23.71389021673197, 29.24650240545825, 11.8038589006716, 23.198982694321398, 15.421114579189341, 19.795874718571906, 25.938404227058253, 13.610883874354947, 8.945477656887425, 40.84876917953546, 35.06512775969037, 20.633440923660004, 17.27171358479943, 11.58013076926412, 16.516943168823584, 22.7960070936994, 13.311198830559231, 34.09581776992074, 28.283439714904514, 4.680544528489992, 32.498862381378295, 7.984986756025324, 6.176257266574079, 9.81600746207612, 10.435012458666458, 13.141507541153903, 17.23909113038122, 33.06871368299374, 20.307904307114782, 16.222077604612295, 16.544414607019945, 44.69972935260656, 27.750746958265648, 28.360998003122997, 47.81908851672308, 35.73366793941374, 24.93512433517025, 37.29714090335969, 50.66150713672279, 22.685455742031838, 47.2175047152872, 19.597004448940748, 22.484129868664564, 27.59052744889674, 10.174463268752906, 32.95558602539362, 43.88441845876009, 18.763489482737967, 20.793405935967126, 35.849850453264665, 33.2841100511116, 27.34829124851277, 12.559255876767724, 36.57621679742563, 28.39873287843864, 20.814626971131872, 17.767807289646413, 16.002817168210736, 7.973854927967857, 26.219648079367385, 23.87789552607698, 14.526443207820744, 26.81950654170004, 30.706587975409864, 44.70364200000368, 33.48543282898349, 87.54261894870562, 40.91782297399216, 19.847638023414092, 19.770420003575605, 32.220513542530384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5844487788949891, "mean_inference_ms": 1.7620142013096416, "mean_action_processing_ms": 0.2640902615054369, "mean_env_wait_ms": 0.20811756919978394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004920363426208496, "StateBufferConnector_ms": 0.005803108215332031, "ViewRequirementAgentConnector_ms": 0.1421414613723755}, "num_episodes": 18, "episode_return_max": 363.72730851395187, "episode_return_min": 4.356429382585569, "episode_return_mean": 228.52159751357263, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.97080611507647, "num_env_steps_trained_throughput_per_sec": 312.97080611507647, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 13807.939, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13807.897, "sample_time_ms": 1810.412, "learn_time_ms": 11978.228, "learn_throughput": 333.939, "synch_weights_time_ms": 17.403}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "ef79f_00000", "date": "2024-08-16_11-23-21", "timestamp": 1723787601, "time_this_iter_s": 12.787453889846802, "time_total_s": 378.6870436668396, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b83a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 378.6870436668396, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 54.66842105263157, "ram_util_percent": 71.64736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8397714799989466, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.845474247957663, "policy_loss": -0.004542650611795209, "vf_loss": 8.846178359329386, "vf_explained_var": 0.22173873220801985, "kl": 0.012795116085949158, "entropy": 1.2804283260668397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2428474806603935, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.2391543957291455, "policy_loss": -0.007419758649769599, "vf_loss": 4.24503947237812, "vf_explained_var": 0.18949254990885497, "kl": 0.007673391177572509, "entropy": 0.9029822080223648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 363.72730851395187, "episode_reward_min": 4.356429382585569, "episode_reward_mean": 233.69437760005894, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -26.64871196930813, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.84299656277625, "predator_policy": 92.47825745861594}, "policy_reward_mean": {"prey_policy": 96.02144376043867, "predator_policy": 20.82574503959079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.9478225892887, 159.11453382763625, 354.71473410736303, 304.3289838594477, 295.6499414422425, 103.18134911666662, 80.89663817283439, 353.11490012104093, 208.5261462696379, 178.04616162808725, 117.46000000000032, 124.76311195525805, 339.6217377335214, 304.11, 4.356429382585569, 148.61152336844592, 220.76000000000005, 265.3098665139049, 298.3797249071754, 25.689999999999984, 363.72730851395187, 309.6965657925481, 270.9803544666111, 293.67857382672616, 164.1704797772331, 124.63000000000028, 145.27559317233857, 336.7342951813484, 145.5359630865264, 141.59429507690757, 323.84595917126984, 81.17443518488604, 339.6561918872693, 298.8605786434646, 156.86102240552776, 179.10122211752784, 126.75139536744926, 313.9960420809687, 196.22415448602297, 243.18051783486095, 244.17353297207382, 168.19724905866093, 296.19349115018684, 329.1884321351683, 306.062281516449, 357.55396390905537, 296.58920648461947, 246.25929368653334, 271.2189412586795, 300.44428622775774, 335.72629631330915, 303.7667792103148, 308.2971075477484, 149.96679831691267, 123.4413183058922, 248.3665126910215, 272.8240365325242, 352.36359017009954, 286.7798555485679, 151.37127412675287, 311.3913024214745, 267.0414117484044, 270.4539816030333, 247.9041479675407, 251.65947116192876, 223.36573418651582, 153.30955845306357, 271.53748824254234, 351.05785935093985, 195.04230312213443, 280.52090447895233, 238.04010791861015, 144.41651729360314, 143.19143381135888, 168.55669340542298, 255.93618119600754, 288.41560234966977, 286.4310517343898, 225.63418850412754, 198.28665531371286, 259.8900654845746, 292.2668336005785, 266.7863254704757, 130.44642483814405, 230.32030076730626, 189.58267134763946, 245.69745671413648, 187.06767696953278, 306.3048750332761, 156.20450138731832, 253.27487938582678, 207.80683816919475, 222.3079784793491, 180.62784835869638, 310.97531473610604, 210.68885307677934, 294.47959761590505, 227.83677144976332, 328.6247472299495, 137.01240539700493], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [23.155130038103227, 109.94642990098642, 2.0000000000000013, 112.7712232040579, 163.4522156889247, 183.74786573296757, 196.6427257833139, 72.55055025377413, 108.39431925866836, 131.30297063601319, 50.3384920827136, 2.0000000000000013, 46.653620046304326, -0.7482956528004261, 136.37207614458598, 197.84299656277625, 40.008149016829144, 159.5905256656786, 160.92116101304575, 2.0000000000000013, 4.813545843921662, 99.35755659091193, 1.5674932492597085, 101.45432802536408, 172.71396628530243, 123.98783280625301, 176.1654736988786, 98.80799444822753, 1.0579895673355069, 2.0000000000000013, 0.9494148224965018, 133.8704333722376, 183.2695976752073, 36.650000000000006, 76.48889083514368, 144.99546205938307, 142.12502127996623, 125.51338908963828, 21.82784846534046, 1.5431100638806576, 175.6757371603826, 180.5963105022553, 125.83442261031054, 141.96269950315846, 83.351239262872, 106.67003984524187, 174.68276781460116, 82.5667247736688, 140.66192553888223, 4.969999999999958, 0.4498480348603126, 119.33830257888918, 111.26121156842939, 0.9984810389110945, 142.5230468606104, 168.40703457108265, 96.68368337446026, 2.0000000000000013, 85.45426023806043, 8.690040068814039, 161.57076867101023, 142.76870476072068, 2.0000000000000013, 75.01548569803774, 157.2374896329402, 165.3779307846864, 127.77632162239001, 147.53, 116.57572798268951, 1.6184842116270677, -0.49303534772984814, 172.04680525091473, 76.49461301854829, -1.0786526957776255, 143.3492588917912, 124.1480889832427, 133.52781123363064, 40.435658393244154, 73.91888705184088, 136.38994387237727, 65.08412877627391, 117.56093921241475, 154.56181920541877, 1.3427795743518707, 119.84234593864667, 152.33041662187668, 121.8762211854433, 166.09631766350304, 94.99150248424533, 150.33132517732096, 165.69071509309128, 175.93537871329394, 105.57407821773604, 129.9461798888077, 123.35736104257384, 81.85157133782965, 109.86810726809698, 122.73073671707178, 118.67184232415894, 136.03816495796858, 154.2308520634167, 158.9390827186501, 134.3066973944749, 93.54618487661399, 176.21348991992357, 94.17846311936536, 119.86972437882501, 2.0000000000000013, 85.3341123816333, 2.0000000000000013, 67.46095523746003, 118.5262999687363, 128.29444367007926, 107.35018595257665, 166.39810425575973, 171.8042418917404, 135.94544493054252, 130.58339069728277, -6.869804100702924, 127.86047955592052, 115.87751230241588, 142.13717212895014, 109.44899302157474, 124.82592651519748, 36.31578900767103, 161.68771628449008, 92.6429129127705, 79.0811485349241, 96.98145047456899, 94.0092284127758, 104.32863116850459, 31.07845497792868, 14.117134420428197, 69.28946357531638, 104.51071401539214, 124.94563990954484, 137.50494730169586, 175.7879213315944, 79.27600558216467, 38.926293055816046, 138.55683782579393, 102.40717123445346, 93.20193156304444, 75.70421585118937, 105.09495338111329, -0.5859832127907967, 13.46579216888162, 64.75069196661286, 130.17845901182085, -0.20419986717614946, 117.10663916699049, 114.85286993283844, 111.67793330679055, 126.6401254374348, 120.42329831163504, 124.66180367323383, 108.37951562630533, 41.8444429024087, 34.6634816940666, 42.59512184195714, 82.68016496433748, 116.44443952283092, 124.22685502590444, 116.04904502856807, 78.58916633132718, 139.20830440084654, -26.64871196930813, 35.55477887694674, 89.602840425789, 82.29715350261549, 50.28830477069273, 91.09526946260362, 94.71114604241882, 122.7842769981878, 74.17895782006883, 54.528956512074906, 124.26245967103046, 133.98793889369222, 27.83361067994989, 53.55747566114986, 85.13009387430101, 106.92341071366958, 79.09126855056269, 49.935829623321965, 57.8228415920243, 107.22395312215917, 86.49833014400544, 56.67355457428741, 129.5493780152321, 149.16828942565328, 108.75368782541523, 54.42103322727726, 136.57903619689768, 122.6255292951821, 86.83871726773594, 76.66177424945958, 134.70493873952188, 173.18323504471095, 27.62847323223771, 32.71093677323514], "policy_predator_policy_reward": [24.32270541693669, 10.523557233262775, 20.825578122905235, 23.517732500673073, 4.723150274840002, 2.7915024106307933, 17.276340181750825, 17.85936764060882, 33.62710675082641, 22.32554479673467, 25.659897215730286, 25.18295981822261, 22.651440429412713, 12.339873349917722, 11.783864858834557, 7.115962554844204, 6.199110951643399, 2.728360635486537, 9.95121317706001, 5.173787437981781, 0.0, 13.28889756516646, 12.762584307249666, 8.978706373384192, 17.420738395803845, 25.49920024616211, 13.21312103450884, 15.92341081838499, 0.9020104326644944, 0.39642938258561755, 1.4078674132797109, 12.383807760432063, 0.8404023247927033, 0.0, 25.636694220158166, 18.188819399219916, 3.596699552797575, 27.1446149847733, 1.8821515346595408, 0.43688993611934374, 2.7261312458133644, 4.729129605500661, 27.217182238913722, 14.682261440165274, 40.18746411886857, 40.77161123962878, 29.75699433634875, 6.672086902107445, 17.34993308882982, 1.1886211495210963, 1.4801519651396888, 3.3616974211108053, 10.24111291099626, 22.774787654001713, 14.300548062398416, 11.503665687256962, 33.1826122001548, 13.669667511911205, 14.212772501248281, 33.23722226878454, 10.850117557917525, 8.656368181621408, 2.8340439500717878, 1.3249055367764737, 12.667182073022959, 4.373589396619696, 19.162632285402516, 4.391624735672084, 26.26465173885727, 12.402158472353861, 3.189842419842453, 4.3576097945008225, 47.306890693451145, 4.0285443512270955, 28.10358951790719, 18.395104688027583, 11.769301747003212, 10.491383112144817, 14.539166345993232, 18.332520564649556, 31.985871223726082, 29.542593759659002, 6.989283596739099, 5.303366682151265, 14.11999581641463, 9.900732773248665, 33.123778814556694, 8.092114471665225, 29.479525550385254, 31.259928304497656, 8.109887266984204, 7.817982835685991, 37.355058161343734, 23.71389021673197, 29.24650240545825, 11.8038589006716, 23.198982694321398, 15.421114579189341, 19.795874718571906, 25.938404227058253, 13.610883874354947, 8.945477656887425, 40.84876917953546, 35.06512775969037, 20.633440923660004, 17.27171358479943, 11.58013076926412, 16.516943168823584, 22.7960070936994, 13.311198830559231, 34.09581776992074, 28.283439714904514, 4.680544528489992, 32.498862381378295, 7.984986756025324, 6.176257266574079, 9.81600746207612, 10.435012458666458, 13.141507541153903, 17.23909113038122, 33.06871368299374, 20.307904307114782, 16.222077604612295, 16.544414607019945, 44.69972935260656, 27.750746958265648, 28.360998003122997, 47.81908851672308, 35.73366793941374, 24.93512433517025, 37.29714090335969, 50.66150713672279, 22.685455742031838, 47.2175047152872, 19.597004448940748, 22.484129868664564, 27.59052744889674, 10.174463268752906, 32.95558602539362, 43.88441845876009, 18.763489482737967, 20.793405935967126, 35.849850453264665, 33.2841100511116, 27.34829124851277, 12.559255876767724, 36.57621679742563, 28.39873287843864, 20.814626971131872, 17.767807289646413, 16.002817168210736, 7.973854927967857, 26.219648079367385, 23.87789552607698, 14.526443207820744, 26.81950654170004, 30.706587975409864, 44.70364200000368, 33.48543282898349, 87.54261894870562, 40.91782297399216, 19.847638023414092, 19.770420003575605, 32.220513542530384, 32.78436307126805, 16.204491667034123, 92.47825745861594, 29.062100471889565, 32.90643855780839, 25.513868281093494, 35.03524066553357, 13.163856448809515, 19.285636021599135, 8.916397651930776, 25.184348733199023, 33.175413904189995, 31.900628041932432, 16.153848426620886, 27.42022826430169, 47.393186781916945, 34.885462941604494, 26.33591185625166, 43.83559243536754, 34.94414755994248, 27.744195480407033, 29.51698828475866, 21.935699356502408, 15.520264283901117, 20.901596047099275, 11.356051248121322, 17.23573809831262, 30.278393925774218, 19.801810865929323, 15.473221257895991, 29.43512240617284, 34.90115752639494, 4.779588232766359, 15.956985212950354, 52.98727833631788, 23.685717055214237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5883623542157964, "mean_inference_ms": 1.7804241305201123, "mean_action_processing_ms": 0.2655600473861745, "mean_env_wait_ms": 0.21012276721163367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004814267158508301, "StateBufferConnector_ms": 0.005282878875732422, "ViewRequirementAgentConnector_ms": 0.12232482433319092}, "num_episodes": 18, "episode_return_max": 363.72730851395187, "episode_return_min": 4.356429382585569, "episode_return_mean": 233.69437760005894, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.85136904250373, "num_env_steps_trained_throughput_per_sec": 329.85136904250373, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 13714.789, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13714.746, "sample_time_ms": 1799.281, "learn_time_ms": 11896.216, "learn_throughput": 336.241, "synch_weights_time_ms": 17.334}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "ef79f_00000", "date": "2024-08-16_11-23-34", "timestamp": 1723787614, "time_this_iter_s": 12.132455110549927, "time_total_s": 390.8194987773895, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32140fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 390.8194987773895, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 55.04117647058824, "ram_util_percent": 72.77058823529411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0537593028217396, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.746837886426814, "policy_loss": -0.00590776528857609, "vf_loss": 8.75025973723679, "vf_explained_var": 0.19371597716417263, "kl": 0.00828634999603, "entropy": 1.2327099947702318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.343593455937804, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.707422713123301, "policy_loss": -0.007503027882224944, "vf_loss": 5.713602624873005, "vf_explained_var": 0.13046234398291856, "kl": 0.00661557513731745, "entropy": 0.9127024567947186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 357.55396390905537, "episode_reward_min": 44.33895521892311, "episode_reward_mean": 226.7906964856199, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -79.83612871027731, "predator_policy": 1.1886211495210963}, "policy_reward_max": {"prey_policy": 176.21348991992357, "predator_policy": 110.8673673599682}, "policy_reward_mean": {"prey_policy": 87.6430291836699, "predator_policy": 25.752319059140035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.9803544666111, 293.67857382672616, 164.1704797772331, 124.63000000000028, 145.27559317233857, 336.7342951813484, 145.5359630865264, 141.59429507690757, 323.84595917126984, 81.17443518488604, 339.6561918872693, 298.8605786434646, 156.86102240552776, 179.10122211752784, 126.75139536744926, 313.9960420809687, 196.22415448602297, 243.18051783486095, 244.17353297207382, 168.19724905866093, 296.19349115018684, 329.1884321351683, 306.062281516449, 357.55396390905537, 296.58920648461947, 246.25929368653334, 271.2189412586795, 300.44428622775774, 335.72629631330915, 303.7667792103148, 308.2971075477484, 149.96679831691267, 123.4413183058922, 248.3665126910215, 272.8240365325242, 352.36359017009954, 286.7798555485679, 151.37127412675287, 311.3913024214745, 267.0414117484044, 270.4539816030333, 247.9041479675407, 251.65947116192876, 223.36573418651582, 153.30955845306357, 271.53748824254234, 351.05785935093985, 195.04230312213443, 280.52090447895233, 238.04010791861015, 144.41651729360314, 143.19143381135888, 168.55669340542298, 255.93618119600754, 288.41560234966977, 286.4310517343898, 225.63418850412754, 198.28665531371286, 259.8900654845746, 292.2668336005785, 266.7863254704757, 130.44642483814405, 230.32030076730626, 189.58267134763946, 245.69745671413648, 187.06767696953278, 306.3048750332761, 156.20450138731832, 253.27487938582678, 207.80683816919475, 222.3079784793491, 180.62784835869638, 310.97531473610604, 210.68885307677934, 294.47959761590505, 227.83677144976332, 328.6247472299495, 137.01240539700493, 239.2326338380772, 279.2661239566449, 108.51784032671992, 263.53710189587554, 44.33895521892311, 117.8643368687513, 304.4763786943143, 100.41561370931237, 293.76521098383057, 202.48043809802007, 104.0330726916058, 130.33655256538674, 299.90718696199826, 74.41780492425079, 223.9863205721654, 153.85350675174834, 132.22568824763405, 251.98970323058793, 175.36851119570028, 62.52294577612893, 323.13204907559106, 151.97139227446314], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [83.351239262872, 106.67003984524187, 174.68276781460116, 82.5667247736688, 140.66192553888223, 4.969999999999958, 0.4498480348603126, 119.33830257888918, 111.26121156842939, 0.9984810389110945, 142.5230468606104, 168.40703457108265, 96.68368337446026, 2.0000000000000013, 85.45426023806043, 8.690040068814039, 161.57076867101023, 142.76870476072068, 2.0000000000000013, 75.01548569803774, 157.2374896329402, 165.3779307846864, 127.77632162239001, 147.53, 116.57572798268951, 1.6184842116270677, -0.49303534772984814, 172.04680525091473, 76.49461301854829, -1.0786526957776255, 143.3492588917912, 124.1480889832427, 133.52781123363064, 40.435658393244154, 73.91888705184088, 136.38994387237727, 65.08412877627391, 117.56093921241475, 154.56181920541877, 1.3427795743518707, 119.84234593864667, 152.33041662187668, 121.8762211854433, 166.09631766350304, 94.99150248424533, 150.33132517732096, 165.69071509309128, 175.93537871329394, 105.57407821773604, 129.9461798888077, 123.35736104257384, 81.85157133782965, 109.86810726809698, 122.73073671707178, 118.67184232415894, 136.03816495796858, 154.2308520634167, 158.9390827186501, 134.3066973944749, 93.54618487661399, 176.21348991992357, 94.17846311936536, 119.86972437882501, 2.0000000000000013, 85.3341123816333, 2.0000000000000013, 67.46095523746003, 118.5262999687363, 128.29444367007926, 107.35018595257665, 166.39810425575973, 171.8042418917404, 135.94544493054252, 130.58339069728277, -6.869804100702924, 127.86047955592052, 115.87751230241588, 142.13717212895014, 109.44899302157474, 124.82592651519748, 36.31578900767103, 161.68771628449008, 92.6429129127705, 79.0811485349241, 96.98145047456899, 94.0092284127758, 104.32863116850459, 31.07845497792868, 14.117134420428197, 69.28946357531638, 104.51071401539214, 124.94563990954484, 137.50494730169586, 175.7879213315944, 79.27600558216467, 38.926293055816046, 138.55683782579393, 102.40717123445346, 93.20193156304444, 75.70421585118937, 105.09495338111329, -0.5859832127907967, 13.46579216888162, 64.75069196661286, 130.17845901182085, -0.20419986717614946, 117.10663916699049, 114.85286993283844, 111.67793330679055, 126.6401254374348, 120.42329831163504, 124.66180367323383, 108.37951562630533, 41.8444429024087, 34.6634816940666, 42.59512184195714, 82.68016496433748, 116.44443952283092, 124.22685502590444, 116.04904502856807, 78.58916633132718, 139.20830440084654, -26.64871196930813, 35.55477887694674, 89.602840425789, 82.29715350261549, 50.28830477069273, 91.09526946260362, 94.71114604241882, 122.7842769981878, 74.17895782006883, 54.528956512074906, 124.26245967103046, 133.98793889369222, 27.83361067994989, 53.55747566114986, 85.13009387430101, 106.92341071366958, 79.09126855056269, 49.935829623321965, 57.8228415920243, 107.22395312215917, 86.49833014400544, 56.67355457428741, 129.5493780152321, 149.16828942565328, 108.75368782541523, 54.42103322727726, 136.57903619689768, 122.6255292951821, 86.83871726773594, 76.66177424945958, 134.70493873952188, 173.18323504471095, 27.62847323223771, 32.71093677323514, 91.63889173438392, 76.6098248896205, 70.97257016750851, 117.01480063911353, -11.145700381565252, 44.506679523741646, 84.29560157059498, 102.18299790631703, -79.83612871027731, -23.931775660812576, 26.039550914394372, 22.519380855335825, 146.99672495099009, 130.38013874790843, 28.838177343416774, -25.05760267452681, 134.98762243272648, 130.26754997172083, 24.285694142166747, 77.6474079204679, 54.4257577994738, 2.0000000000000013, 50.40137583540271, 8.074402337236322, 142.4941529732094, 128.9158364781439, 6.88166668263573, -18.168556674188764, 87.30203044519172, 68.82929068336391, 12.623226437249492, 64.5531918085027, 36.83013985071827, 18.54872001341263, 94.47468260425498, 93.62150210268538, 36.88274587885971, 67.61971690071917, 8.32962122305005, -7.627824532344582, 154.81488941014953, 134.8153109928519, 33.5061434154468, 47.12732902779064], "policy_predator_policy_reward": [40.18746411886857, 40.77161123962878, 29.75699433634875, 6.672086902107445, 17.34993308882982, 1.1886211495210963, 1.4801519651396888, 3.3616974211108053, 10.24111291099626, 22.774787654001713, 14.300548062398416, 11.503665687256962, 33.1826122001548, 13.669667511911205, 14.212772501248281, 33.23722226878454, 10.850117557917525, 8.656368181621408, 2.8340439500717878, 1.3249055367764737, 12.667182073022959, 4.373589396619696, 19.162632285402516, 4.391624735672084, 26.26465173885727, 12.402158472353861, 3.189842419842453, 4.3576097945008225, 47.306890693451145, 4.0285443512270955, 28.10358951790719, 18.395104688027583, 11.769301747003212, 10.491383112144817, 14.539166345993232, 18.332520564649556, 31.985871223726082, 29.542593759659002, 6.989283596739099, 5.303366682151265, 14.11999581641463, 9.900732773248665, 33.123778814556694, 8.092114471665225, 29.479525550385254, 31.259928304497656, 8.109887266984204, 7.817982835685991, 37.355058161343734, 23.71389021673197, 29.24650240545825, 11.8038589006716, 23.198982694321398, 15.421114579189341, 19.795874718571906, 25.938404227058253, 13.610883874354947, 8.945477656887425, 40.84876917953546, 35.06512775969037, 20.633440923660004, 17.27171358479943, 11.58013076926412, 16.516943168823584, 22.7960070936994, 13.311198830559231, 34.09581776992074, 28.283439714904514, 4.680544528489992, 32.498862381378295, 7.984986756025324, 6.176257266574079, 9.81600746207612, 10.435012458666458, 13.141507541153903, 17.23909113038122, 33.06871368299374, 20.307904307114782, 16.222077604612295, 16.544414607019945, 44.69972935260656, 27.750746958265648, 28.360998003122997, 47.81908851672308, 35.73366793941374, 24.93512433517025, 37.29714090335969, 50.66150713672279, 22.685455742031838, 47.2175047152872, 19.597004448940748, 22.484129868664564, 27.59052744889674, 10.174463268752906, 32.95558602539362, 43.88441845876009, 18.763489482737967, 20.793405935967126, 35.849850453264665, 33.2841100511116, 27.34829124851277, 12.559255876767724, 36.57621679742563, 28.39873287843864, 20.814626971131872, 17.767807289646413, 16.002817168210736, 7.973854927967857, 26.219648079367385, 23.87789552607698, 14.526443207820744, 26.81950654170004, 30.706587975409864, 44.70364200000368, 33.48543282898349, 87.54261894870562, 40.91782297399216, 19.847638023414092, 19.770420003575605, 32.220513542530384, 32.78436307126805, 16.204491667034123, 92.47825745861594, 29.062100471889565, 32.90643855780839, 25.513868281093494, 35.03524066553357, 13.163856448809515, 19.285636021599135, 8.916397651930776, 25.184348733199023, 33.175413904189995, 31.900628041932432, 16.153848426620886, 27.42022826430169, 47.393186781916945, 34.885462941604494, 26.33591185625166, 43.83559243536754, 34.94414755994248, 27.744195480407033, 29.51698828475866, 21.935699356502408, 15.520264283901117, 20.901596047099275, 11.356051248121322, 17.23573809831262, 30.278393925774218, 19.801810865929323, 15.473221257895991, 29.43512240617284, 34.90115752639494, 4.779588232766359, 15.956985212950354, 52.98727833631788, 23.685717055214237, 39.34797819035319, 31.635939023719583, 33.588052587748344, 57.69070056227468, 59.04088677770505, 16.115974406838454, 51.682552083879656, 25.37595033508379, 37.239492230044796, 110.8673673599682, 49.677713409650465, 19.62769168937066, 11.72007189914177, 15.379443096274004, 60.67542884964403, 35.95961019077842, 16.39410798259488, 12.115930596788344, 72.94331661554261, 27.60401941984282, 32.23165487269309, 15.375660019438437, 44.14957602071457, 27.71119837203307, 16.981462283730696, 11.515735226914241, 32.15761540624244, 53.547079509561456, 35.129264896417155, 32.725734547192644, 59.88745883270138, 16.789629673294773, 22.572539329419637, 54.2742890540834, 38.83795188909511, 25.05556663455244, 33.5912811863404, 37.27476722978099, 12.848964078748107, 48.97218500667531, 17.426953754522625, 16.074894918067024, 35.726087320771285, 35.61183251045428]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5932515508068077, "mean_inference_ms": 1.8027195649547894, "mean_action_processing_ms": 0.26709501884135256, "mean_env_wait_ms": 0.2122810929903922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004356265068054199, "StateBufferConnector_ms": 0.005152702331542969, "ViewRequirementAgentConnector_ms": 0.1183476448059082}, "num_episodes": 22, "episode_return_max": 357.55396390905537, "episode_return_min": 44.33895521892311, "episode_return_mean": 226.7906964856199, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 249.96642474304684, "num_env_steps_trained_throughput_per_sec": 249.96642474304684, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 13614.458, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13614.417, "sample_time_ms": 1678.91, "learn_time_ms": 11916.193, "learn_throughput": 335.678, "synch_weights_time_ms": 17.393}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "ef79f_00000", "date": "2024-08-16_11-23-50", "timestamp": 1723787630, "time_this_iter_s": 16.04150915145874, "time_total_s": 406.86100792884827, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214acc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 406.86100792884827, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 80.68636363636365, "ram_util_percent": 78.98636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1495396466482255, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.77931147454277, "policy_loss": -0.007441446768050944, "vf_loss": 8.784242860602323, "vf_explained_var": -0.07429046242956132, "kl": 0.00836688481559774, "entropy": 1.2115173520234528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.103792220827133, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.2100944279362915, "policy_loss": -0.006708073349566095, "vf_loss": 7.215486957913353, "vf_explained_var": 0.1272042263121832, "kl": 0.006577679634480381, "entropy": 0.8392644861072459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 357.55396390905537, "episode_reward_min": -0.26204970721082355, "episode_reward_mean": 196.87528266405354, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -89.248789936004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.21348991992357, "predator_policy": 110.8673673599682}, "policy_reward_mean": {"prey_policy": 65.44442285210775, "predator_policy": 32.993218479919044}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.55396390905537, 296.58920648461947, 246.25929368653334, 271.2189412586795, 300.44428622775774, 335.72629631330915, 303.7667792103148, 308.2971075477484, 149.96679831691267, 123.4413183058922, 248.3665126910215, 272.8240365325242, 352.36359017009954, 286.7798555485679, 151.37127412675287, 311.3913024214745, 267.0414117484044, 270.4539816030333, 247.9041479675407, 251.65947116192876, 223.36573418651582, 153.30955845306357, 271.53748824254234, 351.05785935093985, 195.04230312213443, 280.52090447895233, 238.04010791861015, 144.41651729360314, 143.19143381135888, 168.55669340542298, 255.93618119600754, 288.41560234966977, 286.4310517343898, 225.63418850412754, 198.28665531371286, 259.8900654845746, 292.2668336005785, 266.7863254704757, 130.44642483814405, 230.32030076730626, 189.58267134763946, 245.69745671413648, 187.06767696953278, 306.3048750332761, 156.20450138731832, 253.27487938582678, 207.80683816919475, 222.3079784793491, 180.62784835869638, 310.97531473610604, 210.68885307677934, 294.47959761590505, 227.83677144976332, 328.6247472299495, 137.01240539700493, 239.2326338380772, 279.2661239566449, 108.51784032671992, 263.53710189587554, 44.33895521892311, 117.8643368687513, 304.4763786943143, 100.41561370931237, 293.76521098383057, 202.48043809802007, 104.0330726916058, 130.33655256538674, 299.90718696199826, 74.41780492425079, 223.9863205721654, 153.85350675174834, 132.22568824763405, 251.98970323058793, 175.36851119570028, 62.52294577612893, 323.13204907559106, 151.97139227446314, 68.48156684479908, 91.71857429611262, 5.155229309595992, 18.41660929230729, 15.33473573606795, 7.939638244570279, 151.4517016319566, -0.26204970721082355, 118.73546821476728, 46.78941371105566, 130.41502548463515, 57.15609167229766, 131.25985360376316, 253.7559146876946, 15.057779494852669, 76.59072421591989, 110.79066270569096, 269.30636579936333, 125.66295472875957, 16.806654085183894, 272.25779496021534, 74.46613120947542, 177.2378382209764], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [165.69071509309128, 175.93537871329394, 105.57407821773604, 129.9461798888077, 123.35736104257384, 81.85157133782965, 109.86810726809698, 122.73073671707178, 118.67184232415894, 136.03816495796858, 154.2308520634167, 158.9390827186501, 134.3066973944749, 93.54618487661399, 176.21348991992357, 94.17846311936536, 119.86972437882501, 2.0000000000000013, 85.3341123816333, 2.0000000000000013, 67.46095523746003, 118.5262999687363, 128.29444367007926, 107.35018595257665, 166.39810425575973, 171.8042418917404, 135.94544493054252, 130.58339069728277, -6.869804100702924, 127.86047955592052, 115.87751230241588, 142.13717212895014, 109.44899302157474, 124.82592651519748, 36.31578900767103, 161.68771628449008, 92.6429129127705, 79.0811485349241, 96.98145047456899, 94.0092284127758, 104.32863116850459, 31.07845497792868, 14.117134420428197, 69.28946357531638, 104.51071401539214, 124.94563990954484, 137.50494730169586, 175.7879213315944, 79.27600558216467, 38.926293055816046, 138.55683782579393, 102.40717123445346, 93.20193156304444, 75.70421585118937, 105.09495338111329, -0.5859832127907967, 13.46579216888162, 64.75069196661286, 130.17845901182085, -0.20419986717614946, 117.10663916699049, 114.85286993283844, 111.67793330679055, 126.6401254374348, 120.42329831163504, 124.66180367323383, 108.37951562630533, 41.8444429024087, 34.6634816940666, 42.59512184195714, 82.68016496433748, 116.44443952283092, 124.22685502590444, 116.04904502856807, 78.58916633132718, 139.20830440084654, -26.64871196930813, 35.55477887694674, 89.602840425789, 82.29715350261549, 50.28830477069273, 91.09526946260362, 94.71114604241882, 122.7842769981878, 74.17895782006883, 54.528956512074906, 124.26245967103046, 133.98793889369222, 27.83361067994989, 53.55747566114986, 85.13009387430101, 106.92341071366958, 79.09126855056269, 49.935829623321965, 57.8228415920243, 107.22395312215917, 86.49833014400544, 56.67355457428741, 129.5493780152321, 149.16828942565328, 108.75368782541523, 54.42103322727726, 136.57903619689768, 122.6255292951821, 86.83871726773594, 76.66177424945958, 134.70493873952188, 173.18323504471095, 27.62847323223771, 32.71093677323514, 91.63889173438392, 76.6098248896205, 70.97257016750851, 117.01480063911353, -11.145700381565252, 44.506679523741646, 84.29560157059498, 102.18299790631703, -79.83612871027731, -23.931775660812576, 26.039550914394372, 22.519380855335825, 146.99672495099009, 130.38013874790843, 28.838177343416774, -25.05760267452681, 134.98762243272648, 130.26754997172083, 24.285694142166747, 77.6474079204679, 54.4257577994738, 2.0000000000000013, 50.40137583540271, 8.074402337236322, 142.4941529732094, 128.9158364781439, 6.88166668263573, -18.168556674188764, 87.30203044519172, 68.82929068336391, 12.623226437249492, 64.5531918085027, 36.83013985071827, 18.54872001341263, 94.47468260425498, 93.62150210268538, 36.88274587885971, 67.61971690071917, 8.32962122305005, -7.627824532344582, 154.81488941014953, 134.8153109928519, 33.5061434154468, 47.12732902779064, 10.075064145642857, -11.375448952653489, 18.98224166527534, 17.010656425980393, -59.93281882499764, -64.50749602537397, -13.19248710123719, -68.109512243561, -20.450177310810222, -70.792787738713, -77.41431626466661, -50.18835362474239, 68.38435045403378, 12.073086830479792, -78.20612867584411, -72.34768694019648, -66.7578735576237, 94.3974156794765, -88.35315992847575, -32.019395299261, 80.98654041455178, -4.267027336381578, -0.24565664773736126, -51.64956454466821, 38.87502656979371, 4.769436187316397, 76.01978625870382, 122.29123020891937, -32.00756589284663, -38.65273868818877, -11.011623803063387, -3.845640955750749, 41.70463323229242, -2.047695630497531, 154.4152304554184, 50.198689488093514, -3.9437919953848493, 1.9039512152450597, -80.04481626623779, -89.248789936004, 90.44202589921835, 148.23136249255313, 10.703439474710903, -30.588412728771065, 53.34962417649071, 55.60260275212764], "policy_predator_policy_reward": [8.109887266984204, 7.817982835685991, 37.355058161343734, 23.71389021673197, 29.24650240545825, 11.8038589006716, 23.198982694321398, 15.421114579189341, 19.795874718571906, 25.938404227058253, 13.610883874354947, 8.945477656887425, 40.84876917953546, 35.06512775969037, 20.633440923660004, 17.27171358479943, 11.58013076926412, 16.516943168823584, 22.7960070936994, 13.311198830559231, 34.09581776992074, 28.283439714904514, 4.680544528489992, 32.498862381378295, 7.984986756025324, 6.176257266574079, 9.81600746207612, 10.435012458666458, 13.141507541153903, 17.23909113038122, 33.06871368299374, 20.307904307114782, 16.222077604612295, 16.544414607019945, 44.69972935260656, 27.750746958265648, 28.360998003122997, 47.81908851672308, 35.73366793941374, 24.93512433517025, 37.29714090335969, 50.66150713672279, 22.685455742031838, 47.2175047152872, 19.597004448940748, 22.484129868664564, 27.59052744889674, 10.174463268752906, 32.95558602539362, 43.88441845876009, 18.763489482737967, 20.793405935967126, 35.849850453264665, 33.2841100511116, 27.34829124851277, 12.559255876767724, 36.57621679742563, 28.39873287843864, 20.814626971131872, 17.767807289646413, 16.002817168210736, 7.973854927967857, 26.219648079367385, 23.87789552607698, 14.526443207820744, 26.81950654170004, 30.706587975409864, 44.70364200000368, 33.48543282898349, 87.54261894870562, 40.91782297399216, 19.847638023414092, 19.770420003575605, 32.220513542530384, 32.78436307126805, 16.204491667034123, 92.47825745861594, 29.062100471889565, 32.90643855780839, 25.513868281093494, 35.03524066553357, 13.163856448809515, 19.285636021599135, 8.916397651930776, 25.184348733199023, 33.175413904189995, 31.900628041932432, 16.153848426620886, 27.42022826430169, 47.393186781916945, 34.885462941604494, 26.33591185625166, 43.83559243536754, 34.94414755994248, 27.744195480407033, 29.51698828475866, 21.935699356502408, 15.520264283901117, 20.901596047099275, 11.356051248121322, 17.23573809831262, 30.278393925774218, 19.801810865929323, 15.473221257895991, 29.43512240617284, 34.90115752639494, 4.779588232766359, 15.956985212950354, 52.98727833631788, 23.685717055214237, 39.34797819035319, 31.635939023719583, 33.588052587748344, 57.69070056227468, 59.04088677770505, 16.115974406838454, 51.682552083879656, 25.37595033508379, 37.239492230044796, 110.8673673599682, 49.677713409650465, 19.62769168937066, 11.72007189914177, 15.379443096274004, 60.67542884964403, 35.95961019077842, 16.39410798259488, 12.115930596788344, 72.94331661554261, 27.60401941984282, 32.23165487269309, 15.375660019438437, 44.14957602071457, 27.71119837203307, 16.981462283730696, 11.515735226914241, 32.15761540624244, 53.547079509561456, 35.129264896417155, 32.725734547192644, 59.88745883270138, 16.789629673294773, 22.572539329419637, 54.2742890540834, 38.83795188909511, 25.05556663455244, 33.5912811863404, 37.27476722978099, 12.848964078748107, 48.97218500667531, 17.426953754522625, 16.074894918067024, 35.726087320771285, 35.61183251045428, 46.878110115963864, 22.903841535845903, 42.95552165242062, 12.770154552436173, 54.697805632818955, 74.89773852714866, 70.33095775641445, 29.38765088069106, 89.99852330815047, 16.579177477440897, 41.55352164750797, 93.9887864864713, 35.73008276461475, 35.264181582828236, 79.61712822296155, 70.67463768586829, 77.36391662255986, 13.732009470354628, 88.03074422084673, 79.13122471794584, 20.64402142310395, 33.0514909833609, 44.1551053084039, 64.89620755629923, 61.35502088084053, 26.26036996581263, 31.228906310617386, 24.215991909454168, 10.090955783671662, 75.62712829221638, 60.463616645230054, 30.984372329503994, 51.84014306509585, 19.29358203880016, 35.23935300474592, 29.453092851105456, 35.817228802176075, 91.88556670672327, 90.65480028614537, 95.44546000128028, 33.58440656844389, 0.0, 48.67523984607895, 45.67586461745665, 33.38578331863908, 34.899827973718885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5977967714478213, "mean_inference_ms": 1.8206578354222984, "mean_action_processing_ms": 0.2688164817225729, "mean_env_wait_ms": 0.21477541936833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004615664482116699, "StateBufferConnector_ms": 0.0037009716033935547, "ViewRequirementAgentConnector_ms": 0.127113938331604}, "num_episodes": 23, "episode_return_max": 357.55396390905537, "episode_return_min": -0.26204970721082355, "episode_return_mean": 196.87528266405354, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.0890496863044, "num_env_steps_trained_throughput_per_sec": 305.0890496863044, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 13743.58, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13743.537, "sample_time_ms": 1747.369, "learn_time_ms": 11976.691, "learn_throughput": 333.982, "synch_weights_time_ms": 17.571}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "ef79f_00000", "date": "2024-08-16_11-24-03", "timestamp": 1723787643, "time_this_iter_s": 13.116150856018066, "time_total_s": 419.97715878486633, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214ace50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 419.97715878486633, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 54.03684210526315, "ram_util_percent": 72.17894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0448104707021564, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.205493073993258, "policy_loss": -0.007758982620872163, "vf_loss": 9.211323193141393, "vf_explained_var": -0.17489836001522327, "kl": 0.006429514736445635, "entropy": 1.2131532844412263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.289379391026875, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.877949476746655, "policy_loss": -0.006695203946671749, "vf_loss": 7.882939029370666, "vf_explained_var": 0.07292879466657286, "kl": 0.008528227740817535, "entropy": 0.7871650635565399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 351.05785935093985, "episode_reward_min": -15.274273229148227, "episode_reward_mean": 156.86912317039284, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -132.2790906820826, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 175.7879213315944, "predator_policy": 155.28269877144297}, "policy_reward_mean": {"prey_policy": 35.485738014807815, "predator_policy": 42.94882357038863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [247.9041479675407, 251.65947116192876, 223.36573418651582, 153.30955845306357, 271.53748824254234, 351.05785935093985, 195.04230312213443, 280.52090447895233, 238.04010791861015, 144.41651729360314, 143.19143381135888, 168.55669340542298, 255.93618119600754, 288.41560234966977, 286.4310517343898, 225.63418850412754, 198.28665531371286, 259.8900654845746, 292.2668336005785, 266.7863254704757, 130.44642483814405, 230.32030076730626, 189.58267134763946, 245.69745671413648, 187.06767696953278, 306.3048750332761, 156.20450138731832, 253.27487938582678, 207.80683816919475, 222.3079784793491, 180.62784835869638, 310.97531473610604, 210.68885307677934, 294.47959761590505, 227.83677144976332, 328.6247472299495, 137.01240539700493, 239.2326338380772, 279.2661239566449, 108.51784032671992, 263.53710189587554, 44.33895521892311, 117.8643368687513, 304.4763786943143, 100.41561370931237, 293.76521098383057, 202.48043809802007, 104.0330726916058, 130.33655256538674, 299.90718696199826, 74.41780492425079, 223.9863205721654, 153.85350675174834, 132.22568824763405, 251.98970323058793, 175.36851119570028, 62.52294577612893, 323.13204907559106, 151.97139227446314, 68.48156684479908, 91.71857429611262, 5.155229309595992, 18.41660929230729, 15.33473573606795, 7.939638244570279, 151.4517016319566, -0.26204970721082355, 118.73546821476728, 46.78941371105566, 130.41502548463515, 57.15609167229766, 131.25985360376316, 253.7559146876946, 15.057779494852669, 76.59072421591989, 110.79066270569096, 269.30636579936333, 125.66295472875957, 16.806654085183894, 272.25779496021534, 74.46613120947542, 177.2378382209764, 58.00484869370727, 126.2721381425374, 45.75531168147216, 58.67314021442805, 23.36994222205103, 21.183338396887166, 29.369786803223942, 11.542265782868819, 46.39846848007098, 38.20656474753735, -15.274273229148227, 25.10511710835053, 51.508349373009246, 77.54896428125421, 7.437831948166516, 170.88175130119512, 48.75246500669611, 28.503995782322463], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [92.6429129127705, 79.0811485349241, 96.98145047456899, 94.0092284127758, 104.32863116850459, 31.07845497792868, 14.117134420428197, 69.28946357531638, 104.51071401539214, 124.94563990954484, 137.50494730169586, 175.7879213315944, 79.27600558216467, 38.926293055816046, 138.55683782579393, 102.40717123445346, 93.20193156304444, 75.70421585118937, 105.09495338111329, -0.5859832127907967, 13.46579216888162, 64.75069196661286, 130.17845901182085, -0.20419986717614946, 117.10663916699049, 114.85286993283844, 111.67793330679055, 126.6401254374348, 120.42329831163504, 124.66180367323383, 108.37951562630533, 41.8444429024087, 34.6634816940666, 42.59512184195714, 82.68016496433748, 116.44443952283092, 124.22685502590444, 116.04904502856807, 78.58916633132718, 139.20830440084654, -26.64871196930813, 35.55477887694674, 89.602840425789, 82.29715350261549, 50.28830477069273, 91.09526946260362, 94.71114604241882, 122.7842769981878, 74.17895782006883, 54.528956512074906, 124.26245967103046, 133.98793889369222, 27.83361067994989, 53.55747566114986, 85.13009387430101, 106.92341071366958, 79.09126855056269, 49.935829623321965, 57.8228415920243, 107.22395312215917, 86.49833014400544, 56.67355457428741, 129.5493780152321, 149.16828942565328, 108.75368782541523, 54.42103322727726, 136.57903619689768, 122.6255292951821, 86.83871726773594, 76.66177424945958, 134.70493873952188, 173.18323504471095, 27.62847323223771, 32.71093677323514, 91.63889173438392, 76.6098248896205, 70.97257016750851, 117.01480063911353, -11.145700381565252, 44.506679523741646, 84.29560157059498, 102.18299790631703, -79.83612871027731, -23.931775660812576, 26.039550914394372, 22.519380855335825, 146.99672495099009, 130.38013874790843, 28.838177343416774, -25.05760267452681, 134.98762243272648, 130.26754997172083, 24.285694142166747, 77.6474079204679, 54.4257577994738, 2.0000000000000013, 50.40137583540271, 8.074402337236322, 142.4941529732094, 128.9158364781439, 6.88166668263573, -18.168556674188764, 87.30203044519172, 68.82929068336391, 12.623226437249492, 64.5531918085027, 36.83013985071827, 18.54872001341263, 94.47468260425498, 93.62150210268538, 36.88274587885971, 67.61971690071917, 8.32962122305005, -7.627824532344582, 154.81488941014953, 134.8153109928519, 33.5061434154468, 47.12732902779064, 10.075064145642857, -11.375448952653489, 18.98224166527534, 17.010656425980393, -59.93281882499764, -64.50749602537397, -13.19248710123719, -68.109512243561, -20.450177310810222, -70.792787738713, -77.41431626466661, -50.18835362474239, 68.38435045403378, 12.073086830479792, -78.20612867584411, -72.34768694019648, -66.7578735576237, 94.3974156794765, -88.35315992847575, -32.019395299261, 80.98654041455178, -4.267027336381578, -0.24565664773736126, -51.64956454466821, 38.87502656979371, 4.769436187316397, 76.01978625870382, 122.29123020891937, -32.00756589284663, -38.65273868818877, -11.011623803063387, -3.845640955750749, 41.70463323229242, -2.047695630497531, 154.4152304554184, 50.198689488093514, -3.9437919953848493, 1.9039512152450597, -80.04481626623779, -89.248789936004, 90.44202589921835, 148.23136249255313, 10.703439474710903, -30.588412728771065, 53.34962417649071, 55.60260275212764, -44.782800068346, 6.072600311787617, -0.11163297966772018, 39.085671115900425, -4.0246352120185644, -61.7555602321021, -41.537510583531216, -19.7672778804653, -49.31528287676559, -98.44826841437502, -45.10617303731921, -69.48013451111785, -40.128553652474594, -91.64982221666489, -77.23989866713555, -79.8870618334464, -52.84907022950988, 19.33858506562006, -87.01937992587861, -119.50528074713664, -127.33389265006679, -98.58503496603699, -132.2790906820826, -72.3407879046262, -81.58777691106557, -2.0398806730895913, -51.777297994017644, -46.06652699555851, -64.55592592978421, -54.50839983284867, 9.586175131822655, 67.66325117425664, -111.7412970996261, -55.61291876051537, -45.05690330760664, -79.45957975126676], "policy_predator_policy_reward": [28.360998003122997, 47.81908851672308, 35.73366793941374, 24.93512433517025, 37.29714090335969, 50.66150713672279, 22.685455742031838, 47.2175047152872, 19.597004448940748, 22.484129868664564, 27.59052744889674, 10.174463268752906, 32.95558602539362, 43.88441845876009, 18.763489482737967, 20.793405935967126, 35.849850453264665, 33.2841100511116, 27.34829124851277, 12.559255876767724, 36.57621679742563, 28.39873287843864, 20.814626971131872, 17.767807289646413, 16.002817168210736, 7.973854927967857, 26.219648079367385, 23.87789552607698, 14.526443207820744, 26.81950654170004, 30.706587975409864, 44.70364200000368, 33.48543282898349, 87.54261894870562, 40.91782297399216, 19.847638023414092, 19.770420003575605, 32.220513542530384, 32.78436307126805, 16.204491667034123, 92.47825745861594, 29.062100471889565, 32.90643855780839, 25.513868281093494, 35.03524066553357, 13.163856448809515, 19.285636021599135, 8.916397651930776, 25.184348733199023, 33.175413904189995, 31.900628041932432, 16.153848426620886, 27.42022826430169, 47.393186781916945, 34.885462941604494, 26.33591185625166, 43.83559243536754, 34.94414755994248, 27.744195480407033, 29.51698828475866, 21.935699356502408, 15.520264283901117, 20.901596047099275, 11.356051248121322, 17.23573809831262, 30.278393925774218, 19.801810865929323, 15.473221257895991, 29.43512240617284, 34.90115752639494, 4.779588232766359, 15.956985212950354, 52.98727833631788, 23.685717055214237, 39.34797819035319, 31.635939023719583, 33.588052587748344, 57.69070056227468, 59.04088677770505, 16.115974406838454, 51.682552083879656, 25.37595033508379, 37.239492230044796, 110.8673673599682, 49.677713409650465, 19.62769168937066, 11.72007189914177, 15.379443096274004, 60.67542884964403, 35.95961019077842, 16.39410798259488, 12.115930596788344, 72.94331661554261, 27.60401941984282, 32.23165487269309, 15.375660019438437, 44.14957602071457, 27.71119837203307, 16.981462283730696, 11.515735226914241, 32.15761540624244, 53.547079509561456, 35.129264896417155, 32.725734547192644, 59.88745883270138, 16.789629673294773, 22.572539329419637, 54.2742890540834, 38.83795188909511, 25.05556663455244, 33.5912811863404, 37.27476722978099, 12.848964078748107, 48.97218500667531, 17.426953754522625, 16.074894918067024, 35.726087320771285, 35.61183251045428, 46.878110115963864, 22.903841535845903, 42.95552165242062, 12.770154552436173, 54.697805632818955, 74.89773852714866, 70.33095775641445, 29.38765088069106, 89.99852330815047, 16.579177477440897, 41.55352164750797, 93.9887864864713, 35.73008276461475, 35.264181582828236, 79.61712822296155, 70.67463768586829, 77.36391662255986, 13.732009470354628, 88.03074422084673, 79.13122471794584, 20.64402142310395, 33.0514909833609, 44.1551053084039, 64.89620755629923, 61.35502088084053, 26.26036996581263, 31.228906310617386, 24.215991909454168, 10.090955783671662, 75.62712829221638, 60.463616645230054, 30.984372329503994, 51.84014306509585, 19.29358203880016, 35.23935300474592, 29.453092851105456, 35.817228802176075, 91.88556670672327, 90.65480028614537, 95.44546000128028, 33.58440656844389, 0.0, 48.67523984607895, 45.67586461745665, 33.38578331863908, 34.899827973718885, 41.55418614902887, 55.16086230123671, 44.538311708650774, 42.75978829765389, 52.26939809735214, 59.26610902824071, 55.806094385824395, 64.17183429260012, 51.35828660115603, 119.77520691203559, 49.572952557885856, 86.19669338743833, 65.54348835465761, 95.60467431770589, 78.7268510627779, 89.94237522067289, 25.22089450273539, 54.68805914122547, 140.8119332207012, 103.91929219985163, 55.361955615512656, 155.28269877144297, 125.71316064109169, 104.01183505396764, 44.15838200166718, 90.97762495549725, 113.79318148914884, 61.599607781681584, 69.59682670240704, 56.905331008392444, 47.72859894249708, 45.903726052618815, 129.5413454586047, 86.56533540823293, 67.44181615816774, 85.578662683028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6014932557429011, "mean_inference_ms": 1.8364696399165532, "mean_action_processing_ms": 0.27004038828736227, "mean_env_wait_ms": 0.2165429990916271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00467073917388916, "StateBufferConnector_ms": 0.0037450790405273438, "ViewRequirementAgentConnector_ms": 0.12678265571594238}, "num_episodes": 18, "episode_return_max": 351.05785935093985, "episode_return_min": -15.274273229148227, "episode_return_mean": 156.86912317039284, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.31799788478753, "num_env_steps_trained_throughput_per_sec": 300.31799788478753, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 13840.379, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13840.336, "sample_time_ms": 1740.36, "learn_time_ms": 12075.449, "learn_throughput": 331.251, "synch_weights_time_ms": 22.654}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "ef79f_00000", "date": "2024-08-16_11-24-16", "timestamp": 1723787656, "time_this_iter_s": 13.41798210144043, "time_total_s": 433.39514088630676, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321790310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 433.39514088630676, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 67.02631578947368, "ram_util_percent": 72.97894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.505638244196221, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.217529164672529, "policy_loss": -0.001654461699306334, "vf_loss": 9.216896908876127, "vf_explained_var": 0.007565167372819608, "kl": 0.0076223991128028116, "entropy": 1.2126843140869545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.235195601837976, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.242763236716941, "policy_loss": -0.007280858312043603, "vf_loss": 7.248438460486276, "vf_explained_var": 0.16400106214972401, "kl": 0.008028201471079384, "entropy": 0.7532447256739178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 328.6247472299495, "episode_reward_min": -26.518908254084305, "episode_reward_mean": 124.20447007027316, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -136.52865866887404, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.06, "predator_policy": 155.28269877144297}, "policy_reward_mean": {"prey_policy": 11.325979607278702, "predator_policy": 50.77625542785788}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.2668336005785, 266.7863254704757, 130.44642483814405, 230.32030076730626, 189.58267134763946, 245.69745671413648, 187.06767696953278, 306.3048750332761, 156.20450138731832, 253.27487938582678, 207.80683816919475, 222.3079784793491, 180.62784835869638, 310.97531473610604, 210.68885307677934, 294.47959761590505, 227.83677144976332, 328.6247472299495, 137.01240539700493, 239.2326338380772, 279.2661239566449, 108.51784032671992, 263.53710189587554, 44.33895521892311, 117.8643368687513, 304.4763786943143, 100.41561370931237, 293.76521098383057, 202.48043809802007, 104.0330726916058, 130.33655256538674, 299.90718696199826, 74.41780492425079, 223.9863205721654, 153.85350675174834, 132.22568824763405, 251.98970323058793, 175.36851119570028, 62.52294577612893, 323.13204907559106, 151.97139227446314, 68.48156684479908, 91.71857429611262, 5.155229309595992, 18.41660929230729, 15.33473573606795, 7.939638244570279, 151.4517016319566, -0.26204970721082355, 118.73546821476728, 46.78941371105566, 130.41502548463515, 57.15609167229766, 131.25985360376316, 253.7559146876946, 15.057779494852669, 76.59072421591989, 110.79066270569096, 269.30636579936333, 125.66295472875957, 16.806654085183894, 272.25779496021534, 74.46613120947542, 177.2378382209764, 58.00484869370727, 126.2721381425374, 45.75531168147216, 58.67314021442805, 23.36994222205103, 21.183338396887166, 29.369786803223942, 11.542265782868819, 46.39846848007098, 38.20656474753735, -15.274273229148227, 25.10511710835053, 51.508349373009246, 77.54896428125421, 7.437831948166516, 170.88175130119512, 48.75246500669611, 28.503995782322463, 40.646515150675185, 41.353549775332645, 316.67542642861997, 57.405335033043535, 42.085985400828406, 10.55134331877969, 19.23619701304922, -5.2257865165192126, 35.22748373718877, 32.996051157336105, 20.59172349273313, 124.89324449976341, -1.2703218509290988, 13.746534615975541, 63.505797849295924, 42.88238166010953, 87.94810145192562, -26.518908254084305], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [124.22685502590444, 116.04904502856807, 78.58916633132718, 139.20830440084654, -26.64871196930813, 35.55477887694674, 89.602840425789, 82.29715350261549, 50.28830477069273, 91.09526946260362, 94.71114604241882, 122.7842769981878, 74.17895782006883, 54.528956512074906, 124.26245967103046, 133.98793889369222, 27.83361067994989, 53.55747566114986, 85.13009387430101, 106.92341071366958, 79.09126855056269, 49.935829623321965, 57.8228415920243, 107.22395312215917, 86.49833014400544, 56.67355457428741, 129.5493780152321, 149.16828942565328, 108.75368782541523, 54.42103322727726, 136.57903619689768, 122.6255292951821, 86.83871726773594, 76.66177424945958, 134.70493873952188, 173.18323504471095, 27.62847323223771, 32.71093677323514, 91.63889173438392, 76.6098248896205, 70.97257016750851, 117.01480063911353, -11.145700381565252, 44.506679523741646, 84.29560157059498, 102.18299790631703, -79.83612871027731, -23.931775660812576, 26.039550914394372, 22.519380855335825, 146.99672495099009, 130.38013874790843, 28.838177343416774, -25.05760267452681, 134.98762243272648, 130.26754997172083, 24.285694142166747, 77.6474079204679, 54.4257577994738, 2.0000000000000013, 50.40137583540271, 8.074402337236322, 142.4941529732094, 128.9158364781439, 6.88166668263573, -18.168556674188764, 87.30203044519172, 68.82929068336391, 12.623226437249492, 64.5531918085027, 36.83013985071827, 18.54872001341263, 94.47468260425498, 93.62150210268538, 36.88274587885971, 67.61971690071917, 8.32962122305005, -7.627824532344582, 154.81488941014953, 134.8153109928519, 33.5061434154468, 47.12732902779064, 10.075064145642857, -11.375448952653489, 18.98224166527534, 17.010656425980393, -59.93281882499764, -64.50749602537397, -13.19248710123719, -68.109512243561, -20.450177310810222, -70.792787738713, -77.41431626466661, -50.18835362474239, 68.38435045403378, 12.073086830479792, -78.20612867584411, -72.34768694019648, -66.7578735576237, 94.3974156794765, -88.35315992847575, -32.019395299261, 80.98654041455178, -4.267027336381578, -0.24565664773736126, -51.64956454466821, 38.87502656979371, 4.769436187316397, 76.01978625870382, 122.29123020891937, -32.00756589284663, -38.65273868818877, -11.011623803063387, -3.845640955750749, 41.70463323229242, -2.047695630497531, 154.4152304554184, 50.198689488093514, -3.9437919953848493, 1.9039512152450597, -80.04481626623779, -89.248789936004, 90.44202589921835, 148.23136249255313, 10.703439474710903, -30.588412728771065, 53.34962417649071, 55.60260275212764, -44.782800068346, 6.072600311787617, -0.11163297966772018, 39.085671115900425, -4.0246352120185644, -61.7555602321021, -41.537510583531216, -19.7672778804653, -49.31528287676559, -98.44826841437502, -45.10617303731921, -69.48013451111785, -40.128553652474594, -91.64982221666489, -77.23989866713555, -79.8870618334464, -52.84907022950988, 19.33858506562006, -87.01937992587861, -119.50528074713664, -127.33389265006679, -98.58503496603699, -132.2790906820826, -72.3407879046262, -81.58777691106557, -2.0398806730895913, -51.777297994017644, -46.06652699555851, -64.55592592978421, -54.50839983284867, 9.586175131822655, 67.66325117425664, -111.7412970996261, -55.61291876051537, -45.05690330760664, -79.45957975126676, -20.405978440507145, -41.58000955571915, -66.76554740430129, -27.01287277123212, 194.06, 70.24205978741588, -68.78466146568948, -30.54772721454511, -25.96163096643804, -59.20002187506711, -134.20587606927128, -136.52865866887404, -56.05386001097265, -118.10415161200058, -77.24405166430999, -64.81448253493427, -112.94137428374256, -63.71697882187174, -35.48101457780883, -104.05964458076136, -44.7624525002593, -70.61458327796551, 4.9049628175579425, 50.10471520553958, -108.35752210044845, -55.452085569914495, -60.48621997164383, -83.11222541219152, -88.8804577809632, -39.6853289032198, -55.081577271754576, -34.50467991567133, -13.662496287578678, 5.880203492471589, -81.51553796726819, -70.60026135468503], "policy_predator_policy_reward": [19.770420003575605, 32.220513542530384, 32.78436307126805, 16.204491667034123, 92.47825745861594, 29.062100471889565, 32.90643855780839, 25.513868281093494, 35.03524066553357, 13.163856448809515, 19.285636021599135, 8.916397651930776, 25.184348733199023, 33.175413904189995, 31.900628041932432, 16.153848426620886, 27.42022826430169, 47.393186781916945, 34.885462941604494, 26.33591185625166, 43.83559243536754, 34.94414755994248, 27.744195480407033, 29.51698828475866, 21.935699356502408, 15.520264283901117, 20.901596047099275, 11.356051248121322, 17.23573809831262, 30.278393925774218, 19.801810865929323, 15.473221257895991, 29.43512240617284, 34.90115752639494, 4.779588232766359, 15.956985212950354, 52.98727833631788, 23.685717055214237, 39.34797819035319, 31.635939023719583, 33.588052587748344, 57.69070056227468, 59.04088677770505, 16.115974406838454, 51.682552083879656, 25.37595033508379, 37.239492230044796, 110.8673673599682, 49.677713409650465, 19.62769168937066, 11.72007189914177, 15.379443096274004, 60.67542884964403, 35.95961019077842, 16.39410798259488, 12.115930596788344, 72.94331661554261, 27.60401941984282, 32.23165487269309, 15.375660019438437, 44.14957602071457, 27.71119837203307, 16.981462283730696, 11.515735226914241, 32.15761540624244, 53.547079509561456, 35.129264896417155, 32.725734547192644, 59.88745883270138, 16.789629673294773, 22.572539329419637, 54.2742890540834, 38.83795188909511, 25.05556663455244, 33.5912811863404, 37.27476722978099, 12.848964078748107, 48.97218500667531, 17.426953754522625, 16.074894918067024, 35.726087320771285, 35.61183251045428, 46.878110115963864, 22.903841535845903, 42.95552165242062, 12.770154552436173, 54.697805632818955, 74.89773852714866, 70.33095775641445, 29.38765088069106, 89.99852330815047, 16.579177477440897, 41.55352164750797, 93.9887864864713, 35.73008276461475, 35.264181582828236, 79.61712822296155, 70.67463768586829, 77.36391662255986, 13.732009470354628, 88.03074422084673, 79.13122471794584, 20.64402142310395, 33.0514909833609, 44.1551053084039, 64.89620755629923, 61.35502088084053, 26.26036996581263, 31.228906310617386, 24.215991909454168, 10.090955783671662, 75.62712829221638, 60.463616645230054, 30.984372329503994, 51.84014306509585, 19.29358203880016, 35.23935300474592, 29.453092851105456, 35.817228802176075, 91.88556670672327, 90.65480028614537, 95.44546000128028, 33.58440656844389, 0.0, 48.67523984607895, 45.67586461745665, 33.38578331863908, 34.899827973718885, 41.55418614902887, 55.16086230123671, 44.538311708650774, 42.75978829765389, 52.26939809735214, 59.26610902824071, 55.806094385824395, 64.17183429260012, 51.35828660115603, 119.77520691203559, 49.572952557885856, 86.19669338743833, 65.54348835465761, 95.60467431770589, 78.7268510627779, 89.94237522067289, 25.22089450273539, 54.68805914122547, 140.8119332207012, 103.91929219985163, 55.361955615512656, 155.28269877144297, 125.71316064109169, 104.01183505396764, 44.15838200166718, 90.97762495549725, 113.79318148914884, 61.599607781681584, 69.59682670240704, 56.905331008392444, 47.72859894249708, 45.903726052618815, 129.5413454586047, 86.56533540823293, 67.44181615816774, 85.578662683028, 46.47123409093803, 56.16126905596349, 95.57078123912909, 39.56118871173681, 30.227476224695792, 22.14589041650815, 68.49849029514608, 88.239233418132, 62.46453130276541, 64.78310693956809, 138.07772746704555, 143.20815058987935, 123.33142518219177, 70.0627834538306, 38.39960667160029, 98.43314101112477, 127.68452207653289, 84.20131476627024, 83.08168907920901, 89.45502123669749, 61.71926036336601, 74.249498907592, 41.76165533482849, 28.121911141837444, 50.27364814288026, 112.26563767655381, 63.19206720220596, 94.15291279760487, 115.65615153580737, 76.41543299767145, 68.8695055233946, 63.599133324140695, 43.1437339898642, 52.58666025716858, 92.26248901748197, 33.33440205038721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6098943961104848, "mean_inference_ms": 1.8630908377722193, "mean_action_processing_ms": 0.27260298122532023, "mean_env_wait_ms": 0.2200303787403274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005665302276611328, "StateBufferConnector_ms": 0.0062732696533203125, "ViewRequirementAgentConnector_ms": 0.2048020362854004}, "num_episodes": 18, "episode_return_max": 328.6247472299495, "episode_return_min": -26.518908254084305, "episode_return_mean": 124.20447007027316, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.68924748291133, "num_env_steps_trained_throughput_per_sec": 236.68924748291133, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 14297.828, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14297.784, "sample_time_ms": 1990.056, "learn_time_ms": 12282.786, "learn_throughput": 325.659, "synch_weights_time_ms": 23.009}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "ef79f_00000", "date": "2024-08-16_11-24-33", "timestamp": 1723787673, "time_this_iter_s": 16.953025102615356, "time_total_s": 450.3481659889221, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321790c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 450.3481659889221, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 71.964, "ram_util_percent": 80.536}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6758016737680586, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.350102484163154, "policy_loss": -0.0046318241498536535, "vf_loss": 9.352899976256033, "vf_explained_var": -0.04029306056638243, "kl": 0.006114433001318224, "entropy": 1.1982667903420787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5897682286444166, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.83860571043832, "policy_loss": -0.0005402491425494196, "vf_loss": 7.837199516145009, "vf_explained_var": 0.03534687410586725, "kl": 0.009732127859536014, "entropy": 0.7307159010064666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 323.13204907559106, "episode_reward_min": -26.518908254084305, "episode_reward_mean": 84.51060006600574, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -207.50220597546573, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.06, "predator_policy": 213.2392124184958}, "policy_reward_mean": {"prey_policy": -22.649958220934906, "predator_policy": 64.90525825393777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [263.53710189587554, 44.33895521892311, 117.8643368687513, 304.4763786943143, 100.41561370931237, 293.76521098383057, 202.48043809802007, 104.0330726916058, 130.33655256538674, 299.90718696199826, 74.41780492425079, 223.9863205721654, 153.85350675174834, 132.22568824763405, 251.98970323058793, 175.36851119570028, 62.52294577612893, 323.13204907559106, 151.97139227446314, 68.48156684479908, 91.71857429611262, 5.155229309595992, 18.41660929230729, 15.33473573606795, 7.939638244570279, 151.4517016319566, -0.26204970721082355, 118.73546821476728, 46.78941371105566, 130.41502548463515, 57.15609167229766, 131.25985360376316, 253.7559146876946, 15.057779494852669, 76.59072421591989, 110.79066270569096, 269.30636579936333, 125.66295472875957, 16.806654085183894, 272.25779496021534, 74.46613120947542, 177.2378382209764, 58.00484869370727, 126.2721381425374, 45.75531168147216, 58.67314021442805, 23.36994222205103, 21.183338396887166, 29.369786803223942, 11.542265782868819, 46.39846848007098, 38.20656474753735, -15.274273229148227, 25.10511710835053, 51.508349373009246, 77.54896428125421, 7.437831948166516, 170.88175130119512, 48.75246500669611, 28.503995782322463, 40.646515150675185, 41.353549775332645, 316.67542642861997, 57.405335033043535, 42.085985400828406, 10.55134331877969, 19.23619701304922, -5.2257865165192126, 35.22748373718877, 32.996051157336105, 20.59172349273313, 124.89324449976341, -1.2703218509290988, 13.746534615975541, 63.505797849295924, 42.88238166010953, 87.94810145192562, -26.518908254084305, 120.68574767217665, 105.11213474552139, 0.2566212341435623, 68.2369948259668, 28.053063761454304, 50.942881595523666, 53.25086757055615, 85.4538514397129, 6.5112366085098525, 55.74001526710171, 56.08007690636944, 77.17605529177084, 21.07997215575549, 43.39170402165555, 10.631544162559788, 50.817025929345355, 12.47391773997277, 21.944852180853033, 45.16461301580509, 61.230450347509546, 45.33757704180263, 16.37069420761562], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [84.29560157059498, 102.18299790631703, -79.83612871027731, -23.931775660812576, 26.039550914394372, 22.519380855335825, 146.99672495099009, 130.38013874790843, 28.838177343416774, -25.05760267452681, 134.98762243272648, 130.26754997172083, 24.285694142166747, 77.6474079204679, 54.4257577994738, 2.0000000000000013, 50.40137583540271, 8.074402337236322, 142.4941529732094, 128.9158364781439, 6.88166668263573, -18.168556674188764, 87.30203044519172, 68.82929068336391, 12.623226437249492, 64.5531918085027, 36.83013985071827, 18.54872001341263, 94.47468260425498, 93.62150210268538, 36.88274587885971, 67.61971690071917, 8.32962122305005, -7.627824532344582, 154.81488941014953, 134.8153109928519, 33.5061434154468, 47.12732902779064, 10.075064145642857, -11.375448952653489, 18.98224166527534, 17.010656425980393, -59.93281882499764, -64.50749602537397, -13.19248710123719, -68.109512243561, -20.450177310810222, -70.792787738713, -77.41431626466661, -50.18835362474239, 68.38435045403378, 12.073086830479792, -78.20612867584411, -72.34768694019648, -66.7578735576237, 94.3974156794765, -88.35315992847575, -32.019395299261, 80.98654041455178, -4.267027336381578, -0.24565664773736126, -51.64956454466821, 38.87502656979371, 4.769436187316397, 76.01978625870382, 122.29123020891937, -32.00756589284663, -38.65273868818877, -11.011623803063387, -3.845640955750749, 41.70463323229242, -2.047695630497531, 154.4152304554184, 50.198689488093514, -3.9437919953848493, 1.9039512152450597, -80.04481626623779, -89.248789936004, 90.44202589921835, 148.23136249255313, 10.703439474710903, -30.588412728771065, 53.34962417649071, 55.60260275212764, -44.782800068346, 6.072600311787617, -0.11163297966772018, 39.085671115900425, -4.0246352120185644, -61.7555602321021, -41.537510583531216, -19.7672778804653, -49.31528287676559, -98.44826841437502, -45.10617303731921, -69.48013451111785, -40.128553652474594, -91.64982221666489, -77.23989866713555, -79.8870618334464, -52.84907022950988, 19.33858506562006, -87.01937992587861, -119.50528074713664, -127.33389265006679, -98.58503496603699, -132.2790906820826, -72.3407879046262, -81.58777691106557, -2.0398806730895913, -51.777297994017644, -46.06652699555851, -64.55592592978421, -54.50839983284867, 9.586175131822655, 67.66325117425664, -111.7412970996261, -55.61291876051537, -45.05690330760664, -79.45957975126676, -20.405978440507145, -41.58000955571915, -66.76554740430129, -27.01287277123212, 194.06, 70.24205978741588, -68.78466146568948, -30.54772721454511, -25.96163096643804, -59.20002187506711, -134.20587606927128, -136.52865866887404, -56.05386001097265, -118.10415161200058, -77.24405166430999, -64.81448253493427, -112.94137428374256, -63.71697882187174, -35.48101457780883, -104.05964458076136, -44.7624525002593, -70.61458327796551, 4.9049628175579425, 50.10471520553958, -108.35752210044845, -55.452085569914495, -60.48621997164383, -83.11222541219152, -88.8804577809632, -39.6853289032198, -55.081577271754576, -34.50467991567133, -13.662496287578678, 5.880203492471589, -81.51553796726819, -70.60026135468503, 27.156330076982517, -3.5417428067250762, 0.900761173148851, 2.694225530995574, -207.50220597546573, -98.5772911111678, -28.934929158957583, -147.54692599336897, -125.90805983826121, -51.77105978969094, -42.13596635134161, -78.60587962040843, -58.15236228429902, -39.804803717138725, -5.545623002763048, 3.4403140598323345, -112.55803692929602, -115.1976551649289, -118.88668931505805, -90.5272550344592, -5.192270902674518, -169.0992367610247, -112.32437573204793, -24.499131116940827, -45.42084237395348, -48.686213681988015, -9.394384052755518, -87.11694178100535, -70.73265800819226, -118.12770132644525, -56.972946580609836, -46.50549994594308, -67.82912061039119, -73.76824238056092, -167.36308462941926, -84.05237840237601, -34.819370849682564, -71.1854313966737, -76.4236283220977, -16.04250182267283, -52.15302487129788, -172.71064011064422, -96.90246039417558, -79.03141814252628], "policy_predator_policy_reward": [51.682552083879656, 25.37595033508379, 37.239492230044796, 110.8673673599682, 49.677713409650465, 19.62769168937066, 11.72007189914177, 15.379443096274004, 60.67542884964403, 35.95961019077842, 16.39410798259488, 12.115930596788344, 72.94331661554261, 27.60401941984282, 32.23165487269309, 15.375660019438437, 44.14957602071457, 27.71119837203307, 16.981462283730696, 11.515735226914241, 32.15761540624244, 53.547079509561456, 35.129264896417155, 32.725734547192644, 59.88745883270138, 16.789629673294773, 22.572539329419637, 54.2742890540834, 38.83795188909511, 25.05556663455244, 33.5912811863404, 37.27476722978099, 12.848964078748107, 48.97218500667531, 17.426953754522625, 16.074894918067024, 35.726087320771285, 35.61183251045428, 46.878110115963864, 22.903841535845903, 42.95552165242062, 12.770154552436173, 54.697805632818955, 74.89773852714866, 70.33095775641445, 29.38765088069106, 89.99852330815047, 16.579177477440897, 41.55352164750797, 93.9887864864713, 35.73008276461475, 35.264181582828236, 79.61712822296155, 70.67463768586829, 77.36391662255986, 13.732009470354628, 88.03074422084673, 79.13122471794584, 20.64402142310395, 33.0514909833609, 44.1551053084039, 64.89620755629923, 61.35502088084053, 26.26036996581263, 31.228906310617386, 24.215991909454168, 10.090955783671662, 75.62712829221638, 60.463616645230054, 30.984372329503994, 51.84014306509585, 19.29358203880016, 35.23935300474592, 29.453092851105456, 35.817228802176075, 91.88556670672327, 90.65480028614537, 95.44546000128028, 33.58440656844389, 0.0, 48.67523984607895, 45.67586461745665, 33.38578331863908, 34.899827973718885, 41.55418614902887, 55.16086230123671, 44.538311708650774, 42.75978829765389, 52.26939809735214, 59.26610902824071, 55.806094385824395, 64.17183429260012, 51.35828660115603, 119.77520691203559, 49.572952557885856, 86.19669338743833, 65.54348835465761, 95.60467431770589, 78.7268510627779, 89.94237522067289, 25.22089450273539, 54.68805914122547, 140.8119332207012, 103.91929219985163, 55.361955615512656, 155.28269877144297, 125.71316064109169, 104.01183505396764, 44.15838200166718, 90.97762495549725, 113.79318148914884, 61.599607781681584, 69.59682670240704, 56.905331008392444, 47.72859894249708, 45.903726052618815, 129.5413454586047, 86.56533540823293, 67.44181615816774, 85.578662683028, 46.47123409093803, 56.16126905596349, 95.57078123912909, 39.56118871173681, 30.227476224695792, 22.14589041650815, 68.49849029514608, 88.239233418132, 62.46453130276541, 64.78310693956809, 138.07772746704555, 143.20815058987935, 123.33142518219177, 70.0627834538306, 38.39960667160029, 98.43314101112477, 127.68452207653289, 84.20131476627024, 83.08168907920901, 89.45502123669749, 61.71926036336601, 74.249498907592, 41.76165533482849, 28.121911141837444, 50.27364814288026, 112.26563767655381, 63.19206720220596, 94.15291279760487, 115.65615153580737, 76.41543299767145, 68.8695055233946, 63.599133324140695, 43.1437339898642, 52.58666025716858, 92.26248901748197, 33.33440205038721, 47.41154951182028, 49.65961089009895, 51.207780830872515, 50.30936721050432, 93.09690590228126, 213.2392124184958, 125.58158658865675, 119.13726338963676, 139.82486602760306, 65.90731736180359, 73.40471535095377, 98.28001221631993, 86.41935331860417, 64.78868025338967, 29.92588628176393, 57.63327410087968, 154.64162810859813, 79.6253005941367, 105.56791474772875, 159.58604486889004, 82.36576608505473, 148.0058184850142, 99.62308460594451, 114.37647753481508, 81.74159884291187, 33.445429368785234, 58.9552651842251, 80.94776467119135, 100.41040945172088, 99.08149404547625, 78.30247157839024, 75.99300087750805, 58.48141815884223, 95.58986257208258, 112.53929137445633, 160.821023838192, 84.09638629672402, 67.07302896543742, 53.549073780471495, 100.14750671180842, 187.5943257732667, 82.60691625047816, 118.93279405952359, 73.37177868479385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6208505634594365, "mean_inference_ms": 1.9009461059496808, "mean_action_processing_ms": 0.27593596588780345, "mean_env_wait_ms": 0.22462239845915863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005663275718688965, "StateBufferConnector_ms": 0.006623029708862305, "ViewRequirementAgentConnector_ms": 0.21256554126739502}, "num_episodes": 22, "episode_return_max": 323.13204907559106, "episode_return_min": -26.518908254084305, "episode_return_mean": 84.51060006600574, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.48150127877454, "num_env_steps_trained_throughput_per_sec": 328.48150127877454, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 14218.56, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14218.519, "sample_time_ms": 2022.472, "learn_time_ms": 12172.593, "learn_throughput": 328.607, "synch_weights_time_ms": 21.713}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "ef79f_00000", "date": "2024-08-16_11-24-46", "timestamp": 1723787686, "time_this_iter_s": 12.18343186378479, "time_total_s": 462.5315978527069, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b85e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 462.5315978527069, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 50.794117647058826, "ram_util_percent": 71.94117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.000976743899956, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.084920153037581, "policy_loss": -0.004051982428972171, "vf_loss": 9.087678055536179, "vf_explained_var": -0.12235707394660465, "kl": 0.004313508270010724, "entropy": 1.2142067728849946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.935085750540728, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.146438402347464, "policy_loss": -0.0051237844980307045, "vf_loss": 8.149866164172137, "vf_explained_var": 0.15127433226222084, "kl": 0.008480075039596, "entropy": 0.6766982891572215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 316.67542642861997, "episode_reward_min": -31.280212470438883, "episode_reward_mean": 57.075744479098056, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -213.31918270323146, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.06, "predator_policy": 233.3968547278797}, "policy_reward_mean": {"prey_policy": -49.31855184892252, "predator_policy": 77.85642408847156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.33473573606795, 7.939638244570279, 151.4517016319566, -0.26204970721082355, 118.73546821476728, 46.78941371105566, 130.41502548463515, 57.15609167229766, 131.25985360376316, 253.7559146876946, 15.057779494852669, 76.59072421591989, 110.79066270569096, 269.30636579936333, 125.66295472875957, 16.806654085183894, 272.25779496021534, 74.46613120947542, 177.2378382209764, 58.00484869370727, 126.2721381425374, 45.75531168147216, 58.67314021442805, 23.36994222205103, 21.183338396887166, 29.369786803223942, 11.542265782868819, 46.39846848007098, 38.20656474753735, -15.274273229148227, 25.10511710835053, 51.508349373009246, 77.54896428125421, 7.437831948166516, 170.88175130119512, 48.75246500669611, 28.503995782322463, 40.646515150675185, 41.353549775332645, 316.67542642861997, 57.405335033043535, 42.085985400828406, 10.55134331877969, 19.23619701304922, -5.2257865165192126, 35.22748373718877, 32.996051157336105, 20.59172349273313, 124.89324449976341, -1.2703218509290988, 13.746534615975541, 63.505797849295924, 42.88238166010953, 87.94810145192562, -26.518908254084305, 120.68574767217665, 105.11213474552139, 0.2566212341435623, 68.2369948259668, 28.053063761454304, 50.942881595523666, 53.25086757055615, 85.4538514397129, 6.5112366085098525, 55.74001526710171, 56.08007690636944, 77.17605529177084, 21.07997215575549, 43.39170402165555, 10.631544162559788, 50.817025929345355, 12.47391773997277, 21.944852180853033, 45.16461301580509, 61.230450347509546, 45.33757704180263, 16.37069420761562, 15.464969547122577, 22.690501400804205, 52.26865853605125, 89.59542488066815, 56.84313566030604, 20.74901231598907, 61.611060038110054, 2.511035090318052, 19.655596718411978, 11.126540094620685, 7.607267350851896, 38.453807593438114, 63.0276897575182, -30.72137623280569, 57.27164332585481, 74.71521214958405, 21.725052793444483, -31.280212470438883, 139.78058624180267, 47.5078526985054, 21.737260766636844, -6.745732811106497, 95.31420534264777], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.450177310810222, -70.792787738713, -77.41431626466661, -50.18835362474239, 68.38435045403378, 12.073086830479792, -78.20612867584411, -72.34768694019648, -66.7578735576237, 94.3974156794765, -88.35315992847575, -32.019395299261, 80.98654041455178, -4.267027336381578, -0.24565664773736126, -51.64956454466821, 38.87502656979371, 4.769436187316397, 76.01978625870382, 122.29123020891937, -32.00756589284663, -38.65273868818877, -11.011623803063387, -3.845640955750749, 41.70463323229242, -2.047695630497531, 154.4152304554184, 50.198689488093514, -3.9437919953848493, 1.9039512152450597, -80.04481626623779, -89.248789936004, 90.44202589921835, 148.23136249255313, 10.703439474710903, -30.588412728771065, 53.34962417649071, 55.60260275212764, -44.782800068346, 6.072600311787617, -0.11163297966772018, 39.085671115900425, -4.0246352120185644, -61.7555602321021, -41.537510583531216, -19.7672778804653, -49.31528287676559, -98.44826841437502, -45.10617303731921, -69.48013451111785, -40.128553652474594, -91.64982221666489, -77.23989866713555, -79.8870618334464, -52.84907022950988, 19.33858506562006, -87.01937992587861, -119.50528074713664, -127.33389265006679, -98.58503496603699, -132.2790906820826, -72.3407879046262, -81.58777691106557, -2.0398806730895913, -51.777297994017644, -46.06652699555851, -64.55592592978421, -54.50839983284867, 9.586175131822655, 67.66325117425664, -111.7412970996261, -55.61291876051537, -45.05690330760664, -79.45957975126676, -20.405978440507145, -41.58000955571915, -66.76554740430129, -27.01287277123212, 194.06, 70.24205978741588, -68.78466146568948, -30.54772721454511, -25.96163096643804, -59.20002187506711, -134.20587606927128, -136.52865866887404, -56.05386001097265, -118.10415161200058, -77.24405166430999, -64.81448253493427, -112.94137428374256, -63.71697882187174, -35.48101457780883, -104.05964458076136, -44.7624525002593, -70.61458327796551, 4.9049628175579425, 50.10471520553958, -108.35752210044845, -55.452085569914495, -60.48621997164383, -83.11222541219152, -88.8804577809632, -39.6853289032198, -55.081577271754576, -34.50467991567133, -13.662496287578678, 5.880203492471589, -81.51553796726819, -70.60026135468503, 27.156330076982517, -3.5417428067250762, 0.900761173148851, 2.694225530995574, -207.50220597546573, -98.5772911111678, -28.934929158957583, -147.54692599336897, -125.90805983826121, -51.77105978969094, -42.13596635134161, -78.60587962040843, -58.15236228429902, -39.804803717138725, -5.545623002763048, 3.4403140598323345, -112.55803692929602, -115.1976551649289, -118.88668931505805, -90.5272550344592, -5.192270902674518, -169.0992367610247, -112.32437573204793, -24.499131116940827, -45.42084237395348, -48.686213681988015, -9.394384052755518, -87.11694178100535, -70.73265800819226, -118.12770132644525, -56.972946580609836, -46.50549994594308, -67.82912061039119, -73.76824238056092, -167.36308462941926, -84.05237840237601, -34.819370849682564, -71.1854313966737, -76.4236283220977, -16.04250182267283, -52.15302487129788, -172.71064011064422, -96.90246039417558, -79.03141814252628, -163.262884818874, -213.31918270323146, -98.69315907076175, -86.50823568215833, -20.0674156276934, -37.327407930096, 18.068080676491256, -55.84623019070257, -169.17162401680616, -44.77731143679786, -27.158850402971442, -83.28261993566616, -107.0928967466944, -21.045225308599235, -115.00689484191129, -107.91869084093311, -147.1308740954558, -105.49085934396999, -70.35949591028955, -72.86730228476993, -140.0239993626446, -92.84766376881905, -31.809225326135508, -56.84782010136427, 8.55793259427619, -64.61751558136524, -105.80072225611451, -101.49184864024014, -94.782879863778, -51.102382100150926, -1.5396366197839546, -46.451600695651486, -84.40013377835467, -51.06187308970089, -63.634017311516885, -147.4449743894877, -65.89252801272781, 74.68482040012468, -58.86676430390815, -55.309720248281764, -27.752227705554223, -72.92967405277341, -117.61119549371475, -119.32127140226225, -69.61281834260048, -31.709015139787788], "policy_predator_policy_reward": [89.99852330815047, 16.579177477440897, 41.55352164750797, 93.9887864864713, 35.73008276461475, 35.264181582828236, 79.61712822296155, 70.67463768586829, 77.36391662255986, 13.732009470354628, 88.03074422084673, 79.13122471794584, 20.64402142310395, 33.0514909833609, 44.1551053084039, 64.89620755629923, 61.35502088084053, 26.26036996581263, 31.228906310617386, 24.215991909454168, 10.090955783671662, 75.62712829221638, 60.463616645230054, 30.984372329503994, 51.84014306509585, 19.29358203880016, 35.23935300474592, 29.453092851105456, 35.817228802176075, 91.88556670672327, 90.65480028614537, 95.44546000128028, 33.58440656844389, 0.0, 48.67523984607895, 45.67586461745665, 33.38578331863908, 34.899827973718885, 41.55418614902887, 55.16086230123671, 44.538311708650774, 42.75978829765389, 52.26939809735214, 59.26610902824071, 55.806094385824395, 64.17183429260012, 51.35828660115603, 119.77520691203559, 49.572952557885856, 86.19669338743833, 65.54348835465761, 95.60467431770589, 78.7268510627779, 89.94237522067289, 25.22089450273539, 54.68805914122547, 140.8119332207012, 103.91929219985163, 55.361955615512656, 155.28269877144297, 125.71316064109169, 104.01183505396764, 44.15838200166718, 90.97762495549725, 113.79318148914884, 61.599607781681584, 69.59682670240704, 56.905331008392444, 47.72859894249708, 45.903726052618815, 129.5413454586047, 86.56533540823293, 67.44181615816774, 85.578662683028, 46.47123409093803, 56.16126905596349, 95.57078123912909, 39.56118871173681, 30.227476224695792, 22.14589041650815, 68.49849029514608, 88.239233418132, 62.46453130276541, 64.78310693956809, 138.07772746704555, 143.20815058987935, 123.33142518219177, 70.0627834538306, 38.39960667160029, 98.43314101112477, 127.68452207653289, 84.20131476627024, 83.08168907920901, 89.45502123669749, 61.71926036336601, 74.249498907592, 41.76165533482849, 28.121911141837444, 50.27364814288026, 112.26563767655381, 63.19206720220596, 94.15291279760487, 115.65615153580737, 76.41543299767145, 68.8695055233946, 63.599133324140695, 43.1437339898642, 52.58666025716858, 92.26248901748197, 33.33440205038721, 47.41154951182028, 49.65961089009895, 51.207780830872515, 50.30936721050432, 93.09690590228126, 213.2392124184958, 125.58158658865675, 119.13726338963676, 139.82486602760306, 65.90731736180359, 73.40471535095377, 98.28001221631993, 86.41935331860417, 64.78868025338967, 29.92588628176393, 57.63327410087968, 154.64162810859813, 79.6253005941367, 105.56791474772875, 159.58604486889004, 82.36576608505473, 148.0058184850142, 99.62308460594451, 114.37647753481508, 81.74159884291187, 33.445429368785234, 58.9552651842251, 80.94776467119135, 100.41040945172088, 99.08149404547625, 78.30247157839024, 75.99300087750805, 58.48141815884223, 95.58986257208258, 112.53929137445633, 160.821023838192, 84.09638629672402, 67.07302896543742, 53.549073780471495, 100.14750671180842, 187.5943257732667, 82.60691625047816, 118.93279405952359, 73.37177868479385, 158.65018234134826, 233.3968547278797, 138.9649092765668, 68.92698687715743, 38.10263166706675, 71.56085042677375, 45.00112678261079, 82.37244761226873, 132.46943758820046, 138.32263352570948, 54.625292628881326, 76.56519002574521, 82.37799756607417, 107.37118452732943, 120.43541673552237, 105.00120403763998, 119.08748807989893, 153.18984207793892, 72.60054308011388, 81.75279520956634, 162.0442846639773, 78.43464581833788, 59.288097733944355, 67.82275528699354, 10.708407207885179, 108.37886553672217, 35.29977760835892, 141.27141705519, 67.96783640060559, 135.1890688891782, 41.04270574317128, 81.66374372184792, 57.94884711342588, 99.23821254807419, 17.589485059619804, 162.2092941709457, 47.128183838461595, 83.86011001594382, 89.47155825470718, 72.21277899598819, 79.34004531808831, 43.079117206876084, 134.18516326898322, 96.00157081588745, 83.05472336733425, 113.58131545770148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6311154353763127, "mean_inference_ms": 1.9306658928347185, "mean_action_processing_ms": 0.27950842040652224, "mean_env_wait_ms": 0.22858977236069133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005722522735595703, "StateBufferConnector_ms": 0.006753444671630859, "ViewRequirementAgentConnector_ms": 0.215484619140625}, "num_episodes": 23, "episode_return_max": 316.67542642861997, "episode_return_min": -31.280212470438883, "episode_return_mean": 57.075744479098056, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.87471337815816, "num_env_steps_trained_throughput_per_sec": 319.87471337815816, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 13483.389, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13483.349, "sample_time_ms": 2005.454, "learn_time_ms": 11455.78, "learn_throughput": 349.169, "synch_weights_time_ms": 21.015}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "ef79f_00000", "date": "2024-08-16_11-24-58", "timestamp": 1723787698, "time_this_iter_s": 12.511271238327026, "time_total_s": 475.04286909103394, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214b5160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 475.04286909103394, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 50.24999999999999, "ram_util_percent": 72.20555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9334201253595804, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.064163714868052, "policy_loss": -0.006494025201117866, "vf_loss": 9.069518427874046, "vf_explained_var": -0.03327549431059096, "kl": 0.00759544736145053, "entropy": 1.1904842238577584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9107950817971004, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.202825853559705, "policy_loss": 0.0009884537602947265, "vf_loss": 8.199808364948899, "vf_explained_var": 0.0659572513015182, "kl": 0.010145199504511931, "entropy": 0.558415474888509, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 316.67542642861997, "episode_reward_min": -31.280212470438883, "episode_reward_mean": 44.243512525562565, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -221.30990251807845, "predator_policy": 10.708407207885179}, "policy_reward_max": {"prey_policy": 194.06, "predator_policy": 233.3968547278797}, "policy_reward_mean": {"prey_policy": -69.52492645925891, "predator_policy": 91.64668272204017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [177.2378382209764, 58.00484869370727, 126.2721381425374, 45.75531168147216, 58.67314021442805, 23.36994222205103, 21.183338396887166, 29.369786803223942, 11.542265782868819, 46.39846848007098, 38.20656474753735, -15.274273229148227, 25.10511710835053, 51.508349373009246, 77.54896428125421, 7.437831948166516, 170.88175130119512, 48.75246500669611, 28.503995782322463, 40.646515150675185, 41.353549775332645, 316.67542642861997, 57.405335033043535, 42.085985400828406, 10.55134331877969, 19.23619701304922, -5.2257865165192126, 35.22748373718877, 32.996051157336105, 20.59172349273313, 124.89324449976341, -1.2703218509290988, 13.746534615975541, 63.505797849295924, 42.88238166010953, 87.94810145192562, -26.518908254084305, 120.68574767217665, 105.11213474552139, 0.2566212341435623, 68.2369948259668, 28.053063761454304, 50.942881595523666, 53.25086757055615, 85.4538514397129, 6.5112366085098525, 55.74001526710171, 56.08007690636944, 77.17605529177084, 21.07997215575549, 43.39170402165555, 10.631544162559788, 50.817025929345355, 12.47391773997277, 21.944852180853033, 45.16461301580509, 61.230450347509546, 45.33757704180263, 16.37069420761562, 15.464969547122577, 22.690501400804205, 52.26865853605125, 89.59542488066815, 56.84313566030604, 20.74901231598907, 61.611060038110054, 2.511035090318052, 19.655596718411978, 11.126540094620685, 7.607267350851896, 38.453807593438114, 63.0276897575182, -30.72137623280569, 57.27164332585481, 74.71521214958405, 21.725052793444483, -31.280212470438883, 139.78058624180267, 47.5078526985054, 21.737260766636844, -6.745732811106497, 95.31420534264777, 58.87651295460229, 5.6948709732169975, 3.679062182672748, -6.299351600036366, 33.716935271788266, 38.86622595722023, 33.49819247815566, 71.86687966422213, 30.31136819681822, 83.07537470075265, -23.033325768537676, 7.004528020285697, 49.22857018342207, 48.55756135508549, 44.55077331834066, 49.090612880673234, 9.573763766395196, 52.03311059043182], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [53.34962417649071, 55.60260275212764, -44.782800068346, 6.072600311787617, -0.11163297966772018, 39.085671115900425, -4.0246352120185644, -61.7555602321021, -41.537510583531216, -19.7672778804653, -49.31528287676559, -98.44826841437502, -45.10617303731921, -69.48013451111785, -40.128553652474594, -91.64982221666489, -77.23989866713555, -79.8870618334464, -52.84907022950988, 19.33858506562006, -87.01937992587861, -119.50528074713664, -127.33389265006679, -98.58503496603699, -132.2790906820826, -72.3407879046262, -81.58777691106557, -2.0398806730895913, -51.777297994017644, -46.06652699555851, -64.55592592978421, -54.50839983284867, 9.586175131822655, 67.66325117425664, -111.7412970996261, -55.61291876051537, -45.05690330760664, -79.45957975126676, -20.405978440507145, -41.58000955571915, -66.76554740430129, -27.01287277123212, 194.06, 70.24205978741588, -68.78466146568948, -30.54772721454511, -25.96163096643804, -59.20002187506711, -134.20587606927128, -136.52865866887404, -56.05386001097265, -118.10415161200058, -77.24405166430999, -64.81448253493427, -112.94137428374256, -63.71697882187174, -35.48101457780883, -104.05964458076136, -44.7624525002593, -70.61458327796551, 4.9049628175579425, 50.10471520553958, -108.35752210044845, -55.452085569914495, -60.48621997164383, -83.11222541219152, -88.8804577809632, -39.6853289032198, -55.081577271754576, -34.50467991567133, -13.662496287578678, 5.880203492471589, -81.51553796726819, -70.60026135468503, 27.156330076982517, -3.5417428067250762, 0.900761173148851, 2.694225530995574, -207.50220597546573, -98.5772911111678, -28.934929158957583, -147.54692599336897, -125.90805983826121, -51.77105978969094, -42.13596635134161, -78.60587962040843, -58.15236228429902, -39.804803717138725, -5.545623002763048, 3.4403140598323345, -112.55803692929602, -115.1976551649289, -118.88668931505805, -90.5272550344592, -5.192270902674518, -169.0992367610247, -112.32437573204793, -24.499131116940827, -45.42084237395348, -48.686213681988015, -9.394384052755518, -87.11694178100535, -70.73265800819226, -118.12770132644525, -56.972946580609836, -46.50549994594308, -67.82912061039119, -73.76824238056092, -167.36308462941926, -84.05237840237601, -34.819370849682564, -71.1854313966737, -76.4236283220977, -16.04250182267283, -52.15302487129788, -172.71064011064422, -96.90246039417558, -79.03141814252628, -163.262884818874, -213.31918270323146, -98.69315907076175, -86.50823568215833, -20.0674156276934, -37.327407930096, 18.068080676491256, -55.84623019070257, -169.17162401680616, -44.77731143679786, -27.158850402971442, -83.28261993566616, -107.0928967466944, -21.045225308599235, -115.00689484191129, -107.91869084093311, -147.1308740954558, -105.49085934396999, -70.35949591028955, -72.86730228476993, -140.0239993626446, -92.84766376881905, -31.809225326135508, -56.84782010136427, 8.55793259427619, -64.61751558136524, -105.80072225611451, -101.49184864024014, -94.782879863778, -51.102382100150926, -1.5396366197839546, -46.451600695651486, -84.40013377835467, -51.06187308970089, -63.634017311516885, -147.4449743894877, -65.89252801272781, 74.68482040012468, -58.86676430390815, -55.309720248281764, -27.752227705554223, -72.92967405277341, -117.61119549371475, -119.32127140226225, -69.61281834260048, -31.709015139787788, -133.40380792752774, -88.13008734714712, -141.77536930345468, -156.6787148039272, -116.29144709035408, -152.20432545365426, -156.06682503085736, -141.77015445788473, -168.58477880761026, -101.2807314440618, -132.7983446295713, -161.23206728163322, -103.22236515847337, -144.19764051685357, -28.472075029355068, -47.527030758998066, -57.17937512410637, -42.282657366251684, -53.49006089154451, -35.44539916633905, -160.032775726509, -221.30990251807845, -151.93868740368072, -78.02063697965751, -134.66020992900462, -6.385908923234867, -91.89159705768375, -207.6520956105442, -31.986111541312763, -69.34336220874684, -113.86081152107815, -96.70227965439284, -135.83489907200894, -135.5470988699859, -75.39587575312838, -77.36641061368356], "policy_predator_policy_reward": [33.38578331863908, 34.899827973718885, 41.55418614902887, 55.16086230123671, 44.538311708650774, 42.75978829765389, 52.26939809735214, 59.26610902824071, 55.806094385824395, 64.17183429260012, 51.35828660115603, 119.77520691203559, 49.572952557885856, 86.19669338743833, 65.54348835465761, 95.60467431770589, 78.7268510627779, 89.94237522067289, 25.22089450273539, 54.68805914122547, 140.8119332207012, 103.91929219985163, 55.361955615512656, 155.28269877144297, 125.71316064109169, 104.01183505396764, 44.15838200166718, 90.97762495549725, 113.79318148914884, 61.599607781681584, 69.59682670240704, 56.905331008392444, 47.72859894249708, 45.903726052618815, 129.5413454586047, 86.56533540823293, 67.44181615816774, 85.578662683028, 46.47123409093803, 56.16126905596349, 95.57078123912909, 39.56118871173681, 30.227476224695792, 22.14589041650815, 68.49849029514608, 88.239233418132, 62.46453130276541, 64.78310693956809, 138.07772746704555, 143.20815058987935, 123.33142518219177, 70.0627834538306, 38.39960667160029, 98.43314101112477, 127.68452207653289, 84.20131476627024, 83.08168907920901, 89.45502123669749, 61.71926036336601, 74.249498907592, 41.76165533482849, 28.121911141837444, 50.27364814288026, 112.26563767655381, 63.19206720220596, 94.15291279760487, 115.65615153580737, 76.41543299767145, 68.8695055233946, 63.599133324140695, 43.1437339898642, 52.58666025716858, 92.26248901748197, 33.33440205038721, 47.41154951182028, 49.65961089009895, 51.207780830872515, 50.30936721050432, 93.09690590228126, 213.2392124184958, 125.58158658865675, 119.13726338963676, 139.82486602760306, 65.90731736180359, 73.40471535095377, 98.28001221631993, 86.41935331860417, 64.78868025338967, 29.92588628176393, 57.63327410087968, 154.64162810859813, 79.6253005941367, 105.56791474772875, 159.58604486889004, 82.36576608505473, 148.0058184850142, 99.62308460594451, 114.37647753481508, 81.74159884291187, 33.445429368785234, 58.9552651842251, 80.94776467119135, 100.41040945172088, 99.08149404547625, 78.30247157839024, 75.99300087750805, 58.48141815884223, 95.58986257208258, 112.53929137445633, 160.821023838192, 84.09638629672402, 67.07302896543742, 53.549073780471495, 100.14750671180842, 187.5943257732667, 82.60691625047816, 118.93279405952359, 73.37177868479385, 158.65018234134826, 233.3968547278797, 138.9649092765668, 68.92698687715743, 38.10263166706675, 71.56085042677375, 45.00112678261079, 82.37244761226873, 132.46943758820046, 138.32263352570948, 54.625292628881326, 76.56519002574521, 82.37799756607417, 107.37118452732943, 120.43541673552237, 105.00120403763998, 119.08748807989893, 153.18984207793892, 72.60054308011388, 81.75279520956634, 162.0442846639773, 78.43464581833788, 59.288097733944355, 67.82275528699354, 10.708407207885179, 108.37886553672217, 35.29977760835892, 141.27141705519, 67.96783640060559, 135.1890688891782, 41.04270574317128, 81.66374372184792, 57.94884711342588, 99.23821254807419, 17.589485059619804, 162.2092941709457, 47.128183838461595, 83.86011001594382, 89.47155825470718, 72.21277899598819, 79.34004531808831, 43.079117206876084, 134.18516326898322, 96.00157081588745, 83.05472336733425, 113.58131545770148, 149.3301041218413, 131.08030410743584, 188.69119330884726, 115.45776177175149, 109.69953918430987, 162.4752955423712, 195.53184418992515, 96.00578369878043, 189.01746671521053, 114.56497880824962, 209.38990773684247, 123.50673013158215, 118.84551975272824, 162.0726784007546, 85.54641078462471, 62.31957466795054, 63.30229391711814, 66.47110677005806, 71.53820271102934, 100.47263204760692, 223.87815519951357, 134.43119727653558, 108.39430796537424, 128.56954443824966, 73.74096802662903, 116.5337210090324, 163.2926867051928, 184.80856731811986, 71.64811793782219, 74.2321291305781, 118.52523898995284, 141.12846506619115, 135.41624483759952, 145.53951687079058, 111.94136516684817, 92.85403179039548]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6381946226701752, "mean_inference_ms": 1.954396498890169, "mean_action_processing_ms": 0.28144543075010964, "mean_env_wait_ms": 0.23222888407019937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00573885440826416, "StateBufferConnector_ms": 0.007835030555725098, "ViewRequirementAgentConnector_ms": 0.2041531801223755}, "num_episodes": 18, "episode_return_max": 316.67542642861997, "episode_return_min": -31.280212470438883, "episode_return_mean": 44.243512525562565, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.3567462493486, "num_env_steps_trained_throughput_per_sec": 300.3567462493486, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 13561.293, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13561.254, "sample_time_ms": 1995.663, "learn_time_ms": 11543.971, "learn_throughput": 346.501, "synch_weights_time_ms": 20.562}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "ef79f_00000", "date": "2024-08-16_11-25-11", "timestamp": 1723787711, "time_this_iter_s": 13.323822975158691, "time_total_s": 488.3666920661926, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32147fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 488.3666920661926, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 53.50000000000001, "ram_util_percent": 73.26842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.956384425503867, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.078687343395575, "policy_loss": -0.002541848191148823, "vf_loss": 9.07996859020657, "vf_explained_var": 0.006964196824522876, "kl": 0.008403926180103697, "entropy": 1.2080687505227548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6839308920360745, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.19616752074509, "policy_loss": -0.00183942689986594, "vf_loss": 8.1954052821669, "vf_explained_var": 0.09275388254059685, "kl": 0.01300834524108049, "entropy": 0.4857570116482084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 316.67542642861997, "episode_reward_min": -31.280212470438883, "episode_reward_mean": 41.660827338236956, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -221.30990251807845, "predator_policy": 10.708407207885179}, "policy_reward_max": {"prey_policy": 194.06, "predator_policy": 233.3968547278797}, "policy_reward_mean": {"prey_policy": -79.36636147073186, "predator_policy": 100.19677513985033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.503995782322463, 40.646515150675185, 41.353549775332645, 316.67542642861997, 57.405335033043535, 42.085985400828406, 10.55134331877969, 19.23619701304922, -5.2257865165192126, 35.22748373718877, 32.996051157336105, 20.59172349273313, 124.89324449976341, -1.2703218509290988, 13.746534615975541, 63.505797849295924, 42.88238166010953, 87.94810145192562, -26.518908254084305, 120.68574767217665, 105.11213474552139, 0.2566212341435623, 68.2369948259668, 28.053063761454304, 50.942881595523666, 53.25086757055615, 85.4538514397129, 6.5112366085098525, 55.74001526710171, 56.08007690636944, 77.17605529177084, 21.07997215575549, 43.39170402165555, 10.631544162559788, 50.817025929345355, 12.47391773997277, 21.944852180853033, 45.16461301580509, 61.230450347509546, 45.33757704180263, 16.37069420761562, 15.464969547122577, 22.690501400804205, 52.26865853605125, 89.59542488066815, 56.84313566030604, 20.74901231598907, 61.611060038110054, 2.511035090318052, 19.655596718411978, 11.126540094620685, 7.607267350851896, 38.453807593438114, 63.0276897575182, -30.72137623280569, 57.27164332585481, 74.71521214958405, 21.725052793444483, -31.280212470438883, 139.78058624180267, 47.5078526985054, 21.737260766636844, -6.745732811106497, 95.31420534264777, 58.87651295460229, 5.6948709732169975, 3.679062182672748, -6.299351600036366, 33.716935271788266, 38.86622595722023, 33.49819247815566, 71.86687966422213, 30.31136819681822, 83.07537470075265, -23.033325768537676, 7.004528020285697, 49.22857018342207, 48.55756135508549, 44.55077331834066, 49.090612880673234, 9.573763766395196, 52.03311059043182, 61.11925874290712, 63.39399244913791, -0.25825213357518506, 17.816900833029877, 63.67675759064732, 44.45412807698507, 35.02197727865702, 17.801908601285874, 11.248719780637115, 35.594084330255754, 107.8832576732502, -11.968606630695731, 53.14464138823918, 31.120437166404837, 43.93549974358307, 44.71855192703225, 86.1968515932324, 38.805222031708254], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-45.05690330760664, -79.45957975126676, -20.405978440507145, -41.58000955571915, -66.76554740430129, -27.01287277123212, 194.06, 70.24205978741588, -68.78466146568948, -30.54772721454511, -25.96163096643804, -59.20002187506711, -134.20587606927128, -136.52865866887404, -56.05386001097265, -118.10415161200058, -77.24405166430999, -64.81448253493427, -112.94137428374256, -63.71697882187174, -35.48101457780883, -104.05964458076136, -44.7624525002593, -70.61458327796551, 4.9049628175579425, 50.10471520553958, -108.35752210044845, -55.452085569914495, -60.48621997164383, -83.11222541219152, -88.8804577809632, -39.6853289032198, -55.081577271754576, -34.50467991567133, -13.662496287578678, 5.880203492471589, -81.51553796726819, -70.60026135468503, 27.156330076982517, -3.5417428067250762, 0.900761173148851, 2.694225530995574, -207.50220597546573, -98.5772911111678, -28.934929158957583, -147.54692599336897, -125.90805983826121, -51.77105978969094, -42.13596635134161, -78.60587962040843, -58.15236228429902, -39.804803717138725, -5.545623002763048, 3.4403140598323345, -112.55803692929602, -115.1976551649289, -118.88668931505805, -90.5272550344592, -5.192270902674518, -169.0992367610247, -112.32437573204793, -24.499131116940827, -45.42084237395348, -48.686213681988015, -9.394384052755518, -87.11694178100535, -70.73265800819226, -118.12770132644525, -56.972946580609836, -46.50549994594308, -67.82912061039119, -73.76824238056092, -167.36308462941926, -84.05237840237601, -34.819370849682564, -71.1854313966737, -76.4236283220977, -16.04250182267283, -52.15302487129788, -172.71064011064422, -96.90246039417558, -79.03141814252628, -163.262884818874, -213.31918270323146, -98.69315907076175, -86.50823568215833, -20.0674156276934, -37.327407930096, 18.068080676491256, -55.84623019070257, -169.17162401680616, -44.77731143679786, -27.158850402971442, -83.28261993566616, -107.0928967466944, -21.045225308599235, -115.00689484191129, -107.91869084093311, -147.1308740954558, -105.49085934396999, -70.35949591028955, -72.86730228476993, -140.0239993626446, -92.84766376881905, -31.809225326135508, -56.84782010136427, 8.55793259427619, -64.61751558136524, -105.80072225611451, -101.49184864024014, -94.782879863778, -51.102382100150926, -1.5396366197839546, -46.451600695651486, -84.40013377835467, -51.06187308970089, -63.634017311516885, -147.4449743894877, -65.89252801272781, 74.68482040012468, -58.86676430390815, -55.309720248281764, -27.752227705554223, -72.92967405277341, -117.61119549371475, -119.32127140226225, -69.61281834260048, -31.709015139787788, -133.40380792752774, -88.13008734714712, -141.77536930345468, -156.6787148039272, -116.29144709035408, -152.20432545365426, -156.06682503085736, -141.77015445788473, -168.58477880761026, -101.2807314440618, -132.7983446295713, -161.23206728163322, -103.22236515847337, -144.19764051685357, -28.472075029355068, -47.527030758998066, -57.17937512410637, -42.282657366251684, -53.49006089154451, -35.44539916633905, -160.032775726509, -221.30990251807845, -151.93868740368072, -78.02063697965751, -134.66020992900462, -6.385908923234867, -91.89159705768375, -207.6520956105442, -31.986111541312763, -69.34336220874684, -113.86081152107815, -96.70227965439284, -135.83489907200894, -135.5470988699859, -75.39587575312838, -77.36641061368356, -25.449165534509017, -30.90037620164201, -70.94064846034551, -11.550770851323671, -186.78666715790072, -118.11734750162105, -126.07991783406409, -129.6282512128427, -112.11359034853939, -109.0346477532048, -131.07995899773888, -77.8894983826161, -97.62773844807822, -151.3637226561515, -102.41988317845582, -101.1829706255455, -115.07354711794716, -96.01946865462928, -62.24823195862167, -100.14910786667737, -1.2013286543085888, -111.45893289639227, -170.50262097332865, -167.2968792411215, -37.66489853929321, -168.60509852549555, -68.499387009927, -43.515882694691534, -77.13781786094286, -58.32139211368899, -79.51036694190566, -176.65041714018753, -139.62554268063914, -45.45346881751157, -183.89107775967605, -113.63504344229398], "policy_predator_policy_reward": [67.44181615816774, 85.578662683028, 46.47123409093803, 56.16126905596349, 95.57078123912909, 39.56118871173681, 30.227476224695792, 22.14589041650815, 68.49849029514608, 88.239233418132, 62.46453130276541, 64.78310693956809, 138.07772746704555, 143.20815058987935, 123.33142518219177, 70.0627834538306, 38.39960667160029, 98.43314101112477, 127.68452207653289, 84.20131476627024, 83.08168907920901, 89.45502123669749, 61.71926036336601, 74.249498907592, 41.76165533482849, 28.121911141837444, 50.27364814288026, 112.26563767655381, 63.19206720220596, 94.15291279760487, 115.65615153580737, 76.41543299767145, 68.8695055233946, 63.599133324140695, 43.1437339898642, 52.58666025716858, 92.26248901748197, 33.33440205038721, 47.41154951182028, 49.65961089009895, 51.207780830872515, 50.30936721050432, 93.09690590228126, 213.2392124184958, 125.58158658865675, 119.13726338963676, 139.82486602760306, 65.90731736180359, 73.40471535095377, 98.28001221631993, 86.41935331860417, 64.78868025338967, 29.92588628176393, 57.63327410087968, 154.64162810859813, 79.6253005941367, 105.56791474772875, 159.58604486889004, 82.36576608505473, 148.0058184850142, 99.62308460594451, 114.37647753481508, 81.74159884291187, 33.445429368785234, 58.9552651842251, 80.94776467119135, 100.41040945172088, 99.08149404547625, 78.30247157839024, 75.99300087750805, 58.48141815884223, 95.58986257208258, 112.53929137445633, 160.821023838192, 84.09638629672402, 67.07302896543742, 53.549073780471495, 100.14750671180842, 187.5943257732667, 82.60691625047816, 118.93279405952359, 73.37177868479385, 158.65018234134826, 233.3968547278797, 138.9649092765668, 68.92698687715743, 38.10263166706675, 71.56085042677375, 45.00112678261079, 82.37244761226873, 132.46943758820046, 138.32263352570948, 54.625292628881326, 76.56519002574521, 82.37799756607417, 107.37118452732943, 120.43541673552237, 105.00120403763998, 119.08748807989893, 153.18984207793892, 72.60054308011388, 81.75279520956634, 162.0442846639773, 78.43464581833788, 59.288097733944355, 67.82275528699354, 10.708407207885179, 108.37886553672217, 35.29977760835892, 141.27141705519, 67.96783640060559, 135.1890688891782, 41.04270574317128, 81.66374372184792, 57.94884711342588, 99.23821254807419, 17.589485059619804, 162.2092941709457, 47.128183838461595, 83.86011001594382, 89.47155825470718, 72.21277899598819, 79.34004531808831, 43.079117206876084, 134.18516326898322, 96.00157081588745, 83.05472336733425, 113.58131545770148, 149.3301041218413, 131.08030410743584, 188.69119330884726, 115.45776177175149, 109.69953918430987, 162.4752955423712, 195.53184418992515, 96.00578369878043, 189.01746671521053, 114.56497880824962, 209.38990773684247, 123.50673013158215, 118.84551975272824, 162.0726784007546, 85.54641078462471, 62.31957466795054, 63.30229391711814, 66.47110677005806, 71.53820271102934, 100.47263204760692, 223.87815519951357, 134.43119727653558, 108.39430796537424, 128.56954443824966, 73.74096802662903, 116.5337210090324, 163.2926867051928, 184.80856731811986, 71.64811793782219, 74.2321291305781, 118.52523898995284, 141.12846506619115, 135.41624483759952, 145.53951687079058, 111.94136516684817, 92.85403179039548, 50.61793257998368, 66.85086789907453, 59.45947520081567, 86.42593655999143, 100.91335094757484, 203.73241157837143, 168.9127503102018, 104.61231956973502, 127.685854607423, 157.13914108496843, 144.41137720645398, 109.01220825088606, 162.90740286137026, 121.10603552151656, 139.5433473791591, 81.86141502612807, 124.33592895899513, 98.00580659421841, 64.49108861381553, 133.50033554173922, 109.5159670378419, 111.02755218610882, 118.15564090129773, 207.6752526824566, 159.82867363464874, 99.58596481837895, 70.27668271779973, 72.8590241532238, 104.06185497000783, 75.33285474820717, 150.197670555926, 150.6816654531998, 158.44483751105258, 112.83102558033056, 216.6733471673644, 119.65799606631369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6457742086741424, "mean_inference_ms": 1.9790308871869733, "mean_action_processing_ms": 0.2837494740936565, "mean_env_wait_ms": 0.23564673330160965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005860686302185059, "StateBufferConnector_ms": 0.007905125617980957, "ViewRequirementAgentConnector_ms": 0.20518577098846436}, "num_episodes": 18, "episode_return_max": 316.67542642861997, "episode_return_min": -31.280212470438883, "episode_return_mean": 41.660827338236956, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.52263596576046, "num_env_steps_trained_throughput_per_sec": 318.52263596576046, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 13479.72, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13479.681, "sample_time_ms": 2020.493, "learn_time_ms": 11438.139, "learn_throughput": 349.707, "synch_weights_time_ms": 19.966}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "ef79f_00000", "date": "2024-08-16_11-25-24", "timestamp": 1723787724, "time_this_iter_s": 12.566105127334595, "time_total_s": 500.9327971935272, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321433c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 500.9327971935272, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 57.98823529411765, "ram_util_percent": 72.71764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3906061278133794, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.884896568772653, "policy_loss": -0.007053325704924723, "vf_loss": 8.890411990786356, "vf_explained_var": 0.058602996288783966, "kl": 0.010252671031286267, "entropy": 1.2611376570015358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.616885985173876, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.543956398585486, "policy_loss": 0.0010262850391131544, "vf_loss": 8.541983706862839, "vf_explained_var": 0.03969294245911654, "kl": 0.0047321945761612, "entropy": 0.4409488628307978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 139.78058624180267, "episode_reward_min": -31.280212470438883, "episode_reward_mean": 37.58570814606299, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -293.27284001054426, "predator_policy": 2.96648840715161}, "policy_reward_max": {"prey_policy": 74.68482040012468, "predator_policy": 291.676514379497}, "policy_reward_mean": {"prey_policy": -92.95834047800639, "predator_policy": 111.75119455103788}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.518908254084305, 120.68574767217665, 105.11213474552139, 0.2566212341435623, 68.2369948259668, 28.053063761454304, 50.942881595523666, 53.25086757055615, 85.4538514397129, 6.5112366085098525, 55.74001526710171, 56.08007690636944, 77.17605529177084, 21.07997215575549, 43.39170402165555, 10.631544162559788, 50.817025929345355, 12.47391773997277, 21.944852180853033, 45.16461301580509, 61.230450347509546, 45.33757704180263, 16.37069420761562, 15.464969547122577, 22.690501400804205, 52.26865853605125, 89.59542488066815, 56.84313566030604, 20.74901231598907, 61.611060038110054, 2.511035090318052, 19.655596718411978, 11.126540094620685, 7.607267350851896, 38.453807593438114, 63.0276897575182, -30.72137623280569, 57.27164332585481, 74.71521214958405, 21.725052793444483, -31.280212470438883, 139.78058624180267, 47.5078526985054, 21.737260766636844, -6.745732811106497, 95.31420534264777, 58.87651295460229, 5.6948709732169975, 3.679062182672748, -6.299351600036366, 33.716935271788266, 38.86622595722023, 33.49819247815566, 71.86687966422213, 30.31136819681822, 83.07537470075265, -23.033325768537676, 7.004528020285697, 49.22857018342207, 48.55756135508549, 44.55077331834066, 49.090612880673234, 9.573763766395196, 52.03311059043182, 61.11925874290712, 63.39399244913791, -0.25825213357518506, 17.816900833029877, 63.67675759064732, 44.45412807698507, 35.02197727865702, 17.801908601285874, 11.248719780637115, 35.594084330255754, 107.8832576732502, -11.968606630695731, 53.14464138823918, 31.120437166404837, 43.93549974358307, 44.71855192703225, 86.1968515932324, 38.805222031708254, 5.5217053611087294, 86.47718161079385, -17.611378512065816, 15.192929487615642, 16.077729239525233, -8.236456627109153, 32.775838119707366, 44.16845051697586, -22.768178303445847, 40.46262469084254, 45.399283798863095, 44.93405315608146, 80.33736442159567, 31.917616276573312, 1.1401331592745911, 71.12556157213723, 52.98972265673156, 44.337458156929806], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-81.51553796726819, -70.60026135468503, 27.156330076982517, -3.5417428067250762, 0.900761173148851, 2.694225530995574, -207.50220597546573, -98.5772911111678, -28.934929158957583, -147.54692599336897, -125.90805983826121, -51.77105978969094, -42.13596635134161, -78.60587962040843, -58.15236228429902, -39.804803717138725, -5.545623002763048, 3.4403140598323345, -112.55803692929602, -115.1976551649289, -118.88668931505805, -90.5272550344592, -5.192270902674518, -169.0992367610247, -112.32437573204793, -24.499131116940827, -45.42084237395348, -48.686213681988015, -9.394384052755518, -87.11694178100535, -70.73265800819226, -118.12770132644525, -56.972946580609836, -46.50549994594308, -67.82912061039119, -73.76824238056092, -167.36308462941926, -84.05237840237601, -34.819370849682564, -71.1854313966737, -76.4236283220977, -16.04250182267283, -52.15302487129788, -172.71064011064422, -96.90246039417558, -79.03141814252628, -163.262884818874, -213.31918270323146, -98.69315907076175, -86.50823568215833, -20.0674156276934, -37.327407930096, 18.068080676491256, -55.84623019070257, -169.17162401680616, -44.77731143679786, -27.158850402971442, -83.28261993566616, -107.0928967466944, -21.045225308599235, -115.00689484191129, -107.91869084093311, -147.1308740954558, -105.49085934396999, -70.35949591028955, -72.86730228476993, -140.0239993626446, -92.84766376881905, -31.809225326135508, -56.84782010136427, 8.55793259427619, -64.61751558136524, -105.80072225611451, -101.49184864024014, -94.782879863778, -51.102382100150926, -1.5396366197839546, -46.451600695651486, -84.40013377835467, -51.06187308970089, -63.634017311516885, -147.4449743894877, -65.89252801272781, 74.68482040012468, -58.86676430390815, -55.309720248281764, -27.752227705554223, -72.92967405277341, -117.61119549371475, -119.32127140226225, -69.61281834260048, -31.709015139787788, -133.40380792752774, -88.13008734714712, -141.77536930345468, -156.6787148039272, -116.29144709035408, -152.20432545365426, -156.06682503085736, -141.77015445788473, -168.58477880761026, -101.2807314440618, -132.7983446295713, -161.23206728163322, -103.22236515847337, -144.19764051685357, -28.472075029355068, -47.527030758998066, -57.17937512410637, -42.282657366251684, -53.49006089154451, -35.44539916633905, -160.032775726509, -221.30990251807845, -151.93868740368072, -78.02063697965751, -134.66020992900462, -6.385908923234867, -91.89159705768375, -207.6520956105442, -31.986111541312763, -69.34336220874684, -113.86081152107815, -96.70227965439284, -135.83489907200894, -135.5470988699859, -75.39587575312838, -77.36641061368356, -25.449165534509017, -30.90037620164201, -70.94064846034551, -11.550770851323671, -186.78666715790072, -118.11734750162105, -126.07991783406409, -129.6282512128427, -112.11359034853939, -109.0346477532048, -131.07995899773888, -77.8894983826161, -97.62773844807822, -151.3637226561515, -102.41988317845582, -101.1829706255455, -115.07354711794716, -96.01946865462928, -62.24823195862167, -100.14910786667737, -1.2013286543085888, -111.45893289639227, -170.50262097332865, -167.2968792411215, -37.66489853929321, -168.60509852549555, -68.499387009927, -43.515882694691534, -77.13781786094286, -58.32139211368899, -79.51036694190566, -176.65041714018753, -139.62554268063914, -45.45346881751157, -183.89107775967605, -113.63504344229398, -198.53422980190936, -189.29170439995303, 17.840000000000003, -102.2260566756641, -124.26804322029139, -107.82348180938531, -197.0127110226231, -172.92020219712145, -102.38025594715131, -139.94782777881372, -104.53202276587852, -100.82343872946583, -98.50417681341435, -132.12566837187066, -209.21299080147418, -104.09360151704283, -49.511203149252864, -30.382320263830582, -96.10215721047864, -135.0545949158724, -157.0859184424379, -142.57378321832243, -155.6363284525728, -17.656198170617174, -83.36165401659693, -3.434445539241632, -109.00667101010441, -108.94741367528452, -132.68778514756067, -73.8184227414328, -293.27284001054426, -99.7524404240366, -119.80103367233286, -170.24934808124084, -192.46056240300126, -179.07698232362998], "policy_predator_policy_reward": [92.26248901748197, 33.33440205038721, 47.41154951182028, 49.65961089009895, 51.207780830872515, 50.30936721050432, 93.09690590228126, 213.2392124184958, 125.58158658865675, 119.13726338963676, 139.82486602760306, 65.90731736180359, 73.40471535095377, 98.28001221631993, 86.41935331860417, 64.78868025338967, 29.92588628176393, 57.63327410087968, 154.64162810859813, 79.6253005941367, 105.56791474772875, 159.58604486889004, 82.36576608505473, 148.0058184850142, 99.62308460594451, 114.37647753481508, 81.74159884291187, 33.445429368785234, 58.9552651842251, 80.94776467119135, 100.41040945172088, 99.08149404547625, 78.30247157839024, 75.99300087750805, 58.48141815884223, 95.58986257208258, 112.53929137445633, 160.821023838192, 84.09638629672402, 67.07302896543742, 53.549073780471495, 100.14750671180842, 187.5943257732667, 82.60691625047816, 118.93279405952359, 73.37177868479385, 158.65018234134826, 233.3968547278797, 138.9649092765668, 68.92698687715743, 38.10263166706675, 71.56085042677375, 45.00112678261079, 82.37244761226873, 132.46943758820046, 138.32263352570948, 54.625292628881326, 76.56519002574521, 82.37799756607417, 107.37118452732943, 120.43541673552237, 105.00120403763998, 119.08748807989893, 153.18984207793892, 72.60054308011388, 81.75279520956634, 162.0442846639773, 78.43464581833788, 59.288097733944355, 67.82275528699354, 10.708407207885179, 108.37886553672217, 35.29977760835892, 141.27141705519, 67.96783640060559, 135.1890688891782, 41.04270574317128, 81.66374372184792, 57.94884711342588, 99.23821254807419, 17.589485059619804, 162.2092941709457, 47.128183838461595, 83.86011001594382, 89.47155825470718, 72.21277899598819, 79.34004531808831, 43.079117206876084, 134.18516326898322, 96.00157081588745, 83.05472336733425, 113.58131545770148, 149.3301041218413, 131.08030410743584, 188.69119330884726, 115.45776177175149, 109.69953918430987, 162.4752955423712, 195.53184418992515, 96.00578369878043, 189.01746671521053, 114.56497880824962, 209.38990773684247, 123.50673013158215, 118.84551975272824, 162.0726784007546, 85.54641078462471, 62.31957466795054, 63.30229391711814, 66.47110677005806, 71.53820271102934, 100.47263204760692, 223.87815519951357, 134.43119727653558, 108.39430796537424, 128.56954443824966, 73.74096802662903, 116.5337210090324, 163.2926867051928, 184.80856731811986, 71.64811793782219, 74.2321291305781, 118.52523898995284, 141.12846506619115, 135.41624483759952, 145.53951687079058, 111.94136516684817, 92.85403179039548, 50.61793257998368, 66.85086789907453, 59.45947520081567, 86.42593655999143, 100.91335094757484, 203.73241157837143, 168.9127503102018, 104.61231956973502, 127.685854607423, 157.13914108496843, 144.41137720645398, 109.01220825088606, 162.90740286137026, 121.10603552151656, 139.5433473791591, 81.86141502612807, 124.33592895899513, 98.00580659421841, 64.49108861381553, 133.50033554173922, 109.5159670378419, 111.02755218610882, 118.15564090129773, 207.6752526824566, 159.82867363464874, 99.58596481837895, 70.27668271779973, 72.8590241532238, 104.06185497000783, 75.33285474820717, 150.197670555926, 150.6816654531998, 158.44483751105258, 112.83102558033056, 216.6733471673644, 119.65799606631369, 218.35449730039798, 174.9931422625732, 70.48994919311282, 100.37328909334522, 85.33430603044198, 129.14584048716893, 183.17628756043487, 201.94955514692523, 160.48529414316795, 97.92051882232228, 95.98024252699861, 101.13876234123676, 137.25470528581937, 126.1509780191728, 177.43419701211403, 180.04084582337865, 2.96648840715161, 54.1588567024858, 126.82425239550462, 144.79512442168905, 150.9940384496529, 194.06494700997058, 136.10123448364578, 82.12534529562593, 80.84102772380233, 86.29243625363173, 127.56297065324142, 122.30873030872056, 59.028732206029545, 148.61760884223847, 291.676514379497, 172.4743276272211, 142.894167644159, 200.14593676614638, 194.84706488519942, 221.0279379983618]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6483040390213709, "mean_inference_ms": 1.9909442352034028, "mean_action_processing_ms": 0.28449357177474294, "mean_env_wait_ms": 0.2373949882102906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004767417907714844, "StateBufferConnector_ms": 0.005300045013427734, "ViewRequirementAgentConnector_ms": 0.1496565341949463}, "num_episodes": 18, "episode_return_max": 139.78058624180267, "episode_return_min": -31.280212470438883, "episode_return_mean": 37.58570814606299, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.36004529426629, "num_env_steps_trained_throughput_per_sec": 251.36004529426629, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 13792.988, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13792.949, "sample_time_ms": 2008.329, "learn_time_ms": 11763.755, "learn_throughput": 340.027, "synch_weights_time_ms": 19.432}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "ef79f_00000", "date": "2024-08-16_11-25-40", "timestamp": 1723787740, "time_this_iter_s": 15.967213869094849, "time_total_s": 516.9000110626221, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32147f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 516.9000110626221, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 80.71304347826087, "ram_util_percent": 77.6695652173913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.701996735258708, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.13426290416213, "policy_loss": -0.008545321811029993, "vf_loss": 8.140894008818126, "vf_explained_var": 0.20625390766789672, "kl": 0.012761260068998833, "entropy": 1.281785813525871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.445109818410621, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.058127475667883, "policy_loss": -0.002371478613549794, "vf_loss": 8.059980138647493, "vf_explained_var": 0.20736045547263332, "kl": 0.0051881136468750096, "entropy": 0.4406926325073949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 139.78058624180267, "episode_reward_min": -31.280212470438883, "episode_reward_mean": 37.37227853941534, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -293.27284001054426, "predator_policy": 2.96648840715161}, "policy_reward_max": {"prey_policy": 74.68482040012468, "predator_policy": 291.676514379497}, "policy_reward_mean": {"prey_policy": -101.1605244497502, "predator_policy": 119.84666371945782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.37069420761562, 15.464969547122577, 22.690501400804205, 52.26865853605125, 89.59542488066815, 56.84313566030604, 20.74901231598907, 61.611060038110054, 2.511035090318052, 19.655596718411978, 11.126540094620685, 7.607267350851896, 38.453807593438114, 63.0276897575182, -30.72137623280569, 57.27164332585481, 74.71521214958405, 21.725052793444483, -31.280212470438883, 139.78058624180267, 47.5078526985054, 21.737260766636844, -6.745732811106497, 95.31420534264777, 58.87651295460229, 5.6948709732169975, 3.679062182672748, -6.299351600036366, 33.716935271788266, 38.86622595722023, 33.49819247815566, 71.86687966422213, 30.31136819681822, 83.07537470075265, -23.033325768537676, 7.004528020285697, 49.22857018342207, 48.55756135508549, 44.55077331834066, 49.090612880673234, 9.573763766395196, 52.03311059043182, 61.11925874290712, 63.39399244913791, -0.25825213357518506, 17.816900833029877, 63.67675759064732, 44.45412807698507, 35.02197727865702, 17.801908601285874, 11.248719780637115, 35.594084330255754, 107.8832576732502, -11.968606630695731, 53.14464138823918, 31.120437166404837, 43.93549974358307, 44.71855192703225, 86.1968515932324, 38.805222031708254, 5.5217053611087294, 86.47718161079385, -17.611378512065816, 15.192929487615642, 16.077729239525233, -8.236456627109153, 32.775838119707366, 44.16845051697586, -22.768178303445847, 40.46262469084254, 45.399283798863095, 44.93405315608146, 80.33736442159567, 31.917616276573312, 1.1401331592745911, 71.12556157213723, 52.98972265673156, 44.337458156929806, 5.605363495631142, 73.16993637242524, 5.7684267649175105, -15.329752101016538, -12.526911188084037, 85.10966260520334, 35.57201194554846, 131.20925745143546, 91.5020329134682, 24.802548309540185, 36.50323617355842, 102.70348962700136, 83.98012703936716, -18.97590696967267, 86.70074223224316, 62.81453636320673, -10.529248039555524, 54.2729742946105, 62.05716727165232, 29.936993510014346, 0.5214188793278414, 56.84122764439386], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-96.90246039417558, -79.03141814252628, -163.262884818874, -213.31918270323146, -98.69315907076175, -86.50823568215833, -20.0674156276934, -37.327407930096, 18.068080676491256, -55.84623019070257, -169.17162401680616, -44.77731143679786, -27.158850402971442, -83.28261993566616, -107.0928967466944, -21.045225308599235, -115.00689484191129, -107.91869084093311, -147.1308740954558, -105.49085934396999, -70.35949591028955, -72.86730228476993, -140.0239993626446, -92.84766376881905, -31.809225326135508, -56.84782010136427, 8.55793259427619, -64.61751558136524, -105.80072225611451, -101.49184864024014, -94.782879863778, -51.102382100150926, -1.5396366197839546, -46.451600695651486, -84.40013377835467, -51.06187308970089, -63.634017311516885, -147.4449743894877, -65.89252801272781, 74.68482040012468, -58.86676430390815, -55.309720248281764, -27.752227705554223, -72.92967405277341, -117.61119549371475, -119.32127140226225, -69.61281834260048, -31.709015139787788, -133.40380792752774, -88.13008734714712, -141.77536930345468, -156.6787148039272, -116.29144709035408, -152.20432545365426, -156.06682503085736, -141.77015445788473, -168.58477880761026, -101.2807314440618, -132.7983446295713, -161.23206728163322, -103.22236515847337, -144.19764051685357, -28.472075029355068, -47.527030758998066, -57.17937512410637, -42.282657366251684, -53.49006089154451, -35.44539916633905, -160.032775726509, -221.30990251807845, -151.93868740368072, -78.02063697965751, -134.66020992900462, -6.385908923234867, -91.89159705768375, -207.6520956105442, -31.986111541312763, -69.34336220874684, -113.86081152107815, -96.70227965439284, -135.83489907200894, -135.5470988699859, -75.39587575312838, -77.36641061368356, -25.449165534509017, -30.90037620164201, -70.94064846034551, -11.550770851323671, -186.78666715790072, -118.11734750162105, -126.07991783406409, -129.6282512128427, -112.11359034853939, -109.0346477532048, -131.07995899773888, -77.8894983826161, -97.62773844807822, -151.3637226561515, -102.41988317845582, -101.1829706255455, -115.07354711794716, -96.01946865462928, -62.24823195862167, -100.14910786667737, -1.2013286543085888, -111.45893289639227, -170.50262097332865, -167.2968792411215, -37.66489853929321, -168.60509852549555, -68.499387009927, -43.515882694691534, -77.13781786094286, -58.32139211368899, -79.51036694190566, -176.65041714018753, -139.62554268063914, -45.45346881751157, -183.89107775967605, -113.63504344229398, -198.53422980190936, -189.29170439995303, 17.840000000000003, -102.2260566756641, -124.26804322029139, -107.82348180938531, -197.0127110226231, -172.92020219712145, -102.38025594715131, -139.94782777881372, -104.53202276587852, -100.82343872946583, -98.50417681341435, -132.12566837187066, -209.21299080147418, -104.09360151704283, -49.511203149252864, -30.382320263830582, -96.10215721047864, -135.0545949158724, -157.0859184424379, -142.57378321832243, -155.6363284525728, -17.656198170617174, -83.36165401659693, -3.434445539241632, -109.00667101010441, -108.94741367528452, -132.68778514756067, -73.8184227414328, -293.27284001054426, -99.7524404240366, -119.80103367233286, -170.24934808124084, -192.46056240300126, -179.07698232362998, -183.39825140869547, -131.76800115412001, -42.66728694436697, 1.572641893972733, -87.8260999162297, -95.36345482492035, -136.82374203989193, -205.17911559372018, -124.3876564747055, -94.03958800824297, -200.7691433972292, -85.45339741669936, -258.5235366545109, -164.0584653727144, -31.666714007522792, 17.01080948248489, -153.01236200432396, -23.207790767657595, -91.795432241885, -172.63231090379642, -83.1693099137764, -82.88153718398274, -91.0695316531813, 2.0000000000000013, -4.852874489121727, -120.10798419614511, -185.81123003357072, -137.4712819474497, -37.96300214577934, -120.71973057477089, -120.20889363899573, -75.24483645191329, -128.21582436149455, -249.51896225706238, -64.18817924556497, -33.813450522898485, -82.72437130257681, -107.38094490443596, -126.95024956227488, -194.125804465341, -148.35345631650873, -121.94851655285481, -19.44526412325091, -95.8229409847568], "policy_predator_policy_reward": [118.93279405952359, 73.37177868479385, 158.65018234134826, 233.3968547278797, 138.9649092765668, 68.92698687715743, 38.10263166706675, 71.56085042677375, 45.00112678261079, 82.37244761226873, 132.46943758820046, 138.32263352570948, 54.625292628881326, 76.56519002574521, 82.37799756607417, 107.37118452732943, 120.43541673552237, 105.00120403763998, 119.08748807989893, 153.18984207793892, 72.60054308011388, 81.75279520956634, 162.0442846639773, 78.43464581833788, 59.288097733944355, 67.82275528699354, 10.708407207885179, 108.37886553672217, 35.29977760835892, 141.27141705519, 67.96783640060559, 135.1890688891782, 41.04270574317128, 81.66374372184792, 57.94884711342588, 99.23821254807419, 17.589485059619804, 162.2092941709457, 47.128183838461595, 83.86011001594382, 89.47155825470718, 72.21277899598819, 79.34004531808831, 43.079117206876084, 134.18516326898322, 96.00157081588745, 83.05472336733425, 113.58131545770148, 149.3301041218413, 131.08030410743584, 188.69119330884726, 115.45776177175149, 109.69953918430987, 162.4752955423712, 195.53184418992515, 96.00578369878043, 189.01746671521053, 114.56497880824962, 209.38990773684247, 123.50673013158215, 118.84551975272824, 162.0726784007546, 85.54641078462471, 62.31957466795054, 63.30229391711814, 66.47110677005806, 71.53820271102934, 100.47263204760692, 223.87815519951357, 134.43119727653558, 108.39430796537424, 128.56954443824966, 73.74096802662903, 116.5337210090324, 163.2926867051928, 184.80856731811986, 71.64811793782219, 74.2321291305781, 118.52523898995284, 141.12846506619115, 135.41624483759952, 145.53951687079058, 111.94136516684817, 92.85403179039548, 50.61793257998368, 66.85086789907453, 59.45947520081567, 86.42593655999143, 100.91335094757484, 203.73241157837143, 168.9127503102018, 104.61231956973502, 127.685854607423, 157.13914108496843, 144.41137720645398, 109.01220825088606, 162.90740286137026, 121.10603552151656, 139.5433473791591, 81.86141502612807, 124.33592895899513, 98.00580659421841, 64.49108861381553, 133.50033554173922, 109.5159670378419, 111.02755218610882, 118.15564090129773, 207.6752526824566, 159.82867363464874, 99.58596481837895, 70.27668271779973, 72.8590241532238, 104.06185497000783, 75.33285474820717, 150.197670555926, 150.6816654531998, 158.44483751105258, 112.83102558033056, 216.6733471673644, 119.65799606631369, 218.35449730039798, 174.9931422625732, 70.48994919311282, 100.37328909334522, 85.33430603044198, 129.14584048716893, 183.17628756043487, 201.94955514692523, 160.48529414316795, 97.92051882232228, 95.98024252699861, 101.13876234123676, 137.25470528581937, 126.1509780191728, 177.43419701211403, 180.04084582337865, 2.96648840715161, 54.1588567024858, 126.82425239550462, 144.79512442168905, 150.9940384496529, 194.06494700997058, 136.10123448364578, 82.12534529562593, 80.84102772380233, 86.29243625363173, 127.56297065324142, 122.30873030872056, 59.028732206029545, 148.61760884223847, 291.676514379497, 172.4743276272211, 142.894167644159, 200.14593676614638, 194.84706488519942, 221.0279379983618, 178.92520977445344, 141.84640628399305, 38.32957085000404, 75.93501057281543, 98.58733017545937, 90.37065133060835, 146.1763855728368, 180.49671995975828, 163.9298940759929, 41.97043921887168, 213.86002185280262, 157.47218156632925, 174.615313672264, 283.5387003005098, 58.82999193585468, 87.03517004061912, 157.08194588699072, 110.64023979845872, 117.84725621455927, 171.3830352406621, 65.35703046233961, 137.19705280897787, 109.3208811402574, 82.45214013992468, 107.28311074939467, 101.65787497523915, 207.53524985367523, 96.77135515767267, 122.53640379618923, 122.8470711566043, 96.2243527657082, 162.0439136884075, 209.22832100047586, 157.9772175785259, 62.4715359599166, 89.80306810315727, 137.96458263972272, 114.19790083894213, 203.403450823033, 147.6095967145975, 94.93545650033093, 175.88793524836035, 82.81608187705616, 89.29335087534568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6503699872296355, "mean_inference_ms": 2.001803504708638, "mean_action_processing_ms": 0.2851412234802936, "mean_env_wait_ms": 0.23889733839584543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004783511161804199, "StateBufferConnector_ms": 0.005394458770751953, "ViewRequirementAgentConnector_ms": 0.12999224662780762}, "num_episodes": 22, "episode_return_max": 139.78058624180267, "episode_return_min": -31.280212470438883, "episode_return_mean": 37.37227853941534, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.80630044893803, "num_env_steps_trained_throughput_per_sec": 330.80630044893803, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 13789.487, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13789.448, "sample_time_ms": 2018.733, "learn_time_ms": 11749.683, "learn_throughput": 340.435, "synch_weights_time_ms": 19.66}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "ef79f_00000", "date": "2024-08-16_11-25-52", "timestamp": 1723787752, "time_this_iter_s": 12.097538948059082, "time_total_s": 528.9975500106812, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32147f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 528.9975500106812, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 51.382352941176464, "ram_util_percent": 81.65882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6139627625071813, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.555366133129786, "policy_loss": -0.010378914757843607, "vf_loss": 6.563841610106211, "vf_explained_var": 0.2709788283658406, "kl": 0.012689468498788974, "entropy": 1.2971033455833556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.389589027122215, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.272436501740147, "policy_loss": -0.0018604671269674938, "vf_loss": 8.27393646845742, "vf_explained_var": 0.08733781254480756, "kl": 0.0036050157667565923, "entropy": 0.39815134536967706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 139.80033983746222, "episode_reward_min": -23.033325768537676, "episode_reward_mean": 45.86991209897061, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -293.27284001054426, "predator_policy": 1.059603887919116}, "policy_reward_max": {"prey_policy": 17.840000000000003, "predator_policy": 291.676514379497}, "policy_reward_mean": {"prey_policy": -101.83922452134121, "predator_policy": 124.77418057082649}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.31420534264777, 58.87651295460229, 5.6948709732169975, 3.679062182672748, -6.299351600036366, 33.716935271788266, 38.86622595722023, 33.49819247815566, 71.86687966422213, 30.31136819681822, 83.07537470075265, -23.033325768537676, 7.004528020285697, 49.22857018342207, 48.55756135508549, 44.55077331834066, 49.090612880673234, 9.573763766395196, 52.03311059043182, 61.11925874290712, 63.39399244913791, -0.25825213357518506, 17.816900833029877, 63.67675759064732, 44.45412807698507, 35.02197727865702, 17.801908601285874, 11.248719780637115, 35.594084330255754, 107.8832576732502, -11.968606630695731, 53.14464138823918, 31.120437166404837, 43.93549974358307, 44.71855192703225, 86.1968515932324, 38.805222031708254, 5.5217053611087294, 86.47718161079385, -17.611378512065816, 15.192929487615642, 16.077729239525233, -8.236456627109153, 32.775838119707366, 44.16845051697586, -22.768178303445847, 40.46262469084254, 45.399283798863095, 44.93405315608146, 80.33736442159567, 31.917616276573312, 1.1401331592745911, 71.12556157213723, 52.98972265673156, 44.337458156929806, 5.605363495631142, 73.16993637242524, 5.7684267649175105, -15.329752101016538, -12.526911188084037, 85.10966260520334, 35.57201194554846, 131.20925745143546, 91.5020329134682, 24.802548309540185, 36.50323617355842, 102.70348962700136, 83.98012703936716, -18.97590696967267, 86.70074223224316, 62.81453636320673, -10.529248039555524, 54.2729742946105, 62.05716727165232, 29.936993510014346, 0.5214188793278414, 56.84122764439386, 88.3329802192571, -9.392866963818907, 71.00587639144454, 135.42708562130213, 71.15026460153132, 90.76802647202689, 69.29009191094333, 58.572909026757856, 83.84185566844269, 102.84627708207962, 44.69092500236136, 18.60709544453115, 52.19194345756585, 134.15821438822053, 39.8417730146328, 52.334090734119755, 139.80033983746222, 102.42257588369185, 1.4659744202388238, 80.68040915198813, 14.296324099746553, 88.24378563359382, 91.15308451070976], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-69.61281834260048, -31.709015139787788, -133.40380792752774, -88.13008734714712, -141.77536930345468, -156.6787148039272, -116.29144709035408, -152.20432545365426, -156.06682503085736, -141.77015445788473, -168.58477880761026, -101.2807314440618, -132.7983446295713, -161.23206728163322, -103.22236515847337, -144.19764051685357, -28.472075029355068, -47.527030758998066, -57.17937512410637, -42.282657366251684, -53.49006089154451, -35.44539916633905, -160.032775726509, -221.30990251807845, -151.93868740368072, -78.02063697965751, -134.66020992900462, -6.385908923234867, -91.89159705768375, -207.6520956105442, -31.986111541312763, -69.34336220874684, -113.86081152107815, -96.70227965439284, -135.83489907200894, -135.5470988699859, -75.39587575312838, -77.36641061368356, -25.449165534509017, -30.90037620164201, -70.94064846034551, -11.550770851323671, -186.78666715790072, -118.11734750162105, -126.07991783406409, -129.6282512128427, -112.11359034853939, -109.0346477532048, -131.07995899773888, -77.8894983826161, -97.62773844807822, -151.3637226561515, -102.41988317845582, -101.1829706255455, -115.07354711794716, -96.01946865462928, -62.24823195862167, -100.14910786667737, -1.2013286543085888, -111.45893289639227, -170.50262097332865, -167.2968792411215, -37.66489853929321, -168.60509852549555, -68.499387009927, -43.515882694691534, -77.13781786094286, -58.32139211368899, -79.51036694190566, -176.65041714018753, -139.62554268063914, -45.45346881751157, -183.89107775967605, -113.63504344229398, -198.53422980190936, -189.29170439995303, 17.840000000000003, -102.2260566756641, -124.26804322029139, -107.82348180938531, -197.0127110226231, -172.92020219712145, -102.38025594715131, -139.94782777881372, -104.53202276587852, -100.82343872946583, -98.50417681341435, -132.12566837187066, -209.21299080147418, -104.09360151704283, -49.511203149252864, -30.382320263830582, -96.10215721047864, -135.0545949158724, -157.0859184424379, -142.57378321832243, -155.6363284525728, -17.656198170617174, -83.36165401659693, -3.434445539241632, -109.00667101010441, -108.94741367528452, -132.68778514756067, -73.8184227414328, -293.27284001054426, -99.7524404240366, -119.80103367233286, -170.24934808124084, -192.46056240300126, -179.07698232362998, -183.39825140869547, -131.76800115412001, -42.66728694436697, 1.572641893972733, -87.8260999162297, -95.36345482492035, -136.82374203989193, -205.17911559372018, -124.3876564747055, -94.03958800824297, -200.7691433972292, -85.45339741669936, -258.5235366545109, -164.0584653727144, -31.666714007522792, 17.01080948248489, -153.01236200432396, -23.207790767657595, -91.795432241885, -172.63231090379642, -83.1693099137764, -82.88153718398274, -91.0695316531813, 2.0000000000000013, -4.852874489121727, -120.10798419614511, -185.81123003357072, -137.4712819474497, -37.96300214577934, -120.71973057477089, -120.20889363899573, -75.24483645191329, -128.21582436149455, -249.51896225706238, -64.18817924556497, -33.813450522898485, -82.72437130257681, -107.38094490443596, -126.95024956227488, -194.125804465341, -148.35345631650873, -121.94851655285481, -19.44526412325091, -95.8229409847568, 14.454175200530843, 2.836532977481218, -24.068714575639326, -15.89457551738077, -7.707263450598317, -96.92346433306855, -77.43204077751867, -68.11714261041297, -74.66681493799337, -85.80475090363608, -168.47954610615912, -92.89953564734282, -60.30373872504336, 0.6305321639701403, -46.24793819427044, -156.29751126019545, -267.6016459049109, 1.791159932473403, -150.66030164391654, -18.117419639161607, -107.656045996326, -58.24761472938309, -111.9078438892311, -141.07996327568682, -15.299168038151892, -110.47010895030232, -121.84100262633137, -59.04063366413622, -121.94224395524508, -142.43097623002888, -109.86364637861911, -6.996568960632022, -214.27351782867535, -97.31374995933558, -178.95002341201507, -44.19172446831839, -7.409330626898157, -8.094030387851253, -94.38894422560442, -11.961426193494482, -82.8465486788227, -118.07963319681357, -97.805286579919, -47.58193352813411, -96.44495275985237, -10.60297198412261], "policy_predator_policy_reward": [83.05472336733425, 113.58131545770148, 149.3301041218413, 131.08030410743584, 188.69119330884726, 115.45776177175149, 109.69953918430987, 162.4752955423712, 195.53184418992515, 96.00578369878043, 189.01746671521053, 114.56497880824962, 209.38990773684247, 123.50673013158215, 118.84551975272824, 162.0726784007546, 85.54641078462471, 62.31957466795054, 63.30229391711814, 66.47110677005806, 71.53820271102934, 100.47263204760692, 223.87815519951357, 134.43119727653558, 108.39430796537424, 128.56954443824966, 73.74096802662903, 116.5337210090324, 163.2926867051928, 184.80856731811986, 71.64811793782219, 74.2321291305781, 118.52523898995284, 141.12846506619115, 135.41624483759952, 145.53951687079058, 111.94136516684817, 92.85403179039548, 50.61793257998368, 66.85086789907453, 59.45947520081567, 86.42593655999143, 100.91335094757484, 203.73241157837143, 168.9127503102018, 104.61231956973502, 127.685854607423, 157.13914108496843, 144.41137720645398, 109.01220825088606, 162.90740286137026, 121.10603552151656, 139.5433473791591, 81.86141502612807, 124.33592895899513, 98.00580659421841, 64.49108861381553, 133.50033554173922, 109.5159670378419, 111.02755218610882, 118.15564090129773, 207.6752526824566, 159.82867363464874, 99.58596481837895, 70.27668271779973, 72.8590241532238, 104.06185497000783, 75.33285474820717, 150.197670555926, 150.6816654531998, 158.44483751105258, 112.83102558033056, 216.6733471673644, 119.65799606631369, 218.35449730039798, 174.9931422625732, 70.48994919311282, 100.37328909334522, 85.33430603044198, 129.14584048716893, 183.17628756043487, 201.94955514692523, 160.48529414316795, 97.92051882232228, 95.98024252699861, 101.13876234123676, 137.25470528581937, 126.1509780191728, 177.43419701211403, 180.04084582337865, 2.96648840715161, 54.1588567024858, 126.82425239550462, 144.79512442168905, 150.9940384496529, 194.06494700997058, 136.10123448364578, 82.12534529562593, 80.84102772380233, 86.29243625363173, 127.56297065324142, 122.30873030872056, 59.028732206029545, 148.61760884223847, 291.676514379497, 172.4743276272211, 142.894167644159, 200.14593676614638, 194.84706488519942, 221.0279379983618, 178.92520977445344, 141.84640628399305, 38.32957085000404, 75.93501057281543, 98.58733017545937, 90.37065133060835, 146.1763855728368, 180.49671995975828, 163.9298940759929, 41.97043921887168, 213.86002185280262, 157.47218156632925, 174.615313672264, 283.5387003005098, 58.82999193585468, 87.03517004061912, 157.08194588699072, 110.64023979845872, 117.84725621455927, 171.3830352406621, 65.35703046233961, 137.19705280897787, 109.3208811402574, 82.45214013992468, 107.28311074939467, 101.65787497523915, 207.53524985367523, 96.77135515767267, 122.53640379618923, 122.8470711566043, 96.2243527657082, 162.0439136884075, 209.22832100047586, 157.9772175785259, 62.4715359599166, 89.80306810315727, 137.96458263972272, 114.19790083894213, 203.403450823033, 147.6095967145975, 94.93545650033093, 175.88793524836035, 82.81608187705616, 89.29335087534568, 41.27028843177928, 29.771983609465224, 1.059603887919116, 29.510819241282576, 109.37894624749433, 66.25765792761698, 125.53361645810122, 155.44265255113248, 118.53027745844147, 113.0915529847197, 173.49621529685473, 178.6508929286744, 67.68938448523112, 61.27391398678552, 150.7714435817777, 110.34691489944596, 122.29671372290383, 227.35562791797628, 110.76155105268724, 160.86244731247035, 84.38350007311186, 126.2110856549585, 111.31843978976677, 160.27646281968234, 111.51902752064153, 66.4421929253787, 141.98223773448336, 173.05761294420492, 139.79582573545622, 164.41916746445068, 75.17982378310657, 94.01448229026438, 196.97984326957268, 254.40776435590072, 188.65310521896475, 136.91121854506076, 2.069383589705036, 14.899951845283121, 105.00912248400417, 82.02165708708252, 82.38867458568123, 132.83383138970163, 99.85941477984115, 133.77159096180597, 100.41057883987386, 97.79043041481067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6526346374007669, "mean_inference_ms": 2.0125613530972384, "mean_action_processing_ms": 0.2856096306649914, "mean_env_wait_ms": 0.2404539719865609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005574226379394531, "StateBufferConnector_ms": 0.004966020584106445, "ViewRequirementAgentConnector_ms": 0.12729871273040771}, "num_episodes": 23, "episode_return_max": 139.80033983746222, "episode_return_min": -23.033325768537676, "episode_return_mean": 45.86991209897061, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.85076060862446, "num_env_steps_trained_throughput_per_sec": 306.85076060862446, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 13492.838, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13492.8, "sample_time_ms": 1990.942, "learn_time_ms": 11480.823, "learn_throughput": 348.407, "synch_weights_time_ms": 19.717}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "ef79f_00000", "date": "2024-08-16_11-26-05", "timestamp": 1723787765, "time_this_iter_s": 13.04190468788147, "time_total_s": 542.0394546985626, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b8430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 542.0394546985626, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 53.89473684210526, "ram_util_percent": 78.97368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.89683737102009, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.1288533907088025, "policy_loss": -0.007998789372982052, "vf_loss": 6.134747930557009, "vf_explained_var": 0.04565976785604285, "kl": 0.01402835554480575, "entropy": 1.2658186385240504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.124676201393996, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.944888749702898, "policy_loss": -0.000898389860238663, "vf_loss": 7.945476141430083, "vf_explained_var": 0.009250459721479466, "kl": 0.006220178736023305, "entropy": 0.41913803320713144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 148.59551374528425, "episode_reward_min": -22.768178303445847, "episode_reward_mean": 54.99230520534038, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -3575.750050647578, "predator_policy": 1.059603887919116}, "policy_reward_max": {"prey_policy": 47.3989129813007, "predator_policy": 2567.2205710954495}, "policy_reward_mean": {"prey_policy": -104.44620419945186, "predator_policy": 131.94235680212202}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.03311059043182, 61.11925874290712, 63.39399244913791, -0.25825213357518506, 17.816900833029877, 63.67675759064732, 44.45412807698507, 35.02197727865702, 17.801908601285874, 11.248719780637115, 35.594084330255754, 107.8832576732502, -11.968606630695731, 53.14464138823918, 31.120437166404837, 43.93549974358307, 44.71855192703225, 86.1968515932324, 38.805222031708254, 5.5217053611087294, 86.47718161079385, -17.611378512065816, 15.192929487615642, 16.077729239525233, -8.236456627109153, 32.775838119707366, 44.16845051697586, -22.768178303445847, 40.46262469084254, 45.399283798863095, 44.93405315608146, 80.33736442159567, 31.917616276573312, 1.1401331592745911, 71.12556157213723, 52.98972265673156, 44.337458156929806, 5.605363495631142, 73.16993637242524, 5.7684267649175105, -15.329752101016538, -12.526911188084037, 85.10966260520334, 35.57201194554846, 131.20925745143546, 91.5020329134682, 24.802548309540185, 36.50323617355842, 102.70348962700136, 83.98012703936716, -18.97590696967267, 86.70074223224316, 62.81453636320673, -10.529248039555524, 54.2729742946105, 62.05716727165232, 29.936993510014346, 0.5214188793278414, 56.84122764439386, 88.3329802192571, -9.392866963818907, 71.00587639144454, 135.42708562130213, 71.15026460153132, 90.76802647202689, 69.29009191094333, 58.572909026757856, 83.84185566844269, 102.84627708207962, 44.69092500236136, 18.60709544453115, 52.19194345756585, 134.15821438822053, 39.8417730146328, 52.334090734119755, 139.80033983746222, 102.42257588369185, 1.4659744202388238, 80.68040915198813, 14.296324099746553, 88.24378563359382, 91.15308451070976, 144.16384340497024, 65.74466354921938, 140.54197381435054, 148.59551374528425, 106.29928451475705, 114.31603259858832, 93.93216556287041, 71.26787019213066, 18.258740092527592, 133.5696698906205, 66.63104049296906, 60.10912176557231, 87.47139592120101, 10.395403712985194, 85.42129608794745, 17.273742789765166, 48.16013007652778, 133.66018230241704], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-75.39587575312838, -77.36641061368356, -25.449165534509017, -30.90037620164201, -70.94064846034551, -11.550770851323671, -186.78666715790072, -118.11734750162105, -126.07991783406409, -129.6282512128427, -112.11359034853939, -109.0346477532048, -131.07995899773888, -77.8894983826161, -97.62773844807822, -151.3637226561515, -102.41988317845582, -101.1829706255455, -115.07354711794716, -96.01946865462928, -62.24823195862167, -100.14910786667737, -1.2013286543085888, -111.45893289639227, -170.50262097332865, -167.2968792411215, -37.66489853929321, -168.60509852549555, -68.499387009927, -43.515882694691534, -77.13781786094286, -58.32139211368899, -79.51036694190566, -176.65041714018753, -139.62554268063914, -45.45346881751157, -183.89107775967605, -113.63504344229398, -198.53422980190936, -189.29170439995303, 17.840000000000003, -102.2260566756641, -124.26804322029139, -107.82348180938531, -197.0127110226231, -172.92020219712145, -102.38025594715131, -139.94782777881372, -104.53202276587852, -100.82343872946583, -98.50417681341435, -132.12566837187066, -209.21299080147418, -104.09360151704283, -49.511203149252864, -30.382320263830582, -96.10215721047864, -135.0545949158724, -157.0859184424379, -142.57378321832243, -155.6363284525728, -17.656198170617174, -83.36165401659693, -3.434445539241632, -109.00667101010441, -108.94741367528452, -132.68778514756067, -73.8184227414328, -293.27284001054426, -99.7524404240366, -119.80103367233286, -170.24934808124084, -192.46056240300126, -179.07698232362998, -183.39825140869547, -131.76800115412001, -42.66728694436697, 1.572641893972733, -87.8260999162297, -95.36345482492035, -136.82374203989193, -205.17911559372018, -124.3876564747055, -94.03958800824297, -200.7691433972292, -85.45339741669936, -258.5235366545109, -164.0584653727144, -31.666714007522792, 17.01080948248489, -153.01236200432396, -23.207790767657595, -91.795432241885, -172.63231090379642, -83.1693099137764, -82.88153718398274, -91.0695316531813, 2.0000000000000013, -4.852874489121727, -120.10798419614511, -185.81123003357072, -137.4712819474497, -37.96300214577934, -120.71973057477089, -120.20889363899573, -75.24483645191329, -128.21582436149455, -249.51896225706238, -64.18817924556497, -33.813450522898485, -82.72437130257681, -107.38094490443596, -126.95024956227488, -194.125804465341, -148.35345631650873, -121.94851655285481, -19.44526412325091, -95.8229409847568, 14.454175200530843, 2.836532977481218, -24.068714575639326, -15.89457551738077, -7.707263450598317, -96.92346433306855, -77.43204077751867, -68.11714261041297, -74.66681493799337, -85.80475090363608, -168.47954610615912, -92.89953564734282, -60.30373872504336, 0.6305321639701403, -46.24793819427044, -156.29751126019545, -267.6016459049109, 1.791159932473403, -150.66030164391654, -18.117419639161607, -107.656045996326, -58.24761472938309, -111.9078438892311, -141.07996327568682, -15.299168038151892, -110.47010895030232, -121.84100262633137, -59.04063366413622, -121.94224395524508, -142.43097623002888, -109.86364637861911, -6.996568960632022, -214.27351782867535, -97.31374995933558, -178.95002341201507, -44.19172446831839, -7.409330626898157, -8.094030387851253, -94.38894422560442, -11.961426193494482, -82.8465486788227, -118.07963319681357, -97.805286579919, -47.58193352813411, -96.44495275985237, -10.60297198412261, 0.16384416540344832, 19.103032246577307, -2.862713783857652, -43.57562715098452, 12.466301693326471, 37.90791305907503, 47.3989129813007, -68.33326812654704, 33.352050783517285, -170.37690196334034, 33.034259097065785, -37.71124525100637, -10.83806564046873, -69.63170234283423, -119.30933958219133, -4.984156752490248, -103.2094362870745, -27.699668306360373, -24.70232014594064, -4.0184189267281045, -1.5049540314706533, -3575.750050647578, 17.409983657289313, -6.605781794595988, 9.460991342461204, -132.3128987259974, -15.436256465749375, 2.0000000000000013, -18.139371098106768, -27.368311329363937, -16.48702180345864, -18.61498021460017, 26.126821471127524, -13.887933083230442, -57.19174256294474, -87.78934819026588], "policy_predator_policy_reward": [111.94136516684817, 92.85403179039548, 50.61793257998368, 66.85086789907453, 59.45947520081567, 86.42593655999143, 100.91335094757484, 203.73241157837143, 168.9127503102018, 104.61231956973502, 127.685854607423, 157.13914108496843, 144.41137720645398, 109.01220825088606, 162.90740286137026, 121.10603552151656, 139.5433473791591, 81.86141502612807, 124.33592895899513, 98.00580659421841, 64.49108861381553, 133.50033554173922, 109.5159670378419, 111.02755218610882, 118.15564090129773, 207.6752526824566, 159.82867363464874, 99.58596481837895, 70.27668271779973, 72.8590241532238, 104.06185497000783, 75.33285474820717, 150.197670555926, 150.6816654531998, 158.44483751105258, 112.83102558033056, 216.6733471673644, 119.65799606631369, 218.35449730039798, 174.9931422625732, 70.48994919311282, 100.37328909334522, 85.33430603044198, 129.14584048716893, 183.17628756043487, 201.94955514692523, 160.48529414316795, 97.92051882232228, 95.98024252699861, 101.13876234123676, 137.25470528581937, 126.1509780191728, 177.43419701211403, 180.04084582337865, 2.96648840715161, 54.1588567024858, 126.82425239550462, 144.79512442168905, 150.9940384496529, 194.06494700997058, 136.10123448364578, 82.12534529562593, 80.84102772380233, 86.29243625363173, 127.56297065324142, 122.30873030872056, 59.028732206029545, 148.61760884223847, 291.676514379497, 172.4743276272211, 142.894167644159, 200.14593676614638, 194.84706488519942, 221.0279379983618, 178.92520977445344, 141.84640628399305, 38.32957085000404, 75.93501057281543, 98.58733017545937, 90.37065133060835, 146.1763855728368, 180.49671995975828, 163.9298940759929, 41.97043921887168, 213.86002185280262, 157.47218156632925, 174.615313672264, 283.5387003005098, 58.82999193585468, 87.03517004061912, 157.08194588699072, 110.64023979845872, 117.84725621455927, 171.3830352406621, 65.35703046233961, 137.19705280897787, 109.3208811402574, 82.45214013992468, 107.28311074939467, 101.65787497523915, 207.53524985367523, 96.77135515767267, 122.53640379618923, 122.8470711566043, 96.2243527657082, 162.0439136884075, 209.22832100047586, 157.9772175785259, 62.4715359599166, 89.80306810315727, 137.96458263972272, 114.19790083894213, 203.403450823033, 147.6095967145975, 94.93545650033093, 175.88793524836035, 82.81608187705616, 89.29335087534568, 41.27028843177928, 29.771983609465224, 1.059603887919116, 29.510819241282576, 109.37894624749433, 66.25765792761698, 125.53361645810122, 155.44265255113248, 118.53027745844147, 113.0915529847197, 173.49621529685473, 178.6508929286744, 67.68938448523112, 61.27391398678552, 150.7714435817777, 110.34691489944596, 122.29671372290383, 227.35562791797628, 110.76155105268724, 160.86244731247035, 84.38350007311186, 126.2110856549585, 111.31843978976677, 160.27646281968234, 111.51902752064153, 66.4421929253787, 141.98223773448336, 173.05761294420492, 139.79582573545622, 164.41916746445068, 75.17982378310657, 94.01448229026438, 196.97984326957268, 254.40776435590072, 188.65310521896475, 136.91121854506076, 2.069383589705036, 14.899951845283121, 105.00912248400417, 82.02165708708252, 82.38867458568123, 132.83383138970163, 99.85941477984115, 133.77159096180597, 100.41057883987386, 97.79043041481067, 56.24199552202833, 68.65497147096077, 73.81724025610355, 38.36576422795793, 43.647489707978515, 46.52026935397034, 93.26621465814303, 76.2636542323878, 134.9014753340326, 108.42266036054696, 69.87910761793835, 49.11391113459004, 84.43529524841412, 89.96663829775913, 107.98254946574035, 87.57881706107194, 84.22764077634127, 64.94020390962153, 84.30724050885577, 77.98316845443347, 2567.2205710954495, 1076.6654740765664, 30.863667251905653, 18.441252650973368, 94.9989511533628, 115.32435215137433, 17.13625646574953, 6.695403712985271, 65.350860053485, 65.57811846193324, 28.269444617461712, 24.106300190362543, 22.45283192023752, 13.468409768392936, 143.34356029455157, 135.29771276107596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6542004733358258, "mean_inference_ms": 2.0193500024854303, "mean_action_processing_ms": 0.28588272598737224, "mean_env_wait_ms": 0.24130140978187392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015842676162719727, "StateBufferConnector_ms": 0.0038923025131225586, "ViewRequirementAgentConnector_ms": 0.1305546760559082}, "num_episodes": 18, "episode_return_max": 148.59551374528425, "episode_return_min": -22.768178303445847, "episode_return_mean": 54.99230520534038, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.9007733846098, "num_env_steps_trained_throughput_per_sec": 292.9007733846098, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 13547.395, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13547.357, "sample_time_ms": 1953.977, "learn_time_ms": 11571.911, "learn_throughput": 345.665, "synch_weights_time_ms": 20.144}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "ef79f_00000", "date": "2024-08-16_11-26-19", "timestamp": 1723787779, "time_this_iter_s": 13.66524600982666, "time_total_s": 555.7047007083893, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214aca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 555.7047007083893, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 54.04736842105264, "ram_util_percent": 71.21578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3959105510560295, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.925327542723802, "policy_loss": -0.017518144212515345, "vf_loss": 4.940672535871072, "vf_explained_var": 0.27692258298081696, "kl": 0.01448764617599139, "entropy": 1.2300649467599456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.671027511200577, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.450178172600964, "policy_loss": -0.0033222921678017843, "vf_loss": 8.453218114691436, "vf_explained_var": 0.07379472189479404, "kl": 0.00564783071920262, "entropy": 0.3453068748037651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 148.59551374528425, "episode_reward_min": -22.768178303445847, "episode_reward_mean": 63.02588532544301, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -3575.750050647578, "predator_policy": 1.059603887919116}, "policy_reward_max": {"prey_policy": 56.657087159497756, "predator_policy": 2567.2205710954495}, "policy_reward_mean": {"prey_policy": -91.81595475476045, "predator_policy": 123.32889741748193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.805222031708254, 5.5217053611087294, 86.47718161079385, -17.611378512065816, 15.192929487615642, 16.077729239525233, -8.236456627109153, 32.775838119707366, 44.16845051697586, -22.768178303445847, 40.46262469084254, 45.399283798863095, 44.93405315608146, 80.33736442159567, 31.917616276573312, 1.1401331592745911, 71.12556157213723, 52.98972265673156, 44.337458156929806, 5.605363495631142, 73.16993637242524, 5.7684267649175105, -15.329752101016538, -12.526911188084037, 85.10966260520334, 35.57201194554846, 131.20925745143546, 91.5020329134682, 24.802548309540185, 36.50323617355842, 102.70348962700136, 83.98012703936716, -18.97590696967267, 86.70074223224316, 62.81453636320673, -10.529248039555524, 54.2729742946105, 62.05716727165232, 29.936993510014346, 0.5214188793278414, 56.84122764439386, 88.3329802192571, -9.392866963818907, 71.00587639144454, 135.42708562130213, 71.15026460153132, 90.76802647202689, 69.29009191094333, 58.572909026757856, 83.84185566844269, 102.84627708207962, 44.69092500236136, 18.60709544453115, 52.19194345756585, 134.15821438822053, 39.8417730146328, 52.334090734119755, 139.80033983746222, 102.42257588369185, 1.4659744202388238, 80.68040915198813, 14.296324099746553, 88.24378563359382, 91.15308451070976, 144.16384340497024, 65.74466354921938, 140.54197381435054, 148.59551374528425, 106.29928451475705, 114.31603259858832, 93.93216556287041, 71.26787019213066, 18.258740092527592, 133.5696698906205, 66.63104049296906, 60.10912176557231, 87.47139592120101, 10.395403712985194, 85.42129608794745, 17.273742789765166, 48.16013007652778, 133.66018230241704, 124.36041248738776, 80.92494463087904, 110.06467673498534, 50.34042670632515, 94.80564329610864, 117.40175692100841, 143.93645544927242, 110.57140862359014, 74.52286335913796, 89.2231312412751, 32.8343257722421, 88.49458229015966, 5.1596438138325915, 126.44956082323431, 22.452387467948633, 99.21539105190554, 119.73296954319034, 69.80065079922447], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-183.89107775967605, -113.63504344229398, -198.53422980190936, -189.29170439995303, 17.840000000000003, -102.2260566756641, -124.26804322029139, -107.82348180938531, -197.0127110226231, -172.92020219712145, -102.38025594715131, -139.94782777881372, -104.53202276587852, -100.82343872946583, -98.50417681341435, -132.12566837187066, -209.21299080147418, -104.09360151704283, -49.511203149252864, -30.382320263830582, -96.10215721047864, -135.0545949158724, -157.0859184424379, -142.57378321832243, -155.6363284525728, -17.656198170617174, -83.36165401659693, -3.434445539241632, -109.00667101010441, -108.94741367528452, -132.68778514756067, -73.8184227414328, -293.27284001054426, -99.7524404240366, -119.80103367233286, -170.24934808124084, -192.46056240300126, -179.07698232362998, -183.39825140869547, -131.76800115412001, -42.66728694436697, 1.572641893972733, -87.8260999162297, -95.36345482492035, -136.82374203989193, -205.17911559372018, -124.3876564747055, -94.03958800824297, -200.7691433972292, -85.45339741669936, -258.5235366545109, -164.0584653727144, -31.666714007522792, 17.01080948248489, -153.01236200432396, -23.207790767657595, -91.795432241885, -172.63231090379642, -83.1693099137764, -82.88153718398274, -91.0695316531813, 2.0000000000000013, -4.852874489121727, -120.10798419614511, -185.81123003357072, -137.4712819474497, -37.96300214577934, -120.71973057477089, -120.20889363899573, -75.24483645191329, -128.21582436149455, -249.51896225706238, -64.18817924556497, -33.813450522898485, -82.72437130257681, -107.38094490443596, -126.95024956227488, -194.125804465341, -148.35345631650873, -121.94851655285481, -19.44526412325091, -95.8229409847568, 14.454175200530843, 2.836532977481218, -24.068714575639326, -15.89457551738077, -7.707263450598317, -96.92346433306855, -77.43204077751867, -68.11714261041297, -74.66681493799337, -85.80475090363608, -168.47954610615912, -92.89953564734282, -60.30373872504336, 0.6305321639701403, -46.24793819427044, -156.29751126019545, -267.6016459049109, 1.791159932473403, -150.66030164391654, -18.117419639161607, -107.656045996326, -58.24761472938309, -111.9078438892311, -141.07996327568682, -15.299168038151892, -110.47010895030232, -121.84100262633137, -59.04063366413622, -121.94224395524508, -142.43097623002888, -109.86364637861911, -6.996568960632022, -214.27351782867535, -97.31374995933558, -178.95002341201507, -44.19172446831839, -7.409330626898157, -8.094030387851253, -94.38894422560442, -11.961426193494482, -82.8465486788227, -118.07963319681357, -97.805286579919, -47.58193352813411, -96.44495275985237, -10.60297198412261, 0.16384416540344832, 19.103032246577307, -2.862713783857652, -43.57562715098452, 12.466301693326471, 37.90791305907503, 47.3989129813007, -68.33326812654704, 33.352050783517285, -170.37690196334034, 33.034259097065785, -37.71124525100637, -10.83806564046873, -69.63170234283423, -119.30933958219133, -4.984156752490248, -103.2094362870745, -27.699668306360373, -24.70232014594064, -4.0184189267281045, -1.5049540314706533, -3575.750050647578, 17.409983657289313, -6.605781794595988, 9.460991342461204, -132.3128987259974, -15.436256465749375, 2.0000000000000013, -18.139371098106768, -27.368311329363937, -16.48702180345864, -18.61498021460017, 26.126821471127524, -13.887933083230442, -57.19174256294474, -87.78934819026588, -5.8826065730895, -48.759831535315, -86.69717482284628, -50.22863867800953, -61.414089296461846, -110.75551697950394, -44.19979156679799, 1.8655854772151466, -82.90514093685753, -26.96855765580092, -27.46298726354679, 56.657087159497756, -84.15771583996806, 32.526506954391685, 13.38284498569464, -185.6752252021628, 23.529555594796655, -10.541189359684351, -1.061211164141155, -52.15406283014391, 2.0000000000000013, -95.3537206454872, -24.121352805746625, -10.928566103334106, -0.7317890507695906, 2.0000000000000013, 35.008004478250434, 17.043019491216, -23.476175874980964, -23.427873218646052, 15.726933443041844, 0.033199373535845185, 21.94407072489996, -15.677691319923902, -9.690530622554528, -67.25731059719101], "policy_predator_policy_reward": [216.6733471673644, 119.65799606631369, 218.35449730039798, 174.9931422625732, 70.48994919311282, 100.37328909334522, 85.33430603044198, 129.14584048716893, 183.17628756043487, 201.94955514692523, 160.48529414316795, 97.92051882232228, 95.98024252699861, 101.13876234123676, 137.25470528581937, 126.1509780191728, 177.43419701211403, 180.04084582337865, 2.96648840715161, 54.1588567024858, 126.82425239550462, 144.79512442168905, 150.9940384496529, 194.06494700997058, 136.10123448364578, 82.12534529562593, 80.84102772380233, 86.29243625363173, 127.56297065324142, 122.30873030872056, 59.028732206029545, 148.61760884223847, 291.676514379497, 172.4743276272211, 142.894167644159, 200.14593676614638, 194.84706488519942, 221.0279379983618, 178.92520977445344, 141.84640628399305, 38.32957085000404, 75.93501057281543, 98.58733017545937, 90.37065133060835, 146.1763855728368, 180.49671995975828, 163.9298940759929, 41.97043921887168, 213.86002185280262, 157.47218156632925, 174.615313672264, 283.5387003005098, 58.82999193585468, 87.03517004061912, 157.08194588699072, 110.64023979845872, 117.84725621455927, 171.3830352406621, 65.35703046233961, 137.19705280897787, 109.3208811402574, 82.45214013992468, 107.28311074939467, 101.65787497523915, 207.53524985367523, 96.77135515767267, 122.53640379618923, 122.8470711566043, 96.2243527657082, 162.0439136884075, 209.22832100047586, 157.9772175785259, 62.4715359599166, 89.80306810315727, 137.96458263972272, 114.19790083894213, 203.403450823033, 147.6095967145975, 94.93545650033093, 175.88793524836035, 82.81608187705616, 89.29335087534568, 41.27028843177928, 29.771983609465224, 1.059603887919116, 29.510819241282576, 109.37894624749433, 66.25765792761698, 125.53361645810122, 155.44265255113248, 118.53027745844147, 113.0915529847197, 173.49621529685473, 178.6508929286744, 67.68938448523112, 61.27391398678552, 150.7714435817777, 110.34691489944596, 122.29671372290383, 227.35562791797628, 110.76155105268724, 160.86244731247035, 84.38350007311186, 126.2110856549585, 111.31843978976677, 160.27646281968234, 111.51902752064153, 66.4421929253787, 141.98223773448336, 173.05761294420492, 139.79582573545622, 164.41916746445068, 75.17982378310657, 94.01448229026438, 196.97984326957268, 254.40776435590072, 188.65310521896475, 136.91121854506076, 2.069383589705036, 14.899951845283121, 105.00912248400417, 82.02165708708252, 82.38867458568123, 132.83383138970163, 99.85941477984115, 133.77159096180597, 100.41057883987386, 97.79043041481067, 56.24199552202833, 68.65497147096077, 73.81724025610355, 38.36576422795793, 43.647489707978515, 46.52026935397034, 93.26621465814303, 76.2636542323878, 134.9014753340326, 108.42266036054696, 69.87910761793835, 49.11391113459004, 84.43529524841412, 89.96663829775913, 107.98254946574035, 87.57881706107194, 84.22764077634127, 64.94020390962153, 84.30724050885577, 77.98316845443347, 2567.2205710954495, 1076.6654740765664, 30.863667251905653, 18.441252650973368, 94.9989511533628, 115.32435215137433, 17.13625646574953, 6.695403712985271, 65.350860053485, 65.57811846193324, 28.269444617461712, 24.106300190362543, 22.45283192023752, 13.468409768392936, 143.34356029455157, 135.29771276107596, 83.73308883360276, 95.2697617621893, 106.64044241117, 111.21031572056451, 139.56668666579202, 142.66759634515907, 30.51602971871452, 62.158603077193575, 97.4948763663496, 107.18446552241748, 43.32458682647863, 44.883070198578146, 82.24513292903904, 113.32253140581011, 141.72915433510732, 141.13463450495036, 35.582553479044805, 25.951943644980247, 79.027942567014, 63.41046266854534, 42.538286818263266, 83.64975959946594, 73.2621753143195, 50.28232588492058, 2.2953842762917667, 1.5960485883104705, 36.90895310730212, 37.48958374646535, 25.77694112782766, 43.579495433747994, 40.69360005091737, 42.76165818440984, 69.19796890258382, 44.26862123563013, 39.14199154476549, 107.60650047420444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6554739916452911, "mean_inference_ms": 2.0251181050252938, "mean_action_processing_ms": 0.28611260242238823, "mean_env_wait_ms": 0.24189587883885758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016330242156982422, "StateBufferConnector_ms": 0.003933310508728027, "ViewRequirementAgentConnector_ms": 0.12674927711486816}, "num_episodes": 18, "episode_return_max": 148.59551374528425, "episode_return_min": -22.768178303445847, "episode_return_mean": 63.02588532544301, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.8840499593141, "num_env_steps_trained_throughput_per_sec": 278.8840499593141, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 13649.761, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13649.724, "sample_time_ms": 1958.182, "learn_time_ms": 11674.988, "learn_throughput": 342.613, "synch_weights_time_ms": 15.191}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "ef79f_00000", "date": "2024-08-16_11-26-33", "timestamp": 1723787793, "time_this_iter_s": 14.387240886688232, "time_total_s": 570.0919415950775, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a53125e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 570.0919415950775, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 67.06666666666668, "ram_util_percent": 74.84285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2713250457294403, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.165273650487264, "policy_loss": -0.012995218194863468, "vf_loss": 3.17622068811346, "vf_explained_var": -0.09253213336228062, "kl": 0.013654510337544093, "entropy": 1.1921717266557077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.07862035786664, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.60208944593157, "policy_loss": -0.0035862048069093986, "vf_loss": 8.605333911048042, "vf_explained_var": -0.08582474176215116, "kl": 0.0068339322370827345, "entropy": 0.3305027297959126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 173.08999999999972, "episode_reward_min": -18.97590696967267, "episode_reward_mean": 72.61186305713989, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -3575.750050647578, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.2899999999999, "predator_policy": 2567.2205710954495}, "policy_reward_mean": {"prey_policy": -64.33576036772453, "predator_policy": 100.64169189629439}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.329752101016538, -12.526911188084037, 85.10966260520334, 35.57201194554846, 131.20925745143546, 91.5020329134682, 24.802548309540185, 36.50323617355842, 102.70348962700136, 83.98012703936716, -18.97590696967267, 86.70074223224316, 62.81453636320673, -10.529248039555524, 54.2729742946105, 62.05716727165232, 29.936993510014346, 0.5214188793278414, 56.84122764439386, 88.3329802192571, -9.392866963818907, 71.00587639144454, 135.42708562130213, 71.15026460153132, 90.76802647202689, 69.29009191094333, 58.572909026757856, 83.84185566844269, 102.84627708207962, 44.69092500236136, 18.60709544453115, 52.19194345756585, 134.15821438822053, 39.8417730146328, 52.334090734119755, 139.80033983746222, 102.42257588369185, 1.4659744202388238, 80.68040915198813, 14.296324099746553, 88.24378563359382, 91.15308451070976, 144.16384340497024, 65.74466354921938, 140.54197381435054, 148.59551374528425, 106.29928451475705, 114.31603259858832, 93.93216556287041, 71.26787019213066, 18.258740092527592, 133.5696698906205, 66.63104049296906, 60.10912176557231, 87.47139592120101, 10.395403712985194, 85.42129608794745, 17.273742789765166, 48.16013007652778, 133.66018230241704, 124.36041248738776, 80.92494463087904, 110.06467673498534, 50.34042670632515, 94.80564329610864, 117.40175692100841, 143.93645544927242, 110.57140862359014, 74.52286335913796, 89.2231312412751, 32.8343257722421, 88.49458229015966, 5.1596438138325915, 126.44956082323431, 22.452387467948633, 99.21539105190554, 119.73296954319034, 69.80065079922447, 72.47171282592612, 160.05364647881947, 4.636887915743223, 24.395890338669002, 173.08999999999972, 109.53922272137349, 90.72046956927537, 8.166421154138682, 28.45217983192858, 69.01469784086007, 105.45595029420296, 118.44313752636644, 18.257041628198447, 72.30588721225605, 130.0690149925573, 25.97935883707032, 24.655713467292827, 92.4444085951342, 7.349945676249317, 171.96810482716435, 42.243564335824374, 96.47510454745479], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-136.82374203989193, -205.17911559372018, -124.3876564747055, -94.03958800824297, -200.7691433972292, -85.45339741669936, -258.5235366545109, -164.0584653727144, -31.666714007522792, 17.01080948248489, -153.01236200432396, -23.207790767657595, -91.795432241885, -172.63231090379642, -83.1693099137764, -82.88153718398274, -91.0695316531813, 2.0000000000000013, -4.852874489121727, -120.10798419614511, -185.81123003357072, -137.4712819474497, -37.96300214577934, -120.71973057477089, -120.20889363899573, -75.24483645191329, -128.21582436149455, -249.51896225706238, -64.18817924556497, -33.813450522898485, -82.72437130257681, -107.38094490443596, -126.95024956227488, -194.125804465341, -148.35345631650873, -121.94851655285481, -19.44526412325091, -95.8229409847568, 14.454175200530843, 2.836532977481218, -24.068714575639326, -15.89457551738077, -7.707263450598317, -96.92346433306855, -77.43204077751867, -68.11714261041297, -74.66681493799337, -85.80475090363608, -168.47954610615912, -92.89953564734282, -60.30373872504336, 0.6305321639701403, -46.24793819427044, -156.29751126019545, -267.6016459049109, 1.791159932473403, -150.66030164391654, -18.117419639161607, -107.656045996326, -58.24761472938309, -111.9078438892311, -141.07996327568682, -15.299168038151892, -110.47010895030232, -121.84100262633137, -59.04063366413622, -121.94224395524508, -142.43097623002888, -109.86364637861911, -6.996568960632022, -214.27351782867535, -97.31374995933558, -178.95002341201507, -44.19172446831839, -7.409330626898157, -8.094030387851253, -94.38894422560442, -11.961426193494482, -82.8465486788227, -118.07963319681357, -97.805286579919, -47.58193352813411, -96.44495275985237, -10.60297198412261, 0.16384416540344832, 19.103032246577307, -2.862713783857652, -43.57562715098452, 12.466301693326471, 37.90791305907503, 47.3989129813007, -68.33326812654704, 33.352050783517285, -170.37690196334034, 33.034259097065785, -37.71124525100637, -10.83806564046873, -69.63170234283423, -119.30933958219133, -4.984156752490248, -103.2094362870745, -27.699668306360373, -24.70232014594064, -4.0184189267281045, -1.5049540314706533, -3575.750050647578, 17.409983657289313, -6.605781794595988, 9.460991342461204, -132.3128987259974, -15.436256465749375, 2.0000000000000013, -18.139371098106768, -27.368311329363937, -16.48702180345864, -18.61498021460017, 26.126821471127524, -13.887933083230442, -57.19174256294474, -87.78934819026588, -5.8826065730895, -48.759831535315, -86.69717482284628, -50.22863867800953, -61.414089296461846, -110.75551697950394, -44.19979156679799, 1.8655854772151466, -82.90514093685753, -26.96855765580092, -27.46298726354679, 56.657087159497756, -84.15771583996806, 32.526506954391685, 13.38284498569464, -185.6752252021628, 23.529555594796655, -10.541189359684351, -1.061211164141155, -52.15406283014391, 2.0000000000000013, -95.3537206454872, -24.121352805746625, -10.928566103334106, -0.7317890507695906, 2.0000000000000013, 35.008004478250434, 17.043019491216, -23.476175874980964, -23.427873218646052, 15.726933443041844, 0.033199373535845185, 21.94407072489996, -15.677691319923902, -9.690530622554528, -67.25731059719101, -17.178602336887657, -164.23835726521835, 129.1652310517594, -11.86372453982733, 2.0000000000000013, 0.7799512198941027, 18.830000000000286, -10.782628288324204, -8.337459598264456, 171.2899999999999, 99.34926382431041, 0.6252887743919832, 23.494896116782286, -17.202685928376294, -13.404153326579046, -2.1157352647382015, 4.989640206014115, -5.898433358355457, -56.48944166581429, -1.1772980699373854, -278.62755701455313, 23.780000000000253, 1.7664587991831087, 82.72648242604961, 2.0000000000000013, -15.294585874737196, 35.19852810492404, -30.44843780125906, 57.44000000000001, 39.81603655411813, -6.113663743557514, -1.0636071303643768, -12.079085854659754, 18.830000000000286, 1.821151404027037, 25.108053202000576, -4.977496587712733, 2.0000000000000013, 111.43081602937349, 15.23639277992098, -10.17601445545479, -2.556784757909373, 29.662205431204868, 16.019146068981797], "policy_predator_policy_reward": [146.1763855728368, 180.49671995975828, 163.9298940759929, 41.97043921887168, 213.86002185280262, 157.47218156632925, 174.615313672264, 283.5387003005098, 58.82999193585468, 87.03517004061912, 157.08194588699072, 110.64023979845872, 117.84725621455927, 171.3830352406621, 65.35703046233961, 137.19705280897787, 109.3208811402574, 82.45214013992468, 107.28311074939467, 101.65787497523915, 207.53524985367523, 96.77135515767267, 122.53640379618923, 122.8470711566043, 96.2243527657082, 162.0439136884075, 209.22832100047586, 157.9772175785259, 62.4715359599166, 89.80306810315727, 137.96458263972272, 114.19790083894213, 203.403450823033, 147.6095967145975, 94.93545650033093, 175.88793524836035, 82.81608187705616, 89.29335087534568, 41.27028843177928, 29.771983609465224, 1.059603887919116, 29.510819241282576, 109.37894624749433, 66.25765792761698, 125.53361645810122, 155.44265255113248, 118.53027745844147, 113.0915529847197, 173.49621529685473, 178.6508929286744, 67.68938448523112, 61.27391398678552, 150.7714435817777, 110.34691489944596, 122.29671372290383, 227.35562791797628, 110.76155105268724, 160.86244731247035, 84.38350007311186, 126.2110856549585, 111.31843978976677, 160.27646281968234, 111.51902752064153, 66.4421929253787, 141.98223773448336, 173.05761294420492, 139.79582573545622, 164.41916746445068, 75.17982378310657, 94.01448229026438, 196.97984326957268, 254.40776435590072, 188.65310521896475, 136.91121854506076, 2.069383589705036, 14.899951845283121, 105.00912248400417, 82.02165708708252, 82.38867458568123, 132.83383138970163, 99.85941477984115, 133.77159096180597, 100.41057883987386, 97.79043041481067, 56.24199552202833, 68.65497147096077, 73.81724025610355, 38.36576422795793, 43.647489707978515, 46.52026935397034, 93.26621465814303, 76.2636542323878, 134.9014753340326, 108.42266036054696, 69.87910761793835, 49.11391113459004, 84.43529524841412, 89.96663829775913, 107.98254946574035, 87.57881706107194, 84.22764077634127, 64.94020390962153, 84.30724050885577, 77.98316845443347, 2567.2205710954495, 1076.6654740765664, 30.863667251905653, 18.441252650973368, 94.9989511533628, 115.32435215137433, 17.13625646574953, 6.695403712985271, 65.350860053485, 65.57811846193324, 28.269444617461712, 24.106300190362543, 22.45283192023752, 13.468409768392936, 143.34356029455157, 135.29771276107596, 83.73308883360276, 95.2697617621893, 106.64044241117, 111.21031572056451, 139.56668666579202, 142.66759634515907, 30.51602971871452, 62.158603077193575, 97.4948763663496, 107.18446552241748, 43.32458682647863, 44.883070198578146, 82.24513292903904, 113.32253140581011, 141.72915433510732, 141.13463450495036, 35.582553479044805, 25.951943644980247, 79.027942567014, 63.41046266854534, 42.538286818263266, 83.64975959946594, 73.2621753143195, 50.28232588492058, 2.2953842762917667, 1.5960485883104705, 36.90895310730212, 37.48958374646535, 25.77694112782766, 43.579495433747994, 40.69360005091737, 42.76165818440984, 69.19796890258382, 44.26862123563013, 39.14199154476549, 107.60650047420444, 99.3630711331773, 154.52560129485516, 24.44152351008101, 18.31061645680644, 1.1700487801058987, 0.6868879157432783, 4.437858519313314, 11.910660107679279, 10.137459598264417, 0.0, 3.9839315453108397, 5.580738577359691, 44.66074011415748, 39.76751926671096, 18.68415332657902, 5.002156418876911, 12.755153632523493, 16.60581935174593, 65.9639007925816, 60.71753678402968, 157.47859123903217, 202.82491606972405, 19.25965138741843, 14.690544913714968, 18.29588787056436, 13.255739632371025, 34.11836229433656, 33.43743461425322, 23.823962813492695, 8.989015624945578, 11.929356667396876, 21.227273043594874, 7.793242845320549, 10.111556476631417, 22.68009834045877, 42.83510564864746, 4.101780871330873, 6.225661392631217, 14.05469513248447, 31.246200885385413, 28.038739268789698, 26.937624280398932, 21.627698002497347, 29.166055044769838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6604843440112895, "mean_inference_ms": 2.043028730400615, "mean_action_processing_ms": 0.28733155531346344, "mean_env_wait_ms": 0.2436242061066323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01862955093383789, "StateBufferConnector_ms": 0.015970945358276367, "ViewRequirementAgentConnector_ms": 0.1581404209136963}, "num_episodes": 22, "episode_return_max": 173.08999999999972, "episode_return_min": -18.97590696967267, "episode_return_mean": 72.61186305713989, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.50462789724276, "num_env_steps_trained_throughput_per_sec": 237.50462789724276, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 13643.96, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13643.914, "sample_time_ms": 1898.611, "learn_time_ms": 11728.665, "learn_throughput": 341.045, "synch_weights_time_ms": 15.31}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "ef79f_00000", "date": "2024-08-16_11-26-50", "timestamp": 1723787810, "time_this_iter_s": 16.891282320022583, "time_total_s": 586.9832239151001, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214ba670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 586.9832239151001, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 82.95, "ram_util_percent": 81.94166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8496564879303887, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8254666344198602, "policy_loss": -0.006542433064095873, "vf_loss": 2.830965721481061, "vf_explained_var": -0.06856652359483104, "kl": 0.006955685777216854, "entropy": 1.2540036627224513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.95855798115806, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.09733194220003, "policy_loss": -0.0020506920403845254, "vf_loss": 8.099154454690439, "vf_explained_var": -0.45245209818794613, "kl": 0.004563310165056375, "entropy": 0.36323583517125047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 212.9631188784557, "episode_reward_min": 1.4659744202388238, "episode_reward_mean": 76.2187353281429, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -3575.750050647578, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.2899999999999, "predator_policy": 2567.2205710954495}, "policy_reward_mean": {"prey_policy": -37.20307922950937, "predator_policy": 75.31244689358077}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.15026460153132, 90.76802647202689, 69.29009191094333, 58.572909026757856, 83.84185566844269, 102.84627708207962, 44.69092500236136, 18.60709544453115, 52.19194345756585, 134.15821438822053, 39.8417730146328, 52.334090734119755, 139.80033983746222, 102.42257588369185, 1.4659744202388238, 80.68040915198813, 14.296324099746553, 88.24378563359382, 91.15308451070976, 144.16384340497024, 65.74466354921938, 140.54197381435054, 148.59551374528425, 106.29928451475705, 114.31603259858832, 93.93216556287041, 71.26787019213066, 18.258740092527592, 133.5696698906205, 66.63104049296906, 60.10912176557231, 87.47139592120101, 10.395403712985194, 85.42129608794745, 17.273742789765166, 48.16013007652778, 133.66018230241704, 124.36041248738776, 80.92494463087904, 110.06467673498534, 50.34042670632515, 94.80564329610864, 117.40175692100841, 143.93645544927242, 110.57140862359014, 74.52286335913796, 89.2231312412751, 32.8343257722421, 88.49458229015966, 5.1596438138325915, 126.44956082323431, 22.452387467948633, 99.21539105190554, 119.73296954319034, 69.80065079922447, 72.47171282592612, 160.05364647881947, 4.636887915743223, 24.395890338669002, 173.08999999999972, 109.53922272137349, 90.72046956927537, 8.166421154138682, 28.45217983192858, 69.01469784086007, 105.45595029420296, 118.44313752636644, 18.257041628198447, 72.30588721225605, 130.0690149925573, 25.97935883707032, 24.655713467292827, 92.4444085951342, 7.349945676249317, 171.96810482716435, 42.243564335824374, 96.47510454745479, 138.59767754900724, 6.819298563152299, 87.13000000000007, 51.170530189625474, 3.6699999999999657, 3.9199999999999604, 108.79000000000076, 4.23969943261013, 45.85726953057273, 3.7299999999999645, 125.1867163287864, 92.28192094482895, 212.9631188784557, 3.8799999999999613, 3.6699999999999657, 90.72575339294761, 91.80117006154636, 18.273439911609234, 147.0127156994486, 114.66000000000024, 4.709999999999943, 146.64659984813807, 27.49000000000039], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-74.66681493799337, -85.80475090363608, -168.47954610615912, -92.89953564734282, -60.30373872504336, 0.6305321639701403, -46.24793819427044, -156.29751126019545, -267.6016459049109, 1.791159932473403, -150.66030164391654, -18.117419639161607, -107.656045996326, -58.24761472938309, -111.9078438892311, -141.07996327568682, -15.299168038151892, -110.47010895030232, -121.84100262633137, -59.04063366413622, -121.94224395524508, -142.43097623002888, -109.86364637861911, -6.996568960632022, -214.27351782867535, -97.31374995933558, -178.95002341201507, -44.19172446831839, -7.409330626898157, -8.094030387851253, -94.38894422560442, -11.961426193494482, -82.8465486788227, -118.07963319681357, -97.805286579919, -47.58193352813411, -96.44495275985237, -10.60297198412261, 0.16384416540344832, 19.103032246577307, -2.862713783857652, -43.57562715098452, 12.466301693326471, 37.90791305907503, 47.3989129813007, -68.33326812654704, 33.352050783517285, -170.37690196334034, 33.034259097065785, -37.71124525100637, -10.83806564046873, -69.63170234283423, -119.30933958219133, -4.984156752490248, -103.2094362870745, -27.699668306360373, -24.70232014594064, -4.0184189267281045, -1.5049540314706533, -3575.750050647578, 17.409983657289313, -6.605781794595988, 9.460991342461204, -132.3128987259974, -15.436256465749375, 2.0000000000000013, -18.139371098106768, -27.368311329363937, -16.48702180345864, -18.61498021460017, 26.126821471127524, -13.887933083230442, -57.19174256294474, -87.78934819026588, -5.8826065730895, -48.759831535315, -86.69717482284628, -50.22863867800953, -61.414089296461846, -110.75551697950394, -44.19979156679799, 1.8655854772151466, -82.90514093685753, -26.96855765580092, -27.46298726354679, 56.657087159497756, -84.15771583996806, 32.526506954391685, 13.38284498569464, -185.6752252021628, 23.529555594796655, -10.541189359684351, -1.061211164141155, -52.15406283014391, 2.0000000000000013, -95.3537206454872, -24.121352805746625, -10.928566103334106, -0.7317890507695906, 2.0000000000000013, 35.008004478250434, 17.043019491216, -23.476175874980964, -23.427873218646052, 15.726933443041844, 0.033199373535845185, 21.94407072489996, -15.677691319923902, -9.690530622554528, -67.25731059719101, -17.178602336887657, -164.23835726521835, 129.1652310517594, -11.86372453982733, 2.0000000000000013, 0.7799512198941027, 18.830000000000286, -10.782628288324204, -8.337459598264456, 171.2899999999999, 99.34926382431041, 0.6252887743919832, 23.494896116782286, -17.202685928376294, -13.404153326579046, -2.1157352647382015, 4.989640206014115, -5.898433358355457, -56.48944166581429, -1.1772980699373854, -278.62755701455313, 23.780000000000253, 1.7664587991831087, 82.72648242604961, 2.0000000000000013, -15.294585874737196, 35.19852810492404, -30.44843780125906, 57.44000000000001, 39.81603655411813, -6.113663743557514, -1.0636071303643768, -12.079085854659754, 18.830000000000286, 1.821151404027037, 25.108053202000576, -4.977496587712733, 2.0000000000000013, 111.43081602937349, 15.23639277992098, -10.17601445545479, -2.556784757909373, 29.662205431204868, 16.019146068981797, 94.35829929492591, -17.5749389390459, -3.412426617913609, -14.5915428114185, 84.35127447828359, 2.0000000000000013, 2.0000000000000013, 43.801867250671194, -1.4189801473080375, -4.07382325524733, 2.0000000000000013, -2.3398217552572866, 104.55180569234753, 1.6417614420957816, 0.7670097858109569, 2.0000000000000013, 20.20580936605974, 9.052765834839661, -0.05672956510595859, -3.5925736317406054, 102.47365365084389, -3.6557314117175626, 17.407623502534783, 47.626262998905, 93.12432241331639, 105.95, 2.0000000000000013, -0.866009548670867, -12.310278651735171, -0.4647774471702224, 62.30748283775869, 0.6929469186925271, -41.46427232847487, 38.87077516444501, -6.155559009883627, -23.83329400439985, -20.758713788989002, 88.95200836728871, 112.88000000000001, -4.085482871728329, 0.5044334675806129, -7.846196076225024, 18.82728944682163, 92.1760696416596, -2.7630381986158383, 19.89784083406878], "policy_predator_policy_reward": [118.53027745844147, 113.0915529847197, 173.49621529685473, 178.6508929286744, 67.68938448523112, 61.27391398678552, 150.7714435817777, 110.34691489944596, 122.29671372290383, 227.35562791797628, 110.76155105268724, 160.86244731247035, 84.38350007311186, 126.2110856549585, 111.31843978976677, 160.27646281968234, 111.51902752064153, 66.4421929253787, 141.98223773448336, 173.05761294420492, 139.79582573545622, 164.41916746445068, 75.17982378310657, 94.01448229026438, 196.97984326957268, 254.40776435590072, 188.65310521896475, 136.91121854506076, 2.069383589705036, 14.899951845283121, 105.00912248400417, 82.02165708708252, 82.38867458568123, 132.83383138970163, 99.85941477984115, 133.77159096180597, 100.41057883987386, 97.79043041481067, 56.24199552202833, 68.65497147096077, 73.81724025610355, 38.36576422795793, 43.647489707978515, 46.52026935397034, 93.26621465814303, 76.2636542323878, 134.9014753340326, 108.42266036054696, 69.87910761793835, 49.11391113459004, 84.43529524841412, 89.96663829775913, 107.98254946574035, 87.57881706107194, 84.22764077634127, 64.94020390962153, 84.30724050885577, 77.98316845443347, 2567.2205710954495, 1076.6654740765664, 30.863667251905653, 18.441252650973368, 94.9989511533628, 115.32435215137433, 17.13625646574953, 6.695403712985271, 65.350860053485, 65.57811846193324, 28.269444617461712, 24.106300190362543, 22.45283192023752, 13.468409768392936, 143.34356029455157, 135.29771276107596, 83.73308883360276, 95.2697617621893, 106.64044241117, 111.21031572056451, 139.56668666579202, 142.66759634515907, 30.51602971871452, 62.158603077193575, 97.4948763663496, 107.18446552241748, 43.32458682647863, 44.883070198578146, 82.24513292903904, 113.32253140581011, 141.72915433510732, 141.13463450495036, 35.582553479044805, 25.951943644980247, 79.027942567014, 63.41046266854534, 42.538286818263266, 83.64975959946594, 73.2621753143195, 50.28232588492058, 2.2953842762917667, 1.5960485883104705, 36.90895310730212, 37.48958374646535, 25.77694112782766, 43.579495433747994, 40.69360005091737, 42.76165818440984, 69.19796890258382, 44.26862123563013, 39.14199154476549, 107.60650047420444, 99.3630711331773, 154.52560129485516, 24.44152351008101, 18.31061645680644, 1.1700487801058987, 0.6868879157432783, 4.437858519313314, 11.910660107679279, 10.137459598264417, 0.0, 3.9839315453108397, 5.580738577359691, 44.66074011415748, 39.76751926671096, 18.68415332657902, 5.002156418876911, 12.755153632523493, 16.60581935174593, 65.9639007925816, 60.71753678402968, 157.47859123903217, 202.82491606972405, 19.25965138741843, 14.690544913714968, 18.29588787056436, 13.255739632371025, 34.11836229433656, 33.43743461425322, 23.823962813492695, 8.989015624945578, 11.929356667396876, 21.227273043594874, 7.793242845320549, 10.111556476631417, 22.68009834045877, 42.83510564864746, 4.101780871330873, 6.225661392631217, 14.05469513248447, 31.246200885385413, 28.038739268789698, 26.937624280398932, 21.627698002497347, 29.166055044769838, 28.977143140821337, 32.83717405230642, 15.547308802142219, 9.2759591903422, 0.7787255217164102, 0.0, 4.537492697558101, 0.8311702413964566, 5.863823255247292, 3.2989801473080105, 0.0, 4.259821755257246, 0.4834249189096827, 2.1130079466473113, 1.2029902141890445, 0.2696994326101758, 11.046977970396949, 5.551716359276805, 1.9767295651059602, 5.402573631740567, 14.510550068942123, 11.85824402071724, 11.995782675395665, 15.252251767992416, 6.708515096578796, 7.180281368561069, 2.746009548670855, 0.0, 15.15136113113936, 1.2936949677659983, 14.659860560042155, 13.065463076453197, 59.79066182475325, 34.60400540082133, 23.431910593399436, 24.830382332493137, 37.634824044058405, 41.18459707709097, 4.2671613982321155, 1.5983214734961788, 9.646196076224985, 2.405566532419388, 13.264554803999104, 22.378685955659787, 3.6121722698768255, 6.743025094670373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6660468816095773, "mean_inference_ms": 2.0549852111407896, "mean_action_processing_ms": 0.2885591981758098, "mean_env_wait_ms": 0.24472305004899497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022366762161254883, "StateBufferConnector_ms": 0.01581251621246338, "ViewRequirementAgentConnector_ms": 0.1566692590713501}, "num_episodes": 23, "episode_return_max": 212.9631188784557, "episode_return_min": 1.4659744202388238, "episode_return_mean": 76.2187353281429, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.0799902954044, "num_env_steps_trained_throughput_per_sec": 290.0799902954044, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 13805.165, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13805.118, "sample_time_ms": 1870.859, "learn_time_ms": 11917.231, "learn_throughput": 335.648, "synch_weights_time_ms": 15.499}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "ef79f_00000", "date": "2024-08-16_11-27-04", "timestamp": 1723787824, "time_this_iter_s": 13.839667797088623, "time_total_s": 600.8228917121887, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214acaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 600.8228917121887, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 63.452631578947376, "ram_util_percent": 82.28421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.205314570949191, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.761738057489748, "policy_loss": -0.008124819413448373, "vf_loss": 4.768199520640903, "vf_explained_var": -0.0016805589514434652, "kl": 0.011089105154165033, "entropy": 1.179668116569519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.28391257108204, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.018088081652525, "policy_loss": -0.0021314545880717337, "vf_loss": 8.019987544307002, "vf_explained_var": -0.32080256090593084, "kl": 0.009279665878131787, "entropy": 0.3612050916940447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 284.57668750165317, "episode_reward_min": 3.6699999999999657, "episode_reward_mean": 85.94330884650486, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -3575.750050647578, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.09, "predator_policy": 2567.2205710954495}, "policy_reward_mean": {"prey_policy": -12.845761343596472, "predator_policy": 55.817415766848825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.15308451070976, 144.16384340497024, 65.74466354921938, 140.54197381435054, 148.59551374528425, 106.29928451475705, 114.31603259858832, 93.93216556287041, 71.26787019213066, 18.258740092527592, 133.5696698906205, 66.63104049296906, 60.10912176557231, 87.47139592120101, 10.395403712985194, 85.42129608794745, 17.273742789765166, 48.16013007652778, 133.66018230241704, 124.36041248738776, 80.92494463087904, 110.06467673498534, 50.34042670632515, 94.80564329610864, 117.40175692100841, 143.93645544927242, 110.57140862359014, 74.52286335913796, 89.2231312412751, 32.8343257722421, 88.49458229015966, 5.1596438138325915, 126.44956082323431, 22.452387467948633, 99.21539105190554, 119.73296954319034, 69.80065079922447, 72.47171282592612, 160.05364647881947, 4.636887915743223, 24.395890338669002, 173.08999999999972, 109.53922272137349, 90.72046956927537, 8.166421154138682, 28.45217983192858, 69.01469784086007, 105.45595029420296, 118.44313752636644, 18.257041628198447, 72.30588721225605, 130.0690149925573, 25.97935883707032, 24.655713467292827, 92.4444085951342, 7.349945676249317, 171.96810482716435, 42.243564335824374, 96.47510454745479, 138.59767754900724, 6.819298563152299, 87.13000000000007, 51.170530189625474, 3.6699999999999657, 3.9199999999999604, 108.79000000000076, 4.23969943261013, 45.85726953057273, 3.7299999999999645, 125.1867163287864, 92.28192094482895, 212.9631188784557, 3.8799999999999613, 3.6699999999999657, 90.72575339294761, 91.80117006154636, 18.273439911609234, 147.0127156994486, 114.66000000000024, 4.709999999999943, 146.64659984813807, 27.49000000000039, 102.80000000000017, 136.4982987207794, 146.0311861206347, 249.72782157720573, 9.069626875514817, 105.43459336768142, 8.11316128442726, 141.77284742353964, 64.62206832166794, 284.57668750165317, 131.78451215929965, 162.0700000000001, 144.4300000000004, 19.67085885357711, 13.39880836960339, 5.471862451920351, 284.1875875130203, 208.00030712560448], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-96.44495275985237, -10.60297198412261, 0.16384416540344832, 19.103032246577307, -2.862713783857652, -43.57562715098452, 12.466301693326471, 37.90791305907503, 47.3989129813007, -68.33326812654704, 33.352050783517285, -170.37690196334034, 33.034259097065785, -37.71124525100637, -10.83806564046873, -69.63170234283423, -119.30933958219133, -4.984156752490248, -103.2094362870745, -27.699668306360373, -24.70232014594064, -4.0184189267281045, -1.5049540314706533, -3575.750050647578, 17.409983657289313, -6.605781794595988, 9.460991342461204, -132.3128987259974, -15.436256465749375, 2.0000000000000013, -18.139371098106768, -27.368311329363937, -16.48702180345864, -18.61498021460017, 26.126821471127524, -13.887933083230442, -57.19174256294474, -87.78934819026588, -5.8826065730895, -48.759831535315, -86.69717482284628, -50.22863867800953, -61.414089296461846, -110.75551697950394, -44.19979156679799, 1.8655854772151466, -82.90514093685753, -26.96855765580092, -27.46298726354679, 56.657087159497756, -84.15771583996806, 32.526506954391685, 13.38284498569464, -185.6752252021628, 23.529555594796655, -10.541189359684351, -1.061211164141155, -52.15406283014391, 2.0000000000000013, -95.3537206454872, -24.121352805746625, -10.928566103334106, -0.7317890507695906, 2.0000000000000013, 35.008004478250434, 17.043019491216, -23.476175874980964, -23.427873218646052, 15.726933443041844, 0.033199373535845185, 21.94407072489996, -15.677691319923902, -9.690530622554528, -67.25731059719101, -17.178602336887657, -164.23835726521835, 129.1652310517594, -11.86372453982733, 2.0000000000000013, 0.7799512198941027, 18.830000000000286, -10.782628288324204, -8.337459598264456, 171.2899999999999, 99.34926382431041, 0.6252887743919832, 23.494896116782286, -17.202685928376294, -13.404153326579046, -2.1157352647382015, 4.989640206014115, -5.898433358355457, -56.48944166581429, -1.1772980699373854, -278.62755701455313, 23.780000000000253, 1.7664587991831087, 82.72648242604961, 2.0000000000000013, -15.294585874737196, 35.19852810492404, -30.44843780125906, 57.44000000000001, 39.81603655411813, -6.113663743557514, -1.0636071303643768, -12.079085854659754, 18.830000000000286, 1.821151404027037, 25.108053202000576, -4.977496587712733, 2.0000000000000013, 111.43081602937349, 15.23639277992098, -10.17601445545479, -2.556784757909373, 29.662205431204868, 16.019146068981797, 94.35829929492591, -17.5749389390459, -3.412426617913609, -14.5915428114185, 84.35127447828359, 2.0000000000000013, 2.0000000000000013, 43.801867250671194, -1.4189801473080375, -4.07382325524733, 2.0000000000000013, -2.3398217552572866, 104.55180569234753, 1.6417614420957816, 0.7670097858109569, 2.0000000000000013, 20.20580936605974, 9.052765834839661, -0.05672956510595859, -3.5925736317406054, 102.47365365084389, -3.6557314117175626, 17.407623502534783, 47.626262998905, 93.12432241331639, 105.95, 2.0000000000000013, -0.866009548670867, -12.310278651735171, -0.4647774471702224, 62.30748283775869, 0.6929469186925271, -41.46427232847487, 38.87077516444501, -6.155559009883627, -23.83329400439985, -20.758713788989002, 88.95200836728871, 112.88000000000001, -4.085482871728329, 0.5044334675806129, -7.846196076225024, 18.82728944682163, 92.1760696416596, -2.7630381986158383, 19.89784083406878, -5.87823999755181, 100.62020568919066, 132.60668525302884, -1.923848338858488, 60.99856853814459, -18.38548497717751, 152.25626595242113, 14.611078284728364, 2.0000000000000013, -6.476959550196089, 56.48132086824456, 2.0000000000000013, 5.959999999999972, -1.5402164728254508, -9.788742848268253, 134.47670493021502, 37.63437507616188, -4.930402004187982, 115.59248183303067, 139.37809873762077, 16.55576334368862, 100.5094206455955, -3.7792321235248822, 157.06173177862502, 139.5067023494385, 2.0000000000000013, -27.05968570819808, 0.30029050721593425, 2.0000000000000013, -25.70345044467832, -7.829634600497068, -12.760060897774766, 40.07589149872553, 191.09, 98.1679833441348, 67.30648986996653], "policy_predator_policy_reward": [100.41057883987386, 97.79043041481067, 56.24199552202833, 68.65497147096077, 73.81724025610355, 38.36576422795793, 43.647489707978515, 46.52026935397034, 93.26621465814303, 76.2636542323878, 134.9014753340326, 108.42266036054696, 69.87910761793835, 49.11391113459004, 84.43529524841412, 89.96663829775913, 107.98254946574035, 87.57881706107194, 84.22764077634127, 64.94020390962153, 84.30724050885577, 77.98316845443347, 2567.2205710954495, 1076.6654740765664, 30.863667251905653, 18.441252650973368, 94.9989511533628, 115.32435215137433, 17.13625646574953, 6.695403712985271, 65.350860053485, 65.57811846193324, 28.269444617461712, 24.106300190362543, 22.45283192023752, 13.468409768392936, 143.34356029455157, 135.29771276107596, 83.73308883360276, 95.2697617621893, 106.64044241117, 111.21031572056451, 139.56668666579202, 142.66759634515907, 30.51602971871452, 62.158603077193575, 97.4948763663496, 107.18446552241748, 43.32458682647863, 44.883070198578146, 82.24513292903904, 113.32253140581011, 141.72915433510732, 141.13463450495036, 35.582553479044805, 25.951943644980247, 79.027942567014, 63.41046266854534, 42.538286818263266, 83.64975959946594, 73.2621753143195, 50.28232588492058, 2.2953842762917667, 1.5960485883104705, 36.90895310730212, 37.48958374646535, 25.77694112782766, 43.579495433747994, 40.69360005091737, 42.76165818440984, 69.19796890258382, 44.26862123563013, 39.14199154476549, 107.60650047420444, 99.3630711331773, 154.52560129485516, 24.44152351008101, 18.31061645680644, 1.1700487801058987, 0.6868879157432783, 4.437858519313314, 11.910660107679279, 10.137459598264417, 0.0, 3.9839315453108397, 5.580738577359691, 44.66074011415748, 39.76751926671096, 18.68415332657902, 5.002156418876911, 12.755153632523493, 16.60581935174593, 65.9639007925816, 60.71753678402968, 157.47859123903217, 202.82491606972405, 19.25965138741843, 14.690544913714968, 18.29588787056436, 13.255739632371025, 34.11836229433656, 33.43743461425322, 23.823962813492695, 8.989015624945578, 11.929356667396876, 21.227273043594874, 7.793242845320549, 10.111556476631417, 22.68009834045877, 42.83510564864746, 4.101780871330873, 6.225661392631217, 14.05469513248447, 31.246200885385413, 28.038739268789698, 26.937624280398932, 21.627698002497347, 29.166055044769838, 28.977143140821337, 32.83717405230642, 15.547308802142219, 9.2759591903422, 0.7787255217164102, 0.0, 4.537492697558101, 0.8311702413964566, 5.863823255247292, 3.2989801473080105, 0.0, 4.259821755257246, 0.4834249189096827, 2.1130079466473113, 1.2029902141890445, 0.2696994326101758, 11.046977970396949, 5.551716359276805, 1.9767295651059602, 5.402573631740567, 14.510550068942123, 11.85824402071724, 11.995782675395665, 15.252251767992416, 6.708515096578796, 7.180281368561069, 2.746009548670855, 0.0, 15.15136113113936, 1.2936949677659983, 14.659860560042155, 13.065463076453197, 59.79066182475325, 34.60400540082133, 23.431910593399436, 24.830382332493137, 37.634824044058405, 41.18459707709097, 4.2671613982321155, 1.5983214734961788, 9.646196076224985, 2.405566532419388, 13.264554803999104, 22.378685955659787, 3.6121722698768255, 6.743025094670373, 7.698239997551771, 0.35979431080934754, 4.3083963295815755, 1.5070654770272272, 55.82625218794762, 47.59185037172051, 39.837749622701224, 43.02272771735522, 7.994730619308082, 5.551855806402866, 25.564967660227754, 21.388304839208864, 3.4802164728254197, 0.21316128442731597, 5.580814934707749, 11.50407040688511, 10.067145741083, 21.850949508610846, 18.219891374186453, 11.386215556815847, 8.122291125661139, 6.5970370443540425, 3.1882682213750266, 5.5992321235248435, 2.9232976505615413, 0.0, 16.78171761816794, 29.648536436391094, 27.116878040428944, 9.985380773853079, 10.970583878327723, 15.090974071864458, 39.11302841866598, 13.908667595628868, 19.25149554351636, 23.274338367987703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6694727026378625, "mean_inference_ms": 2.067359723191205, "mean_action_processing_ms": 0.2894407038663215, "mean_env_wait_ms": 0.24611717827720728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021698713302612305, "StateBufferConnector_ms": 0.015713214874267578, "ViewRequirementAgentConnector_ms": 0.15514516830444336}, "num_episodes": 18, "episode_return_max": 284.57668750165317, "episode_return_min": 3.6699999999999657, "episode_return_mean": 85.94330884650486, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.52470866717476, "num_env_steps_trained_throughput_per_sec": 305.52470866717476, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 13863.899, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13863.851, "sample_time_ms": 1873.871, "learn_time_ms": 11973.137, "learn_throughput": 334.081, "synch_weights_time_ms": 15.145}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "ef79f_00000", "date": "2024-08-16_11-27-17", "timestamp": 1723787837, "time_this_iter_s": 13.150057077407837, "time_total_s": 613.9729487895966, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321437670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 613.9729487895966, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 60.26842105263159, "ram_util_percent": 82.48947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.906654488378101, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.820759729733543, "policy_loss": -0.006807986791763041, "vf_loss": 4.826040875596344, "vf_explained_var": 0.039082310565565, "kl": 0.010178822589340424, "entropy": 1.203948207254763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.145917219775063, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.66920876149778, "policy_loss": -0.0004229281770272387, "vf_loss": 7.669465482802618, "vf_explained_var": -0.3801323991603952, "kl": 0.006647663714353626, "entropy": 0.30326825109108413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 284.57668750165317, "episode_reward_min": 3.6699999999999657, "episode_reward_mean": 93.19532926967699, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -278.62755701455313, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.09, "predator_policy": 202.82491606972405}, "policy_reward_mean": {"prey_policy": 18.071059168476623, "predator_policy": 28.526605466361822}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.66018230241704, 124.36041248738776, 80.92494463087904, 110.06467673498534, 50.34042670632515, 94.80564329610864, 117.40175692100841, 143.93645544927242, 110.57140862359014, 74.52286335913796, 89.2231312412751, 32.8343257722421, 88.49458229015966, 5.1596438138325915, 126.44956082323431, 22.452387467948633, 99.21539105190554, 119.73296954319034, 69.80065079922447, 72.47171282592612, 160.05364647881947, 4.636887915743223, 24.395890338669002, 173.08999999999972, 109.53922272137349, 90.72046956927537, 8.166421154138682, 28.45217983192858, 69.01469784086007, 105.45595029420296, 118.44313752636644, 18.257041628198447, 72.30588721225605, 130.0690149925573, 25.97935883707032, 24.655713467292827, 92.4444085951342, 7.349945676249317, 171.96810482716435, 42.243564335824374, 96.47510454745479, 138.59767754900724, 6.819298563152299, 87.13000000000007, 51.170530189625474, 3.6699999999999657, 3.9199999999999604, 108.79000000000076, 4.23969943261013, 45.85726953057273, 3.7299999999999645, 125.1867163287864, 92.28192094482895, 212.9631188784557, 3.8799999999999613, 3.6699999999999657, 90.72575339294761, 91.80117006154636, 18.273439911609234, 147.0127156994486, 114.66000000000024, 4.709999999999943, 146.64659984813807, 27.49000000000039, 102.80000000000017, 136.4982987207794, 146.0311861206347, 249.72782157720573, 9.069626875514817, 105.43459336768142, 8.11316128442726, 141.77284742353964, 64.62206832166794, 284.57668750165317, 131.78451215929965, 162.0700000000001, 144.4300000000004, 19.67085885357711, 13.39880836960339, 5.471862451920351, 284.1875875130203, 208.00030712560448, 177.7648926932138, 100.4393504899617, 178.9303090969284, 167.64598584689853, 78.69295415147838, 156.23000000000008, 6.45599993729314, 6.046627964510479, 132.47724733149204, 166.34891237644834, 6.7156658161511436, 192.648860125031, 222.5280143579432, 92.94461303891445, 106.11325972040018, 245.28884335391234, 187.40308916605554, 3.8323895735784146], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-57.19174256294474, -87.78934819026588, -5.8826065730895, -48.759831535315, -86.69717482284628, -50.22863867800953, -61.414089296461846, -110.75551697950394, -44.19979156679799, 1.8655854772151466, -82.90514093685753, -26.96855765580092, -27.46298726354679, 56.657087159497756, -84.15771583996806, 32.526506954391685, 13.38284498569464, -185.6752252021628, 23.529555594796655, -10.541189359684351, -1.061211164141155, -52.15406283014391, 2.0000000000000013, -95.3537206454872, -24.121352805746625, -10.928566103334106, -0.7317890507695906, 2.0000000000000013, 35.008004478250434, 17.043019491216, -23.476175874980964, -23.427873218646052, 15.726933443041844, 0.033199373535845185, 21.94407072489996, -15.677691319923902, -9.690530622554528, -67.25731059719101, -17.178602336887657, -164.23835726521835, 129.1652310517594, -11.86372453982733, 2.0000000000000013, 0.7799512198941027, 18.830000000000286, -10.782628288324204, -8.337459598264456, 171.2899999999999, 99.34926382431041, 0.6252887743919832, 23.494896116782286, -17.202685928376294, -13.404153326579046, -2.1157352647382015, 4.989640206014115, -5.898433358355457, -56.48944166581429, -1.1772980699373854, -278.62755701455313, 23.780000000000253, 1.7664587991831087, 82.72648242604961, 2.0000000000000013, -15.294585874737196, 35.19852810492404, -30.44843780125906, 57.44000000000001, 39.81603655411813, -6.113663743557514, -1.0636071303643768, -12.079085854659754, 18.830000000000286, 1.821151404027037, 25.108053202000576, -4.977496587712733, 2.0000000000000013, 111.43081602937349, 15.23639277992098, -10.17601445545479, -2.556784757909373, 29.662205431204868, 16.019146068981797, 94.35829929492591, -17.5749389390459, -3.412426617913609, -14.5915428114185, 84.35127447828359, 2.0000000000000013, 2.0000000000000013, 43.801867250671194, -1.4189801473080375, -4.07382325524733, 2.0000000000000013, -2.3398217552572866, 104.55180569234753, 1.6417614420957816, 0.7670097858109569, 2.0000000000000013, 20.20580936605974, 9.052765834839661, -0.05672956510595859, -3.5925736317406054, 102.47365365084389, -3.6557314117175626, 17.407623502534783, 47.626262998905, 93.12432241331639, 105.95, 2.0000000000000013, -0.866009548670867, -12.310278651735171, -0.4647774471702224, 62.30748283775869, 0.6929469186925271, -41.46427232847487, 38.87077516444501, -6.155559009883627, -23.83329400439985, -20.758713788989002, 88.95200836728871, 112.88000000000001, -4.085482871728329, 0.5044334675806129, -7.846196076225024, 18.82728944682163, 92.1760696416596, -2.7630381986158383, 19.89784083406878, -5.87823999755181, 100.62020568919066, 132.60668525302884, -1.923848338858488, 60.99856853814459, -18.38548497717751, 152.25626595242113, 14.611078284728364, 2.0000000000000013, -6.476959550196089, 56.48132086824456, 2.0000000000000013, 5.959999999999972, -1.5402164728254508, -9.788742848268253, 134.47670493021502, 37.63437507616188, -4.930402004187982, 115.59248183303067, 139.37809873762077, 16.55576334368862, 100.5094206455955, -3.7792321235248822, 157.06173177862502, 139.5067023494385, 2.0000000000000013, -27.05968570819808, 0.30029050721593425, 2.0000000000000013, -25.70345044467832, -7.829634600497068, -12.760060897774766, 40.07589149872553, 191.09, 98.1679833441348, 67.30648986996653, 103.97000000000004, 44.513208674463606, 0.781999658797044, 81.3355133400231, 116.06639540559712, 21.111644095075594, 1.5207078898125532, 165.3499999999999, -11.48301736901877, 59.836962473378776, -2.860316587190259, 151.53304700898082, -2.7598178232451076, 2.0000000000000013, -1.6720608954413743, 2.0000000000000013, -2.0157130229795586, 80.53466847098844, 2.0000000000000013, 154.4952430207075, -1.6503711619987682, 3.922602614355028, -43.42739851090572, 116.84000000000009, 36.98630931517333, 134.2238194318685, 86.54062076139945, -1.0830243843663019, 101.9900000000001, -2.8002583132064265, 161.34475011411092, 81.2, 24.052399878141205, 134.79452164650252, 0.9868977934730327, 1.2005311893161044], "policy_predator_policy_reward": [143.34356029455157, 135.29771276107596, 83.73308883360276, 95.2697617621893, 106.64044241117, 111.21031572056451, 139.56668666579202, 142.66759634515907, 30.51602971871452, 62.158603077193575, 97.4948763663496, 107.18446552241748, 43.32458682647863, 44.883070198578146, 82.24513292903904, 113.32253140581011, 141.72915433510732, 141.13463450495036, 35.582553479044805, 25.951943644980247, 79.027942567014, 63.41046266854534, 42.538286818263266, 83.64975959946594, 73.2621753143195, 50.28232588492058, 2.2953842762917667, 1.5960485883104705, 36.90895310730212, 37.48958374646535, 25.77694112782766, 43.579495433747994, 40.69360005091737, 42.76165818440984, 69.19796890258382, 44.26862123563013, 39.14199154476549, 107.60650047420444, 99.3630711331773, 154.52560129485516, 24.44152351008101, 18.31061645680644, 1.1700487801058987, 0.6868879157432783, 4.437858519313314, 11.910660107679279, 10.137459598264417, 0.0, 3.9839315453108397, 5.580738577359691, 44.66074011415748, 39.76751926671096, 18.68415332657902, 5.002156418876911, 12.755153632523493, 16.60581935174593, 65.9639007925816, 60.71753678402968, 157.47859123903217, 202.82491606972405, 19.25965138741843, 14.690544913714968, 18.29588787056436, 13.255739632371025, 34.11836229433656, 33.43743461425322, 23.823962813492695, 8.989015624945578, 11.929356667396876, 21.227273043594874, 7.793242845320549, 10.111556476631417, 22.68009834045877, 42.83510564864746, 4.101780871330873, 6.225661392631217, 14.05469513248447, 31.246200885385413, 28.038739268789698, 26.937624280398932, 21.627698002497347, 29.166055044769838, 28.977143140821337, 32.83717405230642, 15.547308802142219, 9.2759591903422, 0.7787255217164102, 0.0, 4.537492697558101, 0.8311702413964566, 5.863823255247292, 3.2989801473080105, 0.0, 4.259821755257246, 0.4834249189096827, 2.1130079466473113, 1.2029902141890445, 0.2696994326101758, 11.046977970396949, 5.551716359276805, 1.9767295651059602, 5.402573631740567, 14.510550068942123, 11.85824402071724, 11.995782675395665, 15.252251767992416, 6.708515096578796, 7.180281368561069, 2.746009548670855, 0.0, 15.15136113113936, 1.2936949677659983, 14.659860560042155, 13.065463076453197, 59.79066182475325, 34.60400540082133, 23.431910593399436, 24.830382332493137, 37.634824044058405, 41.18459707709097, 4.2671613982321155, 1.5983214734961788, 9.646196076224985, 2.405566532419388, 13.264554803999104, 22.378685955659787, 3.6121722698768255, 6.743025094670373, 7.698239997551771, 0.35979431080934754, 4.3083963295815755, 1.5070654770272272, 55.82625218794762, 47.59185037172051, 39.837749622701224, 43.02272771735522, 7.994730619308082, 5.551855806402866, 25.564967660227754, 21.388304839208864, 3.4802164728254197, 0.21316128442731597, 5.580814934707749, 11.50407040688511, 10.067145741083, 21.850949508610846, 18.219891374186453, 11.386215556815847, 8.122291125661139, 6.5970370443540425, 3.1882682213750266, 5.5992321235248435, 2.9232976505615413, 0.0, 16.78171761816794, 29.648536436391094, 27.116878040428944, 9.985380773853079, 10.970583878327723, 15.090974071864458, 39.11302841866598, 13.908667595628868, 19.25149554351636, 23.274338367987703, 11.442656404769362, 17.839027613981344, 10.82203405562268, 7.499803435518434, 30.44365683931954, 11.308612756936931, 0.3159858468987675, 0.4592921101874482, 15.456446934719244, 14.88256211239835, 4.750316587190219, 2.80695299101922, 3.8271977602586773, 3.38862000027961, 3.511061689778354, 2.207627170173547, 32.516128139931595, 21.442163743551404, 0.17891237644856028, 9.674756979292404, 0.4803153221648965, 3.963119041629994, 49.242093791305976, 69.9941648446308, 30.161984794874474, 21.15590081602759, 3.0365639458548803, 4.450452716026245, 3.9832861393785355, 2.9402318942276953, 1.9452498858890501, 0.7988433539121895, 16.70195123205704, 11.854216409355157, 0.769468810683897, 0.8754917801054208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6730991799847267, "mean_inference_ms": 2.078698785673799, "mean_action_processing_ms": 0.29026351572989023, "mean_env_wait_ms": 0.24716920460967898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01102900505065918, "StateBufferConnector_ms": 0.015442371368408203, "ViewRequirementAgentConnector_ms": 0.14784014225006104}, "num_episodes": 18, "episode_return_max": 284.57668750165317, "episode_return_min": 3.6699999999999657, "episode_return_mean": 93.19532926967699, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.7989449922013, "num_env_steps_trained_throughput_per_sec": 293.7989449922013, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 13893.624, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13893.568, "sample_time_ms": 1843.756, "learn_time_ms": 12029.901, "learn_throughput": 332.505, "synch_weights_time_ms": 18.073}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "ef79f_00000", "date": "2024-08-16_11-27-31", "timestamp": 1723787851, "time_this_iter_s": 13.681875944137573, "time_total_s": 627.6548247337341, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 627.6548247337341, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 59.754999999999995, "ram_util_percent": 82.565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3188486793053844, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.581339077344016, "policy_loss": -0.008773701046667401, "vf_loss": 4.588722613627318, "vf_explained_var": 0.09100830274284201, "kl": 0.009267745281353374, "entropy": 1.185010660451556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.609288499721144, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.078189533223551, "policy_loss": -0.0027502235602932397, "vf_loss": 7.080568332268448, "vf_explained_var": -0.289694601612747, "kl": 0.0148576052283796, "entropy": 0.3199760460348987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 294.86242375344307, "episode_reward_min": 3.6699999999999657, "episode_reward_mean": 100.01414843881047, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -278.62755701455313, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.09, "predator_policy": 202.82491606972405}, "policy_reward_mean": {"prey_policy": 31.454793012898254, "predator_policy": 18.55228120650695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.80065079922447, 72.47171282592612, 160.05364647881947, 4.636887915743223, 24.395890338669002, 173.08999999999972, 109.53922272137349, 90.72046956927537, 8.166421154138682, 28.45217983192858, 69.01469784086007, 105.45595029420296, 118.44313752636644, 18.257041628198447, 72.30588721225605, 130.0690149925573, 25.97935883707032, 24.655713467292827, 92.4444085951342, 7.349945676249317, 171.96810482716435, 42.243564335824374, 96.47510454745479, 138.59767754900724, 6.819298563152299, 87.13000000000007, 51.170530189625474, 3.6699999999999657, 3.9199999999999604, 108.79000000000076, 4.23969943261013, 45.85726953057273, 3.7299999999999645, 125.1867163287864, 92.28192094482895, 212.9631188784557, 3.8799999999999613, 3.6699999999999657, 90.72575339294761, 91.80117006154636, 18.273439911609234, 147.0127156994486, 114.66000000000024, 4.709999999999943, 146.64659984813807, 27.49000000000039, 102.80000000000017, 136.4982987207794, 146.0311861206347, 249.72782157720573, 9.069626875514817, 105.43459336768142, 8.11316128442726, 141.77284742353964, 64.62206832166794, 284.57668750165317, 131.78451215929965, 162.0700000000001, 144.4300000000004, 19.67085885357711, 13.39880836960339, 5.471862451920351, 284.1875875130203, 208.00030712560448, 177.7648926932138, 100.4393504899617, 178.9303090969284, 167.64598584689853, 78.69295415147838, 156.23000000000008, 6.45599993729314, 6.046627964510479, 132.47724733149204, 166.34891237644834, 6.7156658161511436, 192.648860125031, 222.5280143579432, 92.94461303891445, 106.11325972040018, 245.28884335391234, 187.40308916605554, 3.8323895735784146, 23.735705101961504, 4.909999999999939, 201.5021953293135, 65.45802036772413, 294.86242375344307, 174.85117319487813, 3.93999999999996, 135.26797913340835, 119.28450237879017, 124.92699500841272, 242.29000000000008, 5.240097235517029, 272.15554492499905, 6.284943428443329, 121.25521455735206, 264.6826794186077, 240.8613926782767, 4.523812917119268], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.690530622554528, -67.25731059719101, -17.178602336887657, -164.23835726521835, 129.1652310517594, -11.86372453982733, 2.0000000000000013, 0.7799512198941027, 18.830000000000286, -10.782628288324204, -8.337459598264456, 171.2899999999999, 99.34926382431041, 0.6252887743919832, 23.494896116782286, -17.202685928376294, -13.404153326579046, -2.1157352647382015, 4.989640206014115, -5.898433358355457, -56.48944166581429, -1.1772980699373854, -278.62755701455313, 23.780000000000253, 1.7664587991831087, 82.72648242604961, 2.0000000000000013, -15.294585874737196, 35.19852810492404, -30.44843780125906, 57.44000000000001, 39.81603655411813, -6.113663743557514, -1.0636071303643768, -12.079085854659754, 18.830000000000286, 1.821151404027037, 25.108053202000576, -4.977496587712733, 2.0000000000000013, 111.43081602937349, 15.23639277992098, -10.17601445545479, -2.556784757909373, 29.662205431204868, 16.019146068981797, 94.35829929492591, -17.5749389390459, -3.412426617913609, -14.5915428114185, 84.35127447828359, 2.0000000000000013, 2.0000000000000013, 43.801867250671194, -1.4189801473080375, -4.07382325524733, 2.0000000000000013, -2.3398217552572866, 104.55180569234753, 1.6417614420957816, 0.7670097858109569, 2.0000000000000013, 20.20580936605974, 9.052765834839661, -0.05672956510595859, -3.5925736317406054, 102.47365365084389, -3.6557314117175626, 17.407623502534783, 47.626262998905, 93.12432241331639, 105.95, 2.0000000000000013, -0.866009548670867, -12.310278651735171, -0.4647774471702224, 62.30748283775869, 0.6929469186925271, -41.46427232847487, 38.87077516444501, -6.155559009883627, -23.83329400439985, -20.758713788989002, 88.95200836728871, 112.88000000000001, -4.085482871728329, 0.5044334675806129, -7.846196076225024, 18.82728944682163, 92.1760696416596, -2.7630381986158383, 19.89784083406878, -5.87823999755181, 100.62020568919066, 132.60668525302884, -1.923848338858488, 60.99856853814459, -18.38548497717751, 152.25626595242113, 14.611078284728364, 2.0000000000000013, -6.476959550196089, 56.48132086824456, 2.0000000000000013, 5.959999999999972, -1.5402164728254508, -9.788742848268253, 134.47670493021502, 37.63437507616188, -4.930402004187982, 115.59248183303067, 139.37809873762077, 16.55576334368862, 100.5094206455955, -3.7792321235248822, 157.06173177862502, 139.5067023494385, 2.0000000000000013, -27.05968570819808, 0.30029050721593425, 2.0000000000000013, -25.70345044467832, -7.829634600497068, -12.760060897774766, 40.07589149872553, 191.09, 98.1679833441348, 67.30648986996653, 103.97000000000004, 44.513208674463606, 0.781999658797044, 81.3355133400231, 116.06639540559712, 21.111644095075594, 1.5207078898125532, 165.3499999999999, -11.48301736901877, 59.836962473378776, -2.860316587190259, 151.53304700898082, -2.7598178232451076, 2.0000000000000013, -1.6720608954413743, 2.0000000000000013, -2.0157130229795586, 80.53466847098844, 2.0000000000000013, 154.4952430207075, -1.6503711619987682, 3.922602614355028, -43.42739851090572, 116.84000000000009, 36.98630931517333, 134.2238194318685, 86.54062076139945, -1.0830243843663019, 101.9900000000001, -2.8002583132064265, 161.34475011411092, 81.2, 24.052399878141205, 134.79452164650252, 0.9868977934730327, 1.2005311893161044, 2.98999999999998, -2.1921362363284853, 2.0000000000000013, 1.5226157239413, 26.75000000000018, 169.47722828874385, -2.469484218226616, -5.736935841856948, 96.83600236285976, 154.05174403338935, -43.39439822319629, 165.35000000000008, 1.4292786871929306, 0.39976587607142483, 9.655151559613454, 81.25502455163499, -17.304912612786612, 43.074386998260316, 114.61103570970845, -34.77377385997185, 153.07073851590275, 79.87179517456627, -0.1933543799257753, 2.0000000000000013, 171.74029967380102, 23.493871290484332, -3.537895346583002, 1.199590485258525, 107.21438342453166, 0.6368639129969408, 119.03114815117128, 128.11821179759397, -35.79310216508726, 167.33000000000007, 2.0000000000000013, 1.1884337566763217], "policy_predator_policy_reward": [39.14199154476549, 107.60650047420444, 99.3630711331773, 154.52560129485516, 24.44152351008101, 18.31061645680644, 1.1700487801058987, 0.6868879157432783, 4.437858519313314, 11.910660107679279, 10.137459598264417, 0.0, 3.9839315453108397, 5.580738577359691, 44.66074011415748, 39.76751926671096, 18.68415332657902, 5.002156418876911, 12.755153632523493, 16.60581935174593, 65.9639007925816, 60.71753678402968, 157.47859123903217, 202.82491606972405, 19.25965138741843, 14.690544913714968, 18.29588787056436, 13.255739632371025, 34.11836229433656, 33.43743461425322, 23.823962813492695, 8.989015624945578, 11.929356667396876, 21.227273043594874, 7.793242845320549, 10.111556476631417, 22.68009834045877, 42.83510564864746, 4.101780871330873, 6.225661392631217, 14.05469513248447, 31.246200885385413, 28.038739268789698, 26.937624280398932, 21.627698002497347, 29.166055044769838, 28.977143140821337, 32.83717405230642, 15.547308802142219, 9.2759591903422, 0.7787255217164102, 0.0, 4.537492697558101, 0.8311702413964566, 5.863823255247292, 3.2989801473080105, 0.0, 4.259821755257246, 0.4834249189096827, 2.1130079466473113, 1.2029902141890445, 0.2696994326101758, 11.046977970396949, 5.551716359276805, 1.9767295651059602, 5.402573631740567, 14.510550068942123, 11.85824402071724, 11.995782675395665, 15.252251767992416, 6.708515096578796, 7.180281368561069, 2.746009548670855, 0.0, 15.15136113113936, 1.2936949677659983, 14.659860560042155, 13.065463076453197, 59.79066182475325, 34.60400540082133, 23.431910593399436, 24.830382332493137, 37.634824044058405, 41.18459707709097, 4.2671613982321155, 1.5983214734961788, 9.646196076224985, 2.405566532419388, 13.264554803999104, 22.378685955659787, 3.6121722698768255, 6.743025094670373, 7.698239997551771, 0.35979431080934754, 4.3083963295815755, 1.5070654770272272, 55.82625218794762, 47.59185037172051, 39.837749622701224, 43.02272771735522, 7.994730619308082, 5.551855806402866, 25.564967660227754, 21.388304839208864, 3.4802164728254197, 0.21316128442731597, 5.580814934707749, 11.50407040688511, 10.067145741083, 21.850949508610846, 18.219891374186453, 11.386215556815847, 8.122291125661139, 6.5970370443540425, 3.1882682213750266, 5.5992321235248435, 2.9232976505615413, 0.0, 16.78171761816794, 29.648536436391094, 27.116878040428944, 9.985380773853079, 10.970583878327723, 15.090974071864458, 39.11302841866598, 13.908667595628868, 19.25149554351636, 23.274338367987703, 11.442656404769362, 17.839027613981344, 10.82203405562268, 7.499803435518434, 30.44365683931954, 11.308612756936931, 0.3159858468987675, 0.4592921101874482, 15.456446934719244, 14.88256211239835, 4.750316587190219, 2.80695299101922, 3.8271977602586773, 3.38862000027961, 3.511061689778354, 2.207627170173547, 32.516128139931595, 21.442163743551404, 0.17891237644856028, 9.674756979292404, 0.4803153221648965, 3.963119041629994, 49.242093791305976, 69.9941648446308, 30.161984794874474, 21.15590081602759, 3.0365639458548803, 4.450452716026245, 3.9832861393785355, 2.9402318942276953, 1.9452498858890501, 0.7988433539121895, 16.70195123205704, 11.854216409355157, 0.769468810683897, 0.8754917801054208, 6.6713201471682115, 16.266521191121353, 1.3873842760587012, 0.0, 4.582771711256142, 0.6921953293139251, 29.062031952007736, 44.602408475799386, 31.13752546211195, 12.837151895082165, 50.38439822319608, 2.511173194878612, 0.5507213128070707, 1.5602341239285766, 33.06685667148969, 11.29094635066991, 44.5112230471545, 49.00380494616168, 5.0135156369448115, 40.076217521730506, 4.048024570287801, 5.299441739243191, 2.143354379925774, 1.290097235517098, 36.50991866941296, 40.41145529130082, 4.784156288443546, 3.8390920013243024, 4.661739143563592, 8.742228076259162, 7.875994196578097, 9.657325273264856, 38.45326058850276, 70.87123425486125, 0.5733647623744232, 0.7620143980685766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.677747235124754, "mean_inference_ms": 2.0920524289405806, "mean_action_processing_ms": 0.2912995463797603, "mean_env_wait_ms": 0.24853974134597168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01051175594329834, "StateBufferConnector_ms": 0.015352487564086914, "ViewRequirementAgentConnector_ms": 0.19923055171966553}, "num_episodes": 18, "episode_return_max": 294.86242375344307, "episode_return_min": 3.6699999999999657, "episode_return_mean": 100.01414843881047, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.10835923397536, "num_env_steps_trained_throughput_per_sec": 312.10835923397536, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 13919.433, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13919.377, "sample_time_ms": 1883.977, "learn_time_ms": 12014.732, "learn_throughput": 332.925, "synch_weights_time_ms": 18.85}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "ef79f_00000", "date": "2024-08-16_11-27-44", "timestamp": 1723787864, "time_this_iter_s": 12.94472885131836, "time_total_s": 640.5995535850525, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32147fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 640.5995535850525, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 53.96666666666666, "ram_util_percent": 82.65555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.31960428420198, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.400562004311375, "policy_loss": -0.011677341872244758, "vf_loss": 7.409427173806246, "vf_explained_var": 0.20571770040446488, "kl": 0.018747814752701316, "entropy": 1.066569571015696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.707948642433005, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.764841010330846, "policy_loss": -0.0007369678424395345, "vf_loss": 5.765247384076396, "vf_explained_var": -0.04329414569511615, "kl": 0.013223407529289102, "entropy": 0.371042852395426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 307.29615168179384, "episode_reward_min": 2.0477216440775443, "episode_reward_mean": 121.40249848631557, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -94.21236937139898, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.09, "predator_policy": 110.45826979111169}, "policy_reward_mean": {"prey_policy": 45.18756219917328, "predator_policy": 15.513687043984492}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.47510454745479, 138.59767754900724, 6.819298563152299, 87.13000000000007, 51.170530189625474, 3.6699999999999657, 3.9199999999999604, 108.79000000000076, 4.23969943261013, 45.85726953057273, 3.7299999999999645, 125.1867163287864, 92.28192094482895, 212.9631188784557, 3.8799999999999613, 3.6699999999999657, 90.72575339294761, 91.80117006154636, 18.273439911609234, 147.0127156994486, 114.66000000000024, 4.709999999999943, 146.64659984813807, 27.49000000000039, 102.80000000000017, 136.4982987207794, 146.0311861206347, 249.72782157720573, 9.069626875514817, 105.43459336768142, 8.11316128442726, 141.77284742353964, 64.62206832166794, 284.57668750165317, 131.78451215929965, 162.0700000000001, 144.4300000000004, 19.67085885357711, 13.39880836960339, 5.471862451920351, 284.1875875130203, 208.00030712560448, 177.7648926932138, 100.4393504899617, 178.9303090969284, 167.64598584689853, 78.69295415147838, 156.23000000000008, 6.45599993729314, 6.046627964510479, 132.47724733149204, 166.34891237644834, 6.7156658161511436, 192.648860125031, 222.5280143579432, 92.94461303891445, 106.11325972040018, 245.28884335391234, 187.40308916605554, 3.8323895735784146, 23.735705101961504, 4.909999999999939, 201.5021953293135, 65.45802036772413, 294.86242375344307, 174.85117319487813, 3.93999999999996, 135.26797913340835, 119.28450237879017, 124.92699500841272, 242.29000000000008, 5.240097235517029, 272.15554492499905, 6.284943428443329, 121.25521455735206, 264.6826794186077, 240.8613926782767, 4.523812917119268, 37.53500302817201, 223.35962421813232, 251.17569472783782, 167.05158569320008, 298.5325329541538, 273.1542939985155, 174.56873223469995, 11.75944394918875, 184.0124872284382, 106.44437735276732, 292.45699963199803, 160.89999999999998, 3.9499999999999598, 152.6334712730049, 245.39184334308243, 101.88824358499066, 113.52831139190063, 109.86990181549045, 2.0477216440775443, 297.88174860073, 307.29615168179384, 242.91074326660973], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [29.662205431204868, 16.019146068981797, 94.35829929492591, -17.5749389390459, -3.412426617913609, -14.5915428114185, 84.35127447828359, 2.0000000000000013, 2.0000000000000013, 43.801867250671194, -1.4189801473080375, -4.07382325524733, 2.0000000000000013, -2.3398217552572866, 104.55180569234753, 1.6417614420957816, 0.7670097858109569, 2.0000000000000013, 20.20580936605974, 9.052765834839661, -0.05672956510595859, -3.5925736317406054, 102.47365365084389, -3.6557314117175626, 17.407623502534783, 47.626262998905, 93.12432241331639, 105.95, 2.0000000000000013, -0.866009548670867, -12.310278651735171, -0.4647774471702224, 62.30748283775869, 0.6929469186925271, -41.46427232847487, 38.87077516444501, -6.155559009883627, -23.83329400439985, -20.758713788989002, 88.95200836728871, 112.88000000000001, -4.085482871728329, 0.5044334675806129, -7.846196076225024, 18.82728944682163, 92.1760696416596, -2.7630381986158383, 19.89784083406878, -5.87823999755181, 100.62020568919066, 132.60668525302884, -1.923848338858488, 60.99856853814459, -18.38548497717751, 152.25626595242113, 14.611078284728364, 2.0000000000000013, -6.476959550196089, 56.48132086824456, 2.0000000000000013, 5.959999999999972, -1.5402164728254508, -9.788742848268253, 134.47670493021502, 37.63437507616188, -4.930402004187982, 115.59248183303067, 139.37809873762077, 16.55576334368862, 100.5094206455955, -3.7792321235248822, 157.06173177862502, 139.5067023494385, 2.0000000000000013, -27.05968570819808, 0.30029050721593425, 2.0000000000000013, -25.70345044467832, -7.829634600497068, -12.760060897774766, 40.07589149872553, 191.09, 98.1679833441348, 67.30648986996653, 103.97000000000004, 44.513208674463606, 0.781999658797044, 81.3355133400231, 116.06639540559712, 21.111644095075594, 1.5207078898125532, 165.3499999999999, -11.48301736901877, 59.836962473378776, -2.860316587190259, 151.53304700898082, -2.7598178232451076, 2.0000000000000013, -1.6720608954413743, 2.0000000000000013, -2.0157130229795586, 80.53466847098844, 2.0000000000000013, 154.4952430207075, -1.6503711619987682, 3.922602614355028, -43.42739851090572, 116.84000000000009, 36.98630931517333, 134.2238194318685, 86.54062076139945, -1.0830243843663019, 101.9900000000001, -2.8002583132064265, 161.34475011411092, 81.2, 24.052399878141205, 134.79452164650252, 0.9868977934730327, 1.2005311893161044, 2.98999999999998, -2.1921362363284853, 2.0000000000000013, 1.5226157239413, 26.75000000000018, 169.47722828874385, -2.469484218226616, -5.736935841856948, 96.83600236285976, 154.05174403338935, -43.39439822319629, 165.35000000000008, 1.4292786871929306, 0.39976587607142483, 9.655151559613454, 81.25502455163499, -17.304912612786612, 43.074386998260316, 114.61103570970845, -34.77377385997185, 153.07073851590275, 79.87179517456627, -0.1933543799257753, 2.0000000000000013, 171.74029967380102, 23.493871290484332, -3.537895346583002, 1.199590485258525, 107.21438342453166, 0.6368639129969408, 119.03114815117128, 128.11821179759397, -35.79310216508726, 167.33000000000007, 2.0000000000000013, 1.1884337566763217, -20.448867291580314, 1.3698630869766746, 185.14999999999995, -94.21236937139898, 69.30013463238774, 166.3400000000001, 157.43000000000018, -12.833578982007676, 142.32275239029207, 143.2573195028524, 109.10251693924525, 159.67041197138678, 118.82000000000002, 20.144056849672236, 2.0000000000000013, -13.745958476272536, -3.6207306384902678, 178.21999999999997, 14.37850428179714, 2.0000000000000013, 188.11999999999995, 82.47416348918114, -0.09287613207890161, 142.59966111775083, 0.8353341610024397, 1.7908647989064483, -0.36458587306109225, 149.51000000000005, 114.15343573162724, 112.13415471239523, 2.0000000000000013, 41.418806443155695, 2.0000000000000013, 38.950477435499614, -67.77747216078005, 12.203924758139147, -14.787570694012185, -3.4751763836022462, 174.26, 84.2876376962456, 147.3113914948018, 146.97787350256252, 101.9343346728875, 86.15000000000005], "policy_predator_policy_reward": [21.627698002497347, 29.166055044769838, 28.977143140821337, 32.83717405230642, 15.547308802142219, 9.2759591903422, 0.7787255217164102, 0.0, 4.537492697558101, 0.8311702413964566, 5.863823255247292, 3.2989801473080105, 0.0, 4.259821755257246, 0.4834249189096827, 2.1130079466473113, 1.2029902141890445, 0.2696994326101758, 11.046977970396949, 5.551716359276805, 1.9767295651059602, 5.402573631740567, 14.510550068942123, 11.85824402071724, 11.995782675395665, 15.252251767992416, 6.708515096578796, 7.180281368561069, 2.746009548670855, 0.0, 15.15136113113936, 1.2936949677659983, 14.659860560042155, 13.065463076453197, 59.79066182475325, 34.60400540082133, 23.431910593399436, 24.830382332493137, 37.634824044058405, 41.18459707709097, 4.2671613982321155, 1.5983214734961788, 9.646196076224985, 2.405566532419388, 13.264554803999104, 22.378685955659787, 3.6121722698768255, 6.743025094670373, 7.698239997551771, 0.35979431080934754, 4.3083963295815755, 1.5070654770272272, 55.82625218794762, 47.59185037172051, 39.837749622701224, 43.02272771735522, 7.994730619308082, 5.551855806402866, 25.564967660227754, 21.388304839208864, 3.4802164728254197, 0.21316128442731597, 5.580814934707749, 11.50407040688511, 10.067145741083, 21.850949508610846, 18.219891374186453, 11.386215556815847, 8.122291125661139, 6.5970370443540425, 3.1882682213750266, 5.5992321235248435, 2.9232976505615413, 0.0, 16.78171761816794, 29.648536436391094, 27.116878040428944, 9.985380773853079, 10.970583878327723, 15.090974071864458, 39.11302841866598, 13.908667595628868, 19.25149554351636, 23.274338367987703, 11.442656404769362, 17.839027613981344, 10.82203405562268, 7.499803435518434, 30.44365683931954, 11.308612756936931, 0.3159858468987675, 0.4592921101874482, 15.456446934719244, 14.88256211239835, 4.750316587190219, 2.80695299101922, 3.8271977602586773, 3.38862000027961, 3.511061689778354, 2.207627170173547, 32.516128139931595, 21.442163743551404, 0.17891237644856028, 9.674756979292404, 0.4803153221648965, 3.963119041629994, 49.242093791305976, 69.9941648446308, 30.161984794874474, 21.15590081602759, 3.0365639458548803, 4.450452716026245, 3.9832861393785355, 2.9402318942276953, 1.9452498858890501, 0.7988433539121895, 16.70195123205704, 11.854216409355157, 0.769468810683897, 0.8754917801054208, 6.6713201471682115, 16.266521191121353, 1.3873842760587012, 0.0, 4.582771711256142, 0.6921953293139251, 29.062031952007736, 44.602408475799386, 31.13752546211195, 12.837151895082165, 50.38439822319608, 2.511173194878612, 0.5507213128070707, 1.5602341239285766, 33.06685667148969, 11.29094635066991, 44.5112230471545, 49.00380494616168, 5.0135156369448115, 40.076217521730506, 4.048024570287801, 5.299441739243191, 2.143354379925774, 1.290097235517098, 36.50991866941296, 40.41145529130082, 4.784156288443546, 3.8390920013243024, 4.661739143563592, 8.742228076259162, 7.875994196578097, 9.657325273264856, 38.45326058850276, 70.87123425486125, 0.5733647623744232, 0.7620143980685766, 13.821014698093819, 42.79299253468226, 110.45826979111169, 21.963723798420236, 9.17143127991895, 6.364128815531192, 9.958673809473668, 12.496490865733826, 3.0951247276227742, 9.857336333386744, 0.4785440990495109, 3.9028209888339616, 13.213123307148075, 22.39155207788027, 8.316369194060984, 15.189033231400341, 5.39638998800618, 4.016827878922505, 43.97761570118028, 46.08825736978939, 1.4730443254105008, 20.389791817406625, 16.400338882249184, 1.9928761320789032, 1.1246658389975617, 0.1991352010935531, 2.2882578003880023, 1.1997993456777072, 19.104252899060235, 0.0, 37.01849776347515, 21.450939378359553, 35.74831139189967, 36.82952256450021, 70.99732133610404, 94.44612788202748, 3.548374826500162, 16.762093895191793, 23.843103650495696, 15.491007253989148, 0.36706024558479056, 12.639826438844945, 32.71142399340381, 22.11498460031848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6831266560441351, "mean_inference_ms": 2.105658915427147, "mean_action_processing_ms": 0.2926895834367963, "mean_env_wait_ms": 0.25022728222480883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008219003677368164, "StateBufferConnector_ms": 0.0038601160049438477, "ViewRequirementAgentConnector_ms": 0.22539258003234863}, "num_episodes": 22, "episode_return_max": 307.29615168179384, "episode_return_min": 2.0477216440775443, "episode_return_mean": 121.40249848631557, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.2399745534491, "num_env_steps_trained_throughput_per_sec": 281.2399745534491, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 13750.364, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13750.306, "sample_time_ms": 2009.619, "learn_time_ms": 11717.11, "learn_throughput": 341.381, "synch_weights_time_ms": 22.045}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "ef79f_00000", "date": "2024-08-16_11-27-58", "timestamp": 1723787878, "time_this_iter_s": 14.274209976196289, "time_total_s": 654.8737635612488, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214bad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 654.8737635612488, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 61.05238095238096, "ram_util_percent": 81.9952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6344489416748127, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.700254102232595, "policy_loss": -0.006986295609000735, "vf_loss": 6.705619625565867, "vf_explained_var": 0.24598645211527587, "kl": 0.010805067516568794, "entropy": 1.0720599792937122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.716230493058603, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.1853623460840295, "policy_loss": -0.00360597021417032, "vf_loss": 5.188812528590046, "vf_explained_var": -0.0018183645432588284, "kl": 0.0062314074077732, "entropy": 0.3974798410342484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 335.588730389149, "episode_reward_min": 2.0477216440775443, "episode_reward_mean": 153.54271306714554, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -94.21236937139898, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0054144912609, "predator_policy": 110.45826979111169}, "policy_reward_mean": {"prey_policy": 58.783191723191976, "predator_policy": 17.98816481038079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.49000000000039, 102.80000000000017, 136.4982987207794, 146.0311861206347, 249.72782157720573, 9.069626875514817, 105.43459336768142, 8.11316128442726, 141.77284742353964, 64.62206832166794, 284.57668750165317, 131.78451215929965, 162.0700000000001, 144.4300000000004, 19.67085885357711, 13.39880836960339, 5.471862451920351, 284.1875875130203, 208.00030712560448, 177.7648926932138, 100.4393504899617, 178.9303090969284, 167.64598584689853, 78.69295415147838, 156.23000000000008, 6.45599993729314, 6.046627964510479, 132.47724733149204, 166.34891237644834, 6.7156658161511436, 192.648860125031, 222.5280143579432, 92.94461303891445, 106.11325972040018, 245.28884335391234, 187.40308916605554, 3.8323895735784146, 23.735705101961504, 4.909999999999939, 201.5021953293135, 65.45802036772413, 294.86242375344307, 174.85117319487813, 3.93999999999996, 135.26797913340835, 119.28450237879017, 124.92699500841272, 242.29000000000008, 5.240097235517029, 272.15554492499905, 6.284943428443329, 121.25521455735206, 264.6826794186077, 240.8613926782767, 4.523812917119268, 37.53500302817201, 223.35962421813232, 251.17569472783782, 167.05158569320008, 298.5325329541538, 273.1542939985155, 174.56873223469995, 11.75944394918875, 184.0124872284382, 106.44437735276732, 292.45699963199803, 160.89999999999998, 3.9499999999999598, 152.6334712730049, 245.39184334308243, 101.88824358499066, 113.52831139190063, 109.86990181549045, 2.0477216440775443, 297.88174860073, 307.29615168179384, 242.91074326660973, 255.21381705591756, 3.9499999999999598, 124.7012466635599, 276.05981119481356, 66.03348571619, 194.72999999999965, 143.015115412939, 96.507215652098, 310.29472600289057, 183.10999999999967, 244.28546700463747, 309.9749038247647, 131.00891599311598, 184.41906238493382, 247.09658677093364, 277.12917227921247, 65.5308832834999, 288.29918951289574, 335.588730389149, 319.2639792450442, 306.469516501145, 300.32471192849073, 153.22593614494838], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.7630381986158383, 19.89784083406878, -5.87823999755181, 100.62020568919066, 132.60668525302884, -1.923848338858488, 60.99856853814459, -18.38548497717751, 152.25626595242113, 14.611078284728364, 2.0000000000000013, -6.476959550196089, 56.48132086824456, 2.0000000000000013, 5.959999999999972, -1.5402164728254508, -9.788742848268253, 134.47670493021502, 37.63437507616188, -4.930402004187982, 115.59248183303067, 139.37809873762077, 16.55576334368862, 100.5094206455955, -3.7792321235248822, 157.06173177862502, 139.5067023494385, 2.0000000000000013, -27.05968570819808, 0.30029050721593425, 2.0000000000000013, -25.70345044467832, -7.829634600497068, -12.760060897774766, 40.07589149872553, 191.09, 98.1679833441348, 67.30648986996653, 103.97000000000004, 44.513208674463606, 0.781999658797044, 81.3355133400231, 116.06639540559712, 21.111644095075594, 1.5207078898125532, 165.3499999999999, -11.48301736901877, 59.836962473378776, -2.860316587190259, 151.53304700898082, -2.7598178232451076, 2.0000000000000013, -1.6720608954413743, 2.0000000000000013, -2.0157130229795586, 80.53466847098844, 2.0000000000000013, 154.4952430207075, -1.6503711619987682, 3.922602614355028, -43.42739851090572, 116.84000000000009, 36.98630931517333, 134.2238194318685, 86.54062076139945, -1.0830243843663019, 101.9900000000001, -2.8002583132064265, 161.34475011411092, 81.2, 24.052399878141205, 134.79452164650252, 0.9868977934730327, 1.2005311893161044, 2.98999999999998, -2.1921362363284853, 2.0000000000000013, 1.5226157239413, 26.75000000000018, 169.47722828874385, -2.469484218226616, -5.736935841856948, 96.83600236285976, 154.05174403338935, -43.39439822319629, 165.35000000000008, 1.4292786871929306, 0.39976587607142483, 9.655151559613454, 81.25502455163499, -17.304912612786612, 43.074386998260316, 114.61103570970845, -34.77377385997185, 153.07073851590275, 79.87179517456627, -0.1933543799257753, 2.0000000000000013, 171.74029967380102, 23.493871290484332, -3.537895346583002, 1.199590485258525, 107.21438342453166, 0.6368639129969408, 119.03114815117128, 128.11821179759397, -35.79310216508726, 167.33000000000007, 2.0000000000000013, 1.1884337566763217, -20.448867291580314, 1.3698630869766746, 185.14999999999995, -94.21236937139898, 69.30013463238774, 166.3400000000001, 157.43000000000018, -12.833578982007676, 142.32275239029207, 143.2573195028524, 109.10251693924525, 159.67041197138678, 118.82000000000002, 20.144056849672236, 2.0000000000000013, -13.745958476272536, -3.6207306384902678, 178.21999999999997, 14.37850428179714, 2.0000000000000013, 188.11999999999995, 82.47416348918114, -0.09287613207890161, 142.59966111775083, 0.8353341610024397, 1.7908647989064483, -0.36458587306109225, 149.51000000000005, 114.15343573162724, 112.13415471239523, 2.0000000000000013, 41.418806443155695, 2.0000000000000013, 38.950477435499614, -67.77747216078005, 12.203924758139147, -14.787570694012185, -3.4751763836022462, 174.26, 84.2876376962456, 147.3113914948018, 146.97787350256252, 101.9343346728875, 86.15000000000005, 75.27252869418575, 148.72915809259416, 0.6095051899965286, 2.0000000000000013, 74.88366162453076, 2.0000000000000013, 175.24999999999997, 47.6971612560195, -21.488832773004535, 22.907069231155333, 192.0054144912609, -10.678079711258935, -5.711768725250539, 134.7181368819245, 39.96991071550829, -2.521197000724734, 140.0097979768189, 151.756809122726, -2.117169261495543, 181.18999999999994, 33.32803554015079, 157.26287309016413, 120.15731432201441, 150.8076071533334, -2.2355221821198583, 4.420671794609123, 90.24504111726672, 55.2042643826556, -49.01142318100584, 162.56976612246302, 158.41999999999996, 69.58784407377806, -24.474088633618983, -94.19372995320579, 167.6858199861461, 91.47269990866462, 156.44000000000003, 171.31196064064326, 142.25127344887983, 157.39335903989797, 156.0256676904677, 145.55000000000004, 77.49230648648299, 173.26999999999992, -11.938353590268001, 141.30407293438898], "policy_predator_policy_reward": [3.6121722698768255, 6.743025094670373, 7.698239997551771, 0.35979431080934754, 4.3083963295815755, 1.5070654770272272, 55.82625218794762, 47.59185037172051, 39.837749622701224, 43.02272771735522, 7.994730619308082, 5.551855806402866, 25.564967660227754, 21.388304839208864, 3.4802164728254197, 0.21316128442731597, 5.580814934707749, 11.50407040688511, 10.067145741083, 21.850949508610846, 18.219891374186453, 11.386215556815847, 8.122291125661139, 6.5970370443540425, 3.1882682213750266, 5.5992321235248435, 2.9232976505615413, 0.0, 16.78171761816794, 29.648536436391094, 27.116878040428944, 9.985380773853079, 10.970583878327723, 15.090974071864458, 39.11302841866598, 13.908667595628868, 19.25149554351636, 23.274338367987703, 11.442656404769362, 17.839027613981344, 10.82203405562268, 7.499803435518434, 30.44365683931954, 11.308612756936931, 0.3159858468987675, 0.4592921101874482, 15.456446934719244, 14.88256211239835, 4.750316587190219, 2.80695299101922, 3.8271977602586773, 3.38862000027961, 3.511061689778354, 2.207627170173547, 32.516128139931595, 21.442163743551404, 0.17891237644856028, 9.674756979292404, 0.4803153221648965, 3.963119041629994, 49.242093791305976, 69.9941648446308, 30.161984794874474, 21.15590081602759, 3.0365639458548803, 4.450452716026245, 3.9832861393785355, 2.9402318942276953, 1.9452498858890501, 0.7988433539121895, 16.70195123205704, 11.854216409355157, 0.769468810683897, 0.8754917801054208, 6.6713201471682115, 16.266521191121353, 1.3873842760587012, 0.0, 4.582771711256142, 0.6921953293139251, 29.062031952007736, 44.602408475799386, 31.13752546211195, 12.837151895082165, 50.38439822319608, 2.511173194878612, 0.5507213128070707, 1.5602341239285766, 33.06685667148969, 11.29094635066991, 44.5112230471545, 49.00380494616168, 5.0135156369448115, 40.076217521730506, 4.048024570287801, 5.299441739243191, 2.143354379925774, 1.290097235517098, 36.50991866941296, 40.41145529130082, 4.784156288443546, 3.8390920013243024, 4.661739143563592, 8.742228076259162, 7.875994196578097, 9.657325273264856, 38.45326058850276, 70.87123425486125, 0.5733647623744232, 0.7620143980685766, 13.821014698093819, 42.79299253468226, 110.45826979111169, 21.963723798420236, 9.17143127991895, 6.364128815531192, 9.958673809473668, 12.496490865733826, 3.0951247276227742, 9.857336333386744, 0.4785440990495109, 3.9028209888339616, 13.213123307148075, 22.39155207788027, 8.316369194060984, 15.189033231400341, 5.39638998800618, 4.016827878922505, 43.97761570118028, 46.08825736978939, 1.4730443254105008, 20.389791817406625, 16.400338882249184, 1.9928761320789032, 1.1246658389975617, 0.1991352010935531, 2.2882578003880023, 1.1997993456777072, 19.104252899060235, 0.0, 37.01849776347515, 21.450939378359553, 35.74831139189967, 36.82952256450021, 70.99732133610404, 94.44612788202748, 3.548374826500162, 16.762093895191793, 23.843103650495696, 15.491007253989148, 0.36706024558479056, 12.639826438844945, 32.71142399340381, 22.11498460031848, 14.32229898165912, 16.889831287478746, 0.0, 1.3404948100034728, 2.775237093764083, 45.04234794526465, 40.034327159211514, 13.078322779582532, 37.620651557167605, 26.994597700871914, 12.388079711258898, 1.0145855087390916, 2.4988272699496195, 11.509919986315262, 30.308064521742015, 28.750437415572257, 11.534450586748108, 6.993668316597622, 4.037169261495502, 0.0, 25.362987052151645, 28.331571322171246, 24.42783444576772, 14.582147903649325, 75.08175314520658, 53.74201323541977, 8.296157927376473, 30.673598957634905, 61.9882753336312, 71.54996849584536, 23.884619307603778, 25.23670889783079, 95.21778539494215, 88.9809164753827, 3.9369944902944485, 25.20367512779079, 4.452292924489645, 3.384476824016224, 0.8014667364803887, 18.817880019786067, 1.6195165011451909, 3.2743323095323933, 26.42050836856164, 23.14189707344603, 16.048552433088958, 7.811664367738348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6898638169102298, "mean_inference_ms": 2.1235615731275224, "mean_action_processing_ms": 0.29467151321745205, "mean_env_wait_ms": 0.2523563557511395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004123568534851074, "StateBufferConnector_ms": 0.0034427642822265625, "ViewRequirementAgentConnector_ms": 0.22672498226165771}, "num_episodes": 23, "episode_return_max": 335.588730389149, "episode_return_min": 2.0477216440775443, "episode_return_mean": 153.54271306714554, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.5861245692456, "num_env_steps_trained_throughput_per_sec": 295.5861245692456, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 13894.441, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13894.38, "sample_time_ms": 2098.588, "learn_time_ms": 11771.424, "learn_throughput": 339.806, "synch_weights_time_ms": 22.755}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "ef79f_00000", "date": "2024-08-16_11-28-12", "timestamp": 1723787892, "time_this_iter_s": 13.644856929779053, "time_total_s": 668.5186204910278, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214baf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 668.5186204910278, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 58.15263157894737, "ram_util_percent": 81.57368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.408845715516459, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.909371565510987, "policy_loss": -0.007109608979422658, "vf_loss": 7.914695084536517, "vf_explained_var": 0.24873016725772273, "kl": 0.011907345097018724, "entropy": 0.9806816125988329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.233314513781714, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.220077269417899, "policy_loss": -0.003220501035037968, "vf_loss": 4.223184294549245, "vf_explained_var": -0.01321567035225964, "kl": 0.004539072931866079, "entropy": 0.3307198681528606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 349.1754259061308, "episode_reward_min": 2.0477216440775443, "episode_reward_mean": 171.62538361003703, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -94.21236937139898, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0054144912609, "predator_policy": 123.1061440231187}, "policy_reward_mean": {"prey_policy": 65.09177288165417, "predator_policy": 20.72091892336437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.00030712560448, 177.7648926932138, 100.4393504899617, 178.9303090969284, 167.64598584689853, 78.69295415147838, 156.23000000000008, 6.45599993729314, 6.046627964510479, 132.47724733149204, 166.34891237644834, 6.7156658161511436, 192.648860125031, 222.5280143579432, 92.94461303891445, 106.11325972040018, 245.28884335391234, 187.40308916605554, 3.8323895735784146, 23.735705101961504, 4.909999999999939, 201.5021953293135, 65.45802036772413, 294.86242375344307, 174.85117319487813, 3.93999999999996, 135.26797913340835, 119.28450237879017, 124.92699500841272, 242.29000000000008, 5.240097235517029, 272.15554492499905, 6.284943428443329, 121.25521455735206, 264.6826794186077, 240.8613926782767, 4.523812917119268, 37.53500302817201, 223.35962421813232, 251.17569472783782, 167.05158569320008, 298.5325329541538, 273.1542939985155, 174.56873223469995, 11.75944394918875, 184.0124872284382, 106.44437735276732, 292.45699963199803, 160.89999999999998, 3.9499999999999598, 152.6334712730049, 245.39184334308243, 101.88824358499066, 113.52831139190063, 109.86990181549045, 2.0477216440775443, 297.88174860073, 307.29615168179384, 242.91074326660973, 255.21381705591756, 3.9499999999999598, 124.7012466635599, 276.05981119481356, 66.03348571619, 194.72999999999965, 143.015115412939, 96.507215652098, 310.29472600289057, 183.10999999999967, 244.28546700463747, 309.9749038247647, 131.00891599311598, 184.41906238493382, 247.09658677093364, 277.12917227921247, 65.5308832834999, 288.29918951289574, 335.588730389149, 319.2639792450442, 306.469516501145, 300.32471192849073, 153.22593614494838, 258.5475599536112, 154.5197838353775, 164.26, 341.7065031305237, 216.7149035601949, 46.69579450869663, 319.9326432985715, 160.34000000000003, 145.5078220413356, 164.15965015378168, 125.45375677987147, 349.1754259061308, 270.29306682398635, 329.31573446715066, 151.01506415074792, 209.8607260456682, 264.4449413908688, 173.47359878316138], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [98.1679833441348, 67.30648986996653, 103.97000000000004, 44.513208674463606, 0.781999658797044, 81.3355133400231, 116.06639540559712, 21.111644095075594, 1.5207078898125532, 165.3499999999999, -11.48301736901877, 59.836962473378776, -2.860316587190259, 151.53304700898082, -2.7598178232451076, 2.0000000000000013, -1.6720608954413743, 2.0000000000000013, -2.0157130229795586, 80.53466847098844, 2.0000000000000013, 154.4952430207075, -1.6503711619987682, 3.922602614355028, -43.42739851090572, 116.84000000000009, 36.98630931517333, 134.2238194318685, 86.54062076139945, -1.0830243843663019, 101.9900000000001, -2.8002583132064265, 161.34475011411092, 81.2, 24.052399878141205, 134.79452164650252, 0.9868977934730327, 1.2005311893161044, 2.98999999999998, -2.1921362363284853, 2.0000000000000013, 1.5226157239413, 26.75000000000018, 169.47722828874385, -2.469484218226616, -5.736935841856948, 96.83600236285976, 154.05174403338935, -43.39439822319629, 165.35000000000008, 1.4292786871929306, 0.39976587607142483, 9.655151559613454, 81.25502455163499, -17.304912612786612, 43.074386998260316, 114.61103570970845, -34.77377385997185, 153.07073851590275, 79.87179517456627, -0.1933543799257753, 2.0000000000000013, 171.74029967380102, 23.493871290484332, -3.537895346583002, 1.199590485258525, 107.21438342453166, 0.6368639129969408, 119.03114815117128, 128.11821179759397, -35.79310216508726, 167.33000000000007, 2.0000000000000013, 1.1884337566763217, -20.448867291580314, 1.3698630869766746, 185.14999999999995, -94.21236937139898, 69.30013463238774, 166.3400000000001, 157.43000000000018, -12.833578982007676, 142.32275239029207, 143.2573195028524, 109.10251693924525, 159.67041197138678, 118.82000000000002, 20.144056849672236, 2.0000000000000013, -13.745958476272536, -3.6207306384902678, 178.21999999999997, 14.37850428179714, 2.0000000000000013, 188.11999999999995, 82.47416348918114, -0.09287613207890161, 142.59966111775083, 0.8353341610024397, 1.7908647989064483, -0.36458587306109225, 149.51000000000005, 114.15343573162724, 112.13415471239523, 2.0000000000000013, 41.418806443155695, 2.0000000000000013, 38.950477435499614, -67.77747216078005, 12.203924758139147, -14.787570694012185, -3.4751763836022462, 174.26, 84.2876376962456, 147.3113914948018, 146.97787350256252, 101.9343346728875, 86.15000000000005, 75.27252869418575, 148.72915809259416, 0.6095051899965286, 2.0000000000000013, 74.88366162453076, 2.0000000000000013, 175.24999999999997, 47.6971612560195, -21.488832773004535, 22.907069231155333, 192.0054144912609, -10.678079711258935, -5.711768725250539, 134.7181368819245, 39.96991071550829, -2.521197000724734, 140.0097979768189, 151.756809122726, -2.117169261495543, 181.18999999999994, 33.32803554015079, 157.26287309016413, 120.15731432201441, 150.8076071533334, -2.2355221821198583, 4.420671794609123, 90.24504111726672, 55.2042643826556, -49.01142318100584, 162.56976612246302, 158.41999999999996, 69.58784407377806, -24.474088633618983, -94.19372995320579, 167.6858199861461, 91.47269990866462, 156.44000000000003, 171.31196064064326, 142.25127344887983, 157.39335903989797, 156.0256676904677, 145.55000000000004, 77.49230648648299, 173.26999999999992, -11.938353590268001, 141.30407293438898, 108.92, 76.03525924845653, -62.64419823951347, 130.53437553315803, -0.36823493805502894, 161.196629449679, 158.05626108841443, 177.23000000000002, -57.93755770914201, 155.22546212057316, -49.515074722577324, -78.61642368897644, 108.88050369881003, 184.81843052356464, 156.4461131476779, 2.0000000000000013, 133.68864697582674, -73.55839744558195, -18.933942826950993, 143.2680503061783, 2.0000000000000013, 119.67436816022901, 163.67693356257166, 179.66209639147525, -56.2139024811857, 170.471665907285, 172.88577096342476, 144.33514546093, 139.61, -23.63291028944098, -26.529456959890908, 122.78000000000002, 176.51907160775994, 66.87465663140757, -27.382759260736016, 77.05407943485612], "policy_predator_policy_reward": [19.25149554351636, 23.274338367987703, 11.442656404769362, 17.839027613981344, 10.82203405562268, 7.499803435518434, 30.44365683931954, 11.308612756936931, 0.3159858468987675, 0.4592921101874482, 15.456446934719244, 14.88256211239835, 4.750316587190219, 2.80695299101922, 3.8271977602586773, 3.38862000027961, 3.511061689778354, 2.207627170173547, 32.516128139931595, 21.442163743551404, 0.17891237644856028, 9.674756979292404, 0.4803153221648965, 3.963119041629994, 49.242093791305976, 69.9941648446308, 30.161984794874474, 21.15590081602759, 3.0365639458548803, 4.450452716026245, 3.9832861393785355, 2.9402318942276953, 1.9452498858890501, 0.7988433539121895, 16.70195123205704, 11.854216409355157, 0.769468810683897, 0.8754917801054208, 6.6713201471682115, 16.266521191121353, 1.3873842760587012, 0.0, 4.582771711256142, 0.6921953293139251, 29.062031952007736, 44.602408475799386, 31.13752546211195, 12.837151895082165, 50.38439822319608, 2.511173194878612, 0.5507213128070707, 1.5602341239285766, 33.06685667148969, 11.29094635066991, 44.5112230471545, 49.00380494616168, 5.0135156369448115, 40.076217521730506, 4.048024570287801, 5.299441739243191, 2.143354379925774, 1.290097235517098, 36.50991866941296, 40.41145529130082, 4.784156288443546, 3.8390920013243024, 4.661739143563592, 8.742228076259162, 7.875994196578097, 9.657325273264856, 38.45326058850276, 70.87123425486125, 0.5733647623744232, 0.7620143980685766, 13.821014698093819, 42.79299253468226, 110.45826979111169, 21.963723798420236, 9.17143127991895, 6.364128815531192, 9.958673809473668, 12.496490865733826, 3.0951247276227742, 9.857336333386744, 0.4785440990495109, 3.9028209888339616, 13.213123307148075, 22.39155207788027, 8.316369194060984, 15.189033231400341, 5.39638998800618, 4.016827878922505, 43.97761570118028, 46.08825736978939, 1.4730443254105008, 20.389791817406625, 16.400338882249184, 1.9928761320789032, 1.1246658389975617, 0.1991352010935531, 2.2882578003880023, 1.1997993456777072, 19.104252899060235, 0.0, 37.01849776347515, 21.450939378359553, 35.74831139189967, 36.82952256450021, 70.99732133610404, 94.44612788202748, 3.548374826500162, 16.762093895191793, 23.843103650495696, 15.491007253989148, 0.36706024558479056, 12.639826438844945, 32.71142399340381, 22.11498460031848, 14.32229898165912, 16.889831287478746, 0.0, 1.3404948100034728, 2.775237093764083, 45.04234794526465, 40.034327159211514, 13.078322779582532, 37.620651557167605, 26.994597700871914, 12.388079711258898, 1.0145855087390916, 2.4988272699496195, 11.509919986315262, 30.308064521742015, 28.750437415572257, 11.534450586748108, 6.993668316597622, 4.037169261495502, 0.0, 25.362987052151645, 28.331571322171246, 24.42783444576772, 14.582147903649325, 75.08175314520658, 53.74201323541977, 8.296157927376473, 30.673598957634905, 61.9882753336312, 71.54996849584536, 23.884619307603778, 25.23670889783079, 95.21778539494215, 88.9809164753827, 3.9369944902944485, 25.20367512779079, 4.452292924489645, 3.384476824016224, 0.8014667364803887, 18.817880019786067, 1.6195165011451909, 3.2743323095323933, 26.42050836856164, 23.14189707344603, 16.048552433088958, 7.811664367738348, 36.619249349410374, 36.97305135574432, 42.32159820263496, 44.30800833909775, 2.2882349380550244, 1.1433705503210003, 4.071916572773392, 2.3483254693359132, 71.10147421958087, 48.32552492918286, 51.72114889713186, 123.1061440231187, 17.233012865765566, 9.000696210431553, 0.0, 1.8938868523221322, 64.16130143479023, 21.216271076300476, 18.407830992705854, 21.417711681848782, 3.005631839771009, 0.7737567798711277, 5.8363959520839925, 0.0, 91.76450197545289, 64.27080142243418, 0.0, 12.094818042796021, 12.168261337539196, 22.869713102649897, 75.69880306183404, 37.911379943725, 6.26237264691994, 14.788840504781344, 49.28468537930738, 74.51759322973422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6953142718334716, "mean_inference_ms": 2.138259289838499, "mean_action_processing_ms": 0.2964996536378475, "mean_env_wait_ms": 0.2540625848135422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041893720626831055, "StateBufferConnector_ms": 0.0034960508346557617, "ViewRequirementAgentConnector_ms": 0.2285851240158081}, "num_episodes": 18, "episode_return_max": 349.1754259061308, "episode_return_min": 2.0477216440775443, "episode_return_mean": 171.62538361003703, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.14015917756666, "num_env_steps_trained_throughput_per_sec": 296.14015917756666, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 13941.588, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13941.525, "sample_time_ms": 2124.835, "learn_time_ms": 11792.346, "learn_throughput": 339.203, "synch_weights_time_ms": 22.644}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "ef79f_00000", "date": "2024-08-16_11-28-26", "timestamp": 1723787906, "time_this_iter_s": 13.580195188522339, "time_total_s": 682.0988156795502, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321433790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 682.0988156795502, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 61.6842105263158, "ram_util_percent": 81.72631578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8068626717915612, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.083789807274227, "policy_loss": -0.005974623799895641, "vf_loss": 9.08809389840989, "vf_explained_var": 0.19832760994396512, "kl": 0.011136963712670178, "entropy": 0.9051576434935211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.153207324800038, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.45061944615904, "policy_loss": -0.0036444934023416075, "vf_loss": 4.454210172254572, "vf_explained_var": 0.06456084153639577, "kl": 0.004302162214815559, "entropy": 0.31611135947325875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 351.1837792428387, "episode_reward_min": 2.0477216440775443, "episode_reward_mean": 188.95628699373788, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -111.6648200646968, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0054144912609, "predator_policy": 123.1061440231187}, "policy_reward_mean": {"prey_policy": 70.44811294326654, "predator_policy": 24.03003055360239}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8323895735784146, 23.735705101961504, 4.909999999999939, 201.5021953293135, 65.45802036772413, 294.86242375344307, 174.85117319487813, 3.93999999999996, 135.26797913340835, 119.28450237879017, 124.92699500841272, 242.29000000000008, 5.240097235517029, 272.15554492499905, 6.284943428443329, 121.25521455735206, 264.6826794186077, 240.8613926782767, 4.523812917119268, 37.53500302817201, 223.35962421813232, 251.17569472783782, 167.05158569320008, 298.5325329541538, 273.1542939985155, 174.56873223469995, 11.75944394918875, 184.0124872284382, 106.44437735276732, 292.45699963199803, 160.89999999999998, 3.9499999999999598, 152.6334712730049, 245.39184334308243, 101.88824358499066, 113.52831139190063, 109.86990181549045, 2.0477216440775443, 297.88174860073, 307.29615168179384, 242.91074326660973, 255.21381705591756, 3.9499999999999598, 124.7012466635599, 276.05981119481356, 66.03348571619, 194.72999999999965, 143.015115412939, 96.507215652098, 310.29472600289057, 183.10999999999967, 244.28546700463747, 309.9749038247647, 131.00891599311598, 184.41906238493382, 247.09658677093364, 277.12917227921247, 65.5308832834999, 288.29918951289574, 335.588730389149, 319.2639792450442, 306.469516501145, 300.32471192849073, 153.22593614494838, 258.5475599536112, 154.5197838353775, 164.26, 341.7065031305237, 216.7149035601949, 46.69579450869663, 319.9326432985715, 160.34000000000003, 145.5078220413356, 164.15965015378168, 125.45375677987147, 349.1754259061308, 270.29306682398635, 329.31573446715066, 151.01506415074792, 209.8607260456682, 264.4449413908688, 173.47359878316138, 77.80571309929987, 244.72746191478194, 85.41754953766063, 243.32122091198065, 314.12671454682055, 229.4893222279527, 170.1199999999999, 256.94930358953354, 322.10193149710454, 289.6794897416083, 232.09333850392667, 321.3970423513976, 208.41599026509402, 351.1837792428387, 61.19722297960819, 340.50499839324794, 233.23182822227776, 184.0023639371851], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.9868977934730327, 1.2005311893161044, 2.98999999999998, -2.1921362363284853, 2.0000000000000013, 1.5226157239413, 26.75000000000018, 169.47722828874385, -2.469484218226616, -5.736935841856948, 96.83600236285976, 154.05174403338935, -43.39439822319629, 165.35000000000008, 1.4292786871929306, 0.39976587607142483, 9.655151559613454, 81.25502455163499, -17.304912612786612, 43.074386998260316, 114.61103570970845, -34.77377385997185, 153.07073851590275, 79.87179517456627, -0.1933543799257753, 2.0000000000000013, 171.74029967380102, 23.493871290484332, -3.537895346583002, 1.199590485258525, 107.21438342453166, 0.6368639129969408, 119.03114815117128, 128.11821179759397, -35.79310216508726, 167.33000000000007, 2.0000000000000013, 1.1884337566763217, -20.448867291580314, 1.3698630869766746, 185.14999999999995, -94.21236937139898, 69.30013463238774, 166.3400000000001, 157.43000000000018, -12.833578982007676, 142.32275239029207, 143.2573195028524, 109.10251693924525, 159.67041197138678, 118.82000000000002, 20.144056849672236, 2.0000000000000013, -13.745958476272536, -3.6207306384902678, 178.21999999999997, 14.37850428179714, 2.0000000000000013, 188.11999999999995, 82.47416348918114, -0.09287613207890161, 142.59966111775083, 0.8353341610024397, 1.7908647989064483, -0.36458587306109225, 149.51000000000005, 114.15343573162724, 112.13415471239523, 2.0000000000000013, 41.418806443155695, 2.0000000000000013, 38.950477435499614, -67.77747216078005, 12.203924758139147, -14.787570694012185, -3.4751763836022462, 174.26, 84.2876376962456, 147.3113914948018, 146.97787350256252, 101.9343346728875, 86.15000000000005, 75.27252869418575, 148.72915809259416, 0.6095051899965286, 2.0000000000000013, 74.88366162453076, 2.0000000000000013, 175.24999999999997, 47.6971612560195, -21.488832773004535, 22.907069231155333, 192.0054144912609, -10.678079711258935, -5.711768725250539, 134.7181368819245, 39.96991071550829, -2.521197000724734, 140.0097979768189, 151.756809122726, -2.117169261495543, 181.18999999999994, 33.32803554015079, 157.26287309016413, 120.15731432201441, 150.8076071533334, -2.2355221821198583, 4.420671794609123, 90.24504111726672, 55.2042643826556, -49.01142318100584, 162.56976612246302, 158.41999999999996, 69.58784407377806, -24.474088633618983, -94.19372995320579, 167.6858199861461, 91.47269990866462, 156.44000000000003, 171.31196064064326, 142.25127344887983, 157.39335903989797, 156.0256676904677, 145.55000000000004, 77.49230648648299, 173.26999999999992, -11.938353590268001, 141.30407293438898, 108.92, 76.03525924845653, -62.64419823951347, 130.53437553315803, -0.36823493805502894, 161.196629449679, 158.05626108841443, 177.23000000000002, -57.93755770914201, 155.22546212057316, -49.515074722577324, -78.61642368897644, 108.88050369881003, 184.81843052356464, 156.4461131476779, 2.0000000000000013, 133.68864697582674, -73.55839744558195, -18.933942826950993, 143.2680503061783, 2.0000000000000013, 119.67436816022901, 163.67693356257166, 179.66209639147525, -56.2139024811857, 170.471665907285, 172.88577096342476, 144.33514546093, 139.61, -23.63291028944098, -26.529456959890908, 122.78000000000002, 176.51907160775994, 66.87465663140757, -27.382759260736016, 77.05407943485612, 10.196990124800287, -0.15107040570792596, 186.95004508146954, -12.822855760590947, -88.13905788758677, 60.53190563991994, 176.24, -42.65091445120752, 172.0530623679312, 130.95260548958862, -100.7382941297174, 159.0615111062888, 160.71868757210265, 2.0000000000000013, 175.8770111981297, 27.41816405307418, 156.72821143071923, 153.72970328836294, 85.9094822889255, 177.23000000000002, 139.75942932827348, 56.714755212981714, 154.95557366352296, 154.46000000000004, 170.11628936207126, -33.61724585866922, 165.97767324649828, 178.19515028035838, 11.23942520202803, -63.91791037607793, 159.41, 160.77679573304073, 178.62264509055277, -111.6648200646968, 96.82679233017271, 26.985181111042692], "policy_predator_policy_reward": [0.769468810683897, 0.8754917801054208, 6.6713201471682115, 16.266521191121353, 1.3873842760587012, 0.0, 4.582771711256142, 0.6921953293139251, 29.062031952007736, 44.602408475799386, 31.13752546211195, 12.837151895082165, 50.38439822319608, 2.511173194878612, 0.5507213128070707, 1.5602341239285766, 33.06685667148969, 11.29094635066991, 44.5112230471545, 49.00380494616168, 5.0135156369448115, 40.076217521730506, 4.048024570287801, 5.299441739243191, 2.143354379925774, 1.290097235517098, 36.50991866941296, 40.41145529130082, 4.784156288443546, 3.8390920013243024, 4.661739143563592, 8.742228076259162, 7.875994196578097, 9.657325273264856, 38.45326058850276, 70.87123425486125, 0.5733647623744232, 0.7620143980685766, 13.821014698093819, 42.79299253468226, 110.45826979111169, 21.963723798420236, 9.17143127991895, 6.364128815531192, 9.958673809473668, 12.496490865733826, 3.0951247276227742, 9.857336333386744, 0.4785440990495109, 3.9028209888339616, 13.213123307148075, 22.39155207788027, 8.316369194060984, 15.189033231400341, 5.39638998800618, 4.016827878922505, 43.97761570118028, 46.08825736978939, 1.4730443254105008, 20.389791817406625, 16.400338882249184, 1.9928761320789032, 1.1246658389975617, 0.1991352010935531, 2.2882578003880023, 1.1997993456777072, 19.104252899060235, 0.0, 37.01849776347515, 21.450939378359553, 35.74831139189967, 36.82952256450021, 70.99732133610404, 94.44612788202748, 3.548374826500162, 16.762093895191793, 23.843103650495696, 15.491007253989148, 0.36706024558479056, 12.639826438844945, 32.71142399340381, 22.11498460031848, 14.32229898165912, 16.889831287478746, 0.0, 1.3404948100034728, 2.775237093764083, 45.04234794526465, 40.034327159211514, 13.078322779582532, 37.620651557167605, 26.994597700871914, 12.388079711258898, 1.0145855087390916, 2.4988272699496195, 11.509919986315262, 30.308064521742015, 28.750437415572257, 11.534450586748108, 6.993668316597622, 4.037169261495502, 0.0, 25.362987052151645, 28.331571322171246, 24.42783444576772, 14.582147903649325, 75.08175314520658, 53.74201323541977, 8.296157927376473, 30.673598957634905, 61.9882753336312, 71.54996849584536, 23.884619307603778, 25.23670889783079, 95.21778539494215, 88.9809164753827, 3.9369944902944485, 25.20367512779079, 4.452292924489645, 3.384476824016224, 0.8014667364803887, 18.817880019786067, 1.6195165011451909, 3.2743323095323933, 26.42050836856164, 23.14189707344603, 16.048552433088958, 7.811664367738348, 36.619249349410374, 36.97305135574432, 42.32159820263496, 44.30800833909775, 2.2882349380550244, 1.1433705503210003, 4.071916572773392, 2.3483254693359132, 71.10147421958087, 48.32552492918286, 51.72114889713186, 123.1061440231187, 17.233012865765566, 9.000696210431553, 0.0, 1.8938868523221322, 64.16130143479023, 21.216271076300476, 18.407830992705854, 21.417711681848782, 3.005631839771009, 0.7737567798711277, 5.8363959520839925, 0.0, 91.76450197545289, 64.27080142243418, 0.0, 12.094818042796021, 12.168261337539196, 22.869713102649897, 75.69880306183404, 37.911379943725, 6.26237264691994, 14.788840504781344, 49.28468537930738, 74.51759322973422, 35.19366299901452, 32.56613038119297, 39.40946935999, 31.19080323391323, 63.68897260906401, 49.3357291762634, 53.787225302687226, 55.94491006050096, 6.736399894464117, 4.384646794836666, 85.46087538666286, 85.70522986471858, 0.0, 7.401312427897369, 30.666740636177117, 22.987387702152848, 7.0417864236097, 4.602230354412746, 14.559613021628346, 11.980394431054377, 12.304582866050064, 23.314571096621393, 5.35439620192054, 6.627072485954329, 48.26200163161429, 23.654945130077913, 6.855683890920567, 0.15527182506148562, 71.8023537854828, 42.07335436817518, 15.075973838570961, 5.242228821636255, 94.3180809457565, 71.9559222506653, 2.9621847556449246, 57.228205740324746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7005786140869992, "mean_inference_ms": 2.152351339722541, "mean_action_processing_ms": 0.29837379643852097, "mean_env_wait_ms": 0.2557224510353764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004236459732055664, "StateBufferConnector_ms": 0.003442525863647461, "ViewRequirementAgentConnector_ms": 0.22887372970581055}, "num_episodes": 18, "episode_return_max": 351.1837792428387, "episode_return_min": 2.0477216440775443, "episode_return_mean": 188.95628699373788, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.8552352194186, "num_env_steps_trained_throughput_per_sec": 307.8552352194186, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 13875.251, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13875.181, "sample_time_ms": 2112.333, "learn_time_ms": 11737.699, "learn_throughput": 340.782, "synch_weights_time_ms": 23.292}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "ef79f_00000", "date": "2024-08-16_11-28-39", "timestamp": 1723787919, "time_this_iter_s": 13.07591199874878, "time_total_s": 695.174727678299, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3212b85e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 695.174727678299, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 65.12105263157895, "ram_util_percent": 82.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6285517045114406, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.157106194168172, "policy_loss": -0.006295037276983734, "vf_loss": 9.161738334635578, "vf_explained_var": 0.22894240245617256, "kl": 0.011086085769788253, "entropy": 0.9331403886199628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.390437908904262, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8778307571612967, "policy_loss": -0.0028576971544199206, "vf_loss": 3.8806645267224185, "vf_explained_var": 0.009202014548437935, "kl": 0.003827777261449871, "entropy": 0.2763188319073783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 372.4060544885739, "episode_reward_min": 2.0477216440775443, "episode_reward_mean": 218.54881003509897, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -230.47251306516898, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0054144912609, "predator_policy": 167.0906342032316}, "policy_reward_mean": {"prey_policy": 83.13747624954587, "predator_policy": 26.136928768003663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.05158569320008, 298.5325329541538, 273.1542939985155, 174.56873223469995, 11.75944394918875, 184.0124872284382, 106.44437735276732, 292.45699963199803, 160.89999999999998, 3.9499999999999598, 152.6334712730049, 245.39184334308243, 101.88824358499066, 113.52831139190063, 109.86990181549045, 2.0477216440775443, 297.88174860073, 307.29615168179384, 242.91074326660973, 255.21381705591756, 3.9499999999999598, 124.7012466635599, 276.05981119481356, 66.03348571619, 194.72999999999965, 143.015115412939, 96.507215652098, 310.29472600289057, 183.10999999999967, 244.28546700463747, 309.9749038247647, 131.00891599311598, 184.41906238493382, 247.09658677093364, 277.12917227921247, 65.5308832834999, 288.29918951289574, 335.588730389149, 319.2639792450442, 306.469516501145, 300.32471192849073, 153.22593614494838, 258.5475599536112, 154.5197838353775, 164.26, 341.7065031305237, 216.7149035601949, 46.69579450869663, 319.9326432985715, 160.34000000000003, 145.5078220413356, 164.15965015378168, 125.45375677987147, 349.1754259061308, 270.29306682398635, 329.31573446715066, 151.01506415074792, 209.8607260456682, 264.4449413908688, 173.47359878316138, 77.80571309929987, 244.72746191478194, 85.41754953766063, 243.32122091198065, 314.12671454682055, 229.4893222279527, 170.1199999999999, 256.94930358953354, 322.10193149710454, 289.6794897416083, 232.09333850392667, 321.3970423513976, 208.41599026509402, 351.1837792428387, 61.19722297960819, 340.50499839324794, 233.23182822227776, 184.0023639371851, 328.081825559156, 248.6273890987099, 354.2984767062792, 337.6601021420212, 244.08400397454102, 156.83437432177834, 231.17503471405908, 340.9055084880479, 165.5605288460589, 178.58999999999992, 254.43406755431897, 116.64478127939029, 251.46677952589383, 331.57, 305.6342640528972, 372.4060544885739, 241.79449336960374, 257.6795303028425, 309.17408374548336, 219.74519569868158, 338.16932131736843, 196.65187992637865], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [157.43000000000018, -12.833578982007676, 142.32275239029207, 143.2573195028524, 109.10251693924525, 159.67041197138678, 118.82000000000002, 20.144056849672236, 2.0000000000000013, -13.745958476272536, -3.6207306384902678, 178.21999999999997, 14.37850428179714, 2.0000000000000013, 188.11999999999995, 82.47416348918114, -0.09287613207890161, 142.59966111775083, 0.8353341610024397, 1.7908647989064483, -0.36458587306109225, 149.51000000000005, 114.15343573162724, 112.13415471239523, 2.0000000000000013, 41.418806443155695, 2.0000000000000013, 38.950477435499614, -67.77747216078005, 12.203924758139147, -14.787570694012185, -3.4751763836022462, 174.26, 84.2876376962456, 147.3113914948018, 146.97787350256252, 101.9343346728875, 86.15000000000005, 75.27252869418575, 148.72915809259416, 0.6095051899965286, 2.0000000000000013, 74.88366162453076, 2.0000000000000013, 175.24999999999997, 47.6971612560195, -21.488832773004535, 22.907069231155333, 192.0054144912609, -10.678079711258935, -5.711768725250539, 134.7181368819245, 39.96991071550829, -2.521197000724734, 140.0097979768189, 151.756809122726, -2.117169261495543, 181.18999999999994, 33.32803554015079, 157.26287309016413, 120.15731432201441, 150.8076071533334, -2.2355221821198583, 4.420671794609123, 90.24504111726672, 55.2042643826556, -49.01142318100584, 162.56976612246302, 158.41999999999996, 69.58784407377806, -24.474088633618983, -94.19372995320579, 167.6858199861461, 91.47269990866462, 156.44000000000003, 171.31196064064326, 142.25127344887983, 157.39335903989797, 156.0256676904677, 145.55000000000004, 77.49230648648299, 173.26999999999992, -11.938353590268001, 141.30407293438898, 108.92, 76.03525924845653, -62.64419823951347, 130.53437553315803, -0.36823493805502894, 161.196629449679, 158.05626108841443, 177.23000000000002, -57.93755770914201, 155.22546212057316, -49.515074722577324, -78.61642368897644, 108.88050369881003, 184.81843052356464, 156.4461131476779, 2.0000000000000013, 133.68864697582674, -73.55839744558195, -18.933942826950993, 143.2680503061783, 2.0000000000000013, 119.67436816022901, 163.67693356257166, 179.66209639147525, -56.2139024811857, 170.471665907285, 172.88577096342476, 144.33514546093, 139.61, -23.63291028944098, -26.529456959890908, 122.78000000000002, 176.51907160775994, 66.87465663140757, -27.382759260736016, 77.05407943485612, 10.196990124800287, -0.15107040570792596, 186.95004508146954, -12.822855760590947, -88.13905788758677, 60.53190563991994, 176.24, -42.65091445120752, 172.0530623679312, 130.95260548958862, -100.7382941297174, 159.0615111062888, 160.71868757210265, 2.0000000000000013, 175.8770111981297, 27.41816405307418, 156.72821143071923, 153.72970328836294, 85.9094822889255, 177.23000000000002, 139.75942932827348, 56.714755212981714, 154.95557366352296, 154.46000000000004, 170.11628936207126, -33.61724585866922, 165.97767324649828, 178.19515028035838, 11.23942520202803, -63.91791037607793, 159.41, 160.77679573304073, 178.62264509055277, -111.6648200646968, 96.82679233017271, 26.985181111042692, 143.40411552745917, 175.09170656746483, 79.06726172378717, 134.57757208292492, 133.7112412358477, 175.07222753621025, 184.80346895108238, 145.6648532216279, -71.55549181038897, 188.6354648949254, 25.982293722656102, 83.8137724338828, -24.002355777246745, 174.19691925220306, 160.62949713141796, 175.4013493509973, -3.90135198321979, 139.677039561321, -51.30614090801291, 140.71006278288172, -24.654427842078476, 175.9596411029289, 88.34916606653353, -40.70222481140408, 5.6510895049198915, 182.99751900200874, 161.39, 166.65560912870947, 103.38185265328337, 175.5075247508263, 184.97491958841374, 179.80449933546709, 162.56285885184735, 46.14423232211173, 29.679204328475244, 179.2100000000001, 182.899267613512, 96.01710325963771, -78.33725595595267, 181.1841949138654, 148.67044544588072, 163.08101581911546, -230.47251306516898, 178.83320087471955], "policy_predator_policy_reward": [9.958673809473668, 12.496490865733826, 3.0951247276227742, 9.857336333386744, 0.4785440990495109, 3.9028209888339616, 13.213123307148075, 22.39155207788027, 8.316369194060984, 15.189033231400341, 5.39638998800618, 4.016827878922505, 43.97761570118028, 46.08825736978939, 1.4730443254105008, 20.389791817406625, 16.400338882249184, 1.9928761320789032, 1.1246658389975617, 0.1991352010935531, 2.2882578003880023, 1.1997993456777072, 19.104252899060235, 0.0, 37.01849776347515, 21.450939378359553, 35.74831139189967, 36.82952256450021, 70.99732133610404, 94.44612788202748, 3.548374826500162, 16.762093895191793, 23.843103650495696, 15.491007253989148, 0.36706024558479056, 12.639826438844945, 32.71142399340381, 22.11498460031848, 14.32229898165912, 16.889831287478746, 0.0, 1.3404948100034728, 2.775237093764083, 45.04234794526465, 40.034327159211514, 13.078322779582532, 37.620651557167605, 26.994597700871914, 12.388079711258898, 1.0145855087390916, 2.4988272699496195, 11.509919986315262, 30.308064521742015, 28.750437415572257, 11.534450586748108, 6.993668316597622, 4.037169261495502, 0.0, 25.362987052151645, 28.331571322171246, 24.42783444576772, 14.582147903649325, 75.08175314520658, 53.74201323541977, 8.296157927376473, 30.673598957634905, 61.9882753336312, 71.54996849584536, 23.884619307603778, 25.23670889783079, 95.21778539494215, 88.9809164753827, 3.9369944902944485, 25.20367512779079, 4.452292924489645, 3.384476824016224, 0.8014667364803887, 18.817880019786067, 1.6195165011451909, 3.2743323095323933, 26.42050836856164, 23.14189707344603, 16.048552433088958, 7.811664367738348, 36.619249349410374, 36.97305135574432, 42.32159820263496, 44.30800833909775, 2.2882349380550244, 1.1433705503210003, 4.071916572773392, 2.3483254693359132, 71.10147421958087, 48.32552492918286, 51.72114889713186, 123.1061440231187, 17.233012865765566, 9.000696210431553, 0.0, 1.8938868523221322, 64.16130143479023, 21.216271076300476, 18.407830992705854, 21.417711681848782, 3.005631839771009, 0.7737567798711277, 5.8363959520839925, 0.0, 91.76450197545289, 64.27080142243418, 0.0, 12.094818042796021, 12.168261337539196, 22.869713102649897, 75.69880306183404, 37.911379943725, 6.26237264691994, 14.788840504781344, 49.28468537930738, 74.51759322973422, 35.19366299901452, 32.56613038119297, 39.40946935999, 31.19080323391323, 63.68897260906401, 49.3357291762634, 53.787225302687226, 55.94491006050096, 6.736399894464117, 4.384646794836666, 85.46087538666286, 85.70522986471858, 0.0, 7.401312427897369, 30.666740636177117, 22.987387702152848, 7.0417864236097, 4.602230354412746, 14.559613021628346, 11.980394431054377, 12.304582866050064, 23.314571096621393, 5.35439620192054, 6.627072485954329, 48.26200163161429, 23.654945130077913, 6.855683890920567, 0.15527182506148562, 71.8023537854828, 42.07335436817518, 15.075973838570961, 5.242228821636255, 94.3180809457565, 71.9559222506653, 2.9621847556449246, 57.228205740324746, 2.872002816613749, 6.714000647618217, 3.077329976584528, 31.905225315413404, 37.441947601526785, 8.073060332694437, 4.710812581054347, 2.480967388256585, 63.38433231913746, 63.61969857086684, 0.0, 47.03830816523942, 56.27262751129394, 24.70784372780892, 3.2635929248415008, 1.6110690807910502, 14.59520724858837, 15.189634019369402, 87.65876084234084, 1.5273172827903694, 54.344428225815435, 48.78442606765324, 2.2867326796687766, 66.71110734459205, 25.090357913491857, 37.72781310547343, 3.5243908712904988, 0.0, 15.437011556629594, 11.307875092157968, 6.715870110114039, 0.9107654545790093, 14.741885740883381, 18.34551645476126, 22.74673637132373, 26.043589603043294, 20.73859731231658, 9.519115560017047, 38.86697545679003, 78.0312812839789, 10.880897813682278, 15.536962238690114, 167.0906342032316, 81.2005579135966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7054979180959953, "mean_inference_ms": 2.168943432152196, "mean_action_processing_ms": 0.30052870412799604, "mean_env_wait_ms": 0.2575158367001292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004423379898071289, "StateBufferConnector_ms": 0.003417372703552246, "ViewRequirementAgentConnector_ms": 0.2048724889755249}, "num_episodes": 22, "episode_return_max": 372.4060544885739, "episode_return_min": 2.0477216440775443, "episode_return_mean": 218.54881003509897, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.8813519472398, "num_env_steps_trained_throughput_per_sec": 316.8813519472398, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 13703.265, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13703.196, "sample_time_ms": 2139.307, "learn_time_ms": 11538.219, "learn_throughput": 346.674, "synch_weights_time_ms": 23.722}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "ef79f_00000", "date": "2024-08-16_11-28-52", "timestamp": 1723787932, "time_this_iter_s": 12.704531908035278, "time_total_s": 707.8792595863342, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321790ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 707.8792595863342, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 58.99444444444445, "ram_util_percent": 82.28888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3800372919392965, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.316638180566212, "policy_loss": 0.0009339076227868203, "vf_loss": 9.313553059290326, "vf_explained_var": 0.17250371830804007, "kl": 0.01434144275847777, "entropy": 0.922818440892709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.122540519035683, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3586591081013757, "policy_loss": -0.00421311745035743, "vf_loss": 2.3628571599879593, "vf_explained_var": 0.07089420175426221, "kl": 0.004819541777394989, "entropy": 0.2639791093490742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 372.4060544885739, "episode_reward_min": 3.9499999999999598, "episode_reward_mean": 240.64160426472645, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -230.47251306516898, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.03999999999996, "predator_policy": 167.0906342032316}, "policy_reward_mean": {"prey_policy": 93.5806202938233, "predator_policy": 26.74018183853997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [242.91074326660973, 255.21381705591756, 3.9499999999999598, 124.7012466635599, 276.05981119481356, 66.03348571619, 194.72999999999965, 143.015115412939, 96.507215652098, 310.29472600289057, 183.10999999999967, 244.28546700463747, 309.9749038247647, 131.00891599311598, 184.41906238493382, 247.09658677093364, 277.12917227921247, 65.5308832834999, 288.29918951289574, 335.588730389149, 319.2639792450442, 306.469516501145, 300.32471192849073, 153.22593614494838, 258.5475599536112, 154.5197838353775, 164.26, 341.7065031305237, 216.7149035601949, 46.69579450869663, 319.9326432985715, 160.34000000000003, 145.5078220413356, 164.15965015378168, 125.45375677987147, 349.1754259061308, 270.29306682398635, 329.31573446715066, 151.01506415074792, 209.8607260456682, 264.4449413908688, 173.47359878316138, 77.80571309929987, 244.72746191478194, 85.41754953766063, 243.32122091198065, 314.12671454682055, 229.4893222279527, 170.1199999999999, 256.94930358953354, 322.10193149710454, 289.6794897416083, 232.09333850392667, 321.3970423513976, 208.41599026509402, 351.1837792428387, 61.19722297960819, 340.50499839324794, 233.23182822227776, 184.0023639371851, 328.081825559156, 248.6273890987099, 354.2984767062792, 337.6601021420212, 244.08400397454102, 156.83437432177834, 231.17503471405908, 340.9055084880479, 165.5605288460589, 178.58999999999992, 254.43406755431897, 116.64478127939029, 251.46677952589383, 331.57, 305.6342640528972, 372.4060544885739, 241.79449336960374, 257.6795303028425, 309.17408374548336, 219.74519569868158, 338.16932131736843, 196.65187992637865, 177.87772124641887, 310.8472864593843, 223.5772693900585, 284.71818348232307, 348.55906689825173, 302.36173681594215, 307.1941792301893, 296.75999999999993, 191.48669109110614, 346.09999999999997, 351.48, 344.84408796162353, 276.24773538241914, 201.82852943163516, 199.07424771635354, 367.1536054184518, 356.3699999999999, 326.166928816623], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.9343346728875, 86.15000000000005, 75.27252869418575, 148.72915809259416, 0.6095051899965286, 2.0000000000000013, 74.88366162453076, 2.0000000000000013, 175.24999999999997, 47.6971612560195, -21.488832773004535, 22.907069231155333, 192.0054144912609, -10.678079711258935, -5.711768725250539, 134.7181368819245, 39.96991071550829, -2.521197000724734, 140.0097979768189, 151.756809122726, -2.117169261495543, 181.18999999999994, 33.32803554015079, 157.26287309016413, 120.15731432201441, 150.8076071533334, -2.2355221821198583, 4.420671794609123, 90.24504111726672, 55.2042643826556, -49.01142318100584, 162.56976612246302, 158.41999999999996, 69.58784407377806, -24.474088633618983, -94.19372995320579, 167.6858199861461, 91.47269990866462, 156.44000000000003, 171.31196064064326, 142.25127344887983, 157.39335903989797, 156.0256676904677, 145.55000000000004, 77.49230648648299, 173.26999999999992, -11.938353590268001, 141.30407293438898, 108.92, 76.03525924845653, -62.64419823951347, 130.53437553315803, -0.36823493805502894, 161.196629449679, 158.05626108841443, 177.23000000000002, -57.93755770914201, 155.22546212057316, -49.515074722577324, -78.61642368897644, 108.88050369881003, 184.81843052356464, 156.4461131476779, 2.0000000000000013, 133.68864697582674, -73.55839744558195, -18.933942826950993, 143.2680503061783, 2.0000000000000013, 119.67436816022901, 163.67693356257166, 179.66209639147525, -56.2139024811857, 170.471665907285, 172.88577096342476, 144.33514546093, 139.61, -23.63291028944098, -26.529456959890908, 122.78000000000002, 176.51907160775994, 66.87465663140757, -27.382759260736016, 77.05407943485612, 10.196990124800287, -0.15107040570792596, 186.95004508146954, -12.822855760590947, -88.13905788758677, 60.53190563991994, 176.24, -42.65091445120752, 172.0530623679312, 130.95260548958862, -100.7382941297174, 159.0615111062888, 160.71868757210265, 2.0000000000000013, 175.8770111981297, 27.41816405307418, 156.72821143071923, 153.72970328836294, 85.9094822889255, 177.23000000000002, 139.75942932827348, 56.714755212981714, 154.95557366352296, 154.46000000000004, 170.11628936207126, -33.61724585866922, 165.97767324649828, 178.19515028035838, 11.23942520202803, -63.91791037607793, 159.41, 160.77679573304073, 178.62264509055277, -111.6648200646968, 96.82679233017271, 26.985181111042692, 143.40411552745917, 175.09170656746483, 79.06726172378717, 134.57757208292492, 133.7112412358477, 175.07222753621025, 184.80346895108238, 145.6648532216279, -71.55549181038897, 188.6354648949254, 25.982293722656102, 83.8137724338828, -24.002355777246745, 174.19691925220306, 160.62949713141796, 175.4013493509973, -3.90135198321979, 139.677039561321, -51.30614090801291, 140.71006278288172, -24.654427842078476, 175.9596411029289, 88.34916606653353, -40.70222481140408, 5.6510895049198915, 182.99751900200874, 161.39, 166.65560912870947, 103.38185265328337, 175.5075247508263, 184.97491958841374, 179.80449933546709, 162.56285885184735, 46.14423232211173, 29.679204328475244, 179.2100000000001, 182.899267613512, 96.01710325963771, -78.33725595595267, 181.1841949138654, 148.67044544588072, 163.08101581911546, -230.47251306516898, 178.83320087471955, -87.74196827454176, 157.43, 163.2512140572763, 141.59000000000015, -40.8060712109159, 177.50157230970672, 74.34425253583257, 179.88917181078384, 173.0127951309184, 166.33999999999997, 76.03735268194177, 196.03999999999996, 101.54386720339366, 182.17999999999995, 173.07706381466343, 109.81745041414673, 185.28096750356724, -117.49608376961883, 159.6882908994596, 172.6357029740994, 195.7962083515731, 155.45, 156.1585048214613, 183.24625939867528, 145.1555299924251, 88.24804140690397, -13.156861825171065, 128.81252485518291, 146.54000000000008, -79.34208792466346, 161.536670561679, 192.69437137237975, 174.26, 180.07857642221248, 126.0565676477001, 175.15426363062443], "policy_predator_policy_reward": [32.71142399340381, 22.11498460031848, 14.32229898165912, 16.889831287478746, 0.0, 1.3404948100034728, 2.775237093764083, 45.04234794526465, 40.034327159211514, 13.078322779582532, 37.620651557167605, 26.994597700871914, 12.388079711258898, 1.0145855087390916, 2.4988272699496195, 11.509919986315262, 30.308064521742015, 28.750437415572257, 11.534450586748108, 6.993668316597622, 4.037169261495502, 0.0, 25.362987052151645, 28.331571322171246, 24.42783444576772, 14.582147903649325, 75.08175314520658, 53.74201323541977, 8.296157927376473, 30.673598957634905, 61.9882753336312, 71.54996849584536, 23.884619307603778, 25.23670889783079, 95.21778539494215, 88.9809164753827, 3.9369944902944485, 25.20367512779079, 4.452292924489645, 3.384476824016224, 0.8014667364803887, 18.817880019786067, 1.6195165011451909, 3.2743323095323933, 26.42050836856164, 23.14189707344603, 16.048552433088958, 7.811664367738348, 36.619249349410374, 36.97305135574432, 42.32159820263496, 44.30800833909775, 2.2882349380550244, 1.1433705503210003, 4.071916572773392, 2.3483254693359132, 71.10147421958087, 48.32552492918286, 51.72114889713186, 123.1061440231187, 17.233012865765566, 9.000696210431553, 0.0, 1.8938868523221322, 64.16130143479023, 21.216271076300476, 18.407830992705854, 21.417711681848782, 3.005631839771009, 0.7737567798711277, 5.8363959520839925, 0.0, 91.76450197545289, 64.27080142243418, 0.0, 12.094818042796021, 12.168261337539196, 22.869713102649897, 75.69880306183404, 37.911379943725, 6.26237264691994, 14.788840504781344, 49.28468537930738, 74.51759322973422, 35.19366299901452, 32.56613038119297, 39.40946935999, 31.19080323391323, 63.68897260906401, 49.3357291762634, 53.787225302687226, 55.94491006050096, 6.736399894464117, 4.384646794836666, 85.46087538666286, 85.70522986471858, 0.0, 7.401312427897369, 30.666740636177117, 22.987387702152848, 7.0417864236097, 4.602230354412746, 14.559613021628346, 11.980394431054377, 12.304582866050064, 23.314571096621393, 5.35439620192054, 6.627072485954329, 48.26200163161429, 23.654945130077913, 6.855683890920567, 0.15527182506148562, 71.8023537854828, 42.07335436817518, 15.075973838570961, 5.242228821636255, 94.3180809457565, 71.9559222506653, 2.9621847556449246, 57.228205740324746, 2.872002816613749, 6.714000647618217, 3.077329976584528, 31.905225315413404, 37.441947601526785, 8.073060332694437, 4.710812581054347, 2.480967388256585, 63.38433231913746, 63.61969857086684, 0.0, 47.03830816523942, 56.27262751129394, 24.70784372780892, 3.2635929248415008, 1.6110690807910502, 14.59520724858837, 15.189634019369402, 87.65876084234084, 1.5273172827903694, 54.344428225815435, 48.78442606765324, 2.2867326796687766, 66.71110734459205, 25.090357913491857, 37.72781310547343, 3.5243908712904988, 0.0, 15.437011556629594, 11.307875092157968, 6.715870110114039, 0.9107654545790093, 14.741885740883381, 18.34551645476126, 22.74673637132373, 26.043589603043294, 20.73859731231658, 9.519115560017047, 38.86697545679003, 78.0312812839789, 10.880897813682278, 15.536962238690114, 167.0906342032316, 81.2005579135966, 95.75196827454177, 12.43772124641888, 2.067286459384628, 3.9387859427237815, 48.81740727571294, 38.0643610155547, 5.759011671539273, 24.725747464167423, 5.542053098431425, 3.664218668901921, 21.411650299102792, 8.872733834897629, 13.674521603281399, 9.7957904235142, 13.865485771189794, 0.0, 118.75428712505897, 4.947520232098781, 2.1078401576860615, 11.668165968754952, 0.0, 0.2337916484269049, 4.817513809962669, 0.6218099315243323, 24.278431307917344, 18.565732675172804, 16.186298270299, 69.98656813132425, 61.12280541500837, 70.75353022600852, 11.729140708047051, 1.1934227763461582, 2.0314235777875433, 0.0, 0.6698784242017505, 24.286219114096795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7087452361456866, "mean_inference_ms": 2.177239805579413, "mean_action_processing_ms": 0.3018345238877519, "mean_env_wait_ms": 0.2587862624645379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004483819007873535, "StateBufferConnector_ms": 0.0032722949981689453, "ViewRequirementAgentConnector_ms": 0.16859471797943115}, "num_episodes": 18, "episode_return_max": 372.4060544885739, "episode_return_min": 3.9499999999999598, "episode_return_mean": 240.64160426472645, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.41262705720186, "num_env_steps_trained_throughput_per_sec": 292.41262705720186, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 13387.017, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13386.956, "sample_time_ms": 2087.732, "learn_time_ms": 11274.022, "learn_throughput": 354.798, "synch_weights_time_ms": 23.213}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "ef79f_00000", "date": "2024-08-16_11-29-05", "timestamp": 1723787945, "time_this_iter_s": 13.724930047988892, "time_total_s": 721.6041896343231, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5312e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 721.6041896343231, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 59.96842105263157, "ram_util_percent": 82.1421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5933737858893378, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.212534414523493, "policy_loss": -0.0026293887854085636, "vf_loss": 9.214087936361, "vf_explained_var": 0.14933990914985618, "kl": 0.007172344370588676, "entropy": 0.924808445052495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.792752485489719, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4853954348614606, "policy_loss": -0.005289778347427725, "vf_loss": 2.4906759086109345, "vf_explained_var": 0.08209251736206984, "kl": 0.0059583623023796925, "entropy": 0.29005533115415977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 376.254969807523, "episode_reward_min": 46.69579450869663, "episode_reward_mean": 261.6557902522782, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -230.47251306516898, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 167.0906342032316}, "policy_reward_mean": {"prey_policy": 105.91590294783504, "predator_policy": 24.91199217830407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.22593614494838, 258.5475599536112, 154.5197838353775, 164.26, 341.7065031305237, 216.7149035601949, 46.69579450869663, 319.9326432985715, 160.34000000000003, 145.5078220413356, 164.15965015378168, 125.45375677987147, 349.1754259061308, 270.29306682398635, 329.31573446715066, 151.01506415074792, 209.8607260456682, 264.4449413908688, 173.47359878316138, 77.80571309929987, 244.72746191478194, 85.41754953766063, 243.32122091198065, 314.12671454682055, 229.4893222279527, 170.1199999999999, 256.94930358953354, 322.10193149710454, 289.6794897416083, 232.09333850392667, 321.3970423513976, 208.41599026509402, 351.1837792428387, 61.19722297960819, 340.50499839324794, 233.23182822227776, 184.0023639371851, 328.081825559156, 248.6273890987099, 354.2984767062792, 337.6601021420212, 244.08400397454102, 156.83437432177834, 231.17503471405908, 340.9055084880479, 165.5605288460589, 178.58999999999992, 254.43406755431897, 116.64478127939029, 251.46677952589383, 331.57, 305.6342640528972, 372.4060544885739, 241.79449336960374, 257.6795303028425, 309.17408374548336, 219.74519569868158, 338.16932131736843, 196.65187992637865, 177.87772124641887, 310.8472864593843, 223.5772693900585, 284.71818348232307, 348.55906689825173, 302.36173681594215, 307.1941792301893, 296.75999999999993, 191.48669109110614, 346.09999999999997, 351.48, 344.84408796162353, 276.24773538241914, 201.82852943163516, 199.07424771635354, 367.1536054184518, 356.3699999999999, 326.166928816623, 228.79304398905106, 299.8168793604936, 352.12158830006143, 159.84179502183198, 297.54999999999984, 308.0219763466747, 346.03661440351317, 369.8486093206074, 366.0780819244433, 221.3025897378022, 345.27106815179684, 339.9083117727514, 339.60512624903606, 353.7194531213647, 359.43662403536945, 294.0654256229915, 376.254969807523, 238.22197354498354, 336.79883577773785, 322.03999999999996, 204.06500638567377, 246.29790596430385, 302.23999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.938353590268001, 141.30407293438898, 108.92, 76.03525924845653, -62.64419823951347, 130.53437553315803, -0.36823493805502894, 161.196629449679, 158.05626108841443, 177.23000000000002, -57.93755770914201, 155.22546212057316, -49.515074722577324, -78.61642368897644, 108.88050369881003, 184.81843052356464, 156.4461131476779, 2.0000000000000013, 133.68864697582674, -73.55839744558195, -18.933942826950993, 143.2680503061783, 2.0000000000000013, 119.67436816022901, 163.67693356257166, 179.66209639147525, -56.2139024811857, 170.471665907285, 172.88577096342476, 144.33514546093, 139.61, -23.63291028944098, -26.529456959890908, 122.78000000000002, 176.51907160775994, 66.87465663140757, -27.382759260736016, 77.05407943485612, 10.196990124800287, -0.15107040570792596, 186.95004508146954, -12.822855760590947, -88.13905788758677, 60.53190563991994, 176.24, -42.65091445120752, 172.0530623679312, 130.95260548958862, -100.7382941297174, 159.0615111062888, 160.71868757210265, 2.0000000000000013, 175.8770111981297, 27.41816405307418, 156.72821143071923, 153.72970328836294, 85.9094822889255, 177.23000000000002, 139.75942932827348, 56.714755212981714, 154.95557366352296, 154.46000000000004, 170.11628936207126, -33.61724585866922, 165.97767324649828, 178.19515028035838, 11.23942520202803, -63.91791037607793, 159.41, 160.77679573304073, 178.62264509055277, -111.6648200646968, 96.82679233017271, 26.985181111042692, 143.40411552745917, 175.09170656746483, 79.06726172378717, 134.57757208292492, 133.7112412358477, 175.07222753621025, 184.80346895108238, 145.6648532216279, -71.55549181038897, 188.6354648949254, 25.982293722656102, 83.8137724338828, -24.002355777246745, 174.19691925220306, 160.62949713141796, 175.4013493509973, -3.90135198321979, 139.677039561321, -51.30614090801291, 140.71006278288172, -24.654427842078476, 175.9596411029289, 88.34916606653353, -40.70222481140408, 5.6510895049198915, 182.99751900200874, 161.39, 166.65560912870947, 103.38185265328337, 175.5075247508263, 184.97491958841374, 179.80449933546709, 162.56285885184735, 46.14423232211173, 29.679204328475244, 179.2100000000001, 182.899267613512, 96.01710325963771, -78.33725595595267, 181.1841949138654, 148.67044544588072, 163.08101581911546, -230.47251306516898, 178.83320087471955, -87.74196827454176, 157.43, 163.2512140572763, 141.59000000000015, -40.8060712109159, 177.50157230970672, 74.34425253583257, 179.88917181078384, 173.0127951309184, 166.33999999999997, 76.03735268194177, 196.03999999999996, 101.54386720339366, 182.17999999999995, 173.07706381466343, 109.81745041414673, 185.28096750356724, -117.49608376961883, 159.6882908994596, 172.6357029740994, 195.7962083515731, 155.45, 156.1585048214613, 183.24625939867528, 145.1555299924251, 88.24804140690397, -13.156861825171065, 128.81252485518291, 146.54000000000008, -79.34208792466346, 161.536670561679, 192.69437137237975, 174.26, 180.07857642221248, 126.0565676477001, 175.15426363062443, -25.86905732850998, 161.58801527388357, 144.89324354803168, 136.9300121066895, 157.14414856003867, 184.336577698305, 122.48725318310527, -28.652652454776202, 144.2816956257775, 135.36597512410432, 37.73015744668493, 168.32, 153.875045343855, 169.10822411193453, 182.40664316908283, 182.529780663308, 170.04547259359998, 172.274033680167, 158.01562451522204, 20.61758122882715, 185.33215338447576, 153.90744690953062, 147.52805312316855, 154.45792750724746, 157.95491468814134, 169.47618857835252, 148.34538582549874, 185.43437204571504, 186.2109369886258, 164.2087480722797, 158.72389294837103, 111.65409793176062, 159.43956967690139, 200.0, 127.65703848932172, 55.70153660412514, 170.52198308071007, 149.6998151374716, 110.78114915661358, 190.69864174504454, 97.17199412246563, 64.13703590179271, 11.206231289760385, 183.16999999999996, 119.27407262214146, 162.48375220904435], "policy_predator_policy_reward": [16.048552433088958, 7.811664367738348, 36.619249349410374, 36.97305135574432, 42.32159820263496, 44.30800833909775, 2.2882349380550244, 1.1433705503210003, 4.071916572773392, 2.3483254693359132, 71.10147421958087, 48.32552492918286, 51.72114889713186, 123.1061440231187, 17.233012865765566, 9.000696210431553, 0.0, 1.8938868523221322, 64.16130143479023, 21.216271076300476, 18.407830992705854, 21.417711681848782, 3.005631839771009, 0.7737567798711277, 5.8363959520839925, 0.0, 91.76450197545289, 64.27080142243418, 0.0, 12.094818042796021, 12.168261337539196, 22.869713102649897, 75.69880306183404, 37.911379943725, 6.26237264691994, 14.788840504781344, 49.28468537930738, 74.51759322973422, 35.19366299901452, 32.56613038119297, 39.40946935999, 31.19080323391323, 63.68897260906401, 49.3357291762634, 53.787225302687226, 55.94491006050096, 6.736399894464117, 4.384646794836666, 85.46087538666286, 85.70522986471858, 0.0, 7.401312427897369, 30.666740636177117, 22.987387702152848, 7.0417864236097, 4.602230354412746, 14.559613021628346, 11.980394431054377, 12.304582866050064, 23.314571096621393, 5.35439620192054, 6.627072485954329, 48.26200163161429, 23.654945130077913, 6.855683890920567, 0.15527182506148562, 71.8023537854828, 42.07335436817518, 15.075973838570961, 5.242228821636255, 94.3180809457565, 71.9559222506653, 2.9621847556449246, 57.228205740324746, 2.872002816613749, 6.714000647618217, 3.077329976584528, 31.905225315413404, 37.441947601526785, 8.073060332694437, 4.710812581054347, 2.480967388256585, 63.38433231913746, 63.61969857086684, 0.0, 47.03830816523942, 56.27262751129394, 24.70784372780892, 3.2635929248415008, 1.6110690807910502, 14.59520724858837, 15.189634019369402, 87.65876084234084, 1.5273172827903694, 54.344428225815435, 48.78442606765324, 2.2867326796687766, 66.71110734459205, 25.090357913491857, 37.72781310547343, 3.5243908712904988, 0.0, 15.437011556629594, 11.307875092157968, 6.715870110114039, 0.9107654545790093, 14.741885740883381, 18.34551645476126, 22.74673637132373, 26.043589603043294, 20.73859731231658, 9.519115560017047, 38.86697545679003, 78.0312812839789, 10.880897813682278, 15.536962238690114, 167.0906342032316, 81.2005579135966, 95.75196827454177, 12.43772124641888, 2.067286459384628, 3.9387859427237815, 48.81740727571294, 38.0643610155547, 5.759011671539273, 24.725747464167423, 5.542053098431425, 3.664218668901921, 21.411650299102792, 8.872733834897629, 13.674521603281399, 9.7957904235142, 13.865485771189794, 0.0, 118.75428712505897, 4.947520232098781, 2.1078401576860615, 11.668165968754952, 0.0, 0.2337916484269049, 4.817513809962669, 0.6218099315243323, 24.278431307917344, 18.565732675172804, 16.186298270299, 69.98656813132425, 61.12280541500837, 70.75353022600852, 11.729140708047051, 1.1934227763461582, 2.0314235777875433, 0.0, 0.6698784242017505, 24.286219114096795, 39.83398614664221, 53.24009989703528, 11.140665699016543, 6.85295800675591, 0.6250106017565209, 10.015851439961335, 20.1496779578153, 45.85751633568764, 5.676647051626636, 12.225682198491567, 31.17523814459893, 70.79658075539088, 14.933819457595419, 8.11952549012827, 4.59335683091716, 0.3188286572993975, 18.394823690130746, 5.363751960545611, 8.103496922810265, 34.56588707094281, 3.5132037523281294, 2.5182641054622774, 2.9655708834924432, 34.95676025884293, 0.6402115608947754, 11.533811421647462, 18.674614174501237, 1.265081075649809, 7.787942665263858, 1.2289963092001817, 13.121193152459343, 10.56624159040062, 7.204969807523041, 9.610430323098575, 30.094591591891, 24.768806859645835, 3.8101268293477606, 12.766910730208375, 2.163934762301694, 18.39627433604021, 29.05476996618643, 13.70120639522911, 44.973768710239675, 6.947905964304082, 16.145436761510524, 4.3367384073036765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7133115930397916, "mean_inference_ms": 2.1908579622913247, "mean_action_processing_ms": 0.3033755674205744, "mean_env_wait_ms": 0.26047140094242005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004827260971069336, "StateBufferConnector_ms": 0.00334775447845459, "ViewRequirementAgentConnector_ms": 0.1649610996246338}, "num_episodes": 23, "episode_return_max": 376.254969807523, "episode_return_min": 46.69579450869663, "episode_return_mean": 261.6557902522782, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.8869771445872, "num_env_steps_trained_throughput_per_sec": 301.8869771445872, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 13333.086, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13333.025, "sample_time_ms": 2176.785, "learn_time_ms": 11131.256, "learn_throughput": 359.348, "synch_weights_time_ms": 23.219}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "ef79f_00000", "date": "2024-08-16_11-29-19", "timestamp": 1723787959, "time_this_iter_s": 13.307439088821411, "time_total_s": 734.9116287231445, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321429ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 734.9116287231445, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 60.20526315789473, "ram_util_percent": 81.8421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.668571148820655, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.235447688834377, "policy_loss": -0.005359056410650728, "vf_loss": 9.239660368520747, "vf_explained_var": 0.2709541221144338, "kl": 0.007642458508597389, "entropy": 0.9151850500119426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.315354197870486, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.081243055838126, "policy_loss": -0.0037800569094658372, "vf_loss": 3.0850181900634968, "vf_explained_var": 0.16621092308765997, "kl": 0.003147515752796665, "entropy": 0.28868874377674525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 383.83555340000987, "episode_reward_min": 61.19722297960819, "episode_reward_mean": 274.70248889268373, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -230.47251306516898, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 167.0906342032316}, "policy_reward_mean": {"prey_policy": 112.88371039167019, "predator_policy": 24.46753405467172}, "custom_metrics": {}, "hist_stats": {"episode_reward": [173.47359878316138, 77.80571309929987, 244.72746191478194, 85.41754953766063, 243.32122091198065, 314.12671454682055, 229.4893222279527, 170.1199999999999, 256.94930358953354, 322.10193149710454, 289.6794897416083, 232.09333850392667, 321.3970423513976, 208.41599026509402, 351.1837792428387, 61.19722297960819, 340.50499839324794, 233.23182822227776, 184.0023639371851, 328.081825559156, 248.6273890987099, 354.2984767062792, 337.6601021420212, 244.08400397454102, 156.83437432177834, 231.17503471405908, 340.9055084880479, 165.5605288460589, 178.58999999999992, 254.43406755431897, 116.64478127939029, 251.46677952589383, 331.57, 305.6342640528972, 372.4060544885739, 241.79449336960374, 257.6795303028425, 309.17408374548336, 219.74519569868158, 338.16932131736843, 196.65187992637865, 177.87772124641887, 310.8472864593843, 223.5772693900585, 284.71818348232307, 348.55906689825173, 302.36173681594215, 307.1941792301893, 296.75999999999993, 191.48669109110614, 346.09999999999997, 351.48, 344.84408796162353, 276.24773538241914, 201.82852943163516, 199.07424771635354, 367.1536054184518, 356.3699999999999, 326.166928816623, 228.79304398905106, 299.8168793604936, 352.12158830006143, 159.84179502183198, 297.54999999999984, 308.0219763466747, 346.03661440351317, 369.8486093206074, 366.0780819244433, 221.3025897378022, 345.27106815179684, 339.9083117727514, 339.60512624903606, 353.7194531213647, 359.43662403536945, 294.0654256229915, 376.254969807523, 238.22197354498354, 336.79883577773785, 322.03999999999996, 204.06500638567377, 246.29790596430385, 302.23999999999995, 253.86065158377113, 297.5939213658654, 257.41131555654783, 260.0586672310461, 146.7752408244203, 306.0671095775304, 254.22007495252433, 325.9649012756623, 190.73181039361174, 232.9730176915229, 383.83555340000987, 335.7262503173842, 360.86075083638843, 340.4589604729191, 337.747540763633, 315.23758320286316, 230.00488388841939, 300.31094289790383], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-27.382759260736016, 77.05407943485612, 10.196990124800287, -0.15107040570792596, 186.95004508146954, -12.822855760590947, -88.13905788758677, 60.53190563991994, 176.24, -42.65091445120752, 172.0530623679312, 130.95260548958862, -100.7382941297174, 159.0615111062888, 160.71868757210265, 2.0000000000000013, 175.8770111981297, 27.41816405307418, 156.72821143071923, 153.72970328836294, 85.9094822889255, 177.23000000000002, 139.75942932827348, 56.714755212981714, 154.95557366352296, 154.46000000000004, 170.11628936207126, -33.61724585866922, 165.97767324649828, 178.19515028035838, 11.23942520202803, -63.91791037607793, 159.41, 160.77679573304073, 178.62264509055277, -111.6648200646968, 96.82679233017271, 26.985181111042692, 143.40411552745917, 175.09170656746483, 79.06726172378717, 134.57757208292492, 133.7112412358477, 175.07222753621025, 184.80346895108238, 145.6648532216279, -71.55549181038897, 188.6354648949254, 25.982293722656102, 83.8137724338828, -24.002355777246745, 174.19691925220306, 160.62949713141796, 175.4013493509973, -3.90135198321979, 139.677039561321, -51.30614090801291, 140.71006278288172, -24.654427842078476, 175.9596411029289, 88.34916606653353, -40.70222481140408, 5.6510895049198915, 182.99751900200874, 161.39, 166.65560912870947, 103.38185265328337, 175.5075247508263, 184.97491958841374, 179.80449933546709, 162.56285885184735, 46.14423232211173, 29.679204328475244, 179.2100000000001, 182.899267613512, 96.01710325963771, -78.33725595595267, 181.1841949138654, 148.67044544588072, 163.08101581911546, -230.47251306516898, 178.83320087471955, -87.74196827454176, 157.43, 163.2512140572763, 141.59000000000015, -40.8060712109159, 177.50157230970672, 74.34425253583257, 179.88917181078384, 173.0127951309184, 166.33999999999997, 76.03735268194177, 196.03999999999996, 101.54386720339366, 182.17999999999995, 173.07706381466343, 109.81745041414673, 185.28096750356724, -117.49608376961883, 159.6882908994596, 172.6357029740994, 195.7962083515731, 155.45, 156.1585048214613, 183.24625939867528, 145.1555299924251, 88.24804140690397, -13.156861825171065, 128.81252485518291, 146.54000000000008, -79.34208792466346, 161.536670561679, 192.69437137237975, 174.26, 180.07857642221248, 126.0565676477001, 175.15426363062443, -25.86905732850998, 161.58801527388357, 144.89324354803168, 136.9300121066895, 157.14414856003867, 184.336577698305, 122.48725318310527, -28.652652454776202, 144.2816956257775, 135.36597512410432, 37.73015744668493, 168.32, 153.875045343855, 169.10822411193453, 182.40664316908283, 182.529780663308, 170.04547259359998, 172.274033680167, 158.01562451522204, 20.61758122882715, 185.33215338447576, 153.90744690953062, 147.52805312316855, 154.45792750724746, 157.95491468814134, 169.47618857835252, 148.34538582549874, 185.43437204571504, 186.2109369886258, 164.2087480722797, 158.72389294837103, 111.65409793176062, 159.43956967690139, 200.0, 127.65703848932172, 55.70153660412514, 170.52198308071007, 149.6998151374716, 110.78114915661358, 190.69864174504454, 97.17199412246563, 64.13703590179271, 11.206231289760385, 183.16999999999996, 119.27407262214146, 162.48375220904435, 177.6749594720897, -3.9004052046858604, 164.3599999999999, 47.24517782609763, -39.73417452838395, 181.40069036131894, 185.8628538098152, 14.20095750408641, 17.492858453685606, 67.02051086811524, 119.30452170172427, 161.08131906915855, 158.97241708216075, 63.626153190937565, 172.58665321387622, 109.9773856700874, 15.43782651360826, 126.73999999999995, 189.98136965386902, -64.03565403759904, 187.230761080854, 193.64594351418822, 164.15373807285903, 152.56018978598996, 166.87768592450794, 183.70154279945584, 158.41999999999996, 171.72677562334195, 154.4558088156071, 170.02357021578297, 89.90613072363811, 173.1137940892308, 122.59812537214032, 34.078585408393295, 115.7981000534276, 126.18037748787832], "policy_predator_policy_reward": [49.28468537930738, 74.51759322973422, 35.19366299901452, 32.56613038119297, 39.40946935999, 31.19080323391323, 63.68897260906401, 49.3357291762634, 53.787225302687226, 55.94491006050096, 6.736399894464117, 4.384646794836666, 85.46087538666286, 85.70522986471858, 0.0, 7.401312427897369, 30.666740636177117, 22.987387702152848, 7.0417864236097, 4.602230354412746, 14.559613021628346, 11.980394431054377, 12.304582866050064, 23.314571096621393, 5.35439620192054, 6.627072485954329, 48.26200163161429, 23.654945130077913, 6.855683890920567, 0.15527182506148562, 71.8023537854828, 42.07335436817518, 15.075973838570961, 5.242228821636255, 94.3180809457565, 71.9559222506653, 2.9621847556449246, 57.228205740324746, 2.872002816613749, 6.714000647618217, 3.077329976584528, 31.905225315413404, 37.441947601526785, 8.073060332694437, 4.710812581054347, 2.480967388256585, 63.38433231913746, 63.61969857086684, 0.0, 47.03830816523942, 56.27262751129394, 24.70784372780892, 3.2635929248415008, 1.6110690807910502, 14.59520724858837, 15.189634019369402, 87.65876084234084, 1.5273172827903694, 54.344428225815435, 48.78442606765324, 2.2867326796687766, 66.71110734459205, 25.090357913491857, 37.72781310547343, 3.5243908712904988, 0.0, 15.437011556629594, 11.307875092157968, 6.715870110114039, 0.9107654545790093, 14.741885740883381, 18.34551645476126, 22.74673637132373, 26.043589603043294, 20.73859731231658, 9.519115560017047, 38.86697545679003, 78.0312812839789, 10.880897813682278, 15.536962238690114, 167.0906342032316, 81.2005579135966, 95.75196827454177, 12.43772124641888, 2.067286459384628, 3.9387859427237815, 48.81740727571294, 38.0643610155547, 5.759011671539273, 24.725747464167423, 5.542053098431425, 3.664218668901921, 21.411650299102792, 8.872733834897629, 13.674521603281399, 9.7957904235142, 13.865485771189794, 0.0, 118.75428712505897, 4.947520232098781, 2.1078401576860615, 11.668165968754952, 0.0, 0.2337916484269049, 4.817513809962669, 0.6218099315243323, 24.278431307917344, 18.565732675172804, 16.186298270299, 69.98656813132425, 61.12280541500837, 70.75353022600852, 11.729140708047051, 1.1934227763461582, 2.0314235777875433, 0.0, 0.6698784242017505, 24.286219114096795, 39.83398614664221, 53.24009989703528, 11.140665699016543, 6.85295800675591, 0.6250106017565209, 10.015851439961335, 20.1496779578153, 45.85751633568764, 5.676647051626636, 12.225682198491567, 31.17523814459893, 70.79658075539088, 14.933819457595419, 8.11952549012827, 4.59335683091716, 0.3188286572993975, 18.394823690130746, 5.363751960545611, 8.103496922810265, 34.56588707094281, 3.5132037523281294, 2.5182641054622774, 2.9655708834924432, 34.95676025884293, 0.6402115608947754, 11.533811421647462, 18.674614174501237, 1.265081075649809, 7.787942665263858, 1.2289963092001817, 13.121193152459343, 10.56624159040062, 7.204969807523041, 9.610430323098575, 30.094591591891, 24.768806859645835, 3.8101268293477606, 12.766910730208375, 2.163934762301694, 18.39627433604021, 29.05476996618643, 13.70120639522911, 44.973768710239675, 6.947905964304082, 16.145436761510524, 4.3367384073036765, 34.80472703188016, 45.28137028448712, 44.13600153130708, 41.85274200846065, 57.4213283628139, 58.32347136079886, 51.76961214628426, 8.22524377086021, 6.265456597298445, 55.996414905320975, 11.779486746253875, 13.901782060394096, 12.445260198037163, 19.176244481388895, 22.524744880629147, 20.876117511069484, 17.96744958073447, 30.586534299268923, 45.577780450549966, 61.44952162470264, 0.0, 2.958848804967645, 10.807371447247087, 8.204951011288253, 0.0, 10.281522112424684, 8.104993706158984, 2.207191143418193, 13.268161732242934, 0.0, 19.683702689193396, 32.53395570080085, 41.325885271860926, 32.002287836025054, 20.90100884923907, 37.43145650735887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7174491265345228, "mean_inference_ms": 2.203318079535029, "mean_action_processing_ms": 0.30473641960290315, "mean_env_wait_ms": 0.26206568018646365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004947662353515625, "StateBufferConnector_ms": 0.0033986568450927734, "ViewRequirementAgentConnector_ms": 0.16368317604064941}, "num_episodes": 18, "episode_return_max": 383.83555340000987, "episode_return_min": 61.19722297960819, "episode_return_mean": 274.70248889268373, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.90414289568025, "num_env_steps_trained_throughput_per_sec": 295.90414289568025, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 13375.652, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13375.591, "sample_time_ms": 2251.084, "learn_time_ms": 11099.135, "learn_throughput": 360.388, "synch_weights_time_ms": 23.624}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "ef79f_00000", "date": "2024-08-16_11-29-32", "timestamp": 1723787972, "time_this_iter_s": 13.5728919506073, "time_total_s": 748.4845206737518, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214af160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 748.4845206737518, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 59.825, "ram_util_percent": 82.04999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4050340346873753, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.156136478948845, "policy_loss": -0.0014117059849754528, "vf_loss": 9.15582197431534, "vf_explained_var": 0.37108626271051076, "kl": 0.011508008972382822, "entropy": 0.9346911429097413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.000113167018487, "cur_kl_coeff": 0.00078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1186880041051794, "policy_loss": -0.0020318547039534208, "vf_loss": 2.120717641979298, "vf_explained_var": 0.15682918769972665, "kl": 0.002834755144179731, "entropy": 0.2999871921523538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 383.83555340000987, "episode_reward_min": 90.44973408709056, "episode_reward_mean": 281.0088929628353, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -230.47251306516898, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 167.0906342032316}, "policy_reward_mean": {"prey_policy": 118.06695410618138, "predator_policy": 22.437492375236275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [184.0023639371851, 328.081825559156, 248.6273890987099, 354.2984767062792, 337.6601021420212, 244.08400397454102, 156.83437432177834, 231.17503471405908, 340.9055084880479, 165.5605288460589, 178.58999999999992, 254.43406755431897, 116.64478127939029, 251.46677952589383, 331.57, 305.6342640528972, 372.4060544885739, 241.79449336960374, 257.6795303028425, 309.17408374548336, 219.74519569868158, 338.16932131736843, 196.65187992637865, 177.87772124641887, 310.8472864593843, 223.5772693900585, 284.71818348232307, 348.55906689825173, 302.36173681594215, 307.1941792301893, 296.75999999999993, 191.48669109110614, 346.09999999999997, 351.48, 344.84408796162353, 276.24773538241914, 201.82852943163516, 199.07424771635354, 367.1536054184518, 356.3699999999999, 326.166928816623, 228.79304398905106, 299.8168793604936, 352.12158830006143, 159.84179502183198, 297.54999999999984, 308.0219763466747, 346.03661440351317, 369.8486093206074, 366.0780819244433, 221.3025897378022, 345.27106815179684, 339.9083117727514, 339.60512624903606, 353.7194531213647, 359.43662403536945, 294.0654256229915, 376.254969807523, 238.22197354498354, 336.79883577773785, 322.03999999999996, 204.06500638567377, 246.29790596430385, 302.23999999999995, 253.86065158377113, 297.5939213658654, 257.41131555654783, 260.0586672310461, 146.7752408244203, 306.0671095775304, 254.22007495252433, 325.9649012756623, 190.73181039361174, 232.9730176915229, 383.83555340000987, 335.7262503173842, 360.86075083638843, 340.4589604729191, 337.747540763633, 315.23758320286316, 230.00488388841939, 300.31094289790383, 372.2005401173218, 336.82988918302857, 152.70361723179812, 355.71794255828286, 326.99736215059806, 126.74231821344979, 256.31000000000006, 374.8032007464215, 115.39990324047874, 346.12999999999994, 250.74999999999994, 291.2109581749211, 316.7478431604552, 345.5637827972547, 90.44973408709056, 277.4148590051184, 259.5249621572281, 190.38], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [96.82679233017271, 26.985181111042692, 143.40411552745917, 175.09170656746483, 79.06726172378717, 134.57757208292492, 133.7112412358477, 175.07222753621025, 184.80346895108238, 145.6648532216279, -71.55549181038897, 188.6354648949254, 25.982293722656102, 83.8137724338828, -24.002355777246745, 174.19691925220306, 160.62949713141796, 175.4013493509973, -3.90135198321979, 139.677039561321, -51.30614090801291, 140.71006278288172, -24.654427842078476, 175.9596411029289, 88.34916606653353, -40.70222481140408, 5.6510895049198915, 182.99751900200874, 161.39, 166.65560912870947, 103.38185265328337, 175.5075247508263, 184.97491958841374, 179.80449933546709, 162.56285885184735, 46.14423232211173, 29.679204328475244, 179.2100000000001, 182.899267613512, 96.01710325963771, -78.33725595595267, 181.1841949138654, 148.67044544588072, 163.08101581911546, -230.47251306516898, 178.83320087471955, -87.74196827454176, 157.43, 163.2512140572763, 141.59000000000015, -40.8060712109159, 177.50157230970672, 74.34425253583257, 179.88917181078384, 173.0127951309184, 166.33999999999997, 76.03735268194177, 196.03999999999996, 101.54386720339366, 182.17999999999995, 173.07706381466343, 109.81745041414673, 185.28096750356724, -117.49608376961883, 159.6882908994596, 172.6357029740994, 195.7962083515731, 155.45, 156.1585048214613, 183.24625939867528, 145.1555299924251, 88.24804140690397, -13.156861825171065, 128.81252485518291, 146.54000000000008, -79.34208792466346, 161.536670561679, 192.69437137237975, 174.26, 180.07857642221248, 126.0565676477001, 175.15426363062443, -25.86905732850998, 161.58801527388357, 144.89324354803168, 136.9300121066895, 157.14414856003867, 184.336577698305, 122.48725318310527, -28.652652454776202, 144.2816956257775, 135.36597512410432, 37.73015744668493, 168.32, 153.875045343855, 169.10822411193453, 182.40664316908283, 182.529780663308, 170.04547259359998, 172.274033680167, 158.01562451522204, 20.61758122882715, 185.33215338447576, 153.90744690953062, 147.52805312316855, 154.45792750724746, 157.95491468814134, 169.47618857835252, 148.34538582549874, 185.43437204571504, 186.2109369886258, 164.2087480722797, 158.72389294837103, 111.65409793176062, 159.43956967690139, 200.0, 127.65703848932172, 55.70153660412514, 170.52198308071007, 149.6998151374716, 110.78114915661358, 190.69864174504454, 97.17199412246563, 64.13703590179271, 11.206231289760385, 183.16999999999996, 119.27407262214146, 162.48375220904435, 177.6749594720897, -3.9004052046858604, 164.3599999999999, 47.24517782609763, -39.73417452838395, 181.40069036131894, 185.8628538098152, 14.20095750408641, 17.492858453685606, 67.02051086811524, 119.30452170172427, 161.08131906915855, 158.97241708216075, 63.626153190937565, 172.58665321387622, 109.9773856700874, 15.43782651360826, 126.73999999999995, 189.98136965386902, -64.03565403759904, 187.230761080854, 193.64594351418822, 164.15373807285903, 152.56018978598996, 166.87768592450794, 183.70154279945584, 158.41999999999996, 171.72677562334195, 154.4558088156071, 170.02357021578297, 89.90613072363811, 173.1137940892308, 122.59812537214032, 34.078585408393295, 115.7981000534276, 126.18037748787832, 190.09999999999997, 175.013448946978, 99.86323328928832, 184.96649949101928, 32.0485898634331, 20.89143482374194, 166.77509252411997, 171.69096118965737, 104.73385962115125, 186.14, 50.78912924486555, -22.441329525981477, 70.44741768137068, 138.79160409930378, 191.20271951924275, 179.053641589702, -59.35620228822615, 51.856399320612255, 185.61061005093018, 148.40692596738188, 164.75830146042333, 64.96632706950523, 155.67636329055134, 94.31301558827639, 186.15104970871272, 117.98559255915004, 176.22649736174878, 162.82691531516102, 4.763305693495067, -13.99389465037535, 169.065472666932, 75.65085278088245, 93.2627743965322, 143.04079787711265, 169.31, -32.1443956239528], "policy_predator_policy_reward": [2.9621847556449246, 57.228205740324746, 2.872002816613749, 6.714000647618217, 3.077329976584528, 31.905225315413404, 37.441947601526785, 8.073060332694437, 4.710812581054347, 2.480967388256585, 63.38433231913746, 63.61969857086684, 0.0, 47.03830816523942, 56.27262751129394, 24.70784372780892, 3.2635929248415008, 1.6110690807910502, 14.59520724858837, 15.189634019369402, 87.65876084234084, 1.5273172827903694, 54.344428225815435, 48.78442606765324, 2.2867326796687766, 66.71110734459205, 25.090357913491857, 37.72781310547343, 3.5243908712904988, 0.0, 15.437011556629594, 11.307875092157968, 6.715870110114039, 0.9107654545790093, 14.741885740883381, 18.34551645476126, 22.74673637132373, 26.043589603043294, 20.73859731231658, 9.519115560017047, 38.86697545679003, 78.0312812839789, 10.880897813682278, 15.536962238690114, 167.0906342032316, 81.2005579135966, 95.75196827454177, 12.43772124641888, 2.067286459384628, 3.9387859427237815, 48.81740727571294, 38.0643610155547, 5.759011671539273, 24.725747464167423, 5.542053098431425, 3.664218668901921, 21.411650299102792, 8.872733834897629, 13.674521603281399, 9.7957904235142, 13.865485771189794, 0.0, 118.75428712505897, 4.947520232098781, 2.1078401576860615, 11.668165968754952, 0.0, 0.2337916484269049, 4.817513809962669, 0.6218099315243323, 24.278431307917344, 18.565732675172804, 16.186298270299, 69.98656813132425, 61.12280541500837, 70.75353022600852, 11.729140708047051, 1.1934227763461582, 2.0314235777875433, 0.0, 0.6698784242017505, 24.286219114096795, 39.83398614664221, 53.24009989703528, 11.140665699016543, 6.85295800675591, 0.6250106017565209, 10.015851439961335, 20.1496779578153, 45.85751633568764, 5.676647051626636, 12.225682198491567, 31.17523814459893, 70.79658075539088, 14.933819457595419, 8.11952549012827, 4.59335683091716, 0.3188286572993975, 18.394823690130746, 5.363751960545611, 8.103496922810265, 34.56588707094281, 3.5132037523281294, 2.5182641054622774, 2.9655708834924432, 34.95676025884293, 0.6402115608947754, 11.533811421647462, 18.674614174501237, 1.265081075649809, 7.787942665263858, 1.2289963092001817, 13.121193152459343, 10.56624159040062, 7.204969807523041, 9.610430323098575, 30.094591591891, 24.768806859645835, 3.8101268293477606, 12.766910730208375, 2.163934762301694, 18.39627433604021, 29.05476996618643, 13.70120639522911, 44.973768710239675, 6.947905964304082, 16.145436761510524, 4.3367384073036765, 34.80472703188016, 45.28137028448712, 44.13600153130708, 41.85274200846065, 57.4213283628139, 58.32347136079886, 51.76961214628426, 8.22524377086021, 6.265456597298445, 55.996414905320975, 11.779486746253875, 13.901782060394096, 12.445260198037163, 19.176244481388895, 22.524744880629147, 20.876117511069484, 17.96744958073447, 30.586534299268923, 45.577780450549966, 61.44952162470264, 0.0, 2.958848804967645, 10.807371447247087, 8.204951011288253, 0.0, 10.281522112424684, 8.104993706158984, 2.207191143418193, 13.268161732242934, 0.0, 19.683702689193396, 32.53395570080085, 41.325885271860926, 32.002287836025054, 20.90100884923907, 37.43145650735887, 1.1005401173217961, 5.986551053021996, 29.14246421470221, 22.857692188018795, 45.63455118804693, 54.12904135657622, 8.979903908709401, 8.271984935796068, 14.157304306766356, 21.96619822268057, 60.51726027182151, 37.877258222744025, 39.3351973308643, 7.735780888461248, 2.700785791873895, 1.8460538456029112, 106.70747928676602, 16.192226921326547, 1.439389949069814, 10.673074032618135, 0.9258503253286443, 20.099521144742827, 24.833319132256204, 16.388260163837195, 1.116793451742474, 11.494407440849953, 3.6122570947031534, 2.8981130256417007, 62.2818443625429, 37.398478681427925, 26.44076244085636, 6.257771116447521, 14.90003649801649, 8.321353385566841, 0.0, 53.21439562395289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7230468993305934, "mean_inference_ms": 2.2183486648851884, "mean_action_processing_ms": 0.3064687153480825, "mean_env_wait_ms": 0.2639624411301847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005005955696105957, "StateBufferConnector_ms": 0.014687061309814453, "ViewRequirementAgentConnector_ms": 0.21650230884552002}, "num_episodes": 18, "episode_return_max": 383.83555340000987, "episode_return_min": 90.44973408709056, "episode_return_mean": 281.0088929628353, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.106383722777, "num_env_steps_trained_throughput_per_sec": 300.106383722777, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 13347.038, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13346.984, "sample_time_ms": 2334.395, "learn_time_ms": 10990.018, "learn_throughput": 363.967, "synch_weights_time_ms": 20.896}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "ef79f_00000", "date": "2024-08-16_11-29-46", "timestamp": 1723787986, "time_this_iter_s": 13.389646768569946, "time_total_s": 761.8741674423218, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5312dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 761.8741674423218, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 62.284210526315796, "ram_util_percent": 82.40526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.496011686230463, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.944480529159465, "policy_loss": -0.0057296063043867, "vf_loss": 8.948997362833174, "vf_explained_var": -0.3479287583361227, "kl": 0.008085231719339411, "entropy": 0.93559891925287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.3318037094262545, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.970026532493571, "policy_loss": -0.006435005467202731, "vf_loss": 1.976458359300775, "vf_explained_var": 0.3739820824098335, "kl": 0.008138726703427017, "entropy": 0.3458831070749848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 383.83555340000987, "episode_reward_min": 90.44973408709056, "episode_reward_mean": 289.3479985415173, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -230.47251306516898, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 167.0906342032316}, "policy_reward_mean": {"prey_policy": 124.13230676710288, "predator_policy": 20.54169250365581}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.65187992637865, 177.87772124641887, 310.8472864593843, 223.5772693900585, 284.71818348232307, 348.55906689825173, 302.36173681594215, 307.1941792301893, 296.75999999999993, 191.48669109110614, 346.09999999999997, 351.48, 344.84408796162353, 276.24773538241914, 201.82852943163516, 199.07424771635354, 367.1536054184518, 356.3699999999999, 326.166928816623, 228.79304398905106, 299.8168793604936, 352.12158830006143, 159.84179502183198, 297.54999999999984, 308.0219763466747, 346.03661440351317, 369.8486093206074, 366.0780819244433, 221.3025897378022, 345.27106815179684, 339.9083117727514, 339.60512624903606, 353.7194531213647, 359.43662403536945, 294.0654256229915, 376.254969807523, 238.22197354498354, 336.79883577773785, 322.03999999999996, 204.06500638567377, 246.29790596430385, 302.23999999999995, 253.86065158377113, 297.5939213658654, 257.41131555654783, 260.0586672310461, 146.7752408244203, 306.0671095775304, 254.22007495252433, 325.9649012756623, 190.73181039361174, 232.9730176915229, 383.83555340000987, 335.7262503173842, 360.86075083638843, 340.4589604729191, 337.747540763633, 315.23758320286316, 230.00488388841939, 300.31094289790383, 372.2005401173218, 336.82988918302857, 152.70361723179812, 355.71794255828286, 326.99736215059806, 126.74231821344979, 256.31000000000006, 374.8032007464215, 115.39990324047874, 346.12999999999994, 250.74999999999994, 291.2109581749211, 316.7478431604552, 345.5637827972547, 90.44973408709056, 277.4148590051184, 259.5249621572281, 190.38, 304.55179068221275, 209.7828043601647, 295.153273964099, 336.3077396499758, 222.56310859883678, 329.6223771620575, 324.948911861445, 321.4599999999999, 240.1983683757376, 318.5376565130486, 254.95453335185198, 333.9923836895925, 212.73942004766917, 322.4426241107886, 301.2277867013984, 322.68672963666313, 334.6444490422073, 320.36567003548356, 311.0860027388924, 352.84960426595705, 359.23, 273.10350220301245], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-230.47251306516898, 178.83320087471955, -87.74196827454176, 157.43, 163.2512140572763, 141.59000000000015, -40.8060712109159, 177.50157230970672, 74.34425253583257, 179.88917181078384, 173.0127951309184, 166.33999999999997, 76.03735268194177, 196.03999999999996, 101.54386720339366, 182.17999999999995, 173.07706381466343, 109.81745041414673, 185.28096750356724, -117.49608376961883, 159.6882908994596, 172.6357029740994, 195.7962083515731, 155.45, 156.1585048214613, 183.24625939867528, 145.1555299924251, 88.24804140690397, -13.156861825171065, 128.81252485518291, 146.54000000000008, -79.34208792466346, 161.536670561679, 192.69437137237975, 174.26, 180.07857642221248, 126.0565676477001, 175.15426363062443, -25.86905732850998, 161.58801527388357, 144.89324354803168, 136.9300121066895, 157.14414856003867, 184.336577698305, 122.48725318310527, -28.652652454776202, 144.2816956257775, 135.36597512410432, 37.73015744668493, 168.32, 153.875045343855, 169.10822411193453, 182.40664316908283, 182.529780663308, 170.04547259359998, 172.274033680167, 158.01562451522204, 20.61758122882715, 185.33215338447576, 153.90744690953062, 147.52805312316855, 154.45792750724746, 157.95491468814134, 169.47618857835252, 148.34538582549874, 185.43437204571504, 186.2109369886258, 164.2087480722797, 158.72389294837103, 111.65409793176062, 159.43956967690139, 200.0, 127.65703848932172, 55.70153660412514, 170.52198308071007, 149.6998151374716, 110.78114915661358, 190.69864174504454, 97.17199412246563, 64.13703590179271, 11.206231289760385, 183.16999999999996, 119.27407262214146, 162.48375220904435, 177.6749594720897, -3.9004052046858604, 164.3599999999999, 47.24517782609763, -39.73417452838395, 181.40069036131894, 185.8628538098152, 14.20095750408641, 17.492858453685606, 67.02051086811524, 119.30452170172427, 161.08131906915855, 158.97241708216075, 63.626153190937565, 172.58665321387622, 109.9773856700874, 15.43782651360826, 126.73999999999995, 189.98136965386902, -64.03565403759904, 187.230761080854, 193.64594351418822, 164.15373807285903, 152.56018978598996, 166.87768592450794, 183.70154279945584, 158.41999999999996, 171.72677562334195, 154.4558088156071, 170.02357021578297, 89.90613072363811, 173.1137940892308, 122.59812537214032, 34.078585408393295, 115.7981000534276, 126.18037748787832, 190.09999999999997, 175.013448946978, 99.86323328928832, 184.96649949101928, 32.0485898634331, 20.89143482374194, 166.77509252411997, 171.69096118965737, 104.73385962115125, 186.14, 50.78912924486555, -22.441329525981477, 70.44741768137068, 138.79160409930378, 191.20271951924275, 179.053641589702, -59.35620228822615, 51.856399320612255, 185.61061005093018, 148.40692596738188, 164.75830146042333, 64.96632706950523, 155.67636329055134, 94.31301558827639, 186.15104970871272, 117.98559255915004, 176.22649736174878, 162.82691531516102, 4.763305693495067, -13.99389465037535, 169.065472666932, 75.65085278088245, 93.2627743965322, 143.04079787711265, 169.31, -32.1443956239528, 85.17323047048971, 193.6010599452713, -8.877949200877525, 149.6006135671849, 113.931378194314, 150.82356703245327, 144.41223439588663, 159.0722506843939, 36.32087659159719, 152.9645081433213, 163.18188466778258, 164.03141824383897, 124.5491270660897, 173.27, 150.70699285781888, 161.2914034368209, 35.92999723699356, 168.32, 165.28186961974487, 127.44115479097516, 122.15676274748304, 82.10319223631204, 158.69942276796593, 161.26033729580303, 179.53974001348166, -76.85235563424348, 118.768095583545, 189.6097929736841, 145.6282071252922, 144.45154537761294, 122.84759983744509, 160.44528605716692, 152.97557050017156, 165.08227704240483, 124.8764484594225, 150.48681189686528, 74.4309285144856, 198.01999999999998, 144.05620081509943, 188.42116959915813, 173.40013297523774, 182.16103454279377, 132.8955093077241, 110.492918422426], "policy_predator_policy_reward": [167.0906342032316, 81.2005579135966, 95.75196827454177, 12.43772124641888, 2.067286459384628, 3.9387859427237815, 48.81740727571294, 38.0643610155547, 5.759011671539273, 24.725747464167423, 5.542053098431425, 3.664218668901921, 21.411650299102792, 8.872733834897629, 13.674521603281399, 9.7957904235142, 13.865485771189794, 0.0, 118.75428712505897, 4.947520232098781, 2.1078401576860615, 11.668165968754952, 0.0, 0.2337916484269049, 4.817513809962669, 0.6218099315243323, 24.278431307917344, 18.565732675172804, 16.186298270299, 69.98656813132425, 61.12280541500837, 70.75353022600852, 11.729140708047051, 1.1934227763461582, 2.0314235777875433, 0.0, 0.6698784242017505, 24.286219114096795, 39.83398614664221, 53.24009989703528, 11.140665699016543, 6.85295800675591, 0.6250106017565209, 10.015851439961335, 20.1496779578153, 45.85751633568764, 5.676647051626636, 12.225682198491567, 31.17523814459893, 70.79658075539088, 14.933819457595419, 8.11952549012827, 4.59335683091716, 0.3188286572993975, 18.394823690130746, 5.363751960545611, 8.103496922810265, 34.56588707094281, 3.5132037523281294, 2.5182641054622774, 2.9655708834924432, 34.95676025884293, 0.6402115608947754, 11.533811421647462, 18.674614174501237, 1.265081075649809, 7.787942665263858, 1.2289963092001817, 13.121193152459343, 10.56624159040062, 7.204969807523041, 9.610430323098575, 30.094591591891, 24.768806859645835, 3.8101268293477606, 12.766910730208375, 2.163934762301694, 18.39627433604021, 29.05476996618643, 13.70120639522911, 44.973768710239675, 6.947905964304082, 16.145436761510524, 4.3367384073036765, 34.80472703188016, 45.28137028448712, 44.13600153130708, 41.85274200846065, 57.4213283628139, 58.32347136079886, 51.76961214628426, 8.22524377086021, 6.265456597298445, 55.996414905320975, 11.779486746253875, 13.901782060394096, 12.445260198037163, 19.176244481388895, 22.524744880629147, 20.876117511069484, 17.96744958073447, 30.586534299268923, 45.577780450549966, 61.44952162470264, 0.0, 2.958848804967645, 10.807371447247087, 8.204951011288253, 0.0, 10.281522112424684, 8.104993706158984, 2.207191143418193, 13.268161732242934, 0.0, 19.683702689193396, 32.53395570080085, 41.325885271860926, 32.002287836025054, 20.90100884923907, 37.43145650735887, 1.1005401173217961, 5.986551053021996, 29.14246421470221, 22.857692188018795, 45.63455118804693, 54.12904135657622, 8.979903908709401, 8.271984935796068, 14.157304306766356, 21.96619822268057, 60.51726027182151, 37.877258222744025, 39.3351973308643, 7.735780888461248, 2.700785791873895, 1.8460538456029112, 106.70747928676602, 16.192226921326547, 1.439389949069814, 10.673074032618135, 0.9258503253286443, 20.099521144742827, 24.833319132256204, 16.388260163837195, 1.116793451742474, 11.494407440849953, 3.6122570947031534, 2.8981130256417007, 62.2818443625429, 37.398478681427925, 26.44076244085636, 6.257771116447521, 14.90003649801649, 8.321353385566841, 0.0, 53.21439562395289, 7.071692220619558, 18.70580804583215, 36.513275831708, 32.54686416214933, 17.141475786764694, 13.256852950567291, 23.294781413885953, 9.528473155809397, 1.1337228442079577, 32.14400101971051, 0.20049249427500007, 2.20858175616096, 16.630872933910343, 10.498911861445192, 0.7873890035670799, 8.674214701793222, 7.053878433855233, 28.894492704888897, 0.8152816288600162, 24.999350473468528, 25.397919909861706, 25.296658458195438, 9.161670189072803, 4.8709534367510585, 9.117704620347167, 100.93433104808376, 8.129217910438296, 5.935517643121334, 7.592497630654213, 3.555536567839208, 22.629501184145365, 16.764342557905785, 6.166967724255399, 10.419633775375633, 31.58056128479487, 13.421848394400929, 18.280553547529802, 20.354520676876948, 11.975576506674791, 8.396657345024803, 2.8489654572062215, 0.819867024762266, 5.368877543641707, 24.346196929220593]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7305430517708759, "mean_inference_ms": 2.23634358979928, "mean_action_processing_ms": 0.30826331155346226, "mean_env_wait_ms": 0.26608263434894425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004908204078674316, "StateBufferConnector_ms": 0.014801979064941406, "ViewRequirementAgentConnector_ms": 0.19405746459960938}, "num_episodes": 22, "episode_return_max": 383.83555340000987, "episode_return_min": 90.44973408709056, "episode_return_mean": 289.3479985415173, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.2719336138865, "num_env_steps_trained_throughput_per_sec": 308.2719336138865, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 13362.987, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13362.933, "sample_time_ms": 2309.102, "learn_time_ms": 11031.383, "learn_throughput": 362.602, "synch_weights_time_ms": 20.613}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "ef79f_00000", "date": "2024-08-16_11-29-59", "timestamp": 1723787999, "time_this_iter_s": 13.023970127105713, "time_total_s": 774.8981375694275, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321437820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 774.8981375694275, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 62.094444444444434, "ram_util_percent": 82.27222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9256252640769596, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.764850397210903, "policy_loss": -0.004417902857518543, "vf_loss": 8.767679114064212, "vf_explained_var": -0.14026751874615906, "kl": 0.010594486176991644, "entropy": 0.9669342459824981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.171853850632117, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.950907875558056, "policy_loss": -0.005267099195736505, "vf_loss": 1.9561729311312317, "vf_explained_var": 0.3552916045857485, "kl": 0.005224696882145604, "entropy": 0.2751752753421743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 383.83555340000987, "episode_reward_min": 90.44973408709056, "episode_reward_mean": 291.9148144299646, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -76.85235563424348, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 106.70747928676602}, "policy_reward_mean": {"prey_policy": 127.7272377287128, "predator_policy": 18.230169486269535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.54999999999984, 308.0219763466747, 346.03661440351317, 369.8486093206074, 366.0780819244433, 221.3025897378022, 345.27106815179684, 339.9083117727514, 339.60512624903606, 353.7194531213647, 359.43662403536945, 294.0654256229915, 376.254969807523, 238.22197354498354, 336.79883577773785, 322.03999999999996, 204.06500638567377, 246.29790596430385, 302.23999999999995, 253.86065158377113, 297.5939213658654, 257.41131555654783, 260.0586672310461, 146.7752408244203, 306.0671095775304, 254.22007495252433, 325.9649012756623, 190.73181039361174, 232.9730176915229, 383.83555340000987, 335.7262503173842, 360.86075083638843, 340.4589604729191, 337.747540763633, 315.23758320286316, 230.00488388841939, 300.31094289790383, 372.2005401173218, 336.82988918302857, 152.70361723179812, 355.71794255828286, 326.99736215059806, 126.74231821344979, 256.31000000000006, 374.8032007464215, 115.39990324047874, 346.12999999999994, 250.74999999999994, 291.2109581749211, 316.7478431604552, 345.5637827972547, 90.44973408709056, 277.4148590051184, 259.5249621572281, 190.38, 304.55179068221275, 209.7828043601647, 295.153273964099, 336.3077396499758, 222.56310859883678, 329.6223771620575, 324.948911861445, 321.4599999999999, 240.1983683757376, 318.5376565130486, 254.95453335185198, 333.9923836895925, 212.73942004766917, 322.4426241107886, 301.2277867013984, 322.68672963666313, 334.6444490422073, 320.36567003548356, 311.0860027388924, 352.84960426595705, 359.23, 273.10350220301245, 239.53868363099423, 268.7260518620653, 307.86171481812517, 350.33760665379975, 294.45278179669657, 306.1892466753899, 326.21, 315.5406508403055, 297.509622759358, 168.14830172269188, 352.36999999999983, 323.6406247333605, 310.4883885089181, 246.79216188333658, 333.4377252494754, 250.6686300420349, 262.59191209895636, 351.31146135977446, 311.1674016544965, 323.2024547577989, 304.06443355476597, 107.84419018098055, 354.45999999999975], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [144.2816956257775, 135.36597512410432, 37.73015744668493, 168.32, 153.875045343855, 169.10822411193453, 182.40664316908283, 182.529780663308, 170.04547259359998, 172.274033680167, 158.01562451522204, 20.61758122882715, 185.33215338447576, 153.90744690953062, 147.52805312316855, 154.45792750724746, 157.95491468814134, 169.47618857835252, 148.34538582549874, 185.43437204571504, 186.2109369886258, 164.2087480722797, 158.72389294837103, 111.65409793176062, 159.43956967690139, 200.0, 127.65703848932172, 55.70153660412514, 170.52198308071007, 149.6998151374716, 110.78114915661358, 190.69864174504454, 97.17199412246563, 64.13703590179271, 11.206231289760385, 183.16999999999996, 119.27407262214146, 162.48375220904435, 177.6749594720897, -3.9004052046858604, 164.3599999999999, 47.24517782609763, -39.73417452838395, 181.40069036131894, 185.8628538098152, 14.20095750408641, 17.492858453685606, 67.02051086811524, 119.30452170172427, 161.08131906915855, 158.97241708216075, 63.626153190937565, 172.58665321387622, 109.9773856700874, 15.43782651360826, 126.73999999999995, 189.98136965386902, -64.03565403759904, 187.230761080854, 193.64594351418822, 164.15373807285903, 152.56018978598996, 166.87768592450794, 183.70154279945584, 158.41999999999996, 171.72677562334195, 154.4558088156071, 170.02357021578297, 89.90613072363811, 173.1137940892308, 122.59812537214032, 34.078585408393295, 115.7981000534276, 126.18037748787832, 190.09999999999997, 175.013448946978, 99.86323328928832, 184.96649949101928, 32.0485898634331, 20.89143482374194, 166.77509252411997, 171.69096118965737, 104.73385962115125, 186.14, 50.78912924486555, -22.441329525981477, 70.44741768137068, 138.79160409930378, 191.20271951924275, 179.053641589702, -59.35620228822615, 51.856399320612255, 185.61061005093018, 148.40692596738188, 164.75830146042333, 64.96632706950523, 155.67636329055134, 94.31301558827639, 186.15104970871272, 117.98559255915004, 176.22649736174878, 162.82691531516102, 4.763305693495067, -13.99389465037535, 169.065472666932, 75.65085278088245, 93.2627743965322, 143.04079787711265, 169.31, -32.1443956239528, 85.17323047048971, 193.6010599452713, -8.877949200877525, 149.6006135671849, 113.931378194314, 150.82356703245327, 144.41223439588663, 159.0722506843939, 36.32087659159719, 152.9645081433213, 163.18188466778258, 164.03141824383897, 124.5491270660897, 173.27, 150.70699285781888, 161.2914034368209, 35.92999723699356, 168.32, 165.28186961974487, 127.44115479097516, 122.15676274748304, 82.10319223631204, 158.69942276796593, 161.26033729580303, 179.53974001348166, -76.85235563424348, 118.768095583545, 189.6097929736841, 145.6282071252922, 144.45154537761294, 122.84759983744509, 160.44528605716692, 152.97557050017156, 165.08227704240483, 124.8764484594225, 150.48681189686528, 74.4309285144856, 198.01999999999998, 144.05620081509943, 188.42116959915813, 173.40013297523774, 182.16103454279377, 132.8955093077241, 110.492918422426, 15.242638704020287, 156.44000000000005, 53.532669651024044, 154.3688661244969, 126.19857886943495, 158.03010960218344, 144.47920353187595, 180.19999999999996, 112.00127299377148, 154.73722798010724, 171.29000000000002, 114.2059306402648, 142.4485874417636, 160.8719115606171, 147.42331008604316, 152.94514628475522, 92.32208306979447, 168.61380087847243, 14.990456993349571, 108.9671502551869, 171.29786437691035, 177.37514740567326, 158.53158689341063, 145.36129983698487, 145.30856235014602, 153.74544563218177, 88.20405664150937, 137.82781283964997, 106.94789496635275, 183.55608926757733, 28.028837934099723, 169.10730485254916, 57.4868490401906, 178.69936826636754, 180.20000000000005, 140.4308126599566, 137.22634523211647, 153.91766965126362, 160.07622832913256, 143.55129200812638, 129.86283266739704, 148.19447137882148, 11.418035211421376, -9.616184599003546, 191.08999999999997, 163.37], "policy_predator_policy_reward": [5.676647051626636, 12.225682198491567, 31.17523814459893, 70.79658075539088, 14.933819457595419, 8.11952549012827, 4.59335683091716, 0.3188286572993975, 18.394823690130746, 5.363751960545611, 8.103496922810265, 34.56588707094281, 3.5132037523281294, 2.5182641054622774, 2.9655708834924432, 34.95676025884293, 0.6402115608947754, 11.533811421647462, 18.674614174501237, 1.265081075649809, 7.787942665263858, 1.2289963092001817, 13.121193152459343, 10.56624159040062, 7.204969807523041, 9.610430323098575, 30.094591591891, 24.768806859645835, 3.8101268293477606, 12.766910730208375, 2.163934762301694, 18.39627433604021, 29.05476996618643, 13.70120639522911, 44.973768710239675, 6.947905964304082, 16.145436761510524, 4.3367384073036765, 34.80472703188016, 45.28137028448712, 44.13600153130708, 41.85274200846065, 57.4213283628139, 58.32347136079886, 51.76961214628426, 8.22524377086021, 6.265456597298445, 55.996414905320975, 11.779486746253875, 13.901782060394096, 12.445260198037163, 19.176244481388895, 22.524744880629147, 20.876117511069484, 17.96744958073447, 30.586534299268923, 45.577780450549966, 61.44952162470264, 0.0, 2.958848804967645, 10.807371447247087, 8.204951011288253, 0.0, 10.281522112424684, 8.104993706158984, 2.207191143418193, 13.268161732242934, 0.0, 19.683702689193396, 32.53395570080085, 41.325885271860926, 32.002287836025054, 20.90100884923907, 37.43145650735887, 1.1005401173217961, 5.986551053021996, 29.14246421470221, 22.857692188018795, 45.63455118804693, 54.12904135657622, 8.979903908709401, 8.271984935796068, 14.157304306766356, 21.96619822268057, 60.51726027182151, 37.877258222744025, 39.3351973308643, 7.735780888461248, 2.700785791873895, 1.8460538456029112, 106.70747928676602, 16.192226921326547, 1.439389949069814, 10.673074032618135, 0.9258503253286443, 20.099521144742827, 24.833319132256204, 16.388260163837195, 1.116793451742474, 11.494407440849953, 3.6122570947031534, 2.8981130256417007, 62.2818443625429, 37.398478681427925, 26.44076244085636, 6.257771116447521, 14.90003649801649, 8.321353385566841, 0.0, 53.21439562395289, 7.071692220619558, 18.70580804583215, 36.513275831708, 32.54686416214933, 17.141475786764694, 13.256852950567291, 23.294781413885953, 9.528473155809397, 1.1337228442079577, 32.14400101971051, 0.20049249427500007, 2.20858175616096, 16.630872933910343, 10.498911861445192, 0.7873890035670799, 8.674214701793222, 7.053878433855233, 28.894492704888897, 0.8152816288600162, 24.999350473468528, 25.397919909861706, 25.296658458195438, 9.161670189072803, 4.8709534367510585, 9.117704620347167, 100.93433104808376, 8.129217910438296, 5.935517643121334, 7.592497630654213, 3.555536567839208, 22.629501184145365, 16.764342557905785, 6.166967724255399, 10.419633775375633, 31.58056128479487, 13.421848394400929, 18.280553547529802, 20.354520676876948, 11.975576506674791, 8.396657345024803, 2.8489654572062215, 0.819867024762266, 5.368877543641707, 24.346196929220593, 30.411965878139664, 37.44407904883447, 33.2604736636822, 27.56404242286228, 16.555576732368905, 7.077449614137848, 8.58174196940512, 17.076661152518664, 4.177924385790023, 23.536356437027823, 11.52880976407706, 9.16450627104815, 19.808990612603377, 3.0805103850159568, 6.227628739310429, 8.944565730197017, 13.054792218206764, 23.51894659288446, 4.692060523225176, 39.498633950930206, 0.922135623089525, 2.7748525943267515, 9.160007330238862, 10.587730672726197, 7.714115326347148, 3.720265200243186, 4.228458309447602, 16.531834092729813, 36.54438714163851, 6.389353873906851, 21.612166698559165, 31.920320556826887, 1.2211930760506255, 25.184501716347583, 16.24218863901871, 14.438460060799352, 3.1266104852182464, 16.8967762858982, 12.064940448338028, 7.509993972202, 1.5436237707972043, 24.463505737750218, 9.055387249577905, 96.98695231898482, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7366817718507745, "mean_inference_ms": 2.2484050869274075, "mean_action_processing_ms": 0.30922677075421295, "mean_env_wait_ms": 0.2668077306211378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004813194274902344, "StateBufferConnector_ms": 0.014801263809204102, "ViewRequirementAgentConnector_ms": 0.17679369449615479}, "num_episodes": 23, "episode_return_max": 383.83555340000987, "episode_return_min": 90.44973408709056, "episode_return_mean": 291.9148144299646, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.6515531736842, "num_env_steps_trained_throughput_per_sec": 298.6515531736842, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 13280.068, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13280.014, "sample_time_ms": 2174.493, "learn_time_ms": 11084.876, "learn_throughput": 360.852, "synch_weights_time_ms": 18.716}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "ef79f_00000", "date": "2024-08-16_11-30-12", "timestamp": 1723788012, "time_this_iter_s": 13.44700002670288, "time_total_s": 788.3451375961304, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32147fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 788.3451375961304, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 64.42105263157893, "ram_util_percent": 82.53684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6897014644410877, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.79405299645883, "policy_loss": -0.008249448411777695, "vf_loss": 8.800635871433077, "vf_explained_var": 0.03720481922386815, "kl": 0.011110564545821806, "entropy": 0.9090765246007808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.330505267211369, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8110338937353205, "policy_loss": -0.004793032301619413, "vf_loss": 1.815824729803378, "vf_explained_var": 0.2165886109152799, "kl": 0.005614559892556087, "entropy": 0.27319333440569976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 383.83555340000987, "episode_reward_min": 90.44973408709056, "episode_reward_mean": 290.64940812615095, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -76.85235563424348, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 106.70747928676602}, "policy_reward_mean": {"prey_policy": 126.6189566209344, "predator_policy": 18.705747442141114}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.23999999999995, 253.86065158377113, 297.5939213658654, 257.41131555654783, 260.0586672310461, 146.7752408244203, 306.0671095775304, 254.22007495252433, 325.9649012756623, 190.73181039361174, 232.9730176915229, 383.83555340000987, 335.7262503173842, 360.86075083638843, 340.4589604729191, 337.747540763633, 315.23758320286316, 230.00488388841939, 300.31094289790383, 372.2005401173218, 336.82988918302857, 152.70361723179812, 355.71794255828286, 326.99736215059806, 126.74231821344979, 256.31000000000006, 374.8032007464215, 115.39990324047874, 346.12999999999994, 250.74999999999994, 291.2109581749211, 316.7478431604552, 345.5637827972547, 90.44973408709056, 277.4148590051184, 259.5249621572281, 190.38, 304.55179068221275, 209.7828043601647, 295.153273964099, 336.3077396499758, 222.56310859883678, 329.6223771620575, 324.948911861445, 321.4599999999999, 240.1983683757376, 318.5376565130486, 254.95453335185198, 333.9923836895925, 212.73942004766917, 322.4426241107886, 301.2277867013984, 322.68672963666313, 334.6444490422073, 320.36567003548356, 311.0860027388924, 352.84960426595705, 359.23, 273.10350220301245, 239.53868363099423, 268.7260518620653, 307.86171481812517, 350.33760665379975, 294.45278179669657, 306.1892466753899, 326.21, 315.5406508403055, 297.509622759358, 168.14830172269188, 352.36999999999983, 323.6406247333605, 310.4883885089181, 246.79216188333658, 333.4377252494754, 250.6686300420349, 262.59191209895636, 351.31146135977446, 311.1674016544965, 323.2024547577989, 304.06443355476597, 107.84419018098055, 354.45999999999975, 327.98935915838587, 323.96783953960534, 254.57065701473226, 363.3989918174086, 332.1778009648449, 316.26776184769636, 246.71637039926543, 351.4983553955436, 337.2213336920323, 354.70389446830603, 283.941222947888, 325.38022400215067, 265.1715899493057, 353.5718434227066, 222.13805039572603, 316.1092358626223, 324.22999999999996, 238.92741090698604], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [119.27407262214146, 162.48375220904435, 177.6749594720897, -3.9004052046858604, 164.3599999999999, 47.24517782609763, -39.73417452838395, 181.40069036131894, 185.8628538098152, 14.20095750408641, 17.492858453685606, 67.02051086811524, 119.30452170172427, 161.08131906915855, 158.97241708216075, 63.626153190937565, 172.58665321387622, 109.9773856700874, 15.43782651360826, 126.73999999999995, 189.98136965386902, -64.03565403759904, 187.230761080854, 193.64594351418822, 164.15373807285903, 152.56018978598996, 166.87768592450794, 183.70154279945584, 158.41999999999996, 171.72677562334195, 154.4558088156071, 170.02357021578297, 89.90613072363811, 173.1137940892308, 122.59812537214032, 34.078585408393295, 115.7981000534276, 126.18037748787832, 190.09999999999997, 175.013448946978, 99.86323328928832, 184.96649949101928, 32.0485898634331, 20.89143482374194, 166.77509252411997, 171.69096118965737, 104.73385962115125, 186.14, 50.78912924486555, -22.441329525981477, 70.44741768137068, 138.79160409930378, 191.20271951924275, 179.053641589702, -59.35620228822615, 51.856399320612255, 185.61061005093018, 148.40692596738188, 164.75830146042333, 64.96632706950523, 155.67636329055134, 94.31301558827639, 186.15104970871272, 117.98559255915004, 176.22649736174878, 162.82691531516102, 4.763305693495067, -13.99389465037535, 169.065472666932, 75.65085278088245, 93.2627743965322, 143.04079787711265, 169.31, -32.1443956239528, 85.17323047048971, 193.6010599452713, -8.877949200877525, 149.6006135671849, 113.931378194314, 150.82356703245327, 144.41223439588663, 159.0722506843939, 36.32087659159719, 152.9645081433213, 163.18188466778258, 164.03141824383897, 124.5491270660897, 173.27, 150.70699285781888, 161.2914034368209, 35.92999723699356, 168.32, 165.28186961974487, 127.44115479097516, 122.15676274748304, 82.10319223631204, 158.69942276796593, 161.26033729580303, 179.53974001348166, -76.85235563424348, 118.768095583545, 189.6097929736841, 145.6282071252922, 144.45154537761294, 122.84759983744509, 160.44528605716692, 152.97557050017156, 165.08227704240483, 124.8764484594225, 150.48681189686528, 74.4309285144856, 198.01999999999998, 144.05620081509943, 188.42116959915813, 173.40013297523774, 182.16103454279377, 132.8955093077241, 110.492918422426, 15.242638704020287, 156.44000000000005, 53.532669651024044, 154.3688661244969, 126.19857886943495, 158.03010960218344, 144.47920353187595, 180.19999999999996, 112.00127299377148, 154.73722798010724, 171.29000000000002, 114.2059306402648, 142.4485874417636, 160.8719115606171, 147.42331008604316, 152.94514628475522, 92.32208306979447, 168.61380087847243, 14.990456993349571, 108.9671502551869, 171.29786437691035, 177.37514740567326, 158.53158689341063, 145.36129983698487, 145.30856235014602, 153.74544563218177, 88.20405664150937, 137.82781283964997, 106.94789496635275, 183.55608926757733, 28.028837934099723, 169.10730485254916, 57.4868490401906, 178.69936826636754, 180.20000000000005, 140.4308126599566, 137.22634523211647, 153.91766965126362, 160.07622832913256, 143.55129200812638, 129.86283266739704, 148.19447137882148, 11.418035211421376, -9.616184599003546, 191.08999999999997, 163.37, 153.37258929751857, 126.6701448643343, 137.26419611332994, 162.08622801890937, 63.49015597921228, 160.35956462195537, 186.14, 159.1002508237597, 128.99021020331028, 182.78652958625912, 149.04056539054415, 157.913861391543, 132.98402091328597, 60.67133843377712, 148.97769655193912, 184.16, 184.55658035519832, 118.54938642281394, 168.64147461446345, 176.07136641229675, 114.34482862318112, 134.12326924296502, 152.31607341747585, 165.3277752067198, 186.18869737273238, -1.6981187547113858, 163.07175457209897, 166.55950272250305, 58.772132512745834, 73.33760033218073, 100.87279254755948, 175.8262541320062, 103.0122348958261, 197.02999999999997, 75.35067585296605, 110.07149248355516], "policy_predator_policy_reward": [16.145436761510524, 4.3367384073036765, 34.80472703188016, 45.28137028448712, 44.13600153130708, 41.85274200846065, 57.4213283628139, 58.32347136079886, 51.76961214628426, 8.22524377086021, 6.265456597298445, 55.996414905320975, 11.779486746253875, 13.901782060394096, 12.445260198037163, 19.176244481388895, 22.524744880629147, 20.876117511069484, 17.96744958073447, 30.586534299268923, 45.577780450549966, 61.44952162470264, 0.0, 2.958848804967645, 10.807371447247087, 8.204951011288253, 0.0, 10.281522112424684, 8.104993706158984, 2.207191143418193, 13.268161732242934, 0.0, 19.683702689193396, 32.53395570080085, 41.325885271860926, 32.002287836025054, 20.90100884923907, 37.43145650735887, 1.1005401173217961, 5.986551053021996, 29.14246421470221, 22.857692188018795, 45.63455118804693, 54.12904135657622, 8.979903908709401, 8.271984935796068, 14.157304306766356, 21.96619822268057, 60.51726027182151, 37.877258222744025, 39.3351973308643, 7.735780888461248, 2.700785791873895, 1.8460538456029112, 106.70747928676602, 16.192226921326547, 1.439389949069814, 10.673074032618135, 0.9258503253286443, 20.099521144742827, 24.833319132256204, 16.388260163837195, 1.116793451742474, 11.494407440849953, 3.6122570947031534, 2.8981130256417007, 62.2818443625429, 37.398478681427925, 26.44076244085636, 6.257771116447521, 14.90003649801649, 8.321353385566841, 0.0, 53.21439562395289, 7.071692220619558, 18.70580804583215, 36.513275831708, 32.54686416214933, 17.141475786764694, 13.256852950567291, 23.294781413885953, 9.528473155809397, 1.1337228442079577, 32.14400101971051, 0.20049249427500007, 2.20858175616096, 16.630872933910343, 10.498911861445192, 0.7873890035670799, 8.674214701793222, 7.053878433855233, 28.894492704888897, 0.8152816288600162, 24.999350473468528, 25.397919909861706, 25.296658458195438, 9.161670189072803, 4.8709534367510585, 9.117704620347167, 100.93433104808376, 8.129217910438296, 5.935517643121334, 7.592497630654213, 3.555536567839208, 22.629501184145365, 16.764342557905785, 6.166967724255399, 10.419633775375633, 31.58056128479487, 13.421848394400929, 18.280553547529802, 20.354520676876948, 11.975576506674791, 8.396657345024803, 2.8489654572062215, 0.819867024762266, 5.368877543641707, 24.346196929220593, 30.411965878139664, 37.44407904883447, 33.2604736636822, 27.56404242286228, 16.555576732368905, 7.077449614137848, 8.58174196940512, 17.076661152518664, 4.177924385790023, 23.536356437027823, 11.52880976407706, 9.16450627104815, 19.808990612603377, 3.0805103850159568, 6.227628739310429, 8.944565730197017, 13.054792218206764, 23.51894659288446, 4.692060523225176, 39.498633950930206, 0.922135623089525, 2.7748525943267515, 9.160007330238862, 10.587730672726197, 7.714115326347148, 3.720265200243186, 4.228458309447602, 16.531834092729813, 36.54438714163851, 6.389353873906851, 21.612166698559165, 31.920320556826887, 1.2211930760506255, 25.184501716347583, 16.24218863901871, 14.438460060799352, 3.1266104852182464, 16.8967762858982, 12.064940448338028, 7.509993972202, 1.5436237707972043, 24.463505737750218, 9.055387249577905, 96.98695231898482, 0.0, 0.0, 12.45119769040962, 35.49542730612352, 17.577429678800364, 7.0399857285657275, 16.01065165783548, 14.710284755729292, 8.187784929164412, 9.970956064484636, 6.6970986282142215, 13.703962547061293, 0.0, 9.313335065609282, 12.331697983043965, 40.72931306915834, 14.114259833449681, 4.246399010154777, 24.036467331137207, 10.078899582882983, 3.466231997361792, 6.524821444184062, 18.6427565961708, 16.83036848557125, 1.814046881050892, 5.922328496904192, 42.88271340214005, 37.79829792914474, 11.539128929276071, 12.401457198828501, 31.29930516222714, 58.729012388572215, 21.120115064632028, 18.290074118424627, 0.1572306005324116, 24.030534503641498, 18.317743294047318, 35.18749927641781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7385321153911795, "mean_inference_ms": 2.2558749634117294, "mean_action_processing_ms": 0.3101986462611404, "mean_env_wait_ms": 0.26782930116210074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426360130310059, "StateBufferConnector_ms": 0.014690756797790527, "ViewRequirementAgentConnector_ms": 0.1633586883544922}, "num_episodes": 18, "episode_return_max": 383.83555340000987, "episode_return_min": 90.44973408709056, "episode_return_mean": 290.64940812615095, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.7677463712021, "num_env_steps_trained_throughput_per_sec": 308.7677463712021, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 13222.296, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13222.245, "sample_time_ms": 2089.396, "learn_time_ms": 11112.069, "learn_throughput": 359.969, "synch_weights_time_ms": 18.906}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "ef79f_00000", "date": "2024-08-16_11-30-25", "timestamp": 1723788025, "time_this_iter_s": 13.010323286056519, "time_total_s": 801.3554608821869, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214bab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 801.3554608821869, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 63.142105263157895, "ram_util_percent": 82.41052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.090776110483856, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.663748387180307, "policy_loss": -0.006246764906411054, "vf_loss": 8.667534617519884, "vf_explained_var": -0.3318213995171602, "kl": 0.016403583364208753, "entropy": 0.9971869403723056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.003976393250562, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5530233362995127, "policy_loss": -0.005320022731561154, "vf_loss": 2.558341375608293, "vf_explained_var": 0.36530514419394194, "kl": 0.005092853389517485, "entropy": 0.28134793933264163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 389.10999999999996, "episode_reward_min": 90.44973408709056, "episode_reward_mean": 296.4036844588183, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -76.85235563424348, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 106.70747928676602}, "policy_reward_mean": {"prey_policy": 131.32367080462834, "predator_policy": 16.87817142478083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.31094289790383, 372.2005401173218, 336.82988918302857, 152.70361723179812, 355.71794255828286, 326.99736215059806, 126.74231821344979, 256.31000000000006, 374.8032007464215, 115.39990324047874, 346.12999999999994, 250.74999999999994, 291.2109581749211, 316.7478431604552, 345.5637827972547, 90.44973408709056, 277.4148590051184, 259.5249621572281, 190.38, 304.55179068221275, 209.7828043601647, 295.153273964099, 336.3077396499758, 222.56310859883678, 329.6223771620575, 324.948911861445, 321.4599999999999, 240.1983683757376, 318.5376565130486, 254.95453335185198, 333.9923836895925, 212.73942004766917, 322.4426241107886, 301.2277867013984, 322.68672963666313, 334.6444490422073, 320.36567003548356, 311.0860027388924, 352.84960426595705, 359.23, 273.10350220301245, 239.53868363099423, 268.7260518620653, 307.86171481812517, 350.33760665379975, 294.45278179669657, 306.1892466753899, 326.21, 315.5406508403055, 297.509622759358, 168.14830172269188, 352.36999999999983, 323.6406247333605, 310.4883885089181, 246.79216188333658, 333.4377252494754, 250.6686300420349, 262.59191209895636, 351.31146135977446, 311.1674016544965, 323.2024547577989, 304.06443355476597, 107.84419018098055, 354.45999999999975, 327.98935915838587, 323.96783953960534, 254.57065701473226, 363.3989918174086, 332.1778009648449, 316.26776184769636, 246.71637039926543, 351.4983553955436, 337.2213336920323, 354.70389446830603, 283.941222947888, 325.38022400215067, 265.1715899493057, 353.5718434227066, 222.13805039572603, 316.1092358626223, 324.22999999999996, 238.92741090698604, 366.6848653634212, 300.31, 380.16999999999996, 306.72215433672784, 344.3459702944207, 389.10999999999996, 309.3566937853693, 249.327917517174, 370.27, 320.79072316020563, 297.8039723983227, 296.7807686084742, 327.63734277909634, 346.24999999999994, 307.89728074615107, 270.13192205935184, 255.62572499837387, 267.98053055376175], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [115.7981000534276, 126.18037748787832, 190.09999999999997, 175.013448946978, 99.86323328928832, 184.96649949101928, 32.0485898634331, 20.89143482374194, 166.77509252411997, 171.69096118965737, 104.73385962115125, 186.14, 50.78912924486555, -22.441329525981477, 70.44741768137068, 138.79160409930378, 191.20271951924275, 179.053641589702, -59.35620228822615, 51.856399320612255, 185.61061005093018, 148.40692596738188, 164.75830146042333, 64.96632706950523, 155.67636329055134, 94.31301558827639, 186.15104970871272, 117.98559255915004, 176.22649736174878, 162.82691531516102, 4.763305693495067, -13.99389465037535, 169.065472666932, 75.65085278088245, 93.2627743965322, 143.04079787711265, 169.31, -32.1443956239528, 85.17323047048971, 193.6010599452713, -8.877949200877525, 149.6006135671849, 113.931378194314, 150.82356703245327, 144.41223439588663, 159.0722506843939, 36.32087659159719, 152.9645081433213, 163.18188466778258, 164.03141824383897, 124.5491270660897, 173.27, 150.70699285781888, 161.2914034368209, 35.92999723699356, 168.32, 165.28186961974487, 127.44115479097516, 122.15676274748304, 82.10319223631204, 158.69942276796593, 161.26033729580303, 179.53974001348166, -76.85235563424348, 118.768095583545, 189.6097929736841, 145.6282071252922, 144.45154537761294, 122.84759983744509, 160.44528605716692, 152.97557050017156, 165.08227704240483, 124.8764484594225, 150.48681189686528, 74.4309285144856, 198.01999999999998, 144.05620081509943, 188.42116959915813, 173.40013297523774, 182.16103454279377, 132.8955093077241, 110.492918422426, 15.242638704020287, 156.44000000000005, 53.532669651024044, 154.3688661244969, 126.19857886943495, 158.03010960218344, 144.47920353187595, 180.19999999999996, 112.00127299377148, 154.73722798010724, 171.29000000000002, 114.2059306402648, 142.4485874417636, 160.8719115606171, 147.42331008604316, 152.94514628475522, 92.32208306979447, 168.61380087847243, 14.990456993349571, 108.9671502551869, 171.29786437691035, 177.37514740567326, 158.53158689341063, 145.36129983698487, 145.30856235014602, 153.74544563218177, 88.20405664150937, 137.82781283964997, 106.94789496635275, 183.55608926757733, 28.028837934099723, 169.10730485254916, 57.4868490401906, 178.69936826636754, 180.20000000000005, 140.4308126599566, 137.22634523211647, 153.91766965126362, 160.07622832913256, 143.55129200812638, 129.86283266739704, 148.19447137882148, 11.418035211421376, -9.616184599003546, 191.08999999999997, 163.37, 153.37258929751857, 126.6701448643343, 137.26419611332994, 162.08622801890937, 63.49015597921228, 160.35956462195537, 186.14, 159.1002508237597, 128.99021020331028, 182.78652958625912, 149.04056539054415, 157.913861391543, 132.98402091328597, 60.67133843377712, 148.97769655193912, 184.16, 184.55658035519832, 118.54938642281394, 168.64147461446345, 176.07136641229675, 114.34482862318112, 134.12326924296502, 152.31607341747585, 165.3277752067198, 186.18869737273238, -1.6981187547113858, 163.07175457209897, 166.55950272250305, 58.772132512745834, 73.33760033218073, 100.87279254755948, 175.8262541320062, 103.0122348958261, 197.02999999999997, 75.35067585296605, 110.07149248355516, 147.35868096051797, 191.08999999999997, 160.69328775338354, 112.66247572439124, 195.05, 184.66313014266848, 168.12291702661162, 115.37172242084925, 140.80501665405666, 187.77904674422717, 189.10999999999996, 200.0, 155.98677322494, 136.23191170242586, 145.80000122577218, 31.525137128810066, 180.69718946406874, 189.10999999999999, 133.1356764513942, 180.12482918243347, 153.40761654798587, 94.57024964064604, 125.91978325197701, 148.49089483373209, 163.30748938939274, 133.10451583998054, 179.20999999999998, 160.92417867902148, 157.92197278120335, 115.11696821393772, 88.52323944462185, 139.64554814817546, 41.91611273919156, 168.07017863284617, 41.09520871325179, 153.94698095341113], "policy_predator_policy_reward": [20.90100884923907, 37.43145650735887, 1.1005401173217961, 5.986551053021996, 29.14246421470221, 22.857692188018795, 45.63455118804693, 54.12904135657622, 8.979903908709401, 8.271984935796068, 14.157304306766356, 21.96619822268057, 60.51726027182151, 37.877258222744025, 39.3351973308643, 7.735780888461248, 2.700785791873895, 1.8460538456029112, 106.70747928676602, 16.192226921326547, 1.439389949069814, 10.673074032618135, 0.9258503253286443, 20.099521144742827, 24.833319132256204, 16.388260163837195, 1.116793451742474, 11.494407440849953, 3.6122570947031534, 2.8981130256417007, 62.2818443625429, 37.398478681427925, 26.44076244085636, 6.257771116447521, 14.90003649801649, 8.321353385566841, 0.0, 53.21439562395289, 7.071692220619558, 18.70580804583215, 36.513275831708, 32.54686416214933, 17.141475786764694, 13.256852950567291, 23.294781413885953, 9.528473155809397, 1.1337228442079577, 32.14400101971051, 0.20049249427500007, 2.20858175616096, 16.630872933910343, 10.498911861445192, 0.7873890035670799, 8.674214701793222, 7.053878433855233, 28.894492704888897, 0.8152816288600162, 24.999350473468528, 25.397919909861706, 25.296658458195438, 9.161670189072803, 4.8709534367510585, 9.117704620347167, 100.93433104808376, 8.129217910438296, 5.935517643121334, 7.592497630654213, 3.555536567839208, 22.629501184145365, 16.764342557905785, 6.166967724255399, 10.419633775375633, 31.58056128479487, 13.421848394400929, 18.280553547529802, 20.354520676876948, 11.975576506674791, 8.396657345024803, 2.8489654572062215, 0.819867024762266, 5.368877543641707, 24.346196929220593, 30.411965878139664, 37.44407904883447, 33.2604736636822, 27.56404242286228, 16.555576732368905, 7.077449614137848, 8.58174196940512, 17.076661152518664, 4.177924385790023, 23.536356437027823, 11.52880976407706, 9.16450627104815, 19.808990612603377, 3.0805103850159568, 6.227628739310429, 8.944565730197017, 13.054792218206764, 23.51894659288446, 4.692060523225176, 39.498633950930206, 0.922135623089525, 2.7748525943267515, 9.160007330238862, 10.587730672726197, 7.714115326347148, 3.720265200243186, 4.228458309447602, 16.531834092729813, 36.54438714163851, 6.389353873906851, 21.612166698559165, 31.920320556826887, 1.2211930760506255, 25.184501716347583, 16.24218863901871, 14.438460060799352, 3.1266104852182464, 16.8967762858982, 12.064940448338028, 7.509993972202, 1.5436237707972043, 24.463505737750218, 9.055387249577905, 96.98695231898482, 0.0, 0.0, 12.45119769040962, 35.49542730612352, 17.577429678800364, 7.0399857285657275, 16.01065165783548, 14.710284755729292, 8.187784929164412, 9.970956064484636, 6.6970986282142215, 13.703962547061293, 0.0, 9.313335065609282, 12.331697983043965, 40.72931306915834, 14.114259833449681, 4.246399010154777, 24.036467331137207, 10.078899582882983, 3.466231997361792, 6.524821444184062, 18.6427565961708, 16.83036848557125, 1.814046881050892, 5.922328496904192, 42.88271340214005, 37.79829792914474, 11.539128929276071, 12.401457198828501, 31.29930516222714, 58.729012388572215, 21.120115064632028, 18.290074118424627, 0.1572306005324116, 24.030534503641498, 18.317743294047318, 35.18749927641781, 20.741319039482033, 7.494865363421219, 7.244439740897164, 19.709796781328038, 0.0, 0.4568698573315486, 13.539350118280765, 9.688164770986267, 15.26498334594332, 0.4969235501935618, 0.0, 0.0, 11.681094012973091, 5.456914845030514, 32.705591417438214, 39.297187745153416, 0.46281053593125354, 0.0, 3.6854940240354455, 3.84472350234251, 28.432494676422834, 21.393611533267865, 4.794160059067582, 17.57593046369757, 13.795302592503843, 17.43003495721927, 0.0, 6.115821320978536, 14.58618859009229, 20.27215116091766, 3.042589837558908, 38.92054462899561, 32.62509437583488, 13.01433925050128, 36.77901497548789, 36.15932591161096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7405040387735137, "mean_inference_ms": 2.2595941350853774, "mean_action_processing_ms": 0.31042383199605356, "mean_env_wait_ms": 0.2679859634819174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00431370735168457, "StateBufferConnector_ms": 0.014621496200561523, "ViewRequirementAgentConnector_ms": 0.16144931316375732}, "num_episodes": 18, "episode_return_max": 389.10999999999996, "episode_return_min": 90.44973408709056, "episode_return_mean": 296.4036844588183, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.0524411125947, "num_env_steps_trained_throughput_per_sec": 304.0524411125947, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 13187.146, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13187.095, "sample_time_ms": 2068.174, "learn_time_ms": 11097.775, "learn_throughput": 360.433, "synch_weights_time_ms": 19.033}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "ef79f_00000", "date": "2024-08-16_11-30-39", "timestamp": 1723788039, "time_this_iter_s": 13.175869941711426, "time_total_s": 814.5313308238983, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5380430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 814.5313308238983, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 63.22222222222222, "ram_util_percent": 82.1388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.944002822246501, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.156518677807359, "policy_loss": -0.008500989095465572, "vf_loss": 8.163445803223464, "vf_explained_var": -0.19970157121224377, "kl": 0.01049244752444877, "entropy": 0.9525964708239943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.308954565424137, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.88674881262754, "policy_loss": -0.004218400594970537, "vf_loss": 1.8909653755407485, "vf_explained_var": 0.3578502305601009, "kl": 0.0047047383511423305, "entropy": 0.265026680975364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 389.10999999999996, "episode_reward_min": 107.84419018098055, "episode_reward_mean": 301.02946731356235, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -76.85235563424348, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 100.93433104808376}, "policy_reward_mean": {"prey_policy": 134.72864569457818, "predator_policy": 15.786087962202982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.3077396499758, 222.56310859883678, 329.6223771620575, 324.948911861445, 321.4599999999999, 240.1983683757376, 318.5376565130486, 254.95453335185198, 333.9923836895925, 212.73942004766917, 322.4426241107886, 301.2277867013984, 322.68672963666313, 334.6444490422073, 320.36567003548356, 311.0860027388924, 352.84960426595705, 359.23, 273.10350220301245, 239.53868363099423, 268.7260518620653, 307.86171481812517, 350.33760665379975, 294.45278179669657, 306.1892466753899, 326.21, 315.5406508403055, 297.509622759358, 168.14830172269188, 352.36999999999983, 323.6406247333605, 310.4883885089181, 246.79216188333658, 333.4377252494754, 250.6686300420349, 262.59191209895636, 351.31146135977446, 311.1674016544965, 323.2024547577989, 304.06443355476597, 107.84419018098055, 354.45999999999975, 327.98935915838587, 323.96783953960534, 254.57065701473226, 363.3989918174086, 332.1778009648449, 316.26776184769636, 246.71637039926543, 351.4983553955436, 337.2213336920323, 354.70389446830603, 283.941222947888, 325.38022400215067, 265.1715899493057, 353.5718434227066, 222.13805039572603, 316.1092358626223, 324.22999999999996, 238.92741090698604, 366.6848653634212, 300.31, 380.16999999999996, 306.72215433672784, 344.3459702944207, 389.10999999999996, 309.3566937853693, 249.327917517174, 370.27, 320.79072316020563, 297.8039723983227, 296.7807686084742, 327.63734277909634, 346.24999999999994, 307.89728074615107, 270.13192205935184, 255.62572499837387, 267.98053055376175, 377.1267766903691, 252.8667140138564, 309.07000000000005, 178.95495803277385, 261.050310447394, 314.1729378845275, 346.64148587564307, 321.07690575504387, 247.0980600314801, 329.62577705733895, 233.24574782608246, 286.0516053424085, 303.398272695232, 362.74510248532874, 252.42947147585735, 271.82542401998853, 362.70287637355335, 252.24342594548077, 330.2295556401496, 307.2030420855212, 290.2755977028138, 168.21996282138997], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [144.41223439588663, 159.0722506843939, 36.32087659159719, 152.9645081433213, 163.18188466778258, 164.03141824383897, 124.5491270660897, 173.27, 150.70699285781888, 161.2914034368209, 35.92999723699356, 168.32, 165.28186961974487, 127.44115479097516, 122.15676274748304, 82.10319223631204, 158.69942276796593, 161.26033729580303, 179.53974001348166, -76.85235563424348, 118.768095583545, 189.6097929736841, 145.6282071252922, 144.45154537761294, 122.84759983744509, 160.44528605716692, 152.97557050017156, 165.08227704240483, 124.8764484594225, 150.48681189686528, 74.4309285144856, 198.01999999999998, 144.05620081509943, 188.42116959915813, 173.40013297523774, 182.16103454279377, 132.8955093077241, 110.492918422426, 15.242638704020287, 156.44000000000005, 53.532669651024044, 154.3688661244969, 126.19857886943495, 158.03010960218344, 144.47920353187595, 180.19999999999996, 112.00127299377148, 154.73722798010724, 171.29000000000002, 114.2059306402648, 142.4485874417636, 160.8719115606171, 147.42331008604316, 152.94514628475522, 92.32208306979447, 168.61380087847243, 14.990456993349571, 108.9671502551869, 171.29786437691035, 177.37514740567326, 158.53158689341063, 145.36129983698487, 145.30856235014602, 153.74544563218177, 88.20405664150937, 137.82781283964997, 106.94789496635275, 183.55608926757733, 28.028837934099723, 169.10730485254916, 57.4868490401906, 178.69936826636754, 180.20000000000005, 140.4308126599566, 137.22634523211647, 153.91766965126362, 160.07622832913256, 143.55129200812638, 129.86283266739704, 148.19447137882148, 11.418035211421376, -9.616184599003546, 191.08999999999997, 163.37, 153.37258929751857, 126.6701448643343, 137.26419611332994, 162.08622801890937, 63.49015597921228, 160.35956462195537, 186.14, 159.1002508237597, 128.99021020331028, 182.78652958625912, 149.04056539054415, 157.913861391543, 132.98402091328597, 60.67133843377712, 148.97769655193912, 184.16, 184.55658035519832, 118.54938642281394, 168.64147461446345, 176.07136641229675, 114.34482862318112, 134.12326924296502, 152.31607341747585, 165.3277752067198, 186.18869737273238, -1.6981187547113858, 163.07175457209897, 166.55950272250305, 58.772132512745834, 73.33760033218073, 100.87279254755948, 175.8262541320062, 103.0122348958261, 197.02999999999997, 75.35067585296605, 110.07149248355516, 147.35868096051797, 191.08999999999997, 160.69328775338354, 112.66247572439124, 195.05, 184.66313014266848, 168.12291702661162, 115.37172242084925, 140.80501665405666, 187.77904674422717, 189.10999999999996, 200.0, 155.98677322494, 136.23191170242586, 145.80000122577218, 31.525137128810066, 180.69718946406874, 189.10999999999999, 133.1356764513942, 180.12482918243347, 153.40761654798587, 94.57024964064604, 125.91978325197701, 148.49089483373209, 163.30748938939274, 133.10451583998054, 179.20999999999998, 160.92417867902148, 157.92197278120335, 115.11696821393772, 88.52323944462185, 139.64554814817546, 41.91611273919156, 168.07017863284617, 41.09520871325179, 153.94698095341113, 167.51191236507387, 200.0, 106.2149886379355, 119.96354198380611, 168.16216092491567, 114.35768022751654, 15.234127161918941, 66.58443747103476, 116.11935739733514, 96.46720230987603, 122.7830342772976, 163.6809458619189, 111.67952233027704, 200.0, 144.0515487944328, 163.0672476994593, 154.21236459446902, 23.74939075747303, 186.14, 117.90332853990262, 129.23029382815662, 75.07708385969306, 93.34092263550521, 154.28576333914265, 138.9432484049301, 144.66034597143857, 149.2229098007428, 195.36582821831576, 39.67744701368505, 168.50762154485437, 106.45237354938769, 148.17103789562003, 152.85261765050905, 188.1199999999999, 116.9365825056653, 111.033063614797, 113.69980523340409, 194.65617656643002, 150.8390615816686, 146.34785709447297, 48.32207980685047, 149.67182550068213, 59.72720534471151, 72.64442414755567], "policy_predator_policy_reward": [23.294781413885953, 9.528473155809397, 1.1337228442079577, 32.14400101971051, 0.20049249427500007, 2.20858175616096, 16.630872933910343, 10.498911861445192, 0.7873890035670799, 8.674214701793222, 7.053878433855233, 28.894492704888897, 0.8152816288600162, 24.999350473468528, 25.397919909861706, 25.296658458195438, 9.161670189072803, 4.8709534367510585, 9.117704620347167, 100.93433104808376, 8.129217910438296, 5.935517643121334, 7.592497630654213, 3.555536567839208, 22.629501184145365, 16.764342557905785, 6.166967724255399, 10.419633775375633, 31.58056128479487, 13.421848394400929, 18.280553547529802, 20.354520676876948, 11.975576506674791, 8.396657345024803, 2.8489654572062215, 0.819867024762266, 5.368877543641707, 24.346196929220593, 30.411965878139664, 37.44407904883447, 33.2604736636822, 27.56404242286228, 16.555576732368905, 7.077449614137848, 8.58174196940512, 17.076661152518664, 4.177924385790023, 23.536356437027823, 11.52880976407706, 9.16450627104815, 19.808990612603377, 3.0805103850159568, 6.227628739310429, 8.944565730197017, 13.054792218206764, 23.51894659288446, 4.692060523225176, 39.498633950930206, 0.922135623089525, 2.7748525943267515, 9.160007330238862, 10.587730672726197, 7.714115326347148, 3.720265200243186, 4.228458309447602, 16.531834092729813, 36.54438714163851, 6.389353873906851, 21.612166698559165, 31.920320556826887, 1.2211930760506255, 25.184501716347583, 16.24218863901871, 14.438460060799352, 3.1266104852182464, 16.8967762858982, 12.064940448338028, 7.509993972202, 1.5436237707972043, 24.463505737750218, 9.055387249577905, 96.98695231898482, 0.0, 0.0, 12.45119769040962, 35.49542730612352, 17.577429678800364, 7.0399857285657275, 16.01065165783548, 14.710284755729292, 8.187784929164412, 9.970956064484636, 6.6970986282142215, 13.703962547061293, 0.0, 9.313335065609282, 12.331697983043965, 40.72931306915834, 14.114259833449681, 4.246399010154777, 24.036467331137207, 10.078899582882983, 3.466231997361792, 6.524821444184062, 18.6427565961708, 16.83036848557125, 1.814046881050892, 5.922328496904192, 42.88271340214005, 37.79829792914474, 11.539128929276071, 12.401457198828501, 31.29930516222714, 58.729012388572215, 21.120115064632028, 18.290074118424627, 0.1572306005324116, 24.030534503641498, 18.317743294047318, 35.18749927641781, 20.741319039482033, 7.494865363421219, 7.244439740897164, 19.709796781328038, 0.0, 0.4568698573315486, 13.539350118280765, 9.688164770986267, 15.26498334594332, 0.4969235501935618, 0.0, 0.0, 11.681094012973091, 5.456914845030514, 32.705591417438214, 39.297187745153416, 0.46281053593125354, 0.0, 3.6854940240354455, 3.84472350234251, 28.432494676422834, 21.393611533267865, 4.794160059067582, 17.57593046369757, 13.795302592503843, 17.43003495721927, 0.0, 6.115821320978536, 14.58618859009229, 20.27215116091766, 3.042589837558908, 38.92054462899561, 32.62509437583488, 13.01433925050128, 36.77901497548789, 36.15932591161096, 4.0367766903691855, 5.578087634926117, 17.04804169465793, 9.640141697457013, 5.407018150526413, 21.143140697041375, 34.63521157583709, 62.50118182398308, 35.30553670001291, 13.158214040169822, 9.156892235168431, 18.552065510142565, 9.640277872932572, 25.321685672433443, 13.958109261151787, 0.0, 32.76703271272291, 36.3692719668151, 19.078794973096354, 6.503653544340012, 23.465023263753455, 5.473346874479123, 29.517263487372283, 8.907655880388404, 11.236561947362507, 8.558116371500867, 15.041118018757757, 3.115246447512478, 30.982192812505623, 13.262210104812427, 3.589599646612058, 13.612412928368718, 8.815044500790789, 12.91521422225365, 20.986936385203, 3.286843439815476, 18.247485402282354, 3.626088438033144, 0.0, 10.01612340937965, 57.30631881875557, 34.97537357652556, 3.9635435177190708, 31.88478981140376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7408728130476157, "mean_inference_ms": 2.263148066209733, "mean_action_processing_ms": 0.3100754760527367, "mean_env_wait_ms": 0.267929464317749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004287838935852051, "StateBufferConnector_ms": 0.0033555030822753906, "ViewRequirementAgentConnector_ms": 0.11536908149719238}, "num_episodes": 22, "episode_return_max": 389.10999999999996, "episode_return_min": 107.84419018098055, "episode_return_mean": 301.02946731356235, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.84621472348107, "num_env_steps_trained_throughput_per_sec": 304.84621472348107, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 13199.97, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13199.925, "sample_time_ms": 2073.518, "learn_time_ms": 11106.386, "learn_throughput": 360.153, "synch_weights_time_ms": 17.949}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "ef79f_00000", "date": "2024-08-16_11-30-52", "timestamp": 1723788052, "time_this_iter_s": 13.174116134643555, "time_total_s": 827.7054469585419, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5380670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 827.7054469585419, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 62.084210526315786, "ram_util_percent": 81.52105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8192170125466807, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.293718303448308, "policy_loss": -0.008324588838442372, "vf_loss": 8.300021172831299, "vf_explained_var": -0.30084675172018627, "kl": 0.013477983094403775, "entropy": 0.9099381218196223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.742115697469661, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8750364031110491, "policy_loss": -0.0011591523464414336, "vf_loss": 1.8761950467944777, "vf_explained_var": 0.34532463008133824, "kl": 0.002612652379855067, "entropy": 0.24948963667192156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 389.10999999999996, "episode_reward_min": 107.84419018098055, "episode_reward_mean": 300.4273888916923, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -9.616184599003546, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 96.98695231898482}, "policy_reward_mean": {"prey_policy": 135.0387924108976, "predator_policy": 15.174902034948568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [273.10350220301245, 239.53868363099423, 268.7260518620653, 307.86171481812517, 350.33760665379975, 294.45278179669657, 306.1892466753899, 326.21, 315.5406508403055, 297.509622759358, 168.14830172269188, 352.36999999999983, 323.6406247333605, 310.4883885089181, 246.79216188333658, 333.4377252494754, 250.6686300420349, 262.59191209895636, 351.31146135977446, 311.1674016544965, 323.2024547577989, 304.06443355476597, 107.84419018098055, 354.45999999999975, 327.98935915838587, 323.96783953960534, 254.57065701473226, 363.3989918174086, 332.1778009648449, 316.26776184769636, 246.71637039926543, 351.4983553955436, 337.2213336920323, 354.70389446830603, 283.941222947888, 325.38022400215067, 265.1715899493057, 353.5718434227066, 222.13805039572603, 316.1092358626223, 324.22999999999996, 238.92741090698604, 366.6848653634212, 300.31, 380.16999999999996, 306.72215433672784, 344.3459702944207, 389.10999999999996, 309.3566937853693, 249.327917517174, 370.27, 320.79072316020563, 297.8039723983227, 296.7807686084742, 327.63734277909634, 346.24999999999994, 307.89728074615107, 270.13192205935184, 255.62572499837387, 267.98053055376175, 377.1267766903691, 252.8667140138564, 309.07000000000005, 178.95495803277385, 261.050310447394, 314.1729378845275, 346.64148587564307, 321.07690575504387, 247.0980600314801, 329.62577705733895, 233.24574782608246, 286.0516053424085, 303.398272695232, 362.74510248532874, 252.42947147585735, 271.82542401998853, 362.70287637355335, 252.24342594548077, 330.2295556401496, 307.2030420855212, 290.2755977028138, 168.21996282138997, 329.67, 304.6884808208431, 239.46545491768967, 298.6534478513522, 313.5060113268477, 289.85565724091424, 311.88256794286485, 338.7867879759133, 311.5022548638334, 338.2042196424047, 279.7455453921844, 282.5806798678629, 306.5, 279.29005448133216, 283.133807084844, 344.80455418571705, 311.39, 295.99], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [132.8955093077241, 110.492918422426, 15.242638704020287, 156.44000000000005, 53.532669651024044, 154.3688661244969, 126.19857886943495, 158.03010960218344, 144.47920353187595, 180.19999999999996, 112.00127299377148, 154.73722798010724, 171.29000000000002, 114.2059306402648, 142.4485874417636, 160.8719115606171, 147.42331008604316, 152.94514628475522, 92.32208306979447, 168.61380087847243, 14.990456993349571, 108.9671502551869, 171.29786437691035, 177.37514740567326, 158.53158689341063, 145.36129983698487, 145.30856235014602, 153.74544563218177, 88.20405664150937, 137.82781283964997, 106.94789496635275, 183.55608926757733, 28.028837934099723, 169.10730485254916, 57.4868490401906, 178.69936826636754, 180.20000000000005, 140.4308126599566, 137.22634523211647, 153.91766965126362, 160.07622832913256, 143.55129200812638, 129.86283266739704, 148.19447137882148, 11.418035211421376, -9.616184599003546, 191.08999999999997, 163.37, 153.37258929751857, 126.6701448643343, 137.26419611332994, 162.08622801890937, 63.49015597921228, 160.35956462195537, 186.14, 159.1002508237597, 128.99021020331028, 182.78652958625912, 149.04056539054415, 157.913861391543, 132.98402091328597, 60.67133843377712, 148.97769655193912, 184.16, 184.55658035519832, 118.54938642281394, 168.64147461446345, 176.07136641229675, 114.34482862318112, 134.12326924296502, 152.31607341747585, 165.3277752067198, 186.18869737273238, -1.6981187547113858, 163.07175457209897, 166.55950272250305, 58.772132512745834, 73.33760033218073, 100.87279254755948, 175.8262541320062, 103.0122348958261, 197.02999999999997, 75.35067585296605, 110.07149248355516, 147.35868096051797, 191.08999999999997, 160.69328775338354, 112.66247572439124, 195.05, 184.66313014266848, 168.12291702661162, 115.37172242084925, 140.80501665405666, 187.77904674422717, 189.10999999999996, 200.0, 155.98677322494, 136.23191170242586, 145.80000122577218, 31.525137128810066, 180.69718946406874, 189.10999999999999, 133.1356764513942, 180.12482918243347, 153.40761654798587, 94.57024964064604, 125.91978325197701, 148.49089483373209, 163.30748938939274, 133.10451583998054, 179.20999999999998, 160.92417867902148, 157.92197278120335, 115.11696821393772, 88.52323944462185, 139.64554814817546, 41.91611273919156, 168.07017863284617, 41.09520871325179, 153.94698095341113, 167.51191236507387, 200.0, 106.2149886379355, 119.96354198380611, 168.16216092491567, 114.35768022751654, 15.234127161918941, 66.58443747103476, 116.11935739733514, 96.46720230987603, 122.7830342772976, 163.6809458619189, 111.67952233027704, 200.0, 144.0515487944328, 163.0672476994593, 154.21236459446902, 23.74939075747303, 186.14, 117.90332853990262, 129.23029382815662, 75.07708385969306, 93.34092263550521, 154.28576333914265, 138.9432484049301, 144.66034597143857, 149.2229098007428, 195.36582821831576, 39.67744701368505, 168.50762154485437, 106.45237354938769, 148.17103789562003, 152.85261765050905, 188.1199999999999, 116.9365825056653, 111.033063614797, 113.69980523340409, 194.65617656643002, 150.8390615816686, 146.34785709447297, 48.32207980685047, 149.67182550068213, 59.72720534471151, 72.64442414755567, 149.51, 179.34745127188418, 132.4419548221432, 131.27000494290382, 121.54137685383489, 58.65361577766532, 167.04515563957838, 99.85781137745515, 124.6415602996922, 152.08736190364164, 157.94936425505816, 114.06497881869157, 107.23730257714452, 179.96215188558955, 167.8507322982984, 157.34320341174606, 178.50423344444943, 113.45863879904348, 158.42000000000002, 167.26130335981992, 192.07999999999998, 83.44776476800345, 114.18498363333964, 151.37613081015797, 158.52756055969206, 139.68965584189846, 99.93643853914632, 148.41266110472128, 130.94927337283502, 122.53909138617227, 171.96228154811527, 127.04678580238652, 136.16542400744837, 161.7086994354322, 157.43, 137.4663091783426], "policy_predator_policy_reward": [5.368877543641707, 24.346196929220593, 30.411965878139664, 37.44407904883447, 33.2604736636822, 27.56404242286228, 16.555576732368905, 7.077449614137848, 8.58174196940512, 17.076661152518664, 4.177924385790023, 23.536356437027823, 11.52880976407706, 9.16450627104815, 19.808990612603377, 3.0805103850159568, 6.227628739310429, 8.944565730197017, 13.054792218206764, 23.51894659288446, 4.692060523225176, 39.498633950930206, 0.922135623089525, 2.7748525943267515, 9.160007330238862, 10.587730672726197, 7.714115326347148, 3.720265200243186, 4.228458309447602, 16.531834092729813, 36.54438714163851, 6.389353873906851, 21.612166698559165, 31.920320556826887, 1.2211930760506255, 25.184501716347583, 16.24218863901871, 14.438460060799352, 3.1266104852182464, 16.8967762858982, 12.064940448338028, 7.509993972202, 1.5436237707972043, 24.463505737750218, 9.055387249577905, 96.98695231898482, 0.0, 0.0, 12.45119769040962, 35.49542730612352, 17.577429678800364, 7.0399857285657275, 16.01065165783548, 14.710284755729292, 8.187784929164412, 9.970956064484636, 6.6970986282142215, 13.703962547061293, 0.0, 9.313335065609282, 12.331697983043965, 40.72931306915834, 14.114259833449681, 4.246399010154777, 24.036467331137207, 10.078899582882983, 3.466231997361792, 6.524821444184062, 18.6427565961708, 16.83036848557125, 1.814046881050892, 5.922328496904192, 42.88271340214005, 37.79829792914474, 11.539128929276071, 12.401457198828501, 31.29930516222714, 58.729012388572215, 21.120115064632028, 18.290074118424627, 0.1572306005324116, 24.030534503641498, 18.317743294047318, 35.18749927641781, 20.741319039482033, 7.494865363421219, 7.244439740897164, 19.709796781328038, 0.0, 0.4568698573315486, 13.539350118280765, 9.688164770986267, 15.26498334594332, 0.4969235501935618, 0.0, 0.0, 11.681094012973091, 5.456914845030514, 32.705591417438214, 39.297187745153416, 0.46281053593125354, 0.0, 3.6854940240354455, 3.84472350234251, 28.432494676422834, 21.393611533267865, 4.794160059067582, 17.57593046369757, 13.795302592503843, 17.43003495721927, 0.0, 6.115821320978536, 14.58618859009229, 20.27215116091766, 3.042589837558908, 38.92054462899561, 32.62509437583488, 13.01433925050128, 36.77901497548789, 36.15932591161096, 4.0367766903691855, 5.578087634926117, 17.04804169465793, 9.640141697457013, 5.407018150526413, 21.143140697041375, 34.63521157583709, 62.50118182398308, 35.30553670001291, 13.158214040169822, 9.156892235168431, 18.552065510142565, 9.640277872932572, 25.321685672433443, 13.958109261151787, 0.0, 32.76703271272291, 36.3692719668151, 19.078794973096354, 6.503653544340012, 23.465023263753455, 5.473346874479123, 29.517263487372283, 8.907655880388404, 11.236561947362507, 8.558116371500867, 15.041118018757757, 3.115246447512478, 30.982192812505623, 13.262210104812427, 3.589599646612058, 13.612412928368718, 8.815044500790789, 12.91521422225365, 20.986936385203, 3.286843439815476, 18.247485402282354, 3.626088438033144, 0.0, 10.01612340937965, 57.30631881875557, 34.97537357652556, 3.9635435177190708, 31.88478981140376, 0.8125487281158152, 0.0, 15.747710709035518, 25.22881034676053, 35.331645791587434, 23.938816494602055, 17.74398191774007, 14.006498916578598, 14.115655015970951, 22.661434107542977, 12.895031538249485, 4.9462826289150215, 14.482481736329175, 10.200631743801692, 0.7367536179149181, 12.856098647953923, 7.95340045648825, 11.585982163852297, 1.784219642404691, 10.73869664018007, 2.603588834638088, 1.614191789543076, 2.3481456956610187, 14.671419728704315, 3.3116991574140937, 4.971084440995402, 10.877393376610831, 20.06356146085368, 0.0, 29.645442325836758, 17.648916003679094, 28.14657083153613, 1.5539347049044767, 11.961941852214947, 0.0, 1.0936908216574028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7403915279506452, "mean_inference_ms": 2.2612348983863457, "mean_action_processing_ms": 0.31010892197987383, "mean_env_wait_ms": 0.2676285132974639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004235744476318359, "StateBufferConnector_ms": 0.0032341480255126953, "ViewRequirementAgentConnector_ms": 0.10952126979827881}, "num_episodes": 18, "episode_return_max": 389.10999999999996, "episode_return_min": 107.84419018098055, "episode_return_mean": 300.4273888916923, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.4587098377782, "num_env_steps_trained_throughput_per_sec": 310.4587098377782, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 13226.084, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13226.038, "sample_time_ms": 2051.569, "learn_time_ms": 11154.855, "learn_throughput": 358.588, "synch_weights_time_ms": 17.608}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "ef79f_00000", "date": "2024-08-16_11-31-05", "timestamp": 1723788065, "time_this_iter_s": 12.934316158294678, "time_total_s": 840.6397631168365, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214af280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 840.6397631168365, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 64.37368421052632, "ram_util_percent": 82.26842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.735018538324921, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.021556455622274, "policy_loss": -0.002012319328440797, "vf_loss": 8.022410990952183, "vf_explained_var": 0.01129847698741489, "kl": 0.00771850722294188, "entropy": 0.8830332451711886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8626787751440017, "cur_kl_coeff": 9.765625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.414242392084586, "policy_loss": -0.0049097730151116455, "vf_loss": 1.419151304638575, "vf_explained_var": 0.19171204712025072, "kl": 0.008834849535668144, "entropy": 0.2543614105651618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 393.93554118258896, "episode_reward_min": 168.21996282138997, "episode_reward_mean": 305.7526757431093, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1.6981187547113858, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 62.50118182398308}, "policy_reward_mean": {"prey_policy": 138.69078930169948, "predator_policy": 14.18554856985517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.45999999999975, 327.98935915838587, 323.96783953960534, 254.57065701473226, 363.3989918174086, 332.1778009648449, 316.26776184769636, 246.71637039926543, 351.4983553955436, 337.2213336920323, 354.70389446830603, 283.941222947888, 325.38022400215067, 265.1715899493057, 353.5718434227066, 222.13805039572603, 316.1092358626223, 324.22999999999996, 238.92741090698604, 366.6848653634212, 300.31, 380.16999999999996, 306.72215433672784, 344.3459702944207, 389.10999999999996, 309.3566937853693, 249.327917517174, 370.27, 320.79072316020563, 297.8039723983227, 296.7807686084742, 327.63734277909634, 346.24999999999994, 307.89728074615107, 270.13192205935184, 255.62572499837387, 267.98053055376175, 377.1267766903691, 252.8667140138564, 309.07000000000005, 178.95495803277385, 261.050310447394, 314.1729378845275, 346.64148587564307, 321.07690575504387, 247.0980600314801, 329.62577705733895, 233.24574782608246, 286.0516053424085, 303.398272695232, 362.74510248532874, 252.42947147585735, 271.82542401998853, 362.70287637355335, 252.24342594548077, 330.2295556401496, 307.2030420855212, 290.2755977028138, 168.21996282138997, 329.67, 304.6884808208431, 239.46545491768967, 298.6534478513522, 313.5060113268477, 289.85565724091424, 311.88256794286485, 338.7867879759133, 311.5022548638334, 338.2042196424047, 279.7455453921844, 282.5806798678629, 306.5, 279.29005448133216, 283.133807084844, 344.80455418571705, 311.39, 295.99, 367.48364455452577, 308.86, 385.33078638953964, 318.65, 393.93554118258896, 287.39, 285.11752107749527, 328.6006914495963, 316.1582206169571, 300.8048255804719, 307.0594889344067, 229.78215447342222, 338.5277361499255, 302.8512677895592, 307.2675165940576, 375.03939650657514, 218.7328244096061, 268.74055963697583, 360.91161060200386, 330.5572911717886, 269.39629851619077, 194.45885649235012, 362.07], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.08999999999997, 163.37, 153.37258929751857, 126.6701448643343, 137.26419611332994, 162.08622801890937, 63.49015597921228, 160.35956462195537, 186.14, 159.1002508237597, 128.99021020331028, 182.78652958625912, 149.04056539054415, 157.913861391543, 132.98402091328597, 60.67133843377712, 148.97769655193912, 184.16, 184.55658035519832, 118.54938642281394, 168.64147461446345, 176.07136641229675, 114.34482862318112, 134.12326924296502, 152.31607341747585, 165.3277752067198, 186.18869737273238, -1.6981187547113858, 163.07175457209897, 166.55950272250305, 58.772132512745834, 73.33760033218073, 100.87279254755948, 175.8262541320062, 103.0122348958261, 197.02999999999997, 75.35067585296605, 110.07149248355516, 147.35868096051797, 191.08999999999997, 160.69328775338354, 112.66247572439124, 195.05, 184.66313014266848, 168.12291702661162, 115.37172242084925, 140.80501665405666, 187.77904674422717, 189.10999999999996, 200.0, 155.98677322494, 136.23191170242586, 145.80000122577218, 31.525137128810066, 180.69718946406874, 189.10999999999999, 133.1356764513942, 180.12482918243347, 153.40761654798587, 94.57024964064604, 125.91978325197701, 148.49089483373209, 163.30748938939274, 133.10451583998054, 179.20999999999998, 160.92417867902148, 157.92197278120335, 115.11696821393772, 88.52323944462185, 139.64554814817546, 41.91611273919156, 168.07017863284617, 41.09520871325179, 153.94698095341113, 167.51191236507387, 200.0, 106.2149886379355, 119.96354198380611, 168.16216092491567, 114.35768022751654, 15.234127161918941, 66.58443747103476, 116.11935739733514, 96.46720230987603, 122.7830342772976, 163.6809458619189, 111.67952233027704, 200.0, 144.0515487944328, 163.0672476994593, 154.21236459446902, 23.74939075747303, 186.14, 117.90332853990262, 129.23029382815662, 75.07708385969306, 93.34092263550521, 154.28576333914265, 138.9432484049301, 144.66034597143857, 149.2229098007428, 195.36582821831576, 39.67744701368505, 168.50762154485437, 106.45237354938769, 148.17103789562003, 152.85261765050905, 188.1199999999999, 116.9365825056653, 111.033063614797, 113.69980523340409, 194.65617656643002, 150.8390615816686, 146.34785709447297, 48.32207980685047, 149.67182550068213, 59.72720534471151, 72.64442414755567, 149.51, 179.34745127188418, 132.4419548221432, 131.27000494290382, 121.54137685383489, 58.65361577766532, 167.04515563957838, 99.85781137745515, 124.6415602996922, 152.08736190364164, 157.94936425505816, 114.06497881869157, 107.23730257714452, 179.96215188558955, 167.8507322982984, 157.34320341174606, 178.50423344444943, 113.45863879904348, 158.42000000000002, 167.26130335981992, 192.07999999999998, 83.44776476800345, 114.18498363333964, 151.37613081015797, 158.52756055969206, 139.68965584189846, 99.93643853914632, 148.41266110472128, 130.94927337283502, 122.53909138617227, 171.96228154811527, 127.04678580238652, 136.16542400744837, 161.7086994354322, 157.43, 137.4663091783426, 190.1, 161.62092681054105, 143.14473248882456, 164.1602325167327, 200.0, 182.03386710259193, 153.03150297878864, 162.38, 191.95170397157702, 200.0, 151.2204091838158, 118.39924938850807, 85.73306264242493, 142.71468175409493, 188.95340448395774, 98.7551748691736, 145.30736048302452, 141.0527024038543, 140.2857988495657, 143.69719901950802, 146.7040223893262, 135.1462265732714, 85.42922346485295, 83.83064273690857, 145.5149525244117, 179.61793472059543, 162.25605772938533, 126.74000000000001, 143.29623503823865, 142.1549563542913, 164.51341242719948, 200.0, 85.91963359548441, 74.76094604516256, 77.52881190031604, 152.75899423412372, 189.90161060200387, 158.93447203186128, 150.5, 172.9806995133231, 105.99714407819138, 111.46688144353449, 86.711598414639, 60.64670887295001, 165.05877434918102, 186.92442541428915], "policy_predator_policy_reward": [0.0, 0.0, 12.45119769040962, 35.49542730612352, 17.577429678800364, 7.0399857285657275, 16.01065165783548, 14.710284755729292, 8.187784929164412, 9.970956064484636, 6.6970986282142215, 13.703962547061293, 0.0, 9.313335065609282, 12.331697983043965, 40.72931306915834, 14.114259833449681, 4.246399010154777, 24.036467331137207, 10.078899582882983, 3.466231997361792, 6.524821444184062, 18.6427565961708, 16.83036848557125, 1.814046881050892, 5.922328496904192, 42.88271340214005, 37.79829792914474, 11.539128929276071, 12.401457198828501, 31.29930516222714, 58.729012388572215, 21.120115064632028, 18.290074118424627, 0.1572306005324116, 24.030534503641498, 18.317743294047318, 35.18749927641781, 20.741319039482033, 7.494865363421219, 7.244439740897164, 19.709796781328038, 0.0, 0.4568698573315486, 13.539350118280765, 9.688164770986267, 15.26498334594332, 0.4969235501935618, 0.0, 0.0, 11.681094012973091, 5.456914845030514, 32.705591417438214, 39.297187745153416, 0.46281053593125354, 0.0, 3.6854940240354455, 3.84472350234251, 28.432494676422834, 21.393611533267865, 4.794160059067582, 17.57593046369757, 13.795302592503843, 17.43003495721927, 0.0, 6.115821320978536, 14.58618859009229, 20.27215116091766, 3.042589837558908, 38.92054462899561, 32.62509437583488, 13.01433925050128, 36.77901497548789, 36.15932591161096, 4.0367766903691855, 5.578087634926117, 17.04804169465793, 9.640141697457013, 5.407018150526413, 21.143140697041375, 34.63521157583709, 62.50118182398308, 35.30553670001291, 13.158214040169822, 9.156892235168431, 18.552065510142565, 9.640277872932572, 25.321685672433443, 13.958109261151787, 0.0, 32.76703271272291, 36.3692719668151, 19.078794973096354, 6.503653544340012, 23.465023263753455, 5.473346874479123, 29.517263487372283, 8.907655880388404, 11.236561947362507, 8.558116371500867, 15.041118018757757, 3.115246447512478, 30.982192812505623, 13.262210104812427, 3.589599646612058, 13.612412928368718, 8.815044500790789, 12.91521422225365, 20.986936385203, 3.286843439815476, 18.247485402282354, 3.626088438033144, 0.0, 10.01612340937965, 57.30631881875557, 34.97537357652556, 3.9635435177190708, 31.88478981140376, 0.8125487281158152, 0.0, 15.747710709035518, 25.22881034676053, 35.331645791587434, 23.938816494602055, 17.74398191774007, 14.006498916578598, 14.115655015970951, 22.661434107542977, 12.895031538249485, 4.9462826289150215, 14.482481736329175, 10.200631743801692, 0.7367536179149181, 12.856098647953923, 7.95340045648825, 11.585982163852297, 1.784219642404691, 10.73869664018007, 2.603588834638088, 1.614191789543076, 2.3481456956610187, 14.671419728704315, 3.3116991574140937, 4.971084440995402, 10.877393376610831, 20.06356146085368, 0.0, 29.645442325836758, 17.648916003679094, 28.14657083153613, 1.5539347049044767, 11.961941852214947, 0.0, 1.0936908216574028, 9.112866356157829, 6.649851387826883, 1.3652675111754293, 0.18976748326730575, 1.4031697104394698, 1.8937495765081964, 3.238497021211348, 0.0, 1.0332187344867738, 0.9506184765251994, 17.033426992150016, 0.7369144355261005, 23.822306381716054, 32.84747029925936, 0.5372869656386277, 40.354825130826384, 12.008565262489324, 17.78959246758894, 9.466370956375798, 7.355456755022375, 11.982364638417561, 13.22687533339155, 17.342478769250125, 43.1798095024106, 5.8089484474278965, 7.585900457490409, 2.111267789559151, 11.743942270614674, 2.9267074157014, 18.88961778582628, 6.956355843143686, 3.569628236231953, 20.84558698567863, 37.20665778328047, 25.63101171533291, 12.821741787203154, 0.0, 12.075527968138731, 0.9772911717885555, 6.099300486676906, 5.537363729182818, 46.3949092652821, 14.551655064289209, 32.54889414047192, 9.086805437080804, 0.9999947994490312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7399861484027584, "mean_inference_ms": 2.261787053666875, "mean_action_processing_ms": 0.3100752115371379, "mean_env_wait_ms": 0.2673240509314375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008264422416687012, "StateBufferConnector_ms": 0.0036106109619140625, "ViewRequirementAgentConnector_ms": 0.13372135162353516}, "num_episodes": 23, "episode_return_max": 393.93554118258896, "episode_return_min": 168.21996282138997, "episode_return_mean": 305.7526757431093, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.8543870221993, "num_env_steps_trained_throughput_per_sec": 310.8543870221993, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 13144.93, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13144.885, "sample_time_ms": 1948.352, "learn_time_ms": 11176.242, "learn_throughput": 357.902, "synch_weights_time_ms": 18.114}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "ef79f_00000", "date": "2024-08-16_11-31-18", "timestamp": 1723788078, "time_this_iter_s": 12.921133041381836, "time_total_s": 853.5608961582184, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321790ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 853.5608961582184, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 62.81666666666667, "ram_util_percent": 81.98333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.882330257930453, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.738714307452005, "policy_loss": -0.0008434998597112046, "vf_loss": 7.737196080899112, "vf_explained_var": -0.28255642021774613, "kl": 0.015744828401145418, "entropy": 0.8946917231751498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.0195498296192715, "cur_kl_coeff": 9.765625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2115862129226564, "policy_loss": -0.007007095996393925, "vf_loss": 2.2185929144501055, "vf_explained_var": 0.2658370311298068, "kl": 0.00399003164348952, "entropy": 0.2480232771190386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 393.93554118258896, "episode_reward_min": 168.21996282138997, "episode_reward_mean": 302.6657079915234, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 15.234127161918941, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 76.49963147143578}, "policy_reward_mean": {"prey_policy": 137.10174988078234, "predator_policy": 14.231104114979352}, "custom_metrics": {}, "hist_stats": {"episode_reward": [238.92741090698604, 366.6848653634212, 300.31, 380.16999999999996, 306.72215433672784, 344.3459702944207, 389.10999999999996, 309.3566937853693, 249.327917517174, 370.27, 320.79072316020563, 297.8039723983227, 296.7807686084742, 327.63734277909634, 346.24999999999994, 307.89728074615107, 270.13192205935184, 255.62572499837387, 267.98053055376175, 377.1267766903691, 252.8667140138564, 309.07000000000005, 178.95495803277385, 261.050310447394, 314.1729378845275, 346.64148587564307, 321.07690575504387, 247.0980600314801, 329.62577705733895, 233.24574782608246, 286.0516053424085, 303.398272695232, 362.74510248532874, 252.42947147585735, 271.82542401998853, 362.70287637355335, 252.24342594548077, 330.2295556401496, 307.2030420855212, 290.2755977028138, 168.21996282138997, 329.67, 304.6884808208431, 239.46545491768967, 298.6534478513522, 313.5060113268477, 289.85565724091424, 311.88256794286485, 338.7867879759133, 311.5022548638334, 338.2042196424047, 279.7455453921844, 282.5806798678629, 306.5, 279.29005448133216, 283.133807084844, 344.80455418571705, 311.39, 295.99, 367.48364455452577, 308.86, 385.33078638953964, 318.65, 393.93554118258896, 287.39, 285.11752107749527, 328.6006914495963, 316.1582206169571, 300.8048255804719, 307.0594889344067, 229.78215447342222, 338.5277361499255, 302.8512677895592, 307.2675165940576, 375.03939650657514, 218.7328244096061, 268.74055963697583, 360.91161060200386, 330.5572911717886, 269.39629851619077, 194.45885649235012, 362.07, 323.21317956120185, 260.519650491904, 352.95425279626744, 271.25219376957494, 320.29834366764317, 317.42, 283.1834231589092, 359.4642821004419, 260.35, 333.33, 331.2796403336407, 292.8425974865477, 221.7051387642834, 355.02825578267976, 278.64270220593323, 227.43829008772784, 334.81843660793606, 221.0773689049352], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [75.35067585296605, 110.07149248355516, 147.35868096051797, 191.08999999999997, 160.69328775338354, 112.66247572439124, 195.05, 184.66313014266848, 168.12291702661162, 115.37172242084925, 140.80501665405666, 187.77904674422717, 189.10999999999996, 200.0, 155.98677322494, 136.23191170242586, 145.80000122577218, 31.525137128810066, 180.69718946406874, 189.10999999999999, 133.1356764513942, 180.12482918243347, 153.40761654798587, 94.57024964064604, 125.91978325197701, 148.49089483373209, 163.30748938939274, 133.10451583998054, 179.20999999999998, 160.92417867902148, 157.92197278120335, 115.11696821393772, 88.52323944462185, 139.64554814817546, 41.91611273919156, 168.07017863284617, 41.09520871325179, 153.94698095341113, 167.51191236507387, 200.0, 106.2149886379355, 119.96354198380611, 168.16216092491567, 114.35768022751654, 15.234127161918941, 66.58443747103476, 116.11935739733514, 96.46720230987603, 122.7830342772976, 163.6809458619189, 111.67952233027704, 200.0, 144.0515487944328, 163.0672476994593, 154.21236459446902, 23.74939075747303, 186.14, 117.90332853990262, 129.23029382815662, 75.07708385969306, 93.34092263550521, 154.28576333914265, 138.9432484049301, 144.66034597143857, 149.2229098007428, 195.36582821831576, 39.67744701368505, 168.50762154485437, 106.45237354938769, 148.17103789562003, 152.85261765050905, 188.1199999999999, 116.9365825056653, 111.033063614797, 113.69980523340409, 194.65617656643002, 150.8390615816686, 146.34785709447297, 48.32207980685047, 149.67182550068213, 59.72720534471151, 72.64442414755567, 149.51, 179.34745127188418, 132.4419548221432, 131.27000494290382, 121.54137685383489, 58.65361577766532, 167.04515563957838, 99.85781137745515, 124.6415602996922, 152.08736190364164, 157.94936425505816, 114.06497881869157, 107.23730257714452, 179.96215188558955, 167.8507322982984, 157.34320341174606, 178.50423344444943, 113.45863879904348, 158.42000000000002, 167.26130335981992, 192.07999999999998, 83.44776476800345, 114.18498363333964, 151.37613081015797, 158.52756055969206, 139.68965584189846, 99.93643853914632, 148.41266110472128, 130.94927337283502, 122.53909138617227, 171.96228154811527, 127.04678580238652, 136.16542400744837, 161.7086994354322, 157.43, 137.4663091783426, 190.1, 161.62092681054105, 143.14473248882456, 164.1602325167327, 200.0, 182.03386710259193, 153.03150297878864, 162.38, 191.95170397157702, 200.0, 151.2204091838158, 118.39924938850807, 85.73306264242493, 142.71468175409493, 188.95340448395774, 98.7551748691736, 145.30736048302452, 141.0527024038543, 140.2857988495657, 143.69719901950802, 146.7040223893262, 135.1462265732714, 85.42922346485295, 83.83064273690857, 145.5149525244117, 179.61793472059543, 162.25605772938533, 126.74000000000001, 143.29623503823865, 142.1549563542913, 164.51341242719948, 200.0, 85.91963359548441, 74.76094604516256, 77.52881190031604, 152.75899423412372, 189.90161060200387, 158.93447203186128, 150.5, 172.9806995133231, 105.99714407819138, 111.46688144353449, 86.711598414639, 60.64670887295001, 165.05877434918102, 186.92442541428915, 186.08051004975775, 39.4815162064107, 100.27678718848789, 108.71018470773814, 180.14159925009773, 162.71158645536502, 122.43289803790609, 137.58489990520226, 189.36546725001506, 84.23166153727219, 170.0687551308871, 134.32947599679176, 143.63031755562764, 97.77790123978833, 172.78557504100655, 177.66715176945144, 40.65188419724306, 184.45068351182314, 148.30581129356887, 176.24, 182.18, 116.96115350292465, 152.68064724656406, 114.57423702187461, 81.53797231161137, 105.38341124267404, 117.87223496352695, 200.0, 135.94819141793937, 120.42726613946809, 114.91539150210275, 73.22558654077004, 170.0621496837021, 149.92917064081894, 91.4067951990755, 83.53419889680907], "policy_predator_policy_reward": [18.317743294047318, 35.18749927641781, 20.741319039482033, 7.494865363421219, 7.244439740897164, 19.709796781328038, 0.0, 0.4568698573315486, 13.539350118280765, 9.688164770986267, 15.26498334594332, 0.4969235501935618, 0.0, 0.0, 11.681094012973091, 5.456914845030514, 32.705591417438214, 39.297187745153416, 0.46281053593125354, 0.0, 3.6854940240354455, 3.84472350234251, 28.432494676422834, 21.393611533267865, 4.794160059067582, 17.57593046369757, 13.795302592503843, 17.43003495721927, 0.0, 6.115821320978536, 14.58618859009229, 20.27215116091766, 3.042589837558908, 38.92054462899561, 32.62509437583488, 13.01433925050128, 36.77901497548789, 36.15932591161096, 4.0367766903691855, 5.578087634926117, 17.04804169465793, 9.640141697457013, 5.407018150526413, 21.143140697041375, 34.63521157583709, 62.50118182398308, 35.30553670001291, 13.158214040169822, 9.156892235168431, 18.552065510142565, 9.640277872932572, 25.321685672433443, 13.958109261151787, 0.0, 32.76703271272291, 36.3692719668151, 19.078794973096354, 6.503653544340012, 23.465023263753455, 5.473346874479123, 29.517263487372283, 8.907655880388404, 11.236561947362507, 8.558116371500867, 15.041118018757757, 3.115246447512478, 30.982192812505623, 13.262210104812427, 3.589599646612058, 13.612412928368718, 8.815044500790789, 12.91521422225365, 20.986936385203, 3.286843439815476, 18.247485402282354, 3.626088438033144, 0.0, 10.01612340937965, 57.30631881875557, 34.97537357652556, 3.9635435177190708, 31.88478981140376, 0.8125487281158152, 0.0, 15.747710709035518, 25.22881034676053, 35.331645791587434, 23.938816494602055, 17.74398191774007, 14.006498916578598, 14.115655015970951, 22.661434107542977, 12.895031538249485, 4.9462826289150215, 14.482481736329175, 10.200631743801692, 0.7367536179149181, 12.856098647953923, 7.95340045648825, 11.585982163852297, 1.784219642404691, 10.73869664018007, 2.603588834638088, 1.614191789543076, 2.3481456956610187, 14.671419728704315, 3.3116991574140937, 4.971084440995402, 10.877393376610831, 20.06356146085368, 0.0, 29.645442325836758, 17.648916003679094, 28.14657083153613, 1.5539347049044767, 11.961941852214947, 0.0, 1.0936908216574028, 9.112866356157829, 6.649851387826883, 1.3652675111754293, 0.18976748326730575, 1.4031697104394698, 1.8937495765081964, 3.238497021211348, 0.0, 1.0332187344867738, 0.9506184765251994, 17.033426992150016, 0.7369144355261005, 23.822306381716054, 32.84747029925936, 0.5372869656386277, 40.354825130826384, 12.008565262489324, 17.78959246758894, 9.466370956375798, 7.355456755022375, 11.982364638417561, 13.22687533339155, 17.342478769250125, 43.1798095024106, 5.8089484474278965, 7.585900457490409, 2.111267789559151, 11.743942270614674, 2.9267074157014, 18.88961778582628, 6.956355843143686, 3.569628236231953, 20.84558698567863, 37.20665778328047, 25.63101171533291, 12.821741787203154, 0.0, 12.075527968138731, 0.9772911717885555, 6.099300486676906, 5.537363729182818, 46.3949092652821, 14.551655064289209, 32.54889414047192, 9.086805437080804, 0.9999947994490312, 76.49963147143578, 21.15152183359766, 39.71189618009513, 11.820782415582768, 2.5190884415935115, 7.5819786492111865, 11.234395826466613, 0.0, 19.289740844286463, 27.411474036069357, 9.897022853755027, 3.124746018566104, 25.102432766787324, 16.672771596705918, 4.062011399547655, 4.949543890436261, 14.572888953398698, 20.67454333753512, 6.707373420166085, 2.0768152862650378, 17.755652108487375, 14.382834722228656, 2.8499068104976835, 22.73780640761131, 12.594979985054028, 22.188775224943775, 17.439032655085352, 19.71698816406745, 10.525188957947359, 11.742055690578425, 9.796957765421752, 29.500354279433314, 14.82711628341501, 0.0, 0.0, 46.13637480905065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7397292234418764, "mean_inference_ms": 2.262133335697976, "mean_action_processing_ms": 0.30999031688740447, "mean_env_wait_ms": 0.26709288957139876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008966207504272461, "StateBufferConnector_ms": 0.003621339797973633, "ViewRequirementAgentConnector_ms": 0.14746379852294922}, "num_episodes": 18, "episode_return_max": 393.93554118258896, "episode_return_min": 168.21996282138997, "episode_return_mean": 302.6657079915234, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.75322392023475, "num_env_steps_trained_throughput_per_sec": 321.75322392023475, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 13063.119, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13063.069, "sample_time_ms": 1855.903, "learn_time_ms": 11185.839, "learn_throughput": 357.595, "synch_weights_time_ms": 18.86}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "ef79f_00000", "date": "2024-08-16_11-31-30", "timestamp": 1723788090, "time_this_iter_s": 12.481795072555542, "time_total_s": 866.0426912307739, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321433790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 866.0426912307739, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 62.78333333333333, "ram_util_percent": 81.98888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7689456452452945, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.101674885976882, "policy_loss": -0.0005295694946119237, "vf_loss": 8.10000172241655, "vf_explained_var": -0.03586933316377105, "kl": 0.014684891744944868, "entropy": 0.8986900107570426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.118828068839179, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5948012150784647, "policy_loss": -0.004584520251155097, "vf_loss": 2.5993855016572134, "vf_explained_var": 0.41441916612090257, "kl": 0.00435184837299292, "entropy": 0.2304740259019786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 393.93554118258896, "episode_reward_min": 99.70770633684158, "episode_reward_mean": 286.6596994946114, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -11.269112035594652, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 76.49963147143578}, "policy_reward_mean": {"prey_policy": 127.89563827085533, "predator_policy": 15.434211476450374}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.98053055376175, 377.1267766903691, 252.8667140138564, 309.07000000000005, 178.95495803277385, 261.050310447394, 314.1729378845275, 346.64148587564307, 321.07690575504387, 247.0980600314801, 329.62577705733895, 233.24574782608246, 286.0516053424085, 303.398272695232, 362.74510248532874, 252.42947147585735, 271.82542401998853, 362.70287637355335, 252.24342594548077, 330.2295556401496, 307.2030420855212, 290.2755977028138, 168.21996282138997, 329.67, 304.6884808208431, 239.46545491768967, 298.6534478513522, 313.5060113268477, 289.85565724091424, 311.88256794286485, 338.7867879759133, 311.5022548638334, 338.2042196424047, 279.7455453921844, 282.5806798678629, 306.5, 279.29005448133216, 283.133807084844, 344.80455418571705, 311.39, 295.99, 367.48364455452577, 308.86, 385.33078638953964, 318.65, 393.93554118258896, 287.39, 285.11752107749527, 328.6006914495963, 316.1582206169571, 300.8048255804719, 307.0594889344067, 229.78215447342222, 338.5277361499255, 302.8512677895592, 307.2675165940576, 375.03939650657514, 218.7328244096061, 268.74055963697583, 360.91161060200386, 330.5572911717886, 269.39629851619077, 194.45885649235012, 362.07, 323.21317956120185, 260.519650491904, 352.95425279626744, 271.25219376957494, 320.29834366764317, 317.42, 283.1834231589092, 359.4642821004419, 260.35, 333.33, 331.2796403336407, 292.8425974865477, 221.7051387642834, 355.02825578267976, 278.64270220593323, 227.43829008772784, 334.81843660793606, 221.0773689049352, 318.63999999999976, 341.9474154213561, 141.00358009047963, 203.0837349232172, 164.21234140064593, 99.70770633684158, 200.09622419585844, 296.55353764322166, 287.02249074983575, 277.03291917347804, 303.6827605489543, 236.77302417436493, 287.8575370434538, 206.7616919575602, 226.54480078218276, 209.11919121436205, 153.81989249703742, 123.6830491100279], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [41.09520871325179, 153.94698095341113, 167.51191236507387, 200.0, 106.2149886379355, 119.96354198380611, 168.16216092491567, 114.35768022751654, 15.234127161918941, 66.58443747103476, 116.11935739733514, 96.46720230987603, 122.7830342772976, 163.6809458619189, 111.67952233027704, 200.0, 144.0515487944328, 163.0672476994593, 154.21236459446902, 23.74939075747303, 186.14, 117.90332853990262, 129.23029382815662, 75.07708385969306, 93.34092263550521, 154.28576333914265, 138.9432484049301, 144.66034597143857, 149.2229098007428, 195.36582821831576, 39.67744701368505, 168.50762154485437, 106.45237354938769, 148.17103789562003, 152.85261765050905, 188.1199999999999, 116.9365825056653, 111.033063614797, 113.69980523340409, 194.65617656643002, 150.8390615816686, 146.34785709447297, 48.32207980685047, 149.67182550068213, 59.72720534471151, 72.64442414755567, 149.51, 179.34745127188418, 132.4419548221432, 131.27000494290382, 121.54137685383489, 58.65361577766532, 167.04515563957838, 99.85781137745515, 124.6415602996922, 152.08736190364164, 157.94936425505816, 114.06497881869157, 107.23730257714452, 179.96215188558955, 167.8507322982984, 157.34320341174606, 178.50423344444943, 113.45863879904348, 158.42000000000002, 167.26130335981992, 192.07999999999998, 83.44776476800345, 114.18498363333964, 151.37613081015797, 158.52756055969206, 139.68965584189846, 99.93643853914632, 148.41266110472128, 130.94927337283502, 122.53909138617227, 171.96228154811527, 127.04678580238652, 136.16542400744837, 161.7086994354322, 157.43, 137.4663091783426, 190.1, 161.62092681054105, 143.14473248882456, 164.1602325167327, 200.0, 182.03386710259193, 153.03150297878864, 162.38, 191.95170397157702, 200.0, 151.2204091838158, 118.39924938850807, 85.73306264242493, 142.71468175409493, 188.95340448395774, 98.7551748691736, 145.30736048302452, 141.0527024038543, 140.2857988495657, 143.69719901950802, 146.7040223893262, 135.1462265732714, 85.42922346485295, 83.83064273690857, 145.5149525244117, 179.61793472059543, 162.25605772938533, 126.74000000000001, 143.29623503823865, 142.1549563542913, 164.51341242719948, 200.0, 85.91963359548441, 74.76094604516256, 77.52881190031604, 152.75899423412372, 189.90161060200387, 158.93447203186128, 150.5, 172.9806995133231, 105.99714407819138, 111.46688144353449, 86.711598414639, 60.64670887295001, 165.05877434918102, 186.92442541428915, 186.08051004975775, 39.4815162064107, 100.27678718848789, 108.71018470773814, 180.14159925009773, 162.71158645536502, 122.43289803790609, 137.58489990520226, 189.36546725001506, 84.23166153727219, 170.0687551308871, 134.32947599679176, 143.63031755562764, 97.77790123978833, 172.78557504100655, 177.66715176945144, 40.65188419724306, 184.45068351182314, 148.30581129356887, 176.24, 182.18, 116.96115350292465, 152.68064724656406, 114.57423702187461, 81.53797231161137, 105.38341124267404, 117.87223496352695, 200.0, 135.94819141793937, 120.42726613946809, 114.91539150210275, 73.22558654077004, 170.0621496837021, 149.92917064081894, 91.4067951990755, 83.53419889680907, 152.21481555453357, 162.72517242452125, 161.91650154593313, 177.62681826124174, 51.28599404822354, 48.66759362207496, 103.5230994674865, 66.18050520559277, 22.047334161835362, 83.70160240338637, -11.269112035594652, 32.87714064636352, 18.030833383600417, 113.41671679947211, 135.95362768064172, 153.46999999999997, 157.31863796257306, 81.00651359831275, 83.37434969296818, 152.496694683079, 68.22365673950935, 161.36114557810345, 106.16542903498471, 92.4970882828464, 177.22999999999996, 88.5500957095851, 105.24636738039978, 91.64444920592055, 187.1536103178004, -8.70740875460652, 121.71237446245144, 66.75796354929602, 54.109722621503536, 33.15077065987252, 64.58632761330317, 3.399958793167407], "policy_predator_policy_reward": [36.77901497548789, 36.15932591161096, 4.0367766903691855, 5.578087634926117, 17.04804169465793, 9.640141697457013, 5.407018150526413, 21.143140697041375, 34.63521157583709, 62.50118182398308, 35.30553670001291, 13.158214040169822, 9.156892235168431, 18.552065510142565, 9.640277872932572, 25.321685672433443, 13.958109261151787, 0.0, 32.76703271272291, 36.3692719668151, 19.078794973096354, 6.503653544340012, 23.465023263753455, 5.473346874479123, 29.517263487372283, 8.907655880388404, 11.236561947362507, 8.558116371500867, 15.041118018757757, 3.115246447512478, 30.982192812505623, 13.262210104812427, 3.589599646612058, 13.612412928368718, 8.815044500790789, 12.91521422225365, 20.986936385203, 3.286843439815476, 18.247485402282354, 3.626088438033144, 0.0, 10.01612340937965, 57.30631881875557, 34.97537357652556, 3.9635435177190708, 31.88478981140376, 0.8125487281158152, 0.0, 15.747710709035518, 25.22881034676053, 35.331645791587434, 23.938816494602055, 17.74398191774007, 14.006498916578598, 14.115655015970951, 22.661434107542977, 12.895031538249485, 4.9462826289150215, 14.482481736329175, 10.200631743801692, 0.7367536179149181, 12.856098647953923, 7.95340045648825, 11.585982163852297, 1.784219642404691, 10.73869664018007, 2.603588834638088, 1.614191789543076, 2.3481456956610187, 14.671419728704315, 3.3116991574140937, 4.971084440995402, 10.877393376610831, 20.06356146085368, 0.0, 29.645442325836758, 17.648916003679094, 28.14657083153613, 1.5539347049044767, 11.961941852214947, 0.0, 1.0936908216574028, 9.112866356157829, 6.649851387826883, 1.3652675111754293, 0.18976748326730575, 1.4031697104394698, 1.8937495765081964, 3.238497021211348, 0.0, 1.0332187344867738, 0.9506184765251994, 17.033426992150016, 0.7369144355261005, 23.822306381716054, 32.84747029925936, 0.5372869656386277, 40.354825130826384, 12.008565262489324, 17.78959246758894, 9.466370956375798, 7.355456755022375, 11.982364638417561, 13.22687533339155, 17.342478769250125, 43.1798095024106, 5.8089484474278965, 7.585900457490409, 2.111267789559151, 11.743942270614674, 2.9267074157014, 18.88961778582628, 6.956355843143686, 3.569628236231953, 20.84558698567863, 37.20665778328047, 25.63101171533291, 12.821741787203154, 0.0, 12.075527968138731, 0.9772911717885555, 6.099300486676906, 5.537363729182818, 46.3949092652821, 14.551655064289209, 32.54889414047192, 9.086805437080804, 0.9999947994490312, 76.49963147143578, 21.15152183359766, 39.71189618009513, 11.820782415582768, 2.5190884415935115, 7.5819786492111865, 11.234395826466613, 0.0, 19.289740844286463, 27.411474036069357, 9.897022853755027, 3.124746018566104, 25.102432766787324, 16.672771596705918, 4.062011399547655, 4.949543890436261, 14.572888953398698, 20.67454333753512, 6.707373420166085, 2.0768152862650378, 17.755652108487375, 14.382834722228656, 2.8499068104976835, 22.73780640761131, 12.594979985054028, 22.188775224943775, 17.439032655085352, 19.71698816406745, 10.525188957947359, 11.742055690578425, 9.796957765421752, 29.500354279433314, 14.82711628341501, 0.0, 0.0, 46.13637480905065, 0.0, 3.7000120209452656, 1.022636983186231, 1.3814586309949908, 31.57764791900957, 9.472344501171577, 6.813647556336455, 26.56648269380152, 24.677964111420224, 33.785440724004054, 19.037824138431827, 59.06185358764096, 7.086422811615692, 61.56225120117023, 5.516372319358266, 1.61353764322166, 16.03968831080516, 32.65765087814476, 20.59236602620463, 20.569508771226314, 32.53672996116586, 41.561228270175704, 22.32679125142142, 15.783715605112466, 18.62990429041492, 3.4475370434538513, 5.615408002702725, 4.2554673685371505, 45.38732250877417, 2.711276710214924, 4.661980766438295, 15.986872436176109, 14.019539088362823, 52.539860127298574, 48.06242597127429, 7.634336732282903]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.739680270213812, "mean_inference_ms": 2.2636018391558697, "mean_action_processing_ms": 0.30999523484521363, "mean_env_wait_ms": 0.2668990271695008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009638547897338867, "StateBufferConnector_ms": 0.0036559104919433594, "ViewRequirementAgentConnector_ms": 0.14876484870910645}, "num_episodes": 18, "episode_return_max": 393.93554118258896, "episode_return_min": 99.70770633684158, "episode_return_mean": 286.6596994946114, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.39115888786847, "num_env_steps_trained_throughput_per_sec": 311.39115888786847, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 12995.888, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12995.838, "sample_time_ms": 1805.621, "learn_time_ms": 11169.565, "learn_throughput": 358.116, "synch_weights_time_ms": 18.329}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "ef79f_00000", "date": "2024-08-16_11-31-43", "timestamp": 1723788103, "time_this_iter_s": 12.928436994552612, "time_total_s": 878.9711282253265, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214ac9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 878.9711282253265, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 63.12222222222223, "ram_util_percent": 82.02777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.206053062879219, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.241347428730556, "policy_loss": -0.0048296105168345906, "vf_loss": 8.244637166633808, "vf_explained_var": -0.24465161845797584, "kl": 0.010265857014327376, "entropy": 0.9128712082981433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.487511431540131, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.62192588773354, "policy_loss": -0.0021918913366755955, "vf_loss": 3.624117712495188, "vf_explained_var": 0.35319329474968886, "kl": 0.004323256959822261, "entropy": 0.2546481939219924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 393.93554118258896, "episode_reward_min": 23.215718647204177, "episode_reward_mean": 270.72124069158536, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.93370337271612, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 76.49963147143578}, "policy_reward_mean": {"prey_policy": 120.1276377779435, "predator_policy": 15.232982567849197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.21996282138997, 329.67, 304.6884808208431, 239.46545491768967, 298.6534478513522, 313.5060113268477, 289.85565724091424, 311.88256794286485, 338.7867879759133, 311.5022548638334, 338.2042196424047, 279.7455453921844, 282.5806798678629, 306.5, 279.29005448133216, 283.133807084844, 344.80455418571705, 311.39, 295.99, 367.48364455452577, 308.86, 385.33078638953964, 318.65, 393.93554118258896, 287.39, 285.11752107749527, 328.6006914495963, 316.1582206169571, 300.8048255804719, 307.0594889344067, 229.78215447342222, 338.5277361499255, 302.8512677895592, 307.2675165940576, 375.03939650657514, 218.7328244096061, 268.74055963697583, 360.91161060200386, 330.5572911717886, 269.39629851619077, 194.45885649235012, 362.07, 323.21317956120185, 260.519650491904, 352.95425279626744, 271.25219376957494, 320.29834366764317, 317.42, 283.1834231589092, 359.4642821004419, 260.35, 333.33, 331.2796403336407, 292.8425974865477, 221.7051387642834, 355.02825578267976, 278.64270220593323, 227.43829008772784, 334.81843660793606, 221.0773689049352, 318.63999999999976, 341.9474154213561, 141.00358009047963, 203.0837349232172, 164.21234140064593, 99.70770633684158, 200.09622419585844, 296.55353764322166, 287.02249074983575, 277.03291917347804, 303.6827605489543, 236.77302417436493, 287.8575370434538, 206.7616919575602, 226.54480078218276, 209.11919121436205, 153.81989249703742, 123.6830491100279, 274.5375716355898, 214.39013614164807, 159.35848207477497, 143.30696263415248, 270.6431847933718, 23.215718647204177, 176.542119353312, 308.971998360326, 113.81568325370098, 315.7900000000001, 207.50369850004262, 305.2303239463968, 257.49813349885704, 313.9071412682917, 335.2574710974544, 144.16483665402373, 159.63226461904503, 201.95405502171278, 286.8940838155181, 182.75988252439754, 192.1049497921857, 276.69], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [59.72720534471151, 72.64442414755567, 149.51, 179.34745127188418, 132.4419548221432, 131.27000494290382, 121.54137685383489, 58.65361577766532, 167.04515563957838, 99.85781137745515, 124.6415602996922, 152.08736190364164, 157.94936425505816, 114.06497881869157, 107.23730257714452, 179.96215188558955, 167.8507322982984, 157.34320341174606, 178.50423344444943, 113.45863879904348, 158.42000000000002, 167.26130335981992, 192.07999999999998, 83.44776476800345, 114.18498363333964, 151.37613081015797, 158.52756055969206, 139.68965584189846, 99.93643853914632, 148.41266110472128, 130.94927337283502, 122.53909138617227, 171.96228154811527, 127.04678580238652, 136.16542400744837, 161.7086994354322, 157.43, 137.4663091783426, 190.1, 161.62092681054105, 143.14473248882456, 164.1602325167327, 200.0, 182.03386710259193, 153.03150297878864, 162.38, 191.95170397157702, 200.0, 151.2204091838158, 118.39924938850807, 85.73306264242493, 142.71468175409493, 188.95340448395774, 98.7551748691736, 145.30736048302452, 141.0527024038543, 140.2857988495657, 143.69719901950802, 146.7040223893262, 135.1462265732714, 85.42922346485295, 83.83064273690857, 145.5149525244117, 179.61793472059543, 162.25605772938533, 126.74000000000001, 143.29623503823865, 142.1549563542913, 164.51341242719948, 200.0, 85.91963359548441, 74.76094604516256, 77.52881190031604, 152.75899423412372, 189.90161060200387, 158.93447203186128, 150.5, 172.9806995133231, 105.99714407819138, 111.46688144353449, 86.711598414639, 60.64670887295001, 165.05877434918102, 186.92442541428915, 186.08051004975775, 39.4815162064107, 100.27678718848789, 108.71018470773814, 180.14159925009773, 162.71158645536502, 122.43289803790609, 137.58489990520226, 189.36546725001506, 84.23166153727219, 170.0687551308871, 134.32947599679176, 143.63031755562764, 97.77790123978833, 172.78557504100655, 177.66715176945144, 40.65188419724306, 184.45068351182314, 148.30581129356887, 176.24, 182.18, 116.96115350292465, 152.68064724656406, 114.57423702187461, 81.53797231161137, 105.38341124267404, 117.87223496352695, 200.0, 135.94819141793937, 120.42726613946809, 114.91539150210275, 73.22558654077004, 170.0621496837021, 149.92917064081894, 91.4067951990755, 83.53419889680907, 152.21481555453357, 162.72517242452125, 161.91650154593313, 177.62681826124174, 51.28599404822354, 48.66759362207496, 103.5230994674865, 66.18050520559277, 22.047334161835362, 83.70160240338637, -11.269112035594652, 32.87714064636352, 18.030833383600417, 113.41671679947211, 135.95362768064172, 153.46999999999997, 157.31863796257306, 81.00651359831275, 83.37434969296818, 152.496694683079, 68.22365673950935, 161.36114557810345, 106.16542903498471, 92.4970882828464, 177.22999999999996, 88.5500957095851, 105.24636738039978, 91.64444920592055, 187.1536103178004, -8.70740875460652, 121.71237446245144, 66.75796354929602, 54.109722621503536, 33.15077065987252, 64.58632761330317, 3.399958793167407, 154.40951172367448, 83.08288590783351, 87.57593098569052, 101.64600813178298, 84.0701633841386, 23.05342808642248, 12.984697490306468, 63.08458210079185, 146.54000000000008, 100.4921455542528, -50.93370337271612, 7.250997672153833, 101.93683247878651, 21.92784808333708, 146.97177046489452, 155.45, 98.56873122115834, -34.89530732390443, 156.2498790770107, 158.42, 88.62442243979008, 91.83000779036055, 158.71712065927568, 123.57911570555035, 115.64881676676123, 101.37285228171064, 138.9138680822042, 162.22204095483195, 183.17, 140.33604071096906, 23.708569844753757, 80.83452825021017, 17.746790010246823, 104.6605477943599, 104.50766130237089, 64.20062965298919, 125.45107193716072, 137.644083815518, 91.6588111468337, 32.51106866462632, 47.612206329825995, 115.58131286894023, 97.76885676554221, 148.552002594448], "policy_predator_policy_reward": [3.9635435177190708, 31.88478981140376, 0.8125487281158152, 0.0, 15.747710709035518, 25.22881034676053, 35.331645791587434, 23.938816494602055, 17.74398191774007, 14.006498916578598, 14.115655015970951, 22.661434107542977, 12.895031538249485, 4.9462826289150215, 14.482481736329175, 10.200631743801692, 0.7367536179149181, 12.856098647953923, 7.95340045648825, 11.585982163852297, 1.784219642404691, 10.73869664018007, 2.603588834638088, 1.614191789543076, 2.3481456956610187, 14.671419728704315, 3.3116991574140937, 4.971084440995402, 10.877393376610831, 20.06356146085368, 0.0, 29.645442325836758, 17.648916003679094, 28.14657083153613, 1.5539347049044767, 11.961941852214947, 0.0, 1.0936908216574028, 9.112866356157829, 6.649851387826883, 1.3652675111754293, 0.18976748326730575, 1.4031697104394698, 1.8937495765081964, 3.238497021211348, 0.0, 1.0332187344867738, 0.9506184765251994, 17.033426992150016, 0.7369144355261005, 23.822306381716054, 32.84747029925936, 0.5372869656386277, 40.354825130826384, 12.008565262489324, 17.78959246758894, 9.466370956375798, 7.355456755022375, 11.982364638417561, 13.22687533339155, 17.342478769250125, 43.1798095024106, 5.8089484474278965, 7.585900457490409, 2.111267789559151, 11.743942270614674, 2.9267074157014, 18.88961778582628, 6.956355843143686, 3.569628236231953, 20.84558698567863, 37.20665778328047, 25.63101171533291, 12.821741787203154, 0.0, 12.075527968138731, 0.9772911717885555, 6.099300486676906, 5.537363729182818, 46.3949092652821, 14.551655064289209, 32.54889414047192, 9.086805437080804, 0.9999947994490312, 76.49963147143578, 21.15152183359766, 39.71189618009513, 11.820782415582768, 2.5190884415935115, 7.5819786492111865, 11.234395826466613, 0.0, 19.289740844286463, 27.411474036069357, 9.897022853755027, 3.124746018566104, 25.102432766787324, 16.672771596705918, 4.062011399547655, 4.949543890436261, 14.572888953398698, 20.67454333753512, 6.707373420166085, 2.0768152862650378, 17.755652108487375, 14.382834722228656, 2.8499068104976835, 22.73780640761131, 12.594979985054028, 22.188775224943775, 17.439032655085352, 19.71698816406745, 10.525188957947359, 11.742055690578425, 9.796957765421752, 29.500354279433314, 14.82711628341501, 0.0, 0.0, 46.13637480905065, 0.0, 3.7000120209452656, 1.022636983186231, 1.3814586309949908, 31.57764791900957, 9.472344501171577, 6.813647556336455, 26.56648269380152, 24.677964111420224, 33.785440724004054, 19.037824138431827, 59.06185358764096, 7.086422811615692, 61.56225120117023, 5.516372319358266, 1.61353764322166, 16.03968831080516, 32.65765087814476, 20.59236602620463, 20.569508771226314, 32.53672996116586, 41.561228270175704, 22.32679125142142, 15.783715605112466, 18.62990429041492, 3.4475370434538513, 5.615408002702725, 4.2554673685371505, 45.38732250877417, 2.711276710214924, 4.661980766438295, 15.986872436176109, 14.019539088362823, 52.539860127298574, 48.06242597127429, 7.634336732282903, 16.79444642114931, 20.25072758293245, 0.38611129752618756, 24.782085726648415, 42.681777417897415, 9.553113186316537, 21.38014860842548, 45.85753443462871, 6.626714349648751, 16.984324889470418, 26.603637253244663, 40.29478709452184, 15.112049517496398, 37.56538927369206, 0.1819983603260013, 6.368229535105479, 2.894351862739193, 47.24790749370785, 1.1201209229892906, 0.0, 12.31399728393612, 14.735270985955822, 15.86286597468609, 7.071221606884753, 21.113289165935473, 19.363175284449714, 3.441676447686586, 9.329555783568965, 2.648159141990337, 9.103271244494982, 37.30435408143875, 2.317384477621029, 15.073154407349879, 22.151772407088572, 25.13042665198803, 8.115337414364596, 23.79892806283927, 0.0, 22.635379798232513, 35.9546229147051, 25.32892448363869, 3.582506109780768, 25.88377261725575, 4.485368022754085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7397666673143726, "mean_inference_ms": 2.2654753512967587, "mean_action_processing_ms": 0.3100527478966488, "mean_env_wait_ms": 0.26668094972106826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010219573974609375, "StateBufferConnector_ms": 0.0037118196487426758, "ViewRequirementAgentConnector_ms": 0.15121698379516602}, "num_episodes": 22, "episode_return_max": 393.93554118258896, "episode_return_min": 23.215718647204177, "episode_return_mean": 270.72124069158536, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.01208370973524, "num_env_steps_trained_throughput_per_sec": 321.01208370973524, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 12909.087, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12909.036, "sample_time_ms": 1731.338, "learn_time_ms": 11156.303, "learn_throughput": 358.542, "synch_weights_time_ms": 18.939}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "ef79f_00000", "date": "2024-08-16_11-31-56", "timestamp": 1723788116, "time_this_iter_s": 12.519704103469849, "time_total_s": 891.4908323287964, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321429820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 891.4908323287964, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 63.02222222222221, "ram_util_percent": 82.21666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.474929712941407, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.343080914209759, "policy_loss": -0.010704815531243132, "vf_loss": 8.350661860571968, "vf_explained_var": -0.025087558340143274, "kl": 0.02082562954947045, "entropy": 0.8700184444586436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.743849794952958, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.742337149287027, "policy_loss": -0.00451530181832375, "vf_loss": 3.746852380384213, "vf_explained_var": 0.4152040458545483, "kl": 0.009237835188950145, "entropy": 0.2501389728888633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 393.93554118258896, "episode_reward_min": 23.215718647204177, "episode_reward_mean": 251.55383686441556, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.93370337271612, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 76.49963147143578}, "policy_reward_mean": {"prey_policy": 108.52638350144844, "predator_policy": 17.25053493075938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [393.93554118258896, 287.39, 285.11752107749527, 328.6006914495963, 316.1582206169571, 300.8048255804719, 307.0594889344067, 229.78215447342222, 338.5277361499255, 302.8512677895592, 307.2675165940576, 375.03939650657514, 218.7328244096061, 268.74055963697583, 360.91161060200386, 330.5572911717886, 269.39629851619077, 194.45885649235012, 362.07, 323.21317956120185, 260.519650491904, 352.95425279626744, 271.25219376957494, 320.29834366764317, 317.42, 283.1834231589092, 359.4642821004419, 260.35, 333.33, 331.2796403336407, 292.8425974865477, 221.7051387642834, 355.02825578267976, 278.64270220593323, 227.43829008772784, 334.81843660793606, 221.0773689049352, 318.63999999999976, 341.9474154213561, 141.00358009047963, 203.0837349232172, 164.21234140064593, 99.70770633684158, 200.09622419585844, 296.55353764322166, 287.02249074983575, 277.03291917347804, 303.6827605489543, 236.77302417436493, 287.8575370434538, 206.7616919575602, 226.54480078218276, 209.11919121436205, 153.81989249703742, 123.6830491100279, 274.5375716355898, 214.39013614164807, 159.35848207477497, 143.30696263415248, 270.6431847933718, 23.215718647204177, 176.542119353312, 308.971998360326, 113.81568325370098, 315.7900000000001, 207.50369850004262, 305.2303239463968, 257.49813349885704, 313.9071412682917, 335.2574710974544, 144.16483665402373, 159.63226461904503, 201.95405502171278, 286.8940838155181, 182.75988252439754, 192.1049497921857, 276.69, 195.83069578608644, 180.9003123536172, 280.2121453665858, 284.98667027808204, 304.9500000000001, 249.8599999999999, 176.7339076634011, 319.193382121242, 350.7208853448676, 191.46142810145227, 209.8847554471356, 303.23681783981584, 36.112460118442705, 259.52471767202377, 229.06854584552417, 223.69022217337033, 136.79613587014683, 195.7134610099693, 146.7506271040148, 174.03000000000003, 233.52946796595447, 239.98243728162316, 168.284459299723], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.95170397157702, 200.0, 151.2204091838158, 118.39924938850807, 85.73306264242493, 142.71468175409493, 188.95340448395774, 98.7551748691736, 145.30736048302452, 141.0527024038543, 140.2857988495657, 143.69719901950802, 146.7040223893262, 135.1462265732714, 85.42922346485295, 83.83064273690857, 145.5149525244117, 179.61793472059543, 162.25605772938533, 126.74000000000001, 143.29623503823865, 142.1549563542913, 164.51341242719948, 200.0, 85.91963359548441, 74.76094604516256, 77.52881190031604, 152.75899423412372, 189.90161060200387, 158.93447203186128, 150.5, 172.9806995133231, 105.99714407819138, 111.46688144353449, 86.711598414639, 60.64670887295001, 165.05877434918102, 186.92442541428915, 186.08051004975775, 39.4815162064107, 100.27678718848789, 108.71018470773814, 180.14159925009773, 162.71158645536502, 122.43289803790609, 137.58489990520226, 189.36546725001506, 84.23166153727219, 170.0687551308871, 134.32947599679176, 143.63031755562764, 97.77790123978833, 172.78557504100655, 177.66715176945144, 40.65188419724306, 184.45068351182314, 148.30581129356887, 176.24, 182.18, 116.96115350292465, 152.68064724656406, 114.57423702187461, 81.53797231161137, 105.38341124267404, 117.87223496352695, 200.0, 135.94819141793937, 120.42726613946809, 114.91539150210275, 73.22558654077004, 170.0621496837021, 149.92917064081894, 91.4067951990755, 83.53419889680907, 152.21481555453357, 162.72517242452125, 161.91650154593313, 177.62681826124174, 51.28599404822354, 48.66759362207496, 103.5230994674865, 66.18050520559277, 22.047334161835362, 83.70160240338637, -11.269112035594652, 32.87714064636352, 18.030833383600417, 113.41671679947211, 135.95362768064172, 153.46999999999997, 157.31863796257306, 81.00651359831275, 83.37434969296818, 152.496694683079, 68.22365673950935, 161.36114557810345, 106.16542903498471, 92.4970882828464, 177.22999999999996, 88.5500957095851, 105.24636738039978, 91.64444920592055, 187.1536103178004, -8.70740875460652, 121.71237446245144, 66.75796354929602, 54.109722621503536, 33.15077065987252, 64.58632761330317, 3.399958793167407, 154.40951172367448, 83.08288590783351, 87.57593098569052, 101.64600813178298, 84.0701633841386, 23.05342808642248, 12.984697490306468, 63.08458210079185, 146.54000000000008, 100.4921455542528, -50.93370337271612, 7.250997672153833, 101.93683247878651, 21.92784808333708, 146.97177046489452, 155.45, 98.56873122115834, -34.89530732390443, 156.2498790770107, 158.42, 88.62442243979008, 91.83000779036055, 158.71712065927568, 123.57911570555035, 115.64881676676123, 101.37285228171064, 138.9138680822042, 162.22204095483195, 183.17, 140.33604071096906, 23.708569844753757, 80.83452825021017, 17.746790010246823, 104.6605477943599, 104.50766130237089, 64.20062965298919, 125.45107193716072, 137.644083815518, 91.6588111468337, 32.51106866462632, 47.612206329825995, 115.58131286894023, 97.76885676554221, 148.552002594448, 51.40447974509987, 65.01778472580483, 71.29623524801855, 67.35139015673427, 110.79536324023991, 152.94785931859647, 119.81000000000006, 161.1165031721728, 159.1551624055344, 145.55, 137.74679184875765, 97.35391651671846, 83.1018267358275, 70.78700366547741, 133.4216104094572, 184.16000000000003, 170.92758215744473, 167.50925750577062, 0.20155566695938276, 90.13316587185406, 78.44410239047262, 105.00552702410015, 120.0377533453353, 158.72505533364802, -40.49022713766425, 8.013998857595128, 91.9288235252288, 151.2124038611737, 68.37070973459389, 129.3404779896038, 112.38259438700895, 86.30978446332159, -1.8574237587540092, 40.55271616816301, 35.55071639854242, 79.2456994184453, 50.66270594274719, 54.65563934539263, 72.60837805308319, 70.99449724772175, 120.92728414307436, 93.64963835420137, 100.49074510618692, 103.73355104339737, 10.703275387226805, 78.97738280274629], "policy_predator_policy_reward": [1.0332187344867738, 0.9506184765251994, 17.033426992150016, 0.7369144355261005, 23.822306381716054, 32.84747029925936, 0.5372869656386277, 40.354825130826384, 12.008565262489324, 17.78959246758894, 9.466370956375798, 7.355456755022375, 11.982364638417561, 13.22687533339155, 17.342478769250125, 43.1798095024106, 5.8089484474278965, 7.585900457490409, 2.111267789559151, 11.743942270614674, 2.9267074157014, 18.88961778582628, 6.956355843143686, 3.569628236231953, 20.84558698567863, 37.20665778328047, 25.63101171533291, 12.821741787203154, 0.0, 12.075527968138731, 0.9772911717885555, 6.099300486676906, 5.537363729182818, 46.3949092652821, 14.551655064289209, 32.54889414047192, 9.086805437080804, 0.9999947994490312, 76.49963147143578, 21.15152183359766, 39.71189618009513, 11.820782415582768, 2.5190884415935115, 7.5819786492111865, 11.234395826466613, 0.0, 19.289740844286463, 27.411474036069357, 9.897022853755027, 3.124746018566104, 25.102432766787324, 16.672771596705918, 4.062011399547655, 4.949543890436261, 14.572888953398698, 20.67454333753512, 6.707373420166085, 2.0768152862650378, 17.755652108487375, 14.382834722228656, 2.8499068104976835, 22.73780640761131, 12.594979985054028, 22.188775224943775, 17.439032655085352, 19.71698816406745, 10.525188957947359, 11.742055690578425, 9.796957765421752, 29.500354279433314, 14.82711628341501, 0.0, 0.0, 46.13637480905065, 0.0, 3.7000120209452656, 1.022636983186231, 1.3814586309949908, 31.57764791900957, 9.472344501171577, 6.813647556336455, 26.56648269380152, 24.677964111420224, 33.785440724004054, 19.037824138431827, 59.06185358764096, 7.086422811615692, 61.56225120117023, 5.516372319358266, 1.61353764322166, 16.03968831080516, 32.65765087814476, 20.59236602620463, 20.569508771226314, 32.53672996116586, 41.561228270175704, 22.32679125142142, 15.783715605112466, 18.62990429041492, 3.4475370434538513, 5.615408002702725, 4.2554673685371505, 45.38732250877417, 2.711276710214924, 4.661980766438295, 15.986872436176109, 14.019539088362823, 52.539860127298574, 48.06242597127429, 7.634336732282903, 16.79444642114931, 20.25072758293245, 0.38611129752618756, 24.782085726648415, 42.681777417897415, 9.553113186316537, 21.38014860842548, 45.85753443462871, 6.626714349648751, 16.984324889470418, 26.603637253244663, 40.29478709452184, 15.112049517496398, 37.56538927369206, 0.1819983603260013, 6.368229535105479, 2.894351862739193, 47.24790749370785, 1.1201209229892906, 0.0, 12.31399728393612, 14.735270985955822, 15.86286597468609, 7.071221606884753, 21.113289165935473, 19.363175284449714, 3.441676447686586, 9.329555783568965, 2.648159141990337, 9.103271244494982, 37.30435408143875, 2.317384477621029, 15.073154407349879, 22.151772407088572, 25.13042665198803, 8.115337414364596, 23.79892806283927, 0.0, 22.635379798232513, 35.9546229147051, 25.32892448363869, 3.582506109780768, 25.88377261725575, 4.485368022754085, 34.6180111006484, 44.7904202145334, 42.25268694886434, 0.0, 9.860073503587392, 6.608849304161997, 0.9366702780821837, 3.1234968278272293, 0.24483759446564987, 0.0, 3.819816431846377, 10.939475202677494, 22.102301810595396, 0.7427754515008064, 0.44175528421944105, 1.1700164275653642, 6.037003542549434, 6.247042139102861, 60.08982235913179, 41.03688420350723, 20.266755615990416, 6.168370416572408, 12.693067633637854, 11.780941527194816, 14.03475281065775, 54.55393558785403, 16.38349028562144, 0.0, 8.67695767637223, 22.680400444954284, 8.514871458328638, 16.482971864711136, 48.54760544023722, 49.553238020500345, 38.66796597821204, 42.249079214769644, 7.0935484374905045, 34.33873337838443, 4.111428278503897, 26.315696420691133, 15.363479077621358, 3.5890663910574747, 7.277843134758709, 28.480297997280232, 6.4869882350133246, 72.11681287473655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7415541509261736, "mean_inference_ms": 2.269770757530121, "mean_action_processing_ms": 0.31035771061759937, "mean_env_wait_ms": 0.2666760944855163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012186169624328613, "StateBufferConnector_ms": 0.012185811996459961, "ViewRequirementAgentConnector_ms": 0.18225550651550293}, "num_episodes": 23, "episode_return_max": 393.93554118258896, "episode_return_min": 23.215718647204177, "episode_return_mean": 251.55383686441556, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.8114073710743, "num_env_steps_trained_throughput_per_sec": 314.8114073710743, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 12882.133, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12882.083, "sample_time_ms": 1787.347, "learn_time_ms": 11073.727, "learn_throughput": 361.215, "synch_weights_time_ms": 18.675}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "ef79f_00000", "date": "2024-08-16_11-32-09", "timestamp": 1723788129, "time_this_iter_s": 12.711312294006348, "time_total_s": 904.2021446228027, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214aa160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 904.2021446228027, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 61.20000000000001, "ram_util_percent": 81.85555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.709132664544242, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.713081916677889, "policy_loss": -0.0036702473849925415, "vf_loss": 7.71420972612169, "vf_explained_var": 0.08823457751324568, "kl": 0.011299733667885122, "entropy": 0.9306859489155825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.912182243665059, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3548633120047353, "policy_loss": -6.713805900068668e-05, "vf_loss": 2.3549304427293243, "vf_explained_var": 0.1436696431939564, "kl": 0.004692632974255113, "entropy": 0.20476649391351553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 362.07, "episode_reward_min": 23.215718647204177, "episode_reward_mean": 243.50129040573722, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -50.93370337271612, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 76.49963147143578}, "policy_reward_mean": {"prey_policy": 104.67885673494882, "predator_policy": 17.07178846791982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.07, 323.21317956120185, 260.519650491904, 352.95425279626744, 271.25219376957494, 320.29834366764317, 317.42, 283.1834231589092, 359.4642821004419, 260.35, 333.33, 331.2796403336407, 292.8425974865477, 221.7051387642834, 355.02825578267976, 278.64270220593323, 227.43829008772784, 334.81843660793606, 221.0773689049352, 318.63999999999976, 341.9474154213561, 141.00358009047963, 203.0837349232172, 164.21234140064593, 99.70770633684158, 200.09622419585844, 296.55353764322166, 287.02249074983575, 277.03291917347804, 303.6827605489543, 236.77302417436493, 287.8575370434538, 206.7616919575602, 226.54480078218276, 209.11919121436205, 153.81989249703742, 123.6830491100279, 274.5375716355898, 214.39013614164807, 159.35848207477497, 143.30696263415248, 270.6431847933718, 23.215718647204177, 176.542119353312, 308.971998360326, 113.81568325370098, 315.7900000000001, 207.50369850004262, 305.2303239463968, 257.49813349885704, 313.9071412682917, 335.2574710974544, 144.16483665402373, 159.63226461904503, 201.95405502171278, 286.8940838155181, 182.75988252439754, 192.1049497921857, 276.69, 195.83069578608644, 180.9003123536172, 280.2121453665858, 284.98667027808204, 304.9500000000001, 249.8599999999999, 176.7339076634011, 319.193382121242, 350.7208853448676, 191.46142810145227, 209.8847554471356, 303.23681783981584, 36.112460118442705, 259.52471767202377, 229.06854584552417, 223.69022217337033, 136.79613587014683, 195.7134610099693, 146.7506271040148, 174.03000000000003, 233.52946796595447, 239.98243728162316, 168.284459299723, 274.6680788070221, 225.7205373643039, 227.7951838344178, 308.2523085774022, 216.82895565171577, 241.25901930000657, 158.13804152935234, 238.7552789697138, 315.6399999999999, 300.3650765589038, 232.71736501882242, 258.03395056087027, 282.393706152348, 288.818159920428, 285.7295600737641, 229.92586832644332, 264.4260646706216, 260.6099999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [165.05877434918102, 186.92442541428915, 186.08051004975775, 39.4815162064107, 100.27678718848789, 108.71018470773814, 180.14159925009773, 162.71158645536502, 122.43289803790609, 137.58489990520226, 189.36546725001506, 84.23166153727219, 170.0687551308871, 134.32947599679176, 143.63031755562764, 97.77790123978833, 172.78557504100655, 177.66715176945144, 40.65188419724306, 184.45068351182314, 148.30581129356887, 176.24, 182.18, 116.96115350292465, 152.68064724656406, 114.57423702187461, 81.53797231161137, 105.38341124267404, 117.87223496352695, 200.0, 135.94819141793937, 120.42726613946809, 114.91539150210275, 73.22558654077004, 170.0621496837021, 149.92917064081894, 91.4067951990755, 83.53419889680907, 152.21481555453357, 162.72517242452125, 161.91650154593313, 177.62681826124174, 51.28599404822354, 48.66759362207496, 103.5230994674865, 66.18050520559277, 22.047334161835362, 83.70160240338637, -11.269112035594652, 32.87714064636352, 18.030833383600417, 113.41671679947211, 135.95362768064172, 153.46999999999997, 157.31863796257306, 81.00651359831275, 83.37434969296818, 152.496694683079, 68.22365673950935, 161.36114557810345, 106.16542903498471, 92.4970882828464, 177.22999999999996, 88.5500957095851, 105.24636738039978, 91.64444920592055, 187.1536103178004, -8.70740875460652, 121.71237446245144, 66.75796354929602, 54.109722621503536, 33.15077065987252, 64.58632761330317, 3.399958793167407, 154.40951172367448, 83.08288590783351, 87.57593098569052, 101.64600813178298, 84.0701633841386, 23.05342808642248, 12.984697490306468, 63.08458210079185, 146.54000000000008, 100.4921455542528, -50.93370337271612, 7.250997672153833, 101.93683247878651, 21.92784808333708, 146.97177046489452, 155.45, 98.56873122115834, -34.89530732390443, 156.2498790770107, 158.42, 88.62442243979008, 91.83000779036055, 158.71712065927568, 123.57911570555035, 115.64881676676123, 101.37285228171064, 138.9138680822042, 162.22204095483195, 183.17, 140.33604071096906, 23.708569844753757, 80.83452825021017, 17.746790010246823, 104.6605477943599, 104.50766130237089, 64.20062965298919, 125.45107193716072, 137.644083815518, 91.6588111468337, 32.51106866462632, 47.612206329825995, 115.58131286894023, 97.76885676554221, 148.552002594448, 51.40447974509987, 65.01778472580483, 71.29623524801855, 67.35139015673427, 110.79536324023991, 152.94785931859647, 119.81000000000006, 161.1165031721728, 159.1551624055344, 145.55, 137.74679184875765, 97.35391651671846, 83.1018267358275, 70.78700366547741, 133.4216104094572, 184.16000000000003, 170.92758215744473, 167.50925750577062, 0.20155566695938276, 90.13316587185406, 78.44410239047262, 105.00552702410015, 120.0377533453353, 158.72505533364802, -40.49022713766425, 8.013998857595128, 91.9288235252288, 151.2124038611737, 68.37070973459389, 129.3404779896038, 112.38259438700895, 86.30978446332159, -1.8574237587540092, 40.55271616816301, 35.55071639854242, 79.2456994184453, 50.66270594274719, 54.65563934539263, 72.60837805308319, 70.99449724772175, 120.92728414307436, 93.64963835420137, 100.49074510618692, 103.73355104339737, 10.703275387226805, 78.97738280274629, 145.10582542123558, 117.94083756606055, 59.06939794521847, 141.8313990821763, 57.04511509075499, 120.35494401377152, 150.16949992926635, 152.61096393216195, 61.092733164509845, 127.47370918396545, 95.95295999712414, 112.92129129888912, 59.306837097008156, 46.69651959876344, 79.90457968729028, 126.474647961094, 179.86616232259635, 131.20871600272918, 126.62509632345989, 161.82391389792997, 128.28438516492304, 95.38834422232554, 67.07031440245142, 115.66730246352341, 162.38, 102.10306259299972, 118.64375548426199, 152.0051403756671, 141.13799602477354, 129.56909640952358, 109.10044813095301, 89.92729380459299, 126.67011805236812, 106.82323362073029, 84.63785005391343, 138.99306812064174], "policy_predator_policy_reward": [9.086805437080804, 0.9999947994490312, 76.49963147143578, 21.15152183359766, 39.71189618009513, 11.820782415582768, 2.5190884415935115, 7.5819786492111865, 11.234395826466613, 0.0, 19.289740844286463, 27.411474036069357, 9.897022853755027, 3.124746018566104, 25.102432766787324, 16.672771596705918, 4.062011399547655, 4.949543890436261, 14.572888953398698, 20.67454333753512, 6.707373420166085, 2.0768152862650378, 17.755652108487375, 14.382834722228656, 2.8499068104976835, 22.73780640761131, 12.594979985054028, 22.188775224943775, 17.439032655085352, 19.71698816406745, 10.525188957947359, 11.742055690578425, 9.796957765421752, 29.500354279433314, 14.82711628341501, 0.0, 0.0, 46.13637480905065, 0.0, 3.7000120209452656, 1.022636983186231, 1.3814586309949908, 31.57764791900957, 9.472344501171577, 6.813647556336455, 26.56648269380152, 24.677964111420224, 33.785440724004054, 19.037824138431827, 59.06185358764096, 7.086422811615692, 61.56225120117023, 5.516372319358266, 1.61353764322166, 16.03968831080516, 32.65765087814476, 20.59236602620463, 20.569508771226314, 32.53672996116586, 41.561228270175704, 22.32679125142142, 15.783715605112466, 18.62990429041492, 3.4475370434538513, 5.615408002702725, 4.2554673685371505, 45.38732250877417, 2.711276710214924, 4.661980766438295, 15.986872436176109, 14.019539088362823, 52.539860127298574, 48.06242597127429, 7.634336732282903, 16.79444642114931, 20.25072758293245, 0.38611129752618756, 24.782085726648415, 42.681777417897415, 9.553113186316537, 21.38014860842548, 45.85753443462871, 6.626714349648751, 16.984324889470418, 26.603637253244663, 40.29478709452184, 15.112049517496398, 37.56538927369206, 0.1819983603260013, 6.368229535105479, 2.894351862739193, 47.24790749370785, 1.1201209229892906, 0.0, 12.31399728393612, 14.735270985955822, 15.86286597468609, 7.071221606884753, 21.113289165935473, 19.363175284449714, 3.441676447686586, 9.329555783568965, 2.648159141990337, 9.103271244494982, 37.30435408143875, 2.317384477621029, 15.073154407349879, 22.151772407088572, 25.13042665198803, 8.115337414364596, 23.79892806283927, 0.0, 22.635379798232513, 35.9546229147051, 25.32892448363869, 3.582506109780768, 25.88377261725575, 4.485368022754085, 34.6180111006484, 44.7904202145334, 42.25268694886434, 0.0, 9.860073503587392, 6.608849304161997, 0.9366702780821837, 3.1234968278272293, 0.24483759446564987, 0.0, 3.819816431846377, 10.939475202677494, 22.102301810595396, 0.7427754515008064, 0.44175528421944105, 1.1700164275653642, 6.037003542549434, 6.247042139102861, 60.08982235913179, 41.03688420350723, 20.266755615990416, 6.168370416572408, 12.693067633637854, 11.780941527194816, 14.03475281065775, 54.55393558785403, 16.38349028562144, 0.0, 8.67695767637223, 22.680400444954284, 8.514871458328638, 16.482971864711136, 48.54760544023722, 49.553238020500345, 38.66796597821204, 42.249079214769644, 7.0935484374905045, 34.33873337838443, 4.111428278503897, 26.315696420691133, 15.363479077621358, 3.5890663910574747, 7.277843134758709, 28.480297997280232, 6.4869882350133246, 72.11681287473655, 6.156731268442394, 5.464684551283613, 17.866507433532913, 6.953232903376099, 26.793893777795923, 23.601230952095584, 4.566095206022051, 0.9057495099519322, 26.930705512707675, 1.3318077905331092, 30.274124723082615, 2.1106432809106965, 30.26467479269609, 21.870010040884758, 10.997428987656958, 21.378622333672745, 2.223837677403698, 2.3412839972708164, 4.67125544479491, 7.244810892719262, 7.890693304671174, 1.153942326902743, 37.955789871691515, 37.34054382320381, 10.679879727012214, 7.230763832336095, 2.99226762217677, 15.176996438322192, 9.833917925691969, 5.1885497137750995, 20.958537604903764, 9.939588785994069, 13.514801406788488, 17.417911590734853, 3.5069318793583095, 33.472149946086596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7429109248663032, "mean_inference_ms": 2.276301690256066, "mean_action_processing_ms": 0.3114728200205328, "mean_env_wait_ms": 0.2677008790557978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008390069007873535, "StateBufferConnector_ms": 0.011907696723937988, "ViewRequirementAgentConnector_ms": 0.16101276874542236}, "num_episodes": 18, "episode_return_max": 362.07, "episode_return_min": 23.215718647204177, "episode_return_mean": 243.50129040573722, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.4266727890936, "num_env_steps_trained_throughput_per_sec": 309.4266727890936, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 12835.493, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12835.444, "sample_time_ms": 1864.692, "learn_time_ms": 10950.812, "learn_throughput": 365.27, "synch_weights_time_ms": 17.788}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "ef79f_00000", "date": "2024-08-16_11-32-22", "timestamp": 1723788142, "time_this_iter_s": 12.934115171432495, "time_total_s": 917.1362597942352, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321429af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 917.1362597942352, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 60.933333333333344, "ram_util_percent": 81.1111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.5314704553790826, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4230670320924625, "policy_loss": -0.0029531610232812386, "vf_loss": 7.424739039638055, "vf_explained_var": 0.1885659010637374, "kl": 0.005693939847006255, "entropy": 0.9024469227071792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.196837171991035, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9758211284718186, "policy_loss": -0.004280184163519787, "vf_loss": 1.9801013100084173, "vf_explained_var": 0.3720929033857174, "kl": 0.006378147387243012, "entropy": 0.17565134050984862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 350.7208853448676, "episode_reward_min": 23.215718647204177, "episode_reward_mean": 234.4446313510247, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -136.0099237465577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.1536103178004, "predator_policy": 155.3124966133962}, "policy_reward_mean": {"prey_policy": 99.62188034542824, "predator_policy": 17.60043533008414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.0773689049352, 318.63999999999976, 341.9474154213561, 141.00358009047963, 203.0837349232172, 164.21234140064593, 99.70770633684158, 200.09622419585844, 296.55353764322166, 287.02249074983575, 277.03291917347804, 303.6827605489543, 236.77302417436493, 287.8575370434538, 206.7616919575602, 226.54480078218276, 209.11919121436205, 153.81989249703742, 123.6830491100279, 274.5375716355898, 214.39013614164807, 159.35848207477497, 143.30696263415248, 270.6431847933718, 23.215718647204177, 176.542119353312, 308.971998360326, 113.81568325370098, 315.7900000000001, 207.50369850004262, 305.2303239463968, 257.49813349885704, 313.9071412682917, 335.2574710974544, 144.16483665402373, 159.63226461904503, 201.95405502171278, 286.8940838155181, 182.75988252439754, 192.1049497921857, 276.69, 195.83069578608644, 180.9003123536172, 280.2121453665858, 284.98667027808204, 304.9500000000001, 249.8599999999999, 176.7339076634011, 319.193382121242, 350.7208853448676, 191.46142810145227, 209.8847554471356, 303.23681783981584, 36.112460118442705, 259.52471767202377, 229.06854584552417, 223.69022217337033, 136.79613587014683, 195.7134610099693, 146.7506271040148, 174.03000000000003, 233.52946796595447, 239.98243728162316, 168.284459299723, 274.6680788070221, 225.7205373643039, 227.7951838344178, 308.2523085774022, 216.82895565171577, 241.25901930000657, 158.13804152935234, 238.7552789697138, 315.6399999999999, 300.3650765589038, 232.71736501882242, 258.03395056087027, 282.393706152348, 288.818159920428, 285.7295600737641, 229.92586832644332, 264.4260646706216, 260.6099999999999, 187.50958616589338, 227.6421739699134, 300.5406702032283, 260.6737192286536, 226.53471308703695, 259.34238747786947, 330.6099999999999, 234.103727465557, 277.9300344325882, 232.36146931388032, 260.1361297538198, 316.4699999999998, 276.39224085625534, 80.7473432858945, 301.4064510698497, 254.45999999999998, 266.390192459875, 286.8936425731223], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [91.4067951990755, 83.53419889680907, 152.21481555453357, 162.72517242452125, 161.91650154593313, 177.62681826124174, 51.28599404822354, 48.66759362207496, 103.5230994674865, 66.18050520559277, 22.047334161835362, 83.70160240338637, -11.269112035594652, 32.87714064636352, 18.030833383600417, 113.41671679947211, 135.95362768064172, 153.46999999999997, 157.31863796257306, 81.00651359831275, 83.37434969296818, 152.496694683079, 68.22365673950935, 161.36114557810345, 106.16542903498471, 92.4970882828464, 177.22999999999996, 88.5500957095851, 105.24636738039978, 91.64444920592055, 187.1536103178004, -8.70740875460652, 121.71237446245144, 66.75796354929602, 54.109722621503536, 33.15077065987252, 64.58632761330317, 3.399958793167407, 154.40951172367448, 83.08288590783351, 87.57593098569052, 101.64600813178298, 84.0701633841386, 23.05342808642248, 12.984697490306468, 63.08458210079185, 146.54000000000008, 100.4921455542528, -50.93370337271612, 7.250997672153833, 101.93683247878651, 21.92784808333708, 146.97177046489452, 155.45, 98.56873122115834, -34.89530732390443, 156.2498790770107, 158.42, 88.62442243979008, 91.83000779036055, 158.71712065927568, 123.57911570555035, 115.64881676676123, 101.37285228171064, 138.9138680822042, 162.22204095483195, 183.17, 140.33604071096906, 23.708569844753757, 80.83452825021017, 17.746790010246823, 104.6605477943599, 104.50766130237089, 64.20062965298919, 125.45107193716072, 137.644083815518, 91.6588111468337, 32.51106866462632, 47.612206329825995, 115.58131286894023, 97.76885676554221, 148.552002594448, 51.40447974509987, 65.01778472580483, 71.29623524801855, 67.35139015673427, 110.79536324023991, 152.94785931859647, 119.81000000000006, 161.1165031721728, 159.1551624055344, 145.55, 137.74679184875765, 97.35391651671846, 83.1018267358275, 70.78700366547741, 133.4216104094572, 184.16000000000003, 170.92758215744473, 167.50925750577062, 0.20155566695938276, 90.13316587185406, 78.44410239047262, 105.00552702410015, 120.0377533453353, 158.72505533364802, -40.49022713766425, 8.013998857595128, 91.9288235252288, 151.2124038611737, 68.37070973459389, 129.3404779896038, 112.38259438700895, 86.30978446332159, -1.8574237587540092, 40.55271616816301, 35.55071639854242, 79.2456994184453, 50.66270594274719, 54.65563934539263, 72.60837805308319, 70.99449724772175, 120.92728414307436, 93.64963835420137, 100.49074510618692, 103.73355104339737, 10.703275387226805, 78.97738280274629, 145.10582542123558, 117.94083756606055, 59.06939794521847, 141.8313990821763, 57.04511509075499, 120.35494401377152, 150.16949992926635, 152.61096393216195, 61.092733164509845, 127.47370918396545, 95.95295999712414, 112.92129129888912, 59.306837097008156, 46.69651959876344, 79.90457968729028, 126.474647961094, 179.86616232259635, 131.20871600272918, 126.62509632345989, 161.82391389792997, 128.28438516492304, 95.38834422232554, 67.07031440245142, 115.66730246352341, 162.38, 102.10306259299972, 118.64375548426199, 152.0051403756671, 141.13799602477354, 129.56909640952358, 109.10044813095301, 89.92729380459299, 126.67011805236812, 106.82323362073029, 84.63785005391343, 138.99306812064174, -136.0099237465577, 34.48282896672313, 89.34838322600706, 105.14188923697138, 151.11199926111664, 147.37622860164583, 143.86329071861462, 106.78491221993505, 90.22208744305418, 105.15353963594134, 121.10909102001496, 118.48590144211917, 154.64176648598442, 174.26, 32.01779106096693, 114.70333471252054, 115.84999999999992, 148.44048987277094, 83.97353561107865, 134.63907480739596, 128.72000000000014, 119.09780061039609, 160.70214668989342, 142.71551176833984, 126.78427032239549, 124.47980658043764, 17.788498921754677, 18.136682210965006, 174.02554795027308, 97.72125653662619, 118.62857276359776, 135.64999999999995, 136.27711942821549, 119.00240150764498, 168.3200000000001, 109.56416453092976], "policy_predator_policy_reward": [0.0, 46.13637480905065, 0.0, 3.7000120209452656, 1.022636983186231, 1.3814586309949908, 31.57764791900957, 9.472344501171577, 6.813647556336455, 26.56648269380152, 24.677964111420224, 33.785440724004054, 19.037824138431827, 59.06185358764096, 7.086422811615692, 61.56225120117023, 5.516372319358266, 1.61353764322166, 16.03968831080516, 32.65765087814476, 20.59236602620463, 20.569508771226314, 32.53672996116586, 41.561228270175704, 22.32679125142142, 15.783715605112466, 18.62990429041492, 3.4475370434538513, 5.615408002702725, 4.2554673685371505, 45.38732250877417, 2.711276710214924, 4.661980766438295, 15.986872436176109, 14.019539088362823, 52.539860127298574, 48.06242597127429, 7.634336732282903, 16.79444642114931, 20.25072758293245, 0.38611129752618756, 24.782085726648415, 42.681777417897415, 9.553113186316537, 21.38014860842548, 45.85753443462871, 6.626714349648751, 16.984324889470418, 26.603637253244663, 40.29478709452184, 15.112049517496398, 37.56538927369206, 0.1819983603260013, 6.368229535105479, 2.894351862739193, 47.24790749370785, 1.1201209229892906, 0.0, 12.31399728393612, 14.735270985955822, 15.86286597468609, 7.071221606884753, 21.113289165935473, 19.363175284449714, 3.441676447686586, 9.329555783568965, 2.648159141990337, 9.103271244494982, 37.30435408143875, 2.317384477621029, 15.073154407349879, 22.151772407088572, 25.13042665198803, 8.115337414364596, 23.79892806283927, 0.0, 22.635379798232513, 35.9546229147051, 25.32892448363869, 3.582506109780768, 25.88377261725575, 4.485368022754085, 34.6180111006484, 44.7904202145334, 42.25268694886434, 0.0, 9.860073503587392, 6.608849304161997, 0.9366702780821837, 3.1234968278272293, 0.24483759446564987, 0.0, 3.819816431846377, 10.939475202677494, 22.102301810595396, 0.7427754515008064, 0.44175528421944105, 1.1700164275653642, 6.037003542549434, 6.247042139102861, 60.08982235913179, 41.03688420350723, 20.266755615990416, 6.168370416572408, 12.693067633637854, 11.780941527194816, 14.03475281065775, 54.55393558785403, 16.38349028562144, 0.0, 8.67695767637223, 22.680400444954284, 8.514871458328638, 16.482971864711136, 48.54760544023722, 49.553238020500345, 38.66796597821204, 42.249079214769644, 7.0935484374905045, 34.33873337838443, 4.111428278503897, 26.315696420691133, 15.363479077621358, 3.5890663910574747, 7.277843134758709, 28.480297997280232, 6.4869882350133246, 72.11681287473655, 6.156731268442394, 5.464684551283613, 17.866507433532913, 6.953232903376099, 26.793893777795923, 23.601230952095584, 4.566095206022051, 0.9057495099519322, 26.930705512707675, 1.3318077905331092, 30.274124723082615, 2.1106432809106965, 30.26467479269609, 21.870010040884758, 10.997428987656958, 21.378622333672745, 2.223837677403698, 2.3412839972708164, 4.67125544479491, 7.244810892719262, 7.890693304671174, 1.153942326902743, 37.955789871691515, 37.34054382320381, 10.679879727012214, 7.230763832336095, 2.99226762217677, 15.176996438322192, 9.833917925691969, 5.1885497137750995, 20.958537604903764, 9.939588785994069, 13.514801406788488, 17.417911590734853, 3.5069318793583095, 33.472149946086596, 155.3124966133962, 133.72418433233142, 29.580496323592087, 3.5714051833429297, 1.1794287016724736, 0.8730136387932435, 6.11626938514647, 3.9092469049575733, 26.41236564839806, 4.746720359643444, 9.822312940345041, 9.925082075390195, 1.0895632340082757, 0.6186702800072249, 31.483544240462358, 55.89905745160721, 5.560538605325442, 8.079005954491876, 1.94273750390629, 11.806121391499442, 3.9262369168570443, 8.392092226567353, 4.124044472738966, 8.92829706902788, 19.69246437977677, 5.435699573645889, 11.84108884196067, 32.98107331121421, 22.644045585449636, 7.015600997500879, 0.0, 0.18142723640223368, 4.034686263045855, 7.075985260968909, 8.105835469070275, 0.9036425731223171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7447128776437298, "mean_inference_ms": 2.2823029383860325, "mean_action_processing_ms": 0.3123065395506865, "mean_env_wait_ms": 0.2684305976099616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007702350616455078, "StateBufferConnector_ms": 0.011882424354553223, "ViewRequirementAgentConnector_ms": 0.15051913261413574}, "num_episodes": 18, "episode_return_max": 350.7208853448676, "episode_return_min": 23.215718647204177, "episode_return_mean": 234.4446313510247, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.2466924700492, "num_env_steps_trained_throughput_per_sec": 292.2466924700492, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 12908.728, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12908.678, "sample_time_ms": 1876.238, "learn_time_ms": 11013.437, "learn_throughput": 363.193, "synch_weights_time_ms": 16.777}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "ef79f_00000", "date": "2024-08-16_11-32-35", "timestamp": 1723788155, "time_this_iter_s": 13.727563858032227, "time_total_s": 930.8638236522675, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321429e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 930.8638236522675, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 65.85999999999999, "ram_util_percent": 81.03}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5691039978827117, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.963215683881568, "policy_loss": -0.003966327802223897, "vf_loss": 7.965913645678727, "vf_explained_var": -0.040754864676288825, "kl": 0.005637185114009631, "entropy": 0.9040043763382725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.31167114235106, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.888862653194912, "policy_loss": -0.0020649275112966142, "vf_loss": 2.8909275787848014, "vf_explained_var": 0.2682093876694876, "kl": 0.002195574247658513, "entropy": 0.15616225228107797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 350.7208853448676, "episode_reward_min": -20.852827737934067, "episode_reward_mean": 230.13643053831439, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -136.0099237465577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.16000000000003, "predator_policy": 155.3124966133962}, "policy_reward_mean": {"prey_policy": 97.7136602421515, "predator_policy": 17.35455502700569}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.30696263415248, 270.6431847933718, 23.215718647204177, 176.542119353312, 308.971998360326, 113.81568325370098, 315.7900000000001, 207.50369850004262, 305.2303239463968, 257.49813349885704, 313.9071412682917, 335.2574710974544, 144.16483665402373, 159.63226461904503, 201.95405502171278, 286.8940838155181, 182.75988252439754, 192.1049497921857, 276.69, 195.83069578608644, 180.9003123536172, 280.2121453665858, 284.98667027808204, 304.9500000000001, 249.8599999999999, 176.7339076634011, 319.193382121242, 350.7208853448676, 191.46142810145227, 209.8847554471356, 303.23681783981584, 36.112460118442705, 259.52471767202377, 229.06854584552417, 223.69022217337033, 136.79613587014683, 195.7134610099693, 146.7506271040148, 174.03000000000003, 233.52946796595447, 239.98243728162316, 168.284459299723, 274.6680788070221, 225.7205373643039, 227.7951838344178, 308.2523085774022, 216.82895565171577, 241.25901930000657, 158.13804152935234, 238.7552789697138, 315.6399999999999, 300.3650765589038, 232.71736501882242, 258.03395056087027, 282.393706152348, 288.818159920428, 285.7295600737641, 229.92586832644332, 264.4260646706216, 260.6099999999999, 187.50958616589338, 227.6421739699134, 300.5406702032283, 260.6737192286536, 226.53471308703695, 259.34238747786947, 330.6099999999999, 234.103727465557, 277.9300344325882, 232.36146931388032, 260.1361297538198, 316.4699999999998, 276.39224085625534, 80.7473432858945, 301.4064510698497, 254.45999999999998, 266.390192459875, 286.8936425731223, 305.9858019415665, -4.249744343258136, 302.73999999999995, 227.7510343698102, 238.75839714724944, 297.6254306241085, 248.74207986357732, 144.89014353552304, 12.389938111437976, 245.7270587693268, -20.852827737934067, 334.92708064347846, 243.81513440582563, 54.56849605846209, 230.66018924965516, 216.04660143105394, 279.31703120165463, 320.28058296987854, 247.93910104314995, 107.40466976449365, 162.30015905885452, 319.3190166408767], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [12.984697490306468, 63.08458210079185, 146.54000000000008, 100.4921455542528, -50.93370337271612, 7.250997672153833, 101.93683247878651, 21.92784808333708, 146.97177046489452, 155.45, 98.56873122115834, -34.89530732390443, 156.2498790770107, 158.42, 88.62442243979008, 91.83000779036055, 158.71712065927568, 123.57911570555035, 115.64881676676123, 101.37285228171064, 138.9138680822042, 162.22204095483195, 183.17, 140.33604071096906, 23.708569844753757, 80.83452825021017, 17.746790010246823, 104.6605477943599, 104.50766130237089, 64.20062965298919, 125.45107193716072, 137.644083815518, 91.6588111468337, 32.51106866462632, 47.612206329825995, 115.58131286894023, 97.76885676554221, 148.552002594448, 51.40447974509987, 65.01778472580483, 71.29623524801855, 67.35139015673427, 110.79536324023991, 152.94785931859647, 119.81000000000006, 161.1165031721728, 159.1551624055344, 145.55, 137.74679184875765, 97.35391651671846, 83.1018267358275, 70.78700366547741, 133.4216104094572, 184.16000000000003, 170.92758215744473, 167.50925750577062, 0.20155566695938276, 90.13316587185406, 78.44410239047262, 105.00552702410015, 120.0377533453353, 158.72505533364802, -40.49022713766425, 8.013998857595128, 91.9288235252288, 151.2124038611737, 68.37070973459389, 129.3404779896038, 112.38259438700895, 86.30978446332159, -1.8574237587540092, 40.55271616816301, 35.55071639854242, 79.2456994184453, 50.66270594274719, 54.65563934539263, 72.60837805308319, 70.99449724772175, 120.92728414307436, 93.64963835420137, 100.49074510618692, 103.73355104339737, 10.703275387226805, 78.97738280274629, 145.10582542123558, 117.94083756606055, 59.06939794521847, 141.8313990821763, 57.04511509075499, 120.35494401377152, 150.16949992926635, 152.61096393216195, 61.092733164509845, 127.47370918396545, 95.95295999712414, 112.92129129888912, 59.306837097008156, 46.69651959876344, 79.90457968729028, 126.474647961094, 179.86616232259635, 131.20871600272918, 126.62509632345989, 161.82391389792997, 128.28438516492304, 95.38834422232554, 67.07031440245142, 115.66730246352341, 162.38, 102.10306259299972, 118.64375548426199, 152.0051403756671, 141.13799602477354, 129.56909640952358, 109.10044813095301, 89.92729380459299, 126.67011805236812, 106.82323362073029, 84.63785005391343, 138.99306812064174, -136.0099237465577, 34.48282896672313, 89.34838322600706, 105.14188923697138, 151.11199926111664, 147.37622860164583, 143.86329071861462, 106.78491221993505, 90.22208744305418, 105.15353963594134, 121.10909102001496, 118.48590144211917, 154.64176648598442, 174.26, 32.01779106096693, 114.70333471252054, 115.84999999999992, 148.44048987277094, 83.97353561107865, 134.63907480739596, 128.72000000000014, 119.09780061039609, 160.70214668989342, 142.71551176833984, 126.78427032239549, 124.47980658043764, 17.788498921754677, 18.136682210965006, 174.02554795027308, 97.72125653662619, 118.62857276359776, 135.64999999999995, 136.27711942821549, 119.00240150764498, 168.3200000000001, 109.56416453092976, 152.47999999999993, 144.0867084053965, -17.02440680971306, -54.27540546812312, 159.82394330491329, 132.38826521747907, 49.643687385208175, 142.8137517831667, 110.26079916914053, 94.9523650056113, 149.66380785948834, 134.66710475094519, 95.3862506883555, 125.56414038971788, 16.193177556592087, 91.91271829925802, -74.29415279272834, -9.727770240593369, 108.15635159008413, 101.53381134208541, -35.151690269833125, -41.934640240361645, 169.47195319325618, 163.81821703823047, 69.74662545791122, 118.30255381203055, 19.246652962073973, -18.145346794743457, 64.88843382027815, 113.0542306198458, 116.14957991704586, 73.66328277137706, 99.96043953563873, 139.7999041165609, 165.91504584885234, 147.52999999999997, 118.26308732772928, 106.96916800347063, 44.827693259016016, -20.461720136454403, 46.49905226054304, 69.74678649869634, 156.82207767823797, 143.59475784477775], "policy_predator_policy_reward": [21.38014860842548, 45.85753443462871, 6.626714349648751, 16.984324889470418, 26.603637253244663, 40.29478709452184, 15.112049517496398, 37.56538927369206, 0.1819983603260013, 6.368229535105479, 2.894351862739193, 47.24790749370785, 1.1201209229892906, 0.0, 12.31399728393612, 14.735270985955822, 15.86286597468609, 7.071221606884753, 21.113289165935473, 19.363175284449714, 3.441676447686586, 9.329555783568965, 2.648159141990337, 9.103271244494982, 37.30435408143875, 2.317384477621029, 15.073154407349879, 22.151772407088572, 25.13042665198803, 8.115337414364596, 23.79892806283927, 0.0, 22.635379798232513, 35.9546229147051, 25.32892448363869, 3.582506109780768, 25.88377261725575, 4.485368022754085, 34.6180111006484, 44.7904202145334, 42.25268694886434, 0.0, 9.860073503587392, 6.608849304161997, 0.9366702780821837, 3.1234968278272293, 0.24483759446564987, 0.0, 3.819816431846377, 10.939475202677494, 22.102301810595396, 0.7427754515008064, 0.44175528421944105, 1.1700164275653642, 6.037003542549434, 6.247042139102861, 60.08982235913179, 41.03688420350723, 20.266755615990416, 6.168370416572408, 12.693067633637854, 11.780941527194816, 14.03475281065775, 54.55393558785403, 16.38349028562144, 0.0, 8.67695767637223, 22.680400444954284, 8.514871458328638, 16.482971864711136, 48.54760544023722, 49.553238020500345, 38.66796597821204, 42.249079214769644, 7.0935484374905045, 34.33873337838443, 4.111428278503897, 26.315696420691133, 15.363479077621358, 3.5890663910574747, 7.277843134758709, 28.480297997280232, 6.4869882350133246, 72.11681287473655, 6.156731268442394, 5.464684551283613, 17.866507433532913, 6.953232903376099, 26.793893777795923, 23.601230952095584, 4.566095206022051, 0.9057495099519322, 26.930705512707675, 1.3318077905331092, 30.274124723082615, 2.1106432809106965, 30.26467479269609, 21.870010040884758, 10.997428987656958, 21.378622333672745, 2.223837677403698, 2.3412839972708164, 4.67125544479491, 7.244810892719262, 7.890693304671174, 1.153942326902743, 37.955789871691515, 37.34054382320381, 10.679879727012214, 7.230763832336095, 2.99226762217677, 15.176996438322192, 9.833917925691969, 5.1885497137750995, 20.958537604903764, 9.939588785994069, 13.514801406788488, 17.417911590734853, 3.5069318793583095, 33.472149946086596, 155.3124966133962, 133.72418433233142, 29.580496323592087, 3.5714051833429297, 1.1794287016724736, 0.8730136387932435, 6.11626938514647, 3.9092469049575733, 26.41236564839806, 4.746720359643444, 9.822312940345041, 9.925082075390195, 1.0895632340082757, 0.6186702800072249, 31.483544240462358, 55.89905745160721, 5.560538605325442, 8.079005954491876, 1.94273750390629, 11.806121391499442, 3.9262369168570443, 8.392092226567353, 4.124044472738966, 8.92829706902788, 19.69246437977677, 5.435699573645889, 11.84108884196067, 32.98107331121421, 22.644045585449636, 7.015600997500879, 0.0, 0.18142723640223368, 4.034686263045855, 7.075985260968909, 8.105835469070275, 0.9036425731223171, 9.213291594603522, 0.20580194156633402, 54.03791876145141, 13.012149173126625, 2.4460566950866065, 8.081734782520925, 25.48502803317322, 9.808567168262151, 21.265753605267015, 12.279479367230762, 6.614121642163505, 6.680396371511574, 10.15412581685759, 17.63756296864631, 35.379372375841996, 1.4048753038309134, 82.42364205653125, 13.988219088228439, 17.530434320117056, 18.50646151704027, 0.6405588515021102, 55.59294392075864, 1.299829768513297, 0.3370806434787227, 32.8365722555782, 22.929382880306335, 39.34223443768882, 14.1249554534427, 26.497125106523377, 26.2203997030079, 25.404521654622112, 0.8292170880090505, 13.603256756479373, 25.953430792975578, 4.248403530623419, 2.587133590402851, 8.585194169097697, 14.121651542852364, 0.40044076141151347, 82.63825588052046, 17.455005048905655, 28.599315250709516, 12.496225988459285, 6.405955129401968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7463330934570565, "mean_inference_ms": 2.289928582023149, "mean_action_processing_ms": 0.3128374870152594, "mean_env_wait_ms": 0.2694580253100872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007055759429931641, "StateBufferConnector_ms": 0.011986255645751953, "ViewRequirementAgentConnector_ms": 0.15155315399169922}, "num_episodes": 22, "episode_return_max": 350.7208853448676, "episode_return_min": -20.852827737934067, "episode_return_mean": 230.13643053831439, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.42350865044835, "num_env_steps_trained_throughput_per_sec": 310.42350865044835, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 12881.727, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12881.679, "sample_time_ms": 1860.318, "learn_time_ms": 11002.686, "learn_throughput": 363.548, "synch_weights_time_ms": 16.498}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "ef79f_00000", "date": "2024-08-16_11-32-48", "timestamp": 1723788168, "time_this_iter_s": 12.93985891342163, "time_total_s": 943.8036825656891, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32147fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 943.8036825656891, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 63.861111111111114, "ram_util_percent": 81.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4970215186870917, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.5330974906840655, "policy_loss": -0.002059809931568683, "vf_loss": 7.533423169706234, "vf_explained_var": -0.13621816408066523, "kl": 0.007707205268273157, "entropy": 0.9132265587332388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.143199934088994, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.991317498810077, "policy_loss": -0.0037566688761765522, "vf_loss": 2.995074169724076, "vf_explained_var": 0.5743809557150281, "kl": 0.007090854474370618, "entropy": 0.17095177170460818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 350.7208853448676, "episode_reward_min": -20.852827737934067, "episode_reward_mean": 227.78485623337582, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -233.67754299085624, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.16000000000003, "predator_policy": 386.917542990856}, "policy_reward_mean": {"prey_policy": 94.37493546816839, "predator_policy": 19.517492648519557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.69, 195.83069578608644, 180.9003123536172, 280.2121453665858, 284.98667027808204, 304.9500000000001, 249.8599999999999, 176.7339076634011, 319.193382121242, 350.7208853448676, 191.46142810145227, 209.8847554471356, 303.23681783981584, 36.112460118442705, 259.52471767202377, 229.06854584552417, 223.69022217337033, 136.79613587014683, 195.7134610099693, 146.7506271040148, 174.03000000000003, 233.52946796595447, 239.98243728162316, 168.284459299723, 274.6680788070221, 225.7205373643039, 227.7951838344178, 308.2523085774022, 216.82895565171577, 241.25901930000657, 158.13804152935234, 238.7552789697138, 315.6399999999999, 300.3650765589038, 232.71736501882242, 258.03395056087027, 282.393706152348, 288.818159920428, 285.7295600737641, 229.92586832644332, 264.4260646706216, 260.6099999999999, 187.50958616589338, 227.6421739699134, 300.5406702032283, 260.6737192286536, 226.53471308703695, 259.34238747786947, 330.6099999999999, 234.103727465557, 277.9300344325882, 232.36146931388032, 260.1361297538198, 316.4699999999998, 276.39224085625534, 80.7473432858945, 301.4064510698497, 254.45999999999998, 266.390192459875, 286.8936425731223, 305.9858019415665, -4.249744343258136, 302.73999999999995, 227.7510343698102, 238.75839714724944, 297.6254306241085, 248.74207986357732, 144.89014353552304, 12.389938111437976, 245.7270587693268, -20.852827737934067, 334.92708064347846, 243.81513440582563, 54.56849605846209, 230.66018924965516, 216.04660143105394, 279.31703120165463, 320.28058296987854, 247.93910104314995, 107.40466976449365, 162.30015905885452, 319.3190166408767, 220.87662650654005, 338.78736526092405, 0.23979211810157586, 332.53999999999974, 274.72999999999996, 285.5037897844064, 185.17355722138925, 291.6856118019716, 227.60734136858568, 249.15634449109413, 15.419745527624904, 283.7543886829265, 304.65999999999985, 11.09139965156571, 55.55559044224654, 55.513001818598994, 287.41207603891166, 284.32844657125185], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [97.76885676554221, 148.552002594448, 51.40447974509987, 65.01778472580483, 71.29623524801855, 67.35139015673427, 110.79536324023991, 152.94785931859647, 119.81000000000006, 161.1165031721728, 159.1551624055344, 145.55, 137.74679184875765, 97.35391651671846, 83.1018267358275, 70.78700366547741, 133.4216104094572, 184.16000000000003, 170.92758215744473, 167.50925750577062, 0.20155566695938276, 90.13316587185406, 78.44410239047262, 105.00552702410015, 120.0377533453353, 158.72505533364802, -40.49022713766425, 8.013998857595128, 91.9288235252288, 151.2124038611737, 68.37070973459389, 129.3404779896038, 112.38259438700895, 86.30978446332159, -1.8574237587540092, 40.55271616816301, 35.55071639854242, 79.2456994184453, 50.66270594274719, 54.65563934539263, 72.60837805308319, 70.99449724772175, 120.92728414307436, 93.64963835420137, 100.49074510618692, 103.73355104339737, 10.703275387226805, 78.97738280274629, 145.10582542123558, 117.94083756606055, 59.06939794521847, 141.8313990821763, 57.04511509075499, 120.35494401377152, 150.16949992926635, 152.61096393216195, 61.092733164509845, 127.47370918396545, 95.95295999712414, 112.92129129888912, 59.306837097008156, 46.69651959876344, 79.90457968729028, 126.474647961094, 179.86616232259635, 131.20871600272918, 126.62509632345989, 161.82391389792997, 128.28438516492304, 95.38834422232554, 67.07031440245142, 115.66730246352341, 162.38, 102.10306259299972, 118.64375548426199, 152.0051403756671, 141.13799602477354, 129.56909640952358, 109.10044813095301, 89.92729380459299, 126.67011805236812, 106.82323362073029, 84.63785005391343, 138.99306812064174, -136.0099237465577, 34.48282896672313, 89.34838322600706, 105.14188923697138, 151.11199926111664, 147.37622860164583, 143.86329071861462, 106.78491221993505, 90.22208744305418, 105.15353963594134, 121.10909102001496, 118.48590144211917, 154.64176648598442, 174.26, 32.01779106096693, 114.70333471252054, 115.84999999999992, 148.44048987277094, 83.97353561107865, 134.63907480739596, 128.72000000000014, 119.09780061039609, 160.70214668989342, 142.71551176833984, 126.78427032239549, 124.47980658043764, 17.788498921754677, 18.136682210965006, 174.02554795027308, 97.72125653662619, 118.62857276359776, 135.64999999999995, 136.27711942821549, 119.00240150764498, 168.3200000000001, 109.56416453092976, 152.47999999999993, 144.0867084053965, -17.02440680971306, -54.27540546812312, 159.82394330491329, 132.38826521747907, 49.643687385208175, 142.8137517831667, 110.26079916914053, 94.9523650056113, 149.66380785948834, 134.66710475094519, 95.3862506883555, 125.56414038971788, 16.193177556592087, 91.91271829925802, -74.29415279272834, -9.727770240593369, 108.15635159008413, 101.53381134208541, -35.151690269833125, -41.934640240361645, 169.47195319325618, 163.81821703823047, 69.74662545791122, 118.30255381203055, 19.246652962073973, -18.145346794743457, 64.88843382027815, 113.0542306198458, 116.14957991704586, 73.66328277137706, 99.96043953563873, 139.7999041165609, 165.91504584885234, 147.52999999999997, 118.26308732772928, 106.96916800347063, 44.827693259016016, -20.461720136454403, 46.49905226054304, 69.74678649869634, 156.82207767823797, 143.59475784477775, 126.36204479474604, 74.83906049534123, 183.17, 155.03385037320365, -44.24702462684872, -44.567835303563754, 166.04879308399745, 160.20864452496818, 122.15165878837522, 141.43005167104164, 119.98359443450836, 141.68848115454085, 70.03772624220372, 71.41648554285278, 139.0600626085146, 136.11291882963388, 92.86967516218438, 105.69316128986515, 103.4366424747177, 116.1468903866986, -3.226948949867027, -38.6799423200722, 112.38763504437223, 148.53630757829097, -233.67754299085624, 149.78449659694826, -41.50179609434627, -47.07693862758551, 20.608180982886925, -11.771543818354361, -20.259094497679452, -28.58033630273884, 133.10693778291318, 125.30008826263476, 128.94699454788554, 136.06370653732336], "policy_predator_policy_reward": [25.88377261725575, 4.485368022754085, 34.6180111006484, 44.7904202145334, 42.25268694886434, 0.0, 9.860073503587392, 6.608849304161997, 0.9366702780821837, 3.1234968278272293, 0.24483759446564987, 0.0, 3.819816431846377, 10.939475202677494, 22.102301810595396, 0.7427754515008064, 0.44175528421944105, 1.1700164275653642, 6.037003542549434, 6.247042139102861, 60.08982235913179, 41.03688420350723, 20.266755615990416, 6.168370416572408, 12.693067633637854, 11.780941527194816, 14.03475281065775, 54.55393558785403, 16.38349028562144, 0.0, 8.67695767637223, 22.680400444954284, 8.514871458328638, 16.482971864711136, 48.54760544023722, 49.553238020500345, 38.66796597821204, 42.249079214769644, 7.0935484374905045, 34.33873337838443, 4.111428278503897, 26.315696420691133, 15.363479077621358, 3.5890663910574747, 7.277843134758709, 28.480297997280232, 6.4869882350133246, 72.11681287473655, 6.156731268442394, 5.464684551283613, 17.866507433532913, 6.953232903376099, 26.793893777795923, 23.601230952095584, 4.566095206022051, 0.9057495099519322, 26.930705512707675, 1.3318077905331092, 30.274124723082615, 2.1106432809106965, 30.26467479269609, 21.870010040884758, 10.997428987656958, 21.378622333672745, 2.223837677403698, 2.3412839972708164, 4.67125544479491, 7.244810892719262, 7.890693304671174, 1.153942326902743, 37.955789871691515, 37.34054382320381, 10.679879727012214, 7.230763832336095, 2.99226762217677, 15.176996438322192, 9.833917925691969, 5.1885497137750995, 20.958537604903764, 9.939588785994069, 13.514801406788488, 17.417911590734853, 3.5069318793583095, 33.472149946086596, 155.3124966133962, 133.72418433233142, 29.580496323592087, 3.5714051833429297, 1.1794287016724736, 0.8730136387932435, 6.11626938514647, 3.9092469049575733, 26.41236564839806, 4.746720359643444, 9.822312940345041, 9.925082075390195, 1.0895632340082757, 0.6186702800072249, 31.483544240462358, 55.89905745160721, 5.560538605325442, 8.079005954491876, 1.94273750390629, 11.806121391499442, 3.9262369168570443, 8.392092226567353, 4.124044472738966, 8.92829706902788, 19.69246437977677, 5.435699573645889, 11.84108884196067, 32.98107331121421, 22.644045585449636, 7.015600997500879, 0.0, 0.18142723640223368, 4.034686263045855, 7.075985260968909, 8.105835469070275, 0.9036425731223171, 9.213291594603522, 0.20580194156633402, 54.03791876145141, 13.012149173126625, 2.4460566950866065, 8.081734782520925, 25.48502803317322, 9.808567168262151, 21.265753605267015, 12.279479367230762, 6.614121642163505, 6.680396371511574, 10.15412581685759, 17.63756296864631, 35.379372375841996, 1.4048753038309134, 82.42364205653125, 13.988219088228439, 17.530434320117056, 18.50646151704027, 0.6405588515021102, 55.59294392075864, 1.299829768513297, 0.3370806434787227, 32.8365722555782, 22.929382880306335, 39.34223443768882, 14.1249554534427, 26.497125106523377, 26.2203997030079, 25.404521654622112, 0.8292170880090505, 13.603256756479373, 25.953430792975578, 4.248403530623419, 2.587133590402851, 8.585194169097697, 14.121651542852364, 0.40044076141151347, 82.63825588052046, 17.455005048905655, 28.599315250709516, 12.496225988459285, 6.405955129401968, 2.553362425206691, 17.122158791246314, 0.18736526092418737, 0.3961496267964298, 49.03896227884896, 40.015689769665, 1.1213554750318744, 5.161206916002671, 2.3678731450923856, 8.780416395490652, 4.62901853917431, 19.202695656182925, 2.6942711809375726, 41.0250742553953, 1.9413639741734956, 14.571266389650006, 24.469953209315893, 4.574551707220263, 22.195754610593887, 7.377057019083835, 44.82398479392849, 12.502652003635617, 9.832180715052436, 12.99826534521144, 1.635503403051782, 386.917542990856, 50.07519510547381, 49.59493926802357, 39.03785091318222, 7.681102364531818, 54.15453793514555, 50.19789468387174, 14.255551258532162, 14.749498734831832, 9.609767084981542, 9.707978401061347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7478337347700781, "mean_inference_ms": 2.2923354097707436, "mean_action_processing_ms": 0.3135801985137133, "mean_env_wait_ms": 0.27004476247392295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006511807441711426, "StateBufferConnector_ms": 0.01191103458404541, "ViewRequirementAgentConnector_ms": 0.14440679550170898}, "num_episodes": 18, "episode_return_max": 350.7208853448676, "episode_return_min": -20.852827737934067, "episode_return_mean": 227.78485623337582, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.19500406779105, "num_env_steps_trained_throughput_per_sec": 302.19500406779105, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 12893.239, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12893.19, "sample_time_ms": 1870.57, "learn_time_ms": 11004.105, "learn_throughput": 363.501, "synch_weights_time_ms": 16.275}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "ef79f_00000", "date": "2024-08-16_11-33-02", "timestamp": 1723788182, "time_this_iter_s": 13.286702871322632, "time_total_s": 957.0903854370117, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5380e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 957.0903854370117, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 65.26315789473684, "ram_util_percent": 81.98421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6138346936336903, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.1458635098089, "policy_loss": -0.0004744539847942414, "vf_loss": 8.144940111119912, "vf_explained_var": -0.015443527793127392, "kl": 0.006212601336765676, "entropy": 0.8887997099331447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.975245215842333, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9428215686606354, "policy_loss": -0.0038220865474570364, "vf_loss": 3.946643645675094, "vf_explained_var": 0.4779063994922335, "kl": 0.0027059382171752758, "entropy": 0.21148116507385142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 343.7280857485865, "episode_reward_min": -30.951738395489922, "episode_reward_mean": 220.72256296005176, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -233.67754299085624, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.17, "predator_policy": 386.917542990856}, "policy_reward_mean": {"prey_policy": 90.23482641632589, "predator_policy": 20.12645506370005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.284459299723, 274.6680788070221, 225.7205373643039, 227.7951838344178, 308.2523085774022, 216.82895565171577, 241.25901930000657, 158.13804152935234, 238.7552789697138, 315.6399999999999, 300.3650765589038, 232.71736501882242, 258.03395056087027, 282.393706152348, 288.818159920428, 285.7295600737641, 229.92586832644332, 264.4260646706216, 260.6099999999999, 187.50958616589338, 227.6421739699134, 300.5406702032283, 260.6737192286536, 226.53471308703695, 259.34238747786947, 330.6099999999999, 234.103727465557, 277.9300344325882, 232.36146931388032, 260.1361297538198, 316.4699999999998, 276.39224085625534, 80.7473432858945, 301.4064510698497, 254.45999999999998, 266.390192459875, 286.8936425731223, 305.9858019415665, -4.249744343258136, 302.73999999999995, 227.7510343698102, 238.75839714724944, 297.6254306241085, 248.74207986357732, 144.89014353552304, 12.389938111437976, 245.7270587693268, -20.852827737934067, 334.92708064347846, 243.81513440582563, 54.56849605846209, 230.66018924965516, 216.04660143105394, 279.31703120165463, 320.28058296987854, 247.93910104314995, 107.40466976449365, 162.30015905885452, 319.3190166408767, 220.87662650654005, 338.78736526092405, 0.23979211810157586, 332.53999999999974, 274.72999999999996, 285.5037897844064, 185.17355722138925, 291.6856118019716, 227.60734136858568, 249.15634449109413, 15.419745527624904, 283.7543886829265, 304.65999999999985, 11.09139965156571, 55.55559044224654, 55.513001818598994, 287.41207603891166, 284.32844657125185, 91.3412946953028, 289.1746198100154, 334.0483207101653, 227.1162591212417, 270.81307399302347, 343.7280857485865, 301.9986049507818, 321.3084551957706, 301.1090680323755, 225.56908827889413, 58.75749618300036, 163.4073370953946, -16.91225563291575, 216.41737636850897, 310.93991639884376, 164.9159817397491, -4.925401573660866, -30.951738395489922, 206.22500163916902, 1.6774524982463495, 279.3442243193393, 205.57072103385548, 232.95676580075587], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.703275387226805, 78.97738280274629, 145.10582542123558, 117.94083756606055, 59.06939794521847, 141.8313990821763, 57.04511509075499, 120.35494401377152, 150.16949992926635, 152.61096393216195, 61.092733164509845, 127.47370918396545, 95.95295999712414, 112.92129129888912, 59.306837097008156, 46.69651959876344, 79.90457968729028, 126.474647961094, 179.86616232259635, 131.20871600272918, 126.62509632345989, 161.82391389792997, 128.28438516492304, 95.38834422232554, 67.07031440245142, 115.66730246352341, 162.38, 102.10306259299972, 118.64375548426199, 152.0051403756671, 141.13799602477354, 129.56909640952358, 109.10044813095301, 89.92729380459299, 126.67011805236812, 106.82323362073029, 84.63785005391343, 138.99306812064174, -136.0099237465577, 34.48282896672313, 89.34838322600706, 105.14188923697138, 151.11199926111664, 147.37622860164583, 143.86329071861462, 106.78491221993505, 90.22208744305418, 105.15353963594134, 121.10909102001496, 118.48590144211917, 154.64176648598442, 174.26, 32.01779106096693, 114.70333471252054, 115.84999999999992, 148.44048987277094, 83.97353561107865, 134.63907480739596, 128.72000000000014, 119.09780061039609, 160.70214668989342, 142.71551176833984, 126.78427032239549, 124.47980658043764, 17.788498921754677, 18.136682210965006, 174.02554795027308, 97.72125653662619, 118.62857276359776, 135.64999999999995, 136.27711942821549, 119.00240150764498, 168.3200000000001, 109.56416453092976, 152.47999999999993, 144.0867084053965, -17.02440680971306, -54.27540546812312, 159.82394330491329, 132.38826521747907, 49.643687385208175, 142.8137517831667, 110.26079916914053, 94.9523650056113, 149.66380785948834, 134.66710475094519, 95.3862506883555, 125.56414038971788, 16.193177556592087, 91.91271829925802, -74.29415279272834, -9.727770240593369, 108.15635159008413, 101.53381134208541, -35.151690269833125, -41.934640240361645, 169.47195319325618, 163.81821703823047, 69.74662545791122, 118.30255381203055, 19.246652962073973, -18.145346794743457, 64.88843382027815, 113.0542306198458, 116.14957991704586, 73.66328277137706, 99.96043953563873, 139.7999041165609, 165.91504584885234, 147.52999999999997, 118.26308732772928, 106.96916800347063, 44.827693259016016, -20.461720136454403, 46.49905226054304, 69.74678649869634, 156.82207767823797, 143.59475784477775, 126.36204479474604, 74.83906049534123, 183.17, 155.03385037320365, -44.24702462684872, -44.567835303563754, 166.04879308399745, 160.20864452496818, 122.15165878837522, 141.43005167104164, 119.98359443450836, 141.68848115454085, 70.03772624220372, 71.41648554285278, 139.0600626085146, 136.11291882963388, 92.86967516218438, 105.69316128986515, 103.4366424747177, 116.1468903866986, -3.226948949867027, -38.6799423200722, 112.38763504437223, 148.53630757829097, -233.67754299085624, 149.78449659694826, -41.50179609434627, -47.07693862758551, 20.608180982886925, -11.771543818354361, -20.259094497679452, -28.58033630273884, 133.10693778291318, 125.30008826263476, 128.94699454788554, 136.06370653732336, 8.130021174056232, 23.94881495818464, 177.0314726878933, 103.55514864193412, 175.4604617426736, 153.01921877792046, 68.33371725250115, 98.67967982243911, 150.84587449208215, 89.11423792958269, 148.69053542360916, 179.99453508064622, 159.59826034114744, 126.65088802481054, 134.90855566996404, 163.5509869800465, 123.10057435402568, 171.28999999999985, 87.76706806606569, 104.68045782312272, -8.906940717981263, 12.645269736404154, 59.73683998683415, 64.959459493074, -42.49343008640399, -41.29348768690171, 97.01095095660465, 69.45388394369958, 147.53000000000003, 157.44675195066037, 48.44207082942215, 66.31139961753621, -62.11969187953273, -13.815096461754486, -49.643422136265166, -58.21671809100586, 95.02659749544928, 64.78669396257087, -58.984744202425915, -48.995768295690105, 128.76263956700575, 139.03234512587846, 137.35916666284527, 24.315183160862762, 87.29731036060268, 84.58391608438505], "policy_predator_policy_reward": [6.4869882350133246, 72.11681287473655, 6.156731268442394, 5.464684551283613, 17.866507433532913, 6.953232903376099, 26.793893777795923, 23.601230952095584, 4.566095206022051, 0.9057495099519322, 26.930705512707675, 1.3318077905331092, 30.274124723082615, 2.1106432809106965, 30.26467479269609, 21.870010040884758, 10.997428987656958, 21.378622333672745, 2.223837677403698, 2.3412839972708164, 4.67125544479491, 7.244810892719262, 7.890693304671174, 1.153942326902743, 37.955789871691515, 37.34054382320381, 10.679879727012214, 7.230763832336095, 2.99226762217677, 15.176996438322192, 9.833917925691969, 5.1885497137750995, 20.958537604903764, 9.939588785994069, 13.514801406788488, 17.417911590734853, 3.5069318793583095, 33.472149946086596, 155.3124966133962, 133.72418433233142, 29.580496323592087, 3.5714051833429297, 1.1794287016724736, 0.8730136387932435, 6.11626938514647, 3.9092469049575733, 26.41236564839806, 4.746720359643444, 9.822312940345041, 9.925082075390195, 1.0895632340082757, 0.6186702800072249, 31.483544240462358, 55.89905745160721, 5.560538605325442, 8.079005954491876, 1.94273750390629, 11.806121391499442, 3.9262369168570443, 8.392092226567353, 4.124044472738966, 8.92829706902788, 19.69246437977677, 5.435699573645889, 11.84108884196067, 32.98107331121421, 22.644045585449636, 7.015600997500879, 0.0, 0.18142723640223368, 4.034686263045855, 7.075985260968909, 8.105835469070275, 0.9036425731223171, 9.213291594603522, 0.20580194156633402, 54.03791876145141, 13.012149173126625, 2.4460566950866065, 8.081734782520925, 25.48502803317322, 9.808567168262151, 21.265753605267015, 12.279479367230762, 6.614121642163505, 6.680396371511574, 10.15412581685759, 17.63756296864631, 35.379372375841996, 1.4048753038309134, 82.42364205653125, 13.988219088228439, 17.530434320117056, 18.50646151704027, 0.6405588515021102, 55.59294392075864, 1.299829768513297, 0.3370806434787227, 32.8365722555782, 22.929382880306335, 39.34223443768882, 14.1249554534427, 26.497125106523377, 26.2203997030079, 25.404521654622112, 0.8292170880090505, 13.603256756479373, 25.953430792975578, 4.248403530623419, 2.587133590402851, 8.585194169097697, 14.121651542852364, 0.40044076141151347, 82.63825588052046, 17.455005048905655, 28.599315250709516, 12.496225988459285, 6.405955129401968, 2.553362425206691, 17.122158791246314, 0.18736526092418737, 0.3961496267964298, 49.03896227884896, 40.015689769665, 1.1213554750318744, 5.161206916002671, 2.3678731450923856, 8.780416395490652, 4.62901853917431, 19.202695656182925, 2.6942711809375726, 41.0250742553953, 1.9413639741734956, 14.571266389650006, 24.469953209315893, 4.574551707220263, 22.195754610593887, 7.377057019083835, 44.82398479392849, 12.502652003635617, 9.832180715052436, 12.99826534521144, 1.635503403051782, 386.917542990856, 50.07519510547381, 49.59493926802357, 39.03785091318222, 7.681102364531818, 54.15453793514555, 50.19789468387174, 14.255551258532162, 14.749498734831832, 9.609767084981542, 9.707978401061347, 44.48866911934413, 14.773789443717744, 2.423147122122365, 6.164851358065983, 2.0395619175800017, 3.529078271991172, 30.280782921310035, 29.822079124991554, 21.3550296060512, 9.497931965307517, 8.948651141568076, 6.094364102763078, 7.977352772257896, 7.772103812566, 12.945296061851101, 9.903616483909135, 4.4894256459744915, 2.2290680323760217, 0.0, 33.12156238970576, 46.43004382061178, 8.589123343965829, 16.621245880441844, 22.089791735044688, 54.65881596747918, 12.215846172910807, 17.453330999706935, 32.49921046849808, 4.705534085334832, 1.257630362848667, 31.72378262847629, 18.4387286643145, 1.6081838517132359, 69.40120291591303, 64.88930259973031, 12.019099232050802, 32.134888575581286, 14.276821605568038, 65.22708003602995, 44.43088496033242, 5.120976007219997, 6.428263619235547, 7.577050555272789, 36.31932065487484, 35.68525955411941, 25.39027980164896]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7570556478678162, "mean_inference_ms": 2.3160041584582123, "mean_action_processing_ms": 0.3172218520427499, "mean_env_wait_ms": 0.27294045103936426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02113330364227295, "StateBufferConnector_ms": 0.03280293941497803, "ViewRequirementAgentConnector_ms": 0.2809619903564453}, "num_episodes": 23, "episode_return_max": 343.7280857485865, "episode_return_min": -30.951738395489922, "episode_return_mean": 220.72256296005176, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 91.30201544549865, "num_env_steps_trained_throughput_per_sec": 91.30201544549865, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 15985.888, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15985.836, "sample_time_ms": 2426.05, "learn_time_ms": 13530.518, "learn_throughput": 295.628, "synch_weights_time_ms": 25.281}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "ef79f_00000", "date": "2024-08-16_11-33-46", "timestamp": 1723788226, "time_this_iter_s": 43.92360496520996, "time_total_s": 1001.0139904022217, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321793ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1001.0139904022217, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 61.099999999999994, "ram_util_percent": 82.05645161290323}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4294670612093, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.615911878353705, "policy_loss": -0.004014430183636409, "vf_loss": 8.618624355174877, "vf_explained_var": -0.09396553717593037, "kl": 0.0057864918218968235, "entropy": 0.8746495311222379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.221157114530998, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.715290102126106, "policy_loss": -0.004358318757398852, "vf_loss": 4.719648419990741, "vf_explained_var": 0.5524037676828879, "kl": 0.0030796211918406157, "entropy": 0.2309050400263418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 343.7280857485865, "episode_reward_min": -30.951738395489922, "episode_reward_mean": 206.36755115952917, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -233.67754299085624, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.17, "predator_policy": 386.917542990856}, "policy_reward_mean": {"prey_policy": 79.7951874505345, "predator_policy": 23.388588129230147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [260.6099999999999, 187.50958616589338, 227.6421739699134, 300.5406702032283, 260.6737192286536, 226.53471308703695, 259.34238747786947, 330.6099999999999, 234.103727465557, 277.9300344325882, 232.36146931388032, 260.1361297538198, 316.4699999999998, 276.39224085625534, 80.7473432858945, 301.4064510698497, 254.45999999999998, 266.390192459875, 286.8936425731223, 305.9858019415665, -4.249744343258136, 302.73999999999995, 227.7510343698102, 238.75839714724944, 297.6254306241085, 248.74207986357732, 144.89014353552304, 12.389938111437976, 245.7270587693268, -20.852827737934067, 334.92708064347846, 243.81513440582563, 54.56849605846209, 230.66018924965516, 216.04660143105394, 279.31703120165463, 320.28058296987854, 247.93910104314995, 107.40466976449365, 162.30015905885452, 319.3190166408767, 220.87662650654005, 338.78736526092405, 0.23979211810157586, 332.53999999999974, 274.72999999999996, 285.5037897844064, 185.17355722138925, 291.6856118019716, 227.60734136858568, 249.15634449109413, 15.419745527624904, 283.7543886829265, 304.65999999999985, 11.09139965156571, 55.55559044224654, 55.513001818598994, 287.41207603891166, 284.32844657125185, 91.3412946953028, 289.1746198100154, 334.0483207101653, 227.1162591212417, 270.81307399302347, 343.7280857485865, 301.9986049507818, 321.3084551957706, 301.1090680323755, 225.56908827889413, 58.75749618300036, 163.4073370953946, -16.91225563291575, 216.41737636850897, 310.93991639884376, 164.9159817397491, -4.925401573660866, -30.951738395489922, 206.22500163916902, 1.6774524982463495, 279.3442243193393, 205.57072103385548, 232.95676580075587, 198.7227585622016, 124.84405394968333, 53.428072305377995, 318.0768167302074, 224.75219355776454, 188.99338364061646, 271.4299999999999, 248.94890030172039, -3.8639218278619674, 149.57393862499416, 105.64218585251047, -17.735192890505978, 58.11654116576959, 337.8701702735354, 280.84674018417064, 184.36648586829077, 167.74828515907967, 190.4890231060454], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [84.63785005391343, 138.99306812064174, -136.0099237465577, 34.48282896672313, 89.34838322600706, 105.14188923697138, 151.11199926111664, 147.37622860164583, 143.86329071861462, 106.78491221993505, 90.22208744305418, 105.15353963594134, 121.10909102001496, 118.48590144211917, 154.64176648598442, 174.26, 32.01779106096693, 114.70333471252054, 115.84999999999992, 148.44048987277094, 83.97353561107865, 134.63907480739596, 128.72000000000014, 119.09780061039609, 160.70214668989342, 142.71551176833984, 126.78427032239549, 124.47980658043764, 17.788498921754677, 18.136682210965006, 174.02554795027308, 97.72125653662619, 118.62857276359776, 135.64999999999995, 136.27711942821549, 119.00240150764498, 168.3200000000001, 109.56416453092976, 152.47999999999993, 144.0867084053965, -17.02440680971306, -54.27540546812312, 159.82394330491329, 132.38826521747907, 49.643687385208175, 142.8137517831667, 110.26079916914053, 94.9523650056113, 149.66380785948834, 134.66710475094519, 95.3862506883555, 125.56414038971788, 16.193177556592087, 91.91271829925802, -74.29415279272834, -9.727770240593369, 108.15635159008413, 101.53381134208541, -35.151690269833125, -41.934640240361645, 169.47195319325618, 163.81821703823047, 69.74662545791122, 118.30255381203055, 19.246652962073973, -18.145346794743457, 64.88843382027815, 113.0542306198458, 116.14957991704586, 73.66328277137706, 99.96043953563873, 139.7999041165609, 165.91504584885234, 147.52999999999997, 118.26308732772928, 106.96916800347063, 44.827693259016016, -20.461720136454403, 46.49905226054304, 69.74678649869634, 156.82207767823797, 143.59475784477775, 126.36204479474604, 74.83906049534123, 183.17, 155.03385037320365, -44.24702462684872, -44.567835303563754, 166.04879308399745, 160.20864452496818, 122.15165878837522, 141.43005167104164, 119.98359443450836, 141.68848115454085, 70.03772624220372, 71.41648554285278, 139.0600626085146, 136.11291882963388, 92.86967516218438, 105.69316128986515, 103.4366424747177, 116.1468903866986, -3.226948949867027, -38.6799423200722, 112.38763504437223, 148.53630757829097, -233.67754299085624, 149.78449659694826, -41.50179609434627, -47.07693862758551, 20.608180982886925, -11.771543818354361, -20.259094497679452, -28.58033630273884, 133.10693778291318, 125.30008826263476, 128.94699454788554, 136.06370653732336, 8.130021174056232, 23.94881495818464, 177.0314726878933, 103.55514864193412, 175.4604617426736, 153.01921877792046, 68.33371725250115, 98.67967982243911, 150.84587449208215, 89.11423792958269, 148.69053542360916, 179.99453508064622, 159.59826034114744, 126.65088802481054, 134.90855566996404, 163.5509869800465, 123.10057435402568, 171.28999999999985, 87.76706806606569, 104.68045782312272, -8.906940717981263, 12.645269736404154, 59.73683998683415, 64.959459493074, -42.49343008640399, -41.29348768690171, 97.01095095660465, 69.45388394369958, 147.53000000000003, 157.44675195066037, 48.44207082942215, 66.31139961753621, -62.11969187953273, -13.815096461754486, -49.643422136265166, -58.21671809100586, 95.02659749544928, 64.78669396257087, -58.984744202425915, -48.995768295690105, 128.76263956700575, 139.03234512587846, 137.35916666284527, 24.315183160862762, 87.29731036060268, 84.58391608438505, 32.09714320513748, 107.16898931517339, 53.43974380427767, 8.762745879923356, -70.898355260033, -23.571947070548834, 134.4938919852143, 162.37999999999988, 84.18850357975609, 79.28904526446016, 70.64956528737468, 71.09044582757812, 123.20319559360927, 123.3802640296198, 127.74150553194227, 65.42661530261164, -44.85246565110484, -105.60724136060215, 19.677514668182905, 37.879621283366994, 21.911126995890967, 7.851329973672034, -42.35079180202185, -48.28168034583782, -4.290132198518797, 0.7175517843614663, 176.24, 143.08521807384022, 140.2535939324759, 112.33433530037112, 71.05719261844182, 53.9837789407539, 38.74178597848956, 68.56247449821348, 75.14901540103477, 29.094924929686105], "policy_predator_policy_reward": [3.5069318793583095, 33.472149946086596, 155.3124966133962, 133.72418433233142, 29.580496323592087, 3.5714051833429297, 1.1794287016724736, 0.8730136387932435, 6.11626938514647, 3.9092469049575733, 26.41236564839806, 4.746720359643444, 9.822312940345041, 9.925082075390195, 1.0895632340082757, 0.6186702800072249, 31.483544240462358, 55.89905745160721, 5.560538605325442, 8.079005954491876, 1.94273750390629, 11.806121391499442, 3.9262369168570443, 8.392092226567353, 4.124044472738966, 8.92829706902788, 19.69246437977677, 5.435699573645889, 11.84108884196067, 32.98107331121421, 22.644045585449636, 7.015600997500879, 0.0, 0.18142723640223368, 4.034686263045855, 7.075985260968909, 8.105835469070275, 0.9036425731223171, 9.213291594603522, 0.20580194156633402, 54.03791876145141, 13.012149173126625, 2.4460566950866065, 8.081734782520925, 25.48502803317322, 9.808567168262151, 21.265753605267015, 12.279479367230762, 6.614121642163505, 6.680396371511574, 10.15412581685759, 17.63756296864631, 35.379372375841996, 1.4048753038309134, 82.42364205653125, 13.988219088228439, 17.530434320117056, 18.50646151704027, 0.6405588515021102, 55.59294392075864, 1.299829768513297, 0.3370806434787227, 32.8365722555782, 22.929382880306335, 39.34223443768882, 14.1249554534427, 26.497125106523377, 26.2203997030079, 25.404521654622112, 0.8292170880090505, 13.603256756479373, 25.953430792975578, 4.248403530623419, 2.587133590402851, 8.585194169097697, 14.121651542852364, 0.40044076141151347, 82.63825588052046, 17.455005048905655, 28.599315250709516, 12.496225988459285, 6.405955129401968, 2.553362425206691, 17.122158791246314, 0.18736526092418737, 0.3961496267964298, 49.03896227884896, 40.015689769665, 1.1213554750318744, 5.161206916002671, 2.3678731450923856, 8.780416395490652, 4.62901853917431, 19.202695656182925, 2.6942711809375726, 41.0250742553953, 1.9413639741734956, 14.571266389650006, 24.469953209315893, 4.574551707220263, 22.195754610593887, 7.377057019083835, 44.82398479392849, 12.502652003635617, 9.832180715052436, 12.99826534521144, 1.635503403051782, 386.917542990856, 50.07519510547381, 49.59493926802357, 39.03785091318222, 7.681102364531818, 54.15453793514555, 50.19789468387174, 14.255551258532162, 14.749498734831832, 9.609767084981542, 9.707978401061347, 44.48866911934413, 14.773789443717744, 2.423147122122365, 6.164851358065983, 2.0395619175800017, 3.529078271991172, 30.280782921310035, 29.822079124991554, 21.3550296060512, 9.497931965307517, 8.948651141568076, 6.094364102763078, 7.977352772257896, 7.772103812566, 12.945296061851101, 9.903616483909135, 4.4894256459744915, 2.2290680323760217, 0.0, 33.12156238970576, 46.43004382061178, 8.589123343965829, 16.621245880441844, 22.089791735044688, 54.65881596747918, 12.215846172910807, 17.453330999706935, 32.49921046849808, 4.705534085334832, 1.257630362848667, 31.72378262847629, 18.4387286643145, 1.6081838517132359, 69.40120291591303, 64.88930259973031, 12.019099232050802, 32.134888575581286, 14.276821605568038, 65.22708003602995, 44.43088496033242, 5.120976007219997, 6.428263619235547, 7.577050555272789, 36.31932065487484, 35.68525955411941, 25.39027980164896, 42.976017148655245, 16.480608893235495, 45.743513828192796, 16.898050437289267, 77.77170033598789, 70.12667429997195, 14.518010134064253, 6.684914610929078, 44.54463347445297, 16.730011239095408, 32.68158825937062, 14.571784266293129, 0.16233588153080317, 24.684204495240255, 26.677009706079986, 29.10376976108675, 40.120568246284314, 106.4752169375608, 46.73213831712937, 45.28466435631476, 28.55918434806552, 47.320544534881726, 11.066863452681499, 61.83041580467224, 45.89878400896891, 15.79033757095796, 11.604921846012669, 6.940030353682564, 16.448554033461193, 11.810256917862539, 27.627336246432662, 31.698178062662443, 12.147183852172555, 48.29684083020441, 42.529134126801644, 43.71594864852292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7706742343286405, "mean_inference_ms": 2.354301590124004, "mean_action_processing_ms": 0.3231871711290612, "mean_env_wait_ms": 0.277669745846168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02227461338043213, "StateBufferConnector_ms": 0.03357040882110596, "ViewRequirementAgentConnector_ms": 0.3849468231201172}, "num_episodes": 18, "episode_return_max": 343.7280857485865, "episode_return_min": -30.951738395489922, "episode_return_mean": 206.36755115952917, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 100.82318786399875, "num_env_steps_trained_throughput_per_sec": 100.82318786399875, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 18666.454, "restore_workers_time_ms": 0.017, "training_step_time_ms": 18666.396, "sample_time_ms": 3123.814, "learn_time_ms": 15505.186, "learn_throughput": 257.978, "synch_weights_time_ms": 33.442}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "ef79f_00000", "date": "2024-08-16_11-34-25", "timestamp": 1723788265, "time_this_iter_s": 39.75286912918091, "time_total_s": 1040.7668595314026, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214af040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1040.7668595314026, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 55.214035087719296, "ram_util_percent": 81.57368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.647275249983268, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.142548137745528, "policy_loss": -0.003958420410860705, "vf_loss": 9.14509655886857, "vf_explained_var": -0.0022557789686495663, "kl": 0.0062665614066244905, "entropy": 0.8530247074586373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.53698393711968, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.83755549387957, "policy_loss": -0.00630126794696682, "vf_loss": 4.843856774814546, "vf_explained_var": 0.5056860074479744, "kl": 0.0075282150577941215, "entropy": 0.2481899071622778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 360.38999999999993, "episode_reward_min": -30.951738395489922, "episode_reward_mean": 177.54048142890574, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -233.67754299085624, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.1, "predator_policy": 386.917542990856}, "policy_reward_mean": {"prey_policy": 60.9592628860928, "predator_policy": 27.810977828360095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.7510343698102, 238.75839714724944, 297.6254306241085, 248.74207986357732, 144.89014353552304, 12.389938111437976, 245.7270587693268, -20.852827737934067, 334.92708064347846, 243.81513440582563, 54.56849605846209, 230.66018924965516, 216.04660143105394, 279.31703120165463, 320.28058296987854, 247.93910104314995, 107.40466976449365, 162.30015905885452, 319.3190166408767, 220.87662650654005, 338.78736526092405, 0.23979211810157586, 332.53999999999974, 274.72999999999996, 285.5037897844064, 185.17355722138925, 291.6856118019716, 227.60734136858568, 249.15634449109413, 15.419745527624904, 283.7543886829265, 304.65999999999985, 11.09139965156571, 55.55559044224654, 55.513001818598994, 287.41207603891166, 284.32844657125185, 91.3412946953028, 289.1746198100154, 334.0483207101653, 227.1162591212417, 270.81307399302347, 343.7280857485865, 301.9986049507818, 321.3084551957706, 301.1090680323755, 225.56908827889413, 58.75749618300036, 163.4073370953946, -16.91225563291575, 216.41737636850897, 310.93991639884376, 164.9159817397491, -4.925401573660866, -30.951738395489922, 206.22500163916902, 1.6774524982463495, 279.3442243193393, 205.57072103385548, 232.95676580075587, 198.7227585622016, 124.84405394968333, 53.428072305377995, 318.0768167302074, 224.75219355776454, 188.99338364061646, 271.4299999999999, 248.94890030172039, -3.8639218278619674, 149.57393862499416, 105.64218585251047, -17.735192890505978, 58.11654116576959, 337.8701702735354, 280.84674018417064, 184.36648586829077, 167.74828515907967, 190.4890231060454, 295.89707493994814, -2.3633952674988024, 18.69705902114253, 170.7061934496119, 68.83022200227225, 141.12153926197342, -8.325336640771086, 302.8447265830365, 49.11314261510542, 360.38999999999993, 34.878468848098684, 156.8915460349336, -27.21565675486734, 306.22358862762627, 154.06013060124377, 12.731086787653975, 8.232105608532331, 1.815622426699791, 306.6599999999999, 65.4335283836547, 121.20522364036026, 24.69669571064075], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [49.643687385208175, 142.8137517831667, 110.26079916914053, 94.9523650056113, 149.66380785948834, 134.66710475094519, 95.3862506883555, 125.56414038971788, 16.193177556592087, 91.91271829925802, -74.29415279272834, -9.727770240593369, 108.15635159008413, 101.53381134208541, -35.151690269833125, -41.934640240361645, 169.47195319325618, 163.81821703823047, 69.74662545791122, 118.30255381203055, 19.246652962073973, -18.145346794743457, 64.88843382027815, 113.0542306198458, 116.14957991704586, 73.66328277137706, 99.96043953563873, 139.7999041165609, 165.91504584885234, 147.52999999999997, 118.26308732772928, 106.96916800347063, 44.827693259016016, -20.461720136454403, 46.49905226054304, 69.74678649869634, 156.82207767823797, 143.59475784477775, 126.36204479474604, 74.83906049534123, 183.17, 155.03385037320365, -44.24702462684872, -44.567835303563754, 166.04879308399745, 160.20864452496818, 122.15165878837522, 141.43005167104164, 119.98359443450836, 141.68848115454085, 70.03772624220372, 71.41648554285278, 139.0600626085146, 136.11291882963388, 92.86967516218438, 105.69316128986515, 103.4366424747177, 116.1468903866986, -3.226948949867027, -38.6799423200722, 112.38763504437223, 148.53630757829097, -233.67754299085624, 149.78449659694826, -41.50179609434627, -47.07693862758551, 20.608180982886925, -11.771543818354361, -20.259094497679452, -28.58033630273884, 133.10693778291318, 125.30008826263476, 128.94699454788554, 136.06370653732336, 8.130021174056232, 23.94881495818464, 177.0314726878933, 103.55514864193412, 175.4604617426736, 153.01921877792046, 68.33371725250115, 98.67967982243911, 150.84587449208215, 89.11423792958269, 148.69053542360916, 179.99453508064622, 159.59826034114744, 126.65088802481054, 134.90855566996404, 163.5509869800465, 123.10057435402568, 171.28999999999985, 87.76706806606569, 104.68045782312272, -8.906940717981263, 12.645269736404154, 59.73683998683415, 64.959459493074, -42.49343008640399, -41.29348768690171, 97.01095095660465, 69.45388394369958, 147.53000000000003, 157.44675195066037, 48.44207082942215, 66.31139961753621, -62.11969187953273, -13.815096461754486, -49.643422136265166, -58.21671809100586, 95.02659749544928, 64.78669396257087, -58.984744202425915, -48.995768295690105, 128.76263956700575, 139.03234512587846, 137.35916666284527, 24.315183160862762, 87.29731036060268, 84.58391608438505, 32.09714320513748, 107.16898931517339, 53.43974380427767, 8.762745879923356, -70.898355260033, -23.571947070548834, 134.4938919852143, 162.37999999999988, 84.18850357975609, 79.28904526446016, 70.64956528737468, 71.09044582757812, 123.20319559360927, 123.3802640296198, 127.74150553194227, 65.42661530261164, -44.85246565110484, -105.60724136060215, 19.677514668182905, 37.879621283366994, 21.911126995890967, 7.851329973672034, -42.35079180202185, -48.28168034583782, -4.290132198518797, 0.7175517843614663, 176.24, 143.08521807384022, 140.2535939324759, 112.33433530037112, 71.05719261844182, 53.9837789407539, 38.74178597848956, 68.56247449821348, 75.14901540103477, 29.094924929686105, 164.3600000000001, 121.78591902690664, -85.57313930237895, -58.506239458869395, -51.893334530598054, -74.71966675423214, 62.83460598610091, 63.15024259204062, -5.741522738574455, -47.611646059206684, 13.530803454905582, 72.25940563489041, -34.46160256416612, -61.27615818771818, 155.89471816072808, 135.11568940463775, -18.717102265114114, -196.13980735200477, 170.12655374496345, 190.1, -23.244878713658395, -34.679442252985275, 32.5256659134147, 51.38258439785909, -60.82556331514296, -34.26869589912533, 137.000065295255, 145.44310836119098, 41.892161923543824, 65.52306163038723, -40.344621185280005, -18.214695825603325, -28.69933613923589, -21.64053446207151, -38.03461590868076, -52.43370369937913, 120.73762559930842, 168.35866136166203, -29.4075061592555, 16.894966710751707, 24.171867856021674, 49.505723724936374, -29.739394490916467, -49.28511318136422], "policy_predator_policy_reward": [25.48502803317322, 9.808567168262151, 21.265753605267015, 12.279479367230762, 6.614121642163505, 6.680396371511574, 10.15412581685759, 17.63756296864631, 35.379372375841996, 1.4048753038309134, 82.42364205653125, 13.988219088228439, 17.530434320117056, 18.50646151704027, 0.6405588515021102, 55.59294392075864, 1.299829768513297, 0.3370806434787227, 32.8365722555782, 22.929382880306335, 39.34223443768882, 14.1249554534427, 26.497125106523377, 26.2203997030079, 25.404521654622112, 0.8292170880090505, 13.603256756479373, 25.953430792975578, 4.248403530623419, 2.587133590402851, 8.585194169097697, 14.121651542852364, 0.40044076141151347, 82.63825588052046, 17.455005048905655, 28.599315250709516, 12.496225988459285, 6.405955129401968, 2.553362425206691, 17.122158791246314, 0.18736526092418737, 0.3961496267964298, 49.03896227884896, 40.015689769665, 1.1213554750318744, 5.161206916002671, 2.3678731450923856, 8.780416395490652, 4.62901853917431, 19.202695656182925, 2.6942711809375726, 41.0250742553953, 1.9413639741734956, 14.571266389650006, 24.469953209315893, 4.574551707220263, 22.195754610593887, 7.377057019083835, 44.82398479392849, 12.502652003635617, 9.832180715052436, 12.99826534521144, 1.635503403051782, 386.917542990856, 50.07519510547381, 49.59493926802357, 39.03785091318222, 7.681102364531818, 54.15453793514555, 50.19789468387174, 14.255551258532162, 14.749498734831832, 9.609767084981542, 9.707978401061347, 44.48866911934413, 14.773789443717744, 2.423147122122365, 6.164851358065983, 2.0395619175800017, 3.529078271991172, 30.280782921310035, 29.822079124991554, 21.3550296060512, 9.497931965307517, 8.948651141568076, 6.094364102763078, 7.977352772257896, 7.772103812566, 12.945296061851101, 9.903616483909135, 4.4894256459744915, 2.2290680323760217, 0.0, 33.12156238970576, 46.43004382061178, 8.589123343965829, 16.621245880441844, 22.089791735044688, 54.65881596747918, 12.215846172910807, 17.453330999706935, 32.49921046849808, 4.705534085334832, 1.257630362848667, 31.72378262847629, 18.4387286643145, 1.6081838517132359, 69.40120291591303, 64.88930259973031, 12.019099232050802, 32.134888575581286, 14.276821605568038, 65.22708003602995, 44.43088496033242, 5.120976007219997, 6.428263619235547, 7.577050555272789, 36.31932065487484, 35.68525955411941, 25.39027980164896, 42.976017148655245, 16.480608893235495, 45.743513828192796, 16.898050437289267, 77.77170033598789, 70.12667429997195, 14.518010134064253, 6.684914610929078, 44.54463347445297, 16.730011239095408, 32.68158825937062, 14.571784266293129, 0.16233588153080317, 24.684204495240255, 26.677009706079986, 29.10376976108675, 40.120568246284314, 106.4752169375608, 46.73213831712937, 45.28466435631476, 28.55918434806552, 47.320544534881726, 11.066863452681499, 61.83041580467224, 45.89878400896891, 15.79033757095796, 11.604921846012669, 6.940030353682564, 16.448554033461193, 11.810256917862539, 27.627336246432662, 31.698178062662443, 12.147183852172555, 48.29684083020441, 42.529134126801644, 43.71594864852292, 3.9104986513783815, 5.840657261663531, 82.23811104883944, 59.477872444910055, 69.92711031082192, 75.38294999515085, 18.855738913263377, 25.865605958207194, 73.18307850010362, 49.00031229994972, 38.65809192375231, 16.67323824842521, 73.24341569343623, 14.16900841767711, 1.424726583036536, 10.409592434634224, 141.6126918020618, 122.35736043016291, 0.16344625503655272, 0.0, 67.48812442527884, 25.314665389463574, 23.452615051218785, 49.53068067244116, 67.66749504511013, 0.2111074142907483, 17.948702742401316, 5.831712228779252, 44.98451793520077, 1.6603891121120429, 65.98138620117953, 5.309017597357909, 54.09057168368012, 4.48140452615963, 63.370324865799745, 28.91361716896001, 6.761338638337963, 10.80237440069168, 68.09229889384503, 9.853768938313488, 6.507732910495948, 41.01989914890634, 70.86042331970759, 32.860780063213795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.799381347630575, "mean_inference_ms": 2.4396591082588825, "mean_action_processing_ms": 0.3355968171165613, "mean_env_wait_ms": 0.2876490646052396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024330973625183105, "StateBufferConnector_ms": 0.055394768714904785, "ViewRequirementAgentConnector_ms": 0.5809444189071655}, "num_episodes": 22, "episode_return_max": 360.38999999999993, "episode_return_min": -30.951738395489922, "episode_return_mean": 177.54048142890574, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 98.18153540952801, "num_env_steps_trained_throughput_per_sec": 98.18153540952801, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 21497.352, "restore_workers_time_ms": 0.018, "training_step_time_ms": 21497.296, "sample_time_ms": 4111.398, "learn_time_ms": 17342.827, "learn_throughput": 230.643, "synch_weights_time_ms": 39.048}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "ef79f_00000", "date": "2024-08-16_11-35-07", "timestamp": 1723788307, "time_this_iter_s": 40.87339496612549, "time_total_s": 1081.640254497528, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321429af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1081.640254497528, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 53.593103448275855, "ram_util_percent": 81.1241379310345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.452223409578283, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.150995394287916, "policy_loss": -0.004759062291738927, "vf_loss": 9.15424382396476, "vf_explained_var": -0.13246201790829815, "kl": 0.006713893587185882, "entropy": 0.859242434981008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.271053226158102, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.58608737975832, "policy_loss": -0.003595463947082559, "vf_loss": 5.589682847986777, "vf_explained_var": 0.664701839225002, "kl": 0.0083702056911764, "entropy": 0.2987077431230949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 360.38999999999993, "episode_reward_min": -32.89474778222723, "episode_reward_mean": 162.74551980680025, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -233.67754299085624, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.1, "predator_policy": 386.917542990856}, "policy_reward_mean": {"prey_policy": 51.15835492325433, "predator_policy": 30.214404980145865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.3190166408767, 220.87662650654005, 338.78736526092405, 0.23979211810157586, 332.53999999999974, 274.72999999999996, 285.5037897844064, 185.17355722138925, 291.6856118019716, 227.60734136858568, 249.15634449109413, 15.419745527624904, 283.7543886829265, 304.65999999999985, 11.09139965156571, 55.55559044224654, 55.513001818598994, 287.41207603891166, 284.32844657125185, 91.3412946953028, 289.1746198100154, 334.0483207101653, 227.1162591212417, 270.81307399302347, 343.7280857485865, 301.9986049507818, 321.3084551957706, 301.1090680323755, 225.56908827889413, 58.75749618300036, 163.4073370953946, -16.91225563291575, 216.41737636850897, 310.93991639884376, 164.9159817397491, -4.925401573660866, -30.951738395489922, 206.22500163916902, 1.6774524982463495, 279.3442243193393, 205.57072103385548, 232.95676580075587, 198.7227585622016, 124.84405394968333, 53.428072305377995, 318.0768167302074, 224.75219355776454, 188.99338364061646, 271.4299999999999, 248.94890030172039, -3.8639218278619674, 149.57393862499416, 105.64218585251047, -17.735192890505978, 58.11654116576959, 337.8701702735354, 280.84674018417064, 184.36648586829077, 167.74828515907967, 190.4890231060454, 295.89707493994814, -2.3633952674988024, 18.69705902114253, 170.7061934496119, 68.83022200227225, 141.12153926197342, -8.325336640771086, 302.8447265830365, 49.11314261510542, 360.38999999999993, 34.878468848098684, 156.8915460349336, -27.21565675486734, 306.22358862762627, 154.06013060124377, 12.731086787653975, 8.232105608532331, 1.815622426699791, 306.6599999999999, 65.4335283836547, 121.20522364036026, 24.69669571064075, 9.820583001833876, 207.3329614940347, 201.46390511535012, 45.60915871207364, -30.11949319859384, 319.6751585627296, 42.77555269169175, 124.02160800185457, 357.24000000000007, 14.005728138424113, 126.141257167371, -18.981043802403935, 326.073487930457, 28.147537066749877, 89.36995412492286, 314.44482605428936, -32.89474778222723, -11.332294979494167], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.82207767823797, 143.59475784477775, 126.36204479474604, 74.83906049534123, 183.17, 155.03385037320365, -44.24702462684872, -44.567835303563754, 166.04879308399745, 160.20864452496818, 122.15165878837522, 141.43005167104164, 119.98359443450836, 141.68848115454085, 70.03772624220372, 71.41648554285278, 139.0600626085146, 136.11291882963388, 92.86967516218438, 105.69316128986515, 103.4366424747177, 116.1468903866986, -3.226948949867027, -38.6799423200722, 112.38763504437223, 148.53630757829097, -233.67754299085624, 149.78449659694826, -41.50179609434627, -47.07693862758551, 20.608180982886925, -11.771543818354361, -20.259094497679452, -28.58033630273884, 133.10693778291318, 125.30008826263476, 128.94699454788554, 136.06370653732336, 8.130021174056232, 23.94881495818464, 177.0314726878933, 103.55514864193412, 175.4604617426736, 153.01921877792046, 68.33371725250115, 98.67967982243911, 150.84587449208215, 89.11423792958269, 148.69053542360916, 179.99453508064622, 159.59826034114744, 126.65088802481054, 134.90855566996404, 163.5509869800465, 123.10057435402568, 171.28999999999985, 87.76706806606569, 104.68045782312272, -8.906940717981263, 12.645269736404154, 59.73683998683415, 64.959459493074, -42.49343008640399, -41.29348768690171, 97.01095095660465, 69.45388394369958, 147.53000000000003, 157.44675195066037, 48.44207082942215, 66.31139961753621, -62.11969187953273, -13.815096461754486, -49.643422136265166, -58.21671809100586, 95.02659749544928, 64.78669396257087, -58.984744202425915, -48.995768295690105, 128.76263956700575, 139.03234512587846, 137.35916666284527, 24.315183160862762, 87.29731036060268, 84.58391608438505, 32.09714320513748, 107.16898931517339, 53.43974380427767, 8.762745879923356, -70.898355260033, -23.571947070548834, 134.4938919852143, 162.37999999999988, 84.18850357975609, 79.28904526446016, 70.64956528737468, 71.09044582757812, 123.20319559360927, 123.3802640296198, 127.74150553194227, 65.42661530261164, -44.85246565110484, -105.60724136060215, 19.677514668182905, 37.879621283366994, 21.911126995890967, 7.851329973672034, -42.35079180202185, -48.28168034583782, -4.290132198518797, 0.7175517843614663, 176.24, 143.08521807384022, 140.2535939324759, 112.33433530037112, 71.05719261844182, 53.9837789407539, 38.74178597848956, 68.56247449821348, 75.14901540103477, 29.094924929686105, 164.3600000000001, 121.78591902690664, -85.57313930237895, -58.506239458869395, -51.893334530598054, -74.71966675423214, 62.83460598610091, 63.15024259204062, -5.741522738574455, -47.611646059206684, 13.530803454905582, 72.25940563489041, -34.46160256416612, -61.27615818771818, 155.89471816072808, 135.11568940463775, -18.717102265114114, -196.13980735200477, 170.12655374496345, 190.1, -23.244878713658395, -34.679442252985275, 32.5256659134147, 51.38258439785909, -60.82556331514296, -34.26869589912533, 137.000065295255, 145.44310836119098, 41.892161923543824, 65.52306163038723, -40.344621185280005, -18.214695825603325, -28.69933613923589, -21.64053446207151, -38.03461590868076, -52.43370369937913, 120.73762559930842, 168.35866136166203, -29.4075061592555, 16.894966710751707, 24.171867856021674, 49.505723724936374, -29.739394490916467, -49.28511318136422, -4.551754613215822, -49.13975490485433, 60.778395977189604, 102.73894182953113, 84.41510904663188, 91.47677758315554, -25.364676024797088, -23.68782295690734, -44.026349332181546, -42.84766067162879, 150.27393885391632, 137.11840367016066, -29.0251369430765, -67.49876574992923, 74.32929067612012, 2.8907032987227144, 168.83660181329032, 183.90418542369375, -82.93780221717518, -54.065250793347666, 27.04863626946827, 38.37836449819244, -48.01791253032425, -58.88555978850573, 148.52, 153.4627642328983, -16.839872423676148, -23.93916190765455, 8.125016501994907, 30.633061939009053, 149.27857806926815, 133.93140152881466, -60.27186829410973, -55.368344860365944, -70.39123747164041, -80.5774805088688], "policy_predator_policy_reward": [12.496225988459285, 6.405955129401968, 2.553362425206691, 17.122158791246314, 0.18736526092418737, 0.3961496267964298, 49.03896227884896, 40.015689769665, 1.1213554750318744, 5.161206916002671, 2.3678731450923856, 8.780416395490652, 4.62901853917431, 19.202695656182925, 2.6942711809375726, 41.0250742553953, 1.9413639741734956, 14.571266389650006, 24.469953209315893, 4.574551707220263, 22.195754610593887, 7.377057019083835, 44.82398479392849, 12.502652003635617, 9.832180715052436, 12.99826534521144, 1.635503403051782, 386.917542990856, 50.07519510547381, 49.59493926802357, 39.03785091318222, 7.681102364531818, 54.15453793514555, 50.19789468387174, 14.255551258532162, 14.749498734831832, 9.609767084981542, 9.707978401061347, 44.48866911934413, 14.773789443717744, 2.423147122122365, 6.164851358065983, 2.0395619175800017, 3.529078271991172, 30.280782921310035, 29.822079124991554, 21.3550296060512, 9.497931965307517, 8.948651141568076, 6.094364102763078, 7.977352772257896, 7.772103812566, 12.945296061851101, 9.903616483909135, 4.4894256459744915, 2.2290680323760217, 0.0, 33.12156238970576, 46.43004382061178, 8.589123343965829, 16.621245880441844, 22.089791735044688, 54.65881596747918, 12.215846172910807, 17.453330999706935, 32.49921046849808, 4.705534085334832, 1.257630362848667, 31.72378262847629, 18.4387286643145, 1.6081838517132359, 69.40120291591303, 64.88930259973031, 12.019099232050802, 32.134888575581286, 14.276821605568038, 65.22708003602995, 44.43088496033242, 5.120976007219997, 6.428263619235547, 7.577050555272789, 36.31932065487484, 35.68525955411941, 25.39027980164896, 42.976017148655245, 16.480608893235495, 45.743513828192796, 16.898050437289267, 77.77170033598789, 70.12667429997195, 14.518010134064253, 6.684914610929078, 44.54463347445297, 16.730011239095408, 32.68158825937062, 14.571784266293129, 0.16233588153080317, 24.684204495240255, 26.677009706079986, 29.10376976108675, 40.120568246284314, 106.4752169375608, 46.73213831712937, 45.28466435631476, 28.55918434806552, 47.320544534881726, 11.066863452681499, 61.83041580467224, 45.89878400896891, 15.79033757095796, 11.604921846012669, 6.940030353682564, 16.448554033461193, 11.810256917862539, 27.627336246432662, 31.698178062662443, 12.147183852172555, 48.29684083020441, 42.529134126801644, 43.71594864852292, 3.9104986513783815, 5.840657261663531, 82.23811104883944, 59.477872444910055, 69.92711031082192, 75.38294999515085, 18.855738913263377, 25.865605958207194, 73.18307850010362, 49.00031229994972, 38.65809192375231, 16.67323824842521, 73.24341569343623, 14.16900841767711, 1.424726583036536, 10.409592434634224, 141.6126918020618, 122.35736043016291, 0.16344625503655272, 0.0, 67.48812442527884, 25.314665389463574, 23.452615051218785, 49.53068067244116, 67.66749504511013, 0.2111074142907483, 17.948702742401316, 5.831712228779252, 44.98451793520077, 1.6603891121120429, 65.98138620117953, 5.309017597357909, 54.09057168368012, 4.48140452615963, 63.370324865799745, 28.91361716896001, 6.761338638337963, 10.80237440069168, 68.09229889384503, 9.853768938313488, 6.507732910495948, 41.01989914890634, 70.86042331970759, 32.860780063213795, 53.96128365570937, 9.550808864194716, 11.253236346566567, 32.56238734074774, 21.96633652350005, 3.605681962062882, 50.44343625277629, 44.21822144100178, 2.0007738894976006, 54.75374291571887, 15.670625513604248, 16.612190525048653, 75.91895727927782, 63.38049810541979, 42.129252539044934, 4.672361487966941, 2.1458145763062477, 2.353398186709661, 68.32512330229905, 82.68365784664812, 16.909511983929683, 43.80474441578055, 49.04985157684828, 38.87257693957765, 13.633271991824815, 10.457451705733872, 27.173647138618577, 41.75292425946197, 42.306300236363164, 8.305575447555753, 11.571247742770037, 19.663598713436716, 68.5658852077418, 14.179580164506518, 51.60291884240691, 88.03350415860814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8322376424548895, "mean_inference_ms": 2.5305324248024474, "mean_action_processing_ms": 0.35003022500358005, "mean_env_wait_ms": 0.2986526345417781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025101661682128906, "StateBufferConnector_ms": 0.057327985763549805, "ViewRequirementAgentConnector_ms": 0.7291780710220337}, "num_episodes": 18, "episode_return_max": 360.38999999999993, "episode_return_min": -32.89474778222723, "episode_return_mean": 162.74551980680025, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 99.84433957845675, "num_env_steps_trained_throughput_per_sec": 99.84433957845675, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 24219.031, "restore_workers_time_ms": 0.019, "training_step_time_ms": 24218.971, "sample_time_ms": 4938.214, "learn_time_ms": 19235.694, "learn_throughput": 207.947, "synch_weights_time_ms": 40.853}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "ef79f_00000", "date": "2024-08-16_11-35-47", "timestamp": 1723788347, "time_this_iter_s": 40.16252088546753, "time_total_s": 1121.8027753829956, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5369040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1121.8027753829956, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 53.62105263157894, "ram_util_percent": 81.16491228070174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0408674789011165, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.576726894277744, "policy_loss": -0.004291050790725325, "vf_loss": 9.579381505269852, "vf_explained_var": 0.007631333132900258, "kl": 0.007272960204318422, "entropy": 0.8550868344054651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.110327293885447, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.114563166149079, "policy_loss": -0.004402406908763898, "vf_loss": 6.118965575808571, "vf_explained_var": 0.6513566845939273, "kl": 0.022851362119165358, "entropy": 0.47016608696135265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 360.38999999999993, "episode_reward_min": -32.89474778222723, "episode_reward_mean": 120.80324505615707, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.13980735200477, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.1, "predator_policy": 141.6126918020618}, "policy_reward_mean": {"prey_policy": 23.32941813486555, "predator_policy": 37.07220439321301}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.81307399302347, 343.7280857485865, 301.9986049507818, 321.3084551957706, 301.1090680323755, 225.56908827889413, 58.75749618300036, 163.4073370953946, -16.91225563291575, 216.41737636850897, 310.93991639884376, 164.9159817397491, -4.925401573660866, -30.951738395489922, 206.22500163916902, 1.6774524982463495, 279.3442243193393, 205.57072103385548, 232.95676580075587, 198.7227585622016, 124.84405394968333, 53.428072305377995, 318.0768167302074, 224.75219355776454, 188.99338364061646, 271.4299999999999, 248.94890030172039, -3.8639218278619674, 149.57393862499416, 105.64218585251047, -17.735192890505978, 58.11654116576959, 337.8701702735354, 280.84674018417064, 184.36648586829077, 167.74828515907967, 190.4890231060454, 295.89707493994814, -2.3633952674988024, 18.69705902114253, 170.7061934496119, 68.83022200227225, 141.12153926197342, -8.325336640771086, 302.8447265830365, 49.11314261510542, 360.38999999999993, 34.878468848098684, 156.8915460349336, -27.21565675486734, 306.22358862762627, 154.06013060124377, 12.731086787653975, 8.232105608532331, 1.815622426699791, 306.6599999999999, 65.4335283836547, 121.20522364036026, 24.69669571064075, 9.820583001833876, 207.3329614940347, 201.46390511535012, 45.60915871207364, -30.11949319859384, 319.6751585627296, 42.77555269169175, 124.02160800185457, 357.24000000000007, 14.005728138424113, 126.141257167371, -18.981043802403935, 326.073487930457, 28.147537066749877, 89.36995412492286, 314.44482605428936, -32.89474778222723, -11.332294979494167, 16.395566159484783, -1.1865506738762535, 237.04113204186217, 14.907625247931708, 54.4673777168801, 11.249282264442682, -8.532230605505681, 5.310380239218362, 0.9554396426169594, 152.1387170134624, 43.16921632257884, 42.992651371107755, 3.512278473977557, -8.44271612439218, 21.700726336192993, 51.02626717607578, 4.1142533210488, 65.23330970227391, 45.08435040615525, 6.299492909943668, -23.3763254729659, -9.167086124963896, 45.913955855866426], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [150.84587449208215, 89.11423792958269, 148.69053542360916, 179.99453508064622, 159.59826034114744, 126.65088802481054, 134.90855566996404, 163.5509869800465, 123.10057435402568, 171.28999999999985, 87.76706806606569, 104.68045782312272, -8.906940717981263, 12.645269736404154, 59.73683998683415, 64.959459493074, -42.49343008640399, -41.29348768690171, 97.01095095660465, 69.45388394369958, 147.53000000000003, 157.44675195066037, 48.44207082942215, 66.31139961753621, -62.11969187953273, -13.815096461754486, -49.643422136265166, -58.21671809100586, 95.02659749544928, 64.78669396257087, -58.984744202425915, -48.995768295690105, 128.76263956700575, 139.03234512587846, 137.35916666284527, 24.315183160862762, 87.29731036060268, 84.58391608438505, 32.09714320513748, 107.16898931517339, 53.43974380427767, 8.762745879923356, -70.898355260033, -23.571947070548834, 134.4938919852143, 162.37999999999988, 84.18850357975609, 79.28904526446016, 70.64956528737468, 71.09044582757812, 123.20319559360927, 123.3802640296198, 127.74150553194227, 65.42661530261164, -44.85246565110484, -105.60724136060215, 19.677514668182905, 37.879621283366994, 21.911126995890967, 7.851329973672034, -42.35079180202185, -48.28168034583782, -4.290132198518797, 0.7175517843614663, 176.24, 143.08521807384022, 140.2535939324759, 112.33433530037112, 71.05719261844182, 53.9837789407539, 38.74178597848956, 68.56247449821348, 75.14901540103477, 29.094924929686105, 164.3600000000001, 121.78591902690664, -85.57313930237895, -58.506239458869395, -51.893334530598054, -74.71966675423214, 62.83460598610091, 63.15024259204062, -5.741522738574455, -47.611646059206684, 13.530803454905582, 72.25940563489041, -34.46160256416612, -61.27615818771818, 155.89471816072808, 135.11568940463775, -18.717102265114114, -196.13980735200477, 170.12655374496345, 190.1, -23.244878713658395, -34.679442252985275, 32.5256659134147, 51.38258439785909, -60.82556331514296, -34.26869589912533, 137.000065295255, 145.44310836119098, 41.892161923543824, 65.52306163038723, -40.344621185280005, -18.214695825603325, -28.69933613923589, -21.64053446207151, -38.03461590868076, -52.43370369937913, 120.73762559930842, 168.35866136166203, -29.4075061592555, 16.894966710751707, 24.171867856021674, 49.505723724936374, -29.739394490916467, -49.28511318136422, -4.551754613215822, -49.13975490485433, 60.778395977189604, 102.73894182953113, 84.41510904663188, 91.47677758315554, -25.364676024797088, -23.68782295690734, -44.026349332181546, -42.84766067162879, 150.27393885391632, 137.11840367016066, -29.0251369430765, -67.49876574992923, 74.32929067612012, 2.8907032987227144, 168.83660181329032, 183.90418542369375, -82.93780221717518, -54.065250793347666, 27.04863626946827, 38.37836449819244, -48.01791253032425, -58.88555978850573, 148.52, 153.4627642328983, -16.839872423676148, -23.93916190765455, 8.125016501994907, 30.633061939009053, 149.27857806926815, 133.93140152881466, -60.27186829410973, -55.368344860365944, -70.39123747164041, -80.5774805088688, -26.25790558502601, -60.19964841746129, -63.66386273702339, -83.81886606803253, 102.57803853204429, 105.32299038621899, -95.53502595436034, -90.3241651423357, 1.2666693225463213, -58.23967487632539, -57.31523273560856, -60.32777669338966, -63.09884316959279, -19.628625786406985, -38.84333846920254, -48.66050087494454, -59.159904400116, -60.959991150544, 47.5371248923261, 61.93334701355681, -43.60768878652447, -52.178152323469, 9.857468242370176, -24.978904305128015, -56.980691986472614, -60.67150655152144, -67.57965408036313, -39.12176500708115, -40.534525372281024, -47.46053136138536, -42.08427374064743, -101.71884519282908, -45.515547507308156, -68.92740083770865, 1.6143176879484336, -42.541879963612814, -56.13192223960493, 1.669300368446391, -22.44395578854482, -79.75517509718462, -71.95292836057882, -60.77023069009132, -48.635887661246755, -68.3546879862614, -55.162263009390216, -39.014377974253264], "policy_predator_policy_reward": [21.3550296060512, 9.497931965307517, 8.948651141568076, 6.094364102763078, 7.977352772257896, 7.772103812566, 12.945296061851101, 9.903616483909135, 4.4894256459744915, 2.2290680323760217, 0.0, 33.12156238970576, 46.43004382061178, 8.589123343965829, 16.621245880441844, 22.089791735044688, 54.65881596747918, 12.215846172910807, 17.453330999706935, 32.49921046849808, 4.705534085334832, 1.257630362848667, 31.72378262847629, 18.4387286643145, 1.6081838517132359, 69.40120291591303, 64.88930259973031, 12.019099232050802, 32.134888575581286, 14.276821605568038, 65.22708003602995, 44.43088496033242, 5.120976007219997, 6.428263619235547, 7.577050555272789, 36.31932065487484, 35.68525955411941, 25.39027980164896, 42.976017148655245, 16.480608893235495, 45.743513828192796, 16.898050437289267, 77.77170033598789, 70.12667429997195, 14.518010134064253, 6.684914610929078, 44.54463347445297, 16.730011239095408, 32.68158825937062, 14.571784266293129, 0.16233588153080317, 24.684204495240255, 26.677009706079986, 29.10376976108675, 40.120568246284314, 106.4752169375608, 46.73213831712937, 45.28466435631476, 28.55918434806552, 47.320544534881726, 11.066863452681499, 61.83041580467224, 45.89878400896891, 15.79033757095796, 11.604921846012669, 6.940030353682564, 16.448554033461193, 11.810256917862539, 27.627336246432662, 31.698178062662443, 12.147183852172555, 48.29684083020441, 42.529134126801644, 43.71594864852292, 3.9104986513783815, 5.840657261663531, 82.23811104883944, 59.477872444910055, 69.92711031082192, 75.38294999515085, 18.855738913263377, 25.865605958207194, 73.18307850010362, 49.00031229994972, 38.65809192375231, 16.67323824842521, 73.24341569343623, 14.16900841767711, 1.424726583036536, 10.409592434634224, 141.6126918020618, 122.35736043016291, 0.16344625503655272, 0.0, 67.48812442527884, 25.314665389463574, 23.452615051218785, 49.53068067244116, 67.66749504511013, 0.2111074142907483, 17.948702742401316, 5.831712228779252, 44.98451793520077, 1.6603891121120429, 65.98138620117953, 5.309017597357909, 54.09057168368012, 4.48140452615963, 63.370324865799745, 28.91361716896001, 6.761338638337963, 10.80237440069168, 68.09229889384503, 9.853768938313488, 6.507732910495948, 41.01989914890634, 70.86042331970759, 32.860780063213795, 53.96128365570937, 9.550808864194716, 11.253236346566567, 32.56238734074774, 21.96633652350005, 3.605681962062882, 50.44343625277629, 44.21822144100178, 2.0007738894976006, 54.75374291571887, 15.670625513604248, 16.612190525048653, 75.91895727927782, 63.38049810541979, 42.129252539044934, 4.672361487966941, 2.1458145763062477, 2.353398186709661, 68.32512330229905, 82.68365784664812, 16.909511983929683, 43.80474441578055, 49.04985157684828, 38.87257693957765, 13.633271991824815, 10.457451705733872, 27.173647138618577, 41.75292425946197, 42.306300236363164, 8.305575447555753, 11.571247742770037, 19.663598713436716, 68.5658852077418, 14.179580164506518, 51.60291884240691, 88.03350415860814, 33.155311431775964, 69.69780873019617, 74.37614772483975, 71.92003040633992, 21.55279730148609, 7.587305822112964, 94.51863533097041, 106.24818101365712, 70.49152722068122, 40.94885604997808, 79.55130001749123, 49.340991675949475, 60.14960492644235, 14.045633424051628, 79.46447656587472, 13.349743017490656, 49.31285208409078, 71.7624831091861, 40.839729205577534, 1.8285159020019592, 70.38070964679143, 68.57434778578093, 2.820063214898071, 55.29402421896775, 68.74175785734359, 52.42271915462796, 97.45056051991392, 0.8081424431382747, 51.13345163829526, 58.56233143156413, 84.7861800939425, 110.04320601560991, 83.53324071777433, 35.023960948291254, 49.09170867961675, 57.06916329832168, 1.460567367765404, 98.08640490954826, 5.434416771927193, 103.06420702374596, 20.994978062738525, 88.35185551496565, 11.14786307535452, 96.67562644718991, 76.32814827083901, 63.76244856867078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.884082916965069, "mean_inference_ms": 2.6759143428571126, "mean_action_processing_ms": 0.3726081018420245, "mean_env_wait_ms": 0.3164503571876198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01013326644897461, "StateBufferConnector_ms": 0.029926657676696777, "ViewRequirementAgentConnector_ms": 0.8382272720336914}, "num_episodes": 23, "episode_return_max": 360.38999999999993, "episode_return_min": -32.89474778222723, "episode_return_mean": 120.80324505615707, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 99.54180152428415, "num_env_steps_trained_throughput_per_sec": 99.54180152428415, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 26991.384, "restore_workers_time_ms": 0.02, "training_step_time_ms": 26991.321, "sample_time_ms": 5846.269, "learn_time_ms": 21097.917, "learn_throughput": 189.592, "synch_weights_time_ms": 42.093}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "ef79f_00000", "date": "2024-08-16_11-36-27", "timestamp": 1723788387, "time_this_iter_s": 40.24443507194519, "time_total_s": 1162.0472104549408, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214acaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1162.0472104549408, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 53.175438596491226, "ram_util_percent": 80.87017543859648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9592808826890573, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.65116156673936, "policy_loss": -0.002629924211996021, "vf_loss": 9.652594709648657, "vf_explained_var": -0.04826208469728944, "kl": 0.005318930383548797, "entropy": 0.822230293921062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.515715659610809, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.302122297488824, "policy_loss": -0.007583192904435453, "vf_loss": 7.3097054842287905, "vf_explained_var": 0.39364380218364575, "kl": 0.015569523274647166, "entropy": 0.554651879065882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 360.38999999999993, "episode_reward_min": -32.89474778222723, "episode_reward_mean": 94.65612898700714, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.13980735200477, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.1, "predator_policy": 141.6126918020618}, "policy_reward_mean": {"prey_policy": 0.02738711854669873, "predator_policy": 47.300677374956884}, "custom_metrics": {}, "hist_stats": {"episode_reward": [232.95676580075587, 198.7227585622016, 124.84405394968333, 53.428072305377995, 318.0768167302074, 224.75219355776454, 188.99338364061646, 271.4299999999999, 248.94890030172039, -3.8639218278619674, 149.57393862499416, 105.64218585251047, -17.735192890505978, 58.11654116576959, 337.8701702735354, 280.84674018417064, 184.36648586829077, 167.74828515907967, 190.4890231060454, 295.89707493994814, -2.3633952674988024, 18.69705902114253, 170.7061934496119, 68.83022200227225, 141.12153926197342, -8.325336640771086, 302.8447265830365, 49.11314261510542, 360.38999999999993, 34.878468848098684, 156.8915460349336, -27.21565675486734, 306.22358862762627, 154.06013060124377, 12.731086787653975, 8.232105608532331, 1.815622426699791, 306.6599999999999, 65.4335283836547, 121.20522364036026, 24.69669571064075, 9.820583001833876, 207.3329614940347, 201.46390511535012, 45.60915871207364, -30.11949319859384, 319.6751585627296, 42.77555269169175, 124.02160800185457, 357.24000000000007, 14.005728138424113, 126.141257167371, -18.981043802403935, 326.073487930457, 28.147537066749877, 89.36995412492286, 314.44482605428936, -32.89474778222723, -11.332294979494167, 16.395566159484783, -1.1865506738762535, 237.04113204186217, 14.907625247931708, 54.4673777168801, 11.249282264442682, -8.532230605505681, 5.310380239218362, 0.9554396426169594, 152.1387170134624, 43.16921632257884, 42.992651371107755, 3.512278473977557, -8.44271612439218, 21.700726336192993, 51.02626717607578, 4.1142533210488, 65.23330970227391, 45.08435040615525, 6.299492909943668, -23.3763254729659, -9.167086124963896, 45.913955855866426, 19.164275525041248, 53.67249885386638, 11.527332177909553, 83.92096728849143, 13.203879954297616, 97.66388704074804, 44.62508580056422, 81.35949393485957, 1.7406716980685706, 15.418710788005102, 67.07187738059407, 31.864076561199568, 49.27368800600809, 16.60668784250043, 63.72522637989798, 6.239522419143117, 60.506732731973564, -13.303733424687403], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [87.29731036060268, 84.58391608438505, 32.09714320513748, 107.16898931517339, 53.43974380427767, 8.762745879923356, -70.898355260033, -23.571947070548834, 134.4938919852143, 162.37999999999988, 84.18850357975609, 79.28904526446016, 70.64956528737468, 71.09044582757812, 123.20319559360927, 123.3802640296198, 127.74150553194227, 65.42661530261164, -44.85246565110484, -105.60724136060215, 19.677514668182905, 37.879621283366994, 21.911126995890967, 7.851329973672034, -42.35079180202185, -48.28168034583782, -4.290132198518797, 0.7175517843614663, 176.24, 143.08521807384022, 140.2535939324759, 112.33433530037112, 71.05719261844182, 53.9837789407539, 38.74178597848956, 68.56247449821348, 75.14901540103477, 29.094924929686105, 164.3600000000001, 121.78591902690664, -85.57313930237895, -58.506239458869395, -51.893334530598054, -74.71966675423214, 62.83460598610091, 63.15024259204062, -5.741522738574455, -47.611646059206684, 13.530803454905582, 72.25940563489041, -34.46160256416612, -61.27615818771818, 155.89471816072808, 135.11568940463775, -18.717102265114114, -196.13980735200477, 170.12655374496345, 190.1, -23.244878713658395, -34.679442252985275, 32.5256659134147, 51.38258439785909, -60.82556331514296, -34.26869589912533, 137.000065295255, 145.44310836119098, 41.892161923543824, 65.52306163038723, -40.344621185280005, -18.214695825603325, -28.69933613923589, -21.64053446207151, -38.03461590868076, -52.43370369937913, 120.73762559930842, 168.35866136166203, -29.4075061592555, 16.894966710751707, 24.171867856021674, 49.505723724936374, -29.739394490916467, -49.28511318136422, -4.551754613215822, -49.13975490485433, 60.778395977189604, 102.73894182953113, 84.41510904663188, 91.47677758315554, -25.364676024797088, -23.68782295690734, -44.026349332181546, -42.84766067162879, 150.27393885391632, 137.11840367016066, -29.0251369430765, -67.49876574992923, 74.32929067612012, 2.8907032987227144, 168.83660181329032, 183.90418542369375, -82.93780221717518, -54.065250793347666, 27.04863626946827, 38.37836449819244, -48.01791253032425, -58.88555978850573, 148.52, 153.4627642328983, -16.839872423676148, -23.93916190765455, 8.125016501994907, 30.633061939009053, 149.27857806926815, 133.93140152881466, -60.27186829410973, -55.368344860365944, -70.39123747164041, -80.5774805088688, -26.25790558502601, -60.19964841746129, -63.66386273702339, -83.81886606803253, 102.57803853204429, 105.32299038621899, -95.53502595436034, -90.3241651423357, 1.2666693225463213, -58.23967487632539, -57.31523273560856, -60.32777669338966, -63.09884316959279, -19.628625786406985, -38.84333846920254, -48.66050087494454, -59.159904400116, -60.959991150544, 47.5371248923261, 61.93334701355681, -43.60768878652447, -52.178152323469, 9.857468242370176, -24.978904305128015, -56.980691986472614, -60.67150655152144, -67.57965408036313, -39.12176500708115, -40.534525372281024, -47.46053136138536, -42.08427374064743, -101.71884519282908, -45.515547507308156, -68.92740083770865, 1.6143176879484336, -42.541879963612814, -56.13192223960493, 1.669300368446391, -22.44395578854482, -79.75517509718462, -71.95292836057882, -60.77023069009132, -48.635887661246755, -68.3546879862614, -55.162263009390216, -39.014377974253264, -97.81944912544057, -88.76628645777232, -76.17834099764795, -78.3723275357778, -43.75812525951531, -39.5174300913072, -126.57887059627687, -17.65985295482901, -70.61363301953696, -85.96551508382854, 3.52055529816678, -79.11060288991447, -17.805332459504612, -14.669644838247258, -60.773271066725925, 21.38301517231093, -95.62377191119691, -48.30802638447986, -61.56186847792543, -60.22738747783968, -22.108700909637772, -63.03150917568933, -68.49032338564936, -40.20058163174838, -37.395621456175384, -33.38915370943435, -16.380876405783052, -43.90410978832763, 12.450475554865804, -24.959553444695356, -100.16496939955961, -111.5528229778091, -44.12880612441687, -147.05093969215903, -114.6284385517966, -98.52217889247653], "policy_predator_policy_reward": [35.68525955411941, 25.39027980164896, 42.976017148655245, 16.480608893235495, 45.743513828192796, 16.898050437289267, 77.77170033598789, 70.12667429997195, 14.518010134064253, 6.684914610929078, 44.54463347445297, 16.730011239095408, 32.68158825937062, 14.571784266293129, 0.16233588153080317, 24.684204495240255, 26.677009706079986, 29.10376976108675, 40.120568246284314, 106.4752169375608, 46.73213831712937, 45.28466435631476, 28.55918434806552, 47.320544534881726, 11.066863452681499, 61.83041580467224, 45.89878400896891, 15.79033757095796, 11.604921846012669, 6.940030353682564, 16.448554033461193, 11.810256917862539, 27.627336246432662, 31.698178062662443, 12.147183852172555, 48.29684083020441, 42.529134126801644, 43.71594864852292, 3.9104986513783815, 5.840657261663531, 82.23811104883944, 59.477872444910055, 69.92711031082192, 75.38294999515085, 18.855738913263377, 25.865605958207194, 73.18307850010362, 49.00031229994972, 38.65809192375231, 16.67323824842521, 73.24341569343623, 14.16900841767711, 1.424726583036536, 10.409592434634224, 141.6126918020618, 122.35736043016291, 0.16344625503655272, 0.0, 67.48812442527884, 25.314665389463574, 23.452615051218785, 49.53068067244116, 67.66749504511013, 0.2111074142907483, 17.948702742401316, 5.831712228779252, 44.98451793520077, 1.6603891121120429, 65.98138620117953, 5.309017597357909, 54.09057168368012, 4.48140452615963, 63.370324865799745, 28.91361716896001, 6.761338638337963, 10.80237440069168, 68.09229889384503, 9.853768938313488, 6.507732910495948, 41.01989914890634, 70.86042331970759, 32.860780063213795, 53.96128365570937, 9.550808864194716, 11.253236346566567, 32.56238734074774, 21.96633652350005, 3.605681962062882, 50.44343625277629, 44.21822144100178, 2.0007738894976006, 54.75374291571887, 15.670625513604248, 16.612190525048653, 75.91895727927782, 63.38049810541979, 42.129252539044934, 4.672361487966941, 2.1458145763062477, 2.353398186709661, 68.32512330229905, 82.68365784664812, 16.909511983929683, 43.80474441578055, 49.04985157684828, 38.87257693957765, 13.633271991824815, 10.457451705733872, 27.173647138618577, 41.75292425946197, 42.306300236363164, 8.305575447555753, 11.571247742770037, 19.663598713436716, 68.5658852077418, 14.179580164506518, 51.60291884240691, 88.03350415860814, 33.155311431775964, 69.69780873019617, 74.37614772483975, 71.92003040633992, 21.55279730148609, 7.587305822112964, 94.51863533097041, 106.24818101365712, 70.49152722068122, 40.94885604997808, 79.55130001749123, 49.340991675949475, 60.14960492644235, 14.045633424051628, 79.46447656587472, 13.349743017490656, 49.31285208409078, 71.7624831091861, 40.839729205577534, 1.8285159020019592, 70.38070964679143, 68.57434778578093, 2.820063214898071, 55.29402421896775, 68.74175785734359, 52.42271915462796, 97.45056051991392, 0.8081424431382747, 51.13345163829526, 58.56233143156413, 84.7861800939425, 110.04320601560991, 83.53324071777433, 35.023960948291254, 49.09170867961675, 57.06916329832168, 1.460567367765404, 98.08640490954826, 5.434416771927193, 103.06420702374596, 20.994978062738525, 88.35185551496565, 11.14786307535452, 96.67562644718991, 76.32814827083901, 63.76244856867078, 124.82891619572533, 80.92109491252876, 104.35882162452417, 103.86434576276778, 89.14283783725058, 5.660049691481491, 95.76194968707249, 132.39774115252456, 95.32363846692122, 74.45938959074195, 91.96847104250828, 81.28546358998717, 59.50182414316644, 17.598238955149846, 47.62533264505665, 73.12441718421789, 32.32049251225128, 113.35197748149403, 63.40205781199386, 73.8059089317763, 74.1670556045171, 78.04503186140415, 74.00972469259402, 66.54525688600334, 16.204753572262366, 103.85370959935572, 20.493347272917468, 56.39832676369367, 47.091875637644804, 29.142428632082755, 83.64390577834256, 134.3134090181693, 113.78451517697556, 137.9019633715742, 140.1534939747648, 59.693390044820696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9278732527557411, "mean_inference_ms": 2.804745869198106, "mean_action_processing_ms": 0.39253918552889283, "mean_env_wait_ms": 0.33265175402076397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010195732116699219, "StateBufferConnector_ms": 0.03138625621795654, "ViewRequirementAgentConnector_ms": 0.8721082210540771}, "num_episodes": 18, "episode_return_max": 360.38999999999993, "episode_return_min": -32.89474778222723, "episode_return_mean": 94.65612898700714, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 101.0860193352043, "num_env_steps_trained_throughput_per_sec": 101.0860193352043, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 29677.809, "restore_workers_time_ms": 0.021, "training_step_time_ms": 29677.742, "sample_time_ms": 6736.701, "learn_time_ms": 22889.221, "learn_throughput": 174.755, "synch_weights_time_ms": 46.723}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "ef79f_00000", "date": "2024-08-16_11-37-07", "timestamp": 1723788427, "time_this_iter_s": 39.653701305389404, "time_total_s": 1201.7009117603302, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321793d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1201.7009117603302, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 53.762499999999996, "ram_util_percent": 81.30178571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7553694068912475, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.717221876174685, "policy_loss": -0.005864536779484263, "vf_loss": 9.721629028723985, "vf_explained_var": -0.052164818275542486, "kl": 0.006477258178126554, "entropy": 0.8147137534681451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.002794687457817, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.454662618939839, "policy_loss": 0.00016590804083361512, "vf_loss": 8.454496709127275, "vf_explained_var": 0.22459011093649284, "kl": 0.011479763822518486, "entropy": 0.6565992243075497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 360.38999999999993, "episode_reward_min": -32.89474778222723, "episode_reward_mean": 70.07204470547694, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -197.63979917489425, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.1, "predator_policy": 191.11393379084893}, "policy_reward_mean": {"prey_policy": -25.88544210039441, "predator_policy": 60.921464453132906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.4890231060454, 295.89707493994814, -2.3633952674988024, 18.69705902114253, 170.7061934496119, 68.83022200227225, 141.12153926197342, -8.325336640771086, 302.8447265830365, 49.11314261510542, 360.38999999999993, 34.878468848098684, 156.8915460349336, -27.21565675486734, 306.22358862762627, 154.06013060124377, 12.731086787653975, 8.232105608532331, 1.815622426699791, 306.6599999999999, 65.4335283836547, 121.20522364036026, 24.69669571064075, 9.820583001833876, 207.3329614940347, 201.46390511535012, 45.60915871207364, -30.11949319859384, 319.6751585627296, 42.77555269169175, 124.02160800185457, 357.24000000000007, 14.005728138424113, 126.141257167371, -18.981043802403935, 326.073487930457, 28.147537066749877, 89.36995412492286, 314.44482605428936, -32.89474778222723, -11.332294979494167, 16.395566159484783, -1.1865506738762535, 237.04113204186217, 14.907625247931708, 54.4673777168801, 11.249282264442682, -8.532230605505681, 5.310380239218362, 0.9554396426169594, 152.1387170134624, 43.16921632257884, 42.992651371107755, 3.512278473977557, -8.44271612439218, 21.700726336192993, 51.02626717607578, 4.1142533210488, 65.23330970227391, 45.08435040615525, 6.299492909943668, -23.3763254729659, -9.167086124963896, 45.913955855866426, 19.164275525041248, 53.67249885386638, 11.527332177909553, 83.92096728849143, 13.203879954297616, 97.66388704074804, 44.62508580056422, 81.35949393485957, 1.7406716980685706, 15.418710788005102, 67.07187738059407, 31.864076561199568, 49.27368800600809, 16.60668784250043, 63.72522637989798, 6.239522419143117, 60.506732731973564, -13.303733424687403, 32.06966839283194, 44.3116542975373, 20.559251891669533, 24.16522897888287, 5.961225676670219, 42.514832810791184, 40.58225466820943, 79.189738633306, 11.116768682140464, 100.21857329095793, 105.87245171270402, 32.12973016052479, 20.899581785451357, 16.19557409869453, 4.210075925712344, 31.446908995842655, 35.86401223469442, 19.002216868670924], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [75.14901540103477, 29.094924929686105, 164.3600000000001, 121.78591902690664, -85.57313930237895, -58.506239458869395, -51.893334530598054, -74.71966675423214, 62.83460598610091, 63.15024259204062, -5.741522738574455, -47.611646059206684, 13.530803454905582, 72.25940563489041, -34.46160256416612, -61.27615818771818, 155.89471816072808, 135.11568940463775, -18.717102265114114, -196.13980735200477, 170.12655374496345, 190.1, -23.244878713658395, -34.679442252985275, 32.5256659134147, 51.38258439785909, -60.82556331514296, -34.26869589912533, 137.000065295255, 145.44310836119098, 41.892161923543824, 65.52306163038723, -40.344621185280005, -18.214695825603325, -28.69933613923589, -21.64053446207151, -38.03461590868076, -52.43370369937913, 120.73762559930842, 168.35866136166203, -29.4075061592555, 16.894966710751707, 24.171867856021674, 49.505723724936374, -29.739394490916467, -49.28511318136422, -4.551754613215822, -49.13975490485433, 60.778395977189604, 102.73894182953113, 84.41510904663188, 91.47677758315554, -25.364676024797088, -23.68782295690734, -44.026349332181546, -42.84766067162879, 150.27393885391632, 137.11840367016066, -29.0251369430765, -67.49876574992923, 74.32929067612012, 2.8907032987227144, 168.83660181329032, 183.90418542369375, -82.93780221717518, -54.065250793347666, 27.04863626946827, 38.37836449819244, -48.01791253032425, -58.88555978850573, 148.52, 153.4627642328983, -16.839872423676148, -23.93916190765455, 8.125016501994907, 30.633061939009053, 149.27857806926815, 133.93140152881466, -60.27186829410973, -55.368344860365944, -70.39123747164041, -80.5774805088688, -26.25790558502601, -60.19964841746129, -63.66386273702339, -83.81886606803253, 102.57803853204429, 105.32299038621899, -95.53502595436034, -90.3241651423357, 1.2666693225463213, -58.23967487632539, -57.31523273560856, -60.32777669338966, -63.09884316959279, -19.628625786406985, -38.84333846920254, -48.66050087494454, -59.159904400116, -60.959991150544, 47.5371248923261, 61.93334701355681, -43.60768878652447, -52.178152323469, 9.857468242370176, -24.978904305128015, -56.980691986472614, -60.67150655152144, -67.57965408036313, -39.12176500708115, -40.534525372281024, -47.46053136138536, -42.08427374064743, -101.71884519282908, -45.515547507308156, -68.92740083770865, 1.6143176879484336, -42.541879963612814, -56.13192223960493, 1.669300368446391, -22.44395578854482, -79.75517509718462, -71.95292836057882, -60.77023069009132, -48.635887661246755, -68.3546879862614, -55.162263009390216, -39.014377974253264, -97.81944912544057, -88.76628645777232, -76.17834099764795, -78.3723275357778, -43.75812525951531, -39.5174300913072, -126.57887059627687, -17.65985295482901, -70.61363301953696, -85.96551508382854, 3.52055529816678, -79.11060288991447, -17.805332459504612, -14.669644838247258, -60.773271066725925, 21.38301517231093, -95.62377191119691, -48.30802638447986, -61.56186847792543, -60.22738747783968, -22.108700909637772, -63.03150917568933, -68.49032338564936, -40.20058163174838, -37.395621456175384, -33.38915370943435, -16.380876405783052, -43.90410978832763, 12.450475554865804, -24.959553444695356, -100.16496939955961, -111.5528229778091, -44.12880612441687, -147.05093969215903, -114.6284385517966, -98.52217889247653, -88.79465498105306, -38.2961129099854, -197.63979917489425, -90.84145783818032, -76.8174658515117, -89.26393846963146, -78.20053543384854, -132.54251369629176, -58.642644992422206, -67.17757318128453, -72.03950654790711, -63.49513850918139, -47.265931977213334, -48.839791371990934, -54.769441535007296, -65.88398391655876, -123.3146140887974, -96.14904942285332, -130.636697112773, -8.185682594415848, -99.3139377111891, -134.19310901972068, -80.07875668955084, -98.99071049688523, -107.53005184529857, -154.01499699301047, -119.6767146928448, -34.188037847039126, -70.70264914177781, -141.8713540376994, -119.32053832283852, -69.35933064225223, -100.7914819589698, -49.21764115329953, -122.59469610014929, -84.28951211883502], "policy_predator_policy_reward": [42.529134126801644, 43.71594864852292, 3.9104986513783815, 5.840657261663531, 82.23811104883944, 59.477872444910055, 69.92711031082192, 75.38294999515085, 18.855738913263377, 25.865605958207194, 73.18307850010362, 49.00031229994972, 38.65809192375231, 16.67323824842521, 73.24341569343623, 14.16900841767711, 1.424726583036536, 10.409592434634224, 141.6126918020618, 122.35736043016291, 0.16344625503655272, 0.0, 67.48812442527884, 25.314665389463574, 23.452615051218785, 49.53068067244116, 67.66749504511013, 0.2111074142907483, 17.948702742401316, 5.831712228779252, 44.98451793520077, 1.6603891121120429, 65.98138620117953, 5.309017597357909, 54.09057168368012, 4.48140452615963, 63.370324865799745, 28.91361716896001, 6.761338638337963, 10.80237440069168, 68.09229889384503, 9.853768938313488, 6.507732910495948, 41.01989914890634, 70.86042331970759, 32.860780063213795, 53.96128365570937, 9.550808864194716, 11.253236346566567, 32.56238734074774, 21.96633652350005, 3.605681962062882, 50.44343625277629, 44.21822144100178, 2.0007738894976006, 54.75374291571887, 15.670625513604248, 16.612190525048653, 75.91895727927782, 63.38049810541979, 42.129252539044934, 4.672361487966941, 2.1458145763062477, 2.353398186709661, 68.32512330229905, 82.68365784664812, 16.909511983929683, 43.80474441578055, 49.04985157684828, 38.87257693957765, 13.633271991824815, 10.457451705733872, 27.173647138618577, 41.75292425946197, 42.306300236363164, 8.305575447555753, 11.571247742770037, 19.663598713436716, 68.5658852077418, 14.179580164506518, 51.60291884240691, 88.03350415860814, 33.155311431775964, 69.69780873019617, 74.37614772483975, 71.92003040633992, 21.55279730148609, 7.587305822112964, 94.51863533097041, 106.24818101365712, 70.49152722068122, 40.94885604997808, 79.55130001749123, 49.340991675949475, 60.14960492644235, 14.045633424051628, 79.46447656587472, 13.349743017490656, 49.31285208409078, 71.7624831091861, 40.839729205577534, 1.8285159020019592, 70.38070964679143, 68.57434778578093, 2.820063214898071, 55.29402421896775, 68.74175785734359, 52.42271915462796, 97.45056051991392, 0.8081424431382747, 51.13345163829526, 58.56233143156413, 84.7861800939425, 110.04320601560991, 83.53324071777433, 35.023960948291254, 49.09170867961675, 57.06916329832168, 1.460567367765404, 98.08640490954826, 5.434416771927193, 103.06420702374596, 20.994978062738525, 88.35185551496565, 11.14786307535452, 96.67562644718991, 76.32814827083901, 63.76244856867078, 124.82891619572533, 80.92109491252876, 104.35882162452417, 103.86434576276778, 89.14283783725058, 5.660049691481491, 95.76194968707249, 132.39774115252456, 95.32363846692122, 74.45938959074195, 91.96847104250828, 81.28546358998717, 59.50182414316644, 17.598238955149846, 47.62533264505665, 73.12441718421789, 32.32049251225128, 113.35197748149403, 63.40205781199386, 73.8059089317763, 74.1670556045171, 78.04503186140415, 74.00972469259402, 66.54525688600334, 16.204753572262366, 103.85370959935572, 20.493347272917468, 56.39832676369367, 47.091875637644804, 29.142428632082755, 83.64390577834256, 134.3134090181693, 113.78451517697556, 137.9019633715742, 140.1534939747648, 59.693390044820696, 29.105064397497788, 130.0553718863728, 151.26699674024627, 181.52591457036544, 124.57944952588878, 62.06120668692384, 151.87302794958234, 83.03525015944082, 67.28464869740726, 64.49679515296977, 109.76512308024297, 68.28435478763672, 102.5505431778922, 34.13743483952162, 91.94375994231645, 107.89940414255585, 79.48763501934523, 151.092797174446, 106.23012924835201, 132.8108237497946, 175.1641507393974, 164.21534770421655, 83.77259447820244, 127.42660286875845, 91.33069683291134, 191.11393379084893, 56.94319803290803, 113.11712860567043, 119.15227190017293, 97.63180720501668, 91.44921856770094, 128.67755939323237, 122.7559958967911, 63.117139450172616, 81.18082325025061, 144.70560183740466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9727777480786424, "mean_inference_ms": 2.9349304511168537, "mean_action_processing_ms": 0.4127192990179469, "mean_env_wait_ms": 0.3488844936326465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010075688362121582, "StateBufferConnector_ms": 0.0320127010345459, "ViewRequirementAgentConnector_ms": 0.979880690574646}, "num_episodes": 18, "episode_return_max": 360.38999999999993, "episode_return_min": -32.89474778222723, "episode_return_mean": 70.07204470547694, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 97.83115945930813, "num_env_steps_trained_throughput_per_sec": 97.83115945930813, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 32473.773, "restore_workers_time_ms": 0.022, "training_step_time_ms": 32473.703, "sample_time_ms": 7542.138, "learn_time_ms": 24877.873, "learn_throughput": 160.785, "synch_weights_time_ms": 48.499}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "ef79f_00000", "date": "2024-08-16_11-37-48", "timestamp": 1723788468, "time_this_iter_s": 41.223947048187256, "time_total_s": 1242.9248588085175, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3217b0700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1242.9248588085175, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 55.17118644067797, "ram_util_percent": 81.44237288135592}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2546326789117996, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.66109801600219, "policy_loss": -0.0025041398296635304, "vf_loss": 9.662309643074318, "vf_explained_var": -0.05257850992616522, "kl": 0.005744398122432256, "entropy": 0.8087794936523236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9090253986694194, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.5976482459477, "policy_loss": -0.005794243597568422, "vf_loss": 8.60344249710204, "vf_explained_var": 0.2959000497583359, "kl": 0.011295467211669458, "entropy": 0.680394170177046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 357.24000000000007, "episode_reward_min": -32.89474778222723, "episode_reward_mean": 53.64920789616304, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -242.7330858502174, "predator_policy": 0.8081424431382747}, "policy_reward_max": {"prey_policy": 183.90418542369375, "predator_policy": 212.3714620095498}, "policy_reward_mean": {"prey_policy": -52.21586052158912, "predator_policy": 79.04046446967064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.69669571064075, 9.820583001833876, 207.3329614940347, 201.46390511535012, 45.60915871207364, -30.11949319859384, 319.6751585627296, 42.77555269169175, 124.02160800185457, 357.24000000000007, 14.005728138424113, 126.141257167371, -18.981043802403935, 326.073487930457, 28.147537066749877, 89.36995412492286, 314.44482605428936, -32.89474778222723, -11.332294979494167, 16.395566159484783, -1.1865506738762535, 237.04113204186217, 14.907625247931708, 54.4673777168801, 11.249282264442682, -8.532230605505681, 5.310380239218362, 0.9554396426169594, 152.1387170134624, 43.16921632257884, 42.992651371107755, 3.512278473977557, -8.44271612439218, 21.700726336192993, 51.02626717607578, 4.1142533210488, 65.23330970227391, 45.08435040615525, 6.299492909943668, -23.3763254729659, -9.167086124963896, 45.913955855866426, 19.164275525041248, 53.67249885386638, 11.527332177909553, 83.92096728849143, 13.203879954297616, 97.66388704074804, 44.62508580056422, 81.35949393485957, 1.7406716980685706, 15.418710788005102, 67.07187738059407, 31.864076561199568, 49.27368800600809, 16.60668784250043, 63.72522637989798, 6.239522419143117, 60.506732731973564, -13.303733424687403, 32.06966839283194, 44.3116542975373, 20.559251891669533, 24.16522897888287, 5.961225676670219, 42.514832810791184, 40.58225466820943, 79.189738633306, 11.116768682140464, 100.21857329095793, 105.87245171270402, 32.12973016052479, 20.899581785451357, 16.19557409869453, 4.210075925712344, 31.446908995842655, 35.86401223469442, 19.002216868670924, 36.07826113117519, 32.57709467667916, 23.0187897290487, 71.65129151920345, 89.15801298830416, 73.06624255074968, 31.760040592298097, 21.092596406497794, 36.55294363437467, 23.144284477776594, 60.424204126497344, 79.22589309953055, 40.34928311393019, 37.12514404146559, 87.57054677551719, 16.070795937404554, 55.470851628232644, 67.34803534207943, 23.311780532955243, 66.14677407049484, 60.95710778845357, 53.932238180742395], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.739394490916467, -49.28511318136422, -4.551754613215822, -49.13975490485433, 60.778395977189604, 102.73894182953113, 84.41510904663188, 91.47677758315554, -25.364676024797088, -23.68782295690734, -44.026349332181546, -42.84766067162879, 150.27393885391632, 137.11840367016066, -29.0251369430765, -67.49876574992923, 74.32929067612012, 2.8907032987227144, 168.83660181329032, 183.90418542369375, -82.93780221717518, -54.065250793347666, 27.04863626946827, 38.37836449819244, -48.01791253032425, -58.88555978850573, 148.52, 153.4627642328983, -16.839872423676148, -23.93916190765455, 8.125016501994907, 30.633061939009053, 149.27857806926815, 133.93140152881466, -60.27186829410973, -55.368344860365944, -70.39123747164041, -80.5774805088688, -26.25790558502601, -60.19964841746129, -63.66386273702339, -83.81886606803253, 102.57803853204429, 105.32299038621899, -95.53502595436034, -90.3241651423357, 1.2666693225463213, -58.23967487632539, -57.31523273560856, -60.32777669338966, -63.09884316959279, -19.628625786406985, -38.84333846920254, -48.66050087494454, -59.159904400116, -60.959991150544, 47.5371248923261, 61.93334701355681, -43.60768878652447, -52.178152323469, 9.857468242370176, -24.978904305128015, -56.980691986472614, -60.67150655152144, -67.57965408036313, -39.12176500708115, -40.534525372281024, -47.46053136138536, -42.08427374064743, -101.71884519282908, -45.515547507308156, -68.92740083770865, 1.6143176879484336, -42.541879963612814, -56.13192223960493, 1.669300368446391, -22.44395578854482, -79.75517509718462, -71.95292836057882, -60.77023069009132, -48.635887661246755, -68.3546879862614, -55.162263009390216, -39.014377974253264, -97.81944912544057, -88.76628645777232, -76.17834099764795, -78.3723275357778, -43.75812525951531, -39.5174300913072, -126.57887059627687, -17.65985295482901, -70.61363301953696, -85.96551508382854, 3.52055529816678, -79.11060288991447, -17.805332459504612, -14.669644838247258, -60.773271066725925, 21.38301517231093, -95.62377191119691, -48.30802638447986, -61.56186847792543, -60.22738747783968, -22.108700909637772, -63.03150917568933, -68.49032338564936, -40.20058163174838, -37.395621456175384, -33.38915370943435, -16.380876405783052, -43.90410978832763, 12.450475554865804, -24.959553444695356, -100.16496939955961, -111.5528229778091, -44.12880612441687, -147.05093969215903, -114.6284385517966, -98.52217889247653, -88.79465498105306, -38.2961129099854, -197.63979917489425, -90.84145783818032, -76.8174658515117, -89.26393846963146, -78.20053543384854, -132.54251369629176, -58.642644992422206, -67.17757318128453, -72.03950654790711, -63.49513850918139, -47.265931977213334, -48.839791371990934, -54.769441535007296, -65.88398391655876, -123.3146140887974, -96.14904942285332, -130.636697112773, -8.185682594415848, -99.3139377111891, -134.19310901972068, -80.07875668955084, -98.99071049688523, -107.53005184529857, -154.01499699301047, -119.6767146928448, -34.188037847039126, -70.70264914177781, -141.8713540376994, -119.32053832283852, -69.35933064225223, -100.7914819589698, -49.21764115329953, -122.59469610014929, -84.28951211883502, -80.65834158815501, -76.34566409735254, -45.71559603884637, -107.56789199859737, -119.75251688588159, -92.74982862007586, -78.57309585592787, -26.857091742646013, -27.044821216160397, -4.68753113894082, -100.05682972639627, -142.53067479818378, -114.31954335423494, -118.77442479633073, -111.15161989043666, -132.77976548711732, -163.10088890771, -155.56918926591092, -119.86314359154494, -242.7330858502174, -37.42976724739204, -74.12822977259357, -97.91877051819525, -44.255087906002196, -103.26481918077725, -136.69336800740479, -107.14922314507739, -142.4335473580418, -32.520833801772994, -27.007189846104183, -117.08024028517778, -112.95473082655614, -56.96564217959538, -137.3335453899081, -92.07744614343306, -9.820726701693586, -103.02629088185914, -79.99365515121042, -129.58651335037433, -134.62275734219324, -24.355502505670174, -8.035923921541674, -172.3590739377939, -133.83569565096138], "policy_predator_policy_reward": [70.86042331970759, 32.860780063213795, 53.96128365570937, 9.550808864194716, 11.253236346566567, 32.56238734074774, 21.96633652350005, 3.605681962062882, 50.44343625277629, 44.21822144100178, 2.0007738894976006, 54.75374291571887, 15.670625513604248, 16.612190525048653, 75.91895727927782, 63.38049810541979, 42.129252539044934, 4.672361487966941, 2.1458145763062477, 2.353398186709661, 68.32512330229905, 82.68365784664812, 16.909511983929683, 43.80474441578055, 49.04985157684828, 38.87257693957765, 13.633271991824815, 10.457451705733872, 27.173647138618577, 41.75292425946197, 42.306300236363164, 8.305575447555753, 11.571247742770037, 19.663598713436716, 68.5658852077418, 14.179580164506518, 51.60291884240691, 88.03350415860814, 33.155311431775964, 69.69780873019617, 74.37614772483975, 71.92003040633992, 21.55279730148609, 7.587305822112964, 94.51863533097041, 106.24818101365712, 70.49152722068122, 40.94885604997808, 79.55130001749123, 49.340991675949475, 60.14960492644235, 14.045633424051628, 79.46447656587472, 13.349743017490656, 49.31285208409078, 71.7624831091861, 40.839729205577534, 1.8285159020019592, 70.38070964679143, 68.57434778578093, 2.820063214898071, 55.29402421896775, 68.74175785734359, 52.42271915462796, 97.45056051991392, 0.8081424431382747, 51.13345163829526, 58.56233143156413, 84.7861800939425, 110.04320601560991, 83.53324071777433, 35.023960948291254, 49.09170867961675, 57.06916329832168, 1.460567367765404, 98.08640490954826, 5.434416771927193, 103.06420702374596, 20.994978062738525, 88.35185551496565, 11.14786307535452, 96.67562644718991, 76.32814827083901, 63.76244856867078, 124.82891619572533, 80.92109491252876, 104.35882162452417, 103.86434576276778, 89.14283783725058, 5.660049691481491, 95.76194968707249, 132.39774115252456, 95.32363846692122, 74.45938959074195, 91.96847104250828, 81.28546358998717, 59.50182414316644, 17.598238955149846, 47.62533264505665, 73.12441718421789, 32.32049251225128, 113.35197748149403, 63.40205781199386, 73.8059089317763, 74.1670556045171, 78.04503186140415, 74.00972469259402, 66.54525688600334, 16.204753572262366, 103.85370959935572, 20.493347272917468, 56.39832676369367, 47.091875637644804, 29.142428632082755, 83.64390577834256, 134.3134090181693, 113.78451517697556, 137.9019633715742, 140.1534939747648, 59.693390044820696, 29.105064397497788, 130.0553718863728, 151.26699674024627, 181.52591457036544, 124.57944952588878, 62.06120668692384, 151.87302794958234, 83.03525015944082, 67.28464869740726, 64.49679515296977, 109.76512308024297, 68.28435478763672, 102.5505431778922, 34.13743483952162, 91.94375994231645, 107.89940414255585, 79.48763501934523, 151.092797174446, 106.23012924835201, 132.8108237497946, 175.1641507393974, 164.21534770421655, 83.77259447820244, 127.42660286875845, 91.33069683291134, 191.11393379084893, 56.94319803290803, 113.11712860567043, 119.15227190017293, 97.63180720501668, 91.44921856770094, 128.67755939323237, 122.7559958967911, 63.117139450172616, 81.18082325025061, 144.70560183740466, 96.41170183338633, 96.67056498329647, 53.97803531763267, 131.88254739649028, 88.7434422716549, 146.7776929633511, 95.10502352331925, 81.9764555944582, 41.67281422338676, 79.21755112001863, 135.3826377829709, 180.27110929235852, 153.61429423655017, 111.23971450631385, 167.65887057378282, 97.36511121026862, 185.9407586297948, 169.28226317820074, 173.36905190998917, 212.3714620095498, 116.42957675706336, 55.55262438941966, 141.3096194040981, 80.09013211962973, 128.12012336406065, 152.1873469380517, 158.48343856497343, 128.22447597961138, 95.74116326667354, 51.35740715672069, 128.72899308017475, 117.3767739689637, 110.83067669975031, 138.93936249798585, 64.89120961800899, 104.35499856919706, 69.81470032104185, 136.51702624498282, 137.9524830292948, 192.40356173376773, 43.44381236700897, 49.90472184865647, 181.49713634403585, 178.62987142546166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.030094803214378, "mean_inference_ms": 3.0965492522275873, "mean_action_processing_ms": 0.44004479097479066, "mean_env_wait_ms": 0.36979869175618196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009261608123779297, "StateBufferConnector_ms": 0.0314488410949707, "ViewRequirementAgentConnector_ms": 1.037398338317871}, "num_episodes": 22, "episode_return_max": 357.24000000000007, "episode_return_min": -32.89474778222723, "episode_return_mean": 53.64920789616304, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 98.49234564294511, "num_env_steps_trained_throughput_per_sec": 98.49234564294511, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 35166.296, "restore_workers_time_ms": 0.023, "training_step_time_ms": 35166.221, "sample_time_ms": 8778.939, "learn_time_ms": 26331.053, "learn_throughput": 151.912, "synch_weights_time_ms": 50.904}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "ef79f_00000", "date": "2024-08-16_11-38-29", "timestamp": 1723788509, "time_this_iter_s": 40.64245820045471, "time_total_s": 1283.5673170089722, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214af160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1283.5673170089722, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 53.09482758620689, "ram_util_percent": 82.05172413793102}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2310582521573576, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.675708513411264, "policy_loss": -0.004527838898221494, "vf_loss": 9.678933599764708, "vf_explained_var": -0.03151807217370896, "kl": 0.0057900328942557125, "entropy": 0.7889620028790973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.273954726653124, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.256249232266946, "policy_loss": -0.004151893298328909, "vf_loss": 8.260401119756951, "vf_explained_var": 0.12960060289297154, "kl": 0.00788556699875417, "entropy": 0.724748374955364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 237.04113204186217, "episode_reward_min": -23.3763254729659, "episode_reward_mean": 40.11377788038478, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -254.40363561038671, "predator_policy": 0.8081424431382747}, "policy_reward_max": {"prey_policy": 105.32299038621899, "predator_policy": 224.1661740858405}, "policy_reward_mean": {"prey_policy": -73.86850593959471, "predator_policy": 93.9253948797871}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.332294979494167, 16.395566159484783, -1.1865506738762535, 237.04113204186217, 14.907625247931708, 54.4673777168801, 11.249282264442682, -8.532230605505681, 5.310380239218362, 0.9554396426169594, 152.1387170134624, 43.16921632257884, 42.992651371107755, 3.512278473977557, -8.44271612439218, 21.700726336192993, 51.02626717607578, 4.1142533210488, 65.23330970227391, 45.08435040615525, 6.299492909943668, -23.3763254729659, -9.167086124963896, 45.913955855866426, 19.164275525041248, 53.67249885386638, 11.527332177909553, 83.92096728849143, 13.203879954297616, 97.66388704074804, 44.62508580056422, 81.35949393485957, 1.7406716980685706, 15.418710788005102, 67.07187738059407, 31.864076561199568, 49.27368800600809, 16.60668784250043, 63.72522637989798, 6.239522419143117, 60.506732731973564, -13.303733424687403, 32.06966839283194, 44.3116542975373, 20.559251891669533, 24.16522897888287, 5.961225676670219, 42.514832810791184, 40.58225466820943, 79.189738633306, 11.116768682140464, 100.21857329095793, 105.87245171270402, 32.12973016052479, 20.899581785451357, 16.19557409869453, 4.210075925712344, 31.446908995842655, 35.86401223469442, 19.002216868670924, 36.07826113117519, 32.57709467667916, 23.0187897290487, 71.65129151920345, 89.15801298830416, 73.06624255074968, 31.760040592298097, 21.092596406497794, 36.55294363437467, 23.144284477776594, 60.424204126497344, 79.22589309953055, 40.34928311393019, 37.12514404146559, 87.57054677551719, 16.070795937404554, 55.470851628232644, 67.34803534207943, 23.311780532955243, 66.14677407049484, 60.95710778845357, 53.932238180742395, 59.89029005815092, 7.221467998904886, 46.98396174976695, 31.68281974397449, 106.1841625042219, 43.22889934392388, 12.996190691469778, 31.43462353582612, 24.158220019532834, 43.09211826722698, 31.15451437879215, 81.83497168967381, 63.36328966194341, 99.32328033347723, 25.678968573525992, 43.91961852581313, 17.81969262459509, 25.31303771055166], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-70.39123747164041, -80.5774805088688, -26.25790558502601, -60.19964841746129, -63.66386273702339, -83.81886606803253, 102.57803853204429, 105.32299038621899, -95.53502595436034, -90.3241651423357, 1.2666693225463213, -58.23967487632539, -57.31523273560856, -60.32777669338966, -63.09884316959279, -19.628625786406985, -38.84333846920254, -48.66050087494454, -59.159904400116, -60.959991150544, 47.5371248923261, 61.93334701355681, -43.60768878652447, -52.178152323469, 9.857468242370176, -24.978904305128015, -56.980691986472614, -60.67150655152144, -67.57965408036313, -39.12176500708115, -40.534525372281024, -47.46053136138536, -42.08427374064743, -101.71884519282908, -45.515547507308156, -68.92740083770865, 1.6143176879484336, -42.541879963612814, -56.13192223960493, 1.669300368446391, -22.44395578854482, -79.75517509718462, -71.95292836057882, -60.77023069009132, -48.635887661246755, -68.3546879862614, -55.162263009390216, -39.014377974253264, -97.81944912544057, -88.76628645777232, -76.17834099764795, -78.3723275357778, -43.75812525951531, -39.5174300913072, -126.57887059627687, -17.65985295482901, -70.61363301953696, -85.96551508382854, 3.52055529816678, -79.11060288991447, -17.805332459504612, -14.669644838247258, -60.773271066725925, 21.38301517231093, -95.62377191119691, -48.30802638447986, -61.56186847792543, -60.22738747783968, -22.108700909637772, -63.03150917568933, -68.49032338564936, -40.20058163174838, -37.395621456175384, -33.38915370943435, -16.380876405783052, -43.90410978832763, 12.450475554865804, -24.959553444695356, -100.16496939955961, -111.5528229778091, -44.12880612441687, -147.05093969215903, -114.6284385517966, -98.52217889247653, -88.79465498105306, -38.2961129099854, -197.63979917489425, -90.84145783818032, -76.8174658515117, -89.26393846963146, -78.20053543384854, -132.54251369629176, -58.642644992422206, -67.17757318128453, -72.03950654790711, -63.49513850918139, -47.265931977213334, -48.839791371990934, -54.769441535007296, -65.88398391655876, -123.3146140887974, -96.14904942285332, -130.636697112773, -8.185682594415848, -99.3139377111891, -134.19310901972068, -80.07875668955084, -98.99071049688523, -107.53005184529857, -154.01499699301047, -119.6767146928448, -34.188037847039126, -70.70264914177781, -141.8713540376994, -119.32053832283852, -69.35933064225223, -100.7914819589698, -49.21764115329953, -122.59469610014929, -84.28951211883502, -80.65834158815501, -76.34566409735254, -45.71559603884637, -107.56789199859737, -119.75251688588159, -92.74982862007586, -78.57309585592787, -26.857091742646013, -27.044821216160397, -4.68753113894082, -100.05682972639627, -142.53067479818378, -114.31954335423494, -118.77442479633073, -111.15161989043666, -132.77976548711732, -163.10088890771, -155.56918926591092, -119.86314359154494, -242.7330858502174, -37.42976724739204, -74.12822977259357, -97.91877051819525, -44.255087906002196, -103.26481918077725, -136.69336800740479, -107.14922314507739, -142.4335473580418, -32.520833801772994, -27.007189846104183, -117.08024028517778, -112.95473082655614, -56.96564217959538, -137.3335453899081, -92.07744614343306, -9.820726701693586, -103.02629088185914, -79.99365515121042, -129.58651335037433, -134.62275734219324, -24.355502505670174, -8.035923921541674, -172.3590739377939, -133.83569565096138, -103.20253150771758, -28.33607840712114, -137.05034702869588, -95.454406935323, -186.91028244481353, -96.98039066237698, -122.04822947271494, -132.31929479043376, -50.00337617053003, -10.215725745082235, -44.51025293561632, -93.28100434595896, -92.97543834898097, -92.77159772730414, -82.69155682070026, -102.50815734318395, -103.29977211088395, -96.73753954202786, -117.69095082091206, -104.23986626723196, -128.09582791767474, -123.37749120032795, -26.7872710567133, -75.06304623400175, -139.23997466573164, -58.45658465538177, -64.39323718385519, -254.40363561038671, -43.24195786179917, -38.68708715250698, -76.23408326122963, -89.18764157135575, -104.52431300479344, -96.08359825109468, -57.21311126064764, -81.66545375798322], "policy_predator_policy_reward": [51.60291884240691, 88.03350415860814, 33.155311431775964, 69.69780873019617, 74.37614772483975, 71.92003040633992, 21.55279730148609, 7.587305822112964, 94.51863533097041, 106.24818101365712, 70.49152722068122, 40.94885604997808, 79.55130001749123, 49.340991675949475, 60.14960492644235, 14.045633424051628, 79.46447656587472, 13.349743017490656, 49.31285208409078, 71.7624831091861, 40.839729205577534, 1.8285159020019592, 70.38070964679143, 68.57434778578093, 2.820063214898071, 55.29402421896775, 68.74175785734359, 52.42271915462796, 97.45056051991392, 0.8081424431382747, 51.13345163829526, 58.56233143156413, 84.7861800939425, 110.04320601560991, 83.53324071777433, 35.023960948291254, 49.09170867961675, 57.06916329832168, 1.460567367765404, 98.08640490954826, 5.434416771927193, 103.06420702374596, 20.994978062738525, 88.35185551496565, 11.14786307535452, 96.67562644718991, 76.32814827083901, 63.76244856867078, 124.82891619572533, 80.92109491252876, 104.35882162452417, 103.86434576276778, 89.14283783725058, 5.660049691481491, 95.76194968707249, 132.39774115252456, 95.32363846692122, 74.45938959074195, 91.96847104250828, 81.28546358998717, 59.50182414316644, 17.598238955149846, 47.62533264505665, 73.12441718421789, 32.32049251225128, 113.35197748149403, 63.40205781199386, 73.8059089317763, 74.1670556045171, 78.04503186140415, 74.00972469259402, 66.54525688600334, 16.204753572262366, 103.85370959935572, 20.493347272917468, 56.39832676369367, 47.091875637644804, 29.142428632082755, 83.64390577834256, 134.3134090181693, 113.78451517697556, 137.9019633715742, 140.1534939747648, 59.693390044820696, 29.105064397497788, 130.0553718863728, 151.26699674024627, 181.52591457036544, 124.57944952588878, 62.06120668692384, 151.87302794958234, 83.03525015944082, 67.28464869740726, 64.49679515296977, 109.76512308024297, 68.28435478763672, 102.5505431778922, 34.13743483952162, 91.94375994231645, 107.89940414255585, 79.48763501934523, 151.092797174446, 106.23012924835201, 132.8108237497946, 175.1641507393974, 164.21534770421655, 83.77259447820244, 127.42660286875845, 91.33069683291134, 191.11393379084893, 56.94319803290803, 113.11712860567043, 119.15227190017293, 97.63180720501668, 91.44921856770094, 128.67755939323237, 122.7559958967911, 63.117139450172616, 81.18082325025061, 144.70560183740466, 96.41170183338633, 96.67056498329647, 53.97803531763267, 131.88254739649028, 88.7434422716549, 146.7776929633511, 95.10502352331925, 81.9764555944582, 41.67281422338676, 79.21755112001863, 135.3826377829709, 180.27110929235852, 153.61429423655017, 111.23971450631385, 167.65887057378282, 97.36511121026862, 185.9407586297948, 169.28226317820074, 173.36905190998917, 212.3714620095498, 116.42957675706336, 55.55262438941966, 141.3096194040981, 80.09013211962973, 128.12012336406065, 152.1873469380517, 158.48343856497343, 128.22447597961138, 95.74116326667354, 51.35740715672069, 128.72899308017475, 117.3767739689637, 110.83067669975031, 138.93936249798585, 64.89120961800899, 104.35499856919706, 69.81470032104185, 136.51702624498282, 137.9524830292948, 192.40356173376773, 43.44381236700897, 49.90472184865647, 181.49713634403585, 178.62987142546166, 72.85422344917025, 118.57467652381952, 119.92382181632227, 119.80240014660141, 169.39146330083446, 161.48317155612284, 114.31701288270293, 171.73333112442023, 83.57761945192863, 82.82564496790556, 70.66470377323716, 110.35545285226218, 122.32907982375967, 76.4141469439952, 136.77325185213385, 79.86108584757629, 119.37044218416048, 104.82508948828418, 107.30159125998327, 157.72134409538774, 142.59283836654524, 140.03499513024946, 78.932051273027, 104.75323770736176, 132.16275825430958, 128.8970907287471, 193.9539790418785, 224.1661740858405, 23.448111727041866, 84.15990186079038, 91.8973998305521, 117.4439435278463, 91.34691356148294, 127.08069031900041, 76.15656403822312, 88.03503869095935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0792059834862946, "mean_inference_ms": 3.231538049306898, "mean_action_processing_ms": 0.4628201334910931, "mean_env_wait_ms": 0.3876779336398908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01425325870513916, "StateBufferConnector_ms": 0.04668915271759033, "ViewRequirementAgentConnector_ms": 1.106553554534912}, "num_episodes": 18, "episode_return_max": 237.04113204186217, "episode_return_min": -23.3763254729659, "episode_return_mean": 40.11377788038478, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 95.95980888657837, "num_env_steps_trained_throughput_per_sec": 95.95980888657837, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 38046.147, "restore_workers_time_ms": 0.024, "training_step_time_ms": 38046.068, "sample_time_ms": 9926.952, "learn_time_ms": 28060.52, "learn_throughput": 142.549, "synch_weights_time_ms": 53.399}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "ef79f_00000", "date": "2024-08-16_11-39-11", "timestamp": 1723788551, "time_this_iter_s": 41.70184016227722, "time_total_s": 1325.2691571712494, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214b5a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1325.2691571712494, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 55.840677966101694, "ram_util_percent": 82.33728813559323}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.534902155115491, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.572940474212485, "policy_loss": -0.005702931098344307, "vf_loss": 9.576950171637156, "vf_explained_var": -0.035286543577436415, "kl": 0.007525399127317125, "entropy": 0.811625939039957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.323884990070232, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.53507186622216, "policy_loss": -0.003598496126055363, "vf_loss": 8.538670367286318, "vf_explained_var": -0.12021199307113728, "kl": 0.007651507509406117, "entropy": 0.742907278089927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 180.81720599831797, "episode_reward_min": -13.303733424687403, "episode_reward_mean": 48.03546003031831, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -254.40363561038671, "predator_policy": 5.660049691481491}, "policy_reward_max": {"prey_policy": 105.31839370015304, "predator_policy": 224.1661740858405}, "policy_reward_mean": {"prey_policy": -82.43890892365704, "predator_policy": 106.4566389388162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.913955855866426, 19.164275525041248, 53.67249885386638, 11.527332177909553, 83.92096728849143, 13.203879954297616, 97.66388704074804, 44.62508580056422, 81.35949393485957, 1.7406716980685706, 15.418710788005102, 67.07187738059407, 31.864076561199568, 49.27368800600809, 16.60668784250043, 63.72522637989798, 6.239522419143117, 60.506732731973564, -13.303733424687403, 32.06966839283194, 44.3116542975373, 20.559251891669533, 24.16522897888287, 5.961225676670219, 42.514832810791184, 40.58225466820943, 79.189738633306, 11.116768682140464, 100.21857329095793, 105.87245171270402, 32.12973016052479, 20.899581785451357, 16.19557409869453, 4.210075925712344, 31.446908995842655, 35.86401223469442, 19.002216868670924, 36.07826113117519, 32.57709467667916, 23.0187897290487, 71.65129151920345, 89.15801298830416, 73.06624255074968, 31.760040592298097, 21.092596406497794, 36.55294363437467, 23.144284477776594, 60.424204126497344, 79.22589309953055, 40.34928311393019, 37.12514404146559, 87.57054677551719, 16.070795937404554, 55.470851628232644, 67.34803534207943, 23.311780532955243, 66.14677407049484, 60.95710778845357, 53.932238180742395, 59.89029005815092, 7.221467998904886, 46.98396174976695, 31.68281974397449, 106.1841625042219, 43.22889934392388, 12.996190691469778, 31.43462353582612, 24.158220019532834, 43.09211826722698, 31.15451437879215, 81.83497168967381, 63.36328966194341, 99.32328033347723, 25.678968573525992, 43.91961852581313, 17.81969262459509, 25.31303771055166, 90.70167306571896, 32.26594211482436, 91.4705433980227, 13.406273112109117, 66.00957859943952, 76.16209740975283, 180.81720599831797, 44.83857735450436, 53.148079343602866, 35.19325032867722, 57.04182112442769, 60.28607798927716, 34.75020446196489, 117.41199116959855, 20.76460084681708, 78.12854289536837, 94.4621851279294, 64.85867624590871, 65.48946375012582, 72.57669790928308, 40.89184963918108, 20.577379554233513, 94.47636591832386], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-55.162263009390216, -39.014377974253264, -97.81944912544057, -88.76628645777232, -76.17834099764795, -78.3723275357778, -43.75812525951531, -39.5174300913072, -126.57887059627687, -17.65985295482901, -70.61363301953696, -85.96551508382854, 3.52055529816678, -79.11060288991447, -17.805332459504612, -14.669644838247258, -60.773271066725925, 21.38301517231093, -95.62377191119691, -48.30802638447986, -61.56186847792543, -60.22738747783968, -22.108700909637772, -63.03150917568933, -68.49032338564936, -40.20058163174838, -37.395621456175384, -33.38915370943435, -16.380876405783052, -43.90410978832763, 12.450475554865804, -24.959553444695356, -100.16496939955961, -111.5528229778091, -44.12880612441687, -147.05093969215903, -114.6284385517966, -98.52217889247653, -88.79465498105306, -38.2961129099854, -197.63979917489425, -90.84145783818032, -76.8174658515117, -89.26393846963146, -78.20053543384854, -132.54251369629176, -58.642644992422206, -67.17757318128453, -72.03950654790711, -63.49513850918139, -47.265931977213334, -48.839791371990934, -54.769441535007296, -65.88398391655876, -123.3146140887974, -96.14904942285332, -130.636697112773, -8.185682594415848, -99.3139377111891, -134.19310901972068, -80.07875668955084, -98.99071049688523, -107.53005184529857, -154.01499699301047, -119.6767146928448, -34.188037847039126, -70.70264914177781, -141.8713540376994, -119.32053832283852, -69.35933064225223, -100.7914819589698, -49.21764115329953, -122.59469610014929, -84.28951211883502, -80.65834158815501, -76.34566409735254, -45.71559603884637, -107.56789199859737, -119.75251688588159, -92.74982862007586, -78.57309585592787, -26.857091742646013, -27.044821216160397, -4.68753113894082, -100.05682972639627, -142.53067479818378, -114.31954335423494, -118.77442479633073, -111.15161989043666, -132.77976548711732, -163.10088890771, -155.56918926591092, -119.86314359154494, -242.7330858502174, -37.42976724739204, -74.12822977259357, -97.91877051819525, -44.255087906002196, -103.26481918077725, -136.69336800740479, -107.14922314507739, -142.4335473580418, -32.520833801772994, -27.007189846104183, -117.08024028517778, -112.95473082655614, -56.96564217959538, -137.3335453899081, -92.07744614343306, -9.820726701693586, -103.02629088185914, -79.99365515121042, -129.58651335037433, -134.62275734219324, -24.355502505670174, -8.035923921541674, -172.3590739377939, -133.83569565096138, -103.20253150771758, -28.33607840712114, -137.05034702869588, -95.454406935323, -186.91028244481353, -96.98039066237698, -122.04822947271494, -132.31929479043376, -50.00337617053003, -10.215725745082235, -44.51025293561632, -93.28100434595896, -92.97543834898097, -92.77159772730414, -82.69155682070026, -102.50815734318395, -103.29977211088395, -96.73753954202786, -117.69095082091206, -104.23986626723196, -128.09582791767474, -123.37749120032795, -26.7872710567133, -75.06304623400175, -139.23997466573164, -58.45658465538177, -64.39323718385519, -254.40363561038671, -43.24195786179917, -38.68708715250698, -76.23408326122963, -89.18764157135575, -104.52431300479344, -96.08359825109468, -57.21311126064764, -81.66545375798322, -106.0297247731616, -95.07734139399983, -73.21754145071459, -59.65897824189841, -11.916050316714626, -47.32776827387808, -55.90754018792349, -150.00566772861552, -75.31115572897932, -100.57472006715234, -62.937897006730275, -63.92455655054757, -77.56117647575203, 105.31839370015304, -139.36853727871656, -108.35114123065352, -129.1499387142431, -87.1531131273296, -112.82781934281262, -31.322926915541093, -107.92971074703814, -40.87692531928737, -96.13483656654516, -68.71412730072878, -83.85540786912664, -84.43813183900458, -96.74292118692448, -9.462501066151738, -151.99293729691135, -115.7830425437994, -99.93824453506843, -54.22880208782291, 4.199566143104373, -92.42487942705918, -98.0878597135431, -69.67795635382768, -86.25476593963626, -80.66278285836876, -72.50162566842408, -111.25931433848609, -45.221557181640954, -37.76790894247133, -100.85928692308003, -133.29838655000574, -96.8137270680536, -48.21630096261789], "policy_predator_policy_reward": [76.32814827083901, 63.76244856867078, 124.82891619572533, 80.92109491252876, 104.35882162452417, 103.86434576276778, 89.14283783725058, 5.660049691481491, 95.76194968707249, 132.39774115252456, 95.32363846692122, 74.45938959074195, 91.96847104250828, 81.28546358998717, 59.50182414316644, 17.598238955149846, 47.62533264505665, 73.12441718421789, 32.32049251225128, 113.35197748149403, 63.40205781199386, 73.8059089317763, 74.1670556045171, 78.04503186140415, 74.00972469259402, 66.54525688600334, 16.204753572262366, 103.85370959935572, 20.493347272917468, 56.39832676369367, 47.091875637644804, 29.142428632082755, 83.64390577834256, 134.3134090181693, 113.78451517697556, 137.9019633715742, 140.1534939747648, 59.693390044820696, 29.105064397497788, 130.0553718863728, 151.26699674024627, 181.52591457036544, 124.57944952588878, 62.06120668692384, 151.87302794958234, 83.03525015944082, 67.28464869740726, 64.49679515296977, 109.76512308024297, 68.28435478763672, 102.5505431778922, 34.13743483952162, 91.94375994231645, 107.89940414255585, 79.48763501934523, 151.092797174446, 106.23012924835201, 132.8108237497946, 175.1641507393974, 164.21534770421655, 83.77259447820244, 127.42660286875845, 91.33069683291134, 191.11393379084893, 56.94319803290803, 113.11712860567043, 119.15227190017293, 97.63180720501668, 91.44921856770094, 128.67755939323237, 122.7559958967911, 63.117139450172616, 81.18082325025061, 144.70560183740466, 96.41170183338633, 96.67056498329647, 53.97803531763267, 131.88254739649028, 88.7434422716549, 146.7776929633511, 95.10502352331925, 81.9764555944582, 41.67281422338676, 79.21755112001863, 135.3826377829709, 180.27110929235852, 153.61429423655017, 111.23971450631385, 167.65887057378282, 97.36511121026862, 185.9407586297948, 169.28226317820074, 173.36905190998917, 212.3714620095498, 116.42957675706336, 55.55262438941966, 141.3096194040981, 80.09013211962973, 128.12012336406065, 152.1873469380517, 158.48343856497343, 128.22447597961138, 95.74116326667354, 51.35740715672069, 128.72899308017475, 117.3767739689637, 110.83067669975031, 138.93936249798585, 64.89120961800899, 104.35499856919706, 69.81470032104185, 136.51702624498282, 137.9524830292948, 192.40356173376773, 43.44381236700897, 49.90472184865647, 181.49713634403585, 178.62987142546166, 72.85422344917025, 118.57467652381952, 119.92382181632227, 119.80240014660141, 169.39146330083446, 161.48317155612284, 114.31701288270293, 171.73333112442023, 83.57761945192863, 82.82564496790556, 70.66470377323716, 110.35545285226218, 122.32907982375967, 76.4141469439952, 136.77325185213385, 79.86108584757629, 119.37044218416048, 104.82508948828418, 107.30159125998327, 157.72134409538774, 142.59283836654524, 140.03499513024946, 78.932051273027, 104.75323770736176, 132.16275825430958, 128.8970907287471, 193.9539790418785, 224.1661740858405, 23.448111727041866, 84.15990186079038, 91.8973998305521, 117.4439435278463, 91.34691356148294, 127.08069031900041, 76.15656403822312, 88.03503869095935, 135.08298712992254, 156.7257521029582, 94.6947198056453, 70.44774200179192, 95.27633371495641, 55.43802827365883, 104.90559069643088, 114.41389033221704, 116.1395123094006, 125.7559420861704, 88.5281713971185, 114.49637956991245, 64.01404293397121, 89.04594583994597, 143.68745290121166, 148.87080296266276, 102.88223094315872, 166.568900242017, 118.4954020983854, 60.84859448864553, 114.65364409451762, 91.19481309623562, 116.21134748459731, 108.92369437195373, 115.02800522910324, 88.01573894099296, 113.21122410630971, 110.40618931636511, 133.41210671449696, 155.1284739730309, 109.60624940792201, 122.6893401103377, 80.05098370931336, 102.6365147025709, 93.46680374167282, 139.15768857160668, 140.13374863778472, 92.2732639103462, 113.61734811319744, 142.7202898029959, 23.321417718608938, 100.55989804468447, 123.3573310721705, 131.37772195514884, 132.01557983987936, 107.49081410911596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1349217344547136, "mean_inference_ms": 3.3849428625762674, "mean_action_processing_ms": 0.4891719450477203, "mean_env_wait_ms": 0.4081527706368285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01443934440612793, "StateBufferConnector_ms": 0.046640753746032715, "ViewRequirementAgentConnector_ms": 0.9872266054153442}, "num_episodes": 23, "episode_return_max": 180.81720599831797, "episode_return_min": -13.303733424687403, "episode_return_mean": 48.03546003031831, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 101.20226281895916, "num_env_steps_trained_throughput_per_sec": 101.20226281895916, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 40674.979, "restore_workers_time_ms": 0.025, "training_step_time_ms": 40674.898, "sample_time_ms": 10404.647, "learn_time_ms": 30209.212, "learn_throughput": 132.41, "synch_weights_time_ms": 55.834}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "ef79f_00000", "date": "2024-08-16_11-39-50", "timestamp": 1723788590, "time_this_iter_s": 39.55750107765198, "time_total_s": 1364.8266582489014, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3217a61f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1364.8266582489014, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 55.405454545454546, "ram_util_percent": 82.22363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5423154398877785, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.17638097490583, "policy_loss": -0.002974354841613344, "vf_loss": 9.17731046323423, "vf_explained_var": 0.07730620516040337, "kl": 0.009088349746451767, "entropy": 0.7722855856494298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.089337190307638, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.107217656241524, "policy_loss": -0.0045574528617271905, "vf_loss": 8.111775099032771, "vf_explained_var": 0.0021264440168148628, "kl": 0.0194136259768966, "entropy": 0.7472990327726596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 297.7350045437911, "episode_reward_min": -13.303733424687403, "episode_reward_mean": 64.09686514052832, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1382.103891533559, "predator_policy": 23.321417718608938}, "policy_reward_max": {"prey_policy": 110.19784303588048, "predator_policy": 1406.0150306809446}, "policy_reward_mean": {"prey_policy": -91.03671856631561, "predator_policy": 123.08515113657977}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.303733424687403, 32.06966839283194, 44.3116542975373, 20.559251891669533, 24.16522897888287, 5.961225676670219, 42.514832810791184, 40.58225466820943, 79.189738633306, 11.116768682140464, 100.21857329095793, 105.87245171270402, 32.12973016052479, 20.899581785451357, 16.19557409869453, 4.210075925712344, 31.446908995842655, 35.86401223469442, 19.002216868670924, 36.07826113117519, 32.57709467667916, 23.0187897290487, 71.65129151920345, 89.15801298830416, 73.06624255074968, 31.760040592298097, 21.092596406497794, 36.55294363437467, 23.144284477776594, 60.424204126497344, 79.22589309953055, 40.34928311393019, 37.12514404146559, 87.57054677551719, 16.070795937404554, 55.470851628232644, 67.34803534207943, 23.311780532955243, 66.14677407049484, 60.95710778845357, 53.932238180742395, 59.89029005815092, 7.221467998904886, 46.98396174976695, 31.68281974397449, 106.1841625042219, 43.22889934392388, 12.996190691469778, 31.43462353582612, 24.158220019532834, 43.09211826722698, 31.15451437879215, 81.83497168967381, 63.36328966194341, 99.32328033347723, 25.678968573525992, 43.91961852581313, 17.81969262459509, 25.31303771055166, 90.70167306571896, 32.26594211482436, 91.4705433980227, 13.406273112109117, 66.00957859943952, 76.16209740975283, 180.81720599831797, 44.83857735450436, 53.148079343602866, 35.19325032867722, 57.04182112442769, 60.28607798927716, 34.75020446196489, 117.41199116959855, 20.76460084681708, 78.12854289536837, 94.4621851279294, 64.85867624590871, 65.48946375012582, 72.57669790928308, 40.89184963918108, 20.577379554233513, 94.47636591832386, 88.8324451732957, 101.24124309785657, 68.97526565660476, 188.0571698976512, 76.58670749807712, 207.4303640976643, 84.20643373942946, 221.37991949350112, 297.7350045437911, 136.1978787420245, 34.01320092089387, 185.17794180714662, 22.80213773775409, 176.5967897703734, 120.46151769319948, 200.35977726070232, 43.08425616736953, 116.50102796270056], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-114.6284385517966, -98.52217889247653, -88.79465498105306, -38.2961129099854, -197.63979917489425, -90.84145783818032, -76.8174658515117, -89.26393846963146, -78.20053543384854, -132.54251369629176, -58.642644992422206, -67.17757318128453, -72.03950654790711, -63.49513850918139, -47.265931977213334, -48.839791371990934, -54.769441535007296, -65.88398391655876, -123.3146140887974, -96.14904942285332, -130.636697112773, -8.185682594415848, -99.3139377111891, -134.19310901972068, -80.07875668955084, -98.99071049688523, -107.53005184529857, -154.01499699301047, -119.6767146928448, -34.188037847039126, -70.70264914177781, -141.8713540376994, -119.32053832283852, -69.35933064225223, -100.7914819589698, -49.21764115329953, -122.59469610014929, -84.28951211883502, -80.65834158815501, -76.34566409735254, -45.71559603884637, -107.56789199859737, -119.75251688588159, -92.74982862007586, -78.57309585592787, -26.857091742646013, -27.044821216160397, -4.68753113894082, -100.05682972639627, -142.53067479818378, -114.31954335423494, -118.77442479633073, -111.15161989043666, -132.77976548711732, -163.10088890771, -155.56918926591092, -119.86314359154494, -242.7330858502174, -37.42976724739204, -74.12822977259357, -97.91877051819525, -44.255087906002196, -103.26481918077725, -136.69336800740479, -107.14922314507739, -142.4335473580418, -32.520833801772994, -27.007189846104183, -117.08024028517778, -112.95473082655614, -56.96564217959538, -137.3335453899081, -92.07744614343306, -9.820726701693586, -103.02629088185914, -79.99365515121042, -129.58651335037433, -134.62275734219324, -24.355502505670174, -8.035923921541674, -172.3590739377939, -133.83569565096138, -103.20253150771758, -28.33607840712114, -137.05034702869588, -95.454406935323, -186.91028244481353, -96.98039066237698, -122.04822947271494, -132.31929479043376, -50.00337617053003, -10.215725745082235, -44.51025293561632, -93.28100434595896, -92.97543834898097, -92.77159772730414, -82.69155682070026, -102.50815734318395, -103.29977211088395, -96.73753954202786, -117.69095082091206, -104.23986626723196, -128.09582791767474, -123.37749120032795, -26.7872710567133, -75.06304623400175, -139.23997466573164, -58.45658465538177, -64.39323718385519, -254.40363561038671, -43.24195786179917, -38.68708715250698, -76.23408326122963, -89.18764157135575, -104.52431300479344, -96.08359825109468, -57.21311126064764, -81.66545375798322, -106.0297247731616, -95.07734139399983, -73.21754145071459, -59.65897824189841, -11.916050316714626, -47.32776827387808, -55.90754018792349, -150.00566772861552, -75.31115572897932, -100.57472006715234, -62.937897006730275, -63.92455655054757, -77.56117647575203, 105.31839370015304, -139.36853727871656, -108.35114123065352, -129.1499387142431, -87.1531131273296, -112.82781934281262, -31.322926915541093, -107.92971074703814, -40.87692531928737, -96.13483656654516, -68.71412730072878, -83.85540786912664, -84.43813183900458, -96.74292118692448, -9.462501066151738, -151.99293729691135, -115.7830425437994, -99.93824453506843, -54.22880208782291, 4.199566143104373, -92.42487942705918, -98.0878597135431, -69.67795635382768, -86.25476593963626, -80.66278285836876, -72.50162566842408, -111.25931433848609, -45.221557181640954, -37.76790894247133, -100.85928692308003, -133.29838655000574, -96.8137270680536, -48.21630096261789, -445.6734805896816, -73.56981315019459, -9.812846835187369, -60.90843087391217, -89.5926542689409, -71.12249715585811, 66.7204896803923, -45.8051432544566, -172.8654108364673, -84.8540211272462, -92.92518460422666, 84.64641519241383, -144.8643481877366, -79.51679176870807, 19.13732001428946, 83.25065335080845, -218.17966737715017, 68.3056494003707, -127.0266170914184, 50.82170878422322, -91.10918659789414, -355.4654166667664, -106.13368788778604, 110.19784303588048, -85.4263640850912, -111.63121632993916, -1382.103891533559, 108.73293099418804, -19.015712774107797, -59.840102782762365, 104.54988699875175, -114.82088893468153, -109.17561371275983, -77.01482216011028, 7.369306969329068, -167.73062205287368], "policy_predator_policy_reward": [140.1534939747648, 59.693390044820696, 29.105064397497788, 130.0553718863728, 151.26699674024627, 181.52591457036544, 124.57944952588878, 62.06120668692384, 151.87302794958234, 83.03525015944082, 67.28464869740726, 64.49679515296977, 109.76512308024297, 68.28435478763672, 102.5505431778922, 34.13743483952162, 91.94375994231645, 107.89940414255585, 79.48763501934523, 151.092797174446, 106.23012924835201, 132.8108237497946, 175.1641507393974, 164.21534770421655, 83.77259447820244, 127.42660286875845, 91.33069683291134, 191.11393379084893, 56.94319803290803, 113.11712860567043, 119.15227190017293, 97.63180720501668, 91.44921856770094, 128.67755939323237, 122.7559958967911, 63.117139450172616, 81.18082325025061, 144.70560183740466, 96.41170183338633, 96.67056498329647, 53.97803531763267, 131.88254739649028, 88.7434422716549, 146.7776929633511, 95.10502352331925, 81.9764555944582, 41.67281422338676, 79.21755112001863, 135.3826377829709, 180.27110929235852, 153.61429423655017, 111.23971450631385, 167.65887057378282, 97.36511121026862, 185.9407586297948, 169.28226317820074, 173.36905190998917, 212.3714620095498, 116.42957675706336, 55.55262438941966, 141.3096194040981, 80.09013211962973, 128.12012336406065, 152.1873469380517, 158.48343856497343, 128.22447597961138, 95.74116326667354, 51.35740715672069, 128.72899308017475, 117.3767739689637, 110.83067669975031, 138.93936249798585, 64.89120961800899, 104.35499856919706, 69.81470032104185, 136.51702624498282, 137.9524830292948, 192.40356173376773, 43.44381236700897, 49.90472184865647, 181.49713634403585, 178.62987142546166, 72.85422344917025, 118.57467652381952, 119.92382181632227, 119.80240014660141, 169.39146330083446, 161.48317155612284, 114.31701288270293, 171.73333112442023, 83.57761945192863, 82.82564496790556, 70.66470377323716, 110.35545285226218, 122.32907982375967, 76.4141469439952, 136.77325185213385, 79.86108584757629, 119.37044218416048, 104.82508948828418, 107.30159125998327, 157.72134409538774, 142.59283836654524, 140.03499513024946, 78.932051273027, 104.75323770736176, 132.16275825430958, 128.8970907287471, 193.9539790418785, 224.1661740858405, 23.448111727041866, 84.15990186079038, 91.8973998305521, 117.4439435278463, 91.34691356148294, 127.08069031900041, 76.15656403822312, 88.03503869095935, 135.08298712992254, 156.7257521029582, 94.6947198056453, 70.44774200179192, 95.27633371495641, 55.43802827365883, 104.90559069643088, 114.41389033221704, 116.1395123094006, 125.7559420861704, 88.5281713971185, 114.49637956991245, 64.01404293397121, 89.04594583994597, 143.68745290121166, 148.87080296266276, 102.88223094315872, 166.568900242017, 118.4954020983854, 60.84859448864553, 114.65364409451762, 91.19481309623562, 116.21134748459731, 108.92369437195373, 115.02800522910324, 88.01573894099296, 113.21122410630971, 110.40618931636511, 133.41210671449696, 155.1284739730309, 109.60624940792201, 122.6893401103377, 80.05098370931336, 102.6365147025709, 93.46680374167282, 139.15768857160668, 140.13374863778472, 92.2732639103462, 113.61734811319744, 142.7202898029959, 23.321417718608938, 100.55989804468447, 123.3573310721705, 131.37772195514884, 132.01557983987936, 107.49081410911596, 223.99853262660457, 384.07720628656733, 93.01519903905408, 78.94732176790183, 123.22175017532588, 106.46866690607773, 60.64724808652715, 106.49457538518854, 188.2139137032976, 146.09222575849302, 118.73486471034185, 96.9742687991354, 190.1736770693444, 118.41389662652962, 88.20737142301783, 30.784574705385328, 216.98090998899593, 230.62811253157503, 101.65120990632269, 110.7515771428968, 270.0000898176847, 210.58771436786964, 94.98308286592142, 86.13070379313089, 80.32450169236469, 139.53521646041978, 1406.0150306809446, 43.95271962879949, 82.79924520089294, 116.51808804917664, 89.01886715423386, 121.61191204239849, 94.29502680469865, 134.97966523554106, 157.12201783606338, 119.74032521018188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.173816233864578, "mean_inference_ms": 3.490188079801223, "mean_action_processing_ms": 0.507575423804424, "mean_env_wait_ms": 0.42233604437378275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014455795288085938, "StateBufferConnector_ms": 0.04810631275177002, "ViewRequirementAgentConnector_ms": 1.0227820873260498}, "num_episodes": 18, "episode_return_max": 297.7350045437911, "episode_return_min": -13.303733424687403, "episode_return_mean": 64.09686514052832, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.42577312441088, "num_env_steps_trained_throughput_per_sec": 106.42577312441088, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 40052.403, "restore_workers_time_ms": 0.025, "training_step_time_ms": 40052.322, "sample_time_ms": 10358.737, "learn_time_ms": 29641.609, "learn_throughput": 134.945, "synch_weights_time_ms": 48.456}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "ef79f_00000", "date": "2024-08-16_11-40-28", "timestamp": 1723788628, "time_this_iter_s": 37.667670011520386, "time_total_s": 1402.4943282604218, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3217904c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1402.4943282604218, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 54.179245283018865, "ram_util_percent": 81.58490566037737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5219061749637444, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.94525039259088, "policy_loss": -0.008037065926485907, "vf_loss": 8.950962732204054, "vf_explained_var": 0.3426638618348137, "kl": 0.01033216969943881, "entropy": 0.7548272437834865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.3542583432147115, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.37130486019074, "policy_loss": -0.0012752225365065945, "vf_loss": 8.372580083463557, "vf_explained_var": 0.009823175429036378, "kl": 0.01048101200187959, "entropy": 0.651858159505501, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 297.7350045437911, "episode_reward_min": 7.221467998904886, "episode_reward_mean": 95.48273453408292, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1382.103891533559, "predator_policy": 3.0312985085461954}, "policy_reward_max": {"prey_policy": 180.8734364444287, "predator_policy": 1406.0150306809446}, "policy_reward_mean": {"prey_policy": -70.73943457497995, "predator_policy": 118.4808018420214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.65129151920345, 89.15801298830416, 73.06624255074968, 31.760040592298097, 21.092596406497794, 36.55294363437467, 23.144284477776594, 60.424204126497344, 79.22589309953055, 40.34928311393019, 37.12514404146559, 87.57054677551719, 16.070795937404554, 55.470851628232644, 67.34803534207943, 23.311780532955243, 66.14677407049484, 60.95710778845357, 53.932238180742395, 59.89029005815092, 7.221467998904886, 46.98396174976695, 31.68281974397449, 106.1841625042219, 43.22889934392388, 12.996190691469778, 31.43462353582612, 24.158220019532834, 43.09211826722698, 31.15451437879215, 81.83497168967381, 63.36328966194341, 99.32328033347723, 25.678968573525992, 43.91961852581313, 17.81969262459509, 25.31303771055166, 90.70167306571896, 32.26594211482436, 91.4705433980227, 13.406273112109117, 66.00957859943952, 76.16209740975283, 180.81720599831797, 44.83857735450436, 53.148079343602866, 35.19325032867722, 57.04182112442769, 60.28607798927716, 34.75020446196489, 117.41199116959855, 20.76460084681708, 78.12854289536837, 94.4621851279294, 64.85867624590871, 65.48946375012582, 72.57669790928308, 40.89184963918108, 20.577379554233513, 94.47636591832386, 88.8324451732957, 101.24124309785657, 68.97526565660476, 188.0571698976512, 76.58670749807712, 207.4303640976643, 84.20643373942946, 221.37991949350112, 297.7350045437911, 136.1978787420245, 34.01320092089387, 185.17794180714662, 22.80213773775409, 176.5967897703734, 120.46151769319948, 200.35977726070232, 43.08425616736953, 116.50102796270056, 113.52374112383458, 52.284162071704, 73.19176317804464, 153.2111257176616, 213.14929972258074, 158.08870419730465, 156.62168797812853, 250.57164835698393, 161.04589045315913, 244.24080440649337, 254.78862504157402, 77.03975374289324, 201.6550000262934, 227.536445496069, 180.30023316976164, 106.26260635777851, 250.8500520555337, 284.32176784457164, 164.60839672240525, 187.50832311693856, 221.36545919030186, 151.10161060295042], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-78.57309585592787, -26.857091742646013, -27.044821216160397, -4.68753113894082, -100.05682972639627, -142.53067479818378, -114.31954335423494, -118.77442479633073, -111.15161989043666, -132.77976548711732, -163.10088890771, -155.56918926591092, -119.86314359154494, -242.7330858502174, -37.42976724739204, -74.12822977259357, -97.91877051819525, -44.255087906002196, -103.26481918077725, -136.69336800740479, -107.14922314507739, -142.4335473580418, -32.520833801772994, -27.007189846104183, -117.08024028517778, -112.95473082655614, -56.96564217959538, -137.3335453899081, -92.07744614343306, -9.820726701693586, -103.02629088185914, -79.99365515121042, -129.58651335037433, -134.62275734219324, -24.355502505670174, -8.035923921541674, -172.3590739377939, -133.83569565096138, -103.20253150771758, -28.33607840712114, -137.05034702869588, -95.454406935323, -186.91028244481353, -96.98039066237698, -122.04822947271494, -132.31929479043376, -50.00337617053003, -10.215725745082235, -44.51025293561632, -93.28100434595896, -92.97543834898097, -92.77159772730414, -82.69155682070026, -102.50815734318395, -103.29977211088395, -96.73753954202786, -117.69095082091206, -104.23986626723196, -128.09582791767474, -123.37749120032795, -26.7872710567133, -75.06304623400175, -139.23997466573164, -58.45658465538177, -64.39323718385519, -254.40363561038671, -43.24195786179917, -38.68708715250698, -76.23408326122963, -89.18764157135575, -104.52431300479344, -96.08359825109468, -57.21311126064764, -81.66545375798322, -106.0297247731616, -95.07734139399983, -73.21754145071459, -59.65897824189841, -11.916050316714626, -47.32776827387808, -55.90754018792349, -150.00566772861552, -75.31115572897932, -100.57472006715234, -62.937897006730275, -63.92455655054757, -77.56117647575203, 105.31839370015304, -139.36853727871656, -108.35114123065352, -129.1499387142431, -87.1531131273296, -112.82781934281262, -31.322926915541093, -107.92971074703814, -40.87692531928737, -96.13483656654516, -68.71412730072878, -83.85540786912664, -84.43813183900458, -96.74292118692448, -9.462501066151738, -151.99293729691135, -115.7830425437994, -99.93824453506843, -54.22880208782291, 4.199566143104373, -92.42487942705918, -98.0878597135431, -69.67795635382768, -86.25476593963626, -80.66278285836876, -72.50162566842408, -111.25931433848609, -45.221557181640954, -37.76790894247133, -100.85928692308003, -133.29838655000574, -96.8137270680536, -48.21630096261789, -445.6734805896816, -73.56981315019459, -9.812846835187369, -60.90843087391217, -89.5926542689409, -71.12249715585811, 66.7204896803923, -45.8051432544566, -172.8654108364673, -84.8540211272462, -92.92518460422666, 84.64641519241383, -144.8643481877366, -79.51679176870807, 19.13732001428946, 83.25065335080845, -218.17966737715017, 68.3056494003707, -127.0266170914184, 50.82170878422322, -91.10918659789414, -355.4654166667664, -106.13368788778604, 110.19784303588048, -85.4263640850912, -111.63121632993916, -1382.103891533559, 108.73293099418804, -19.015712774107797, -59.840102782762365, 104.54988699875175, -114.82088893468153, -109.17561371275983, -77.01482216011028, 7.369306969329068, -167.73062205287368, -83.58352360135144, 9.614616760507403, -159.50485871972396, -67.59468106109726, -76.13981800899647, -125.17444545275804, -118.44524995469109, 74.16301164034921, 79.68650857511612, 37.040111818313214, 4.8879393542623015, -44.12746006518323, -108.71983723198422, 56.11908832244679, 157.48425044945859, -81.37032169325663, 13.217124026193524, 20.38212248262538, 14.028498993581644, 67.35432215413782, 109.97143237344844, 31.473354771097693, -169.780463851233, -38.20124887991828, 91.9768736738519, 46.120732403682524, 50.052740138774865, 92.13704711777649, -35.32138520805086, 62.15541547370789, -72.3863798782271, -83.53105640111536, 125.01964024509975, -40.11172154760088, 88.17496310181764, -0.014574857405463604, 19.32697098164536, -122.33752796231028, 0.4759381014383432, 180.8734364444287, 59.485388114100346, 59.98677545474678, -7.316278369359999, -8.961181011557134], "policy_predator_policy_reward": [95.10502352331925, 81.9764555944582, 41.67281422338676, 79.21755112001863, 135.3826377829709, 180.27110929235852, 153.61429423655017, 111.23971450631385, 167.65887057378282, 97.36511121026862, 185.9407586297948, 169.28226317820074, 173.36905190998917, 212.3714620095498, 116.42957675706336, 55.55262438941966, 141.3096194040981, 80.09013211962973, 128.12012336406065, 152.1873469380517, 158.48343856497343, 128.22447597961138, 95.74116326667354, 51.35740715672069, 128.72899308017475, 117.3767739689637, 110.83067669975031, 138.93936249798585, 64.89120961800899, 104.35499856919706, 69.81470032104185, 136.51702624498282, 137.9524830292948, 192.40356173376773, 43.44381236700897, 49.90472184865647, 181.49713634403585, 178.62987142546166, 72.85422344917025, 118.57467652381952, 119.92382181632227, 119.80240014660141, 169.39146330083446, 161.48317155612284, 114.31701288270293, 171.73333112442023, 83.57761945192863, 82.82564496790556, 70.66470377323716, 110.35545285226218, 122.32907982375967, 76.4141469439952, 136.77325185213385, 79.86108584757629, 119.37044218416048, 104.82508948828418, 107.30159125998327, 157.72134409538774, 142.59283836654524, 140.03499513024946, 78.932051273027, 104.75323770736176, 132.16275825430958, 128.8970907287471, 193.9539790418785, 224.1661740858405, 23.448111727041866, 84.15990186079038, 91.8973998305521, 117.4439435278463, 91.34691356148294, 127.08069031900041, 76.15656403822312, 88.03503869095935, 135.08298712992254, 156.7257521029582, 94.6947198056453, 70.44774200179192, 95.27633371495641, 55.43802827365883, 104.90559069643088, 114.41389033221704, 116.1395123094006, 125.7559420861704, 88.5281713971185, 114.49637956991245, 64.01404293397121, 89.04594583994597, 143.68745290121166, 148.87080296266276, 102.88223094315872, 166.568900242017, 118.4954020983854, 60.84859448864553, 114.65364409451762, 91.19481309623562, 116.21134748459731, 108.92369437195373, 115.02800522910324, 88.01573894099296, 113.21122410630971, 110.40618931636511, 133.41210671449696, 155.1284739730309, 109.60624940792201, 122.6893401103377, 80.05098370931336, 102.6365147025709, 93.46680374167282, 139.15768857160668, 140.13374863778472, 92.2732639103462, 113.61734811319744, 142.7202898029959, 23.321417718608938, 100.55989804468447, 123.3573310721705, 131.37772195514884, 132.01557983987936, 107.49081410911596, 223.99853262660457, 384.07720628656733, 93.01519903905408, 78.94732176790183, 123.22175017532588, 106.46866690607773, 60.64724808652715, 106.49457538518854, 188.2139137032976, 146.09222575849302, 118.73486471034185, 96.9742687991354, 190.1736770693444, 118.41389662652962, 88.20737142301783, 30.784574705385328, 216.98090998899593, 230.62811253157503, 101.65120990632269, 110.7515771428968, 270.0000898176847, 210.58771436786964, 94.98308286592142, 86.13070379313089, 80.32450169236469, 139.53521646041978, 1406.0150306809446, 43.95271962879949, 82.79924520089294, 116.51808804917664, 89.01886715423386, 121.61191204239849, 94.29502680469865, 134.97966523554106, 157.12201783606338, 119.74032521018188, 92.02490061084906, 95.46774735382938, 75.42798197648591, 203.95571987603935, 144.60638581201076, 129.89964082778846, 81.45975216749889, 116.03361186450442, 46.377874454585545, 50.04480487456583, 89.26538876973706, 108.06283613848818, 106.86311395982942, 102.35932292783646, 92.26937593964333, 82.18834366113867, 28.59764214246644, 98.84900180187375, 90.87806264785887, 71.97992061091489, 56.610407165581016, 56.7334307314468, 227.92220649057853, 57.099259983466105, 23.126997657983438, 40.4303962907755, 46.65340192854789, 38.69325631097, 80.43953549761056, 73.02666740649397, 129.25366482424056, 132.92637781288045, 93.48703777870813, 72.45509557932664, 94.09371113440291, 102.06766846575653, 133.42454382452686, 134.19440987854344, 3.12765006252551, 3.0312985085461954, 18.624528043538348, 83.26876757791642, 92.47393733530032, 74.90513264856723]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.216098402365071, "mean_inference_ms": 3.6059295452751234, "mean_action_processing_ms": 0.5277908274413283, "mean_env_wait_ms": 0.43787501295231224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02642691135406494, "StateBufferConnector_ms": 0.047818779945373535, "ViewRequirementAgentConnector_ms": 0.8890107870101929}, "num_episodes": 22, "episode_return_max": 297.7350045437911, "episode_return_min": 7.221467998904886, "episode_return_mean": 95.48273453408292, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 98.75434449950386, "num_env_steps_trained_throughput_per_sec": 98.75434449950386, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 40135.516, "restore_workers_time_ms": 0.024, "training_step_time_ms": 40135.438, "sample_time_ms": 10353.325, "learn_time_ms": 29735.979, "learn_throughput": 134.517, "synch_weights_time_ms": 42.692}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "ef79f_00000", "date": "2024-08-16_11-41-09", "timestamp": 1723788669, "time_this_iter_s": 40.573020935058594, "time_total_s": 1443.0673491954803, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321793280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1443.0673491954803, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 54.71228070175439, "ram_util_percent": 81.97719298245613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.301644272526736, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.268795338383427, "policy_loss": -0.002063523860717261, "vf_loss": 8.2687445590105, "vf_explained_var": 0.42047896435651827, "kl": 0.009396857349592894, "entropy": 0.7601655291817175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.178894985226727, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.401507024159507, "policy_loss": -0.0030373196791433706, "vf_loss": 8.404544353737402, "vf_explained_var": -0.16839642963081441, "kl": 0.006509081011956859, "entropy": 0.6389934970903649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 310.40115232506497, "episode_reward_min": 7.221467998904886, "episode_reward_mean": 126.09980376113543, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1382.103891533559, "predator_policy": 3.0312985085461954}, "policy_reward_max": {"prey_policy": 180.8734364444287, "predator_policy": 1406.0150306809446}, "policy_reward_mean": {"prey_policy": -46.726546606843215, "predator_policy": 109.77644848741093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.932238180742395, 59.89029005815092, 7.221467998904886, 46.98396174976695, 31.68281974397449, 106.1841625042219, 43.22889934392388, 12.996190691469778, 31.43462353582612, 24.158220019532834, 43.09211826722698, 31.15451437879215, 81.83497168967381, 63.36328966194341, 99.32328033347723, 25.678968573525992, 43.91961852581313, 17.81969262459509, 25.31303771055166, 90.70167306571896, 32.26594211482436, 91.4705433980227, 13.406273112109117, 66.00957859943952, 76.16209740975283, 180.81720599831797, 44.83857735450436, 53.148079343602866, 35.19325032867722, 57.04182112442769, 60.28607798927716, 34.75020446196489, 117.41199116959855, 20.76460084681708, 78.12854289536837, 94.4621851279294, 64.85867624590871, 65.48946375012582, 72.57669790928308, 40.89184963918108, 20.577379554233513, 94.47636591832386, 88.8324451732957, 101.24124309785657, 68.97526565660476, 188.0571698976512, 76.58670749807712, 207.4303640976643, 84.20643373942946, 221.37991949350112, 297.7350045437911, 136.1978787420245, 34.01320092089387, 185.17794180714662, 22.80213773775409, 176.5967897703734, 120.46151769319948, 200.35977726070232, 43.08425616736953, 116.50102796270056, 113.52374112383458, 52.284162071704, 73.19176317804464, 153.2111257176616, 213.14929972258074, 158.08870419730465, 156.62168797812853, 250.57164835698393, 161.04589045315913, 244.24080440649337, 254.78862504157402, 77.03975374289324, 201.6550000262934, 227.536445496069, 180.30023316976164, 106.26260635777851, 250.8500520555337, 284.32176784457164, 164.60839672240525, 187.50832311693856, 221.36545919030186, 151.10161060295042, 302.68178992953733, 248.19909281497254, 226.3512224922115, 229.09413776678724, 310.40115232506497, 222.737702400832, 219.06179335540196, 247.03591818265303, 86.41612755852417, 228.14446889185098, 85.27878434635744, 241.38986804914828, 261.45105260827444, 286.7484503723662, 188.54786177871873, 174.90077911019125, 195.52307144638084, 248.16947790174532], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-172.3590739377939, -133.83569565096138, -103.20253150771758, -28.33607840712114, -137.05034702869588, -95.454406935323, -186.91028244481353, -96.98039066237698, -122.04822947271494, -132.31929479043376, -50.00337617053003, -10.215725745082235, -44.51025293561632, -93.28100434595896, -92.97543834898097, -92.77159772730414, -82.69155682070026, -102.50815734318395, -103.29977211088395, -96.73753954202786, -117.69095082091206, -104.23986626723196, -128.09582791767474, -123.37749120032795, -26.7872710567133, -75.06304623400175, -139.23997466573164, -58.45658465538177, -64.39323718385519, -254.40363561038671, -43.24195786179917, -38.68708715250698, -76.23408326122963, -89.18764157135575, -104.52431300479344, -96.08359825109468, -57.21311126064764, -81.66545375798322, -106.0297247731616, -95.07734139399983, -73.21754145071459, -59.65897824189841, -11.916050316714626, -47.32776827387808, -55.90754018792349, -150.00566772861552, -75.31115572897932, -100.57472006715234, -62.937897006730275, -63.92455655054757, -77.56117647575203, 105.31839370015304, -139.36853727871656, -108.35114123065352, -129.1499387142431, -87.1531131273296, -112.82781934281262, -31.322926915541093, -107.92971074703814, -40.87692531928737, -96.13483656654516, -68.71412730072878, -83.85540786912664, -84.43813183900458, -96.74292118692448, -9.462501066151738, -151.99293729691135, -115.7830425437994, -99.93824453506843, -54.22880208782291, 4.199566143104373, -92.42487942705918, -98.0878597135431, -69.67795635382768, -86.25476593963626, -80.66278285836876, -72.50162566842408, -111.25931433848609, -45.221557181640954, -37.76790894247133, -100.85928692308003, -133.29838655000574, -96.8137270680536, -48.21630096261789, -445.6734805896816, -73.56981315019459, -9.812846835187369, -60.90843087391217, -89.5926542689409, -71.12249715585811, 66.7204896803923, -45.8051432544566, -172.8654108364673, -84.8540211272462, -92.92518460422666, 84.64641519241383, -144.8643481877366, -79.51679176870807, 19.13732001428946, 83.25065335080845, -218.17966737715017, 68.3056494003707, -127.0266170914184, 50.82170878422322, -91.10918659789414, -355.4654166667664, -106.13368788778604, 110.19784303588048, -85.4263640850912, -111.63121632993916, -1382.103891533559, 108.73293099418804, -19.015712774107797, -59.840102782762365, 104.54988699875175, -114.82088893468153, -109.17561371275983, -77.01482216011028, 7.369306969329068, -167.73062205287368, -83.58352360135144, 9.614616760507403, -159.50485871972396, -67.59468106109726, -76.13981800899647, -125.17444545275804, -118.44524995469109, 74.16301164034921, 79.68650857511612, 37.040111818313214, 4.8879393542623015, -44.12746006518323, -108.71983723198422, 56.11908832244679, 157.48425044945859, -81.37032169325663, 13.217124026193524, 20.38212248262538, 14.028498993581644, 67.35432215413782, 109.97143237344844, 31.473354771097693, -169.780463851233, -38.20124887991828, 91.9768736738519, 46.120732403682524, 50.052740138774865, 92.13704711777649, -35.32138520805086, 62.15541547370789, -72.3863798782271, -83.53105640111536, 125.01964024509975, -40.11172154760088, 88.17496310181764, -0.014574857405463604, 19.32697098164536, -122.33752796231028, 0.4759381014383432, 180.8734364444287, 59.485388114100346, 59.98677545474678, -7.316278369359999, -8.961181011557134, 116.34713349071663, 132.83406541131887, 39.625385172586704, 56.70555338808511, 87.10708568879984, 49.7543211548873, 29.123964517732198, 71.71369720412096, 145.5201460759443, 111.83408042931308, 86.59617275460337, -8.994538134876507, 80.41985465257571, 77.85765086596246, -42.31566247762788, 125.2647373200983, -41.342169402661405, -257.3749518917033, 43.49240349909806, 86.00561359286448, -168.1037293739361, -31.926599812213013, 7.09321728493164, 91.1788914097238, 115.34957760187129, 49.79969546129862, 53.61810218776981, 176.85910219530433, 99.36591387812618, -77.26767057761168, -74.8899796169193, 30.360245529892012, -5.90815233669865, 59.3569565773698, -16.254543665555033, 157.07650648782538], "policy_predator_policy_reward": [181.49713634403585, 178.62987142546166, 72.85422344917025, 118.57467652381952, 119.92382181632227, 119.80240014660141, 169.39146330083446, 161.48317155612284, 114.31701288270293, 171.73333112442023, 83.57761945192863, 82.82564496790556, 70.66470377323716, 110.35545285226218, 122.32907982375967, 76.4141469439952, 136.77325185213385, 79.86108584757629, 119.37044218416048, 104.82508948828418, 107.30159125998327, 157.72134409538774, 142.59283836654524, 140.03499513024946, 78.932051273027, 104.75323770736176, 132.16275825430958, 128.8970907287471, 193.9539790418785, 224.1661740858405, 23.448111727041866, 84.15990186079038, 91.8973998305521, 117.4439435278463, 91.34691356148294, 127.08069031900041, 76.15656403822312, 88.03503869095935, 135.08298712992254, 156.7257521029582, 94.6947198056453, 70.44774200179192, 95.27633371495641, 55.43802827365883, 104.90559069643088, 114.41389033221704, 116.1395123094006, 125.7559420861704, 88.5281713971185, 114.49637956991245, 64.01404293397121, 89.04594583994597, 143.68745290121166, 148.87080296266276, 102.88223094315872, 166.568900242017, 118.4954020983854, 60.84859448864553, 114.65364409451762, 91.19481309623562, 116.21134748459731, 108.92369437195373, 115.02800522910324, 88.01573894099296, 113.21122410630971, 110.40618931636511, 133.41210671449696, 155.1284739730309, 109.60624940792201, 122.6893401103377, 80.05098370931336, 102.6365147025709, 93.46680374167282, 139.15768857160668, 140.13374863778472, 92.2732639103462, 113.61734811319744, 142.7202898029959, 23.321417718608938, 100.55989804468447, 123.3573310721705, 131.37772195514884, 132.01557983987936, 107.49081410911596, 223.99853262660457, 384.07720628656733, 93.01519903905408, 78.94732176790183, 123.22175017532588, 106.46866690607773, 60.64724808652715, 106.49457538518854, 188.2139137032976, 146.09222575849302, 118.73486471034185, 96.9742687991354, 190.1736770693444, 118.41389662652962, 88.20737142301783, 30.784574705385328, 216.98090998899593, 230.62811253157503, 101.65120990632269, 110.7515771428968, 270.0000898176847, 210.58771436786964, 94.98308286592142, 86.13070379313089, 80.32450169236469, 139.53521646041978, 1406.0150306809446, 43.95271962879949, 82.79924520089294, 116.51808804917664, 89.01886715423386, 121.61191204239849, 94.29502680469865, 134.97966523554106, 157.12201783606338, 119.74032521018188, 92.02490061084906, 95.46774735382938, 75.42798197648591, 203.95571987603935, 144.60638581201076, 129.89964082778846, 81.45975216749889, 116.03361186450442, 46.377874454585545, 50.04480487456583, 89.26538876973706, 108.06283613848818, 106.86311395982942, 102.35932292783646, 92.26937593964333, 82.18834366113867, 28.59764214246644, 98.84900180187375, 90.87806264785887, 71.97992061091489, 56.610407165581016, 56.7334307314468, 227.92220649057853, 57.099259983466105, 23.126997657983438, 40.4303962907755, 46.65340192854789, 38.69325631097, 80.43953549761056, 73.02666740649397, 129.25366482424056, 132.92637781288045, 93.48703777870813, 72.45509557932664, 94.09371113440291, 102.06766846575653, 133.42454382452686, 134.19440987854344, 3.12765006252551, 3.0312985085461954, 18.624528043538348, 83.26876757791642, 92.47393733530032, 74.90513264856723, 23.704896176774, 29.795694850727823, 82.43056746411237, 69.43758679018838, 43.89574311973695, 45.594072528787386, 51.179308058344866, 77.07716798658919, 14.977825363959957, 38.069100455847746, 73.35187517151842, 71.78419260958665, 51.81095188668311, 8.973335950180775, 73.0508850895036, 91.03595825067923, 285.38930615996435, 99.74394269292439, 61.77783142882362, 36.86862037106488, 128.81790392142676, 156.49120961107954, 76.69851712704035, 66.41924222745249, 46.93746427831415, 49.364315266790314, 28.416460260802754, 27.85478572848909, 90.05406446453833, 76.39555401366611, 116.59033701903503, 102.8401761781836, 64.81951067089042, 77.25475653481935, 87.0541100385229, 20.29340504095205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2441184896503168, "mean_inference_ms": 3.6802690354983385, "mean_action_processing_ms": 0.5407935389767654, "mean_env_wait_ms": 0.4484905892532584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02625882625579834, "StateBufferConnector_ms": 0.027806639671325684, "ViewRequirementAgentConnector_ms": 0.7294340133666992}, "num_episodes": 18, "episode_return_max": 310.40115232506497, "episode_return_min": 7.221467998904886, "episode_return_mean": 126.09980376113543, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 99.41086680283239, "num_env_steps_trained_throughput_per_sec": 99.41086680283239, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 40085.135, "restore_workers_time_ms": 0.024, "training_step_time_ms": 40085.058, "sample_time_ms": 9884.393, "learn_time_ms": 30157.56, "learn_throughput": 132.637, "synch_weights_time_ms": 39.648}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "ef79f_00000", "date": "2024-08-16_11-41-49", "timestamp": 1723788709, "time_this_iter_s": 40.317606925964355, "time_total_s": 1483.3849561214447, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321460a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1483.3849561214447, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 55.25789473684211, "ram_util_percent": 82.04385964912281}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.635891278774019, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.716668438028406, "policy_loss": -0.008229775991409071, "vf_loss": 7.72292545005758, "vf_explained_var": 0.589925839314385, "kl": 0.008767897354770673, "entropy": 0.7521373824783103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.532102687648996, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.627329415366763, "policy_loss": -0.0025153053014061203, "vf_loss": 8.629844736169886, "vf_explained_var": -0.24294156271313863, "kl": 0.009693610597491947, "entropy": 0.5802654344726492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 310.40115232506497, "episode_reward_min": 20.577379554233513, "episode_reward_mean": 170.02067645952388, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1382.103891533559, "predator_policy": 3.0312985085461954}, "policy_reward_max": {"prey_policy": 180.8734364444287, "predator_policy": 1406.0150306809446}, "policy_reward_mean": {"prey_policy": -9.118328495704246, "predator_policy": 94.1286667254662}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.00957859943952, 76.16209740975283, 180.81720599831797, 44.83857735450436, 53.148079343602866, 35.19325032867722, 57.04182112442769, 60.28607798927716, 34.75020446196489, 117.41199116959855, 20.76460084681708, 78.12854289536837, 94.4621851279294, 64.85867624590871, 65.48946375012582, 72.57669790928308, 40.89184963918108, 20.577379554233513, 94.47636591832386, 88.8324451732957, 101.24124309785657, 68.97526565660476, 188.0571698976512, 76.58670749807712, 207.4303640976643, 84.20643373942946, 221.37991949350112, 297.7350045437911, 136.1978787420245, 34.01320092089387, 185.17794180714662, 22.80213773775409, 176.5967897703734, 120.46151769319948, 200.35977726070232, 43.08425616736953, 116.50102796270056, 113.52374112383458, 52.284162071704, 73.19176317804464, 153.2111257176616, 213.14929972258074, 158.08870419730465, 156.62168797812853, 250.57164835698393, 161.04589045315913, 244.24080440649337, 254.78862504157402, 77.03975374289324, 201.6550000262934, 227.536445496069, 180.30023316976164, 106.26260635777851, 250.8500520555337, 284.32176784457164, 164.60839672240525, 187.50832311693856, 221.36545919030186, 151.10161060295042, 302.68178992953733, 248.19909281497254, 226.3512224922115, 229.09413776678724, 310.40115232506497, 222.737702400832, 219.06179335540196, 247.03591818265303, 86.41612755852417, 228.14446889185098, 85.27878434635744, 241.38986804914828, 261.45105260827444, 286.7484503723662, 188.54786177871873, 174.90077911019125, 195.52307144638084, 248.16947790174532, 281.37339591412393, 259.18388541831956, 275.7583721893284, 238.5706196474901, 245.3748384852006, 277.23498108762084, 225.97800556629167, 254.3837819033929, 177.8436580988196, 220.08791756586788, 217.44042336224098, 258.3223912470542, 268.945751869213, 202.62348788337613, 238.2617127340509, 293.7037736516497, 296.437862513788, 265.75697424527596, 116.8995883748516, 234.080575795751, 185.15460213686453, 183.6052527367523, 252.12221469431236], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-75.31115572897932, -100.57472006715234, -62.937897006730275, -63.92455655054757, -77.56117647575203, 105.31839370015304, -139.36853727871656, -108.35114123065352, -129.1499387142431, -87.1531131273296, -112.82781934281262, -31.322926915541093, -107.92971074703814, -40.87692531928737, -96.13483656654516, -68.71412730072878, -83.85540786912664, -84.43813183900458, -96.74292118692448, -9.462501066151738, -151.99293729691135, -115.7830425437994, -99.93824453506843, -54.22880208782291, 4.199566143104373, -92.42487942705918, -98.0878597135431, -69.67795635382768, -86.25476593963626, -80.66278285836876, -72.50162566842408, -111.25931433848609, -45.221557181640954, -37.76790894247133, -100.85928692308003, -133.29838655000574, -96.8137270680536, -48.21630096261789, -445.6734805896816, -73.56981315019459, -9.812846835187369, -60.90843087391217, -89.5926542689409, -71.12249715585811, 66.7204896803923, -45.8051432544566, -172.8654108364673, -84.8540211272462, -92.92518460422666, 84.64641519241383, -144.8643481877366, -79.51679176870807, 19.13732001428946, 83.25065335080845, -218.17966737715017, 68.3056494003707, -127.0266170914184, 50.82170878422322, -91.10918659789414, -355.4654166667664, -106.13368788778604, 110.19784303588048, -85.4263640850912, -111.63121632993916, -1382.103891533559, 108.73293099418804, -19.015712774107797, -59.840102782762365, 104.54988699875175, -114.82088893468153, -109.17561371275983, -77.01482216011028, 7.369306969329068, -167.73062205287368, -83.58352360135144, 9.614616760507403, -159.50485871972396, -67.59468106109726, -76.13981800899647, -125.17444545275804, -118.44524995469109, 74.16301164034921, 79.68650857511612, 37.040111818313214, 4.8879393542623015, -44.12746006518323, -108.71983723198422, 56.11908832244679, 157.48425044945859, -81.37032169325663, 13.217124026193524, 20.38212248262538, 14.028498993581644, 67.35432215413782, 109.97143237344844, 31.473354771097693, -169.780463851233, -38.20124887991828, 91.9768736738519, 46.120732403682524, 50.052740138774865, 92.13704711777649, -35.32138520805086, 62.15541547370789, -72.3863798782271, -83.53105640111536, 125.01964024509975, -40.11172154760088, 88.17496310181764, -0.014574857405463604, 19.32697098164536, -122.33752796231028, 0.4759381014383432, 180.8734364444287, 59.485388114100346, 59.98677545474678, -7.316278369359999, -8.961181011557134, 116.34713349071663, 132.83406541131887, 39.625385172586704, 56.70555338808511, 87.10708568879984, 49.7543211548873, 29.123964517732198, 71.71369720412096, 145.5201460759443, 111.83408042931308, 86.59617275460337, -8.994538134876507, 80.41985465257571, 77.85765086596246, -42.31566247762788, 125.2647373200983, -41.342169402661405, -257.3749518917033, 43.49240349909806, 86.00561359286448, -168.1037293739361, -31.926599812213013, 7.09321728493164, 91.1788914097238, 115.34957760187129, 49.79969546129862, 53.61810218776981, 176.85910219530433, 99.36591387812618, -77.26767057761168, -74.8899796169193, 30.360245529892012, -5.90815233669865, 59.3569565773698, -16.254543665555033, 157.07650648782538, -44.42016437338149, 170.65065427374586, 86.68762542128165, 46.59115299631594, 85.84026584905487, 112.15857981388226, 11.215712185229478, 92.16502407778756, 3.9765036812263324, 97.18000178000906, 107.77166100778447, 119.49090423875506, 140.06421598649501, -16.664634940587767, 103.55024631585223, 83.0048486861481, 7.434091718733592, 72.2767200081532, 60.51240518689209, 86.87968673239189, 72.7928902348104, 108.1539597832714, 56.02815871898449, 123.90831574575546, 99.18923678030995, 67.09334439272865, 63.16672946488777, 37.10738126840219, 59.425775259398385, 121.50298346875947, 119.83990980416264, 86.2994605787803, 100.23876439774438, 113.3685701763276, 101.21896829406286, 40.788333193865164, 41.770576341381485, 11.264866212587862, 39.44506242899857, 59.862887760115, 57.717139498280616, -1.0853096819306174, 105.31564802850465, -14.967735577651627, 106.93385617992392, 63.681852800808336], "policy_predator_policy_reward": [116.1395123094006, 125.7559420861704, 88.5281713971185, 114.49637956991245, 64.01404293397121, 89.04594583994597, 143.68745290121166, 148.87080296266276, 102.88223094315872, 166.568900242017, 118.4954020983854, 60.84859448864553, 114.65364409451762, 91.19481309623562, 116.21134748459731, 108.92369437195373, 115.02800522910324, 88.01573894099296, 113.21122410630971, 110.40618931636511, 133.41210671449696, 155.1284739730309, 109.60624940792201, 122.6893401103377, 80.05098370931336, 102.6365147025709, 93.46680374167282, 139.15768857160668, 140.13374863778472, 92.2732639103462, 113.61734811319744, 142.7202898029959, 23.321417718608938, 100.55989804468447, 123.3573310721705, 131.37772195514884, 132.01557983987936, 107.49081410911596, 223.99853262660457, 384.07720628656733, 93.01519903905408, 78.94732176790183, 123.22175017532588, 106.46866690607773, 60.64724808652715, 106.49457538518854, 188.2139137032976, 146.09222575849302, 118.73486471034185, 96.9742687991354, 190.1736770693444, 118.41389662652962, 88.20737142301783, 30.784574705385328, 216.98090998899593, 230.62811253157503, 101.65120990632269, 110.7515771428968, 270.0000898176847, 210.58771436786964, 94.98308286592142, 86.13070379313089, 80.32450169236469, 139.53521646041978, 1406.0150306809446, 43.95271962879949, 82.79924520089294, 116.51808804917664, 89.01886715423386, 121.61191204239849, 94.29502680469865, 134.97966523554106, 157.12201783606338, 119.74032521018188, 92.02490061084906, 95.46774735382938, 75.42798197648591, 203.95571987603935, 144.60638581201076, 129.89964082778846, 81.45975216749889, 116.03361186450442, 46.377874454585545, 50.04480487456583, 89.26538876973706, 108.06283613848818, 106.86311395982942, 102.35932292783646, 92.26937593964333, 82.18834366113867, 28.59764214246644, 98.84900180187375, 90.87806264785887, 71.97992061091489, 56.610407165581016, 56.7334307314468, 227.92220649057853, 57.099259983466105, 23.126997657983438, 40.4303962907755, 46.65340192854789, 38.69325631097, 80.43953549761056, 73.02666740649397, 129.25366482424056, 132.92637781288045, 93.48703777870813, 72.45509557932664, 94.09371113440291, 102.06766846575653, 133.42454382452686, 134.19440987854344, 3.12765006252551, 3.0312985085461954, 18.624528043538348, 83.26876757791642, 92.47393733530032, 74.90513264856723, 23.704896176774, 29.795694850727823, 82.43056746411237, 69.43758679018838, 43.89574311973695, 45.594072528787386, 51.179308058344866, 77.07716798658919, 14.977825363959957, 38.069100455847746, 73.35187517151842, 71.78419260958665, 51.81095188668311, 8.973335950180775, 73.0508850895036, 91.03595825067923, 285.38930615996435, 99.74394269292439, 61.77783142882362, 36.86862037106488, 128.81790392142676, 156.49120961107954, 76.69851712704035, 66.41924222745249, 46.93746427831415, 49.364315266790314, 28.416460260802754, 27.85478572848909, 90.05406446453833, 76.39555401366611, 116.59033701903503, 102.8401761781836, 64.81951067089042, 77.25475653481935, 87.0541100385229, 20.29340504095205, 67.25599514584358, 87.88691086791613, 66.39997611743853, 59.50513088328325, 24.74266674761967, 53.01685977877164, 78.08240768499961, 57.10747569947345, 75.37962288218218, 68.838710141783, 27.396386116307966, 22.57602972477341, 67.1846157686148, 35.39380875176969, 34.93186896270132, 32.89681793869114, 39.73776419278566, 58.395082179147046, 37.15746042220599, 35.538365224377834, 14.27966082589379, 22.213912518265406, 30.42857840247355, 47.957338379840714, 56.05729476956587, 46.60587592660866, 58.44227985309053, 43.90709729699569, 9.342592497864171, 47.99036150802876, 44.1620032460326, 43.40240002267427, 44.31146651042924, 38.51906142928684, 59.282720289789275, 64.46695246755856, 51.72844859020476, 12.135697230677387, 54.46785053044694, 80.3047750761904, 70.19466673957363, 58.32810558094101, 46.34077494495041, 46.916565340948885, 43.927022187883665, 37.57948352569643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2714060934567284, "mean_inference_ms": 3.75089749513017, "mean_action_processing_ms": 0.5529144738625579, "mean_env_wait_ms": 0.4587964054886604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022168755531311035, "StateBufferConnector_ms": 0.011295080184936523, "ViewRequirementAgentConnector_ms": 0.5910507440567017}, "num_episodes": 23, "episode_return_max": 310.40115232506497, "episode_return_min": 20.577379554233513, "episode_return_mean": 170.02067645952388, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.57747938331589, "num_env_steps_trained_throughput_per_sec": 105.57747938331589, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 39867.586, "restore_workers_time_ms": 0.024, "training_step_time_ms": 39867.508, "sample_time_ms": 9552.697, "learn_time_ms": 30269.654, "learn_throughput": 132.146, "synch_weights_time_ms": 41.152}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "ef79f_00000", "date": "2024-08-16_11-42-27", "timestamp": 1723788747, "time_this_iter_s": 38.11105418205261, "time_total_s": 1521.4960103034973, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321793040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1521.4960103034973, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 54.687037037037044, "ram_util_percent": 81.69444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.56313437778483, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.090613518063984, "policy_loss": -0.007290906639198068, "vf_loss": 7.095665081720504, "vf_explained_var": 0.5172687249524253, "kl": 0.009952572162590972, "entropy": 0.7639544739294304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.5713858286539715, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.29712917363202, "policy_loss": -0.0032528096168159097, "vf_loss": 8.300381988949246, "vf_explained_var": -0.12572286154227283, "kl": 0.007317953419591352, "entropy": 0.5187375510811175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 326.48360878044275, "episode_reward_min": 22.80213773775409, "episode_reward_mean": 206.31018978701118, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1382.103891533559, "predator_policy": 3.0312985085461954}, "policy_reward_max": {"prey_policy": 180.8734364444287, "predator_policy": 1406.0150306809446}, "policy_reward_mean": {"prey_policy": 21.89704660463329, "predator_policy": 81.2580482888723}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.47636591832386, 88.8324451732957, 101.24124309785657, 68.97526565660476, 188.0571698976512, 76.58670749807712, 207.4303640976643, 84.20643373942946, 221.37991949350112, 297.7350045437911, 136.1978787420245, 34.01320092089387, 185.17794180714662, 22.80213773775409, 176.5967897703734, 120.46151769319948, 200.35977726070232, 43.08425616736953, 116.50102796270056, 113.52374112383458, 52.284162071704, 73.19176317804464, 153.2111257176616, 213.14929972258074, 158.08870419730465, 156.62168797812853, 250.57164835698393, 161.04589045315913, 244.24080440649337, 254.78862504157402, 77.03975374289324, 201.6550000262934, 227.536445496069, 180.30023316976164, 106.26260635777851, 250.8500520555337, 284.32176784457164, 164.60839672240525, 187.50832311693856, 221.36545919030186, 151.10161060295042, 302.68178992953733, 248.19909281497254, 226.3512224922115, 229.09413776678724, 310.40115232506497, 222.737702400832, 219.06179335540196, 247.03591818265303, 86.41612755852417, 228.14446889185098, 85.27878434635744, 241.38986804914828, 261.45105260827444, 286.7484503723662, 188.54786177871873, 174.90077911019125, 195.52307144638084, 248.16947790174532, 281.37339591412393, 259.18388541831956, 275.7583721893284, 238.5706196474901, 245.3748384852006, 277.23498108762084, 225.97800556629167, 254.3837819033929, 177.8436580988196, 220.08791756586788, 217.44042336224098, 258.3223912470542, 268.945751869213, 202.62348788337613, 238.2617127340509, 293.7037736516497, 296.437862513788, 265.75697424527596, 116.8995883748516, 234.080575795751, 185.15460213686453, 183.6052527367523, 252.12221469431236, 219.2815600049422, 272.58810207603295, 289.4503544273622, 309.02890555614414, 194.8753352160743, 283.2448877336378, 124.68549101746626, 242.74128895063276, 298.1505085245206, 324.4691518061728, 313.07489464918154, 255.6790366081604, 222.56898784921137, 236.71867219516952, 292.58442781887726, 289.673925791867, 317.0604734912397, 326.48360878044275], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-96.8137270680536, -48.21630096261789, -445.6734805896816, -73.56981315019459, -9.812846835187369, -60.90843087391217, -89.5926542689409, -71.12249715585811, 66.7204896803923, -45.8051432544566, -172.8654108364673, -84.8540211272462, -92.92518460422666, 84.64641519241383, -144.8643481877366, -79.51679176870807, 19.13732001428946, 83.25065335080845, -218.17966737715017, 68.3056494003707, -127.0266170914184, 50.82170878422322, -91.10918659789414, -355.4654166667664, -106.13368788778604, 110.19784303588048, -85.4263640850912, -111.63121632993916, -1382.103891533559, 108.73293099418804, -19.015712774107797, -59.840102782762365, 104.54988699875175, -114.82088893468153, -109.17561371275983, -77.01482216011028, 7.369306969329068, -167.73062205287368, -83.58352360135144, 9.614616760507403, -159.50485871972396, -67.59468106109726, -76.13981800899647, -125.17444545275804, -118.44524995469109, 74.16301164034921, 79.68650857511612, 37.040111818313214, 4.8879393542623015, -44.12746006518323, -108.71983723198422, 56.11908832244679, 157.48425044945859, -81.37032169325663, 13.217124026193524, 20.38212248262538, 14.028498993581644, 67.35432215413782, 109.97143237344844, 31.473354771097693, -169.780463851233, -38.20124887991828, 91.9768736738519, 46.120732403682524, 50.052740138774865, 92.13704711777649, -35.32138520805086, 62.15541547370789, -72.3863798782271, -83.53105640111536, 125.01964024509975, -40.11172154760088, 88.17496310181764, -0.014574857405463604, 19.32697098164536, -122.33752796231028, 0.4759381014383432, 180.8734364444287, 59.485388114100346, 59.98677545474678, -7.316278369359999, -8.961181011557134, 116.34713349071663, 132.83406541131887, 39.625385172586704, 56.70555338808511, 87.10708568879984, 49.7543211548873, 29.123964517732198, 71.71369720412096, 145.5201460759443, 111.83408042931308, 86.59617275460337, -8.994538134876507, 80.41985465257571, 77.85765086596246, -42.31566247762788, 125.2647373200983, -41.342169402661405, -257.3749518917033, 43.49240349909806, 86.00561359286448, -168.1037293739361, -31.926599812213013, 7.09321728493164, 91.1788914097238, 115.34957760187129, 49.79969546129862, 53.61810218776981, 176.85910219530433, 99.36591387812618, -77.26767057761168, -74.8899796169193, 30.360245529892012, -5.90815233669865, 59.3569565773698, -16.254543665555033, 157.07650648782538, -44.42016437338149, 170.65065427374586, 86.68762542128165, 46.59115299631594, 85.84026584905487, 112.15857981388226, 11.215712185229478, 92.16502407778756, 3.9765036812263324, 97.18000178000906, 107.77166100778447, 119.49090423875506, 140.06421598649501, -16.664634940587767, 103.55024631585223, 83.0048486861481, 7.434091718733592, 72.2767200081532, 60.51240518689209, 86.87968673239189, 72.7928902348104, 108.1539597832714, 56.02815871898449, 123.90831574575546, 99.18923678030995, 67.09334439272865, 63.16672946488777, 37.10738126840219, 59.425775259398385, 121.50298346875947, 119.83990980416264, 86.2994605787803, 100.23876439774438, 113.3685701763276, 101.21896829406286, 40.788333193865164, 41.770576341381485, 11.264866212587862, 39.44506242899857, 59.862887760115, 57.717139498280616, -1.0853096819306174, 105.31564802850465, -14.967735577651627, 106.93385617992392, 63.681852800808336, -24.013896938859048, 66.7287661211094, 75.91143030451346, 85.70980377960983, 144.960267654701, 100.2490607449555, 130.59086478276976, 82.61528808414917, -38.14864578774575, 68.76202027047835, 121.4757984396955, 110.93152260124099, 49.471390690284494, 27.037484357555172, 116.10358655731017, 50.21096165824601, 146.92699390066963, 71.60121530378481, 158.72759463075275, 146.2083718263612, 121.51045235941473, 168.2406716392976, 121.97258762723949, 99.25606319785848, 96.24532376037794, 20.240047483260156, 72.28680526791484, 119.01375823382577, 145.9517311197138, 78.3005790035422, 33.80223177776752, 150.5042638270613, 49.93979232387959, 148.55685147605857, 105.58994344034024, 162.5251036982185], "policy_predator_policy_reward": [132.01557983987936, 107.49081410911596, 223.99853262660457, 384.07720628656733, 93.01519903905408, 78.94732176790183, 123.22175017532588, 106.46866690607773, 60.64724808652715, 106.49457538518854, 188.2139137032976, 146.09222575849302, 118.73486471034185, 96.9742687991354, 190.1736770693444, 118.41389662652962, 88.20737142301783, 30.784574705385328, 216.98090998899593, 230.62811253157503, 101.65120990632269, 110.7515771428968, 270.0000898176847, 210.58771436786964, 94.98308286592142, 86.13070379313089, 80.32450169236469, 139.53521646041978, 1406.0150306809446, 43.95271962879949, 82.79924520089294, 116.51808804917664, 89.01886715423386, 121.61191204239849, 94.29502680469865, 134.97966523554106, 157.12201783606338, 119.74032521018188, 92.02490061084906, 95.46774735382938, 75.42798197648591, 203.95571987603935, 144.60638581201076, 129.89964082778846, 81.45975216749889, 116.03361186450442, 46.377874454585545, 50.04480487456583, 89.26538876973706, 108.06283613848818, 106.86311395982942, 102.35932292783646, 92.26937593964333, 82.18834366113867, 28.59764214246644, 98.84900180187375, 90.87806264785887, 71.97992061091489, 56.610407165581016, 56.7334307314468, 227.92220649057853, 57.099259983466105, 23.126997657983438, 40.4303962907755, 46.65340192854789, 38.69325631097, 80.43953549761056, 73.02666740649397, 129.25366482424056, 132.92637781288045, 93.48703777870813, 72.45509557932664, 94.09371113440291, 102.06766846575653, 133.42454382452686, 134.19440987854344, 3.12765006252551, 3.0312985085461954, 18.624528043538348, 83.26876757791642, 92.47393733530032, 74.90513264856723, 23.704896176774, 29.795694850727823, 82.43056746411237, 69.43758679018838, 43.89574311973695, 45.594072528787386, 51.179308058344866, 77.07716798658919, 14.977825363959957, 38.069100455847746, 73.35187517151842, 71.78419260958665, 51.81095188668311, 8.973335950180775, 73.0508850895036, 91.03595825067923, 285.38930615996435, 99.74394269292439, 61.77783142882362, 36.86862037106488, 128.81790392142676, 156.49120961107954, 76.69851712704035, 66.41924222745249, 46.93746427831415, 49.364315266790314, 28.416460260802754, 27.85478572848909, 90.05406446453833, 76.39555401366611, 116.59033701903503, 102.8401761781836, 64.81951067089042, 77.25475653481935, 87.0541100385229, 20.29340504095205, 67.25599514584358, 87.88691086791613, 66.39997611743853, 59.50513088328325, 24.74266674761967, 53.01685977877164, 78.08240768499961, 57.10747569947345, 75.37962288218218, 68.838710141783, 27.396386116307966, 22.57602972477341, 67.1846157686148, 35.39380875176969, 34.93186896270132, 32.89681793869114, 39.73776419278566, 58.395082179147046, 37.15746042220599, 35.538365224377834, 14.27966082589379, 22.213912518265406, 30.42857840247355, 47.957338379840714, 56.05729476956587, 46.60587592660866, 58.44227985309053, 43.90709729699569, 9.342592497864171, 47.99036150802876, 44.1620032460326, 43.40240002267427, 44.31146651042924, 38.51906142928684, 59.282720289789275, 64.46695246755856, 51.72844859020476, 12.135697230677387, 54.46785053044694, 80.3047750761904, 70.19466673957363, 58.32810558094101, 46.34077494495041, 46.916565340948885, 43.927022187883665, 37.57948352569643, 48.40900675749222, 128.15768406519962, 54.974473398226124, 55.992394593683585, 27.095280752192313, 17.14574527551337, 46.9799941755374, 48.84275851368787, 84.6827571704971, 79.57920356284464, 14.842223131089225, 35.99534356161215, 28.2334505842462, 19.94316538538053, 35.25668196241747, 41.17005877265909, 43.05383607700274, 36.56846324306323, 14.228102584438009, 5.305082764620886, 12.689858907663051, 10.633911742806525, 25.894258584444287, 8.556127198618249, 51.064680363926094, 55.01893624164713, 29.757762066594736, 15.660346626834293, 33.66283059733566, 34.669287098285714, 47.58671524771979, 57.78071493931844, 61.508135200308516, 57.055694490992956, 29.76325143614546, 28.605310205738654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2943874216057012, "mean_inference_ms": 3.819833072476818, "mean_action_processing_ms": 0.5637984710579382, "mean_env_wait_ms": 0.46754541714714143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026112675666809082, "StateBufferConnector_ms": 0.01169741153717041, "ViewRequirementAgentConnector_ms": 0.62646484375}, "num_episodes": 18, "episode_return_max": 326.48360878044275, "episode_return_min": 22.80213773775409, "episode_return_mean": 206.31018978701118, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.417094103121, "num_env_steps_trained_throughput_per_sec": 102.417094103121, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 39754.772, "restore_workers_time_ms": 0.025, "training_step_time_ms": 39754.694, "sample_time_ms": 9437.014, "learn_time_ms": 30271.541, "learn_throughput": 132.137, "synch_weights_time_ms": 42.955}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "ef79f_00000", "date": "2024-08-16_11-43-07", "timestamp": 1723788787, "time_this_iter_s": 39.21062684059143, "time_total_s": 1560.7066371440887, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321797ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1560.7066371440887, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 54.5, "ram_util_percent": 82.5490909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.352563493245493, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.647318071789211, "policy_loss": -0.006591543695574045, "vf_loss": 5.651345940998622, "vf_explained_var": 0.5406719490964577, "kl": 0.01139407737937573, "entropy": 0.7446216090961739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.805830632189594, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.622375770599123, "policy_loss": -0.002107647949800132, "vf_loss": 7.624483448109299, "vf_explained_var": 0.003307238016178999, "kl": 0.00882680861420037, "entropy": 0.5098136944587899, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 337.4483931247356, "episode_reward_min": 52.284162071704, "episode_reward_mean": 233.12349182883247, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -257.3749518917033, "predator_policy": 3.0312985085461954}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 285.38930615996435}, "policy_reward_mean": {"prey_policy": 58.42791530094795, "predator_policy": 58.1338306134683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.50102796270056, 113.52374112383458, 52.284162071704, 73.19176317804464, 153.2111257176616, 213.14929972258074, 158.08870419730465, 156.62168797812853, 250.57164835698393, 161.04589045315913, 244.24080440649337, 254.78862504157402, 77.03975374289324, 201.6550000262934, 227.536445496069, 180.30023316976164, 106.26260635777851, 250.8500520555337, 284.32176784457164, 164.60839672240525, 187.50832311693856, 221.36545919030186, 151.10161060295042, 302.68178992953733, 248.19909281497254, 226.3512224922115, 229.09413776678724, 310.40115232506497, 222.737702400832, 219.06179335540196, 247.03591818265303, 86.41612755852417, 228.14446889185098, 85.27878434635744, 241.38986804914828, 261.45105260827444, 286.7484503723662, 188.54786177871873, 174.90077911019125, 195.52307144638084, 248.16947790174532, 281.37339591412393, 259.18388541831956, 275.7583721893284, 238.5706196474901, 245.3748384852006, 277.23498108762084, 225.97800556629167, 254.3837819033929, 177.8436580988196, 220.08791756586788, 217.44042336224098, 258.3223912470542, 268.945751869213, 202.62348788337613, 238.2617127340509, 293.7037736516497, 296.437862513788, 265.75697424527596, 116.8995883748516, 234.080575795751, 185.15460213686453, 183.6052527367523, 252.12221469431236, 219.2815600049422, 272.58810207603295, 289.4503544273622, 309.02890555614414, 194.8753352160743, 283.2448877336378, 124.68549101746626, 242.74128895063276, 298.1505085245206, 324.4691518061728, 313.07489464918154, 255.6790366081604, 222.56898784921137, 236.71867219516952, 292.58442781887726, 289.673925791867, 317.0604734912397, 326.48360878044275, 241.5480178378461, 304.032902512076, 308.68541231562665, 337.4483931247356, 167.26235918359487, 272.1476414115028, 275.7985468185852, 268.2423664165582, 254.74006299117022, 292.63934045746703, 314.10171132658087, 312.1942190677589, 263.2102475119092, 289.4624071292711, 278.6106264099044, 258.55722927283716, 280.93961889087257, 309.32352071949606], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [7.369306969329068, -167.73062205287368, -83.58352360135144, 9.614616760507403, -159.50485871972396, -67.59468106109726, -76.13981800899647, -125.17444545275804, -118.44524995469109, 74.16301164034921, 79.68650857511612, 37.040111818313214, 4.8879393542623015, -44.12746006518323, -108.71983723198422, 56.11908832244679, 157.48425044945859, -81.37032169325663, 13.217124026193524, 20.38212248262538, 14.028498993581644, 67.35432215413782, 109.97143237344844, 31.473354771097693, -169.780463851233, -38.20124887991828, 91.9768736738519, 46.120732403682524, 50.052740138774865, 92.13704711777649, -35.32138520805086, 62.15541547370789, -72.3863798782271, -83.53105640111536, 125.01964024509975, -40.11172154760088, 88.17496310181764, -0.014574857405463604, 19.32697098164536, -122.33752796231028, 0.4759381014383432, 180.8734364444287, 59.485388114100346, 59.98677545474678, -7.316278369359999, -8.961181011557134, 116.34713349071663, 132.83406541131887, 39.625385172586704, 56.70555338808511, 87.10708568879984, 49.7543211548873, 29.123964517732198, 71.71369720412096, 145.5201460759443, 111.83408042931308, 86.59617275460337, -8.994538134876507, 80.41985465257571, 77.85765086596246, -42.31566247762788, 125.2647373200983, -41.342169402661405, -257.3749518917033, 43.49240349909806, 86.00561359286448, -168.1037293739361, -31.926599812213013, 7.09321728493164, 91.1788914097238, 115.34957760187129, 49.79969546129862, 53.61810218776981, 176.85910219530433, 99.36591387812618, -77.26767057761168, -74.8899796169193, 30.360245529892012, -5.90815233669865, 59.3569565773698, -16.254543665555033, 157.07650648782538, -44.42016437338149, 170.65065427374586, 86.68762542128165, 46.59115299631594, 85.84026584905487, 112.15857981388226, 11.215712185229478, 92.16502407778756, 3.9765036812263324, 97.18000178000906, 107.77166100778447, 119.49090423875506, 140.06421598649501, -16.664634940587767, 103.55024631585223, 83.0048486861481, 7.434091718733592, 72.2767200081532, 60.51240518689209, 86.87968673239189, 72.7928902348104, 108.1539597832714, 56.02815871898449, 123.90831574575546, 99.18923678030995, 67.09334439272865, 63.16672946488777, 37.10738126840219, 59.425775259398385, 121.50298346875947, 119.83990980416264, 86.2994605787803, 100.23876439774438, 113.3685701763276, 101.21896829406286, 40.788333193865164, 41.770576341381485, 11.264866212587862, 39.44506242899857, 59.862887760115, 57.717139498280616, -1.0853096819306174, 105.31564802850465, -14.967735577651627, 106.93385617992392, 63.681852800808336, -24.013896938859048, 66.7287661211094, 75.91143030451346, 85.70980377960983, 144.960267654701, 100.2490607449555, 130.59086478276976, 82.61528808414917, -38.14864578774575, 68.76202027047835, 121.4757984396955, 110.93152260124099, 49.471390690284494, 27.037484357555172, 116.10358655731017, 50.21096165824601, 146.92699390066963, 71.60121530378481, 158.72759463075275, 146.2083718263612, 121.51045235941473, 168.2406716392976, 121.97258762723949, 99.25606319785848, 96.24532376037794, 20.240047483260156, 72.28680526791484, 119.01375823382577, 145.9517311197138, 78.3005790035422, 33.80223177776752, 150.5042638270613, 49.93979232387959, 148.55685147605857, 105.58994344034024, 162.5251036982185, 146.33557183067512, 5.081820219971757, 115.74891449481446, 139.06312099433228, 2.9684666723390905, 198.01999999999998, 128.32403180308313, 156.4662443757793, 31.125134327198154, 52.00213664644545, 116.60395790070186, 69.85149607214673, 122.17511160854525, 73.16285709095023, 84.26856824769659, 131.95124273451546, 72.26956833016348, 59.8789806908528, 70.23005496805148, 80.8456740152921, 104.85510363295165, 102.1014485230177, 124.82085420861523, 142.48392794805295, 91.9175913469238, 85.01656700744923, 85.63000189835643, 137.30483254542943, 90.26519826023272, 101.7021094355085, 101.19587568629852, 77.63174406566193, 132.65890357621925, 137.63, 131.80893811100952, 125.65674882765659], "policy_predator_policy_reward": [157.12201783606338, 119.74032521018188, 92.02490061084906, 95.46774735382938, 75.42798197648591, 203.95571987603935, 144.60638581201076, 129.89964082778846, 81.45975216749889, 116.03361186450442, 46.377874454585545, 50.04480487456583, 89.26538876973706, 108.06283613848818, 106.86311395982942, 102.35932292783646, 92.26937593964333, 82.18834366113867, 28.59764214246644, 98.84900180187375, 90.87806264785887, 71.97992061091489, 56.610407165581016, 56.7334307314468, 227.92220649057853, 57.099259983466105, 23.126997657983438, 40.4303962907755, 46.65340192854789, 38.69325631097, 80.43953549761056, 73.02666740649397, 129.25366482424056, 132.92637781288045, 93.48703777870813, 72.45509557932664, 94.09371113440291, 102.06766846575653, 133.42454382452686, 134.19440987854344, 3.12765006252551, 3.0312985085461954, 18.624528043538348, 83.26876757791642, 92.47393733530032, 74.90513264856723, 23.704896176774, 29.795694850727823, 82.43056746411237, 69.43758679018838, 43.89574311973695, 45.594072528787386, 51.179308058344866, 77.07716798658919, 14.977825363959957, 38.069100455847746, 73.35187517151842, 71.78419260958665, 51.81095188668311, 8.973335950180775, 73.0508850895036, 91.03595825067923, 285.38930615996435, 99.74394269292439, 61.77783142882362, 36.86862037106488, 128.81790392142676, 156.49120961107954, 76.69851712704035, 66.41924222745249, 46.93746427831415, 49.364315266790314, 28.416460260802754, 27.85478572848909, 90.05406446453833, 76.39555401366611, 116.59033701903503, 102.8401761781836, 64.81951067089042, 77.25475653481935, 87.0541100385229, 20.29340504095205, 67.25599514584358, 87.88691086791613, 66.39997611743853, 59.50513088328325, 24.74266674761967, 53.01685977877164, 78.08240768499961, 57.10747569947345, 75.37962288218218, 68.838710141783, 27.396386116307966, 22.57602972477341, 67.1846157686148, 35.39380875176969, 34.93186896270132, 32.89681793869114, 39.73776419278566, 58.395082179147046, 37.15746042220599, 35.538365224377834, 14.27966082589379, 22.213912518265406, 30.42857840247355, 47.957338379840714, 56.05729476956587, 46.60587592660866, 58.44227985309053, 43.90709729699569, 9.342592497864171, 47.99036150802876, 44.1620032460326, 43.40240002267427, 44.31146651042924, 38.51906142928684, 59.282720289789275, 64.46695246755856, 51.72844859020476, 12.135697230677387, 54.46785053044694, 80.3047750761904, 70.19466673957363, 58.32810558094101, 46.34077494495041, 46.916565340948885, 43.927022187883665, 37.57948352569643, 48.40900675749222, 128.15768406519962, 54.974473398226124, 55.992394593683585, 27.095280752192313, 17.14574527551337, 46.9799941755374, 48.84275851368787, 84.6827571704971, 79.57920356284464, 14.842223131089225, 35.99534356161215, 28.2334505842462, 19.94316538538053, 35.25668196241747, 41.17005877265909, 43.05383607700274, 36.56846324306323, 14.228102584438009, 5.305082764620886, 12.689858907663051, 10.633911742806525, 25.894258584444287, 8.556127198618249, 51.064680363926094, 55.01893624164713, 29.757762066594736, 15.660346626834293, 33.66283059733566, 34.669287098285714, 47.58671524771979, 57.78071493931844, 61.508135200308516, 57.055694490992956, 29.76325143614546, 28.605310205738654, 48.40105894093537, 41.72956684626416, 31.704760385980602, 17.516106636948702, 54.62283099675705, 53.074114646530425, 24.767484968154196, 27.890631977719014, 62.92295355633774, 21.21213465361341, 45.281801536487336, 40.41038590216687, 34.88911417345594, 45.57146394563377, 28.20449240379237, 23.818063030553795, 43.15588315312712, 79.43563081702686, 79.37563962250017, 62.18797185162369, 54.837004848530185, 52.308154322081364, 26.99357166847638, 17.895865242614367, 50.15609997142926, 36.11998918610686, 32.2881650857487, 34.23940759973662, 48.82985138311999, 37.81346733104333, 25.443990223885713, 54.28561929699098, 3.0593656080094402, 7.591349706643923, 29.80224431137155, 22.0555894694583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3208394748762393, "mean_inference_ms": 3.8929421068624754, "mean_action_processing_ms": 0.575151472675058, "mean_env_wait_ms": 0.47747866146434204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027293086051940918, "StateBufferConnector_ms": 0.008781671524047852, "ViewRequirementAgentConnector_ms": 0.5929396152496338}, "num_episodes": 18, "episode_return_max": 337.4483931247356, "episode_return_min": 52.284162071704, "episode_return_mean": 233.12349182883247, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.59795716072557, "num_env_steps_trained_throughput_per_sec": 29.59795716072557, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 49312.192, "restore_workers_time_ms": 0.025, "training_step_time_ms": 49312.113, "sample_time_ms": 9308.083, "learn_time_ms": 39948.257, "learn_throughput": 100.13, "synch_weights_time_ms": 52.245}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "ef79f_00000", "date": "2024-08-16_11-45-22", "timestamp": 1723788922, "time_this_iter_s": 135.35404014587402, "time_total_s": 1696.0606772899628, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5375550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1696.0606772899628, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 58.51746031746032, "ram_util_percent": 81.91587301587302}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.231355685405631, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.012065613963617, "policy_loss": -0.009051859325596264, "vf_loss": 6.01751443671171, "vf_explained_var": 0.38570215285770476, "kl": 0.016013451330206787, "entropy": 0.7508233232157571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.320975832901304, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.338449183973686, "policy_loss": -0.0031164051452405236, "vf_loss": 7.341565581730434, "vf_explained_var": 0.16524502370092603, "kl": 0.010866995965362702, "entropy": 0.5279828575868455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 337.4483931247356, "episode_reward_min": 85.27878434635744, "episode_reward_mean": 253.8232859301883, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -257.3749518917033, "predator_policy": 1.4448983310982135}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 285.38930615996435}, "policy_reward_mean": {"prey_policy": 81.15623498694853, "predator_policy": 45.75540797814561}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.10161060295042, 302.68178992953733, 248.19909281497254, 226.3512224922115, 229.09413776678724, 310.40115232506497, 222.737702400832, 219.06179335540196, 247.03591818265303, 86.41612755852417, 228.14446889185098, 85.27878434635744, 241.38986804914828, 261.45105260827444, 286.7484503723662, 188.54786177871873, 174.90077911019125, 195.52307144638084, 248.16947790174532, 281.37339591412393, 259.18388541831956, 275.7583721893284, 238.5706196474901, 245.3748384852006, 277.23498108762084, 225.97800556629167, 254.3837819033929, 177.8436580988196, 220.08791756586788, 217.44042336224098, 258.3223912470542, 268.945751869213, 202.62348788337613, 238.2617127340509, 293.7037736516497, 296.437862513788, 265.75697424527596, 116.8995883748516, 234.080575795751, 185.15460213686453, 183.6052527367523, 252.12221469431236, 219.2815600049422, 272.58810207603295, 289.4503544273622, 309.02890555614414, 194.8753352160743, 283.2448877336378, 124.68549101746626, 242.74128895063276, 298.1505085245206, 324.4691518061728, 313.07489464918154, 255.6790366081604, 222.56898784921137, 236.71867219516952, 292.58442781887726, 289.673925791867, 317.0604734912397, 326.48360878044275, 241.5480178378461, 304.032902512076, 308.68541231562665, 337.4483931247356, 167.26235918359487, 272.1476414115028, 275.7985468185852, 268.2423664165582, 254.74006299117022, 292.63934045746703, 314.10171132658087, 312.1942190677589, 263.2102475119092, 289.4624071292711, 278.6106264099044, 258.55722927283716, 280.93961889087257, 309.32352071949606, 326.67716953628894, 309.0256164660972, 247.61154219820696, 281.2703680844206, 144.8552591953602, 286.0395397664695, 309.3137357604678, 279.60942595085106, 244.66942916718037, 231.93410584326725, 334.031701657333, 319.9235808566972, 228.34904790730587, 287.8371771786133, 293.25568887817235, 297.7125111331907, 151.56620708112817, 225.1714860310356, 320.98595120371465, 247.71106211389986, 288.70071778032843, 262.39460427826543], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.316278369359999, -8.961181011557134, 116.34713349071663, 132.83406541131887, 39.625385172586704, 56.70555338808511, 87.10708568879984, 49.7543211548873, 29.123964517732198, 71.71369720412096, 145.5201460759443, 111.83408042931308, 86.59617275460337, -8.994538134876507, 80.41985465257571, 77.85765086596246, -42.31566247762788, 125.2647373200983, -41.342169402661405, -257.3749518917033, 43.49240349909806, 86.00561359286448, -168.1037293739361, -31.926599812213013, 7.09321728493164, 91.1788914097238, 115.34957760187129, 49.79969546129862, 53.61810218776981, 176.85910219530433, 99.36591387812618, -77.26767057761168, -74.8899796169193, 30.360245529892012, -5.90815233669865, 59.3569565773698, -16.254543665555033, 157.07650648782538, -44.42016437338149, 170.65065427374586, 86.68762542128165, 46.59115299631594, 85.84026584905487, 112.15857981388226, 11.215712185229478, 92.16502407778756, 3.9765036812263324, 97.18000178000906, 107.77166100778447, 119.49090423875506, 140.06421598649501, -16.664634940587767, 103.55024631585223, 83.0048486861481, 7.434091718733592, 72.2767200081532, 60.51240518689209, 86.87968673239189, 72.7928902348104, 108.1539597832714, 56.02815871898449, 123.90831574575546, 99.18923678030995, 67.09334439272865, 63.16672946488777, 37.10738126840219, 59.425775259398385, 121.50298346875947, 119.83990980416264, 86.2994605787803, 100.23876439774438, 113.3685701763276, 101.21896829406286, 40.788333193865164, 41.770576341381485, 11.264866212587862, 39.44506242899857, 59.862887760115, 57.717139498280616, -1.0853096819306174, 105.31564802850465, -14.967735577651627, 106.93385617992392, 63.681852800808336, -24.013896938859048, 66.7287661211094, 75.91143030451346, 85.70980377960983, 144.960267654701, 100.2490607449555, 130.59086478276976, 82.61528808414917, -38.14864578774575, 68.76202027047835, 121.4757984396955, 110.93152260124099, 49.471390690284494, 27.037484357555172, 116.10358655731017, 50.21096165824601, 146.92699390066963, 71.60121530378481, 158.72759463075275, 146.2083718263612, 121.51045235941473, 168.2406716392976, 121.97258762723949, 99.25606319785848, 96.24532376037794, 20.240047483260156, 72.28680526791484, 119.01375823382577, 145.9517311197138, 78.3005790035422, 33.80223177776752, 150.5042638270613, 49.93979232387959, 148.55685147605857, 105.58994344034024, 162.5251036982185, 146.33557183067512, 5.081820219971757, 115.74891449481446, 139.06312099433228, 2.9684666723390905, 198.01999999999998, 128.32403180308313, 156.4662443757793, 31.125134327198154, 52.00213664644545, 116.60395790070186, 69.85149607214673, 122.17511160854525, 73.16285709095023, 84.26856824769659, 131.95124273451546, 72.26956833016348, 59.8789806908528, 70.23005496805148, 80.8456740152921, 104.85510363295165, 102.1014485230177, 124.82085420861523, 142.48392794805295, 91.9175913469238, 85.01656700744923, 85.63000189835643, 137.30483254542943, 90.26519826023272, 101.7021094355085, 101.19587568629852, 77.63174406566193, 132.65890357621925, 137.63, 131.80893811100952, 125.65674882765659, 183.17000000000002, 70.13956109076389, 184.93950231963652, 99.77129452762465, 71.74190087198599, 100.72755969979488, 141.63601776018868, 44.805861411429284, 47.503686061654264, -24.72116604721336, 131.9102372923572, 139.32667752935276, 138.40237465652052, 139.15399018388152, 128.39038476679485, 129.09789314624632, 169.6870428610522, 9.588882699741234, 52.552941636509104, 80.7118924499227, 133.4790819077938, 172.48504695949393, 162.9896739408281, 126.49366683110703, 122.48418412210202, 47.089911618655535, 94.6837630854323, 144.03665163512864, 154.50874720395547, 64.89367590291037, 81.98823103299985, 150.2535531729582, -0.36465923446388615, 15.092306490578048, 101.16080572811568, -2.9166014265408613, 143.5690801389942, 134.12476633255403, 54.10209667366314, 151.71486589273235, 136.0685814711959, 93.18700926789518, 117.54516382643129, 72.96023322151287], "policy_predator_policy_reward": [92.47393733530032, 74.90513264856723, 23.704896176774, 29.795694850727823, 82.43056746411237, 69.43758679018838, 43.89574311973695, 45.594072528787386, 51.179308058344866, 77.07716798658919, 14.977825363959957, 38.069100455847746, 73.35187517151842, 71.78419260958665, 51.81095188668311, 8.973335950180775, 73.0508850895036, 91.03595825067923, 285.38930615996435, 99.74394269292439, 61.77783142882362, 36.86862037106488, 128.81790392142676, 156.49120961107954, 76.69851712704035, 66.41924222745249, 46.93746427831415, 49.364315266790314, 28.416460260802754, 27.85478572848909, 90.05406446453833, 76.39555401366611, 116.59033701903503, 102.8401761781836, 64.81951067089042, 77.25475653481935, 87.0541100385229, 20.29340504095205, 67.25599514584358, 87.88691086791613, 66.39997611743853, 59.50513088328325, 24.74266674761967, 53.01685977877164, 78.08240768499961, 57.10747569947345, 75.37962288218218, 68.838710141783, 27.396386116307966, 22.57602972477341, 67.1846157686148, 35.39380875176969, 34.93186896270132, 32.89681793869114, 39.73776419278566, 58.395082179147046, 37.15746042220599, 35.538365224377834, 14.27966082589379, 22.213912518265406, 30.42857840247355, 47.957338379840714, 56.05729476956587, 46.60587592660866, 58.44227985309053, 43.90709729699569, 9.342592497864171, 47.99036150802876, 44.1620032460326, 43.40240002267427, 44.31146651042924, 38.51906142928684, 59.282720289789275, 64.46695246755856, 51.72844859020476, 12.135697230677387, 54.46785053044694, 80.3047750761904, 70.19466673957363, 58.32810558094101, 46.34077494495041, 46.916565340948885, 43.927022187883665, 37.57948352569643, 48.40900675749222, 128.15768406519962, 54.974473398226124, 55.992394593683585, 27.095280752192313, 17.14574527551337, 46.9799941755374, 48.84275851368787, 84.6827571704971, 79.57920356284464, 14.842223131089225, 35.99534356161215, 28.2334505842462, 19.94316538538053, 35.25668196241747, 41.17005877265909, 43.05383607700274, 36.56846324306323, 14.228102584438009, 5.305082764620886, 12.689858907663051, 10.633911742806525, 25.894258584444287, 8.556127198618249, 51.064680363926094, 55.01893624164713, 29.757762066594736, 15.660346626834293, 33.66283059733566, 34.669287098285714, 47.58671524771979, 57.78071493931844, 61.508135200308516, 57.055694490992956, 29.76325143614546, 28.605310205738654, 48.40105894093537, 41.72956684626416, 31.704760385980602, 17.516106636948702, 54.62283099675705, 53.074114646530425, 24.767484968154196, 27.890631977719014, 62.92295355633774, 21.21213465361341, 45.281801536487336, 40.41038590216687, 34.88911417345594, 45.57146394563377, 28.20449240379237, 23.818063030553795, 43.15588315312712, 79.43563081702686, 79.37563962250017, 62.18797185162369, 54.837004848530185, 52.308154322081364, 26.99357166847638, 17.895865242614367, 50.15609997142926, 36.11998918610686, 32.2881650857487, 34.23940759973662, 48.82985138311999, 37.81346733104333, 25.443990223885713, 54.28561929699098, 3.0593656080094402, 7.591349706643923, 29.80224431137155, 22.0555894694583, 37.314717606123615, 36.052890839401435, 11.181920785510755, 13.132898833325326, 20.206731870643694, 54.935349755782376, 33.28254133838487, 61.54594757441781, 95.61978939082101, 26.45294979009831, 8.854653040577546, 5.947971904182177, 13.537598909191125, 18.21977201087467, 20.67624970671168, 1.4448983310982135, 37.70214921836832, 27.691354388019057, 48.96522715461819, 49.7040446022172, 13.908654750492127, 14.158918039553289, 15.242074964318114, 15.198165120443925, 40.912652205988266, 17.862299960560268, 27.243042066794235, 21.87372039125813, 34.882798831624456, 38.97046693968192, 31.00695139870535, 34.46377552852737, 60.22227668183552, 76.61628314317771, 65.0178403509768, 61.909441378484274, 21.50920686489577, 21.782897867270687, 28.651737402110072, 13.242362145394422, 21.33703680945108, 38.108090231786335, 35.98697149490968, 35.90223573541156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3527600965225366, "mean_inference_ms": 3.982932321864747, "mean_action_processing_ms": 0.588143350295605, "mean_env_wait_ms": 0.4890960710175798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026914119720458984, "StateBufferConnector_ms": 0.0248868465423584, "ViewRequirementAgentConnector_ms": 0.6151922941207886}, "num_episodes": 22, "episode_return_max": 337.4483931247356, "episode_return_min": 85.27878434635744, "episode_return_mean": 253.8232859301883, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.729822221922624, "num_env_steps_trained_throughput_per_sec": 6.729822221922624, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 104660.45, "restore_workers_time_ms": 0.026, "training_step_time_ms": 104660.366, "sample_time_ms": 9174.34, "learn_time_ms": 95428.871, "learn_throughput": 41.916, "synch_weights_time_ms": 53.322}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "ef79f_00000", "date": "2024-08-16_11-55-17", "timestamp": 1723789517, "time_this_iter_s": 594.4825699329376, "time_total_s": 2290.5432472229004, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5380f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2290.5432472229004, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 60.84347826086956, "ram_util_percent": 80.6840579710145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0714643105943367, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.952045171979874, "policy_loss": -0.00422105518103178, "vf_loss": 6.955305605338364, "vf_explained_var": 0.26028577921882506, "kl": 0.004269387375590769, "entropy": 0.7436064495296074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.037804736031426, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.9507855513739205, "policy_loss": -0.004593454913615629, "vf_loss": 6.955379007228468, "vf_explained_var": 0.19365536639930078, "kl": 0.011051346262594861, "entropy": 0.5178895543492029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 346.8768364532252, "episode_reward_min": 27.89502519591501, "episode_reward_mean": 252.4071417385134, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -61.16559694794814, "predator_policy": 1.4448983310982135}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 128.15768406519962}, "policy_reward_mean": {"prey_policy": 87.48573136560742, "predator_policy": 38.71783950364926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [248.16947790174532, 281.37339591412393, 259.18388541831956, 275.7583721893284, 238.5706196474901, 245.3748384852006, 277.23498108762084, 225.97800556629167, 254.3837819033929, 177.8436580988196, 220.08791756586788, 217.44042336224098, 258.3223912470542, 268.945751869213, 202.62348788337613, 238.2617127340509, 293.7037736516497, 296.437862513788, 265.75697424527596, 116.8995883748516, 234.080575795751, 185.15460213686453, 183.6052527367523, 252.12221469431236, 219.2815600049422, 272.58810207603295, 289.4503544273622, 309.02890555614414, 194.8753352160743, 283.2448877336378, 124.68549101746626, 242.74128895063276, 298.1505085245206, 324.4691518061728, 313.07489464918154, 255.6790366081604, 222.56898784921137, 236.71867219516952, 292.58442781887726, 289.673925791867, 317.0604734912397, 326.48360878044275, 241.5480178378461, 304.032902512076, 308.68541231562665, 337.4483931247356, 167.26235918359487, 272.1476414115028, 275.7985468185852, 268.2423664165582, 254.74006299117022, 292.63934045746703, 314.10171132658087, 312.1942190677589, 263.2102475119092, 289.4624071292711, 278.6106264099044, 258.55722927283716, 280.93961889087257, 309.32352071949606, 326.67716953628894, 309.0256164660972, 247.61154219820696, 281.2703680844206, 144.8552591953602, 286.0395397664695, 309.3137357604678, 279.60942595085106, 244.66942916718037, 231.93410584326725, 334.031701657333, 319.9235808566972, 228.34904790730587, 287.8371771786133, 293.25568887817235, 297.7125111331907, 151.56620708112817, 225.1714860310356, 320.98595120371465, 247.71106211389986, 288.70071778032843, 262.39460427826543, 161.61024729164242, 298.6919228962472, 300.8089863639231, 145.1438111480388, 229.0883260433077, 232.63386109684092, 88.55046253241231, 243.03859058589674, 253.7881159609518, 149.99744068875913, 243.66358823510654, 27.89502519591501, 243.40407342259775, 346.8768364532252, 136.88310039738423, 155.21558296785105, 212.97403161045696, 293.1864619741739], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.254543665555033, 157.07650648782538, -44.42016437338149, 170.65065427374586, 86.68762542128165, 46.59115299631594, 85.84026584905487, 112.15857981388226, 11.215712185229478, 92.16502407778756, 3.9765036812263324, 97.18000178000906, 107.77166100778447, 119.49090423875506, 140.06421598649501, -16.664634940587767, 103.55024631585223, 83.0048486861481, 7.434091718733592, 72.2767200081532, 60.51240518689209, 86.87968673239189, 72.7928902348104, 108.1539597832714, 56.02815871898449, 123.90831574575546, 99.18923678030995, 67.09334439272865, 63.16672946488777, 37.10738126840219, 59.425775259398385, 121.50298346875947, 119.83990980416264, 86.2994605787803, 100.23876439774438, 113.3685701763276, 101.21896829406286, 40.788333193865164, 41.770576341381485, 11.264866212587862, 39.44506242899857, 59.862887760115, 57.717139498280616, -1.0853096819306174, 105.31564802850465, -14.967735577651627, 106.93385617992392, 63.681852800808336, -24.013896938859048, 66.7287661211094, 75.91143030451346, 85.70980377960983, 144.960267654701, 100.2490607449555, 130.59086478276976, 82.61528808414917, -38.14864578774575, 68.76202027047835, 121.4757984396955, 110.93152260124099, 49.471390690284494, 27.037484357555172, 116.10358655731017, 50.21096165824601, 146.92699390066963, 71.60121530378481, 158.72759463075275, 146.2083718263612, 121.51045235941473, 168.2406716392976, 121.97258762723949, 99.25606319785848, 96.24532376037794, 20.240047483260156, 72.28680526791484, 119.01375823382577, 145.9517311197138, 78.3005790035422, 33.80223177776752, 150.5042638270613, 49.93979232387959, 148.55685147605857, 105.58994344034024, 162.5251036982185, 146.33557183067512, 5.081820219971757, 115.74891449481446, 139.06312099433228, 2.9684666723390905, 198.01999999999998, 128.32403180308313, 156.4662443757793, 31.125134327198154, 52.00213664644545, 116.60395790070186, 69.85149607214673, 122.17511160854525, 73.16285709095023, 84.26856824769659, 131.95124273451546, 72.26956833016348, 59.8789806908528, 70.23005496805148, 80.8456740152921, 104.85510363295165, 102.1014485230177, 124.82085420861523, 142.48392794805295, 91.9175913469238, 85.01656700744923, 85.63000189835643, 137.30483254542943, 90.26519826023272, 101.7021094355085, 101.19587568629852, 77.63174406566193, 132.65890357621925, 137.63, 131.80893811100952, 125.65674882765659, 183.17000000000002, 70.13956109076389, 184.93950231963652, 99.77129452762465, 71.74190087198599, 100.72755969979488, 141.63601776018868, 44.805861411429284, 47.503686061654264, -24.72116604721336, 131.9102372923572, 139.32667752935276, 138.40237465652052, 139.15399018388152, 128.39038476679485, 129.09789314624632, 169.6870428610522, 9.588882699741234, 52.552941636509104, 80.7118924499227, 133.4790819077938, 172.48504695949393, 162.9896739408281, 126.49366683110703, 122.48418412210202, 47.089911618655535, 94.6837630854323, 144.03665163512864, 154.50874720395547, 64.89367590291037, 81.98823103299985, 150.2535531729582, -0.36465923446388615, 15.092306490578048, 101.16080572811568, -2.9166014265408613, 143.5690801389942, 134.12476633255403, 54.10209667366314, 151.71486589273235, 136.0685814711959, 93.18700926789518, 117.54516382643129, 72.96023322151287, 38.67169170828392, 43.36495386997515, 152.45490677722395, 129.92979584512065, 126.66345577600974, 149.4143600815228, -54.75617585059351, 31.44152201780014, 80.67769127557855, 82.6246432164485, 77.61999525810502, 107.70021605535608, -4.176855342542158, 16.317803715949353, 93.74395482589176, 102.59853246400827, 83.86656751724755, 139.49848595039532, 11.737551273267318, 36.007059911796894, 109.49734917374924, 32.4141069134124, -12.64751768530887, -61.16559694794814, 63.841645898649695, 52.20926526664533, 190.91170379423244, 121.561737891521, 37.90022221589487, 64.4436757594597, 52.3103690624698, 50.61043150329477, 58.59805412144382, 77.13678230353469, 157.11344543386488, 124.54609901984904], "policy_predator_policy_reward": [87.0541100385229, 20.29340504095205, 67.25599514584358, 87.88691086791613, 66.39997611743853, 59.50513088328325, 24.74266674761967, 53.01685977877164, 78.08240768499961, 57.10747569947345, 75.37962288218218, 68.838710141783, 27.396386116307966, 22.57602972477341, 67.1846157686148, 35.39380875176969, 34.93186896270132, 32.89681793869114, 39.73776419278566, 58.395082179147046, 37.15746042220599, 35.538365224377834, 14.27966082589379, 22.213912518265406, 30.42857840247355, 47.957338379840714, 56.05729476956587, 46.60587592660866, 58.44227985309053, 43.90709729699569, 9.342592497864171, 47.99036150802876, 44.1620032460326, 43.40240002267427, 44.31146651042924, 38.51906142928684, 59.282720289789275, 64.46695246755856, 51.72844859020476, 12.135697230677387, 54.46785053044694, 80.3047750761904, 70.19466673957363, 58.32810558094101, 46.34077494495041, 46.916565340948885, 43.927022187883665, 37.57948352569643, 48.40900675749222, 128.15768406519962, 54.974473398226124, 55.992394593683585, 27.095280752192313, 17.14574527551337, 46.9799941755374, 48.84275851368787, 84.6827571704971, 79.57920356284464, 14.842223131089225, 35.99534356161215, 28.2334505842462, 19.94316538538053, 35.25668196241747, 41.17005877265909, 43.05383607700274, 36.56846324306323, 14.228102584438009, 5.305082764620886, 12.689858907663051, 10.633911742806525, 25.894258584444287, 8.556127198618249, 51.064680363926094, 55.01893624164713, 29.757762066594736, 15.660346626834293, 33.66283059733566, 34.669287098285714, 47.58671524771979, 57.78071493931844, 61.508135200308516, 57.055694490992956, 29.76325143614546, 28.605310205738654, 48.40105894093537, 41.72956684626416, 31.704760385980602, 17.516106636948702, 54.62283099675705, 53.074114646530425, 24.767484968154196, 27.890631977719014, 62.92295355633774, 21.21213465361341, 45.281801536487336, 40.41038590216687, 34.88911417345594, 45.57146394563377, 28.20449240379237, 23.818063030553795, 43.15588315312712, 79.43563081702686, 79.37563962250017, 62.18797185162369, 54.837004848530185, 52.308154322081364, 26.99357166847638, 17.895865242614367, 50.15609997142926, 36.11998918610686, 32.2881650857487, 34.23940759973662, 48.82985138311999, 37.81346733104333, 25.443990223885713, 54.28561929699098, 3.0593656080094402, 7.591349706643923, 29.80224431137155, 22.0555894694583, 37.314717606123615, 36.052890839401435, 11.181920785510755, 13.132898833325326, 20.206731870643694, 54.935349755782376, 33.28254133838487, 61.54594757441781, 95.61978939082101, 26.45294979009831, 8.854653040577546, 5.947971904182177, 13.537598909191125, 18.21977201087467, 20.67624970671168, 1.4448983310982135, 37.70214921836832, 27.691354388019057, 48.96522715461819, 49.7040446022172, 13.908654750492127, 14.158918039553289, 15.242074964318114, 15.198165120443925, 40.912652205988266, 17.862299960560268, 27.243042066794235, 21.87372039125813, 34.882798831624456, 38.97046693968192, 31.00695139870535, 34.46377552852737, 60.22227668183552, 76.61628314317771, 65.0178403509768, 61.909441378484274, 21.50920686489577, 21.782897867270687, 28.651737402110072, 13.242362145394422, 21.33703680945108, 38.108090231786335, 35.98697149490968, 35.90223573541156, 60.71427288396882, 18.859328829414633, 8.78511997671092, 7.522100297191495, 11.251629371236847, 13.479541135154335, 86.5968690541599, 81.86159592667231, 6.446564515832111, 59.33942703544854, 5.303825339220635, 42.00982444415916, 49.57290604029081, 26.8366081187144, 16.78802778280653, 29.908075513190145, 17.861534519995367, 12.561527973313611, 34.65157146472872, 67.601258038966, 21.327705568040887, 80.42442657990414, 3.4983769226327794, 98.20976290653932, 47.119277086505654, 80.2338851707972, 18.764253400194768, 15.639141367277295, 13.219911252479429, 21.31929116955033, 36.5716099238982, 15.723172478188362, 22.967294298078613, 54.27190088739991, 5.444263952997844, 6.0826535674625655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3827671928156957, "mean_inference_ms": 4.067347840517966, "mean_action_processing_ms": 0.5996765301059616, "mean_env_wait_ms": 0.4999165767543309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040828824043273926, "StateBufferConnector_ms": 0.025043964385986328, "ViewRequirementAgentConnector_ms": 0.6838164329528809}, "num_episodes": 18, "episode_return_max": 346.8768364532252, "episode_return_min": 27.89502519591501, "episode_return_mean": 252.4071417385134, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 92.74412416295456, "num_env_steps_trained_throughput_per_sec": 92.74412416295456, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 104912.163, "restore_workers_time_ms": 0.026, "training_step_time_ms": 104912.081, "sample_time_ms": 8906.584, "learn_time_ms": 95948.954, "learn_throughput": 41.689, "synch_weights_time_ms": 52.88}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "ef79f_00000", "date": "2024-08-16_11-56-00", "timestamp": 1723789560, "time_this_iter_s": 43.37751603126526, "time_total_s": 2333.9207632541656, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321460790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2333.9207632541656, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 60.362903225806456, "ram_util_percent": 79.13870967741936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7416411600731037, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.990376177792827, "policy_loss": -0.0033941173510842774, "vf_loss": 6.993211181832369, "vf_explained_var": 0.15190829713508566, "kl": 0.004969989982496541, "entropy": 0.7425468285247763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.889434504887414, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.998572336176716, "policy_loss": -0.004675041867676314, "vf_loss": 6.003247374327725, "vf_explained_var": 0.21496969177609399, "kl": 0.010377520093343445, "entropy": 0.4908198311057671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 361.5560867351791, "episode_reward_min": 27.89502519591501, "episode_reward_mean": 251.82952920016137, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -61.16559694794814, "predator_policy": 1.4448983310982135}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 128.15768406519962}, "policy_reward_mean": {"prey_policy": 89.97139927336548, "predator_policy": 35.94336532671526}, "custom_metrics": {}, "hist_stats": {"episode_reward": [252.12221469431236, 219.2815600049422, 272.58810207603295, 289.4503544273622, 309.02890555614414, 194.8753352160743, 283.2448877336378, 124.68549101746626, 242.74128895063276, 298.1505085245206, 324.4691518061728, 313.07489464918154, 255.6790366081604, 222.56898784921137, 236.71867219516952, 292.58442781887726, 289.673925791867, 317.0604734912397, 326.48360878044275, 241.5480178378461, 304.032902512076, 308.68541231562665, 337.4483931247356, 167.26235918359487, 272.1476414115028, 275.7985468185852, 268.2423664165582, 254.74006299117022, 292.63934045746703, 314.10171132658087, 312.1942190677589, 263.2102475119092, 289.4624071292711, 278.6106264099044, 258.55722927283716, 280.93961889087257, 309.32352071949606, 326.67716953628894, 309.0256164660972, 247.61154219820696, 281.2703680844206, 144.8552591953602, 286.0395397664695, 309.3137357604678, 279.60942595085106, 244.66942916718037, 231.93410584326725, 334.031701657333, 319.9235808566972, 228.34904790730587, 287.8371771786133, 293.25568887817235, 297.7125111331907, 151.56620708112817, 225.1714860310356, 320.98595120371465, 247.71106211389986, 288.70071778032843, 262.39460427826543, 161.61024729164242, 298.6919228962472, 300.8089863639231, 145.1438111480388, 229.0883260433077, 232.63386109684092, 88.55046253241231, 243.03859058589674, 253.7881159609518, 149.99744068875913, 243.66358823510654, 27.89502519591501, 243.40407342259775, 346.8768364532252, 136.88310039738423, 155.21558296785105, 212.97403161045696, 293.1864619741739, 361.5560867351791, 127.88779372625102, 215.41534863672098, 299.76788503578445, 197.19759422164373, 312.7562016575971, 69.81712292845522, 322.132343574696, 243.24273567116597, 307.30060193736534, 210.96663902603572, 244.4590047664603, 314.18899736700064, 338.8214002503212, 178.91953140821212, 271.48492648736976, 224.24702186179522, 117.64244568349122, 270.35913468747253, 157.2041507295607, 231.68483741715747, 56.728242994336384, 333.65002968979877], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [106.93385617992392, 63.681852800808336, -24.013896938859048, 66.7287661211094, 75.91143030451346, 85.70980377960983, 144.960267654701, 100.2490607449555, 130.59086478276976, 82.61528808414917, -38.14864578774575, 68.76202027047835, 121.4757984396955, 110.93152260124099, 49.471390690284494, 27.037484357555172, 116.10358655731017, 50.21096165824601, 146.92699390066963, 71.60121530378481, 158.72759463075275, 146.2083718263612, 121.51045235941473, 168.2406716392976, 121.97258762723949, 99.25606319785848, 96.24532376037794, 20.240047483260156, 72.28680526791484, 119.01375823382577, 145.9517311197138, 78.3005790035422, 33.80223177776752, 150.5042638270613, 49.93979232387959, 148.55685147605857, 105.58994344034024, 162.5251036982185, 146.33557183067512, 5.081820219971757, 115.74891449481446, 139.06312099433228, 2.9684666723390905, 198.01999999999998, 128.32403180308313, 156.4662443757793, 31.125134327198154, 52.00213664644545, 116.60395790070186, 69.85149607214673, 122.17511160854525, 73.16285709095023, 84.26856824769659, 131.95124273451546, 72.26956833016348, 59.8789806908528, 70.23005496805148, 80.8456740152921, 104.85510363295165, 102.1014485230177, 124.82085420861523, 142.48392794805295, 91.9175913469238, 85.01656700744923, 85.63000189835643, 137.30483254542943, 90.26519826023272, 101.7021094355085, 101.19587568629852, 77.63174406566193, 132.65890357621925, 137.63, 131.80893811100952, 125.65674882765659, 183.17000000000002, 70.13956109076389, 184.93950231963652, 99.77129452762465, 71.74190087198599, 100.72755969979488, 141.63601776018868, 44.805861411429284, 47.503686061654264, -24.72116604721336, 131.9102372923572, 139.32667752935276, 138.40237465652052, 139.15399018388152, 128.39038476679485, 129.09789314624632, 169.6870428610522, 9.588882699741234, 52.552941636509104, 80.7118924499227, 133.4790819077938, 172.48504695949393, 162.9896739408281, 126.49366683110703, 122.48418412210202, 47.089911618655535, 94.6837630854323, 144.03665163512864, 154.50874720395547, 64.89367590291037, 81.98823103299985, 150.2535531729582, -0.36465923446388615, 15.092306490578048, 101.16080572811568, -2.9166014265408613, 143.5690801389942, 134.12476633255403, 54.10209667366314, 151.71486589273235, 136.0685814711959, 93.18700926789518, 117.54516382643129, 72.96023322151287, 38.67169170828392, 43.36495386997515, 152.45490677722395, 129.92979584512065, 126.66345577600974, 149.4143600815228, -54.75617585059351, 31.44152201780014, 80.67769127557855, 82.6246432164485, 77.61999525810502, 107.70021605535608, -4.176855342542158, 16.317803715949353, 93.74395482589176, 102.59853246400827, 83.86656751724755, 139.49848595039532, 11.737551273267318, 36.007059911796894, 109.49734917374924, 32.4141069134124, -12.64751768530887, -61.16559694794814, 63.841645898649695, 52.20926526664533, 190.91170379423244, 121.561737891521, 37.90022221589487, 64.4436757594597, 52.3103690624698, 50.61043150329477, 58.59805412144382, 77.13678230353469, 157.11344543386488, 124.54609901984904, 175.49931728274456, 177.16581675678052, -12.019613927251893, -35.60679721695973, 86.09482114834627, 36.266277883748494, 186.95645419553844, 104.48360730525503, 56.02375010226582, 75.86694552321984, 149.4346730763353, 122.51132127571047, -47.12727462634716, -44.106943699330074, 152.34062817941071, 130.3527543012566, 93.21378999220937, 75.65267125090091, 146.8510082302655, 129.2676038088571, 76.04833001110077, 79.49889977575542, 114.54847113539675, 91.14396508905637, 142.8240780241932, 149.18967036048576, 119.80947695682478, 179.90391316615415, 83.44576003899776, 21.596820478072488, 119.6134609556249, 107.67231083437592, -34.86127327170652, 85.24088645504227, 4.350142562073053, 3.754762249159672, 92.49992707245598, 118.26856179188843, -39.434997861413095, 27.632232531089894, 114.60078234824223, 50.11850275976371, -56.73249870125495, 5.309209914204891, 143.69651374755153, 174.90824232609188], "policy_predator_policy_reward": [43.927022187883665, 37.57948352569643, 48.40900675749222, 128.15768406519962, 54.974473398226124, 55.992394593683585, 27.095280752192313, 17.14574527551337, 46.9799941755374, 48.84275851368787, 84.6827571704971, 79.57920356284464, 14.842223131089225, 35.99534356161215, 28.2334505842462, 19.94316538538053, 35.25668196241747, 41.17005877265909, 43.05383607700274, 36.56846324306323, 14.228102584438009, 5.305082764620886, 12.689858907663051, 10.633911742806525, 25.894258584444287, 8.556127198618249, 51.064680363926094, 55.01893624164713, 29.757762066594736, 15.660346626834293, 33.66283059733566, 34.669287098285714, 47.58671524771979, 57.78071493931844, 61.508135200308516, 57.055694490992956, 29.76325143614546, 28.605310205738654, 48.40105894093537, 41.72956684626416, 31.704760385980602, 17.516106636948702, 54.62283099675705, 53.074114646530425, 24.767484968154196, 27.890631977719014, 62.92295355633774, 21.21213465361341, 45.281801536487336, 40.41038590216687, 34.88911417345594, 45.57146394563377, 28.20449240379237, 23.818063030553795, 43.15588315312712, 79.43563081702686, 79.37563962250017, 62.18797185162369, 54.837004848530185, 52.308154322081364, 26.99357166847638, 17.895865242614367, 50.15609997142926, 36.11998918610686, 32.2881650857487, 34.23940759973662, 48.82985138311999, 37.81346733104333, 25.443990223885713, 54.28561929699098, 3.0593656080094402, 7.591349706643923, 29.80224431137155, 22.0555894694583, 37.314717606123615, 36.052890839401435, 11.181920785510755, 13.132898833325326, 20.206731870643694, 54.935349755782376, 33.28254133838487, 61.54594757441781, 95.61978939082101, 26.45294979009831, 8.854653040577546, 5.947971904182177, 13.537598909191125, 18.21977201087467, 20.67624970671168, 1.4448983310982135, 37.70214921836832, 27.691354388019057, 48.96522715461819, 49.7040446022172, 13.908654750492127, 14.158918039553289, 15.242074964318114, 15.198165120443925, 40.912652205988266, 17.862299960560268, 27.243042066794235, 21.87372039125813, 34.882798831624456, 38.97046693968192, 31.00695139870535, 34.46377552852737, 60.22227668183552, 76.61628314317771, 65.0178403509768, 61.909441378484274, 21.50920686489577, 21.782897867270687, 28.651737402110072, 13.242362145394422, 21.33703680945108, 38.108090231786335, 35.98697149490968, 35.90223573541156, 60.71427288396882, 18.859328829414633, 8.78511997671092, 7.522100297191495, 11.251629371236847, 13.479541135154335, 86.5968690541599, 81.86159592667231, 6.446564515832111, 59.33942703544854, 5.303825339220635, 42.00982444415916, 49.57290604029081, 26.8366081187144, 16.78802778280653, 29.908075513190145, 17.861534519995367, 12.561527973313611, 34.65157146472872, 67.601258038966, 21.327705568040887, 80.42442657990414, 3.4983769226327794, 98.20976290653932, 47.119277086505654, 80.2338851707972, 18.764253400194768, 15.639141367277295, 13.219911252479429, 21.31929116955033, 36.5716099238982, 15.723172478188362, 22.967294298078613, 54.27190088739991, 5.444263952997844, 6.0826535674625655, 4.30010239215117, 4.590850303502933, 57.658988829582455, 117.85521604088026, 40.79738908557242, 52.256860519053895, 6.1576379708530125, 2.1701855641388965, 21.080362598966545, 44.22653599719156, 23.90018766025468, 16.910019645296682, 88.0496585485077, 73.00168270562477, 24.118404581580037, 15.320556512449043, 16.018393007521794, 58.35788142053397, 21.161192701125326, 10.020797197117448, 46.86075373664802, 8.558655502531515, 28.312974254835282, 10.453594287172226, 8.265324696453742, 13.909924285868033, 19.747652047110943, 19.360358080231315, 32.27096308580082, 41.60598780534107, 20.238768302030152, 23.96038639533942, 80.53575260413251, 93.33165607432701, 35.194313453300694, 74.34322741895774, 28.048742847880284, 31.54190297524797, 64.50308898195085, 104.50382707793302, 57.738133382256635, 9.22741892689493, 6.190389769339792, 101.9611420120467, 13.486373108469884, 1.5589005076856168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4276219180258432, "mean_inference_ms": 4.195398852710041, "mean_action_processing_ms": 0.6175535140517006, "mean_env_wait_ms": 0.5152256361580992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06383287906646729, "StateBufferConnector_ms": 0.0664893388748169, "ViewRequirementAgentConnector_ms": 0.7554173469543457}, "num_episodes": 23, "episode_return_max": 361.5560867351791, "episode_return_min": 27.89502519591501, "episode_return_mean": 251.82952920016137, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 94.34881016305528, "num_env_steps_trained_throughput_per_sec": 94.34881016305528, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 104983.337, "restore_workers_time_ms": 0.026, "training_step_time_ms": 104983.258, "sample_time_ms": 8948.705, "learn_time_ms": 95978.077, "learn_throughput": 41.676, "synch_weights_time_ms": 52.835}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "ef79f_00000", "date": "2024-08-16_11-56-43", "timestamp": 1723789603, "time_this_iter_s": 42.42384099960327, "time_total_s": 2376.344604253769, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5375dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2376.344604253769, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 55.10166666666666, "ram_util_percent": 78.195}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.953982692862314, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.628224137725023, "policy_loss": -0.0012799767310430526, "vf_loss": 7.629212849985355, "vf_explained_var": 0.09320726432497539, "kl": 0.005178087692443063, "entropy": 0.7311262149974782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.950681871270376, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.025232100612903, "policy_loss": -0.004630850141414653, "vf_loss": 6.029862961188826, "vf_explained_var": 0.22753356600564623, "kl": 0.009603324438622454, "entropy": 0.5397819133662672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 361.5560867351791, "episode_reward_min": -40.367646037999044, "episode_reward_mean": 240.68224119503392, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -206.75000651976936, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.01999999999998, "predator_policy": 237.38273248568288}, "policy_reward_mean": {"prey_policy": 83.36518027916918, "predator_policy": 36.975940318347824}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.48360878044275, 241.5480178378461, 304.032902512076, 308.68541231562665, 337.4483931247356, 167.26235918359487, 272.1476414115028, 275.7985468185852, 268.2423664165582, 254.74006299117022, 292.63934045746703, 314.10171132658087, 312.1942190677589, 263.2102475119092, 289.4624071292711, 278.6106264099044, 258.55722927283716, 280.93961889087257, 309.32352071949606, 326.67716953628894, 309.0256164660972, 247.61154219820696, 281.2703680844206, 144.8552591953602, 286.0395397664695, 309.3137357604678, 279.60942595085106, 244.66942916718037, 231.93410584326725, 334.031701657333, 319.9235808566972, 228.34904790730587, 287.8371771786133, 293.25568887817235, 297.7125111331907, 151.56620708112817, 225.1714860310356, 320.98595120371465, 247.71106211389986, 288.70071778032843, 262.39460427826543, 161.61024729164242, 298.6919228962472, 300.8089863639231, 145.1438111480388, 229.0883260433077, 232.63386109684092, 88.55046253241231, 243.03859058589674, 253.7881159609518, 149.99744068875913, 243.66358823510654, 27.89502519591501, 243.40407342259775, 346.8768364532252, 136.88310039738423, 155.21558296785105, 212.97403161045696, 293.1864619741739, 361.5560867351791, 127.88779372625102, 215.41534863672098, 299.76788503578445, 197.19759422164373, 312.7562016575971, 69.81712292845522, 322.132343574696, 243.24273567116597, 307.30060193736534, 210.96663902603572, 244.4590047664603, 314.18899736700064, 338.8214002503212, 178.91953140821212, 271.48492648736976, 224.24702186179522, 117.64244568349122, 270.35913468747253, 157.2041507295607, 231.68483741715747, 56.728242994336384, 333.65002968979877, 168.75781126484972, 264.19744237073195, 247.13033275003593, 263.0856933224269, 229.401369926562, 346.4067217121724, 310.55180603106317, -40.367646037999044, 137.28784511326825, 329.8800969488756, 1.4505423141063674, 88.81304333642673, 233.45159515903117, 156.15153398676787, 196.66684417978692, 63.13165548099948, 306.95163315589895, 320.32109688325465], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [105.58994344034024, 162.5251036982185, 146.33557183067512, 5.081820219971757, 115.74891449481446, 139.06312099433228, 2.9684666723390905, 198.01999999999998, 128.32403180308313, 156.4662443757793, 31.125134327198154, 52.00213664644545, 116.60395790070186, 69.85149607214673, 122.17511160854525, 73.16285709095023, 84.26856824769659, 131.95124273451546, 72.26956833016348, 59.8789806908528, 70.23005496805148, 80.8456740152921, 104.85510363295165, 102.1014485230177, 124.82085420861523, 142.48392794805295, 91.9175913469238, 85.01656700744923, 85.63000189835643, 137.30483254542943, 90.26519826023272, 101.7021094355085, 101.19587568629852, 77.63174406566193, 132.65890357621925, 137.63, 131.80893811100952, 125.65674882765659, 183.17000000000002, 70.13956109076389, 184.93950231963652, 99.77129452762465, 71.74190087198599, 100.72755969979488, 141.63601776018868, 44.805861411429284, 47.503686061654264, -24.72116604721336, 131.9102372923572, 139.32667752935276, 138.40237465652052, 139.15399018388152, 128.39038476679485, 129.09789314624632, 169.6870428610522, 9.588882699741234, 52.552941636509104, 80.7118924499227, 133.4790819077938, 172.48504695949393, 162.9896739408281, 126.49366683110703, 122.48418412210202, 47.089911618655535, 94.6837630854323, 144.03665163512864, 154.50874720395547, 64.89367590291037, 81.98823103299985, 150.2535531729582, -0.36465923446388615, 15.092306490578048, 101.16080572811568, -2.9166014265408613, 143.5690801389942, 134.12476633255403, 54.10209667366314, 151.71486589273235, 136.0685814711959, 93.18700926789518, 117.54516382643129, 72.96023322151287, 38.67169170828392, 43.36495386997515, 152.45490677722395, 129.92979584512065, 126.66345577600974, 149.4143600815228, -54.75617585059351, 31.44152201780014, 80.67769127557855, 82.6246432164485, 77.61999525810502, 107.70021605535608, -4.176855342542158, 16.317803715949353, 93.74395482589176, 102.59853246400827, 83.86656751724755, 139.49848595039532, 11.737551273267318, 36.007059911796894, 109.49734917374924, 32.4141069134124, -12.64751768530887, -61.16559694794814, 63.841645898649695, 52.20926526664533, 190.91170379423244, 121.561737891521, 37.90022221589487, 64.4436757594597, 52.3103690624698, 50.61043150329477, 58.59805412144382, 77.13678230353469, 157.11344543386488, 124.54609901984904, 175.49931728274456, 177.16581675678052, -12.019613927251893, -35.60679721695973, 86.09482114834627, 36.266277883748494, 186.95645419553844, 104.48360730525503, 56.02375010226582, 75.86694552321984, 149.4346730763353, 122.51132127571047, -47.12727462634716, -44.106943699330074, 152.34062817941071, 130.3527543012566, 93.21378999220937, 75.65267125090091, 146.8510082302655, 129.2676038088571, 76.04833001110077, 79.49889977575542, 114.54847113539675, 91.14396508905637, 142.8240780241932, 149.18967036048576, 119.80947695682478, 179.90391316615415, 83.44576003899776, 21.596820478072488, 119.6134609556249, 107.67231083437592, -34.86127327170652, 85.24088645504227, 4.350142562073053, 3.754762249159672, 92.49992707245598, 118.26856179188843, -39.434997861413095, 27.632232531089894, 114.60078234824223, 50.11850275976371, -56.73249870125495, 5.309209914204891, 143.69651374755153, 174.90824232609188, 20.940173767450144, 83.17437611435531, 13.41652330899707, 68.16270487982405, 93.61694266602763, 92.67104954041721, 76.71871059373198, 133.87777573018457, 73.62302616411499, 110.0495444148772, 162.94719875208017, 171.03793767450134, 131.23235524706536, 117.05510198268159, -86.52059394260895, -206.75000651976936, 44.688366929232984, -80.16510475763573, 154.16925092019676, 169.53049028153214, -102.71681588464519, -98.19140959725988, -99.73486392267203, -31.59724457816631, 77.21284905284796, 110.59359098922768, 68.69661230615334, 58.219657660897994, 87.28759254592585, 45.910059689098404, -33.70312050942622, -28.357739621208413, 159.57613622929804, 128.4168144920056, 162.83228216000475, 119.33272346093094], "policy_predator_policy_reward": [29.76325143614546, 28.605310205738654, 48.40105894093537, 41.72956684626416, 31.704760385980602, 17.516106636948702, 54.62283099675705, 53.074114646530425, 24.767484968154196, 27.890631977719014, 62.92295355633774, 21.21213465361341, 45.281801536487336, 40.41038590216687, 34.88911417345594, 45.57146394563377, 28.20449240379237, 23.818063030553795, 43.15588315312712, 79.43563081702686, 79.37563962250017, 62.18797185162369, 54.837004848530185, 52.308154322081364, 26.99357166847638, 17.895865242614367, 50.15609997142926, 36.11998918610686, 32.2881650857487, 34.23940759973662, 48.82985138311999, 37.81346733104333, 25.443990223885713, 54.28561929699098, 3.0593656080094402, 7.591349706643923, 29.80224431137155, 22.0555894694583, 37.314717606123615, 36.052890839401435, 11.181920785510755, 13.132898833325326, 20.206731870643694, 54.935349755782376, 33.28254133838487, 61.54594757441781, 95.61978939082101, 26.45294979009831, 8.854653040577546, 5.947971904182177, 13.537598909191125, 18.21977201087467, 20.67624970671168, 1.4448983310982135, 37.70214921836832, 27.691354388019057, 48.96522715461819, 49.7040446022172, 13.908654750492127, 14.158918039553289, 15.242074964318114, 15.198165120443925, 40.912652205988266, 17.862299960560268, 27.243042066794235, 21.87372039125813, 34.882798831624456, 38.97046693968192, 31.00695139870535, 34.46377552852737, 60.22227668183552, 76.61628314317771, 65.0178403509768, 61.909441378484274, 21.50920686489577, 21.782897867270687, 28.651737402110072, 13.242362145394422, 21.33703680945108, 38.108090231786335, 35.98697149490968, 35.90223573541156, 60.71427288396882, 18.859328829414633, 8.78511997671092, 7.522100297191495, 11.251629371236847, 13.479541135154335, 86.5968690541599, 81.86159592667231, 6.446564515832111, 59.33942703544854, 5.303825339220635, 42.00982444415916, 49.57290604029081, 26.8366081187144, 16.78802778280653, 29.908075513190145, 17.861534519995367, 12.561527973313611, 34.65157146472872, 67.601258038966, 21.327705568040887, 80.42442657990414, 3.4983769226327794, 98.20976290653932, 47.119277086505654, 80.2338851707972, 18.764253400194768, 15.639141367277295, 13.219911252479429, 21.31929116955033, 36.5716099238982, 15.723172478188362, 22.967294298078613, 54.27190088739991, 5.444263952997844, 6.0826535674625655, 4.30010239215117, 4.590850303502933, 57.658988829582455, 117.85521604088026, 40.79738908557242, 52.256860519053895, 6.1576379708530125, 2.1701855641388965, 21.080362598966545, 44.22653599719156, 23.90018766025468, 16.910019645296682, 88.0496585485077, 73.00168270562477, 24.118404581580037, 15.320556512449043, 16.018393007521794, 58.35788142053397, 21.161192701125326, 10.020797197117448, 46.86075373664802, 8.558655502531515, 28.312974254835282, 10.453594287172226, 8.265324696453742, 13.909924285868033, 19.747652047110943, 19.360358080231315, 32.27096308580082, 41.60598780534107, 20.238768302030152, 23.96038639533942, 80.53575260413251, 93.33165607432701, 35.194313453300694, 74.34322741895774, 28.048742847880284, 31.54190297524797, 64.50308898195085, 104.50382707793302, 57.738133382256635, 9.22741892689493, 6.190389769339792, 101.9611420120467, 13.486373108469884, 1.5589005076856168, 15.549814187547472, 49.09344719549683, 64.1820617451801, 118.43615243673082, 31.17518111494268, 29.667159428648596, 26.376455694710728, 26.11275130379964, 14.824635056894525, 30.90416429067533, 5.198852049127076, 7.222733236463998, 24.914647484883744, 37.34970131643269, 237.38273248568288, 15.520221938696622, 150.15373680783492, 22.61084613383606, 0.14745957199929272, 6.032896175147471, 141.07314066863472, 61.28562712737682, 126.72230192355175, 93.42284991371339, 14.2270714372724, 31.418083679683267, 29.235264019716677, 0.0, 1.6445360634999802, 61.82465588126259, 0.4646524898786002, 124.7278631217555, 16.72124079663319, 2.2374416379621564, 23.693746850798895, 14.462344411520128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4622013916076206, "mean_inference_ms": 4.2920890321625675, "mean_action_processing_ms": 0.6309417242365619, "mean_env_wait_ms": 0.5268323491657432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05982255935668945, "StateBufferConnector_ms": 0.0663527250289917, "ViewRequirementAgentConnector_ms": 0.7685202360153198}, "num_episodes": 18, "episode_return_max": 361.5560867351791, "episode_return_min": -40.367646037999044, "episode_return_mean": 240.68224119503392, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 100.32215212684709, "num_env_steps_trained_throughput_per_sec": 100.32215212684709, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 105018.012, "restore_workers_time_ms": 0.027, "training_step_time_ms": 105017.932, "sample_time_ms": 9204.699, "learn_time_ms": 95757.275, "learn_throughput": 41.772, "synch_weights_time_ms": 52.413}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "ef79f_00000", "date": "2024-08-16_11-57-23", "timestamp": 1723789643, "time_this_iter_s": 39.912893772125244, "time_total_s": 2416.257498025894, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3214600d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2416.257498025894, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 55.71052631578947, "ram_util_percent": 77.33684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0584322981418124, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.944936634497667, "policy_loss": -0.0038076361722593744, "vf_loss": 8.948290214841329, "vf_explained_var": 0.09478500233125434, "kl": 0.00807252689496284, "entropy": 0.7311590150235191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.184208213336884, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.226217586779721, "policy_loss": -0.004652714574827798, "vf_loss": 6.230870306428778, "vf_explained_var": 0.2928680447358934, "kl": 0.008080882789030651, "entropy": 0.4727740990106391, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 361.5560867351791, "episode_reward_min": -82.13243977367358, "episode_reward_mean": 200.06871969183078, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -235.6610007999762, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.91170379423244, "predator_policy": 251.9456924024296}, "policy_reward_mean": {"prey_policy": 53.53842312168158, "predator_policy": 46.49593672423385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [281.2703680844206, 144.8552591953602, 286.0395397664695, 309.3137357604678, 279.60942595085106, 244.66942916718037, 231.93410584326725, 334.031701657333, 319.9235808566972, 228.34904790730587, 287.8371771786133, 293.25568887817235, 297.7125111331907, 151.56620708112817, 225.1714860310356, 320.98595120371465, 247.71106211389986, 288.70071778032843, 262.39460427826543, 161.61024729164242, 298.6919228962472, 300.8089863639231, 145.1438111480388, 229.0883260433077, 232.63386109684092, 88.55046253241231, 243.03859058589674, 253.7881159609518, 149.99744068875913, 243.66358823510654, 27.89502519591501, 243.40407342259775, 346.8768364532252, 136.88310039738423, 155.21558296785105, 212.97403161045696, 293.1864619741739, 361.5560867351791, 127.88779372625102, 215.41534863672098, 299.76788503578445, 197.19759422164373, 312.7562016575971, 69.81712292845522, 322.132343574696, 243.24273567116597, 307.30060193736534, 210.96663902603572, 244.4590047664603, 314.18899736700064, 338.8214002503212, 178.91953140821212, 271.48492648736976, 224.24702186179522, 117.64244568349122, 270.35913468747253, 157.2041507295607, 231.68483741715747, 56.728242994336384, 333.65002968979877, 168.75781126484972, 264.19744237073195, 247.13033275003593, 263.0856933224269, 229.401369926562, 346.4067217121724, 310.55180603106317, -40.367646037999044, 137.28784511326825, 329.8800969488756, 1.4505423141063674, 88.81304333642673, 233.45159515903117, 156.15153398676787, 196.66684417978692, 63.13165548099948, 306.95163315589895, 320.32109688325465, -0.034904315116246365, 24.940125929818812, 8.837514656847876, 9.280794677745488, 344.70139365877117, -16.539392630169665, 77.27958448495431, 37.49629870405815, 261.54838058971484, 147.1762588937875, 203.20583795235422, 36.915221896087345, 100.84379526501718, -35.912629397985114, 293.1911790815359, -18.79951007476161, 159.4518682224275, 250.11115056145368, 91.92225421756267, 29.04116045206139, 254.86646700602356, -82.13243977367358], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [141.63601776018868, 44.805861411429284, 47.503686061654264, -24.72116604721336, 131.9102372923572, 139.32667752935276, 138.40237465652052, 139.15399018388152, 128.39038476679485, 129.09789314624632, 169.6870428610522, 9.588882699741234, 52.552941636509104, 80.7118924499227, 133.4790819077938, 172.48504695949393, 162.9896739408281, 126.49366683110703, 122.48418412210202, 47.089911618655535, 94.6837630854323, 144.03665163512864, 154.50874720395547, 64.89367590291037, 81.98823103299985, 150.2535531729582, -0.36465923446388615, 15.092306490578048, 101.16080572811568, -2.9166014265408613, 143.5690801389942, 134.12476633255403, 54.10209667366314, 151.71486589273235, 136.0685814711959, 93.18700926789518, 117.54516382643129, 72.96023322151287, 38.67169170828392, 43.36495386997515, 152.45490677722395, 129.92979584512065, 126.66345577600974, 149.4143600815228, -54.75617585059351, 31.44152201780014, 80.67769127557855, 82.6246432164485, 77.61999525810502, 107.70021605535608, -4.176855342542158, 16.317803715949353, 93.74395482589176, 102.59853246400827, 83.86656751724755, 139.49848595039532, 11.737551273267318, 36.007059911796894, 109.49734917374924, 32.4141069134124, -12.64751768530887, -61.16559694794814, 63.841645898649695, 52.20926526664533, 190.91170379423244, 121.561737891521, 37.90022221589487, 64.4436757594597, 52.3103690624698, 50.61043150329477, 58.59805412144382, 77.13678230353469, 157.11344543386488, 124.54609901984904, 175.49931728274456, 177.16581675678052, -12.019613927251893, -35.60679721695973, 86.09482114834627, 36.266277883748494, 186.95645419553844, 104.48360730525503, 56.02375010226582, 75.86694552321984, 149.4346730763353, 122.51132127571047, -47.12727462634716, -44.106943699330074, 152.34062817941071, 130.3527543012566, 93.21378999220937, 75.65267125090091, 146.8510082302655, 129.2676038088571, 76.04833001110077, 79.49889977575542, 114.54847113539675, 91.14396508905637, 142.8240780241932, 149.18967036048576, 119.80947695682478, 179.90391316615415, 83.44576003899776, 21.596820478072488, 119.6134609556249, 107.67231083437592, -34.86127327170652, 85.24088645504227, 4.350142562073053, 3.754762249159672, 92.49992707245598, 118.26856179188843, -39.434997861413095, 27.632232531089894, 114.60078234824223, 50.11850275976371, -56.73249870125495, 5.309209914204891, 143.69651374755153, 174.90824232609188, 20.940173767450144, 83.17437611435531, 13.41652330899707, 68.16270487982405, 93.61694266602763, 92.67104954041721, 76.71871059373198, 133.87777573018457, 73.62302616411499, 110.0495444148772, 162.94719875208017, 171.03793767450134, 131.23235524706536, 117.05510198268159, -86.52059394260895, -206.75000651976936, 44.688366929232984, -80.16510475763573, 154.16925092019676, 169.53049028153214, -102.71681588464519, -98.19140959725988, -99.73486392267203, -31.59724457816631, 77.21284905284796, 110.59359098922768, 68.69661230615334, 58.219657660897994, 87.28759254592585, 45.910059689098404, -33.70312050942622, -28.357739621208413, 159.57613622929804, 128.4168144920056, 162.83228216000475, 119.33272346093094, -235.6610007999762, -162.95771486320385, -230.04843339578682, -114.09588287028423, -85.56290853450614, -93.85190189701387, -151.4018220805526, -134.182007589332, 144.06837306259303, 188.20070484796793, -43.35791389471995, -93.69063596685416, -85.19796040475796, -46.81965560152203, -38.861927470259985, -36.851337140691584, 108.30096493622239, 134.92192805783756, -0.1202997868421889, 54.102343250119944, 88.21909153102112, 55.69264027194011, -36.98633501947253, 9.815267912578296, -38.11339510359555, 25.30833053042093, -165.77797680133156, -146.10325254889477, 108.45578711716384, 157.69807125571808, -124.67328960957188, -138.8428828029157, 54.130904954822874, 47.50138053637824, 135.42957825239338, 64.22262364186254, -59.03786711815396, -134.62486914264468, -97.54007755399948, -188.70557018525034, 124.50352939012592, 104.3559196980179, -137.2915800933338, -142.26270872393363], "policy_predator_policy_reward": [33.28254133838487, 61.54594757441781, 95.61978939082101, 26.45294979009831, 8.854653040577546, 5.947971904182177, 13.537598909191125, 18.21977201087467, 20.67624970671168, 1.4448983310982135, 37.70214921836832, 27.691354388019057, 48.96522715461819, 49.7040446022172, 13.908654750492127, 14.158918039553289, 15.242074964318114, 15.198165120443925, 40.912652205988266, 17.862299960560268, 27.243042066794235, 21.87372039125813, 34.882798831624456, 38.97046693968192, 31.00695139870535, 34.46377552852737, 60.22227668183552, 76.61628314317771, 65.0178403509768, 61.909441378484274, 21.50920686489577, 21.782897867270687, 28.651737402110072, 13.242362145394422, 21.33703680945108, 38.108090231786335, 35.98697149490968, 35.90223573541156, 60.71427288396882, 18.859328829414633, 8.78511997671092, 7.522100297191495, 11.251629371236847, 13.479541135154335, 86.5968690541599, 81.86159592667231, 6.446564515832111, 59.33942703544854, 5.303825339220635, 42.00982444415916, 49.57290604029081, 26.8366081187144, 16.78802778280653, 29.908075513190145, 17.861534519995367, 12.561527973313611, 34.65157146472872, 67.601258038966, 21.327705568040887, 80.42442657990414, 3.4983769226327794, 98.20976290653932, 47.119277086505654, 80.2338851707972, 18.764253400194768, 15.639141367277295, 13.219911252479429, 21.31929116955033, 36.5716099238982, 15.723172478188362, 22.967294298078613, 54.27190088739991, 5.444263952997844, 6.0826535674625655, 4.30010239215117, 4.590850303502933, 57.658988829582455, 117.85521604088026, 40.79738908557242, 52.256860519053895, 6.1576379708530125, 2.1701855641388965, 21.080362598966545, 44.22653599719156, 23.90018766025468, 16.910019645296682, 88.0496585485077, 73.00168270562477, 24.118404581580037, 15.320556512449043, 16.018393007521794, 58.35788142053397, 21.161192701125326, 10.020797197117448, 46.86075373664802, 8.558655502531515, 28.312974254835282, 10.453594287172226, 8.265324696453742, 13.909924285868033, 19.747652047110943, 19.360358080231315, 32.27096308580082, 41.60598780534107, 20.238768302030152, 23.96038639533942, 80.53575260413251, 93.33165607432701, 35.194313453300694, 74.34322741895774, 28.048742847880284, 31.54190297524797, 64.50308898195085, 104.50382707793302, 57.738133382256635, 9.22741892689493, 6.190389769339792, 101.9611420120467, 13.486373108469884, 1.5589005076856168, 15.549814187547472, 49.09344719549683, 64.1820617451801, 118.43615243673082, 31.17518111494268, 29.667159428648596, 26.376455694710728, 26.11275130379964, 14.824635056894525, 30.90416429067533, 5.198852049127076, 7.222733236463998, 24.914647484883744, 37.34970131643269, 237.38273248568288, 15.520221938696622, 150.15373680783492, 22.61084613383606, 0.14745957199929272, 6.032896175147471, 141.07314066863472, 61.28562712737682, 126.72230192355175, 93.42284991371339, 14.2270714372724, 31.418083679683267, 29.235264019716677, 0.0, 1.6445360634999802, 61.82465588126259, 0.4646524898786002, 124.7278631217555, 16.72124079663319, 2.2374416379621564, 23.693746850798895, 14.462344411520128, 251.14464203941336, 147.43916930865038, 117.13874979346035, 251.9456924024296, 58.49562209258453, 129.7567029957835, 225.91721284773783, 68.94741149989206, 6.293890352272718, 6.138425395937683, 102.66431737905545, 17.844839852348937, 121.52735776836465, 87.7698427228696, 1.9784994251773624, 111.23106388983234, 14.453154682143209, 3.872332913512385, 66.28883971010019, 26.905375720409676, 34.9572282363551, 24.33687791303797, 2.695544797639997, 61.3907442053417, 68.63783729678826, 45.01102254140339, 56.244368118198, 219.7242318340431, 9.807333048310626, 17.22998766034394, 186.49013382451588, 58.226528513209885, 53.2165911335612, 4.602991597665171, 28.999801964170942, 21.4591467030272, 144.2645771380607, 141.32041334030063, 115.41204858302387, 199.874759608287, 24.942507375908132, 1.0645105419716352, 1.4676611968129785, 195.95418784678083]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.50172898905823, "mean_inference_ms": 4.401077179132768, "mean_action_processing_ms": 0.645853788002546, "mean_env_wait_ms": 0.5395806672445067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060810089111328125, "StateBufferConnector_ms": 0.06751561164855957, "ViewRequirementAgentConnector_ms": 0.7216522693634033}, "num_episodes": 22, "episode_return_max": 361.5560867351791, "episode_return_min": -82.13243977367358, "episode_return_mean": 200.06871969183078, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.51516938560664, "num_env_steps_trained_throughput_per_sec": 102.51516938560664, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 105161.386, "restore_workers_time_ms": 0.027, "training_step_time_ms": 105161.306, "sample_time_ms": 9415.805, "learn_time_ms": 95688.454, "learn_throughput": 41.802, "synch_weights_time_ms": 53.558}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "ef79f_00000", "date": "2024-08-16_11-58-02", "timestamp": 1723789682, "time_this_iter_s": 39.04887509346008, "time_total_s": 2455.3063731193542, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32147fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2455.3063731193542, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 57.01818181818182, "ram_util_percent": 77.39090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.555842998324248, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.001442524995753, "policy_loss": -0.0031666001677020357, "vf_loss": 9.00372859662172, "vf_explained_var": 0.04391386143114201, "kl": 0.01565360256530093, "entropy": 0.7387934169125936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.2441952651139925, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.311858297025085, "policy_loss": -0.0043293869802876125, "vf_loss": 6.316187682479778, "vf_explained_var": 0.3928109813619543, "kl": 0.006003926456756807, "entropy": 0.4290440018372561, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 361.5560867351791, "episode_reward_min": -82.13243977367358, "episode_reward_mean": 171.23202932158347, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -235.6610007999762, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.91170379423244, "predator_policy": 262.5612733042431}, "policy_reward_mean": {"prey_policy": 28.13394289656002, "predator_policy": 57.48207176423175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [262.39460427826543, 161.61024729164242, 298.6919228962472, 300.8089863639231, 145.1438111480388, 229.0883260433077, 232.63386109684092, 88.55046253241231, 243.03859058589674, 253.7881159609518, 149.99744068875913, 243.66358823510654, 27.89502519591501, 243.40407342259775, 346.8768364532252, 136.88310039738423, 155.21558296785105, 212.97403161045696, 293.1864619741739, 361.5560867351791, 127.88779372625102, 215.41534863672098, 299.76788503578445, 197.19759422164373, 312.7562016575971, 69.81712292845522, 322.132343574696, 243.24273567116597, 307.30060193736534, 210.96663902603572, 244.4590047664603, 314.18899736700064, 338.8214002503212, 178.91953140821212, 271.48492648736976, 224.24702186179522, 117.64244568349122, 270.35913468747253, 157.2041507295607, 231.68483741715747, 56.728242994336384, 333.65002968979877, 168.75781126484972, 264.19744237073195, 247.13033275003593, 263.0856933224269, 229.401369926562, 346.4067217121724, 310.55180603106317, -40.367646037999044, 137.28784511326825, 329.8800969488756, 1.4505423141063674, 88.81304333642673, 233.45159515903117, 156.15153398676787, 196.66684417978692, 63.13165548099948, 306.95163315589895, 320.32109688325465, -0.034904315116246365, 24.940125929818812, 8.837514656847876, 9.280794677745488, 344.70139365877117, -16.539392630169665, 77.27958448495431, 37.49629870405815, 261.54838058971484, 147.1762588937875, 203.20583795235422, 36.915221896087345, 100.84379526501718, -35.912629397985114, 293.1911790815359, -18.79951007476161, 159.4518682224275, 250.11115056145368, 91.92225421756267, 29.04116045206139, 254.86646700602356, -82.13243977367358, 313.52728908066194, -63.644869728696754, 204.2293399676556, 281.79865592896977, -3.754766070504077, 252.57725603590018, 1.616275263429563, 13.989142299418772, 250.4728760605672, -57.37895117150428, 9.656784923355408, 0.4908895514442104, 305.2933523007961, 53.077680315890326, -46.99470233860296, 129.44290183146802, 23.34173409708683, 221.52707021736674], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [117.54516382643129, 72.96023322151287, 38.67169170828392, 43.36495386997515, 152.45490677722395, 129.92979584512065, 126.66345577600974, 149.4143600815228, -54.75617585059351, 31.44152201780014, 80.67769127557855, 82.6246432164485, 77.61999525810502, 107.70021605535608, -4.176855342542158, 16.317803715949353, 93.74395482589176, 102.59853246400827, 83.86656751724755, 139.49848595039532, 11.737551273267318, 36.007059911796894, 109.49734917374924, 32.4141069134124, -12.64751768530887, -61.16559694794814, 63.841645898649695, 52.20926526664533, 190.91170379423244, 121.561737891521, 37.90022221589487, 64.4436757594597, 52.3103690624698, 50.61043150329477, 58.59805412144382, 77.13678230353469, 157.11344543386488, 124.54609901984904, 175.49931728274456, 177.16581675678052, -12.019613927251893, -35.60679721695973, 86.09482114834627, 36.266277883748494, 186.95645419553844, 104.48360730525503, 56.02375010226582, 75.86694552321984, 149.4346730763353, 122.51132127571047, -47.12727462634716, -44.106943699330074, 152.34062817941071, 130.3527543012566, 93.21378999220937, 75.65267125090091, 146.8510082302655, 129.2676038088571, 76.04833001110077, 79.49889977575542, 114.54847113539675, 91.14396508905637, 142.8240780241932, 149.18967036048576, 119.80947695682478, 179.90391316615415, 83.44576003899776, 21.596820478072488, 119.6134609556249, 107.67231083437592, -34.86127327170652, 85.24088645504227, 4.350142562073053, 3.754762249159672, 92.49992707245598, 118.26856179188843, -39.434997861413095, 27.632232531089894, 114.60078234824223, 50.11850275976371, -56.73249870125495, 5.309209914204891, 143.69651374755153, 174.90824232609188, 20.940173767450144, 83.17437611435531, 13.41652330899707, 68.16270487982405, 93.61694266602763, 92.67104954041721, 76.71871059373198, 133.87777573018457, 73.62302616411499, 110.0495444148772, 162.94719875208017, 171.03793767450134, 131.23235524706536, 117.05510198268159, -86.52059394260895, -206.75000651976936, 44.688366929232984, -80.16510475763573, 154.16925092019676, 169.53049028153214, -102.71681588464519, -98.19140959725988, -99.73486392267203, -31.59724457816631, 77.21284905284796, 110.59359098922768, 68.69661230615334, 58.219657660897994, 87.28759254592585, 45.910059689098404, -33.70312050942622, -28.357739621208413, 159.57613622929804, 128.4168144920056, 162.83228216000475, 119.33272346093094, -235.6610007999762, -162.95771486320385, -230.04843339578682, -114.09588287028423, -85.56290853450614, -93.85190189701387, -151.4018220805526, -134.182007589332, 144.06837306259303, 188.20070484796793, -43.35791389471995, -93.69063596685416, -85.19796040475796, -46.81965560152203, -38.861927470259985, -36.851337140691584, 108.30096493622239, 134.92192805783756, -0.1202997868421889, 54.102343250119944, 88.21909153102112, 55.69264027194011, -36.98633501947253, 9.815267912578296, -38.11339510359555, 25.30833053042093, -165.77797680133156, -146.10325254889477, 108.45578711716384, 157.69807125571808, -124.67328960957188, -138.8428828029157, 54.130904954822874, 47.50138053637824, 135.42957825239338, 64.22262364186254, -59.03786711815396, -134.62486914264468, -97.54007755399948, -188.70557018525034, 124.50352939012592, 104.3559196980179, -137.2915800933338, -142.26270872393363, 171.77200491809236, 125.31515430510633, -141.88812679396528, -174.44817028294065, 96.96260097430813, 54.84658666440881, 146.74518421488636, 95.16052055168579, -87.36799043690574, -88.92218422589963, 120.18950707787663, 93.18039524444731, -146.0998074689062, -179.78756835966365, -27.144726013214644, -51.548849070772285, 147.62679310886364, 66.45093470170652, -182.88228858774764, -103.93724649737368, -147.08582063416657, -174.05998671350483, -181.65151338091522, -180.60554607768694, 162.3498174392753, 129.0857365394345, -168.30316519358988, -147.50879582197717, -224.05639662015324, -169.20695582793508, 17.816612808707635, 22.84029514571831, -227.25860192330308, -155.16016094765695, 53.178935655535284, -16.3220683395602], "policy_predator_policy_reward": [35.98697149490968, 35.90223573541156, 60.71427288396882, 18.859328829414633, 8.78511997671092, 7.522100297191495, 11.251629371236847, 13.479541135154335, 86.5968690541599, 81.86159592667231, 6.446564515832111, 59.33942703544854, 5.303825339220635, 42.00982444415916, 49.57290604029081, 26.8366081187144, 16.78802778280653, 29.908075513190145, 17.861534519995367, 12.561527973313611, 34.65157146472872, 67.601258038966, 21.327705568040887, 80.42442657990414, 3.4983769226327794, 98.20976290653932, 47.119277086505654, 80.2338851707972, 18.764253400194768, 15.639141367277295, 13.219911252479429, 21.31929116955033, 36.5716099238982, 15.723172478188362, 22.967294298078613, 54.27190088739991, 5.444263952997844, 6.0826535674625655, 4.30010239215117, 4.590850303502933, 57.658988829582455, 117.85521604088026, 40.79738908557242, 52.256860519053895, 6.1576379708530125, 2.1701855641388965, 21.080362598966545, 44.22653599719156, 23.90018766025468, 16.910019645296682, 88.0496585485077, 73.00168270562477, 24.118404581580037, 15.320556512449043, 16.018393007521794, 58.35788142053397, 21.161192701125326, 10.020797197117448, 46.86075373664802, 8.558655502531515, 28.312974254835282, 10.453594287172226, 8.265324696453742, 13.909924285868033, 19.747652047110943, 19.360358080231315, 32.27096308580082, 41.60598780534107, 20.238768302030152, 23.96038639533942, 80.53575260413251, 93.33165607432701, 35.194313453300694, 74.34322741895774, 28.048742847880284, 31.54190297524797, 64.50308898195085, 104.50382707793302, 57.738133382256635, 9.22741892689493, 6.190389769339792, 101.9611420120467, 13.486373108469884, 1.5589005076856168, 15.549814187547472, 49.09344719549683, 64.1820617451801, 118.43615243673082, 31.17518111494268, 29.667159428648596, 26.376455694710728, 26.11275130379964, 14.824635056894525, 30.90416429067533, 5.198852049127076, 7.222733236463998, 24.914647484883744, 37.34970131643269, 237.38273248568288, 15.520221938696622, 150.15373680783492, 22.61084613383606, 0.14745957199929272, 6.032896175147471, 141.07314066863472, 61.28562712737682, 126.72230192355175, 93.42284991371339, 14.2270714372724, 31.418083679683267, 29.235264019716677, 0.0, 1.6445360634999802, 61.82465588126259, 0.4646524898786002, 124.7278631217555, 16.72124079663319, 2.2374416379621564, 23.693746850798895, 14.462344411520128, 251.14464203941336, 147.43916930865038, 117.13874979346035, 251.9456924024296, 58.49562209258453, 129.7567029957835, 225.91721284773783, 68.94741149989206, 6.293890352272718, 6.138425395937683, 102.66431737905545, 17.844839852348937, 121.52735776836465, 87.7698427228696, 1.9784994251773624, 111.23106388983234, 14.453154682143209, 3.872332913512385, 66.28883971010019, 26.905375720409676, 34.9572282363551, 24.33687791303797, 2.695544797639997, 61.3907442053417, 68.63783729678826, 45.01102254140339, 56.244368118198, 219.7242318340431, 9.807333048310626, 17.22998766034394, 186.49013382451588, 58.226528513209885, 53.2165911335612, 4.602991597665171, 28.999801964170942, 21.4591467030272, 144.2645771380607, 141.32041334030063, 115.41204858302387, 199.874759608287, 24.942507375908132, 1.0645105419716352, 1.4676611968129785, 195.95418784678083, 6.086676273521976, 10.353453583941306, 53.195534153346465, 199.49589319486262, 44.519198749625325, 7.9009535793131445, 15.036976805388962, 24.855974357008723, 50.69830429120398, 121.83710430109738, 16.600472711853552, 22.606881001722993, 147.45812281396164, 180.04552827803786, 11.42711301861612, 81.25560436478963, 19.7472356172746, 16.6479126327226, 218.2770189893121, 11.163564924304568, 130.8313815888916, 199.9712106821351, 100.18667570580318, 262.5612733042431, 13.446180177230532, 0.4116181448560514, 199.20678166718767, 169.68285966426967, 231.1599379953623, 115.10871211412336, 72.14241300585664, 16.643580871185485, 193.75003033803412, 212.01046663001264, 84.9713374547502, 99.69886544664173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5369238310844866, "mean_inference_ms": 4.496370036763087, "mean_action_processing_ms": 0.6598377072784248, "mean_env_wait_ms": 0.5512709694442556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05688738822937012, "StateBufferConnector_ms": 0.06251895427703857, "ViewRequirementAgentConnector_ms": 0.6843589544296265}, "num_episodes": 18, "episode_return_max": 361.5560867351791, "episode_return_min": -82.13243977367358, "episode_return_mean": 171.23202932158347, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 98.03345103467754, "num_env_steps_trained_throughput_per_sec": 98.03345103467754, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 105191.171, "restore_workers_time_ms": 0.027, "training_step_time_ms": 105191.092, "sample_time_ms": 9838.367, "learn_time_ms": 95297.143, "learn_throughput": 41.974, "synch_weights_time_ms": 52.192}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "ef79f_00000", "date": "2024-08-16_11-58-43", "timestamp": 1723789723, "time_this_iter_s": 40.8148889541626, "time_total_s": 2496.121262073517, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a545b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2496.121262073517, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 54.34137931034482, "ram_util_percent": 77.60517241379311}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.691174643758743, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.546159962245396, "policy_loss": -0.0030760200755798783, "vf_loss": 8.548767421359107, "vf_explained_var": 0.050414143100617426, "kl": 0.008329486752668048, "entropy": 0.7386689876437817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.974340950559687, "cur_kl_coeff": 1.1444091796874997e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.794135519562575, "policy_loss": -0.0038926318599522194, "vf_loss": 5.798028159267688, "vf_explained_var": 0.33946437157651105, "kl": 0.0080591108588276, "entropy": 0.4226343583808374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 349.1012333559273, "episode_reward_min": -82.13243977367358, "episode_reward_mean": 150.10937417686532, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -270.4505267801232, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.20070484796793, "predator_policy": 262.5612733042431}, "policy_reward_mean": {"prey_policy": 7.938069400090485, "predator_policy": 67.11661768834222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [197.19759422164373, 312.7562016575971, 69.81712292845522, 322.132343574696, 243.24273567116597, 307.30060193736534, 210.96663902603572, 244.4590047664603, 314.18899736700064, 338.8214002503212, 178.91953140821212, 271.48492648736976, 224.24702186179522, 117.64244568349122, 270.35913468747253, 157.2041507295607, 231.68483741715747, 56.728242994336384, 333.65002968979877, 168.75781126484972, 264.19744237073195, 247.13033275003593, 263.0856933224269, 229.401369926562, 346.4067217121724, 310.55180603106317, -40.367646037999044, 137.28784511326825, 329.8800969488756, 1.4505423141063674, 88.81304333642673, 233.45159515903117, 156.15153398676787, 196.66684417978692, 63.13165548099948, 306.95163315589895, 320.32109688325465, -0.034904315116246365, 24.940125929818812, 8.837514656847876, 9.280794677745488, 344.70139365877117, -16.539392630169665, 77.27958448495431, 37.49629870405815, 261.54838058971484, 147.1762588937875, 203.20583795235422, 36.915221896087345, 100.84379526501718, -35.912629397985114, 293.1911790815359, -18.79951007476161, 159.4518682224275, 250.11115056145368, 91.92225421756267, 29.04116045206139, 254.86646700602356, -82.13243977367358, 313.52728908066194, -63.644869728696754, 204.2293399676556, 281.79865592896977, -3.754766070504077, 252.57725603590018, 1.616275263429563, 13.989142299418772, 250.4728760605672, -57.37895117150428, 9.656784923355408, 0.4908895514442104, 305.2933523007961, 53.077680315890326, -46.99470233860296, 129.44290183146802, 23.34173409708683, 221.52707021736674, 14.763952673665058, 310.3868489231172, 305.52680140152194, 314.95559076241744, 250.07205606255067, 349.1012333559273, 92.59685157648346, -40.17452589934545, 194.9236207577406, 334.1483101360609, 256.99107410902155, 274.35016047122286, -54.95192244394322, 83.55745328337822, -64.60613938889371, 145.7062079155537, -66.75451936775914, -61.767025642488655, -72.38079309047826, -53.49000483568789, 243.5509855883678, 200.79191002069268, -39.09145756400535], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [56.02375010226582, 75.86694552321984, 149.4346730763353, 122.51132127571047, -47.12727462634716, -44.106943699330074, 152.34062817941071, 130.3527543012566, 93.21378999220937, 75.65267125090091, 146.8510082302655, 129.2676038088571, 76.04833001110077, 79.49889977575542, 114.54847113539675, 91.14396508905637, 142.8240780241932, 149.18967036048576, 119.80947695682478, 179.90391316615415, 83.44576003899776, 21.596820478072488, 119.6134609556249, 107.67231083437592, -34.86127327170652, 85.24088645504227, 4.350142562073053, 3.754762249159672, 92.49992707245598, 118.26856179188843, -39.434997861413095, 27.632232531089894, 114.60078234824223, 50.11850275976371, -56.73249870125495, 5.309209914204891, 143.69651374755153, 174.90824232609188, 20.940173767450144, 83.17437611435531, 13.41652330899707, 68.16270487982405, 93.61694266602763, 92.67104954041721, 76.71871059373198, 133.87777573018457, 73.62302616411499, 110.0495444148772, 162.94719875208017, 171.03793767450134, 131.23235524706536, 117.05510198268159, -86.52059394260895, -206.75000651976936, 44.688366929232984, -80.16510475763573, 154.16925092019676, 169.53049028153214, -102.71681588464519, -98.19140959725988, -99.73486392267203, -31.59724457816631, 77.21284905284796, 110.59359098922768, 68.69661230615334, 58.219657660897994, 87.28759254592585, 45.910059689098404, -33.70312050942622, -28.357739621208413, 159.57613622929804, 128.4168144920056, 162.83228216000475, 119.33272346093094, -235.6610007999762, -162.95771486320385, -230.04843339578682, -114.09588287028423, -85.56290853450614, -93.85190189701387, -151.4018220805526, -134.182007589332, 144.06837306259303, 188.20070484796793, -43.35791389471995, -93.69063596685416, -85.19796040475796, -46.81965560152203, -38.861927470259985, -36.851337140691584, 108.30096493622239, 134.92192805783756, -0.1202997868421889, 54.102343250119944, 88.21909153102112, 55.69264027194011, -36.98633501947253, 9.815267912578296, -38.11339510359555, 25.30833053042093, -165.77797680133156, -146.10325254889477, 108.45578711716384, 157.69807125571808, -124.67328960957188, -138.8428828029157, 54.130904954822874, 47.50138053637824, 135.42957825239338, 64.22262364186254, -59.03786711815396, -134.62486914264468, -97.54007755399948, -188.70557018525034, 124.50352939012592, 104.3559196980179, -137.2915800933338, -142.26270872393363, 171.77200491809236, 125.31515430510633, -141.88812679396528, -174.44817028294065, 96.96260097430813, 54.84658666440881, 146.74518421488636, 95.16052055168579, -87.36799043690574, -88.92218422589963, 120.18950707787663, 93.18039524444731, -146.0998074689062, -179.78756835966365, -27.144726013214644, -51.548849070772285, 147.62679310886364, 66.45093470170652, -182.88228858774764, -103.93724649737368, -147.08582063416657, -174.05998671350483, -181.65151338091522, -180.60554607768694, 162.3498174392753, 129.0857365394345, -168.30316519358988, -147.50879582197717, -224.05639662015324, -169.20695582793508, 17.816612808707635, 22.84029514571831, -227.25860192330308, -155.16016094765695, 53.178935655535284, -16.3220683395602, -197.79029375142346, -267.080222018128, 140.9078818809206, 136.83718114666388, 124.34129015027328, 162.03681267129278, 145.6615727514174, 157.61094398483272, 121.39184995512404, 93.00504089306655, 162.08551308844122, 166.87918784417752, 27.663888699740323, 1.7386461982803818, -110.30886285857083, -147.71787339877469, 69.46147640165722, 89.23705530508379, 139.06542794606025, 171.20251796691247, 130.01982015336293, 107.14577918888043, 141.40853398778165, 92.93092647283505, -104.81657048389263, -126.28756960991666, -190.66072519399668, -157.01938901831383, -128.19524749826942, -100.1759744976432, 16.574907364139424, 63.32356578957856, -153.69283946807073, -111.72416239995644, -155.46052807230416, -131.82529176202175, -134.02525594073686, -249.64635542453405, -178.6431670043824, -183.91500576858152, 107.40132078360459, 76.28931345698376, 99.05199448782028, 47.20294008435495, -256.1870164497966, -270.4505267801232], "policy_predator_policy_reward": [21.080362598966545, 44.22653599719156, 23.90018766025468, 16.910019645296682, 88.0496585485077, 73.00168270562477, 24.118404581580037, 15.320556512449043, 16.018393007521794, 58.35788142053397, 21.161192701125326, 10.020797197117448, 46.86075373664802, 8.558655502531515, 28.312974254835282, 10.453594287172226, 8.265324696453742, 13.909924285868033, 19.747652047110943, 19.360358080231315, 32.27096308580082, 41.60598780534107, 20.238768302030152, 23.96038639533942, 80.53575260413251, 93.33165607432701, 35.194313453300694, 74.34322741895774, 28.048742847880284, 31.54190297524797, 64.50308898195085, 104.50382707793302, 57.738133382256635, 9.22741892689493, 6.190389769339792, 101.9611420120467, 13.486373108469884, 1.5589005076856168, 15.549814187547472, 49.09344719549683, 64.1820617451801, 118.43615243673082, 31.17518111494268, 29.667159428648596, 26.376455694710728, 26.11275130379964, 14.824635056894525, 30.90416429067533, 5.198852049127076, 7.222733236463998, 24.914647484883744, 37.34970131643269, 237.38273248568288, 15.520221938696622, 150.15373680783492, 22.61084613383606, 0.14745957199929272, 6.032896175147471, 141.07314066863472, 61.28562712737682, 126.72230192355175, 93.42284991371339, 14.2270714372724, 31.418083679683267, 29.235264019716677, 0.0, 1.6445360634999802, 61.82465588126259, 0.4646524898786002, 124.7278631217555, 16.72124079663319, 2.2374416379621564, 23.693746850798895, 14.462344411520128, 251.14464203941336, 147.43916930865038, 117.13874979346035, 251.9456924024296, 58.49562209258453, 129.7567029957835, 225.91721284773783, 68.94741149989206, 6.293890352272718, 6.138425395937683, 102.66431737905545, 17.844839852348937, 121.52735776836465, 87.7698427228696, 1.9784994251773624, 111.23106388983234, 14.453154682143209, 3.872332913512385, 66.28883971010019, 26.905375720409676, 34.9572282363551, 24.33687791303797, 2.695544797639997, 61.3907442053417, 68.63783729678826, 45.01102254140339, 56.244368118198, 219.7242318340431, 9.807333048310626, 17.22998766034394, 186.49013382451588, 58.226528513209885, 53.2165911335612, 4.602991597665171, 28.999801964170942, 21.4591467030272, 144.2645771380607, 141.32041334030063, 115.41204858302387, 199.874759608287, 24.942507375908132, 1.0645105419716352, 1.4676611968129785, 195.95418784678083, 6.086676273521976, 10.353453583941306, 53.195534153346465, 199.49589319486262, 44.519198749625325, 7.9009535793131445, 15.036976805388962, 24.855974357008723, 50.69830429120398, 121.83710430109738, 16.600472711853552, 22.606881001722993, 147.45812281396164, 180.04552827803786, 11.42711301861612, 81.25560436478963, 19.7472356172746, 16.6479126327226, 218.2770189893121, 11.163564924304568, 130.8313815888916, 199.9712106821351, 100.18667570580318, 262.5612733042431, 13.446180177230532, 0.4116181448560514, 199.20678166718767, 169.68285966426967, 231.1599379953623, 115.10871211412336, 72.14241300585664, 16.643580871185485, 193.75003033803412, 212.01046663001264, 84.9713374547502, 99.69886544664173, 231.34384685908992, 248.29062158412654, 12.7103806962506, 19.931405199282207, 4.63492275832708, 14.513775821629075, 6.842924505796674, 4.840149520370828, 22.174144261608006, 13.501020952752032, 7.763604571110681, 12.372927852197751, 56.62220866163745, 6.5721080168256325, 9.711703439050648, 208.140506918949, 10.53139057154248, 25.693698479457293, 12.724888969097295, 11.155475253991021, 4.372831793969803, 15.452642972808661, 33.97440206252435, 6.036297948082067, 8.639045091018978, 167.51317255884737, 206.22134822206286, 225.01621927362595, 11.248789486422142, 152.5162931205968, 5.038009101661474, 60.76972566017427, 9.741435581371066, 188.9210469188969, 190.4222000420509, 35.09659414978639, 257.1046483552657, 54.18616991952683, 68.95562211589659, 240.11254582137943, 31.100264267101387, 28.760087080678105, 30.16490241615102, 24.37207303236652, 259.42751127148193, 228.11857439443216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.582419185544464, "mean_inference_ms": 4.606729120697565, "mean_action_processing_ms": 0.6771702539374196, "mean_env_wait_ms": 0.5651332333362334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043792009353637695, "StateBufferConnector_ms": 0.05639636516571045, "ViewRequirementAgentConnector_ms": 0.8027676343917847}, "num_episodes": 23, "episode_return_max": 349.1012333559273, "episode_return_min": -82.13243977367358, "episode_return_mean": 150.10937417686532, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 96.28912725633235, "num_env_steps_trained_throughput_per_sec": 96.28912725633235, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 105321.621, "restore_workers_time_ms": 0.027, "training_step_time_ms": 105321.544, "sample_time_ms": 10402.186, "learn_time_ms": 94865.296, "learn_throughput": 42.165, "synch_weights_time_ms": 51.072}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "ef79f_00000", "date": "2024-08-16_11-59-25", "timestamp": 1723789765, "time_this_iter_s": 41.61871790885925, "time_total_s": 2537.739979982376, "pid": 19559, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x321793940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2537.739979982376, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 54.42881355932204, "ram_util_percent": 77.49491525423727}}
