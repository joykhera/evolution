{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9749446568921352, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3251178370751004, "policy_loss": -0.014459490677896248, "vf_loss": 3.337393709696647, "vf_explained_var": -0.0007350244651587246, "kl": 0.010918103111513758, "entropy": 1.5954174246270054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 4695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 12.0, "episode_reward_min": -1033.0, "episode_reward_mean": -362.55555555555554, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3618, "policy_reward_min": {"policy_0": -495.0}, "policy_reward_max": {"policy_0": 60.0}, "policy_reward_mean": {"policy_0": -36.25555555555555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -285.0, 12.0, -306.0, -251.0, -127.0, -173.0, -180.0, -250.0, -630.0, -631.0, -201.0, -160.0, -1033.0, -180.0, -250.0, -493.0, -888.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, -45.0, -415.0, 0.0, -50.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -40.0, 0.0, 10.0, -180.0, -105.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, -7.0, -21.0, 0.0, 0.0, -25.0, -240.0, 0.0, 0.0, 0.0, 0.0, -40.0, -1.0, 17.0, -75.0, 0.0, -5.0, 0.0, -3.0, -205.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, -33.0, 10.0, -47.0, 10.0, -4.0, 10.0, -93.0, 10.0, -110.0, 10.0, 10.0, 2.0, 0.0, -6.0, -24.0, 0.0, -65.0, 60.0, 0.0, -315.0, 10.0, 9.0, 16.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -230.0, 0.0, -30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -95.0, -310.0, 0.0, -170.0, -75.0, 0.0, 0.0, 10.0, -1.0, -5.0, -35.0, -90.0, -11.0, -14.0, 10.0, -495.0, 0.0, 30.0, -4.0, -85.0, 0.0, -11.0, -155.0, 20.0, -6.0, 10.0, 20.0, -45.0, -100.0, 10.0, 10.0, 0.0, 0.0, 0.0, -55.0, 0.0, -355.0, -150.0, 0.0, -6.0, -65.0, -220.0, 0.0, 20.0, -7.0, -250.0, 0.0, 10.0, 0.0, 0.0, -55.0, 0.0, 0.0, -90.0, -55.0, 10.0, 10.0, 10.0, 20.0, -15.0, 0.0, 10.0, 0.0, -215.0, -70.0, 0.0, 0.0, -225.0, 0.0, -1.0, -15.0, 0.0, 0.0, -250.0, 0.0, -2.0, 0.0, -240.0, 7.0, 0.0, -260.0, 0.0, -6.0, -120.0, -255.0, -14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.273754893685977, "mean_inference_ms": 2.715969232116374, "mean_action_processing_ms": 0.9133558070218566, "mean_env_wait_ms": 2.226277471464953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019439061482747395, "StateBufferConnector_ms": 0.012536843617757162, "ViewRequirementAgentConnector_ms": 1.2321988741556804}, "num_episodes": 18, "episode_return_max": 12.0, "episode_return_min": -1033.0, "episode_return_mean": -362.55555555555554}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.466062873150895, "num_env_steps_trained_throughput_per_sec": 15.466062873150895, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 258630.794, "restore_workers_time_ms": 0.016, "training_step_time_ms": 258630.724, "sample_time_ms": 5837.459, "learn_time_ms": 252768.877, "learn_throughput": 15.825, "synch_weights_time_ms": 14.959}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "1841f_00000", "date": "2024-08-07_23-24-32", "timestamp": 1723087472, "time_this_iter_s": 258.63716411590576, "time_total_s": 258.63716411590576, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2413550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.63716411590576, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 50.189402173913045, "ram_util_percent": 81.37989130434782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2955884417786767, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.348445385967454, "policy_loss": -0.009151393625899753, "vf_loss": 2.356550276507966, "vf_explained_var": 0.03004088898182423, "kl": 0.0052325131815790125, "entropy": 1.5907513093135863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 14085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 43.0, "episode_reward_min": -1033.0, "episode_reward_mean": -200.16666666666666, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 7236, "policy_reward_min": {"policy_0": -495.0}, "policy_reward_max": {"policy_0": 60.0}, "policy_reward_mean": {"policy_0": -20.016666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -285.0, 12.0, -306.0, -251.0, -127.0, -173.0, -180.0, -250.0, -630.0, -631.0, -201.0, -160.0, -1033.0, -180.0, -250.0, -493.0, -888.0, -15.0, -10.0, -25.0, -21.0, -52.0, -47.0, -171.0, -80.0, -49.0, -27.0, -58.0, -61.0, -35.0, -10.0, 43.0, -13.0, 2.0, -51.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, -45.0, -415.0, 0.0, -50.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -40.0, 0.0, 10.0, -180.0, -105.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, -7.0, -21.0, 0.0, 0.0, -25.0, -240.0, 0.0, 0.0, 0.0, 0.0, -40.0, -1.0, 17.0, -75.0, 0.0, -5.0, 0.0, -3.0, -205.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, -33.0, 10.0, -47.0, 10.0, -4.0, 10.0, -93.0, 10.0, -110.0, 10.0, 10.0, 2.0, 0.0, -6.0, -24.0, 0.0, -65.0, 60.0, 0.0, -315.0, 10.0, 9.0, 16.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -230.0, 0.0, -30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -95.0, -310.0, 0.0, -170.0, -75.0, 0.0, 0.0, 10.0, -1.0, -5.0, -35.0, -90.0, -11.0, -14.0, 10.0, -495.0, 0.0, 30.0, -4.0, -85.0, 0.0, -11.0, -155.0, 20.0, -6.0, 10.0, 20.0, -45.0, -100.0, 10.0, 10.0, 0.0, 0.0, 0.0, -55.0, 0.0, -355.0, -150.0, 0.0, -6.0, -65.0, -220.0, 0.0, 20.0, -7.0, -250.0, 0.0, 10.0, 0.0, 0.0, -55.0, 0.0, 0.0, -90.0, -55.0, 10.0, 10.0, 10.0, 20.0, -15.0, 0.0, 10.0, 0.0, -215.0, -70.0, 0.0, 0.0, -225.0, 0.0, -1.0, -15.0, 0.0, 0.0, -250.0, 0.0, -2.0, 0.0, -240.0, 7.0, 0.0, -260.0, 0.0, -6.0, -120.0, -255.0, -14.0, 20.0, 0.0, 0.0, 20.0, -50.0, 10.0, 0.0, -45.0, 10.0, 20.0, 0.0, -14.0, 0.0, -3.0, 10.0, 10.0, -2.0, 0.0, -11.0, 0.0, -40.0, -35.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -5.0, 10.0, 0.0, 10.0, -12.0, -6.0, -12.0, 0.0, -6.0, 20.0, -14.0, 0.0, 0.0, -10.0, 0.0, -4.0, -50.0, 6.0, 0.0, -25.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, -20.0, -4.0, -6.0, 7.0, 0.0, 0.0, 0.0, 0.0, -13.0, -40.0, -80.0, -45.0, 0.0, 0.0, -85.0, 10.0, -24.0, 0.0, 0.0, 0.0, -21.0, 20.0, 20.0, 10.0, -6.0, -32.0, -40.0, 0.0, -6.0, 5.0, 0.0, 0.0, 20.0, 0.0, -26.0, 0.0, 10.0, 0.0, 6.0, -8.0, 0.0, -5.0, -4.0, 0.0, 10.0, 0.0, 10.0, -1.0, -2.0, 0.0, 0.0, -50.0, -25.0, 10.0, -16.0, 0.0, 0.0, 0.0, -19.0, -20.0, -16.0, 0.0, 0.0, 0.0, -40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, -2.0, 10.0, -35.0, 10.0, 0.0, 0.0, 0.0, -3.0, 0.0, 10.0, 5.0, 0.0, 10.0, 20.0, 20.0, -25.0, 0.0, 0.0, 3.0, 10.0, -6.0, 10.0, 0.0, -30.0, 10.0, 0.0, -7.0, 0.0, 0.0, 10.0, -25.0, 30.0, -12.0, 0.0, -17.0, -24.0, 20.0, 20.0, 0.0, 10.0, 20.0, 0.0, -55.0, -20.0, 0.0, 0.0, 0.0, -6.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0518773215229107, "mean_inference_ms": 2.5873118747645303, "mean_action_processing_ms": 0.8823710746692318, "mean_env_wait_ms": 2.1025927274845446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021084811952379014, "StateBufferConnector_ms": 0.012488497628106011, "ViewRequirementAgentConnector_ms": 0.874687565697564}, "num_episodes": 18, "episode_return_max": 43.0, "episode_return_min": -1033.0, "episode_return_mean": -200.16666666666666}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.876018072983895, "num_env_steps_trained_throughput_per_sec": 15.876018072983895, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 255291.576, "restore_workers_time_ms": 0.015, "training_step_time_ms": 255291.514, "sample_time_ms": 4797.346, "learn_time_ms": 250471.325, "learn_throughput": 15.97, "synch_weights_time_ms": 14.626}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "1841f_00000", "date": "2024-08-07_23-28-44", "timestamp": 1723087724, "time_this_iter_s": 251.98398613929749, "time_total_s": 510.62115025520325, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b240e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 510.62115025520325, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 49.206460674157306, "ram_util_percent": 80.40814606741573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.070148010775685, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7992824732432096, "policy_loss": -0.008278730206704313, "vf_loss": 1.8062159930682158, "vf_explained_var": 0.026106807224539775, "kl": 0.006726056868755309, "entropy": 1.578171051818088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 23475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 90.0, "episode_reward_min": -1033.0, "episode_reward_mean": -129.87037037037038, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10854, "policy_reward_min": {"policy_0": -495.0}, "policy_reward_max": {"policy_0": 60.0}, "policy_reward_mean": {"policy_0": -12.987037037037037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -285.0, 12.0, -306.0, -251.0, -127.0, -173.0, -180.0, -250.0, -630.0, -631.0, -201.0, -160.0, -1033.0, -180.0, -250.0, -493.0, -888.0, -15.0, -10.0, -25.0, -21.0, -52.0, -47.0, -171.0, -80.0, -49.0, -27.0, -58.0, -61.0, -35.0, -10.0, 43.0, -13.0, 2.0, -51.0, 22.0, 10.0, 9.0, 36.0, 90.0, 60.0, 0.0, 65.0, 0.0, -2.0, 5.0, 3.0, -28.0, 39.0, -87.0, 32.0, -33.0, -28.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, -45.0, -415.0, 0.0, -50.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -40.0, 0.0, 10.0, -180.0, -105.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, -7.0, -21.0, 0.0, 0.0, -25.0, -240.0, 0.0, 0.0, 0.0, 0.0, -40.0, -1.0, 17.0, -75.0, 0.0, -5.0, 0.0, -3.0, -205.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, -33.0, 10.0, -47.0, 10.0, -4.0, 10.0, -93.0, 10.0, -110.0, 10.0, 10.0, 2.0, 0.0, -6.0, -24.0, 0.0, -65.0, 60.0, 0.0, -315.0, 10.0, 9.0, 16.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -230.0, 0.0, -30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -95.0, -310.0, 0.0, -170.0, -75.0, 0.0, 0.0, 10.0, -1.0, -5.0, -35.0, -90.0, -11.0, -14.0, 10.0, -495.0, 0.0, 30.0, -4.0, -85.0, 0.0, -11.0, -155.0, 20.0, -6.0, 10.0, 20.0, -45.0, -100.0, 10.0, 10.0, 0.0, 0.0, 0.0, -55.0, 0.0, -355.0, -150.0, 0.0, -6.0, -65.0, -220.0, 0.0, 20.0, -7.0, -250.0, 0.0, 10.0, 0.0, 0.0, -55.0, 0.0, 0.0, -90.0, -55.0, 10.0, 10.0, 10.0, 20.0, -15.0, 0.0, 10.0, 0.0, -215.0, -70.0, 0.0, 0.0, -225.0, 0.0, -1.0, -15.0, 0.0, 0.0, -250.0, 0.0, -2.0, 0.0, -240.0, 7.0, 0.0, -260.0, 0.0, -6.0, -120.0, -255.0, -14.0, 20.0, 0.0, 0.0, 20.0, -50.0, 10.0, 0.0, -45.0, 10.0, 20.0, 0.0, -14.0, 0.0, -3.0, 10.0, 10.0, -2.0, 0.0, -11.0, 0.0, -40.0, -35.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -5.0, 10.0, 0.0, 10.0, -12.0, -6.0, -12.0, 0.0, -6.0, 20.0, -14.0, 0.0, 0.0, -10.0, 0.0, -4.0, -50.0, 6.0, 0.0, -25.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, -20.0, -4.0, -6.0, 7.0, 0.0, 0.0, 0.0, 0.0, -13.0, -40.0, -80.0, -45.0, 0.0, 0.0, -85.0, 10.0, -24.0, 0.0, 0.0, 0.0, -21.0, 20.0, 20.0, 10.0, -6.0, -32.0, -40.0, 0.0, -6.0, 5.0, 0.0, 0.0, 20.0, 0.0, -26.0, 0.0, 10.0, 0.0, 6.0, -8.0, 0.0, -5.0, -4.0, 0.0, 10.0, 0.0, 10.0, -1.0, -2.0, 0.0, 0.0, -50.0, -25.0, 10.0, -16.0, 0.0, 0.0, 0.0, -19.0, -20.0, -16.0, 0.0, 0.0, 0.0, -40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, -2.0, 10.0, -35.0, 10.0, 0.0, 0.0, 0.0, -3.0, 0.0, 10.0, 5.0, 0.0, 10.0, 20.0, 20.0, -25.0, 0.0, 0.0, 3.0, 10.0, -6.0, 10.0, 0.0, -30.0, 10.0, 0.0, -7.0, 0.0, 0.0, 10.0, -25.0, 30.0, -12.0, 0.0, -17.0, -24.0, 20.0, 20.0, 0.0, 10.0, 20.0, 0.0, -55.0, -20.0, 0.0, 0.0, 0.0, -6.0, 0.0, 10.0, 0.0, -11.0, 10.0, 10.0, 10.0, 0.0, 0.0, -7.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, -30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -14.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, -17.0, 10.0, -10.0, 10.0, 0.0, 0.0, -3.0, 10.0, -6.0, 0.0, 10.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 10.0, 5.0, 10.0, -20.0, 0.0, 0.0, 0.0, -5.0, 0.0, -2.0, -9.0, 10.0, 10.0, 4.0, -8.0, -1.0, 4.0, -5.0, 0.0, 0.0, 0.0, 0.0, -12.0, 7.0, -8.0, 0.0, -10.0, 0.0, 0.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -90.0, 0.0, 0.0, -13.0, -4.0, 2.0, 0.0, 10.0, 0.0, 5.0, 0.0, 20.0, 0.0, -5.0, 0.0, 0.0, 0.0, -13.0, 0.0, 20.0, 0.0, -15.0, 0.0, -25.0, 0.0, 0.0, 0.0, -2.0, -18.0, 0.0, -20.0, 0.0, -4.0, 6.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.951479696901151, "mean_inference_ms": 2.515413854590215, "mean_action_processing_ms": 0.865711692129357, "mean_env_wait_ms": 2.0475986373701387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02152036737512659, "StateBufferConnector_ms": 0.02024394494515878, "ViewRequirementAgentConnector_ms": 0.8496487582171405}, "num_episodes": 18, "episode_return_max": 90.0, "episode_return_min": -1033.0, "episode_return_mean": -129.87037037037038}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.650030765995366, "num_env_steps_trained_throughput_per_sec": 15.650030765995366, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 255391.239, "restore_workers_time_ms": 0.015, "training_step_time_ms": 255391.18, "sample_time_ms": 4618.181, "learn_time_ms": 250747.961, "learn_throughput": 15.952, "synch_weights_time_ms": 13.994}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "1841f_00000", "date": "2024-08-07_23-33-00", "timestamp": 1723087980, "time_this_iter_s": 255.62779092788696, "time_total_s": 766.2489411830902, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b240e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 766.2489411830902, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 49.77651933701657, "ram_util_percent": 80.97790055248619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.282715045066434, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.496425504463549, "policy_loss": -0.008054358849110512, "vf_loss": 2.5032963683683906, "vf_explained_var": 0.05424378532063339, "kl": 0.005917496175978962, "entropy": 1.5748842926071094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 32865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 102.0, "episode_reward_min": -1033.0, "episode_reward_mean": -88.72222222222223, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 14472, "policy_reward_min": {"policy_0": -495.0}, "policy_reward_max": {"policy_0": 60.0}, "policy_reward_mean": {"policy_0": -8.872222222222222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -285.0, 12.0, -306.0, -251.0, -127.0, -173.0, -180.0, -250.0, -630.0, -631.0, -201.0, -160.0, -1033.0, -180.0, -250.0, -493.0, -888.0, -15.0, -10.0, -25.0, -21.0, -52.0, -47.0, -171.0, -80.0, -49.0, -27.0, -58.0, -61.0, -35.0, -10.0, 43.0, -13.0, 2.0, -51.0, 22.0, 10.0, 9.0, 36.0, 90.0, 60.0, 0.0, 65.0, 0.0, -2.0, 5.0, 3.0, -28.0, 39.0, -87.0, 32.0, -33.0, -28.0, -11.0, 48.0, 102.0, 100.0, 40.0, 70.0, 42.0, 27.0, 57.0, 50.0, 0.0, 32.0, 25.0, -39.0, 25.0, 44.0, 39.0, -26.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, -45.0, -415.0, 0.0, -50.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -40.0, 0.0, 10.0, -180.0, -105.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, -7.0, -21.0, 0.0, 0.0, -25.0, -240.0, 0.0, 0.0, 0.0, 0.0, -40.0, -1.0, 17.0, -75.0, 0.0, -5.0, 0.0, -3.0, -205.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, -33.0, 10.0, -47.0, 10.0, -4.0, 10.0, -93.0, 10.0, -110.0, 10.0, 10.0, 2.0, 0.0, -6.0, -24.0, 0.0, -65.0, 60.0, 0.0, -315.0, 10.0, 9.0, 16.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -230.0, 0.0, -30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -95.0, -310.0, 0.0, -170.0, -75.0, 0.0, 0.0, 10.0, -1.0, -5.0, -35.0, -90.0, -11.0, -14.0, 10.0, -495.0, 0.0, 30.0, -4.0, -85.0, 0.0, -11.0, -155.0, 20.0, -6.0, 10.0, 20.0, -45.0, -100.0, 10.0, 10.0, 0.0, 0.0, 0.0, -55.0, 0.0, -355.0, -150.0, 0.0, -6.0, -65.0, -220.0, 0.0, 20.0, -7.0, -250.0, 0.0, 10.0, 0.0, 0.0, -55.0, 0.0, 0.0, -90.0, -55.0, 10.0, 10.0, 10.0, 20.0, -15.0, 0.0, 10.0, 0.0, -215.0, -70.0, 0.0, 0.0, -225.0, 0.0, -1.0, -15.0, 0.0, 0.0, -250.0, 0.0, -2.0, 0.0, -240.0, 7.0, 0.0, -260.0, 0.0, -6.0, -120.0, -255.0, -14.0, 20.0, 0.0, 0.0, 20.0, -50.0, 10.0, 0.0, -45.0, 10.0, 20.0, 0.0, -14.0, 0.0, -3.0, 10.0, 10.0, -2.0, 0.0, -11.0, 0.0, -40.0, -35.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -5.0, 10.0, 0.0, 10.0, -12.0, -6.0, -12.0, 0.0, -6.0, 20.0, -14.0, 0.0, 0.0, -10.0, 0.0, -4.0, -50.0, 6.0, 0.0, -25.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, -20.0, -4.0, -6.0, 7.0, 0.0, 0.0, 0.0, 0.0, -13.0, -40.0, -80.0, -45.0, 0.0, 0.0, -85.0, 10.0, -24.0, 0.0, 0.0, 0.0, -21.0, 20.0, 20.0, 10.0, -6.0, -32.0, -40.0, 0.0, -6.0, 5.0, 0.0, 0.0, 20.0, 0.0, -26.0, 0.0, 10.0, 0.0, 6.0, -8.0, 0.0, -5.0, -4.0, 0.0, 10.0, 0.0, 10.0, -1.0, -2.0, 0.0, 0.0, -50.0, -25.0, 10.0, -16.0, 0.0, 0.0, 0.0, -19.0, -20.0, -16.0, 0.0, 0.0, 0.0, -40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, -2.0, 10.0, -35.0, 10.0, 0.0, 0.0, 0.0, -3.0, 0.0, 10.0, 5.0, 0.0, 10.0, 20.0, 20.0, -25.0, 0.0, 0.0, 3.0, 10.0, -6.0, 10.0, 0.0, -30.0, 10.0, 0.0, -7.0, 0.0, 0.0, 10.0, -25.0, 30.0, -12.0, 0.0, -17.0, -24.0, 20.0, 20.0, 0.0, 10.0, 20.0, 0.0, -55.0, -20.0, 0.0, 0.0, 0.0, -6.0, 0.0, 10.0, 0.0, -11.0, 10.0, 10.0, 10.0, 0.0, 0.0, -7.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, -30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -14.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, -17.0, 10.0, -10.0, 10.0, 0.0, 0.0, -3.0, 10.0, -6.0, 0.0, 10.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 10.0, 5.0, 10.0, -20.0, 0.0, 0.0, 0.0, -5.0, 0.0, -2.0, -9.0, 10.0, 10.0, 4.0, -8.0, -1.0, 4.0, -5.0, 0.0, 0.0, 0.0, 0.0, -12.0, 7.0, -8.0, 0.0, -10.0, 0.0, 0.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -90.0, 0.0, 0.0, -13.0, -4.0, 2.0, 0.0, 10.0, 0.0, 5.0, 0.0, 20.0, 0.0, -5.0, 0.0, 0.0, 0.0, -13.0, 0.0, 20.0, 0.0, -15.0, 0.0, -25.0, 0.0, 0.0, 0.0, -2.0, -18.0, 0.0, -20.0, 0.0, -4.0, 6.0, 10.0, 8.0, 0.0, -2.0, 0.0, -2.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 1.0, 10.0, 0.0, 10.0, 10.0, 0.0, -3.0, 30.0, 30.0, 10.0, 25.0, -3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, -10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 5.0, -2.0, 10.0, -2.0, -9.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 13.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -5.0, 0.0, 20.0, 4.0, 10.0, 6.0, 10.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, -11.0, 0.0, 0.0, 0.0, -1.0, -8.0, 0.0, 10.0, -5.0, 0.0, -7.0, 2.0, 0.0, 20.0, 0.0, 20.0, -8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -2.0, 20.0, -3.0, 0.0, 5.0, -4.0, -8.0, 0.0, 0.0, -3.0, 0.0, -18.0, -11.0, 10.0, -13.0, 9.0, 0.0, 10.0, -1.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 7.0, 0.0, -3.0, 0.0, 0.0, 0.0, 10.0, 10.0, -1.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, -6.0, -5.0, -7.0, 0.0, 7.0, -21.0, -3.0, -1.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9009085732582154, "mean_inference_ms": 2.4780237545471153, "mean_action_processing_ms": 0.8588348815710527, "mean_env_wait_ms": 2.022908495868589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020688772201538086, "StateBufferConnector_ms": 0.02020928594801161, "ViewRequirementAgentConnector_ms": 0.8544501331117418}, "num_episodes": 18, "episode_return_max": 102.0, "episode_return_min": -1033.0, "episode_return_mean": -88.72222222222223}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.884019719550674, "num_env_steps_trained_throughput_per_sec": 15.884019719550674, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 254499.789, "restore_workers_time_ms": 0.07, "training_step_time_ms": 254499.616, "sample_time_ms": 4643.993, "learn_time_ms": 249832.35, "learn_throughput": 16.011, "synch_weights_time_ms": 13.526}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "1841f_00000", "date": "2024-08-07_23-37-12", "timestamp": 1723088232, "time_this_iter_s": 251.83432507514954, "time_total_s": 1018.0832662582397, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a3790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1018.0832662582397, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 48.53089887640449, "ram_util_percent": 79.38567415730337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.044017346306477, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.126576324265859, "policy_loss": -0.010686773566119532, "vf_loss": 3.1357881594643677, "vf_explained_var": 0.06762226704464426, "kl": 0.007374682464343445, "entropy": 1.5560758301879143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 42255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 122.0, "episode_reward_min": -1033.0, "episode_reward_mean": -50.82828282828283, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 19899, "policy_reward_min": {"policy_0": -495.0}, "policy_reward_max": {"policy_0": 60.0}, "policy_reward_mean": {"policy_0": -5.082828282828283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.0, -285.0, 12.0, -306.0, -251.0, -127.0, -173.0, -180.0, -250.0, -630.0, -631.0, -201.0, -160.0, -1033.0, -180.0, -250.0, -493.0, -888.0, -15.0, -10.0, -25.0, -21.0, -52.0, -47.0, -171.0, -80.0, -49.0, -27.0, -58.0, -61.0, -35.0, -10.0, 43.0, -13.0, 2.0, -51.0, 22.0, 10.0, 9.0, 36.0, 90.0, 60.0, 0.0, 65.0, 0.0, -2.0, 5.0, 3.0, -28.0, 39.0, -87.0, 32.0, -33.0, -28.0, -11.0, 48.0, 102.0, 100.0, 40.0, 70.0, 42.0, 27.0, 57.0, 50.0, 0.0, 32.0, 25.0, -39.0, 25.0, 44.0, 39.0, -26.0, 44.0, 114.0, 69.0, 30.0, 78.0, 60.0, -30.0, 29.0, 113.0, 40.0, 120.0, 24.0, 40.0, 86.0, 122.0, 16.0, 43.0, 40.0, -83.0, 44.0, 66.0, -17.0, 36.0, 88.0, 70.0, 40.0, 74.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, -45.0, -415.0, 0.0, -50.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -40.0, 0.0, 10.0, -180.0, -105.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, -7.0, -21.0, 0.0, 0.0, -25.0, -240.0, 0.0, 0.0, 0.0, 0.0, -40.0, -1.0, 17.0, -75.0, 0.0, -5.0, 0.0, -3.0, -205.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, -33.0, 10.0, -47.0, 10.0, -4.0, 10.0, -93.0, 10.0, -110.0, 10.0, 10.0, 2.0, 0.0, -6.0, -24.0, 0.0, -65.0, 60.0, 0.0, -315.0, 10.0, 9.0, 16.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -230.0, 0.0, -30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -95.0, -310.0, 0.0, -170.0, -75.0, 0.0, 0.0, 10.0, -1.0, -5.0, -35.0, -90.0, -11.0, -14.0, 10.0, -495.0, 0.0, 30.0, -4.0, -85.0, 0.0, -11.0, -155.0, 20.0, -6.0, 10.0, 20.0, -45.0, -100.0, 10.0, 10.0, 0.0, 0.0, 0.0, -55.0, 0.0, -355.0, -150.0, 0.0, -6.0, -65.0, -220.0, 0.0, 20.0, -7.0, -250.0, 0.0, 10.0, 0.0, 0.0, -55.0, 0.0, 0.0, -90.0, -55.0, 10.0, 10.0, 10.0, 20.0, -15.0, 0.0, 10.0, 0.0, -215.0, -70.0, 0.0, 0.0, -225.0, 0.0, -1.0, -15.0, 0.0, 0.0, -250.0, 0.0, -2.0, 0.0, -240.0, 7.0, 0.0, -260.0, 0.0, -6.0, -120.0, -255.0, -14.0, 20.0, 0.0, 0.0, 20.0, -50.0, 10.0, 0.0, -45.0, 10.0, 20.0, 0.0, -14.0, 0.0, -3.0, 10.0, 10.0, -2.0, 0.0, -11.0, 0.0, -40.0, -35.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -5.0, 10.0, 0.0, 10.0, -12.0, -6.0, -12.0, 0.0, -6.0, 20.0, -14.0, 0.0, 0.0, -10.0, 0.0, -4.0, -50.0, 6.0, 0.0, -25.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, -20.0, -4.0, -6.0, 7.0, 0.0, 0.0, 0.0, 0.0, -13.0, -40.0, -80.0, -45.0, 0.0, 0.0, -85.0, 10.0, -24.0, 0.0, 0.0, 0.0, -21.0, 20.0, 20.0, 10.0, -6.0, -32.0, -40.0, 0.0, -6.0, 5.0, 0.0, 0.0, 20.0, 0.0, -26.0, 0.0, 10.0, 0.0, 6.0, -8.0, 0.0, -5.0, -4.0, 0.0, 10.0, 0.0, 10.0, -1.0, -2.0, 0.0, 0.0, -50.0, -25.0, 10.0, -16.0, 0.0, 0.0, 0.0, -19.0, -20.0, -16.0, 0.0, 0.0, 0.0, -40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, -2.0, 10.0, -35.0, 10.0, 0.0, 0.0, 0.0, -3.0, 0.0, 10.0, 5.0, 0.0, 10.0, 20.0, 20.0, -25.0, 0.0, 0.0, 3.0, 10.0, -6.0, 10.0, 0.0, -30.0, 10.0, 0.0, -7.0, 0.0, 0.0, 10.0, -25.0, 30.0, -12.0, 0.0, -17.0, -24.0, 20.0, 20.0, 0.0, 10.0, 20.0, 0.0, -55.0, -20.0, 0.0, 0.0, 0.0, -6.0, 0.0, 10.0, 0.0, -11.0, 10.0, 10.0, 10.0, 0.0, 0.0, -7.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, -30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -14.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, -17.0, 10.0, -10.0, 10.0, 0.0, 0.0, -3.0, 10.0, -6.0, 0.0, 10.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 10.0, 5.0, 10.0, -20.0, 0.0, 0.0, 0.0, -5.0, 0.0, -2.0, -9.0, 10.0, 10.0, 4.0, -8.0, -1.0, 4.0, -5.0, 0.0, 0.0, 0.0, 0.0, -12.0, 7.0, -8.0, 0.0, -10.0, 0.0, 0.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -90.0, 0.0, 0.0, -13.0, -4.0, 2.0, 0.0, 10.0, 0.0, 5.0, 0.0, 20.0, 0.0, -5.0, 0.0, 0.0, 0.0, -13.0, 0.0, 20.0, 0.0, -15.0, 0.0, -25.0, 0.0, 0.0, 0.0, -2.0, -18.0, 0.0, -20.0, 0.0, -4.0, 6.0, 10.0, 8.0, 0.0, -2.0, 0.0, -2.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 1.0, 10.0, 0.0, 10.0, 10.0, 0.0, -3.0, 30.0, 30.0, 10.0, 25.0, -3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, -10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 5.0, -2.0, 10.0, -2.0, -9.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 13.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -5.0, 0.0, 20.0, 4.0, 10.0, 6.0, 10.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, -11.0, 0.0, 0.0, 0.0, -1.0, -8.0, 0.0, 10.0, -5.0, 0.0, -7.0, 2.0, 0.0, 20.0, 0.0, 20.0, -8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -2.0, 20.0, -3.0, 0.0, 5.0, -4.0, -8.0, 0.0, 0.0, -3.0, 0.0, -18.0, -11.0, 10.0, -13.0, 9.0, 0.0, 10.0, -1.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 7.0, 0.0, -3.0, 0.0, 0.0, 0.0, 10.0, 10.0, -1.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, -6.0, -5.0, -7.0, 0.0, 7.0, -21.0, -3.0, -1.0, 0.0, 10.0, 10.0, 10.0, -7.0, -12.0, 0.0, 10.0, 10.0, 10.0, 20.0, -7.0, 0.0, 20.0, 38.0, 18.0, 10.0, 0.0, -2.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, -1.0, 0.0, 10.0, 10.0, 20.0, -6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 9.0, 10.0, 10.0, 10.0, 0.0, 19.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -19.0, -6.0, 10.0, -8.0, 10.0, 10.0, -11.0, 10.0, 0.0, -26.0, 0.0, -9.0, 0.0, 10.0, 0.0, 0.0, -12.0, 20.0, 0.0, 20.0, 15.0, 10.0, 10.0, 0.0, 0.0, 20.0, 17.0, 20.0, 14.0, 7.0, 10.0, -5.0, 10.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 13.0, 0.0, -15.0, -2.0, 20.0, 0.0, 10.0, -18.0, -4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, -12.0, 10.0, -2.0, 0.0, 20.0, 20.0, 10.0, -8.0, 20.0, 10.0, 10.0, 30.0, 10.0, 0.0, 30.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 0.0, 16.0, 0.0, 0.0, 9.0, 0.0, -2.0, -2.0, 20.0, 0.0, 20.0, -2.0, 0.0, 8.0, -10.0, 0.0, 10.0, 20.0, 20.0, -11.0, -5.0, 8.0, 0.0, 8.0, 10.0, 0.0, -9.0, 4.0, -4.0, -48.0, 0.0, -44.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, -7.0, -9.0, 10.0, 10.0, 0.0, -5.0, 10.0, 10.0, 0.0, 11.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, -15.0, -12.0, 10.0, -15.0, -13.0, 8.0, 10.0, 8.0, 0.0, 10.0, 17.0, 0.0, 10.0, -1.0, 0.0, -2.0, -6.0, 0.0, 10.0, 15.0, 0.0, 10.0, 0.0, 3.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 20.0, 10.0, 17.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8355017050789306, "mean_inference_ms": 2.467542942917646, "mean_action_processing_ms": 0.8506472744705922, "mean_env_wait_ms": 1.9905039918320704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024899810251563487, "StateBufferConnector_ms": 0.02408798294838029, "ViewRequirementAgentConnector_ms": 0.881416147405451}, "num_episodes": 27, "episode_return_max": 122.0, "episode_return_min": -1033.0, "episode_return_mean": -50.82828282828283}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.552510482156992, "num_env_steps_trained_throughput_per_sec": 15.552510482156992, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 255038.474, "restore_workers_time_ms": 0.058, "training_step_time_ms": 255038.327, "sample_time_ms": 4615.264, "learn_time_ms": 250400.455, "learn_throughput": 15.974, "synch_weights_time_ms": 13.579}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "1841f_00000", "date": "2024-08-07_23-41-29", "timestamp": 1723088489, "time_this_iter_s": 257.20501494407654, "time_total_s": 1275.2882812023163, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b236bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1275.2882812023163, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.0228650137741, "ram_util_percent": 79.9603305785124}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.448286998728975, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.923896294381545, "policy_loss": -0.01190357324959863, "vf_loss": 3.9340861407331764, "vf_explained_var": 0.0424913007801714, "kl": 0.008568615230257176, "entropy": 1.539174344529486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 51645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 190.0, "episode_reward_min": -888.0, "episode_reward_mean": 21.16, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 70.0}, "policy_reward_mean": {"policy_0": 2.116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-888.0, -15.0, -10.0, -25.0, -21.0, -52.0, -47.0, -171.0, -80.0, -49.0, -27.0, -58.0, -61.0, -35.0, -10.0, 43.0, -13.0, 2.0, -51.0, 22.0, 10.0, 9.0, 36.0, 90.0, 60.0, 0.0, 65.0, 0.0, -2.0, 5.0, 3.0, -28.0, 39.0, -87.0, 32.0, -33.0, -28.0, -11.0, 48.0, 102.0, 100.0, 40.0, 70.0, 42.0, 27.0, 57.0, 50.0, 0.0, 32.0, 25.0, -39.0, 25.0, 44.0, 39.0, -26.0, 44.0, 114.0, 69.0, 30.0, 78.0, 60.0, -30.0, 29.0, 113.0, 40.0, 120.0, 24.0, 40.0, 86.0, 122.0, 16.0, 43.0, 40.0, -83.0, 44.0, 66.0, -17.0, 36.0, 88.0, 70.0, 40.0, 74.0, 47.0, 190.0, 86.0, 17.0, 75.0, 57.0, 118.0, 111.0, 5.0, 135.0, 70.0, -53.0, 79.0, 80.0, 163.0, 140.0, 155.0, 35.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -240.0, 7.0, 0.0, -260.0, 0.0, -6.0, -120.0, -255.0, -14.0, 20.0, 0.0, 0.0, 20.0, -50.0, 10.0, 0.0, -45.0, 10.0, 20.0, 0.0, -14.0, 0.0, -3.0, 10.0, 10.0, -2.0, 0.0, -11.0, 0.0, -40.0, -35.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -5.0, 10.0, 0.0, 10.0, -12.0, -6.0, -12.0, 0.0, -6.0, 20.0, -14.0, 0.0, 0.0, -10.0, 0.0, -4.0, -50.0, 6.0, 0.0, -25.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, -20.0, -4.0, -6.0, 7.0, 0.0, 0.0, 0.0, 0.0, -13.0, -40.0, -80.0, -45.0, 0.0, 0.0, -85.0, 10.0, -24.0, 0.0, 0.0, 0.0, -21.0, 20.0, 20.0, 10.0, -6.0, -32.0, -40.0, 0.0, -6.0, 5.0, 0.0, 0.0, 20.0, 0.0, -26.0, 0.0, 10.0, 0.0, 6.0, -8.0, 0.0, -5.0, -4.0, 0.0, 10.0, 0.0, 10.0, -1.0, -2.0, 0.0, 0.0, -50.0, -25.0, 10.0, -16.0, 0.0, 0.0, 0.0, -19.0, -20.0, -16.0, 0.0, 0.0, 0.0, -40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, -2.0, 10.0, -35.0, 10.0, 0.0, 0.0, 0.0, -3.0, 0.0, 10.0, 5.0, 0.0, 10.0, 20.0, 20.0, -25.0, 0.0, 0.0, 3.0, 10.0, -6.0, 10.0, 0.0, -30.0, 10.0, 0.0, -7.0, 0.0, 0.0, 10.0, -25.0, 30.0, -12.0, 0.0, -17.0, -24.0, 20.0, 20.0, 0.0, 10.0, 20.0, 0.0, -55.0, -20.0, 0.0, 0.0, 0.0, -6.0, 0.0, 10.0, 0.0, -11.0, 10.0, 10.0, 10.0, 0.0, 0.0, -7.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, -30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -14.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, -17.0, 10.0, -10.0, 10.0, 0.0, 0.0, -3.0, 10.0, -6.0, 0.0, 10.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 10.0, 5.0, 10.0, -20.0, 0.0, 0.0, 0.0, -5.0, 0.0, -2.0, -9.0, 10.0, 10.0, 4.0, -8.0, -1.0, 4.0, -5.0, 0.0, 0.0, 0.0, 0.0, -12.0, 7.0, -8.0, 0.0, -10.0, 0.0, 0.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -90.0, 0.0, 0.0, -13.0, -4.0, 2.0, 0.0, 10.0, 0.0, 5.0, 0.0, 20.0, 0.0, -5.0, 0.0, 0.0, 0.0, -13.0, 0.0, 20.0, 0.0, -15.0, 0.0, -25.0, 0.0, 0.0, 0.0, -2.0, -18.0, 0.0, -20.0, 0.0, -4.0, 6.0, 10.0, 8.0, 0.0, -2.0, 0.0, -2.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 1.0, 10.0, 0.0, 10.0, 10.0, 0.0, -3.0, 30.0, 30.0, 10.0, 25.0, -3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, -10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 5.0, -2.0, 10.0, -2.0, -9.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 13.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -5.0, 0.0, 20.0, 4.0, 10.0, 6.0, 10.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, -11.0, 0.0, 0.0, 0.0, -1.0, -8.0, 0.0, 10.0, -5.0, 0.0, -7.0, 2.0, 0.0, 20.0, 0.0, 20.0, -8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -2.0, 20.0, -3.0, 0.0, 5.0, -4.0, -8.0, 0.0, 0.0, -3.0, 0.0, -18.0, -11.0, 10.0, -13.0, 9.0, 0.0, 10.0, -1.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 7.0, 0.0, -3.0, 0.0, 0.0, 0.0, 10.0, 10.0, -1.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, -6.0, -5.0, -7.0, 0.0, 7.0, -21.0, -3.0, -1.0, 0.0, 10.0, 10.0, 10.0, -7.0, -12.0, 0.0, 10.0, 10.0, 10.0, 20.0, -7.0, 0.0, 20.0, 38.0, 18.0, 10.0, 0.0, -2.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, -1.0, 0.0, 10.0, 10.0, 20.0, -6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 9.0, 10.0, 10.0, 10.0, 0.0, 19.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -19.0, -6.0, 10.0, -8.0, 10.0, 10.0, -11.0, 10.0, 0.0, -26.0, 0.0, -9.0, 0.0, 10.0, 0.0, 0.0, -12.0, 20.0, 0.0, 20.0, 15.0, 10.0, 10.0, 0.0, 0.0, 20.0, 17.0, 20.0, 14.0, 7.0, 10.0, -5.0, 10.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 13.0, 0.0, -15.0, -2.0, 20.0, 0.0, 10.0, -18.0, -4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, -12.0, 10.0, -2.0, 0.0, 20.0, 20.0, 10.0, -8.0, 20.0, 10.0, 10.0, 30.0, 10.0, 0.0, 30.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 0.0, 16.0, 0.0, 0.0, 9.0, 0.0, -2.0, -2.0, 20.0, 0.0, 20.0, -2.0, 0.0, 8.0, -10.0, 0.0, 10.0, 20.0, 20.0, -11.0, -5.0, 8.0, 0.0, 8.0, 10.0, 0.0, -9.0, 4.0, -4.0, -48.0, 0.0, -44.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, -7.0, -9.0, 10.0, 10.0, 0.0, -5.0, 10.0, 10.0, 0.0, 11.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, -15.0, -12.0, 10.0, -15.0, -13.0, 8.0, 10.0, 8.0, 0.0, 10.0, 17.0, 0.0, 10.0, -1.0, 0.0, -2.0, -6.0, 0.0, 10.0, 15.0, 0.0, 10.0, 0.0, 3.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 20.0, 10.0, 17.0, 10.0, 2.0, 0.0, 40.0, 30.0, -18.0, 0.0, -41.0, 40.0, 2.0, -8.0, 0.0, 70.0, 0.0, 40.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 10.0, 0.0, 20.0, 13.0, 0.0, 10.0, 0.0, 3.0, 10.0, 10.0, -2.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 5.0, 10.0, -5.0, 0.0, 0.0, 0.0, 20.0, 30.0, -15.0, 6.0, 10.0, 0.0, 10.0, 20.0, 0.0, -2.0, 0.0, 0.0, 13.0, 0.0, 20.0, 20.0, 10.0, -1.0, 0.0, 20.0, 9.0, 30.0, 10.0, 8.0, 1.0, 1.0, 0.0, 0.0, 20.0, 11.0, 20.0, 20.0, 30.0, 10.0, -14.0, 14.0, 10.0, 0.0, -22.0, -13.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, -5.0, 0.0, 10.0, 10.0, -10.0, -3.0, 0.0, -20.0, 10.0, 40.0, 40.0, -7.0, 5.0, -21.0, 0.0, -19.0, -31.0, 0.0, -27.0, 0.0, 30.0, 10.0, 10.0, -16.0, 15.0, 7.0, 30.0, 0.0, 0.0, 30.0, 10.0, -7.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 27.0, 10.0, 10.0, 20.0, 40.0, 20.0, 0.0, 6.0, 10.0, 10.0, 30.0, -22.0, -8.0, 20.0, 30.0, 30.0, 20.0, 30.0, 0.0, 0.0, 10.0, 30.0, 10.0, 0.0, 11.0, 19.0, 40.0, 15.0, 20.0, 10.0, 0.0, -13.0, 10.0, 10.0, 10.0, 0.0, 10.0, -12.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.725472228497893, "mean_inference_ms": 2.441858940316228, "mean_action_processing_ms": 0.8371108291913839, "mean_env_wait_ms": 1.934913795515161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02468705177307129, "StateBufferConnector_ms": 0.025551557540893555, "ViewRequirementAgentConnector_ms": 0.7906904220581055}, "num_episodes": 18, "episode_return_max": 190.0, "episode_return_min": -888.0, "episode_return_mean": 21.16}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.656029283402223, "num_env_steps_trained_throughput_per_sec": 15.656029283402223, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 255114.168, "restore_workers_time_ms": 0.051, "training_step_time_ms": 255114.037, "sample_time_ms": 4596.915, "learn_time_ms": 250495.246, "learn_throughput": 15.968, "synch_weights_time_ms": 13.395}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "1841f_00000", "date": "2024-08-07_23-45-45", "timestamp": 1723088745, "time_this_iter_s": 255.50165915489197, "time_total_s": 1530.7899403572083, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2401940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1530.7899403572083, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 47.76952908587258, "ram_util_percent": 80.16620498614958}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.139237211763668, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.400977808725846, "policy_loss": -0.012913091174283197, "vf_loss": 4.412124160430428, "vf_explained_var": 0.05617213167321568, "kl": 0.008833711798047915, "entropy": 1.5167100470033064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 61035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 219.0, "episode_reward_min": -87.0, "episode_reward_mean": 64.02, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 70.0}, "policy_reward_mean": {"policy_0": 6.402}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.0, 22.0, 10.0, 9.0, 36.0, 90.0, 60.0, 0.0, 65.0, 0.0, -2.0, 5.0, 3.0, -28.0, 39.0, -87.0, 32.0, -33.0, -28.0, -11.0, 48.0, 102.0, 100.0, 40.0, 70.0, 42.0, 27.0, 57.0, 50.0, 0.0, 32.0, 25.0, -39.0, 25.0, 44.0, 39.0, -26.0, 44.0, 114.0, 69.0, 30.0, 78.0, 60.0, -30.0, 29.0, 113.0, 40.0, 120.0, 24.0, 40.0, 86.0, 122.0, 16.0, 43.0, 40.0, -83.0, 44.0, 66.0, -17.0, 36.0, 88.0, 70.0, 40.0, 74.0, 47.0, 190.0, 86.0, 17.0, 75.0, 57.0, 118.0, 111.0, 5.0, 135.0, 70.0, -53.0, 79.0, 80.0, 163.0, 140.0, 155.0, 35.0, 170.0, 160.0, 218.0, 186.0, 116.0, 136.0, 170.0, 132.0, 170.0, 143.0, 219.0, 210.0, 117.0, 148.0, 159.0, 57.0, 160.0, 98.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, -55.0, -20.0, 0.0, 0.0, 0.0, -6.0, 0.0, 10.0, 0.0, -11.0, 10.0, 10.0, 10.0, 0.0, 0.0, -7.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, -30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -14.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, -17.0, 10.0, -10.0, 10.0, 0.0, 0.0, -3.0, 10.0, -6.0, 0.0, 10.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -10.0, 10.0, 0.0, 10.0, 5.0, 10.0, -20.0, 0.0, 0.0, 0.0, -5.0, 0.0, -2.0, -9.0, 10.0, 10.0, 4.0, -8.0, -1.0, 4.0, -5.0, 0.0, 0.0, 0.0, 0.0, -12.0, 7.0, -8.0, 0.0, -10.0, 0.0, 0.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -90.0, 0.0, 0.0, -13.0, -4.0, 2.0, 0.0, 10.0, 0.0, 5.0, 0.0, 20.0, 0.0, -5.0, 0.0, 0.0, 0.0, -13.0, 0.0, 20.0, 0.0, -15.0, 0.0, -25.0, 0.0, 0.0, 0.0, -2.0, -18.0, 0.0, -20.0, 0.0, -4.0, 6.0, 10.0, 8.0, 0.0, -2.0, 0.0, -2.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 1.0, 10.0, 0.0, 10.0, 10.0, 0.0, -3.0, 30.0, 30.0, 10.0, 25.0, -3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, -10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 5.0, -2.0, 10.0, -2.0, -9.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 13.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -5.0, 0.0, 20.0, 4.0, 10.0, 6.0, 10.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, -11.0, 0.0, 0.0, 0.0, -1.0, -8.0, 0.0, 10.0, -5.0, 0.0, -7.0, 2.0, 0.0, 20.0, 0.0, 20.0, -8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -2.0, 20.0, -3.0, 0.0, 5.0, -4.0, -8.0, 0.0, 0.0, -3.0, 0.0, -18.0, -11.0, 10.0, -13.0, 9.0, 0.0, 10.0, -1.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 7.0, 0.0, -3.0, 0.0, 0.0, 0.0, 10.0, 10.0, -1.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, -6.0, -5.0, -7.0, 0.0, 7.0, -21.0, -3.0, -1.0, 0.0, 10.0, 10.0, 10.0, -7.0, -12.0, 0.0, 10.0, 10.0, 10.0, 20.0, -7.0, 0.0, 20.0, 38.0, 18.0, 10.0, 0.0, -2.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, -1.0, 0.0, 10.0, 10.0, 20.0, -6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 9.0, 10.0, 10.0, 10.0, 0.0, 19.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -19.0, -6.0, 10.0, -8.0, 10.0, 10.0, -11.0, 10.0, 0.0, -26.0, 0.0, -9.0, 0.0, 10.0, 0.0, 0.0, -12.0, 20.0, 0.0, 20.0, 15.0, 10.0, 10.0, 0.0, 0.0, 20.0, 17.0, 20.0, 14.0, 7.0, 10.0, -5.0, 10.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 13.0, 0.0, -15.0, -2.0, 20.0, 0.0, 10.0, -18.0, -4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, -12.0, 10.0, -2.0, 0.0, 20.0, 20.0, 10.0, -8.0, 20.0, 10.0, 10.0, 30.0, 10.0, 0.0, 30.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 0.0, 16.0, 0.0, 0.0, 9.0, 0.0, -2.0, -2.0, 20.0, 0.0, 20.0, -2.0, 0.0, 8.0, -10.0, 0.0, 10.0, 20.0, 20.0, -11.0, -5.0, 8.0, 0.0, 8.0, 10.0, 0.0, -9.0, 4.0, -4.0, -48.0, 0.0, -44.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, -7.0, -9.0, 10.0, 10.0, 0.0, -5.0, 10.0, 10.0, 0.0, 11.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, -15.0, -12.0, 10.0, -15.0, -13.0, 8.0, 10.0, 8.0, 0.0, 10.0, 17.0, 0.0, 10.0, -1.0, 0.0, -2.0, -6.0, 0.0, 10.0, 15.0, 0.0, 10.0, 0.0, 3.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 20.0, 10.0, 17.0, 10.0, 2.0, 0.0, 40.0, 30.0, -18.0, 0.0, -41.0, 40.0, 2.0, -8.0, 0.0, 70.0, 0.0, 40.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 10.0, 0.0, 20.0, 13.0, 0.0, 10.0, 0.0, 3.0, 10.0, 10.0, -2.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 5.0, 10.0, -5.0, 0.0, 0.0, 0.0, 20.0, 30.0, -15.0, 6.0, 10.0, 0.0, 10.0, 20.0, 0.0, -2.0, 0.0, 0.0, 13.0, 0.0, 20.0, 20.0, 10.0, -1.0, 0.0, 20.0, 9.0, 30.0, 10.0, 8.0, 1.0, 1.0, 0.0, 0.0, 20.0, 11.0, 20.0, 20.0, 30.0, 10.0, -14.0, 14.0, 10.0, 0.0, -22.0, -13.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, -5.0, 0.0, 10.0, 10.0, -10.0, -3.0, 0.0, -20.0, 10.0, 40.0, 40.0, -7.0, 5.0, -21.0, 0.0, -19.0, -31.0, 0.0, -27.0, 0.0, 30.0, 10.0, 10.0, -16.0, 15.0, 7.0, 30.0, 0.0, 0.0, 30.0, 10.0, -7.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 27.0, 10.0, 10.0, 20.0, 40.0, 20.0, 0.0, 6.0, 10.0, 10.0, 30.0, -22.0, -8.0, 20.0, 30.0, 30.0, 20.0, 30.0, 0.0, 0.0, 10.0, 30.0, 10.0, 0.0, 11.0, 19.0, 40.0, 15.0, 20.0, 10.0, 0.0, -13.0, 10.0, 10.0, 10.0, 0.0, 10.0, -12.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 50.0, 0.0, 50.0, 20.0, 0.0, 20.0, 0.0, 24.0, 10.0, -4.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 0.0, 10.0, 29.0, 20.0, 29.0, 0.0, 20.0, 50.0, 50.0, 50.0, 30.0, -7.0, 20.0, -6.0, 50.0, 30.0, 40.0, -6.0, -15.0, 0.0, 0.0, 10.0, 10.0, 20.0, 14.0, 10.0, 0.0, 22.0, 30.0, 20.0, 20.0, -20.0, 50.0, 20.0, 10.0, -7.0, -20.0, 50.0, 13.0, 10.0, 10.0, 60.0, 10.0, 40.0, 30.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 20.0, 0.0, 20.0, 10.0, 28.0, -9.0, 40.0, -27.0, 0.0, 10.0, 10.0, 40.0, -5.0, 30.0, 30.0, 0.0, 20.0, 35.0, 27.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 6.0, 30.0, 10.0, 30.0, 10.0, 29.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 30.0, 34.0, 30.0, -6.0, 21.0, 60.0, -9.0, 20.0, 20.0, 40.0, 0.0, -7.0, 10.0, 30.0, 40.0, 10.0, 0.0, 20.0, 0.0, 4.0, 10.0, -6.0, 10.0, -25.0, 40.0, 12.0, 0.0, 0.0, 67.0, 30.0, 20.0, 40.0, 10.0, 20.0, 0.0, 24.0, -5.0, 40.0, 10.0, 0.0, 20.0, -11.0, 10.0, 0.0, -2.0, 10.0, 0.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, -3.0, 10.0, 1.0, 0.0, 10.0, 0.0, 70.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6769544013766917, "mean_inference_ms": 2.4542315869219578, "mean_action_processing_ms": 0.8283787469205692, "mean_env_wait_ms": 1.9147768316946463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02282428741455078, "StateBufferConnector_ms": 0.025286197662353516, "ViewRequirementAgentConnector_ms": 0.8125777244567871}, "num_episodes": 18, "episode_return_max": 219.0, "episode_return_min": -87.0, "episode_return_mean": 64.02}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.567641340829653, "num_env_steps_trained_throughput_per_sec": 15.567641340829653, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 255375.463, "restore_workers_time_ms": 0.045, "training_step_time_ms": 255375.345, "sample_time_ms": 4564.656, "learn_time_ms": 250789.286, "learn_throughput": 15.95, "synch_weights_time_ms": 13.043}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "1841f_00000", "date": "2024-08-07_23-50-02", "timestamp": 1723089002, "time_this_iter_s": 256.95153307914734, "time_total_s": 1787.7414734363556, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b248d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1787.7414734363556, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 48.3931129476584, "ram_util_percent": 80.60468319559229}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.042140546228431, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.337595281103295, "policy_loss": -0.012655569204893975, "vf_loss": 4.348387558061602, "vf_explained_var": 0.02760537286409047, "kl": 0.00931645780191716, "entropy": 1.4952919196143064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 70425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 261.0, "episode_reward_min": -83.0, "episode_reward_mean": 91.32, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -48.0}, "policy_reward_max": {"policy_0": 80.0}, "policy_reward_mean": {"policy_0": 9.132}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.0, -11.0, 48.0, 102.0, 100.0, 40.0, 70.0, 42.0, 27.0, 57.0, 50.0, 0.0, 32.0, 25.0, -39.0, 25.0, 44.0, 39.0, -26.0, 44.0, 114.0, 69.0, 30.0, 78.0, 60.0, -30.0, 29.0, 113.0, 40.0, 120.0, 24.0, 40.0, 86.0, 122.0, 16.0, 43.0, 40.0, -83.0, 44.0, 66.0, -17.0, 36.0, 88.0, 70.0, 40.0, 74.0, 47.0, 190.0, 86.0, 17.0, 75.0, 57.0, 118.0, 111.0, 5.0, 135.0, 70.0, -53.0, 79.0, 80.0, 163.0, 140.0, 155.0, 35.0, 170.0, 160.0, 218.0, 186.0, 116.0, 136.0, 170.0, 132.0, 170.0, 143.0, 219.0, 210.0, 117.0, 148.0, 159.0, 57.0, 160.0, 98.0, 109.0, 77.0, 150.0, 230.0, 94.0, 220.0, 180.0, 130.0, 200.0, 127.0, 231.0, 98.0, 261.0, 83.0, 98.0, 226.0, 170.0, 216.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, -2.0, -18.0, 0.0, -20.0, 0.0, -4.0, 6.0, 10.0, 8.0, 0.0, -2.0, 0.0, -2.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 1.0, 10.0, 0.0, 10.0, 10.0, 0.0, -3.0, 30.0, 30.0, 10.0, 25.0, -3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, -10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 5.0, -2.0, 10.0, -2.0, -9.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 13.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -5.0, 0.0, 20.0, 4.0, 10.0, 6.0, 10.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, -11.0, 0.0, 0.0, 0.0, -1.0, -8.0, 0.0, 10.0, -5.0, 0.0, -7.0, 2.0, 0.0, 20.0, 0.0, 20.0, -8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -2.0, 20.0, -3.0, 0.0, 5.0, -4.0, -8.0, 0.0, 0.0, -3.0, 0.0, -18.0, -11.0, 10.0, -13.0, 9.0, 0.0, 10.0, -1.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 7.0, 0.0, -3.0, 0.0, 0.0, 0.0, 10.0, 10.0, -1.0, 0.0, 10.0, 10.0, 10.0, 0.0, -10.0, -6.0, -5.0, -7.0, 0.0, 7.0, -21.0, -3.0, -1.0, 0.0, 10.0, 10.0, 10.0, -7.0, -12.0, 0.0, 10.0, 10.0, 10.0, 20.0, -7.0, 0.0, 20.0, 38.0, 18.0, 10.0, 0.0, -2.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, -1.0, 0.0, 10.0, 10.0, 20.0, -6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 9.0, 10.0, 10.0, 10.0, 0.0, 19.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -19.0, -6.0, 10.0, -8.0, 10.0, 10.0, -11.0, 10.0, 0.0, -26.0, 0.0, -9.0, 0.0, 10.0, 0.0, 0.0, -12.0, 20.0, 0.0, 20.0, 15.0, 10.0, 10.0, 0.0, 0.0, 20.0, 17.0, 20.0, 14.0, 7.0, 10.0, -5.0, 10.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 13.0, 0.0, -15.0, -2.0, 20.0, 0.0, 10.0, -18.0, -4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, -12.0, 10.0, -2.0, 0.0, 20.0, 20.0, 10.0, -8.0, 20.0, 10.0, 10.0, 30.0, 10.0, 0.0, 30.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 0.0, 16.0, 0.0, 0.0, 9.0, 0.0, -2.0, -2.0, 20.0, 0.0, 20.0, -2.0, 0.0, 8.0, -10.0, 0.0, 10.0, 20.0, 20.0, -11.0, -5.0, 8.0, 0.0, 8.0, 10.0, 0.0, -9.0, 4.0, -4.0, -48.0, 0.0, -44.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, -7.0, -9.0, 10.0, 10.0, 0.0, -5.0, 10.0, 10.0, 0.0, 11.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, -15.0, -12.0, 10.0, -15.0, -13.0, 8.0, 10.0, 8.0, 0.0, 10.0, 17.0, 0.0, 10.0, -1.0, 0.0, -2.0, -6.0, 0.0, 10.0, 15.0, 0.0, 10.0, 0.0, 3.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 20.0, 10.0, 17.0, 10.0, 2.0, 0.0, 40.0, 30.0, -18.0, 0.0, -41.0, 40.0, 2.0, -8.0, 0.0, 70.0, 0.0, 40.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 10.0, 0.0, 20.0, 13.0, 0.0, 10.0, 0.0, 3.0, 10.0, 10.0, -2.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 5.0, 10.0, -5.0, 0.0, 0.0, 0.0, 20.0, 30.0, -15.0, 6.0, 10.0, 0.0, 10.0, 20.0, 0.0, -2.0, 0.0, 0.0, 13.0, 0.0, 20.0, 20.0, 10.0, -1.0, 0.0, 20.0, 9.0, 30.0, 10.0, 8.0, 1.0, 1.0, 0.0, 0.0, 20.0, 11.0, 20.0, 20.0, 30.0, 10.0, -14.0, 14.0, 10.0, 0.0, -22.0, -13.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, -5.0, 0.0, 10.0, 10.0, -10.0, -3.0, 0.0, -20.0, 10.0, 40.0, 40.0, -7.0, 5.0, -21.0, 0.0, -19.0, -31.0, 0.0, -27.0, 0.0, 30.0, 10.0, 10.0, -16.0, 15.0, 7.0, 30.0, 0.0, 0.0, 30.0, 10.0, -7.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 27.0, 10.0, 10.0, 20.0, 40.0, 20.0, 0.0, 6.0, 10.0, 10.0, 30.0, -22.0, -8.0, 20.0, 30.0, 30.0, 20.0, 30.0, 0.0, 0.0, 10.0, 30.0, 10.0, 0.0, 11.0, 19.0, 40.0, 15.0, 20.0, 10.0, 0.0, -13.0, 10.0, 10.0, 10.0, 0.0, 10.0, -12.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 50.0, 0.0, 50.0, 20.0, 0.0, 20.0, 0.0, 24.0, 10.0, -4.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 0.0, 10.0, 29.0, 20.0, 29.0, 0.0, 20.0, 50.0, 50.0, 50.0, 30.0, -7.0, 20.0, -6.0, 50.0, 30.0, 40.0, -6.0, -15.0, 0.0, 0.0, 10.0, 10.0, 20.0, 14.0, 10.0, 0.0, 22.0, 30.0, 20.0, 20.0, -20.0, 50.0, 20.0, 10.0, -7.0, -20.0, 50.0, 13.0, 10.0, 10.0, 60.0, 10.0, 40.0, 30.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 20.0, 0.0, 20.0, 10.0, 28.0, -9.0, 40.0, -27.0, 0.0, 10.0, 10.0, 40.0, -5.0, 30.0, 30.0, 0.0, 20.0, 35.0, 27.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 6.0, 30.0, 10.0, 30.0, 10.0, 29.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 30.0, 34.0, 30.0, -6.0, 21.0, 60.0, -9.0, 20.0, 20.0, 40.0, 0.0, -7.0, 10.0, 30.0, 40.0, 10.0, 0.0, 20.0, 0.0, 4.0, 10.0, -6.0, 10.0, -25.0, 40.0, 12.0, 0.0, 0.0, 67.0, 30.0, 20.0, 40.0, 10.0, 20.0, 0.0, 24.0, -5.0, 40.0, 10.0, 0.0, 20.0, -11.0, 10.0, 0.0, -2.0, 10.0, 0.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, -3.0, 10.0, 1.0, 0.0, 10.0, 0.0, 70.0, 0.0, 0.0, 20.0, 7.0, 10.0, -4.0, 20.0, 0.0, 30.0, -14.0, 40.0, 0.0, 5.0, 20.0, 30.0, -9.0, -3.0, 50.0, -23.0, 4.0, -5.0, 8.0, 0.0, 0.0, 10.0, 40.0, 20.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 50.0, 40.0, 0.0, 20.0, 20.0, -6.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 20.0, 80.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 20.0, 40.0, 10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 30.0, 40.0, -2.0, 10.0, 10.0, 10.0, -1.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 9.0, 10.0, 12.0, 21.0, -1.0, 60.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 9.0, 0.0, 20.0, 9.0, 10.0, 80.0, 0.0, 20.0, 20.0, 40.0, 5.0, 30.0, 40.0, 16.0, 13.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 8.0, 14.0, -2.0, 7.0, 3.0, 4.0, 7.0, 30.0, -18.0, 5.0, 30.0, 20.0, 10.0, 0.0, 4.0, 30.0, 50.0, 2.0, 5.0, 40.0, 40.0, 50.0, 5.0, 30.0, 10.0, 30.0, 0.0, 65.0, 0.0, 10.0, -5.0, 20.0, 10.0, 11.0, 28.0, 19.0, 40.0, 18.0, 5.0, 30.0, 30.0, 20.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.643500680174538, "mean_inference_ms": 2.4904776401979922, "mean_action_processing_ms": 0.8216935040067037, "mean_env_wait_ms": 1.9010157472138411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0217130184173584, "StateBufferConnector_ms": 0.0207369327545166, "ViewRequirementAgentConnector_ms": 0.769899845123291}, "num_episodes": 18, "episode_return_max": 261.0, "episode_return_min": -83.0, "episode_return_mean": 91.32}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.700398647894248, "num_env_steps_trained_throughput_per_sec": 15.700398647894248, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 255299.857, "restore_workers_time_ms": 0.041, "training_step_time_ms": 255299.747, "sample_time_ms": 4528.023, "learn_time_ms": 250750.724, "learn_throughput": 15.952, "synch_weights_time_ms": 12.826}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "1841f_00000", "date": "2024-08-07_23-54-17", "timestamp": 1723089257, "time_this_iter_s": 254.7799141407013, "time_total_s": 2042.5213875770569, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b248d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2042.5213875770569, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 47.75138888888889, "ram_util_percent": 78.5586111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.011618270533788, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.146190535044645, "policy_loss": -0.011788908561346487, "vf_loss": 5.15608901535741, "vf_explained_var": 0.019408841248645316, "kl": 0.009452170513685259, "entropy": 1.4626954376380157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 79815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 320.0, "episode_reward_min": -83.0, "episode_reward_mean": 128.51, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -48.0}, "policy_reward_max": {"policy_0": 130.0}, "policy_reward_mean": {"policy_0": 12.851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.0, 44.0, 114.0, 69.0, 30.0, 78.0, 60.0, -30.0, 29.0, 113.0, 40.0, 120.0, 24.0, 40.0, 86.0, 122.0, 16.0, 43.0, 40.0, -83.0, 44.0, 66.0, -17.0, 36.0, 88.0, 70.0, 40.0, 74.0, 47.0, 190.0, 86.0, 17.0, 75.0, 57.0, 118.0, 111.0, 5.0, 135.0, 70.0, -53.0, 79.0, 80.0, 163.0, 140.0, 155.0, 35.0, 170.0, 160.0, 218.0, 186.0, 116.0, 136.0, 170.0, 132.0, 170.0, 143.0, 219.0, 210.0, 117.0, 148.0, 159.0, 57.0, 160.0, 98.0, 109.0, 77.0, 150.0, 230.0, 94.0, 220.0, 180.0, 130.0, 200.0, 127.0, 231.0, 98.0, 261.0, 83.0, 98.0, 226.0, 170.0, 216.0, 187.0, 252.0, 255.0, 198.0, 196.0, 206.0, 250.0, 300.0, 190.0, 260.0, 275.0, 320.0, 148.0, 257.0, 290.0, 188.0, 300.0, 270.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-6.0, -5.0, -7.0, 0.0, 7.0, -21.0, -3.0, -1.0, 0.0, 10.0, 10.0, 10.0, -7.0, -12.0, 0.0, 10.0, 10.0, 10.0, 20.0, -7.0, 0.0, 20.0, 38.0, 18.0, 10.0, 0.0, -2.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, -1.0, 0.0, 10.0, 10.0, 20.0, -6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 9.0, 10.0, 10.0, 10.0, 0.0, 19.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -19.0, -6.0, 10.0, -8.0, 10.0, 10.0, -11.0, 10.0, 0.0, -26.0, 0.0, -9.0, 0.0, 10.0, 0.0, 0.0, -12.0, 20.0, 0.0, 20.0, 15.0, 10.0, 10.0, 0.0, 0.0, 20.0, 17.0, 20.0, 14.0, 7.0, 10.0, -5.0, 10.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 13.0, 0.0, -15.0, -2.0, 20.0, 0.0, 10.0, -18.0, -4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, -12.0, 10.0, -2.0, 0.0, 20.0, 20.0, 10.0, -8.0, 20.0, 10.0, 10.0, 30.0, 10.0, 0.0, 30.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 0.0, 16.0, 0.0, 0.0, 9.0, 0.0, -2.0, -2.0, 20.0, 0.0, 20.0, -2.0, 0.0, 8.0, -10.0, 0.0, 10.0, 20.0, 20.0, -11.0, -5.0, 8.0, 0.0, 8.0, 10.0, 0.0, -9.0, 4.0, -4.0, -48.0, 0.0, -44.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, -7.0, -9.0, 10.0, 10.0, 0.0, -5.0, 10.0, 10.0, 0.0, 11.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, -15.0, -12.0, 10.0, -15.0, -13.0, 8.0, 10.0, 8.0, 0.0, 10.0, 17.0, 0.0, 10.0, -1.0, 0.0, -2.0, -6.0, 0.0, 10.0, 15.0, 0.0, 10.0, 0.0, 3.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 20.0, 10.0, 17.0, 10.0, 2.0, 0.0, 40.0, 30.0, -18.0, 0.0, -41.0, 40.0, 2.0, -8.0, 0.0, 70.0, 0.0, 40.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 10.0, 0.0, 20.0, 13.0, 0.0, 10.0, 0.0, 3.0, 10.0, 10.0, -2.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 5.0, 10.0, -5.0, 0.0, 0.0, 0.0, 20.0, 30.0, -15.0, 6.0, 10.0, 0.0, 10.0, 20.0, 0.0, -2.0, 0.0, 0.0, 13.0, 0.0, 20.0, 20.0, 10.0, -1.0, 0.0, 20.0, 9.0, 30.0, 10.0, 8.0, 1.0, 1.0, 0.0, 0.0, 20.0, 11.0, 20.0, 20.0, 30.0, 10.0, -14.0, 14.0, 10.0, 0.0, -22.0, -13.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, -5.0, 0.0, 10.0, 10.0, -10.0, -3.0, 0.0, -20.0, 10.0, 40.0, 40.0, -7.0, 5.0, -21.0, 0.0, -19.0, -31.0, 0.0, -27.0, 0.0, 30.0, 10.0, 10.0, -16.0, 15.0, 7.0, 30.0, 0.0, 0.0, 30.0, 10.0, -7.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 27.0, 10.0, 10.0, 20.0, 40.0, 20.0, 0.0, 6.0, 10.0, 10.0, 30.0, -22.0, -8.0, 20.0, 30.0, 30.0, 20.0, 30.0, 0.0, 0.0, 10.0, 30.0, 10.0, 0.0, 11.0, 19.0, 40.0, 15.0, 20.0, 10.0, 0.0, -13.0, 10.0, 10.0, 10.0, 0.0, 10.0, -12.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 50.0, 0.0, 50.0, 20.0, 0.0, 20.0, 0.0, 24.0, 10.0, -4.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 0.0, 10.0, 29.0, 20.0, 29.0, 0.0, 20.0, 50.0, 50.0, 50.0, 30.0, -7.0, 20.0, -6.0, 50.0, 30.0, 40.0, -6.0, -15.0, 0.0, 0.0, 10.0, 10.0, 20.0, 14.0, 10.0, 0.0, 22.0, 30.0, 20.0, 20.0, -20.0, 50.0, 20.0, 10.0, -7.0, -20.0, 50.0, 13.0, 10.0, 10.0, 60.0, 10.0, 40.0, 30.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 20.0, 0.0, 20.0, 10.0, 28.0, -9.0, 40.0, -27.0, 0.0, 10.0, 10.0, 40.0, -5.0, 30.0, 30.0, 0.0, 20.0, 35.0, 27.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 6.0, 30.0, 10.0, 30.0, 10.0, 29.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 30.0, 34.0, 30.0, -6.0, 21.0, 60.0, -9.0, 20.0, 20.0, 40.0, 0.0, -7.0, 10.0, 30.0, 40.0, 10.0, 0.0, 20.0, 0.0, 4.0, 10.0, -6.0, 10.0, -25.0, 40.0, 12.0, 0.0, 0.0, 67.0, 30.0, 20.0, 40.0, 10.0, 20.0, 0.0, 24.0, -5.0, 40.0, 10.0, 0.0, 20.0, -11.0, 10.0, 0.0, -2.0, 10.0, 0.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, -3.0, 10.0, 1.0, 0.0, 10.0, 0.0, 70.0, 0.0, 0.0, 20.0, 7.0, 10.0, -4.0, 20.0, 0.0, 30.0, -14.0, 40.0, 0.0, 5.0, 20.0, 30.0, -9.0, -3.0, 50.0, -23.0, 4.0, -5.0, 8.0, 0.0, 0.0, 10.0, 40.0, 20.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 50.0, 40.0, 0.0, 20.0, 20.0, -6.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 20.0, 80.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 20.0, 40.0, 10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 30.0, 40.0, -2.0, 10.0, 10.0, 10.0, -1.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 9.0, 10.0, 12.0, 21.0, -1.0, 60.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 9.0, 0.0, 20.0, 9.0, 10.0, 80.0, 0.0, 20.0, 20.0, 40.0, 5.0, 30.0, 40.0, 16.0, 13.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 8.0, 14.0, -2.0, 7.0, 3.0, 4.0, 7.0, 30.0, -18.0, 5.0, 30.0, 20.0, 10.0, 0.0, 4.0, 30.0, 50.0, 2.0, 5.0, 40.0, 40.0, 50.0, 5.0, 30.0, 10.0, 30.0, 0.0, 65.0, 0.0, 10.0, -5.0, 20.0, 10.0, 11.0, 28.0, 19.0, 40.0, 18.0, 5.0, 30.0, 30.0, 20.0, 15.0, 28.0, 9.0, 30.0, 10.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, -3.0, 10.0, 10.0, 17.0, -2.0, 20.0, 30.0, 130.0, 10.0, 30.0, 30.0, 30.0, 0.0, 20.0, 70.0, 5.0, 0.0, 30.0, 40.0, 10.0, 3.0, 10.0, 20.0, 20.0, 30.0, 30.0, -3.0, 90.0, -12.0, -3.0, 30.0, 28.0, 30.0, 30.0, 0.0, 35.0, 0.0, 16.0, 30.0, 19.0, 0.0, 40.0, 27.0, 35.0, 0.0, 10.0, 5.0, 40.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 50.0, 40.0, 20.0, 10.0, 20.0, 20.0, 60.0, 10.0, 60.0, 30.0, 50.0, 10.0, 10.0, 40.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 50.0, 20.0, 20.0, 60.0, 40.0, 20.0, 40.0, 15.0, 40.0, 20.0, -10.0, 20.0, 10.0, 60.0, 60.0, 20.0, 10.0, 30.0, 20.0, 20.0, 40.0, 30.0, 50.0, 40.0, 60.0, -2.0, 33.0, 30.0, 40.0, -10.0, 0.0, 23.0, -22.0, -4.0, 60.0, 0.0, 60.0, 34.0, 10.0, 10.0, 50.0, 40.0, 20.0, 30.0, 3.0, 20.0, 10.0, 20.0, 50.0, 40.0, 40.0, 30.0, 30.0, 10.0, 40.0, 13.0, 30.0, 10.0, 10.0, 20.0, -9.0, 30.0, 4.0, 60.0, 20.0, 20.0, 10.0, 50.0, 10.0, 30.0, 10.0, 50.0, 0.0, 100.0, 20.0, 30.0, 40.0, 20.0, 20.0, 30.0, 20.0, 10.0, 50.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.618568258337011, "mean_inference_ms": 2.5373683723377742, "mean_action_processing_ms": 0.814516332857883, "mean_env_wait_ms": 1.8858541610226138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020786762237548828, "StateBufferConnector_ms": 0.018950462341308594, "ViewRequirementAgentConnector_ms": 0.6964812278747559}, "num_episodes": 18, "episode_return_max": 320.0, "episode_return_min": -83.0, "episode_return_mean": 128.51}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.776454573511083, "num_env_steps_trained_throughput_per_sec": 15.776454573511083, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 255104.584, "restore_workers_time_ms": 0.038, "training_step_time_ms": 255104.481, "sample_time_ms": 4550.28, "learn_time_ms": 250533.636, "learn_throughput": 15.966, "synch_weights_time_ms": 12.571}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "1841f_00000", "date": "2024-08-07_23-58-30", "timestamp": 1723089510, "time_this_iter_s": 253.55309104919434, "time_total_s": 2296.074478626251, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a3160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2296.074478626251, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 47.36378830083565, "ram_util_percent": 79.03537604456825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7012792850137393, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.714253935697107, "policy_loss": -0.012423400606397694, "vf_loss": 5.724870160034797, "vf_explained_var": 0.0054303453943599905, "kl": 0.00903588004283938, "entropy": 1.436108034360396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 89205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 470.0, "episode_reward_min": -53.0, "episode_reward_mean": 195.64, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 130.0}, "policy_reward_mean": {"policy_0": 19.564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.0, 47.0, 190.0, 86.0, 17.0, 75.0, 57.0, 118.0, 111.0, 5.0, 135.0, 70.0, -53.0, 79.0, 80.0, 163.0, 140.0, 155.0, 35.0, 170.0, 160.0, 218.0, 186.0, 116.0, 136.0, 170.0, 132.0, 170.0, 143.0, 219.0, 210.0, 117.0, 148.0, 159.0, 57.0, 160.0, 98.0, 109.0, 77.0, 150.0, 230.0, 94.0, 220.0, 180.0, 130.0, 200.0, 127.0, 231.0, 98.0, 261.0, 83.0, 98.0, 226.0, 170.0, 216.0, 187.0, 252.0, 255.0, 198.0, 196.0, 206.0, 250.0, 300.0, 190.0, 260.0, 275.0, 320.0, 148.0, 257.0, 290.0, 188.0, 300.0, 270.0, 410.0, 192.0, 300.0, 245.0, 161.0, 165.0, 282.0, 184.0, 280.0, 205.0, 264.0, 389.0, 242.0, 390.0, 340.0, 170.0, 404.0, 420.0, 278.0, 371.0, 270.0, 330.0, 337.0, 470.0, 210.0, 360.0, 300.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 20.0, 10.0, 17.0, 10.0, 2.0, 0.0, 40.0, 30.0, -18.0, 0.0, -41.0, 40.0, 2.0, -8.0, 0.0, 70.0, 0.0, 40.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 10.0, 0.0, 20.0, 13.0, 0.0, 10.0, 0.0, 3.0, 10.0, 10.0, -2.0, -1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 5.0, 10.0, -5.0, 0.0, 0.0, 0.0, 20.0, 30.0, -15.0, 6.0, 10.0, 0.0, 10.0, 20.0, 0.0, -2.0, 0.0, 0.0, 13.0, 0.0, 20.0, 20.0, 10.0, -1.0, 0.0, 20.0, 9.0, 30.0, 10.0, 8.0, 1.0, 1.0, 0.0, 0.0, 20.0, 11.0, 20.0, 20.0, 30.0, 10.0, -14.0, 14.0, 10.0, 0.0, -22.0, -13.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, -5.0, 0.0, 10.0, 10.0, -10.0, -3.0, 0.0, -20.0, 10.0, 40.0, 40.0, -7.0, 5.0, -21.0, 0.0, -19.0, -31.0, 0.0, -27.0, 0.0, 30.0, 10.0, 10.0, -16.0, 15.0, 7.0, 30.0, 0.0, 0.0, 30.0, 10.0, -7.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 27.0, 10.0, 10.0, 20.0, 40.0, 20.0, 0.0, 6.0, 10.0, 10.0, 30.0, -22.0, -8.0, 20.0, 30.0, 30.0, 20.0, 30.0, 0.0, 0.0, 10.0, 30.0, 10.0, 0.0, 11.0, 19.0, 40.0, 15.0, 20.0, 10.0, 0.0, -13.0, 10.0, 10.0, 10.0, 0.0, 10.0, -12.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 50.0, 0.0, 50.0, 20.0, 0.0, 20.0, 0.0, 24.0, 10.0, -4.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 0.0, 10.0, 29.0, 20.0, 29.0, 0.0, 20.0, 50.0, 50.0, 50.0, 30.0, -7.0, 20.0, -6.0, 50.0, 30.0, 40.0, -6.0, -15.0, 0.0, 0.0, 10.0, 10.0, 20.0, 14.0, 10.0, 0.0, 22.0, 30.0, 20.0, 20.0, -20.0, 50.0, 20.0, 10.0, -7.0, -20.0, 50.0, 13.0, 10.0, 10.0, 60.0, 10.0, 40.0, 30.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 20.0, 0.0, 20.0, 10.0, 28.0, -9.0, 40.0, -27.0, 0.0, 10.0, 10.0, 40.0, -5.0, 30.0, 30.0, 0.0, 20.0, 35.0, 27.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 6.0, 30.0, 10.0, 30.0, 10.0, 29.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 30.0, 34.0, 30.0, -6.0, 21.0, 60.0, -9.0, 20.0, 20.0, 40.0, 0.0, -7.0, 10.0, 30.0, 40.0, 10.0, 0.0, 20.0, 0.0, 4.0, 10.0, -6.0, 10.0, -25.0, 40.0, 12.0, 0.0, 0.0, 67.0, 30.0, 20.0, 40.0, 10.0, 20.0, 0.0, 24.0, -5.0, 40.0, 10.0, 0.0, 20.0, -11.0, 10.0, 0.0, -2.0, 10.0, 0.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, -3.0, 10.0, 1.0, 0.0, 10.0, 0.0, 70.0, 0.0, 0.0, 20.0, 7.0, 10.0, -4.0, 20.0, 0.0, 30.0, -14.0, 40.0, 0.0, 5.0, 20.0, 30.0, -9.0, -3.0, 50.0, -23.0, 4.0, -5.0, 8.0, 0.0, 0.0, 10.0, 40.0, 20.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 50.0, 40.0, 0.0, 20.0, 20.0, -6.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 20.0, 80.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 20.0, 40.0, 10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 30.0, 40.0, -2.0, 10.0, 10.0, 10.0, -1.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 9.0, 10.0, 12.0, 21.0, -1.0, 60.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 9.0, 0.0, 20.0, 9.0, 10.0, 80.0, 0.0, 20.0, 20.0, 40.0, 5.0, 30.0, 40.0, 16.0, 13.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 8.0, 14.0, -2.0, 7.0, 3.0, 4.0, 7.0, 30.0, -18.0, 5.0, 30.0, 20.0, 10.0, 0.0, 4.0, 30.0, 50.0, 2.0, 5.0, 40.0, 40.0, 50.0, 5.0, 30.0, 10.0, 30.0, 0.0, 65.0, 0.0, 10.0, -5.0, 20.0, 10.0, 11.0, 28.0, 19.0, 40.0, 18.0, 5.0, 30.0, 30.0, 20.0, 15.0, 28.0, 9.0, 30.0, 10.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, -3.0, 10.0, 10.0, 17.0, -2.0, 20.0, 30.0, 130.0, 10.0, 30.0, 30.0, 30.0, 0.0, 20.0, 70.0, 5.0, 0.0, 30.0, 40.0, 10.0, 3.0, 10.0, 20.0, 20.0, 30.0, 30.0, -3.0, 90.0, -12.0, -3.0, 30.0, 28.0, 30.0, 30.0, 0.0, 35.0, 0.0, 16.0, 30.0, 19.0, 0.0, 40.0, 27.0, 35.0, 0.0, 10.0, 5.0, 40.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 50.0, 40.0, 20.0, 10.0, 20.0, 20.0, 60.0, 10.0, 60.0, 30.0, 50.0, 10.0, 10.0, 40.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 50.0, 20.0, 20.0, 60.0, 40.0, 20.0, 40.0, 15.0, 40.0, 20.0, -10.0, 20.0, 10.0, 60.0, 60.0, 20.0, 10.0, 30.0, 20.0, 20.0, 40.0, 30.0, 50.0, 40.0, 60.0, -2.0, 33.0, 30.0, 40.0, -10.0, 0.0, 23.0, -22.0, -4.0, 60.0, 0.0, 60.0, 34.0, 10.0, 10.0, 50.0, 40.0, 20.0, 30.0, 3.0, 20.0, 10.0, 20.0, 50.0, 40.0, 40.0, 30.0, 30.0, 10.0, 40.0, 13.0, 30.0, 10.0, 10.0, 20.0, -9.0, 30.0, 4.0, 60.0, 20.0, 20.0, 10.0, 50.0, 10.0, 30.0, 10.0, 50.0, 0.0, 100.0, 20.0, 30.0, 40.0, 20.0, 20.0, 30.0, 20.0, 10.0, 50.0, 30.0, 20.0, 20.0, 10.0, 30.0, 20.0, 90.0, 80.0, 70.0, 0.0, 40.0, 50.0, 20.0, 20.0, 20.0, 10.0, 16.0, 50.0, 20.0, -4.0, 20.0, 20.0, 10.0, 30.0, 30.0, 10.0, 30.0, 10.0, 40.0, 40.0, 70.0, 30.0, 20.0, 70.0, 20.0, 10.0, 10.0, 0.0, 10.0, 55.0, 30.0, 20.0, 10.0, 0.0, 20.0, 60.0, 15.0, 0.0, 10.0, 20.0, 6.0, 20.0, 10.0, 0.0, -5.0, 40.0, 70.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 7.0, 20.0, 20.0, 10.0, 50.0, 50.0, 60.0, 40.0, 5.0, 50.0, 50.0, 10.0, -10.0, 30.0, 0.0, 11.0, 50.0, 13.0, -20.0, 20.0, 110.0, 37.0, 47.0, 19.0, 30.0, 10.0, 27.0, 30.0, -50.0, 10.0, 40.0, -8.0, 20.0, 10.0, 10.0, 40.0, 13.0, 40.0, 30.0, 30.0, 16.0, 20.0, 20.0, 50.0, 30.0, 30.0, 30.0, 28.0, 10.0, 0.0, 70.0, 10.0, 7.0, 90.0, 48.0, 49.0, 15.0, 70.0, 30.0, 50.0, -15.0, -3.0, 10.0, 20.0, 30.0, 20.0, 80.0, 20.0, 30.0, 50.0, 20.0, 110.0, 10.0, 30.0, 10.0, 30.0, 50.0, 50.0, 30.0, 20.0, 50.0, 10.0, 30.0, 70.0, 10.0, 70.0, 50.0, 10.0, 20.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 50.0, 25.0, 30.0, 5.0, 50.0, 40.0, 40.0, 74.0, 30.0, 60.0, 60.0, 60.0, 19.0, 20.0, 40.0, 100.0, 10.0, 60.0, 50.0, 1.0, 17.0, 10.0, 50.0, 47.0, 20.0, 50.0, 28.0, 26.0, 10.0, 20.0, 50.0, 40.0, 30.0, 50.0, 20.0, 5.0, 28.0, 30.0, 30.0, 88.0, 30.0, 70.0, 20.0, 10.0, 10.0, 10.0, 30.0, 10.0, 70.0, 10.0, 10.0, 50.0, 50.0, 10.0, 20.0, 40.0, 40.0, 0.0, 50.0, 60.0, 40.0, 50.0, 70.0, 10.0, 70.0, 29.0, 10.0, 40.0, 20.0, -2.0, 70.0, 60.0, 20.0, 50.0, 60.0, 50.0, 30.0, 50.0, 40.0, 40.0, 0.0, 10.0, -4.0, 80.0, 5.0, 5.0, 40.0, 10.0, 27.0, 37.0, 20.0, 10.0, 40.0, 110.0, 20.0, 50.0, -10.0, 40.0, 30.0, 50.0, 40.0, 10.0, 20.0, 20.0, 60.0, 40.0, 40.0, 30.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.599220736080417, "mean_inference_ms": 2.5938174752384406, "mean_action_processing_ms": 0.8054405599032936, "mean_env_wait_ms": 1.8724914505935883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01791977882385254, "StateBufferConnector_ms": 0.012995243072509766, "ViewRequirementAgentConnector_ms": 0.6222066879272461}, "num_episodes": 27, "episode_return_max": 470.0, "episode_return_min": -53.0, "episode_return_mean": 195.64}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.56925937950471, "num_env_steps_trained_throughput_per_sec": 15.56925937950471, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 255285.779, "restore_workers_time_ms": 0.036, "training_step_time_ms": 255285.682, "sample_time_ms": 4513.318, "learn_time_ms": 250751.78, "learn_throughput": 15.952, "synch_weights_time_ms": 12.674}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 10, "trial_id": "1841f_00000", "date": "2024-08-08_00-02-47", "timestamp": 1723089767, "time_this_iter_s": 256.94088077545166, "time_total_s": 2553.015359401703, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24a61f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2553.015359401703, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 50.04848484848485, "ram_util_percent": 79.92148760330579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1343819408497997, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.459073465726119, "policy_loss": -0.012238107979966127, "vf_loss": 5.469552217403286, "vf_explained_var": 0.007147963340290058, "kl": 0.008796765122532467, "entropy": 1.4233018743217436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 98595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 470.0, "episode_reward_min": 35.0, "episode_reward_mean": 234.41, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 23.441}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 170.0, 160.0, 218.0, 186.0, 116.0, 136.0, 170.0, 132.0, 170.0, 143.0, 219.0, 210.0, 117.0, 148.0, 159.0, 57.0, 160.0, 98.0, 109.0, 77.0, 150.0, 230.0, 94.0, 220.0, 180.0, 130.0, 200.0, 127.0, 231.0, 98.0, 261.0, 83.0, 98.0, 226.0, 170.0, 216.0, 187.0, 252.0, 255.0, 198.0, 196.0, 206.0, 250.0, 300.0, 190.0, 260.0, 275.0, 320.0, 148.0, 257.0, 290.0, 188.0, 300.0, 270.0, 410.0, 192.0, 300.0, 245.0, 161.0, 165.0, 282.0, 184.0, 280.0, 205.0, 264.0, 389.0, 242.0, 390.0, 340.0, 170.0, 404.0, 420.0, 278.0, 371.0, 270.0, 330.0, 337.0, 470.0, 210.0, 360.0, 300.0, 340.0, 254.0, 360.0, 250.0, 167.0, 370.0, 171.0, 68.0, 390.0, 315.0, 290.0, 470.0, 336.0, 260.0, 275.0, 240.0, 400.0, 470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, -13.0, 10.0, 10.0, 10.0, 0.0, 10.0, -12.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 50.0, 0.0, 50.0, 20.0, 0.0, 20.0, 0.0, 24.0, 10.0, -4.0, 20.0, 10.0, 30.0, 20.0, 30.0, 10.0, 0.0, 10.0, 29.0, 20.0, 29.0, 0.0, 20.0, 50.0, 50.0, 50.0, 30.0, -7.0, 20.0, -6.0, 50.0, 30.0, 40.0, -6.0, -15.0, 0.0, 0.0, 10.0, 10.0, 20.0, 14.0, 10.0, 0.0, 22.0, 30.0, 20.0, 20.0, -20.0, 50.0, 20.0, 10.0, -7.0, -20.0, 50.0, 13.0, 10.0, 10.0, 60.0, 10.0, 40.0, 30.0, 0.0, 0.0, 10.0, 0.0, 40.0, 10.0, 20.0, 0.0, 20.0, 10.0, 28.0, -9.0, 40.0, -27.0, 0.0, 10.0, 10.0, 40.0, -5.0, 30.0, 30.0, 0.0, 20.0, 35.0, 27.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 6.0, 30.0, 10.0, 30.0, 10.0, 29.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 30.0, 34.0, 30.0, -6.0, 21.0, 60.0, -9.0, 20.0, 20.0, 40.0, 0.0, -7.0, 10.0, 30.0, 40.0, 10.0, 0.0, 20.0, 0.0, 4.0, 10.0, -6.0, 10.0, -25.0, 40.0, 12.0, 0.0, 0.0, 67.0, 30.0, 20.0, 40.0, 10.0, 20.0, 0.0, 24.0, -5.0, 40.0, 10.0, 0.0, 20.0, -11.0, 10.0, 0.0, -2.0, 10.0, 0.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, -3.0, 10.0, 1.0, 0.0, 10.0, 0.0, 70.0, 0.0, 0.0, 20.0, 7.0, 10.0, -4.0, 20.0, 0.0, 30.0, -14.0, 40.0, 0.0, 5.0, 20.0, 30.0, -9.0, -3.0, 50.0, -23.0, 4.0, -5.0, 8.0, 0.0, 0.0, 10.0, 40.0, 20.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 50.0, 40.0, 0.0, 20.0, 20.0, -6.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 20.0, 80.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 20.0, 40.0, 10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 30.0, 40.0, -2.0, 10.0, 10.0, 10.0, -1.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 9.0, 10.0, 12.0, 21.0, -1.0, 60.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 9.0, 0.0, 20.0, 9.0, 10.0, 80.0, 0.0, 20.0, 20.0, 40.0, 5.0, 30.0, 40.0, 16.0, 13.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 8.0, 14.0, -2.0, 7.0, 3.0, 4.0, 7.0, 30.0, -18.0, 5.0, 30.0, 20.0, 10.0, 0.0, 4.0, 30.0, 50.0, 2.0, 5.0, 40.0, 40.0, 50.0, 5.0, 30.0, 10.0, 30.0, 0.0, 65.0, 0.0, 10.0, -5.0, 20.0, 10.0, 11.0, 28.0, 19.0, 40.0, 18.0, 5.0, 30.0, 30.0, 20.0, 15.0, 28.0, 9.0, 30.0, 10.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, -3.0, 10.0, 10.0, 17.0, -2.0, 20.0, 30.0, 130.0, 10.0, 30.0, 30.0, 30.0, 0.0, 20.0, 70.0, 5.0, 0.0, 30.0, 40.0, 10.0, 3.0, 10.0, 20.0, 20.0, 30.0, 30.0, -3.0, 90.0, -12.0, -3.0, 30.0, 28.0, 30.0, 30.0, 0.0, 35.0, 0.0, 16.0, 30.0, 19.0, 0.0, 40.0, 27.0, 35.0, 0.0, 10.0, 5.0, 40.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 50.0, 40.0, 20.0, 10.0, 20.0, 20.0, 60.0, 10.0, 60.0, 30.0, 50.0, 10.0, 10.0, 40.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 50.0, 20.0, 20.0, 60.0, 40.0, 20.0, 40.0, 15.0, 40.0, 20.0, -10.0, 20.0, 10.0, 60.0, 60.0, 20.0, 10.0, 30.0, 20.0, 20.0, 40.0, 30.0, 50.0, 40.0, 60.0, -2.0, 33.0, 30.0, 40.0, -10.0, 0.0, 23.0, -22.0, -4.0, 60.0, 0.0, 60.0, 34.0, 10.0, 10.0, 50.0, 40.0, 20.0, 30.0, 3.0, 20.0, 10.0, 20.0, 50.0, 40.0, 40.0, 30.0, 30.0, 10.0, 40.0, 13.0, 30.0, 10.0, 10.0, 20.0, -9.0, 30.0, 4.0, 60.0, 20.0, 20.0, 10.0, 50.0, 10.0, 30.0, 10.0, 50.0, 0.0, 100.0, 20.0, 30.0, 40.0, 20.0, 20.0, 30.0, 20.0, 10.0, 50.0, 30.0, 20.0, 20.0, 10.0, 30.0, 20.0, 90.0, 80.0, 70.0, 0.0, 40.0, 50.0, 20.0, 20.0, 20.0, 10.0, 16.0, 50.0, 20.0, -4.0, 20.0, 20.0, 10.0, 30.0, 30.0, 10.0, 30.0, 10.0, 40.0, 40.0, 70.0, 30.0, 20.0, 70.0, 20.0, 10.0, 10.0, 0.0, 10.0, 55.0, 30.0, 20.0, 10.0, 0.0, 20.0, 60.0, 15.0, 0.0, 10.0, 20.0, 6.0, 20.0, 10.0, 0.0, -5.0, 40.0, 70.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 7.0, 20.0, 20.0, 10.0, 50.0, 50.0, 60.0, 40.0, 5.0, 50.0, 50.0, 10.0, -10.0, 30.0, 0.0, 11.0, 50.0, 13.0, -20.0, 20.0, 110.0, 37.0, 47.0, 19.0, 30.0, 10.0, 27.0, 30.0, -50.0, 10.0, 40.0, -8.0, 20.0, 10.0, 10.0, 40.0, 13.0, 40.0, 30.0, 30.0, 16.0, 20.0, 20.0, 50.0, 30.0, 30.0, 30.0, 28.0, 10.0, 0.0, 70.0, 10.0, 7.0, 90.0, 48.0, 49.0, 15.0, 70.0, 30.0, 50.0, -15.0, -3.0, 10.0, 20.0, 30.0, 20.0, 80.0, 20.0, 30.0, 50.0, 20.0, 110.0, 10.0, 30.0, 10.0, 30.0, 50.0, 50.0, 30.0, 20.0, 50.0, 10.0, 30.0, 70.0, 10.0, 70.0, 50.0, 10.0, 20.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 50.0, 25.0, 30.0, 5.0, 50.0, 40.0, 40.0, 74.0, 30.0, 60.0, 60.0, 60.0, 19.0, 20.0, 40.0, 100.0, 10.0, 60.0, 50.0, 1.0, 17.0, 10.0, 50.0, 47.0, 20.0, 50.0, 28.0, 26.0, 10.0, 20.0, 50.0, 40.0, 30.0, 50.0, 20.0, 5.0, 28.0, 30.0, 30.0, 88.0, 30.0, 70.0, 20.0, 10.0, 10.0, 10.0, 30.0, 10.0, 70.0, 10.0, 10.0, 50.0, 50.0, 10.0, 20.0, 40.0, 40.0, 0.0, 50.0, 60.0, 40.0, 50.0, 70.0, 10.0, 70.0, 29.0, 10.0, 40.0, 20.0, -2.0, 70.0, 60.0, 20.0, 50.0, 60.0, 50.0, 30.0, 50.0, 40.0, 40.0, 0.0, 10.0, -4.0, 80.0, 5.0, 5.0, 40.0, 10.0, 27.0, 37.0, 20.0, 10.0, 40.0, 110.0, 20.0, 50.0, -10.0, 40.0, 30.0, 50.0, 40.0, 10.0, 20.0, 20.0, 60.0, 40.0, 40.0, 30.0, 20.0, 20.0, 20.0, 70.0, 20.0, 0.0, 0.0, 30.0, 20.0, 20.0, 0.0, 160.0, 10.0, 70.0, -15.0, 40.0, 30.0, 10.0, 20.0, 10.0, 60.0, 19.0, 40.0, 20.0, 60.0, 30.0, 40.0, 10.0, 60.0, 20.0, 20.0, 60.0, 90.0, 60.0, 20.0, 14.0, 50.0, 3.0, 44.0, 4.0, -35.0, 0.0, 0.0, 0.0, 10.0, -10.0, 20.0, 13.0, 34.0, 20.0, 30.0, 50.0, 60.0, 30.0, 30.0, 50.0, 20.0, 70.0, 20.0, 50.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, -4.0, 30.0, 60.0, -11.0, -8.0, 4.0, 10.0, 31.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, -13.0, 50.0, 10.0, 50.0, 50.0, 10.0, 10.0, 110.0, 50.0, 0.0, 50.0, 10.0, 0.0, 60.0, 40.0, 40.0, 30.0, 45.0, 30.0, 40.0, 20.0, 10.0, 30.0, 30.0, 10.0, 40.0, 40.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, 40.0, 30.0, 110.0, 10.0, 50.0, 110.0, 10.0, 40.0, 30.0, 0.0, 50.0, 46.0, 48.0, 9.0, 20.0, 50.0, 100.0, -17.0, 10.0, 10.0, 20.0, 40.0, 40.0, 30.0, 30.0, 20.0, 30.0, 30.0, 25.0, 40.0, 20.0, 20.0, 20.0, 40.0, 20.0, 30.0, 50.0, 10.0, 20.0, 50.0, 0.0, 20.0, 50.0, 30.0, 40.0, 10.0, 10.0, 10.0, 20.0, 40.0, 60.0, 90.0, 18.0, 5.0, 20.0, 70.0, 80.0, -3.0, 100.0, 30.0, 20.0, 30.0, 20.0, 60.0, 50.0, 20.0, 50.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.59656331814984, "mean_inference_ms": 2.620967730926618, "mean_action_processing_ms": 0.7992217398071132, "mean_env_wait_ms": 1.8598308088060946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018601179122924805, "StateBufferConnector_ms": 0.011178016662597656, "ViewRequirementAgentConnector_ms": 0.648881196975708}, "num_episodes": 18, "episode_return_max": 470.0, "episode_return_min": 35.0, "episode_return_mean": 234.41}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.490342219587315, "num_env_steps_trained_throughput_per_sec": 15.490342219587315, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 255245.242, "restore_workers_time_ms": 0.036, "training_step_time_ms": 255245.147, "sample_time_ms": 4391.09, "learn_time_ms": 250833.871, "learn_throughput": 15.947, "synch_weights_time_ms": 12.673}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 11, "trial_id": "1841f_00000", "date": "2024-08-08_00-07-05", "timestamp": 1723090025, "time_this_iter_s": 258.2434358596802, "time_total_s": 2811.258795261383, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2413550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2811.258795261383, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 48.69232876712329, "ram_util_percent": 78.83808219178083}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0724058019277005, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.958364517213945, "policy_loss": -0.011428271825658405, "vf_loss": 5.968018224825874, "vf_explained_var": 0.008833958064151394, "kl": 0.008872804720314785, "entropy": 1.3861827522421035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 107985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 518.0, "episode_reward_min": 68.0, "episode_reward_mean": 270.14, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 27.014}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0, 109.0, 77.0, 150.0, 230.0, 94.0, 220.0, 180.0, 130.0, 200.0, 127.0, 231.0, 98.0, 261.0, 83.0, 98.0, 226.0, 170.0, 216.0, 187.0, 252.0, 255.0, 198.0, 196.0, 206.0, 250.0, 300.0, 190.0, 260.0, 275.0, 320.0, 148.0, 257.0, 290.0, 188.0, 300.0, 270.0, 410.0, 192.0, 300.0, 245.0, 161.0, 165.0, 282.0, 184.0, 280.0, 205.0, 264.0, 389.0, 242.0, 390.0, 340.0, 170.0, 404.0, 420.0, 278.0, 371.0, 270.0, 330.0, 337.0, 470.0, 210.0, 360.0, 300.0, 340.0, 254.0, 360.0, 250.0, 167.0, 370.0, 171.0, 68.0, 390.0, 315.0, 290.0, 470.0, 336.0, 260.0, 275.0, 240.0, 400.0, 470.0, 295.0, 252.0, 490.0, 360.0, 370.0, 319.0, 440.0, 518.0, 257.0, 210.0, 243.0, 213.0, 455.0, 445.0, 400.0, 201.0, 392.0, 419.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, -3.0, 10.0, 1.0, 0.0, 10.0, 0.0, 70.0, 0.0, 0.0, 20.0, 7.0, 10.0, -4.0, 20.0, 0.0, 30.0, -14.0, 40.0, 0.0, 5.0, 20.0, 30.0, -9.0, -3.0, 50.0, -23.0, 4.0, -5.0, 8.0, 0.0, 0.0, 10.0, 40.0, 20.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, 20.0, 20.0, 30.0, 20.0, 50.0, 40.0, 0.0, 20.0, 20.0, -6.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 20.0, 80.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 10.0, 30.0, 20.0, 20.0, 20.0, 40.0, 10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 30.0, 40.0, -2.0, 10.0, 10.0, 10.0, -1.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 9.0, 10.0, 12.0, 21.0, -1.0, 60.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 9.0, 0.0, 20.0, 9.0, 10.0, 80.0, 0.0, 20.0, 20.0, 40.0, 5.0, 30.0, 40.0, 16.0, 13.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 8.0, 14.0, -2.0, 7.0, 3.0, 4.0, 7.0, 30.0, -18.0, 5.0, 30.0, 20.0, 10.0, 0.0, 4.0, 30.0, 50.0, 2.0, 5.0, 40.0, 40.0, 50.0, 5.0, 30.0, 10.0, 30.0, 0.0, 65.0, 0.0, 10.0, -5.0, 20.0, 10.0, 11.0, 28.0, 19.0, 40.0, 18.0, 5.0, 30.0, 30.0, 20.0, 15.0, 28.0, 9.0, 30.0, 10.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, -3.0, 10.0, 10.0, 17.0, -2.0, 20.0, 30.0, 130.0, 10.0, 30.0, 30.0, 30.0, 0.0, 20.0, 70.0, 5.0, 0.0, 30.0, 40.0, 10.0, 3.0, 10.0, 20.0, 20.0, 30.0, 30.0, -3.0, 90.0, -12.0, -3.0, 30.0, 28.0, 30.0, 30.0, 0.0, 35.0, 0.0, 16.0, 30.0, 19.0, 0.0, 40.0, 27.0, 35.0, 0.0, 10.0, 5.0, 40.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 50.0, 40.0, 20.0, 10.0, 20.0, 20.0, 60.0, 10.0, 60.0, 30.0, 50.0, 10.0, 10.0, 40.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 50.0, 20.0, 20.0, 60.0, 40.0, 20.0, 40.0, 15.0, 40.0, 20.0, -10.0, 20.0, 10.0, 60.0, 60.0, 20.0, 10.0, 30.0, 20.0, 20.0, 40.0, 30.0, 50.0, 40.0, 60.0, -2.0, 33.0, 30.0, 40.0, -10.0, 0.0, 23.0, -22.0, -4.0, 60.0, 0.0, 60.0, 34.0, 10.0, 10.0, 50.0, 40.0, 20.0, 30.0, 3.0, 20.0, 10.0, 20.0, 50.0, 40.0, 40.0, 30.0, 30.0, 10.0, 40.0, 13.0, 30.0, 10.0, 10.0, 20.0, -9.0, 30.0, 4.0, 60.0, 20.0, 20.0, 10.0, 50.0, 10.0, 30.0, 10.0, 50.0, 0.0, 100.0, 20.0, 30.0, 40.0, 20.0, 20.0, 30.0, 20.0, 10.0, 50.0, 30.0, 20.0, 20.0, 10.0, 30.0, 20.0, 90.0, 80.0, 70.0, 0.0, 40.0, 50.0, 20.0, 20.0, 20.0, 10.0, 16.0, 50.0, 20.0, -4.0, 20.0, 20.0, 10.0, 30.0, 30.0, 10.0, 30.0, 10.0, 40.0, 40.0, 70.0, 30.0, 20.0, 70.0, 20.0, 10.0, 10.0, 0.0, 10.0, 55.0, 30.0, 20.0, 10.0, 0.0, 20.0, 60.0, 15.0, 0.0, 10.0, 20.0, 6.0, 20.0, 10.0, 0.0, -5.0, 40.0, 70.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 7.0, 20.0, 20.0, 10.0, 50.0, 50.0, 60.0, 40.0, 5.0, 50.0, 50.0, 10.0, -10.0, 30.0, 0.0, 11.0, 50.0, 13.0, -20.0, 20.0, 110.0, 37.0, 47.0, 19.0, 30.0, 10.0, 27.0, 30.0, -50.0, 10.0, 40.0, -8.0, 20.0, 10.0, 10.0, 40.0, 13.0, 40.0, 30.0, 30.0, 16.0, 20.0, 20.0, 50.0, 30.0, 30.0, 30.0, 28.0, 10.0, 0.0, 70.0, 10.0, 7.0, 90.0, 48.0, 49.0, 15.0, 70.0, 30.0, 50.0, -15.0, -3.0, 10.0, 20.0, 30.0, 20.0, 80.0, 20.0, 30.0, 50.0, 20.0, 110.0, 10.0, 30.0, 10.0, 30.0, 50.0, 50.0, 30.0, 20.0, 50.0, 10.0, 30.0, 70.0, 10.0, 70.0, 50.0, 10.0, 20.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 50.0, 25.0, 30.0, 5.0, 50.0, 40.0, 40.0, 74.0, 30.0, 60.0, 60.0, 60.0, 19.0, 20.0, 40.0, 100.0, 10.0, 60.0, 50.0, 1.0, 17.0, 10.0, 50.0, 47.0, 20.0, 50.0, 28.0, 26.0, 10.0, 20.0, 50.0, 40.0, 30.0, 50.0, 20.0, 5.0, 28.0, 30.0, 30.0, 88.0, 30.0, 70.0, 20.0, 10.0, 10.0, 10.0, 30.0, 10.0, 70.0, 10.0, 10.0, 50.0, 50.0, 10.0, 20.0, 40.0, 40.0, 0.0, 50.0, 60.0, 40.0, 50.0, 70.0, 10.0, 70.0, 29.0, 10.0, 40.0, 20.0, -2.0, 70.0, 60.0, 20.0, 50.0, 60.0, 50.0, 30.0, 50.0, 40.0, 40.0, 0.0, 10.0, -4.0, 80.0, 5.0, 5.0, 40.0, 10.0, 27.0, 37.0, 20.0, 10.0, 40.0, 110.0, 20.0, 50.0, -10.0, 40.0, 30.0, 50.0, 40.0, 10.0, 20.0, 20.0, 60.0, 40.0, 40.0, 30.0, 20.0, 20.0, 20.0, 70.0, 20.0, 0.0, 0.0, 30.0, 20.0, 20.0, 0.0, 160.0, 10.0, 70.0, -15.0, 40.0, 30.0, 10.0, 20.0, 10.0, 60.0, 19.0, 40.0, 20.0, 60.0, 30.0, 40.0, 10.0, 60.0, 20.0, 20.0, 60.0, 90.0, 60.0, 20.0, 14.0, 50.0, 3.0, 44.0, 4.0, -35.0, 0.0, 0.0, 0.0, 10.0, -10.0, 20.0, 13.0, 34.0, 20.0, 30.0, 50.0, 60.0, 30.0, 30.0, 50.0, 20.0, 70.0, 20.0, 50.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, -4.0, 30.0, 60.0, -11.0, -8.0, 4.0, 10.0, 31.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, -13.0, 50.0, 10.0, 50.0, 50.0, 10.0, 10.0, 110.0, 50.0, 0.0, 50.0, 10.0, 0.0, 60.0, 40.0, 40.0, 30.0, 45.0, 30.0, 40.0, 20.0, 10.0, 30.0, 30.0, 10.0, 40.0, 40.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, 40.0, 30.0, 110.0, 10.0, 50.0, 110.0, 10.0, 40.0, 30.0, 0.0, 50.0, 46.0, 48.0, 9.0, 20.0, 50.0, 100.0, -17.0, 10.0, 10.0, 20.0, 40.0, 40.0, 30.0, 30.0, 20.0, 30.0, 30.0, 25.0, 40.0, 20.0, 20.0, 20.0, 40.0, 20.0, 30.0, 50.0, 10.0, 20.0, 50.0, 0.0, 20.0, 50.0, 30.0, 40.0, 10.0, 10.0, 10.0, 20.0, 40.0, 60.0, 90.0, 18.0, 5.0, 20.0, 70.0, 80.0, -3.0, 100.0, 30.0, 20.0, 30.0, 20.0, 60.0, 50.0, 20.0, 50.0, 90.0, 30.0, 30.0, 10.0, 70.0, 15.0, 25.0, 25.0, 30.0, 30.0, 30.0, 50.0, -11.0, 13.0, 0.0, 20.0, 30.0, 50.0, 20.0, 30.0, 50.0, 10.0, 80.0, 50.0, 70.0, 40.0, 90.0, 40.0, 50.0, 50.0, 10.0, 12.0, 20.0, 20.0, 12.0, 0.0, 80.0, 29.0, 37.0, 100.0, 50.0, 40.0, 80.0, 30.0, 30.0, 40.0, 30.0, 30.0, 70.0, 0.0, 20.0, 29.0, 30.0, 30.0, 80.0, 20.0, 50.0, 0.0, 10.0, 50.0, 20.0, 20.0, 70.0, 40.0, 60.0, 50.0, 30.0, 30.0, 30.0, 40.0, 70.0, 80.0, 80.0, 50.0, 30.0, 40.0, 70.0, 18.0, 20.0, 130.0, 0.0, 30.0, 20.0, 30.0, -7.0, 30.0, 10.0, 70.0, 4.0, 40.0, 30.0, -40.0, 0.0, 40.0, 40.0, 20.0, 50.0, 10.0, 0.0, 80.0, 10.0, 40.0, 30.0, 8.0, 20.0, 30.0, 10.0, -5.0, 50.0, 20.0, 40.0, -6.0, 30.0, 10.0, 26.0, -6.0, 10.0, 60.0, 9.0, 20.0, 60.0, 40.0, 30.0, 60.0, 60.0, 70.0, 40.0, 30.0, 15.0, 110.0, 0.0, 50.0, 50.0, 50.0, 0.0, 90.0, 70.0, 40.0, -5.0, 70.0, 30.0, 60.0, 50.0, 30.0, 50.0, 20.0, 10.0, 20.0, 60.0, 50.0, 50.0, 40.0, 20.0, -4.0, 0.0, 20.0, 40.0, 15.0, 40.0, 20.0, 10.0, 60.0, 50.0, 70.0, 30.0, 40.0, 28.0, 30.0, 30.0, 30.0, 24.0, 10.0, 10.0, 29.0, 120.0, 0.0, 10.0, 40.0, 120.0, 60.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5973316205218198, "mean_inference_ms": 2.6439938950716777, "mean_action_processing_ms": 0.7953703710768335, "mean_env_wait_ms": 1.8509583780225274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01807880401611328, "StateBufferConnector_ms": 0.011058807373046875, "ViewRequirementAgentConnector_ms": 0.6039893627166748}, "num_episodes": 18, "episode_return_max": 518.0, "episode_return_min": 68.0, "episode_return_mean": 270.14}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.642079197349343, "num_env_steps_trained_throughput_per_sec": 15.642079197349343, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 255622.055, "restore_workers_time_ms": 0.036, "training_step_time_ms": 255621.961, "sample_time_ms": 4453.536, "learn_time_ms": 251148.288, "learn_throughput": 15.927, "synch_weights_time_ms": 12.602}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 12, "trial_id": "1841f_00000", "date": "2024-08-08_00-11-21", "timestamp": 1723090281, "time_this_iter_s": 255.7616240978241, "time_total_s": 3067.020419359207, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2484e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3067.020419359207, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 48.10858725761773, "ram_util_percent": 78.798891966759}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5113966479976844, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.375349465117287, "policy_loss": -0.012382112475582204, "vf_loss": 6.385895685240611, "vf_explained_var": 0.006288741286189411, "kl": 0.009179447687701483, "entropy": 1.3444176033662911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 117375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 518.0, "episode_reward_min": 68.0, "episode_reward_mean": 302.57, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 30.257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [216.0, 187.0, 252.0, 255.0, 198.0, 196.0, 206.0, 250.0, 300.0, 190.0, 260.0, 275.0, 320.0, 148.0, 257.0, 290.0, 188.0, 300.0, 270.0, 410.0, 192.0, 300.0, 245.0, 161.0, 165.0, 282.0, 184.0, 280.0, 205.0, 264.0, 389.0, 242.0, 390.0, 340.0, 170.0, 404.0, 420.0, 278.0, 371.0, 270.0, 330.0, 337.0, 470.0, 210.0, 360.0, 300.0, 340.0, 254.0, 360.0, 250.0, 167.0, 370.0, 171.0, 68.0, 390.0, 315.0, 290.0, 470.0, 336.0, 260.0, 275.0, 240.0, 400.0, 470.0, 295.0, 252.0, 490.0, 360.0, 370.0, 319.0, 440.0, 518.0, 257.0, 210.0, 243.0, 213.0, 455.0, 445.0, 400.0, 201.0, 392.0, 419.0, 300.0, 464.0, 370.0, 328.0, 252.0, 324.0, 359.0, 438.0, 289.0, 414.0, 316.0, 262.0, 274.0, 390.0, 158.0, 312.0, 332.0, 443.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [11.0, 28.0, 19.0, 40.0, 18.0, 5.0, 30.0, 30.0, 20.0, 15.0, 28.0, 9.0, 30.0, 10.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, -3.0, 10.0, 10.0, 17.0, -2.0, 20.0, 30.0, 130.0, 10.0, 30.0, 30.0, 30.0, 0.0, 20.0, 70.0, 5.0, 0.0, 30.0, 40.0, 10.0, 3.0, 10.0, 20.0, 20.0, 30.0, 30.0, -3.0, 90.0, -12.0, -3.0, 30.0, 28.0, 30.0, 30.0, 0.0, 35.0, 0.0, 16.0, 30.0, 19.0, 0.0, 40.0, 27.0, 35.0, 0.0, 10.0, 5.0, 40.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 50.0, 40.0, 20.0, 10.0, 20.0, 20.0, 60.0, 10.0, 60.0, 30.0, 50.0, 10.0, 10.0, 40.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 10.0, 20.0, 40.0, 20.0, 10.0, 20.0, 10.0, 20.0, 20.0, 0.0, 50.0, 20.0, 20.0, 60.0, 40.0, 20.0, 40.0, 15.0, 40.0, 20.0, -10.0, 20.0, 10.0, 60.0, 60.0, 20.0, 10.0, 30.0, 20.0, 20.0, 40.0, 30.0, 50.0, 40.0, 60.0, -2.0, 33.0, 30.0, 40.0, -10.0, 0.0, 23.0, -22.0, -4.0, 60.0, 0.0, 60.0, 34.0, 10.0, 10.0, 50.0, 40.0, 20.0, 30.0, 3.0, 20.0, 10.0, 20.0, 50.0, 40.0, 40.0, 30.0, 30.0, 10.0, 40.0, 13.0, 30.0, 10.0, 10.0, 20.0, -9.0, 30.0, 4.0, 60.0, 20.0, 20.0, 10.0, 50.0, 10.0, 30.0, 10.0, 50.0, 0.0, 100.0, 20.0, 30.0, 40.0, 20.0, 20.0, 30.0, 20.0, 10.0, 50.0, 30.0, 20.0, 20.0, 10.0, 30.0, 20.0, 90.0, 80.0, 70.0, 0.0, 40.0, 50.0, 20.0, 20.0, 20.0, 10.0, 16.0, 50.0, 20.0, -4.0, 20.0, 20.0, 10.0, 30.0, 30.0, 10.0, 30.0, 10.0, 40.0, 40.0, 70.0, 30.0, 20.0, 70.0, 20.0, 10.0, 10.0, 0.0, 10.0, 55.0, 30.0, 20.0, 10.0, 0.0, 20.0, 60.0, 15.0, 0.0, 10.0, 20.0, 6.0, 20.0, 10.0, 0.0, -5.0, 40.0, 70.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 7.0, 20.0, 20.0, 10.0, 50.0, 50.0, 60.0, 40.0, 5.0, 50.0, 50.0, 10.0, -10.0, 30.0, 0.0, 11.0, 50.0, 13.0, -20.0, 20.0, 110.0, 37.0, 47.0, 19.0, 30.0, 10.0, 27.0, 30.0, -50.0, 10.0, 40.0, -8.0, 20.0, 10.0, 10.0, 40.0, 13.0, 40.0, 30.0, 30.0, 16.0, 20.0, 20.0, 50.0, 30.0, 30.0, 30.0, 28.0, 10.0, 0.0, 70.0, 10.0, 7.0, 90.0, 48.0, 49.0, 15.0, 70.0, 30.0, 50.0, -15.0, -3.0, 10.0, 20.0, 30.0, 20.0, 80.0, 20.0, 30.0, 50.0, 20.0, 110.0, 10.0, 30.0, 10.0, 30.0, 50.0, 50.0, 30.0, 20.0, 50.0, 10.0, 30.0, 70.0, 10.0, 70.0, 50.0, 10.0, 20.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 50.0, 25.0, 30.0, 5.0, 50.0, 40.0, 40.0, 74.0, 30.0, 60.0, 60.0, 60.0, 19.0, 20.0, 40.0, 100.0, 10.0, 60.0, 50.0, 1.0, 17.0, 10.0, 50.0, 47.0, 20.0, 50.0, 28.0, 26.0, 10.0, 20.0, 50.0, 40.0, 30.0, 50.0, 20.0, 5.0, 28.0, 30.0, 30.0, 88.0, 30.0, 70.0, 20.0, 10.0, 10.0, 10.0, 30.0, 10.0, 70.0, 10.0, 10.0, 50.0, 50.0, 10.0, 20.0, 40.0, 40.0, 0.0, 50.0, 60.0, 40.0, 50.0, 70.0, 10.0, 70.0, 29.0, 10.0, 40.0, 20.0, -2.0, 70.0, 60.0, 20.0, 50.0, 60.0, 50.0, 30.0, 50.0, 40.0, 40.0, 0.0, 10.0, -4.0, 80.0, 5.0, 5.0, 40.0, 10.0, 27.0, 37.0, 20.0, 10.0, 40.0, 110.0, 20.0, 50.0, -10.0, 40.0, 30.0, 50.0, 40.0, 10.0, 20.0, 20.0, 60.0, 40.0, 40.0, 30.0, 20.0, 20.0, 20.0, 70.0, 20.0, 0.0, 0.0, 30.0, 20.0, 20.0, 0.0, 160.0, 10.0, 70.0, -15.0, 40.0, 30.0, 10.0, 20.0, 10.0, 60.0, 19.0, 40.0, 20.0, 60.0, 30.0, 40.0, 10.0, 60.0, 20.0, 20.0, 60.0, 90.0, 60.0, 20.0, 14.0, 50.0, 3.0, 44.0, 4.0, -35.0, 0.0, 0.0, 0.0, 10.0, -10.0, 20.0, 13.0, 34.0, 20.0, 30.0, 50.0, 60.0, 30.0, 30.0, 50.0, 20.0, 70.0, 20.0, 50.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, -4.0, 30.0, 60.0, -11.0, -8.0, 4.0, 10.0, 31.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, -13.0, 50.0, 10.0, 50.0, 50.0, 10.0, 10.0, 110.0, 50.0, 0.0, 50.0, 10.0, 0.0, 60.0, 40.0, 40.0, 30.0, 45.0, 30.0, 40.0, 20.0, 10.0, 30.0, 30.0, 10.0, 40.0, 40.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, 40.0, 30.0, 110.0, 10.0, 50.0, 110.0, 10.0, 40.0, 30.0, 0.0, 50.0, 46.0, 48.0, 9.0, 20.0, 50.0, 100.0, -17.0, 10.0, 10.0, 20.0, 40.0, 40.0, 30.0, 30.0, 20.0, 30.0, 30.0, 25.0, 40.0, 20.0, 20.0, 20.0, 40.0, 20.0, 30.0, 50.0, 10.0, 20.0, 50.0, 0.0, 20.0, 50.0, 30.0, 40.0, 10.0, 10.0, 10.0, 20.0, 40.0, 60.0, 90.0, 18.0, 5.0, 20.0, 70.0, 80.0, -3.0, 100.0, 30.0, 20.0, 30.0, 20.0, 60.0, 50.0, 20.0, 50.0, 90.0, 30.0, 30.0, 10.0, 70.0, 15.0, 25.0, 25.0, 30.0, 30.0, 30.0, 50.0, -11.0, 13.0, 0.0, 20.0, 30.0, 50.0, 20.0, 30.0, 50.0, 10.0, 80.0, 50.0, 70.0, 40.0, 90.0, 40.0, 50.0, 50.0, 10.0, 12.0, 20.0, 20.0, 12.0, 0.0, 80.0, 29.0, 37.0, 100.0, 50.0, 40.0, 80.0, 30.0, 30.0, 40.0, 30.0, 30.0, 70.0, 0.0, 20.0, 29.0, 30.0, 30.0, 80.0, 20.0, 50.0, 0.0, 10.0, 50.0, 20.0, 20.0, 70.0, 40.0, 60.0, 50.0, 30.0, 30.0, 30.0, 40.0, 70.0, 80.0, 80.0, 50.0, 30.0, 40.0, 70.0, 18.0, 20.0, 130.0, 0.0, 30.0, 20.0, 30.0, -7.0, 30.0, 10.0, 70.0, 4.0, 40.0, 30.0, -40.0, 0.0, 40.0, 40.0, 20.0, 50.0, 10.0, 0.0, 80.0, 10.0, 40.0, 30.0, 8.0, 20.0, 30.0, 10.0, -5.0, 50.0, 20.0, 40.0, -6.0, 30.0, 10.0, 26.0, -6.0, 10.0, 60.0, 9.0, 20.0, 60.0, 40.0, 30.0, 60.0, 60.0, 70.0, 40.0, 30.0, 15.0, 110.0, 0.0, 50.0, 50.0, 50.0, 0.0, 90.0, 70.0, 40.0, -5.0, 70.0, 30.0, 60.0, 50.0, 30.0, 50.0, 20.0, 10.0, 20.0, 60.0, 50.0, 50.0, 40.0, 20.0, -4.0, 0.0, 20.0, 40.0, 15.0, 40.0, 20.0, 10.0, 60.0, 50.0, 70.0, 30.0, 40.0, 28.0, 30.0, 30.0, 30.0, 24.0, 10.0, 10.0, 29.0, 120.0, 0.0, 10.0, 40.0, 120.0, 60.0, 20.0, -2.0, -8.0, 30.0, 20.0, 30.0, 30.0, 60.0, 90.0, 10.0, 40.0, 20.0, 26.0, 70.0, 38.0, 50.0, 40.0, 90.0, 40.0, 40.0, 50.0, -9.0, 44.0, 40.0, 50.0, 50.0, 45.0, 50.0, 40.0, 30.0, 30.0, 10.0, 60.0, 80.0, 30.0, 40.0, 12.0, -6.0, 32.0, 30.0, 40.0, 40.0, 20.0, 30.0, 24.0, 25.0, 0.0, 40.0, 43.0, 20.0, 10.0, 30.0, 70.0, 40.0, 70.0, 37.0, 27.0, 20.0, 10.0, 0.0, 20.0, 70.0, 60.0, 30.0, 90.0, -10.0, 30.0, 20.0, 49.0, 20.0, 0.0, 47.0, 10.0, 40.0, 140.0, 50.0, 20.0, 48.0, 26.0, 50.0, 7.0, 30.0, 10.0, 60.0, 20.0, 20.0, 20.0, 60.0, 30.0, 40.0, -1.0, 50.0, 30.0, 50.0, 40.0, 120.0, 30.0, 0.0, 22.0, -18.0, 90.0, 0.0, 48.0, 30.0, 0.0, 20.0, 40.0, 40.0, 0.0, 18.0, 120.0, 40.0, 38.0, 30.0, 27.0, 39.0, 30.0, 10.0, 0.0, 8.0, 40.0, 30.0, 30.0, 20.0, 19.0, 29.0, 50.0, 40.0, 20.0, 17.0, 19.0, 0.0, 100.0, 40.0, 25.0, 30.0, 36.0, 0.0, 30.0, 80.0, 49.0, 20.0, 30.0, 28.0, 30.0, 40.0, 5.0, 24.0, -19.0, 6.0, -6.0, 30.0, 20.0, 80.0, 40.0, -4.0, 20.0, 30.0, 26.0, 10.0, 60.0, 30.0, 20.0, 0.0, 68.0, 10.0, 34.0, 80.0, 30.0, 0.0, 60.0, 40.0, 120.0, 2.0, 50.0, 0.0, 120.0, 10.0, 3.0, -12.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.594282715384748, "mean_inference_ms": 2.6601963895801504, "mean_action_processing_ms": 0.7925909163046383, "mean_env_wait_ms": 1.8456576916636356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024021148681640625, "StateBufferConnector_ms": 0.011546134948730469, "ViewRequirementAgentConnector_ms": 0.6525640487670898}, "num_episodes": 18, "episode_return_max": 518.0, "episode_return_min": 68.0, "episode_return_mean": 302.57}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.478158703825766, "num_env_steps_trained_throughput_per_sec": 15.478158703825766, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 255905.867, "restore_workers_time_ms": 0.035, "training_step_time_ms": 255905.774, "sample_time_ms": 4410.129, "learn_time_ms": 251475.958, "learn_throughput": 15.906, "synch_weights_time_ms": 12.964}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 13, "trial_id": "1841f_00000", "date": "2024-08-08_00-15-40", "timestamp": 1723090540, "time_this_iter_s": 258.43711590766907, "time_total_s": 3325.457535266876, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b249caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3325.457535266876, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 49.04863387978142, "ram_util_percent": 79.49344262295081}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1694825616951823, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.010575396057389, "policy_loss": -0.012422179867076083, "vf_loss": 7.021156634360203, "vf_explained_var": 0.0029530439450464055, "kl": 0.009204697378783527, "entropy": 1.3037323329649286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 126765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 690.0, "episode_reward_min": 68.0, "episode_reward_mean": 343.78, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 34.378}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.0, 410.0, 192.0, 300.0, 245.0, 161.0, 165.0, 282.0, 184.0, 280.0, 205.0, 264.0, 389.0, 242.0, 390.0, 340.0, 170.0, 404.0, 420.0, 278.0, 371.0, 270.0, 330.0, 337.0, 470.0, 210.0, 360.0, 300.0, 340.0, 254.0, 360.0, 250.0, 167.0, 370.0, 171.0, 68.0, 390.0, 315.0, 290.0, 470.0, 336.0, 260.0, 275.0, 240.0, 400.0, 470.0, 295.0, 252.0, 490.0, 360.0, 370.0, 319.0, 440.0, 518.0, 257.0, 210.0, 243.0, 213.0, 455.0, 445.0, 400.0, 201.0, 392.0, 419.0, 300.0, 464.0, 370.0, 328.0, 252.0, 324.0, 359.0, 438.0, 289.0, 414.0, 316.0, 262.0, 274.0, 390.0, 158.0, 312.0, 332.0, 443.0, 520.0, 406.0, 450.0, 565.0, 285.0, 558.0, 371.0, 450.0, 418.0, 660.0, 428.0, 690.0, 376.0, 580.0, 390.0, 238.0, 530.0, 494.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 40.0, 20.0, 20.0, 30.0, 20.0, 10.0, 50.0, 30.0, 20.0, 20.0, 10.0, 30.0, 20.0, 90.0, 80.0, 70.0, 0.0, 40.0, 50.0, 20.0, 20.0, 20.0, 10.0, 16.0, 50.0, 20.0, -4.0, 20.0, 20.0, 10.0, 30.0, 30.0, 10.0, 30.0, 10.0, 40.0, 40.0, 70.0, 30.0, 20.0, 70.0, 20.0, 10.0, 10.0, 0.0, 10.0, 55.0, 30.0, 20.0, 10.0, 0.0, 20.0, 60.0, 15.0, 0.0, 10.0, 20.0, 6.0, 20.0, 10.0, 0.0, -5.0, 40.0, 70.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 7.0, 20.0, 20.0, 10.0, 50.0, 50.0, 60.0, 40.0, 5.0, 50.0, 50.0, 10.0, -10.0, 30.0, 0.0, 11.0, 50.0, 13.0, -20.0, 20.0, 110.0, 37.0, 47.0, 19.0, 30.0, 10.0, 27.0, 30.0, -50.0, 10.0, 40.0, -8.0, 20.0, 10.0, 10.0, 40.0, 13.0, 40.0, 30.0, 30.0, 16.0, 20.0, 20.0, 50.0, 30.0, 30.0, 30.0, 28.0, 10.0, 0.0, 70.0, 10.0, 7.0, 90.0, 48.0, 49.0, 15.0, 70.0, 30.0, 50.0, -15.0, -3.0, 10.0, 20.0, 30.0, 20.0, 80.0, 20.0, 30.0, 50.0, 20.0, 110.0, 10.0, 30.0, 10.0, 30.0, 50.0, 50.0, 30.0, 20.0, 50.0, 10.0, 30.0, 70.0, 10.0, 70.0, 50.0, 10.0, 20.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 50.0, 25.0, 30.0, 5.0, 50.0, 40.0, 40.0, 74.0, 30.0, 60.0, 60.0, 60.0, 19.0, 20.0, 40.0, 100.0, 10.0, 60.0, 50.0, 1.0, 17.0, 10.0, 50.0, 47.0, 20.0, 50.0, 28.0, 26.0, 10.0, 20.0, 50.0, 40.0, 30.0, 50.0, 20.0, 5.0, 28.0, 30.0, 30.0, 88.0, 30.0, 70.0, 20.0, 10.0, 10.0, 10.0, 30.0, 10.0, 70.0, 10.0, 10.0, 50.0, 50.0, 10.0, 20.0, 40.0, 40.0, 0.0, 50.0, 60.0, 40.0, 50.0, 70.0, 10.0, 70.0, 29.0, 10.0, 40.0, 20.0, -2.0, 70.0, 60.0, 20.0, 50.0, 60.0, 50.0, 30.0, 50.0, 40.0, 40.0, 0.0, 10.0, -4.0, 80.0, 5.0, 5.0, 40.0, 10.0, 27.0, 37.0, 20.0, 10.0, 40.0, 110.0, 20.0, 50.0, -10.0, 40.0, 30.0, 50.0, 40.0, 10.0, 20.0, 20.0, 60.0, 40.0, 40.0, 30.0, 20.0, 20.0, 20.0, 70.0, 20.0, 0.0, 0.0, 30.0, 20.0, 20.0, 0.0, 160.0, 10.0, 70.0, -15.0, 40.0, 30.0, 10.0, 20.0, 10.0, 60.0, 19.0, 40.0, 20.0, 60.0, 30.0, 40.0, 10.0, 60.0, 20.0, 20.0, 60.0, 90.0, 60.0, 20.0, 14.0, 50.0, 3.0, 44.0, 4.0, -35.0, 0.0, 0.0, 0.0, 10.0, -10.0, 20.0, 13.0, 34.0, 20.0, 30.0, 50.0, 60.0, 30.0, 30.0, 50.0, 20.0, 70.0, 20.0, 50.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, -4.0, 30.0, 60.0, -11.0, -8.0, 4.0, 10.0, 31.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, -13.0, 50.0, 10.0, 50.0, 50.0, 10.0, 10.0, 110.0, 50.0, 0.0, 50.0, 10.0, 0.0, 60.0, 40.0, 40.0, 30.0, 45.0, 30.0, 40.0, 20.0, 10.0, 30.0, 30.0, 10.0, 40.0, 40.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, 40.0, 30.0, 110.0, 10.0, 50.0, 110.0, 10.0, 40.0, 30.0, 0.0, 50.0, 46.0, 48.0, 9.0, 20.0, 50.0, 100.0, -17.0, 10.0, 10.0, 20.0, 40.0, 40.0, 30.0, 30.0, 20.0, 30.0, 30.0, 25.0, 40.0, 20.0, 20.0, 20.0, 40.0, 20.0, 30.0, 50.0, 10.0, 20.0, 50.0, 0.0, 20.0, 50.0, 30.0, 40.0, 10.0, 10.0, 10.0, 20.0, 40.0, 60.0, 90.0, 18.0, 5.0, 20.0, 70.0, 80.0, -3.0, 100.0, 30.0, 20.0, 30.0, 20.0, 60.0, 50.0, 20.0, 50.0, 90.0, 30.0, 30.0, 10.0, 70.0, 15.0, 25.0, 25.0, 30.0, 30.0, 30.0, 50.0, -11.0, 13.0, 0.0, 20.0, 30.0, 50.0, 20.0, 30.0, 50.0, 10.0, 80.0, 50.0, 70.0, 40.0, 90.0, 40.0, 50.0, 50.0, 10.0, 12.0, 20.0, 20.0, 12.0, 0.0, 80.0, 29.0, 37.0, 100.0, 50.0, 40.0, 80.0, 30.0, 30.0, 40.0, 30.0, 30.0, 70.0, 0.0, 20.0, 29.0, 30.0, 30.0, 80.0, 20.0, 50.0, 0.0, 10.0, 50.0, 20.0, 20.0, 70.0, 40.0, 60.0, 50.0, 30.0, 30.0, 30.0, 40.0, 70.0, 80.0, 80.0, 50.0, 30.0, 40.0, 70.0, 18.0, 20.0, 130.0, 0.0, 30.0, 20.0, 30.0, -7.0, 30.0, 10.0, 70.0, 4.0, 40.0, 30.0, -40.0, 0.0, 40.0, 40.0, 20.0, 50.0, 10.0, 0.0, 80.0, 10.0, 40.0, 30.0, 8.0, 20.0, 30.0, 10.0, -5.0, 50.0, 20.0, 40.0, -6.0, 30.0, 10.0, 26.0, -6.0, 10.0, 60.0, 9.0, 20.0, 60.0, 40.0, 30.0, 60.0, 60.0, 70.0, 40.0, 30.0, 15.0, 110.0, 0.0, 50.0, 50.0, 50.0, 0.0, 90.0, 70.0, 40.0, -5.0, 70.0, 30.0, 60.0, 50.0, 30.0, 50.0, 20.0, 10.0, 20.0, 60.0, 50.0, 50.0, 40.0, 20.0, -4.0, 0.0, 20.0, 40.0, 15.0, 40.0, 20.0, 10.0, 60.0, 50.0, 70.0, 30.0, 40.0, 28.0, 30.0, 30.0, 30.0, 24.0, 10.0, 10.0, 29.0, 120.0, 0.0, 10.0, 40.0, 120.0, 60.0, 20.0, -2.0, -8.0, 30.0, 20.0, 30.0, 30.0, 60.0, 90.0, 10.0, 40.0, 20.0, 26.0, 70.0, 38.0, 50.0, 40.0, 90.0, 40.0, 40.0, 50.0, -9.0, 44.0, 40.0, 50.0, 50.0, 45.0, 50.0, 40.0, 30.0, 30.0, 10.0, 60.0, 80.0, 30.0, 40.0, 12.0, -6.0, 32.0, 30.0, 40.0, 40.0, 20.0, 30.0, 24.0, 25.0, 0.0, 40.0, 43.0, 20.0, 10.0, 30.0, 70.0, 40.0, 70.0, 37.0, 27.0, 20.0, 10.0, 0.0, 20.0, 70.0, 60.0, 30.0, 90.0, -10.0, 30.0, 20.0, 49.0, 20.0, 0.0, 47.0, 10.0, 40.0, 140.0, 50.0, 20.0, 48.0, 26.0, 50.0, 7.0, 30.0, 10.0, 60.0, 20.0, 20.0, 20.0, 60.0, 30.0, 40.0, -1.0, 50.0, 30.0, 50.0, 40.0, 120.0, 30.0, 0.0, 22.0, -18.0, 90.0, 0.0, 48.0, 30.0, 0.0, 20.0, 40.0, 40.0, 0.0, 18.0, 120.0, 40.0, 38.0, 30.0, 27.0, 39.0, 30.0, 10.0, 0.0, 8.0, 40.0, 30.0, 30.0, 20.0, 19.0, 29.0, 50.0, 40.0, 20.0, 17.0, 19.0, 0.0, 100.0, 40.0, 25.0, 30.0, 36.0, 0.0, 30.0, 80.0, 49.0, 20.0, 30.0, 28.0, 30.0, 40.0, 5.0, 24.0, -19.0, 6.0, -6.0, 30.0, 20.0, 80.0, 40.0, -4.0, 20.0, 30.0, 26.0, 10.0, 60.0, 30.0, 20.0, 0.0, 68.0, 10.0, 34.0, 80.0, 30.0, 0.0, 60.0, 40.0, 120.0, 2.0, 50.0, 0.0, 120.0, 10.0, 3.0, -12.0, 110.0, 10.0, 20.0, 30.0, 70.0, 150.0, 20.0, 20.0, 140.0, 30.0, 30.0, 40.0, 50.0, 40.0, 20.0, 45.0, 36.0, 0.0, 75.0, 60.0, 40.0, 40.0, 50.0, 40.0, 60.0, 60.0, 50.0, 30.0, 40.0, 40.0, 40.0, 0.0, 80.0, 40.0, 70.0, 120.0, 20.0, 110.0, 20.0, 5.0, 100.0, 10.0, 40.0, 20.0, 40.0, 60.0, -15.0, 20.0, 20.0, 50.0, 40.0, 30.0, 20.0, 30.0, 108.0, 50.0, 100.0, 40.0, 50.0, 70.0, 60.0, 30.0, 40.0, 48.0, 60.0, 18.0, 40.0, 40.0, 30.0, 30.0, 35.0, 30.0, 30.0, 40.0, 40.0, 10.0, 110.0, 20.0, 20.0, 90.0, 60.0, 50.0, 120.0, 30.0, 20.0, 43.0, 20.0, 30.0, 30.0, 60.0, 15.0, 150.0, 60.0, 50.0, 80.0, 60.0, 60.0, 60.0, 30.0, 50.0, 60.0, 30.0, -9.0, 0.0, 70.0, 47.0, 90.0, 70.0, 80.0, 10.0, 40.0, 130.0, 30.0, 20.0, 40.0, 90.0, 40.0, 40.0, 150.0, 70.0, 80.0, 10.0, -7.0, 50.0, 30.0, 60.0, 50.0, 100.0, 23.0, 30.0, 30.0, 50.0, 80.0, 50.0, 40.0, 30.0, 70.0, 100.0, 60.0, 80.0, 20.0, 20.0, 70.0, 50.0, 40.0, 20.0, 30.0, 0.0, 40.0, 40.0, 80.0, 30.0, 49.0, 20.0, 15.0, 5.0, -15.0, 40.0, 27.0, 17.0, 50.0, 50.0, 40.0, 50.0, 70.0, 40.0, 40.0, 50.0, 90.0, 50.0, 50.0, 50.0, 52.0, 60.0, 80.0, 50.0, 19.0, 50.0, 50.0, 33.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5895273073077085, "mean_inference_ms": 2.6716487574680956, "mean_action_processing_ms": 0.7897501306227138, "mean_env_wait_ms": 1.8385545784349415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025403261184692383, "StateBufferConnector_ms": 0.01201486587524414, "ViewRequirementAgentConnector_ms": 0.683680534362793}, "num_episodes": 18, "episode_return_max": 690.0, "episode_return_min": 68.0, "episode_return_mean": 343.78}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.428559895562989, "num_env_steps_trained_throughput_per_sec": 15.428559895562989, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 256649.269, "restore_workers_time_ms": 0.013, "training_step_time_ms": 256649.223, "sample_time_ms": 4405.288, "learn_time_ms": 252224.166, "learn_throughput": 15.859, "synch_weights_time_ms": 12.794}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 14, "trial_id": "1841f_00000", "date": "2024-08-08_00-19-59", "timestamp": 1723090799, "time_this_iter_s": 259.2697288990021, "time_total_s": 3584.7272641658783, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b248dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3584.7272641658783, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 48.511748633879776, "ram_util_percent": 80.30081967213115}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4334579843238267, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.759056202519816, "policy_loss": -0.013204715185522482, "vf_loss": 6.770365288869515, "vf_explained_var": 0.0023886560885923993, "kl": 0.009478142445571765, "entropy": 1.2883146589683394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 136155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 690.0, "episode_reward_min": 68.0, "episode_reward_mean": 375.72, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 270.0}, "policy_reward_mean": {"policy_0": 37.572}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 340.0, 254.0, 360.0, 250.0, 167.0, 370.0, 171.0, 68.0, 390.0, 315.0, 290.0, 470.0, 336.0, 260.0, 275.0, 240.0, 400.0, 470.0, 295.0, 252.0, 490.0, 360.0, 370.0, 319.0, 440.0, 518.0, 257.0, 210.0, 243.0, 213.0, 455.0, 445.0, 400.0, 201.0, 392.0, 419.0, 300.0, 464.0, 370.0, 328.0, 252.0, 324.0, 359.0, 438.0, 289.0, 414.0, 316.0, 262.0, 274.0, 390.0, 158.0, 312.0, 332.0, 443.0, 520.0, 406.0, 450.0, 565.0, 285.0, 558.0, 371.0, 450.0, 418.0, 660.0, 428.0, 690.0, 376.0, 580.0, 390.0, 238.0, 530.0, 494.0, 230.0, 554.0, 223.0, 365.0, 500.0, 500.0, 640.0, 392.0, 401.0, 410.0, 479.0, 247.0, 265.0, 358.0, 534.0, 450.0, 420.0, 398.0, 447.0, 435.0, 189.0, 370.0, 318.0, 470.0, 538.0, 400.0, 600.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 10.0, 20.0, 20.0, 60.0, 40.0, 40.0, 30.0, 20.0, 20.0, 20.0, 70.0, 20.0, 0.0, 0.0, 30.0, 20.0, 20.0, 0.0, 160.0, 10.0, 70.0, -15.0, 40.0, 30.0, 10.0, 20.0, 10.0, 60.0, 19.0, 40.0, 20.0, 60.0, 30.0, 40.0, 10.0, 60.0, 20.0, 20.0, 60.0, 90.0, 60.0, 20.0, 14.0, 50.0, 3.0, 44.0, 4.0, -35.0, 0.0, 0.0, 0.0, 10.0, -10.0, 20.0, 13.0, 34.0, 20.0, 30.0, 50.0, 60.0, 30.0, 30.0, 50.0, 20.0, 70.0, 20.0, 50.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, -4.0, 30.0, 60.0, -11.0, -8.0, 4.0, 10.0, 31.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, -13.0, 50.0, 10.0, 50.0, 50.0, 10.0, 10.0, 110.0, 50.0, 0.0, 50.0, 10.0, 0.0, 60.0, 40.0, 40.0, 30.0, 45.0, 30.0, 40.0, 20.0, 10.0, 30.0, 30.0, 10.0, 40.0, 40.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, 40.0, 30.0, 110.0, 10.0, 50.0, 110.0, 10.0, 40.0, 30.0, 0.0, 50.0, 46.0, 48.0, 9.0, 20.0, 50.0, 100.0, -17.0, 10.0, 10.0, 20.0, 40.0, 40.0, 30.0, 30.0, 20.0, 30.0, 30.0, 25.0, 40.0, 20.0, 20.0, 20.0, 40.0, 20.0, 30.0, 50.0, 10.0, 20.0, 50.0, 0.0, 20.0, 50.0, 30.0, 40.0, 10.0, 10.0, 10.0, 20.0, 40.0, 60.0, 90.0, 18.0, 5.0, 20.0, 70.0, 80.0, -3.0, 100.0, 30.0, 20.0, 30.0, 20.0, 60.0, 50.0, 20.0, 50.0, 90.0, 30.0, 30.0, 10.0, 70.0, 15.0, 25.0, 25.0, 30.0, 30.0, 30.0, 50.0, -11.0, 13.0, 0.0, 20.0, 30.0, 50.0, 20.0, 30.0, 50.0, 10.0, 80.0, 50.0, 70.0, 40.0, 90.0, 40.0, 50.0, 50.0, 10.0, 12.0, 20.0, 20.0, 12.0, 0.0, 80.0, 29.0, 37.0, 100.0, 50.0, 40.0, 80.0, 30.0, 30.0, 40.0, 30.0, 30.0, 70.0, 0.0, 20.0, 29.0, 30.0, 30.0, 80.0, 20.0, 50.0, 0.0, 10.0, 50.0, 20.0, 20.0, 70.0, 40.0, 60.0, 50.0, 30.0, 30.0, 30.0, 40.0, 70.0, 80.0, 80.0, 50.0, 30.0, 40.0, 70.0, 18.0, 20.0, 130.0, 0.0, 30.0, 20.0, 30.0, -7.0, 30.0, 10.0, 70.0, 4.0, 40.0, 30.0, -40.0, 0.0, 40.0, 40.0, 20.0, 50.0, 10.0, 0.0, 80.0, 10.0, 40.0, 30.0, 8.0, 20.0, 30.0, 10.0, -5.0, 50.0, 20.0, 40.0, -6.0, 30.0, 10.0, 26.0, -6.0, 10.0, 60.0, 9.0, 20.0, 60.0, 40.0, 30.0, 60.0, 60.0, 70.0, 40.0, 30.0, 15.0, 110.0, 0.0, 50.0, 50.0, 50.0, 0.0, 90.0, 70.0, 40.0, -5.0, 70.0, 30.0, 60.0, 50.0, 30.0, 50.0, 20.0, 10.0, 20.0, 60.0, 50.0, 50.0, 40.0, 20.0, -4.0, 0.0, 20.0, 40.0, 15.0, 40.0, 20.0, 10.0, 60.0, 50.0, 70.0, 30.0, 40.0, 28.0, 30.0, 30.0, 30.0, 24.0, 10.0, 10.0, 29.0, 120.0, 0.0, 10.0, 40.0, 120.0, 60.0, 20.0, -2.0, -8.0, 30.0, 20.0, 30.0, 30.0, 60.0, 90.0, 10.0, 40.0, 20.0, 26.0, 70.0, 38.0, 50.0, 40.0, 90.0, 40.0, 40.0, 50.0, -9.0, 44.0, 40.0, 50.0, 50.0, 45.0, 50.0, 40.0, 30.0, 30.0, 10.0, 60.0, 80.0, 30.0, 40.0, 12.0, -6.0, 32.0, 30.0, 40.0, 40.0, 20.0, 30.0, 24.0, 25.0, 0.0, 40.0, 43.0, 20.0, 10.0, 30.0, 70.0, 40.0, 70.0, 37.0, 27.0, 20.0, 10.0, 0.0, 20.0, 70.0, 60.0, 30.0, 90.0, -10.0, 30.0, 20.0, 49.0, 20.0, 0.0, 47.0, 10.0, 40.0, 140.0, 50.0, 20.0, 48.0, 26.0, 50.0, 7.0, 30.0, 10.0, 60.0, 20.0, 20.0, 20.0, 60.0, 30.0, 40.0, -1.0, 50.0, 30.0, 50.0, 40.0, 120.0, 30.0, 0.0, 22.0, -18.0, 90.0, 0.0, 48.0, 30.0, 0.0, 20.0, 40.0, 40.0, 0.0, 18.0, 120.0, 40.0, 38.0, 30.0, 27.0, 39.0, 30.0, 10.0, 0.0, 8.0, 40.0, 30.0, 30.0, 20.0, 19.0, 29.0, 50.0, 40.0, 20.0, 17.0, 19.0, 0.0, 100.0, 40.0, 25.0, 30.0, 36.0, 0.0, 30.0, 80.0, 49.0, 20.0, 30.0, 28.0, 30.0, 40.0, 5.0, 24.0, -19.0, 6.0, -6.0, 30.0, 20.0, 80.0, 40.0, -4.0, 20.0, 30.0, 26.0, 10.0, 60.0, 30.0, 20.0, 0.0, 68.0, 10.0, 34.0, 80.0, 30.0, 0.0, 60.0, 40.0, 120.0, 2.0, 50.0, 0.0, 120.0, 10.0, 3.0, -12.0, 110.0, 10.0, 20.0, 30.0, 70.0, 150.0, 20.0, 20.0, 140.0, 30.0, 30.0, 40.0, 50.0, 40.0, 20.0, 45.0, 36.0, 0.0, 75.0, 60.0, 40.0, 40.0, 50.0, 40.0, 60.0, 60.0, 50.0, 30.0, 40.0, 40.0, 40.0, 0.0, 80.0, 40.0, 70.0, 120.0, 20.0, 110.0, 20.0, 5.0, 100.0, 10.0, 40.0, 20.0, 40.0, 60.0, -15.0, 20.0, 20.0, 50.0, 40.0, 30.0, 20.0, 30.0, 108.0, 50.0, 100.0, 40.0, 50.0, 70.0, 60.0, 30.0, 40.0, 48.0, 60.0, 18.0, 40.0, 40.0, 30.0, 30.0, 35.0, 30.0, 30.0, 40.0, 40.0, 10.0, 110.0, 20.0, 20.0, 90.0, 60.0, 50.0, 120.0, 30.0, 20.0, 43.0, 20.0, 30.0, 30.0, 60.0, 15.0, 150.0, 60.0, 50.0, 80.0, 60.0, 60.0, 60.0, 30.0, 50.0, 60.0, 30.0, -9.0, 0.0, 70.0, 47.0, 90.0, 70.0, 80.0, 10.0, 40.0, 130.0, 30.0, 20.0, 40.0, 90.0, 40.0, 40.0, 150.0, 70.0, 80.0, 10.0, -7.0, 50.0, 30.0, 60.0, 50.0, 100.0, 23.0, 30.0, 30.0, 50.0, 80.0, 50.0, 40.0, 30.0, 70.0, 100.0, 60.0, 80.0, 20.0, 20.0, 70.0, 50.0, 40.0, 20.0, 30.0, 0.0, 40.0, 40.0, 80.0, 30.0, 49.0, 20.0, 15.0, 5.0, -15.0, 40.0, 27.0, 17.0, 50.0, 50.0, 40.0, 50.0, 70.0, 40.0, 40.0, 50.0, 90.0, 50.0, 50.0, 50.0, 52.0, 60.0, 80.0, 50.0, 19.0, 50.0, 50.0, 33.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 0.0, 0.0, 60.0, 40.0, 70.0, 60.0, 11.0, 20.0, 80.0, 43.0, 70.0, 50.0, 90.0, 60.0, 20.0, 0.0, -10.0, 19.0, 60.0, 70.0, 50.0, 9.0, -25.0, 30.0, 30.0, 35.0, 40.0, 50.0, 70.0, 10.0, 7.0, 80.0, 33.0, 10.0, 30.0, 20.0, 60.0, 80.0, 80.0, 30.0, 20.0, 30.0, 120.0, 30.0, 50.0, 80.0, 30.0, 50.0, 0.0, 70.0, 60.0, 30.0, 50.0, 80.0, 90.0, 40.0, 50.0, 10.0, 190.0, -20.0, 90.0, 50.0, 100.0, 40.0, 10.0, 40.0, 20.0, 90.0, 33.0, 19.0, 30.0, 40.0, 70.0, 40.0, 30.0, 50.0, 40.0, 10.0, 10.0, 42.0, 19.0, 80.0, 70.0, 50.0, 30.0, 90.0, 30.0, 30.0, 20.0, 60.0, 40.0, 40.0, 30.0, 40.0, 60.0, 40.0, 80.0, 24.0, 30.0, 60.0, 20.0, 65.0, 40.0, 60.0, 15.0, 17.0, 20.0, 20.0, -21.0, 20.0, 20.0, 43.0, 53.0, 60.0, 0.0, 15.0, -121.0, 130.0, 30.0, 60.0, 98.0, 1.0, 70.0, -18.0, 20.0, 70.0, 40.0, 57.0, 60.0, 40.0, -4.0, 50.0, 5.0, 20.0, 20.0, 70.0, 150.0, 50.0, 3.0, 20.0, 130.0, 31.0, 30.0, 30.0, 40.0, 30.0, 60.0, 140.0, 30.0, 30.0, 60.0, 20.0, 20.0, 20.0, 20.0, 40.0, 0.0, 50.0, 50.0, 40.0, 40.0, 40.0, 100.0, 40.0, 30.0, 5.0, 50.0, 80.0, 59.0, 30.0, 60.0, 70.0, -35.0, 49.0, 60.0, 50.0, 78.0, -3.0, 30.0, 25.0, 60.0, 40.0, 70.0, 37.0, 50.0, 30.0, 29.0, 47.0, 70.0, 39.0, 70.0, 30.0, 20.0, 50.0, 21.0, -135.0, 68.0, 32.0, 10.0, 50.0, 45.0, 28.0, 20.0, 50.0, 30.0, 60.0, 100.0, 40.0, 20.0, 30.0, 40.0, 20.0, 0.0, 30.0, 20.0, 14.0, 20.0, 20.0, 4.0, 60.0, 30.0, 40.0, 60.0, 50.0, 50.0, 40.0, 30.0, 30.0, 70.0, 20.0, 60.0, 0.0, 110.0, 60.0, 50.0, 50.0, 30.0, 90.0, 30.0, 40.0, 49.0, 79.0, 30.0, 90.0, 40.0, 30.0, 40.0, 40.0, 10.0, 40.0, 40.0, 60.0, 40.0, 60.0, 70.0, 50.0, 270.0, 10.0, -10.0, 20.0, 70.0, 40.0, 40.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5910277583356436, "mean_inference_ms": 2.6924490567768133, "mean_action_processing_ms": 0.7862210938854405, "mean_env_wait_ms": 1.830962033677747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02351665496826172, "StateBufferConnector_ms": 0.012129783630371094, "ViewRequirementAgentConnector_ms": 0.7428505420684814}, "num_episodes": 27, "episode_return_max": 690.0, "episode_return_min": 68.0, "episode_return_mean": 375.72}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.664415631573535, "num_env_steps_trained_throughput_per_sec": 15.664415631573535, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 256465.533, "restore_workers_time_ms": 0.013, "training_step_time_ms": 256465.486, "sample_time_ms": 4430.784, "learn_time_ms": 252015.18, "learn_throughput": 15.872, "synch_weights_time_ms": 12.543}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 15, "trial_id": "1841f_00000", "date": "2024-08-08_00-24-14", "timestamp": 1723091054, "time_this_iter_s": 255.36710691452026, "time_total_s": 3840.0943710803986, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2455ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3840.0943710803986, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 47.8606648199446, "ram_util_percent": 79.60470914127424}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.52117387011917, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.893190193176269, "policy_loss": -0.01240365163428576, "vf_loss": 6.9038739671595435, "vf_explained_var": 0.006300173983914149, "kl": 0.0085993522069899, "entropy": 1.264686825747688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 145545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 690.0, "episode_reward_min": 120.0, "episode_reward_mean": 410.27, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 270.0}, "policy_reward_mean": {"policy_0": 41.027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [470.0, 295.0, 252.0, 490.0, 360.0, 370.0, 319.0, 440.0, 518.0, 257.0, 210.0, 243.0, 213.0, 455.0, 445.0, 400.0, 201.0, 392.0, 419.0, 300.0, 464.0, 370.0, 328.0, 252.0, 324.0, 359.0, 438.0, 289.0, 414.0, 316.0, 262.0, 274.0, 390.0, 158.0, 312.0, 332.0, 443.0, 520.0, 406.0, 450.0, 565.0, 285.0, 558.0, 371.0, 450.0, 418.0, 660.0, 428.0, 690.0, 376.0, 580.0, 390.0, 238.0, 530.0, 494.0, 230.0, 554.0, 223.0, 365.0, 500.0, 500.0, 640.0, 392.0, 401.0, 410.0, 479.0, 247.0, 265.0, 358.0, 534.0, 450.0, 420.0, 398.0, 447.0, 435.0, 189.0, 370.0, 318.0, 470.0, 538.0, 400.0, 600.0, 510.0, 609.0, 645.0, 558.0, 290.0, 476.0, 395.0, 630.0, 409.0, 675.0, 430.0, 120.0, 487.0, 624.0, 512.0, 638.0, 422.0, 281.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 30.0, 20.0, 30.0, 20.0, 60.0, 50.0, 20.0, 50.0, 90.0, 30.0, 30.0, 10.0, 70.0, 15.0, 25.0, 25.0, 30.0, 30.0, 30.0, 50.0, -11.0, 13.0, 0.0, 20.0, 30.0, 50.0, 20.0, 30.0, 50.0, 10.0, 80.0, 50.0, 70.0, 40.0, 90.0, 40.0, 50.0, 50.0, 10.0, 12.0, 20.0, 20.0, 12.0, 0.0, 80.0, 29.0, 37.0, 100.0, 50.0, 40.0, 80.0, 30.0, 30.0, 40.0, 30.0, 30.0, 70.0, 0.0, 20.0, 29.0, 30.0, 30.0, 80.0, 20.0, 50.0, 0.0, 10.0, 50.0, 20.0, 20.0, 70.0, 40.0, 60.0, 50.0, 30.0, 30.0, 30.0, 40.0, 70.0, 80.0, 80.0, 50.0, 30.0, 40.0, 70.0, 18.0, 20.0, 130.0, 0.0, 30.0, 20.0, 30.0, -7.0, 30.0, 10.0, 70.0, 4.0, 40.0, 30.0, -40.0, 0.0, 40.0, 40.0, 20.0, 50.0, 10.0, 0.0, 80.0, 10.0, 40.0, 30.0, 8.0, 20.0, 30.0, 10.0, -5.0, 50.0, 20.0, 40.0, -6.0, 30.0, 10.0, 26.0, -6.0, 10.0, 60.0, 9.0, 20.0, 60.0, 40.0, 30.0, 60.0, 60.0, 70.0, 40.0, 30.0, 15.0, 110.0, 0.0, 50.0, 50.0, 50.0, 0.0, 90.0, 70.0, 40.0, -5.0, 70.0, 30.0, 60.0, 50.0, 30.0, 50.0, 20.0, 10.0, 20.0, 60.0, 50.0, 50.0, 40.0, 20.0, -4.0, 0.0, 20.0, 40.0, 15.0, 40.0, 20.0, 10.0, 60.0, 50.0, 70.0, 30.0, 40.0, 28.0, 30.0, 30.0, 30.0, 24.0, 10.0, 10.0, 29.0, 120.0, 0.0, 10.0, 40.0, 120.0, 60.0, 20.0, -2.0, -8.0, 30.0, 20.0, 30.0, 30.0, 60.0, 90.0, 10.0, 40.0, 20.0, 26.0, 70.0, 38.0, 50.0, 40.0, 90.0, 40.0, 40.0, 50.0, -9.0, 44.0, 40.0, 50.0, 50.0, 45.0, 50.0, 40.0, 30.0, 30.0, 10.0, 60.0, 80.0, 30.0, 40.0, 12.0, -6.0, 32.0, 30.0, 40.0, 40.0, 20.0, 30.0, 24.0, 25.0, 0.0, 40.0, 43.0, 20.0, 10.0, 30.0, 70.0, 40.0, 70.0, 37.0, 27.0, 20.0, 10.0, 0.0, 20.0, 70.0, 60.0, 30.0, 90.0, -10.0, 30.0, 20.0, 49.0, 20.0, 0.0, 47.0, 10.0, 40.0, 140.0, 50.0, 20.0, 48.0, 26.0, 50.0, 7.0, 30.0, 10.0, 60.0, 20.0, 20.0, 20.0, 60.0, 30.0, 40.0, -1.0, 50.0, 30.0, 50.0, 40.0, 120.0, 30.0, 0.0, 22.0, -18.0, 90.0, 0.0, 48.0, 30.0, 0.0, 20.0, 40.0, 40.0, 0.0, 18.0, 120.0, 40.0, 38.0, 30.0, 27.0, 39.0, 30.0, 10.0, 0.0, 8.0, 40.0, 30.0, 30.0, 20.0, 19.0, 29.0, 50.0, 40.0, 20.0, 17.0, 19.0, 0.0, 100.0, 40.0, 25.0, 30.0, 36.0, 0.0, 30.0, 80.0, 49.0, 20.0, 30.0, 28.0, 30.0, 40.0, 5.0, 24.0, -19.0, 6.0, -6.0, 30.0, 20.0, 80.0, 40.0, -4.0, 20.0, 30.0, 26.0, 10.0, 60.0, 30.0, 20.0, 0.0, 68.0, 10.0, 34.0, 80.0, 30.0, 0.0, 60.0, 40.0, 120.0, 2.0, 50.0, 0.0, 120.0, 10.0, 3.0, -12.0, 110.0, 10.0, 20.0, 30.0, 70.0, 150.0, 20.0, 20.0, 140.0, 30.0, 30.0, 40.0, 50.0, 40.0, 20.0, 45.0, 36.0, 0.0, 75.0, 60.0, 40.0, 40.0, 50.0, 40.0, 60.0, 60.0, 50.0, 30.0, 40.0, 40.0, 40.0, 0.0, 80.0, 40.0, 70.0, 120.0, 20.0, 110.0, 20.0, 5.0, 100.0, 10.0, 40.0, 20.0, 40.0, 60.0, -15.0, 20.0, 20.0, 50.0, 40.0, 30.0, 20.0, 30.0, 108.0, 50.0, 100.0, 40.0, 50.0, 70.0, 60.0, 30.0, 40.0, 48.0, 60.0, 18.0, 40.0, 40.0, 30.0, 30.0, 35.0, 30.0, 30.0, 40.0, 40.0, 10.0, 110.0, 20.0, 20.0, 90.0, 60.0, 50.0, 120.0, 30.0, 20.0, 43.0, 20.0, 30.0, 30.0, 60.0, 15.0, 150.0, 60.0, 50.0, 80.0, 60.0, 60.0, 60.0, 30.0, 50.0, 60.0, 30.0, -9.0, 0.0, 70.0, 47.0, 90.0, 70.0, 80.0, 10.0, 40.0, 130.0, 30.0, 20.0, 40.0, 90.0, 40.0, 40.0, 150.0, 70.0, 80.0, 10.0, -7.0, 50.0, 30.0, 60.0, 50.0, 100.0, 23.0, 30.0, 30.0, 50.0, 80.0, 50.0, 40.0, 30.0, 70.0, 100.0, 60.0, 80.0, 20.0, 20.0, 70.0, 50.0, 40.0, 20.0, 30.0, 0.0, 40.0, 40.0, 80.0, 30.0, 49.0, 20.0, 15.0, 5.0, -15.0, 40.0, 27.0, 17.0, 50.0, 50.0, 40.0, 50.0, 70.0, 40.0, 40.0, 50.0, 90.0, 50.0, 50.0, 50.0, 52.0, 60.0, 80.0, 50.0, 19.0, 50.0, 50.0, 33.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 0.0, 0.0, 60.0, 40.0, 70.0, 60.0, 11.0, 20.0, 80.0, 43.0, 70.0, 50.0, 90.0, 60.0, 20.0, 0.0, -10.0, 19.0, 60.0, 70.0, 50.0, 9.0, -25.0, 30.0, 30.0, 35.0, 40.0, 50.0, 70.0, 10.0, 7.0, 80.0, 33.0, 10.0, 30.0, 20.0, 60.0, 80.0, 80.0, 30.0, 20.0, 30.0, 120.0, 30.0, 50.0, 80.0, 30.0, 50.0, 0.0, 70.0, 60.0, 30.0, 50.0, 80.0, 90.0, 40.0, 50.0, 10.0, 190.0, -20.0, 90.0, 50.0, 100.0, 40.0, 10.0, 40.0, 20.0, 90.0, 33.0, 19.0, 30.0, 40.0, 70.0, 40.0, 30.0, 50.0, 40.0, 10.0, 10.0, 42.0, 19.0, 80.0, 70.0, 50.0, 30.0, 90.0, 30.0, 30.0, 20.0, 60.0, 40.0, 40.0, 30.0, 40.0, 60.0, 40.0, 80.0, 24.0, 30.0, 60.0, 20.0, 65.0, 40.0, 60.0, 15.0, 17.0, 20.0, 20.0, -21.0, 20.0, 20.0, 43.0, 53.0, 60.0, 0.0, 15.0, -121.0, 130.0, 30.0, 60.0, 98.0, 1.0, 70.0, -18.0, 20.0, 70.0, 40.0, 57.0, 60.0, 40.0, -4.0, 50.0, 5.0, 20.0, 20.0, 70.0, 150.0, 50.0, 3.0, 20.0, 130.0, 31.0, 30.0, 30.0, 40.0, 30.0, 60.0, 140.0, 30.0, 30.0, 60.0, 20.0, 20.0, 20.0, 20.0, 40.0, 0.0, 50.0, 50.0, 40.0, 40.0, 40.0, 100.0, 40.0, 30.0, 5.0, 50.0, 80.0, 59.0, 30.0, 60.0, 70.0, -35.0, 49.0, 60.0, 50.0, 78.0, -3.0, 30.0, 25.0, 60.0, 40.0, 70.0, 37.0, 50.0, 30.0, 29.0, 47.0, 70.0, 39.0, 70.0, 30.0, 20.0, 50.0, 21.0, -135.0, 68.0, 32.0, 10.0, 50.0, 45.0, 28.0, 20.0, 50.0, 30.0, 60.0, 100.0, 40.0, 20.0, 30.0, 40.0, 20.0, 0.0, 30.0, 20.0, 14.0, 20.0, 20.0, 4.0, 60.0, 30.0, 40.0, 60.0, 50.0, 50.0, 40.0, 30.0, 30.0, 70.0, 20.0, 60.0, 0.0, 110.0, 60.0, 50.0, 50.0, 30.0, 90.0, 30.0, 40.0, 49.0, 79.0, 30.0, 90.0, 40.0, 30.0, 40.0, 40.0, 10.0, 40.0, 40.0, 60.0, 40.0, 60.0, 70.0, 50.0, 270.0, 10.0, -10.0, 20.0, 70.0, 40.0, 40.0, 40.0, 30.0, 20.0, 40.0, 50.0, 60.0, 10.0, 100.0, 30.0, 80.0, 90.0, 100.0, 120.0, 61.0, 89.0, 70.0, 10.0, 20.0, 20.0, 29.0, 90.0, 230.0, 10.0, 60.0, 30.0, 30.0, 140.0, 20.0, 5.0, 60.0, 60.0, 60.0, 70.0, 30.0, 10.0, 50.0, 44.0, 90.0, 74.0, 40.0, 90.0, 60.0, 50.0, 10.0, 10.0, 20.0, 20.0, 30.0, 40.0, 0.0, 50.0, 30.0, 28.0, 30.0, 50.0, 60.0, 70.0, 50.0, 48.0, 70.0, 40.0, 40.0, 80.0, 20.0, 29.0, 16.0, 50.0, 40.0, 50.0, 50.0, 20.0, 40.0, 110.0, 40.0, 70.0, 30.0, 50.0, 140.0, 50.0, 60.0, 40.0, 40.0, 30.0, 10.0, 10.0, 20.0, 60.0, 40.0, 79.0, 50.0, 70.0, 80.0, 60.0, 70.0, 90.0, 40.0, 50.0, 28.0, 130.0, 47.0, 80.0, 10.0, 80.0, 60.0, 70.0, 20.0, 90.0, 30.0, 60.0, 0.0, 10.0, 44.0, 5.0, 50.0, 0.0, 8.0, 10.0, -7.0, -1.0, -18.0, 29.0, 30.0, 100.0, 50.0, 89.0, 10.0, 29.0, 19.0, 70.0, 50.0, 40.0, 100.0, 70.0, 50.0, 94.0, 60.0, 76.0, 32.0, 50.0, 40.0, 52.0, 90.0, 40.0, 40.0, 50.0, 50.0, 19.0, 70.0, 10.0, -17.0, 160.0, 90.0, 60.0, 60.0, 34.0, 15.0, 39.0, 100.0, 60.0, 50.0, 130.0, 27.0, 90.0, 30.0, 10.0, 60.0, 20.0, 40.0, 50.0, 30.0, 65.0, -10.0, 10.0, 20.0, 9.0, 50.0, 8.0, 49.0, 60.0, 55.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5873794558535574, "mean_inference_ms": 2.701613403547865, "mean_action_processing_ms": 0.784260363782069, "mean_env_wait_ms": 1.8289585003590307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025413036346435547, "StateBufferConnector_ms": 0.01212763786315918, "ViewRequirementAgentConnector_ms": 0.7298800945281982}, "num_episodes": 18, "episode_return_max": 690.0, "episode_return_min": 120.0, "episode_return_mean": 410.27}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.679739801278338, "num_env_steps_trained_throughput_per_sec": 15.679739801278338, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 256426.898, "restore_workers_time_ms": 0.013, "training_step_time_ms": 256426.851, "sample_time_ms": 4380.789, "learn_time_ms": 252026.665, "learn_throughput": 15.871, "synch_weights_time_ms": 12.388}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 16, "trial_id": "1841f_00000", "date": "2024-08-08_00-28-29", "timestamp": 1723091309, "time_this_iter_s": 255.11526226997375, "time_total_s": 4095.2096333503723, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24810d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4095.2096333503723, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 47.767500000000005, "ram_util_percent": 79.3163888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3659743538489355, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.119426656302553, "policy_loss": -0.01240860099083009, "vf_loss": 7.130154696160866, "vf_explained_var": 0.000177230666112849, "kl": 0.008402797320359827, "entropy": 1.2291871549222415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 154935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 920.0, "episode_reward_min": 120.0, "episode_reward_mean": 434.06, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 317.0}, "policy_reward_mean": {"policy_0": 43.406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [419.0, 300.0, 464.0, 370.0, 328.0, 252.0, 324.0, 359.0, 438.0, 289.0, 414.0, 316.0, 262.0, 274.0, 390.0, 158.0, 312.0, 332.0, 443.0, 520.0, 406.0, 450.0, 565.0, 285.0, 558.0, 371.0, 450.0, 418.0, 660.0, 428.0, 690.0, 376.0, 580.0, 390.0, 238.0, 530.0, 494.0, 230.0, 554.0, 223.0, 365.0, 500.0, 500.0, 640.0, 392.0, 401.0, 410.0, 479.0, 247.0, 265.0, 358.0, 534.0, 450.0, 420.0, 398.0, 447.0, 435.0, 189.0, 370.0, 318.0, 470.0, 538.0, 400.0, 600.0, 510.0, 609.0, 645.0, 558.0, 290.0, 476.0, 395.0, 630.0, 409.0, 675.0, 430.0, 120.0, 487.0, 624.0, 512.0, 638.0, 422.0, 281.0, 423.0, 610.0, 460.0, 247.0, 395.0, 500.0, 357.0, 380.0, 720.0, 420.0, 479.0, 560.0, 293.0, 920.0, 510.0, 539.0, 579.0, 317.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 29.0, 120.0, 0.0, 10.0, 40.0, 120.0, 60.0, 20.0, -2.0, -8.0, 30.0, 20.0, 30.0, 30.0, 60.0, 90.0, 10.0, 40.0, 20.0, 26.0, 70.0, 38.0, 50.0, 40.0, 90.0, 40.0, 40.0, 50.0, -9.0, 44.0, 40.0, 50.0, 50.0, 45.0, 50.0, 40.0, 30.0, 30.0, 10.0, 60.0, 80.0, 30.0, 40.0, 12.0, -6.0, 32.0, 30.0, 40.0, 40.0, 20.0, 30.0, 24.0, 25.0, 0.0, 40.0, 43.0, 20.0, 10.0, 30.0, 70.0, 40.0, 70.0, 37.0, 27.0, 20.0, 10.0, 0.0, 20.0, 70.0, 60.0, 30.0, 90.0, -10.0, 30.0, 20.0, 49.0, 20.0, 0.0, 47.0, 10.0, 40.0, 140.0, 50.0, 20.0, 48.0, 26.0, 50.0, 7.0, 30.0, 10.0, 60.0, 20.0, 20.0, 20.0, 60.0, 30.0, 40.0, -1.0, 50.0, 30.0, 50.0, 40.0, 120.0, 30.0, 0.0, 22.0, -18.0, 90.0, 0.0, 48.0, 30.0, 0.0, 20.0, 40.0, 40.0, 0.0, 18.0, 120.0, 40.0, 38.0, 30.0, 27.0, 39.0, 30.0, 10.0, 0.0, 8.0, 40.0, 30.0, 30.0, 20.0, 19.0, 29.0, 50.0, 40.0, 20.0, 17.0, 19.0, 0.0, 100.0, 40.0, 25.0, 30.0, 36.0, 0.0, 30.0, 80.0, 49.0, 20.0, 30.0, 28.0, 30.0, 40.0, 5.0, 24.0, -19.0, 6.0, -6.0, 30.0, 20.0, 80.0, 40.0, -4.0, 20.0, 30.0, 26.0, 10.0, 60.0, 30.0, 20.0, 0.0, 68.0, 10.0, 34.0, 80.0, 30.0, 0.0, 60.0, 40.0, 120.0, 2.0, 50.0, 0.0, 120.0, 10.0, 3.0, -12.0, 110.0, 10.0, 20.0, 30.0, 70.0, 150.0, 20.0, 20.0, 140.0, 30.0, 30.0, 40.0, 50.0, 40.0, 20.0, 45.0, 36.0, 0.0, 75.0, 60.0, 40.0, 40.0, 50.0, 40.0, 60.0, 60.0, 50.0, 30.0, 40.0, 40.0, 40.0, 0.0, 80.0, 40.0, 70.0, 120.0, 20.0, 110.0, 20.0, 5.0, 100.0, 10.0, 40.0, 20.0, 40.0, 60.0, -15.0, 20.0, 20.0, 50.0, 40.0, 30.0, 20.0, 30.0, 108.0, 50.0, 100.0, 40.0, 50.0, 70.0, 60.0, 30.0, 40.0, 48.0, 60.0, 18.0, 40.0, 40.0, 30.0, 30.0, 35.0, 30.0, 30.0, 40.0, 40.0, 10.0, 110.0, 20.0, 20.0, 90.0, 60.0, 50.0, 120.0, 30.0, 20.0, 43.0, 20.0, 30.0, 30.0, 60.0, 15.0, 150.0, 60.0, 50.0, 80.0, 60.0, 60.0, 60.0, 30.0, 50.0, 60.0, 30.0, -9.0, 0.0, 70.0, 47.0, 90.0, 70.0, 80.0, 10.0, 40.0, 130.0, 30.0, 20.0, 40.0, 90.0, 40.0, 40.0, 150.0, 70.0, 80.0, 10.0, -7.0, 50.0, 30.0, 60.0, 50.0, 100.0, 23.0, 30.0, 30.0, 50.0, 80.0, 50.0, 40.0, 30.0, 70.0, 100.0, 60.0, 80.0, 20.0, 20.0, 70.0, 50.0, 40.0, 20.0, 30.0, 0.0, 40.0, 40.0, 80.0, 30.0, 49.0, 20.0, 15.0, 5.0, -15.0, 40.0, 27.0, 17.0, 50.0, 50.0, 40.0, 50.0, 70.0, 40.0, 40.0, 50.0, 90.0, 50.0, 50.0, 50.0, 52.0, 60.0, 80.0, 50.0, 19.0, 50.0, 50.0, 33.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 0.0, 0.0, 60.0, 40.0, 70.0, 60.0, 11.0, 20.0, 80.0, 43.0, 70.0, 50.0, 90.0, 60.0, 20.0, 0.0, -10.0, 19.0, 60.0, 70.0, 50.0, 9.0, -25.0, 30.0, 30.0, 35.0, 40.0, 50.0, 70.0, 10.0, 7.0, 80.0, 33.0, 10.0, 30.0, 20.0, 60.0, 80.0, 80.0, 30.0, 20.0, 30.0, 120.0, 30.0, 50.0, 80.0, 30.0, 50.0, 0.0, 70.0, 60.0, 30.0, 50.0, 80.0, 90.0, 40.0, 50.0, 10.0, 190.0, -20.0, 90.0, 50.0, 100.0, 40.0, 10.0, 40.0, 20.0, 90.0, 33.0, 19.0, 30.0, 40.0, 70.0, 40.0, 30.0, 50.0, 40.0, 10.0, 10.0, 42.0, 19.0, 80.0, 70.0, 50.0, 30.0, 90.0, 30.0, 30.0, 20.0, 60.0, 40.0, 40.0, 30.0, 40.0, 60.0, 40.0, 80.0, 24.0, 30.0, 60.0, 20.0, 65.0, 40.0, 60.0, 15.0, 17.0, 20.0, 20.0, -21.0, 20.0, 20.0, 43.0, 53.0, 60.0, 0.0, 15.0, -121.0, 130.0, 30.0, 60.0, 98.0, 1.0, 70.0, -18.0, 20.0, 70.0, 40.0, 57.0, 60.0, 40.0, -4.0, 50.0, 5.0, 20.0, 20.0, 70.0, 150.0, 50.0, 3.0, 20.0, 130.0, 31.0, 30.0, 30.0, 40.0, 30.0, 60.0, 140.0, 30.0, 30.0, 60.0, 20.0, 20.0, 20.0, 20.0, 40.0, 0.0, 50.0, 50.0, 40.0, 40.0, 40.0, 100.0, 40.0, 30.0, 5.0, 50.0, 80.0, 59.0, 30.0, 60.0, 70.0, -35.0, 49.0, 60.0, 50.0, 78.0, -3.0, 30.0, 25.0, 60.0, 40.0, 70.0, 37.0, 50.0, 30.0, 29.0, 47.0, 70.0, 39.0, 70.0, 30.0, 20.0, 50.0, 21.0, -135.0, 68.0, 32.0, 10.0, 50.0, 45.0, 28.0, 20.0, 50.0, 30.0, 60.0, 100.0, 40.0, 20.0, 30.0, 40.0, 20.0, 0.0, 30.0, 20.0, 14.0, 20.0, 20.0, 4.0, 60.0, 30.0, 40.0, 60.0, 50.0, 50.0, 40.0, 30.0, 30.0, 70.0, 20.0, 60.0, 0.0, 110.0, 60.0, 50.0, 50.0, 30.0, 90.0, 30.0, 40.0, 49.0, 79.0, 30.0, 90.0, 40.0, 30.0, 40.0, 40.0, 10.0, 40.0, 40.0, 60.0, 40.0, 60.0, 70.0, 50.0, 270.0, 10.0, -10.0, 20.0, 70.0, 40.0, 40.0, 40.0, 30.0, 20.0, 40.0, 50.0, 60.0, 10.0, 100.0, 30.0, 80.0, 90.0, 100.0, 120.0, 61.0, 89.0, 70.0, 10.0, 20.0, 20.0, 29.0, 90.0, 230.0, 10.0, 60.0, 30.0, 30.0, 140.0, 20.0, 5.0, 60.0, 60.0, 60.0, 70.0, 30.0, 10.0, 50.0, 44.0, 90.0, 74.0, 40.0, 90.0, 60.0, 50.0, 10.0, 10.0, 20.0, 20.0, 30.0, 40.0, 0.0, 50.0, 30.0, 28.0, 30.0, 50.0, 60.0, 70.0, 50.0, 48.0, 70.0, 40.0, 40.0, 80.0, 20.0, 29.0, 16.0, 50.0, 40.0, 50.0, 50.0, 20.0, 40.0, 110.0, 40.0, 70.0, 30.0, 50.0, 140.0, 50.0, 60.0, 40.0, 40.0, 30.0, 10.0, 10.0, 20.0, 60.0, 40.0, 79.0, 50.0, 70.0, 80.0, 60.0, 70.0, 90.0, 40.0, 50.0, 28.0, 130.0, 47.0, 80.0, 10.0, 80.0, 60.0, 70.0, 20.0, 90.0, 30.0, 60.0, 0.0, 10.0, 44.0, 5.0, 50.0, 0.0, 8.0, 10.0, -7.0, -1.0, -18.0, 29.0, 30.0, 100.0, 50.0, 89.0, 10.0, 29.0, 19.0, 70.0, 50.0, 40.0, 100.0, 70.0, 50.0, 94.0, 60.0, 76.0, 32.0, 50.0, 40.0, 52.0, 90.0, 40.0, 40.0, 50.0, 50.0, 19.0, 70.0, 10.0, -17.0, 160.0, 90.0, 60.0, 60.0, 34.0, 15.0, 39.0, 100.0, 60.0, 50.0, 130.0, 27.0, 90.0, 30.0, 10.0, 60.0, 20.0, 40.0, 50.0, 30.0, 65.0, -10.0, 10.0, 20.0, 9.0, 50.0, 8.0, 49.0, 60.0, 55.0, 30.0, 20.0, 20.0, 50.0, 60.0, 21.0, 50.0, 30.0, 70.0, 32.0, 70.0, 110.0, 20.0, 60.0, 60.0, 40.0, 40.0, 80.0, 40.0, 70.0, 90.0, 110.0, 30.0, 40.0, 50.0, 60.0, 50.0, 10.0, 30.0, 60.0, 20.0, 50.0, -5.0, 15.0, 30.0, 7.0, 52.0, 27.0, 30.0, 38.0, 3.0, 40.0, 30.0, 20.0, 12.0, 13.0, 40.0, 70.0, 70.0, 30.0, 70.0, 30.0, 80.0, 80.0, 60.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 20.0, 60.0, 60.0, 32.0, 40.0, 20.0, 10.0, 60.0, 25.0, 30.0, 60.0, 90.0, 10.0, 20.0, 20.0, 20.0, 50.0, 10.0, 40.0, 60.0, 20.0, 80.0, 90.0, 40.0, 70.0, 120.0, 80.0, 90.0, 130.0, 0.0, 0.0, 40.0, 30.0, 70.0, 70.0, 70.0, 50.0, 50.0, 30.0, 10.0, 79.0, 60.0, 50.0, 70.0, 40.0, 0.0, 20.0, 80.0, 60.0, 20.0, 50.0, 60.0, 70.0, 60.0, 70.0, 0.0, 90.0, 70.0, 30.0, 60.0, 30.0, 40.0, -10.0, 23.0, 30.0, 11.0, 60.0, 29.0, 30.0, 50.0, 10.0, 43.0, 100.0, 130.0, 16.0, 34.0, 317.0, 98.0, 84.0, 88.0, 50.0, 20.0, 50.0, 100.0, 30.0, 40.0, 30.0, 40.0, 100.0, 50.0, 79.0, 90.0, 50.0, 60.0, 100.0, 40.0, 20.0, 50.0, 40.0, 10.0, 80.0, 50.0, 54.0, 56.0, 64.0, 80.0, 39.0, 50.0, 19.0, 87.0, 8.0, 60.0, 30.0, -27.0, 6.0, 20.0, 50.0, 20.0, 60.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5833248831747437, "mean_inference_ms": 2.711917279474591, "mean_action_processing_ms": 0.7828408263114087, "mean_env_wait_ms": 1.8286002897182831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02647542953491211, "StateBufferConnector_ms": 0.013680219650268555, "ViewRequirementAgentConnector_ms": 0.7827563285827637}, "num_episodes": 18, "episode_return_max": 920.0, "episode_return_min": 120.0, "episode_return_mean": 434.06}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.533322335125975, "num_env_steps_trained_throughput_per_sec": 15.533322335125975, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 256483.668, "restore_workers_time_ms": 0.015, "training_step_time_ms": 256483.617, "sample_time_ms": 4357.967, "learn_time_ms": 252104.928, "learn_throughput": 15.866, "synch_weights_time_ms": 13.867}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 17, "trial_id": "1841f_00000", "date": "2024-08-08_00-32-47", "timestamp": 1723091567, "time_this_iter_s": 257.52426290512085, "time_total_s": 4352.733896255493, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b248d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4352.733896255493, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 48.716208791208786, "ram_util_percent": 80.04148351648352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6730370100123433, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.807903321634847, "policy_loss": -0.01328116116595987, "vf_loss": 6.819392640344378, "vf_explained_var": 0.002045071067901465, "kl": 0.008959202119303459, "entropy": 1.2052129575619683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 164325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 920.0, "episode_reward_min": 72.0, "episode_reward_mean": 456.44, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 317.0}, "policy_reward_mean": {"policy_0": 45.644}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.0, 520.0, 406.0, 450.0, 565.0, 285.0, 558.0, 371.0, 450.0, 418.0, 660.0, 428.0, 690.0, 376.0, 580.0, 390.0, 238.0, 530.0, 494.0, 230.0, 554.0, 223.0, 365.0, 500.0, 500.0, 640.0, 392.0, 401.0, 410.0, 479.0, 247.0, 265.0, 358.0, 534.0, 450.0, 420.0, 398.0, 447.0, 435.0, 189.0, 370.0, 318.0, 470.0, 538.0, 400.0, 600.0, 510.0, 609.0, 645.0, 558.0, 290.0, 476.0, 395.0, 630.0, 409.0, 675.0, 430.0, 120.0, 487.0, 624.0, 512.0, 638.0, 422.0, 281.0, 423.0, 610.0, 460.0, 247.0, 395.0, 500.0, 357.0, 380.0, 720.0, 420.0, 479.0, 560.0, 293.0, 920.0, 510.0, 539.0, 579.0, 317.0, 586.0, 242.0, 563.0, 282.0, 355.0, 561.0, 550.0, 455.0, 620.0, 390.0, 540.0, 430.0, 492.0, 370.0, 565.0, 479.0, 687.0, 72.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 120.0, 2.0, 50.0, 0.0, 120.0, 10.0, 3.0, -12.0, 110.0, 10.0, 20.0, 30.0, 70.0, 150.0, 20.0, 20.0, 140.0, 30.0, 30.0, 40.0, 50.0, 40.0, 20.0, 45.0, 36.0, 0.0, 75.0, 60.0, 40.0, 40.0, 50.0, 40.0, 60.0, 60.0, 50.0, 30.0, 40.0, 40.0, 40.0, 0.0, 80.0, 40.0, 70.0, 120.0, 20.0, 110.0, 20.0, 5.0, 100.0, 10.0, 40.0, 20.0, 40.0, 60.0, -15.0, 20.0, 20.0, 50.0, 40.0, 30.0, 20.0, 30.0, 108.0, 50.0, 100.0, 40.0, 50.0, 70.0, 60.0, 30.0, 40.0, 48.0, 60.0, 18.0, 40.0, 40.0, 30.0, 30.0, 35.0, 30.0, 30.0, 40.0, 40.0, 10.0, 110.0, 20.0, 20.0, 90.0, 60.0, 50.0, 120.0, 30.0, 20.0, 43.0, 20.0, 30.0, 30.0, 60.0, 15.0, 150.0, 60.0, 50.0, 80.0, 60.0, 60.0, 60.0, 30.0, 50.0, 60.0, 30.0, -9.0, 0.0, 70.0, 47.0, 90.0, 70.0, 80.0, 10.0, 40.0, 130.0, 30.0, 20.0, 40.0, 90.0, 40.0, 40.0, 150.0, 70.0, 80.0, 10.0, -7.0, 50.0, 30.0, 60.0, 50.0, 100.0, 23.0, 30.0, 30.0, 50.0, 80.0, 50.0, 40.0, 30.0, 70.0, 100.0, 60.0, 80.0, 20.0, 20.0, 70.0, 50.0, 40.0, 20.0, 30.0, 0.0, 40.0, 40.0, 80.0, 30.0, 49.0, 20.0, 15.0, 5.0, -15.0, 40.0, 27.0, 17.0, 50.0, 50.0, 40.0, 50.0, 70.0, 40.0, 40.0, 50.0, 90.0, 50.0, 50.0, 50.0, 52.0, 60.0, 80.0, 50.0, 19.0, 50.0, 50.0, 33.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 0.0, 0.0, 60.0, 40.0, 70.0, 60.0, 11.0, 20.0, 80.0, 43.0, 70.0, 50.0, 90.0, 60.0, 20.0, 0.0, -10.0, 19.0, 60.0, 70.0, 50.0, 9.0, -25.0, 30.0, 30.0, 35.0, 40.0, 50.0, 70.0, 10.0, 7.0, 80.0, 33.0, 10.0, 30.0, 20.0, 60.0, 80.0, 80.0, 30.0, 20.0, 30.0, 120.0, 30.0, 50.0, 80.0, 30.0, 50.0, 0.0, 70.0, 60.0, 30.0, 50.0, 80.0, 90.0, 40.0, 50.0, 10.0, 190.0, -20.0, 90.0, 50.0, 100.0, 40.0, 10.0, 40.0, 20.0, 90.0, 33.0, 19.0, 30.0, 40.0, 70.0, 40.0, 30.0, 50.0, 40.0, 10.0, 10.0, 42.0, 19.0, 80.0, 70.0, 50.0, 30.0, 90.0, 30.0, 30.0, 20.0, 60.0, 40.0, 40.0, 30.0, 40.0, 60.0, 40.0, 80.0, 24.0, 30.0, 60.0, 20.0, 65.0, 40.0, 60.0, 15.0, 17.0, 20.0, 20.0, -21.0, 20.0, 20.0, 43.0, 53.0, 60.0, 0.0, 15.0, -121.0, 130.0, 30.0, 60.0, 98.0, 1.0, 70.0, -18.0, 20.0, 70.0, 40.0, 57.0, 60.0, 40.0, -4.0, 50.0, 5.0, 20.0, 20.0, 70.0, 150.0, 50.0, 3.0, 20.0, 130.0, 31.0, 30.0, 30.0, 40.0, 30.0, 60.0, 140.0, 30.0, 30.0, 60.0, 20.0, 20.0, 20.0, 20.0, 40.0, 0.0, 50.0, 50.0, 40.0, 40.0, 40.0, 100.0, 40.0, 30.0, 5.0, 50.0, 80.0, 59.0, 30.0, 60.0, 70.0, -35.0, 49.0, 60.0, 50.0, 78.0, -3.0, 30.0, 25.0, 60.0, 40.0, 70.0, 37.0, 50.0, 30.0, 29.0, 47.0, 70.0, 39.0, 70.0, 30.0, 20.0, 50.0, 21.0, -135.0, 68.0, 32.0, 10.0, 50.0, 45.0, 28.0, 20.0, 50.0, 30.0, 60.0, 100.0, 40.0, 20.0, 30.0, 40.0, 20.0, 0.0, 30.0, 20.0, 14.0, 20.0, 20.0, 4.0, 60.0, 30.0, 40.0, 60.0, 50.0, 50.0, 40.0, 30.0, 30.0, 70.0, 20.0, 60.0, 0.0, 110.0, 60.0, 50.0, 50.0, 30.0, 90.0, 30.0, 40.0, 49.0, 79.0, 30.0, 90.0, 40.0, 30.0, 40.0, 40.0, 10.0, 40.0, 40.0, 60.0, 40.0, 60.0, 70.0, 50.0, 270.0, 10.0, -10.0, 20.0, 70.0, 40.0, 40.0, 40.0, 30.0, 20.0, 40.0, 50.0, 60.0, 10.0, 100.0, 30.0, 80.0, 90.0, 100.0, 120.0, 61.0, 89.0, 70.0, 10.0, 20.0, 20.0, 29.0, 90.0, 230.0, 10.0, 60.0, 30.0, 30.0, 140.0, 20.0, 5.0, 60.0, 60.0, 60.0, 70.0, 30.0, 10.0, 50.0, 44.0, 90.0, 74.0, 40.0, 90.0, 60.0, 50.0, 10.0, 10.0, 20.0, 20.0, 30.0, 40.0, 0.0, 50.0, 30.0, 28.0, 30.0, 50.0, 60.0, 70.0, 50.0, 48.0, 70.0, 40.0, 40.0, 80.0, 20.0, 29.0, 16.0, 50.0, 40.0, 50.0, 50.0, 20.0, 40.0, 110.0, 40.0, 70.0, 30.0, 50.0, 140.0, 50.0, 60.0, 40.0, 40.0, 30.0, 10.0, 10.0, 20.0, 60.0, 40.0, 79.0, 50.0, 70.0, 80.0, 60.0, 70.0, 90.0, 40.0, 50.0, 28.0, 130.0, 47.0, 80.0, 10.0, 80.0, 60.0, 70.0, 20.0, 90.0, 30.0, 60.0, 0.0, 10.0, 44.0, 5.0, 50.0, 0.0, 8.0, 10.0, -7.0, -1.0, -18.0, 29.0, 30.0, 100.0, 50.0, 89.0, 10.0, 29.0, 19.0, 70.0, 50.0, 40.0, 100.0, 70.0, 50.0, 94.0, 60.0, 76.0, 32.0, 50.0, 40.0, 52.0, 90.0, 40.0, 40.0, 50.0, 50.0, 19.0, 70.0, 10.0, -17.0, 160.0, 90.0, 60.0, 60.0, 34.0, 15.0, 39.0, 100.0, 60.0, 50.0, 130.0, 27.0, 90.0, 30.0, 10.0, 60.0, 20.0, 40.0, 50.0, 30.0, 65.0, -10.0, 10.0, 20.0, 9.0, 50.0, 8.0, 49.0, 60.0, 55.0, 30.0, 20.0, 20.0, 50.0, 60.0, 21.0, 50.0, 30.0, 70.0, 32.0, 70.0, 110.0, 20.0, 60.0, 60.0, 40.0, 40.0, 80.0, 40.0, 70.0, 90.0, 110.0, 30.0, 40.0, 50.0, 60.0, 50.0, 10.0, 30.0, 60.0, 20.0, 50.0, -5.0, 15.0, 30.0, 7.0, 52.0, 27.0, 30.0, 38.0, 3.0, 40.0, 30.0, 20.0, 12.0, 13.0, 40.0, 70.0, 70.0, 30.0, 70.0, 30.0, 80.0, 80.0, 60.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 20.0, 60.0, 60.0, 32.0, 40.0, 20.0, 10.0, 60.0, 25.0, 30.0, 60.0, 90.0, 10.0, 20.0, 20.0, 20.0, 50.0, 10.0, 40.0, 60.0, 20.0, 80.0, 90.0, 40.0, 70.0, 120.0, 80.0, 90.0, 130.0, 0.0, 0.0, 40.0, 30.0, 70.0, 70.0, 70.0, 50.0, 50.0, 30.0, 10.0, 79.0, 60.0, 50.0, 70.0, 40.0, 0.0, 20.0, 80.0, 60.0, 20.0, 50.0, 60.0, 70.0, 60.0, 70.0, 0.0, 90.0, 70.0, 30.0, 60.0, 30.0, 40.0, -10.0, 23.0, 30.0, 11.0, 60.0, 29.0, 30.0, 50.0, 10.0, 43.0, 100.0, 130.0, 16.0, 34.0, 317.0, 98.0, 84.0, 88.0, 50.0, 20.0, 50.0, 100.0, 30.0, 40.0, 30.0, 40.0, 100.0, 50.0, 79.0, 90.0, 50.0, 60.0, 100.0, 40.0, 20.0, 50.0, 40.0, 10.0, 80.0, 50.0, 54.0, 56.0, 64.0, 80.0, 39.0, 50.0, 19.0, 87.0, 8.0, 60.0, 30.0, -27.0, 6.0, 20.0, 50.0, 20.0, 60.0, 90.0, 100.0, 60.0, -5.0, 70.0, 90.0, 120.0, 10.0, 70.0, 36.0, 35.0, 40.0, 10.0, 63.0, 10.0, -5.0, 50.0, -3.0, 20.0, 40.0, 17.0, 30.0, 20.0, 110.0, 51.0, 80.0, 70.0, 10.0, 28.0, 148.0, 16.0, 20.0, 23.0, 22.0, 20.0, 50.0, 30.0, 40.0, 17.0, 0.0, 60.0, 100.0, 60.0, -7.0, 0.0, -27.0, 80.0, 17.0, 40.0, 33.0, 59.0, 38.0, 110.0, 40.0, 127.0, 50.0, -80.0, 70.0, 60.0, 66.0, 80.0, 70.0, 0.0, 120.0, 40.0, 40.0, 70.0, 60.0, 40.0, 60.0, 50.0, 30.0, 70.0, 0.0, -16.0, 60.0, -5.0, 16.0, 60.0, 100.0, 140.0, 70.0, 40.0, 80.0, 70.0, 30.0, 20.0, 80.0, 80.0, 50.0, 100.0, 30.0, 40.0, 40.0, 20.0, 40.0, 20.0, 30.0, 60.0, 30.0, 80.0, 40.0, 50.0, 60.0, 90.0, 10.0, 40.0, 60.0, 30.0, 120.0, 40.0, 48.0, 35.0, 19.0, 60.0, 40.0, 46.0, -13.0, 80.0, 80.0, 35.0, 56.0, 90.0, 19.0, 20.0, 36.0, 20.0, 110.0, 64.0, 47.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 40.0, 70.0, 50.0, 20.0, 30.0, 90.0, 30.0, 60.0, 20.0, 30.0, 27.0, 80.0, 110.0, 40.0, 78.0, 40.0, 50.0, 40.0, 12.0, 50.0, 10.0, 137.0, 50.0, 30.0, 60.0, 29.0, 60.0, 110.0, 0.0, 68.0, 120.0, 30.0, 30.0, 120.0, 120.0, 22.0, 10.0, 50.0, 9.0, 14.0, -31.0, 30.0, 6.0, -54.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5853415953443446, "mean_inference_ms": 2.722033453203019, "mean_action_processing_ms": 0.7817710201866734, "mean_env_wait_ms": 1.8281002021314883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02043318748474121, "StateBufferConnector_ms": 0.01331949234008789, "ViewRequirementAgentConnector_ms": 0.7648367881774902}, "num_episodes": 18, "episode_return_max": 920.0, "episode_return_min": 72.0, "episode_return_mean": 456.44}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.303432213455467, "num_env_steps_trained_throughput_per_sec": 15.303432213455467, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 257144.536, "restore_workers_time_ms": 0.015, "training_step_time_ms": 257144.484, "sample_time_ms": 4400.768, "learn_time_ms": 252722.985, "learn_throughput": 15.828, "synch_weights_time_ms": 13.956}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 18, "trial_id": "1841f_00000", "date": "2024-08-08_00-37-08", "timestamp": 1723091828, "time_this_iter_s": 261.38719487190247, "time_total_s": 4614.121091127396, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24551f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4614.121091127396, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 49.300540540540545, "ram_util_percent": 80.62243243243243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9414307076329242, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.935830178783851, "policy_loss": -0.01274623275217248, "vf_loss": 6.946829465809214, "vf_explained_var": 0.005677378006255665, "kl": 0.008734692055019418, "entropy": 1.1957629837421055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 173715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 920.0, "episode_reward_min": 72.0, "episode_reward_mean": 468.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 317.0}, "policy_reward_mean": {"policy_0": 46.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [365.0, 500.0, 500.0, 640.0, 392.0, 401.0, 410.0, 479.0, 247.0, 265.0, 358.0, 534.0, 450.0, 420.0, 398.0, 447.0, 435.0, 189.0, 370.0, 318.0, 470.0, 538.0, 400.0, 600.0, 510.0, 609.0, 645.0, 558.0, 290.0, 476.0, 395.0, 630.0, 409.0, 675.0, 430.0, 120.0, 487.0, 624.0, 512.0, 638.0, 422.0, 281.0, 423.0, 610.0, 460.0, 247.0, 395.0, 500.0, 357.0, 380.0, 720.0, 420.0, 479.0, 560.0, 293.0, 920.0, 510.0, 539.0, 579.0, 317.0, 586.0, 242.0, 563.0, 282.0, 355.0, 561.0, 550.0, 455.0, 620.0, 390.0, 540.0, 430.0, 492.0, 370.0, 565.0, 479.0, 687.0, 72.0, 315.0, 450.0, 450.0, 391.0, 354.0, 537.0, 396.0, 669.0, 446.0, 661.0, 590.0, 458.0, 473.0, 720.0, 547.0, 448.0, 474.0, 537.0, 510.0, 630.0, 544.0, 440.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 35.0, 40.0, 50.0, 70.0, 10.0, 7.0, 80.0, 33.0, 10.0, 30.0, 20.0, 60.0, 80.0, 80.0, 30.0, 20.0, 30.0, 120.0, 30.0, 50.0, 80.0, 30.0, 50.0, 0.0, 70.0, 60.0, 30.0, 50.0, 80.0, 90.0, 40.0, 50.0, 10.0, 190.0, -20.0, 90.0, 50.0, 100.0, 40.0, 10.0, 40.0, 20.0, 90.0, 33.0, 19.0, 30.0, 40.0, 70.0, 40.0, 30.0, 50.0, 40.0, 10.0, 10.0, 42.0, 19.0, 80.0, 70.0, 50.0, 30.0, 90.0, 30.0, 30.0, 20.0, 60.0, 40.0, 40.0, 30.0, 40.0, 60.0, 40.0, 80.0, 24.0, 30.0, 60.0, 20.0, 65.0, 40.0, 60.0, 15.0, 17.0, 20.0, 20.0, -21.0, 20.0, 20.0, 43.0, 53.0, 60.0, 0.0, 15.0, -121.0, 130.0, 30.0, 60.0, 98.0, 1.0, 70.0, -18.0, 20.0, 70.0, 40.0, 57.0, 60.0, 40.0, -4.0, 50.0, 5.0, 20.0, 20.0, 70.0, 150.0, 50.0, 3.0, 20.0, 130.0, 31.0, 30.0, 30.0, 40.0, 30.0, 60.0, 140.0, 30.0, 30.0, 60.0, 20.0, 20.0, 20.0, 20.0, 40.0, 0.0, 50.0, 50.0, 40.0, 40.0, 40.0, 100.0, 40.0, 30.0, 5.0, 50.0, 80.0, 59.0, 30.0, 60.0, 70.0, -35.0, 49.0, 60.0, 50.0, 78.0, -3.0, 30.0, 25.0, 60.0, 40.0, 70.0, 37.0, 50.0, 30.0, 29.0, 47.0, 70.0, 39.0, 70.0, 30.0, 20.0, 50.0, 21.0, -135.0, 68.0, 32.0, 10.0, 50.0, 45.0, 28.0, 20.0, 50.0, 30.0, 60.0, 100.0, 40.0, 20.0, 30.0, 40.0, 20.0, 0.0, 30.0, 20.0, 14.0, 20.0, 20.0, 4.0, 60.0, 30.0, 40.0, 60.0, 50.0, 50.0, 40.0, 30.0, 30.0, 70.0, 20.0, 60.0, 0.0, 110.0, 60.0, 50.0, 50.0, 30.0, 90.0, 30.0, 40.0, 49.0, 79.0, 30.0, 90.0, 40.0, 30.0, 40.0, 40.0, 10.0, 40.0, 40.0, 60.0, 40.0, 60.0, 70.0, 50.0, 270.0, 10.0, -10.0, 20.0, 70.0, 40.0, 40.0, 40.0, 30.0, 20.0, 40.0, 50.0, 60.0, 10.0, 100.0, 30.0, 80.0, 90.0, 100.0, 120.0, 61.0, 89.0, 70.0, 10.0, 20.0, 20.0, 29.0, 90.0, 230.0, 10.0, 60.0, 30.0, 30.0, 140.0, 20.0, 5.0, 60.0, 60.0, 60.0, 70.0, 30.0, 10.0, 50.0, 44.0, 90.0, 74.0, 40.0, 90.0, 60.0, 50.0, 10.0, 10.0, 20.0, 20.0, 30.0, 40.0, 0.0, 50.0, 30.0, 28.0, 30.0, 50.0, 60.0, 70.0, 50.0, 48.0, 70.0, 40.0, 40.0, 80.0, 20.0, 29.0, 16.0, 50.0, 40.0, 50.0, 50.0, 20.0, 40.0, 110.0, 40.0, 70.0, 30.0, 50.0, 140.0, 50.0, 60.0, 40.0, 40.0, 30.0, 10.0, 10.0, 20.0, 60.0, 40.0, 79.0, 50.0, 70.0, 80.0, 60.0, 70.0, 90.0, 40.0, 50.0, 28.0, 130.0, 47.0, 80.0, 10.0, 80.0, 60.0, 70.0, 20.0, 90.0, 30.0, 60.0, 0.0, 10.0, 44.0, 5.0, 50.0, 0.0, 8.0, 10.0, -7.0, -1.0, -18.0, 29.0, 30.0, 100.0, 50.0, 89.0, 10.0, 29.0, 19.0, 70.0, 50.0, 40.0, 100.0, 70.0, 50.0, 94.0, 60.0, 76.0, 32.0, 50.0, 40.0, 52.0, 90.0, 40.0, 40.0, 50.0, 50.0, 19.0, 70.0, 10.0, -17.0, 160.0, 90.0, 60.0, 60.0, 34.0, 15.0, 39.0, 100.0, 60.0, 50.0, 130.0, 27.0, 90.0, 30.0, 10.0, 60.0, 20.0, 40.0, 50.0, 30.0, 65.0, -10.0, 10.0, 20.0, 9.0, 50.0, 8.0, 49.0, 60.0, 55.0, 30.0, 20.0, 20.0, 50.0, 60.0, 21.0, 50.0, 30.0, 70.0, 32.0, 70.0, 110.0, 20.0, 60.0, 60.0, 40.0, 40.0, 80.0, 40.0, 70.0, 90.0, 110.0, 30.0, 40.0, 50.0, 60.0, 50.0, 10.0, 30.0, 60.0, 20.0, 50.0, -5.0, 15.0, 30.0, 7.0, 52.0, 27.0, 30.0, 38.0, 3.0, 40.0, 30.0, 20.0, 12.0, 13.0, 40.0, 70.0, 70.0, 30.0, 70.0, 30.0, 80.0, 80.0, 60.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 20.0, 60.0, 60.0, 32.0, 40.0, 20.0, 10.0, 60.0, 25.0, 30.0, 60.0, 90.0, 10.0, 20.0, 20.0, 20.0, 50.0, 10.0, 40.0, 60.0, 20.0, 80.0, 90.0, 40.0, 70.0, 120.0, 80.0, 90.0, 130.0, 0.0, 0.0, 40.0, 30.0, 70.0, 70.0, 70.0, 50.0, 50.0, 30.0, 10.0, 79.0, 60.0, 50.0, 70.0, 40.0, 0.0, 20.0, 80.0, 60.0, 20.0, 50.0, 60.0, 70.0, 60.0, 70.0, 0.0, 90.0, 70.0, 30.0, 60.0, 30.0, 40.0, -10.0, 23.0, 30.0, 11.0, 60.0, 29.0, 30.0, 50.0, 10.0, 43.0, 100.0, 130.0, 16.0, 34.0, 317.0, 98.0, 84.0, 88.0, 50.0, 20.0, 50.0, 100.0, 30.0, 40.0, 30.0, 40.0, 100.0, 50.0, 79.0, 90.0, 50.0, 60.0, 100.0, 40.0, 20.0, 50.0, 40.0, 10.0, 80.0, 50.0, 54.0, 56.0, 64.0, 80.0, 39.0, 50.0, 19.0, 87.0, 8.0, 60.0, 30.0, -27.0, 6.0, 20.0, 50.0, 20.0, 60.0, 90.0, 100.0, 60.0, -5.0, 70.0, 90.0, 120.0, 10.0, 70.0, 36.0, 35.0, 40.0, 10.0, 63.0, 10.0, -5.0, 50.0, -3.0, 20.0, 40.0, 17.0, 30.0, 20.0, 110.0, 51.0, 80.0, 70.0, 10.0, 28.0, 148.0, 16.0, 20.0, 23.0, 22.0, 20.0, 50.0, 30.0, 40.0, 17.0, 0.0, 60.0, 100.0, 60.0, -7.0, 0.0, -27.0, 80.0, 17.0, 40.0, 33.0, 59.0, 38.0, 110.0, 40.0, 127.0, 50.0, -80.0, 70.0, 60.0, 66.0, 80.0, 70.0, 0.0, 120.0, 40.0, 40.0, 70.0, 60.0, 40.0, 60.0, 50.0, 30.0, 70.0, 0.0, -16.0, 60.0, -5.0, 16.0, 60.0, 100.0, 140.0, 70.0, 40.0, 80.0, 70.0, 30.0, 20.0, 80.0, 80.0, 50.0, 100.0, 30.0, 40.0, 40.0, 20.0, 40.0, 20.0, 30.0, 60.0, 30.0, 80.0, 40.0, 50.0, 60.0, 90.0, 10.0, 40.0, 60.0, 30.0, 120.0, 40.0, 48.0, 35.0, 19.0, 60.0, 40.0, 46.0, -13.0, 80.0, 80.0, 35.0, 56.0, 90.0, 19.0, 20.0, 36.0, 20.0, 110.0, 64.0, 47.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 40.0, 70.0, 50.0, 20.0, 30.0, 90.0, 30.0, 60.0, 20.0, 30.0, 27.0, 80.0, 110.0, 40.0, 78.0, 40.0, 50.0, 40.0, 12.0, 50.0, 10.0, 137.0, 50.0, 30.0, 60.0, 29.0, 60.0, 110.0, 0.0, 68.0, 120.0, 30.0, 30.0, 120.0, 120.0, 22.0, 10.0, 50.0, 9.0, 14.0, -31.0, 30.0, 6.0, -54.0, 16.0, 38.0, 30.0, 40.0, 17.0, 68.0, -5.0, 20.0, 47.0, 50.0, 10.0, 20.0, 70.0, 20.0, 100.0, 10.0, 30.0, 50.0, 90.0, 30.0, 30.0, 100.0, 40.0, 55.0, 80.0, 40.0, 50.0, 10.0, 8.0, -13.0, 80.0, 10.0, 60.0, 50.0, 20.0, 40.0, 31.0, 50.0, 40.0, 40.0, 50.0, 80.0, 40.0, 26.0, 18.0, 57.0, 60.0, 15.0, 30.0, 30.0, -2.0, 40.0, 30.0, 43.0, 44.0, 40.0, 50.0, 30.0, 110.0, 50.0, 100.0, 3.0, 70.0, 40.0, 40.0, 60.0, 3.0, 60.0, 40.0, 60.0, 20.0, 60.0, 50.0, 90.0, 30.0, 50.0, 59.0, 110.0, 60.0, 110.0, 50.0, 17.0, 70.0, 100.0, 33.0, -7.0, 60.0, 30.0, 60.0, 23.0, 60.0, 25.0, 70.0, 80.0, 80.0, 100.0, 100.0, 45.0, 31.0, 60.0, 70.0, 80.0, 90.0, 100.0, 70.0, 50.0, 10.0, 70.0, 70.0, 40.0, 10.0, 21.0, 40.0, 20.0, 32.0, 80.0, 20.0, 25.0, 30.0, 70.0, 120.0, 51.0, 50.0, 52.0, 45.0, 100.0, 15.0, 20.0, 100.0, 20.0, 20.0, 50.0, 70.0, 60.0, 120.0, 80.0, 50.0, 70.0, 50.0, 110.0, 60.0, 39.0, 50.0, 50.0, 130.0, 60.0, 60.0, 90.0, 20.0, 18.0, 30.0, 60.0, 60.0, 26.0, 70.0, 50.0, 25.0, 57.0, 50.0, 10.0, 40.0, 109.0, -14.0, 30.0, 2.0, 160.0, 11.0, 50.0, 100.0, 10.0, 16.0, 40.0, 80.0, 70.0, 17.0, 80.0, 50.0, 40.0, 70.0, 60.0, 30.0, 140.0, 50.0, 20.0, 50.0, 40.0, 60.0, 30.0, 40.0, 40.0, 40.0, 70.0, 50.0, 90.0, 80.0, 40.0, 80.0, 100.0, 10.0, 30.0, 80.0, -12.0, 50.0, 100.0, 16.0, 60.0, 90.0, 80.0, 30.0, 100.0, 30.0, 27.0, 60.0, 20.0, 16.0, 20.0, 150.0, 50.0, 15.0, 70.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5891372470031384, "mean_inference_ms": 2.738455739416336, "mean_action_processing_ms": 0.7833940053778916, "mean_env_wait_ms": 1.8314307862419321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02034926414489746, "StateBufferConnector_ms": 0.017787456512451172, "ViewRequirementAgentConnector_ms": 0.8151354789733887}, "num_episodes": 22, "episode_return_max": 920.0, "episode_return_min": 72.0, "episode_return_mean": 468.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.36811546054171, "num_env_steps_trained_throughput_per_sec": 15.36811546054171, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 257818.212, "restore_workers_time_ms": 0.015, "training_step_time_ms": 257818.159, "sample_time_ms": 4390.44, "learn_time_ms": 253405.637, "learn_throughput": 15.785, "synch_weights_time_ms": 15.179}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 19, "trial_id": "1841f_00000", "date": "2024-08-08_00-41-29", "timestamp": 1723092089, "time_this_iter_s": 260.2905490398407, "time_total_s": 4874.411640167236, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2481790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4874.411640167236, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 49.19782608695652, "ram_util_percent": 79.85760869565217}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5764203557699, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.574302227022295, "policy_loss": -0.012199554214572894, "vf_loss": 7.584858862660563, "vf_explained_var": 0.005425285194882443, "kl": 0.00821464938928656, "entropy": 1.1342839460784253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 183105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 920.0, "episode_reward_min": 72.0, "episode_reward_mean": 495.93, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 317.0}, "policy_reward_mean": {"policy_0": 49.593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [600.0, 510.0, 609.0, 645.0, 558.0, 290.0, 476.0, 395.0, 630.0, 409.0, 675.0, 430.0, 120.0, 487.0, 624.0, 512.0, 638.0, 422.0, 281.0, 423.0, 610.0, 460.0, 247.0, 395.0, 500.0, 357.0, 380.0, 720.0, 420.0, 479.0, 560.0, 293.0, 920.0, 510.0, 539.0, 579.0, 317.0, 586.0, 242.0, 563.0, 282.0, 355.0, 561.0, 550.0, 455.0, 620.0, 390.0, 540.0, 430.0, 492.0, 370.0, 565.0, 479.0, 687.0, 72.0, 315.0, 450.0, 450.0, 391.0, 354.0, 537.0, 396.0, 669.0, 446.0, 661.0, 590.0, 458.0, 473.0, 720.0, 547.0, 448.0, 474.0, 537.0, 510.0, 630.0, 544.0, 440.0, 548.0, 390.0, 624.0, 399.0, 587.0, 586.0, 656.0, 680.0, 600.0, 620.0, 620.0, 249.0, 459.0, 460.0, 474.0, 574.0, 575.0, 355.0, 721.0, 740.0, 270.0, 587.0, 520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 50.0, 270.0, 10.0, -10.0, 20.0, 70.0, 40.0, 40.0, 40.0, 30.0, 20.0, 40.0, 50.0, 60.0, 10.0, 100.0, 30.0, 80.0, 90.0, 100.0, 120.0, 61.0, 89.0, 70.0, 10.0, 20.0, 20.0, 29.0, 90.0, 230.0, 10.0, 60.0, 30.0, 30.0, 140.0, 20.0, 5.0, 60.0, 60.0, 60.0, 70.0, 30.0, 10.0, 50.0, 44.0, 90.0, 74.0, 40.0, 90.0, 60.0, 50.0, 10.0, 10.0, 20.0, 20.0, 30.0, 40.0, 0.0, 50.0, 30.0, 28.0, 30.0, 50.0, 60.0, 70.0, 50.0, 48.0, 70.0, 40.0, 40.0, 80.0, 20.0, 29.0, 16.0, 50.0, 40.0, 50.0, 50.0, 20.0, 40.0, 110.0, 40.0, 70.0, 30.0, 50.0, 140.0, 50.0, 60.0, 40.0, 40.0, 30.0, 10.0, 10.0, 20.0, 60.0, 40.0, 79.0, 50.0, 70.0, 80.0, 60.0, 70.0, 90.0, 40.0, 50.0, 28.0, 130.0, 47.0, 80.0, 10.0, 80.0, 60.0, 70.0, 20.0, 90.0, 30.0, 60.0, 0.0, 10.0, 44.0, 5.0, 50.0, 0.0, 8.0, 10.0, -7.0, -1.0, -18.0, 29.0, 30.0, 100.0, 50.0, 89.0, 10.0, 29.0, 19.0, 70.0, 50.0, 40.0, 100.0, 70.0, 50.0, 94.0, 60.0, 76.0, 32.0, 50.0, 40.0, 52.0, 90.0, 40.0, 40.0, 50.0, 50.0, 19.0, 70.0, 10.0, -17.0, 160.0, 90.0, 60.0, 60.0, 34.0, 15.0, 39.0, 100.0, 60.0, 50.0, 130.0, 27.0, 90.0, 30.0, 10.0, 60.0, 20.0, 40.0, 50.0, 30.0, 65.0, -10.0, 10.0, 20.0, 9.0, 50.0, 8.0, 49.0, 60.0, 55.0, 30.0, 20.0, 20.0, 50.0, 60.0, 21.0, 50.0, 30.0, 70.0, 32.0, 70.0, 110.0, 20.0, 60.0, 60.0, 40.0, 40.0, 80.0, 40.0, 70.0, 90.0, 110.0, 30.0, 40.0, 50.0, 60.0, 50.0, 10.0, 30.0, 60.0, 20.0, 50.0, -5.0, 15.0, 30.0, 7.0, 52.0, 27.0, 30.0, 38.0, 3.0, 40.0, 30.0, 20.0, 12.0, 13.0, 40.0, 70.0, 70.0, 30.0, 70.0, 30.0, 80.0, 80.0, 60.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 20.0, 60.0, 60.0, 32.0, 40.0, 20.0, 10.0, 60.0, 25.0, 30.0, 60.0, 90.0, 10.0, 20.0, 20.0, 20.0, 50.0, 10.0, 40.0, 60.0, 20.0, 80.0, 90.0, 40.0, 70.0, 120.0, 80.0, 90.0, 130.0, 0.0, 0.0, 40.0, 30.0, 70.0, 70.0, 70.0, 50.0, 50.0, 30.0, 10.0, 79.0, 60.0, 50.0, 70.0, 40.0, 0.0, 20.0, 80.0, 60.0, 20.0, 50.0, 60.0, 70.0, 60.0, 70.0, 0.0, 90.0, 70.0, 30.0, 60.0, 30.0, 40.0, -10.0, 23.0, 30.0, 11.0, 60.0, 29.0, 30.0, 50.0, 10.0, 43.0, 100.0, 130.0, 16.0, 34.0, 317.0, 98.0, 84.0, 88.0, 50.0, 20.0, 50.0, 100.0, 30.0, 40.0, 30.0, 40.0, 100.0, 50.0, 79.0, 90.0, 50.0, 60.0, 100.0, 40.0, 20.0, 50.0, 40.0, 10.0, 80.0, 50.0, 54.0, 56.0, 64.0, 80.0, 39.0, 50.0, 19.0, 87.0, 8.0, 60.0, 30.0, -27.0, 6.0, 20.0, 50.0, 20.0, 60.0, 90.0, 100.0, 60.0, -5.0, 70.0, 90.0, 120.0, 10.0, 70.0, 36.0, 35.0, 40.0, 10.0, 63.0, 10.0, -5.0, 50.0, -3.0, 20.0, 40.0, 17.0, 30.0, 20.0, 110.0, 51.0, 80.0, 70.0, 10.0, 28.0, 148.0, 16.0, 20.0, 23.0, 22.0, 20.0, 50.0, 30.0, 40.0, 17.0, 0.0, 60.0, 100.0, 60.0, -7.0, 0.0, -27.0, 80.0, 17.0, 40.0, 33.0, 59.0, 38.0, 110.0, 40.0, 127.0, 50.0, -80.0, 70.0, 60.0, 66.0, 80.0, 70.0, 0.0, 120.0, 40.0, 40.0, 70.0, 60.0, 40.0, 60.0, 50.0, 30.0, 70.0, 0.0, -16.0, 60.0, -5.0, 16.0, 60.0, 100.0, 140.0, 70.0, 40.0, 80.0, 70.0, 30.0, 20.0, 80.0, 80.0, 50.0, 100.0, 30.0, 40.0, 40.0, 20.0, 40.0, 20.0, 30.0, 60.0, 30.0, 80.0, 40.0, 50.0, 60.0, 90.0, 10.0, 40.0, 60.0, 30.0, 120.0, 40.0, 48.0, 35.0, 19.0, 60.0, 40.0, 46.0, -13.0, 80.0, 80.0, 35.0, 56.0, 90.0, 19.0, 20.0, 36.0, 20.0, 110.0, 64.0, 47.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 40.0, 70.0, 50.0, 20.0, 30.0, 90.0, 30.0, 60.0, 20.0, 30.0, 27.0, 80.0, 110.0, 40.0, 78.0, 40.0, 50.0, 40.0, 12.0, 50.0, 10.0, 137.0, 50.0, 30.0, 60.0, 29.0, 60.0, 110.0, 0.0, 68.0, 120.0, 30.0, 30.0, 120.0, 120.0, 22.0, 10.0, 50.0, 9.0, 14.0, -31.0, 30.0, 6.0, -54.0, 16.0, 38.0, 30.0, 40.0, 17.0, 68.0, -5.0, 20.0, 47.0, 50.0, 10.0, 20.0, 70.0, 20.0, 100.0, 10.0, 30.0, 50.0, 90.0, 30.0, 30.0, 100.0, 40.0, 55.0, 80.0, 40.0, 50.0, 10.0, 8.0, -13.0, 80.0, 10.0, 60.0, 50.0, 20.0, 40.0, 31.0, 50.0, 40.0, 40.0, 50.0, 80.0, 40.0, 26.0, 18.0, 57.0, 60.0, 15.0, 30.0, 30.0, -2.0, 40.0, 30.0, 43.0, 44.0, 40.0, 50.0, 30.0, 110.0, 50.0, 100.0, 3.0, 70.0, 40.0, 40.0, 60.0, 3.0, 60.0, 40.0, 60.0, 20.0, 60.0, 50.0, 90.0, 30.0, 50.0, 59.0, 110.0, 60.0, 110.0, 50.0, 17.0, 70.0, 100.0, 33.0, -7.0, 60.0, 30.0, 60.0, 23.0, 60.0, 25.0, 70.0, 80.0, 80.0, 100.0, 100.0, 45.0, 31.0, 60.0, 70.0, 80.0, 90.0, 100.0, 70.0, 50.0, 10.0, 70.0, 70.0, 40.0, 10.0, 21.0, 40.0, 20.0, 32.0, 80.0, 20.0, 25.0, 30.0, 70.0, 120.0, 51.0, 50.0, 52.0, 45.0, 100.0, 15.0, 20.0, 100.0, 20.0, 20.0, 50.0, 70.0, 60.0, 120.0, 80.0, 50.0, 70.0, 50.0, 110.0, 60.0, 39.0, 50.0, 50.0, 130.0, 60.0, 60.0, 90.0, 20.0, 18.0, 30.0, 60.0, 60.0, 26.0, 70.0, 50.0, 25.0, 57.0, 50.0, 10.0, 40.0, 109.0, -14.0, 30.0, 2.0, 160.0, 11.0, 50.0, 100.0, 10.0, 16.0, 40.0, 80.0, 70.0, 17.0, 80.0, 50.0, 40.0, 70.0, 60.0, 30.0, 140.0, 50.0, 20.0, 50.0, 40.0, 60.0, 30.0, 40.0, 40.0, 40.0, 70.0, 50.0, 90.0, 80.0, 40.0, 80.0, 100.0, 10.0, 30.0, 80.0, -12.0, 50.0, 100.0, 16.0, 60.0, 90.0, 80.0, 30.0, 100.0, 30.0, 27.0, 60.0, 20.0, 16.0, 20.0, 150.0, 50.0, 15.0, 70.0, 12.0, 60.0, 100.0, 40.0, 50.0, 6.0, 20.0, 90.0, 6.0, 60.0, 116.0, -4.0, 60.0, 26.0, -17.0, 90.0, 17.0, 120.0, 13.0, 35.0, 50.0, 60.0, 100.0, 18.0, 56.0, 80.0, 60.0, 90.0, 40.0, 50.0, 70.0, 30.0, 20.0, 40.0, 45.0, 50.0, 80.0, 30.0, 14.0, 70.0, 20.0, 100.0, 21.0, 70.0, 46.0, 70.0, 40.0, 60.0, 100.0, 60.0, 20.0, 21.0, 68.0, 70.0, 20.0, 70.0, 68.0, 30.0, 100.0, 90.0, 49.0, 54.0, 100.0, 60.0, 40.0, 110.0, 40.0, 32.0, 60.0, 120.0, 40.0, 120.0, 60.0, 130.0, 80.0, 30.0, 30.0, 70.0, 30.0, 60.0, 70.0, 20.0, 70.0, 120.0, 80.0, 60.0, 70.0, 60.0, 40.0, 30.0, 50.0, 110.0, 70.0, 110.0, 80.0, 70.0, 30.0, 30.0, 40.0, 50.0, 30.0, 90.0, 30.0, 80.0, 50.0, 70.0, 90.0, 40.0, 20.0, 50.0, 100.0, -5.0, 10.0, 60.0, 8.0, 20.0, 66.0, 50.0, 10.0, 20.0, 10.0, 60.0, 50.0, 38.0, 48.0, 21.0, 10.0, 80.0, 69.0, 53.0, 30.0, 80.0, 10.0, 90.0, 60.0, 20.0, 20.0, 70.0, 30.0, 40.0, 40.0, 50.0, 50.0, 20.0, 13.0, 100.0, 1.0, 50.0, 20.0, 40.0, 130.0, 60.0, 120.0, 20.0, 50.0, 10.0, 28.0, 60.0, 110.0, 16.0, 100.0, 30.0, 40.0, 100.0, 70.0, 60.0, 85.0, 60.0, 40.0, 20.0, 70.0, -26.0, 30.0, 10.0, 110.0, 20.0, 70.0, -18.0, 40.0, 19.0, 100.0, 70.0, 110.0, 50.0, 100.0, 58.0, 78.0, 40.0, 130.0, 35.0, 50.0, 70.0, 120.0, 110.0, 160.0, 40.0, 60.0, 30.0, 80.0, 80.0, -10.0, 50.0, 0.0, 20.0, 5.0, 10.0, 30.0, 20.0, 5.0, 90.0, 40.0, 29.0, 29.0, 60.0, 39.0, 40.0, 120.0, 60.0, 80.0, 100.0, 30.0, 44.0, 20.0, 40.0, 26.0, 70.0, 20.0, 70.0, 40.0, 70.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5823707294460267, "mean_inference_ms": 2.741373363845467, "mean_action_processing_ms": 0.7824241395606429, "mean_env_wait_ms": 1.8304928206458642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04062008857727051, "StateBufferConnector_ms": 0.021448135375976562, "ViewRequirementAgentConnector_ms": 0.7892472743988037}, "num_episodes": 23, "episode_return_max": 920.0, "episode_return_min": 72.0, "episode_return_mean": 495.93}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.872158881246097, "num_env_steps_trained_throughput_per_sec": 14.872158881246097, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 259022.453, "restore_workers_time_ms": 0.015, "training_step_time_ms": 259022.4, "sample_time_ms": 4414.066, "learn_time_ms": 254586.053, "learn_throughput": 15.712, "synch_weights_time_ms": 15.506}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 20, "trial_id": "1841f_00000", "date": "2024-08-08_00-45-58", "timestamp": 1723092358, "time_this_iter_s": 268.98891973495483, "time_total_s": 5143.400559902191, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24551f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5143.400559902191, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 56.70105263157895, "ram_util_percent": 80.68026315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.811237702576624, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.527765073918433, "policy_loss": -0.01237772742070107, "vf_loss": 7.538490385547106, "vf_explained_var": 0.0029731442054874474, "kl": 0.008262080690860815, "entropy": 1.1083708984465899, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 192495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 920.0, "episode_reward_min": 72.0, "episode_reward_mean": 512.43, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 317.0}, "policy_reward_mean": {"policy_0": 51.243}, "custom_metrics": {}, "hist_stats": {"episode_reward": [281.0, 423.0, 610.0, 460.0, 247.0, 395.0, 500.0, 357.0, 380.0, 720.0, 420.0, 479.0, 560.0, 293.0, 920.0, 510.0, 539.0, 579.0, 317.0, 586.0, 242.0, 563.0, 282.0, 355.0, 561.0, 550.0, 455.0, 620.0, 390.0, 540.0, 430.0, 492.0, 370.0, 565.0, 479.0, 687.0, 72.0, 315.0, 450.0, 450.0, 391.0, 354.0, 537.0, 396.0, 669.0, 446.0, 661.0, 590.0, 458.0, 473.0, 720.0, 547.0, 448.0, 474.0, 537.0, 510.0, 630.0, 544.0, 440.0, 548.0, 390.0, 624.0, 399.0, 587.0, 586.0, 656.0, 680.0, 600.0, 620.0, 620.0, 249.0, 459.0, 460.0, 474.0, 574.0, 575.0, 355.0, 721.0, 740.0, 270.0, 587.0, 520.0, 572.0, 572.0, 706.0, 604.0, 436.0, 669.0, 735.0, 475.0, 565.0, 685.0, 749.0, 699.0, 635.0, 542.0, 590.0, 657.0, 400.0, 389.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-10.0, 10.0, 20.0, 9.0, 50.0, 8.0, 49.0, 60.0, 55.0, 30.0, 20.0, 20.0, 50.0, 60.0, 21.0, 50.0, 30.0, 70.0, 32.0, 70.0, 110.0, 20.0, 60.0, 60.0, 40.0, 40.0, 80.0, 40.0, 70.0, 90.0, 110.0, 30.0, 40.0, 50.0, 60.0, 50.0, 10.0, 30.0, 60.0, 20.0, 50.0, -5.0, 15.0, 30.0, 7.0, 52.0, 27.0, 30.0, 38.0, 3.0, 40.0, 30.0, 20.0, 12.0, 13.0, 40.0, 70.0, 70.0, 30.0, 70.0, 30.0, 80.0, 80.0, 60.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 20.0, 60.0, 60.0, 32.0, 40.0, 20.0, 10.0, 60.0, 25.0, 30.0, 60.0, 90.0, 10.0, 20.0, 20.0, 20.0, 50.0, 10.0, 40.0, 60.0, 20.0, 80.0, 90.0, 40.0, 70.0, 120.0, 80.0, 90.0, 130.0, 0.0, 0.0, 40.0, 30.0, 70.0, 70.0, 70.0, 50.0, 50.0, 30.0, 10.0, 79.0, 60.0, 50.0, 70.0, 40.0, 0.0, 20.0, 80.0, 60.0, 20.0, 50.0, 60.0, 70.0, 60.0, 70.0, 0.0, 90.0, 70.0, 30.0, 60.0, 30.0, 40.0, -10.0, 23.0, 30.0, 11.0, 60.0, 29.0, 30.0, 50.0, 10.0, 43.0, 100.0, 130.0, 16.0, 34.0, 317.0, 98.0, 84.0, 88.0, 50.0, 20.0, 50.0, 100.0, 30.0, 40.0, 30.0, 40.0, 100.0, 50.0, 79.0, 90.0, 50.0, 60.0, 100.0, 40.0, 20.0, 50.0, 40.0, 10.0, 80.0, 50.0, 54.0, 56.0, 64.0, 80.0, 39.0, 50.0, 19.0, 87.0, 8.0, 60.0, 30.0, -27.0, 6.0, 20.0, 50.0, 20.0, 60.0, 90.0, 100.0, 60.0, -5.0, 70.0, 90.0, 120.0, 10.0, 70.0, 36.0, 35.0, 40.0, 10.0, 63.0, 10.0, -5.0, 50.0, -3.0, 20.0, 40.0, 17.0, 30.0, 20.0, 110.0, 51.0, 80.0, 70.0, 10.0, 28.0, 148.0, 16.0, 20.0, 23.0, 22.0, 20.0, 50.0, 30.0, 40.0, 17.0, 0.0, 60.0, 100.0, 60.0, -7.0, 0.0, -27.0, 80.0, 17.0, 40.0, 33.0, 59.0, 38.0, 110.0, 40.0, 127.0, 50.0, -80.0, 70.0, 60.0, 66.0, 80.0, 70.0, 0.0, 120.0, 40.0, 40.0, 70.0, 60.0, 40.0, 60.0, 50.0, 30.0, 70.0, 0.0, -16.0, 60.0, -5.0, 16.0, 60.0, 100.0, 140.0, 70.0, 40.0, 80.0, 70.0, 30.0, 20.0, 80.0, 80.0, 50.0, 100.0, 30.0, 40.0, 40.0, 20.0, 40.0, 20.0, 30.0, 60.0, 30.0, 80.0, 40.0, 50.0, 60.0, 90.0, 10.0, 40.0, 60.0, 30.0, 120.0, 40.0, 48.0, 35.0, 19.0, 60.0, 40.0, 46.0, -13.0, 80.0, 80.0, 35.0, 56.0, 90.0, 19.0, 20.0, 36.0, 20.0, 110.0, 64.0, 47.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 40.0, 70.0, 50.0, 20.0, 30.0, 90.0, 30.0, 60.0, 20.0, 30.0, 27.0, 80.0, 110.0, 40.0, 78.0, 40.0, 50.0, 40.0, 12.0, 50.0, 10.0, 137.0, 50.0, 30.0, 60.0, 29.0, 60.0, 110.0, 0.0, 68.0, 120.0, 30.0, 30.0, 120.0, 120.0, 22.0, 10.0, 50.0, 9.0, 14.0, -31.0, 30.0, 6.0, -54.0, 16.0, 38.0, 30.0, 40.0, 17.0, 68.0, -5.0, 20.0, 47.0, 50.0, 10.0, 20.0, 70.0, 20.0, 100.0, 10.0, 30.0, 50.0, 90.0, 30.0, 30.0, 100.0, 40.0, 55.0, 80.0, 40.0, 50.0, 10.0, 8.0, -13.0, 80.0, 10.0, 60.0, 50.0, 20.0, 40.0, 31.0, 50.0, 40.0, 40.0, 50.0, 80.0, 40.0, 26.0, 18.0, 57.0, 60.0, 15.0, 30.0, 30.0, -2.0, 40.0, 30.0, 43.0, 44.0, 40.0, 50.0, 30.0, 110.0, 50.0, 100.0, 3.0, 70.0, 40.0, 40.0, 60.0, 3.0, 60.0, 40.0, 60.0, 20.0, 60.0, 50.0, 90.0, 30.0, 50.0, 59.0, 110.0, 60.0, 110.0, 50.0, 17.0, 70.0, 100.0, 33.0, -7.0, 60.0, 30.0, 60.0, 23.0, 60.0, 25.0, 70.0, 80.0, 80.0, 100.0, 100.0, 45.0, 31.0, 60.0, 70.0, 80.0, 90.0, 100.0, 70.0, 50.0, 10.0, 70.0, 70.0, 40.0, 10.0, 21.0, 40.0, 20.0, 32.0, 80.0, 20.0, 25.0, 30.0, 70.0, 120.0, 51.0, 50.0, 52.0, 45.0, 100.0, 15.0, 20.0, 100.0, 20.0, 20.0, 50.0, 70.0, 60.0, 120.0, 80.0, 50.0, 70.0, 50.0, 110.0, 60.0, 39.0, 50.0, 50.0, 130.0, 60.0, 60.0, 90.0, 20.0, 18.0, 30.0, 60.0, 60.0, 26.0, 70.0, 50.0, 25.0, 57.0, 50.0, 10.0, 40.0, 109.0, -14.0, 30.0, 2.0, 160.0, 11.0, 50.0, 100.0, 10.0, 16.0, 40.0, 80.0, 70.0, 17.0, 80.0, 50.0, 40.0, 70.0, 60.0, 30.0, 140.0, 50.0, 20.0, 50.0, 40.0, 60.0, 30.0, 40.0, 40.0, 40.0, 70.0, 50.0, 90.0, 80.0, 40.0, 80.0, 100.0, 10.0, 30.0, 80.0, -12.0, 50.0, 100.0, 16.0, 60.0, 90.0, 80.0, 30.0, 100.0, 30.0, 27.0, 60.0, 20.0, 16.0, 20.0, 150.0, 50.0, 15.0, 70.0, 12.0, 60.0, 100.0, 40.0, 50.0, 6.0, 20.0, 90.0, 6.0, 60.0, 116.0, -4.0, 60.0, 26.0, -17.0, 90.0, 17.0, 120.0, 13.0, 35.0, 50.0, 60.0, 100.0, 18.0, 56.0, 80.0, 60.0, 90.0, 40.0, 50.0, 70.0, 30.0, 20.0, 40.0, 45.0, 50.0, 80.0, 30.0, 14.0, 70.0, 20.0, 100.0, 21.0, 70.0, 46.0, 70.0, 40.0, 60.0, 100.0, 60.0, 20.0, 21.0, 68.0, 70.0, 20.0, 70.0, 68.0, 30.0, 100.0, 90.0, 49.0, 54.0, 100.0, 60.0, 40.0, 110.0, 40.0, 32.0, 60.0, 120.0, 40.0, 120.0, 60.0, 130.0, 80.0, 30.0, 30.0, 70.0, 30.0, 60.0, 70.0, 20.0, 70.0, 120.0, 80.0, 60.0, 70.0, 60.0, 40.0, 30.0, 50.0, 110.0, 70.0, 110.0, 80.0, 70.0, 30.0, 30.0, 40.0, 50.0, 30.0, 90.0, 30.0, 80.0, 50.0, 70.0, 90.0, 40.0, 20.0, 50.0, 100.0, -5.0, 10.0, 60.0, 8.0, 20.0, 66.0, 50.0, 10.0, 20.0, 10.0, 60.0, 50.0, 38.0, 48.0, 21.0, 10.0, 80.0, 69.0, 53.0, 30.0, 80.0, 10.0, 90.0, 60.0, 20.0, 20.0, 70.0, 30.0, 40.0, 40.0, 50.0, 50.0, 20.0, 13.0, 100.0, 1.0, 50.0, 20.0, 40.0, 130.0, 60.0, 120.0, 20.0, 50.0, 10.0, 28.0, 60.0, 110.0, 16.0, 100.0, 30.0, 40.0, 100.0, 70.0, 60.0, 85.0, 60.0, 40.0, 20.0, 70.0, -26.0, 30.0, 10.0, 110.0, 20.0, 70.0, -18.0, 40.0, 19.0, 100.0, 70.0, 110.0, 50.0, 100.0, 58.0, 78.0, 40.0, 130.0, 35.0, 50.0, 70.0, 120.0, 110.0, 160.0, 40.0, 60.0, 30.0, 80.0, 80.0, -10.0, 50.0, 0.0, 20.0, 5.0, 10.0, 30.0, 20.0, 5.0, 90.0, 40.0, 29.0, 29.0, 60.0, 39.0, 40.0, 120.0, 60.0, 80.0, 100.0, 30.0, 44.0, 20.0, 40.0, 26.0, 70.0, 20.0, 70.0, 40.0, 70.0, 120.0, 60.0, 70.0, -28.0, 30.0, 110.0, 100.0, 40.0, 70.0, 100.0, 20.0, 54.0, 37.0, 70.0, 47.0, 50.0, 110.0, 60.0, 6.0, 80.0, 58.0, 66.0, 50.0, 20.0, 70.0, 110.0, 136.0, 90.0, 130.0, 0.0, 34.0, 17.0, 17.0, 90.0, 40.0, 60.0, 60.0, 60.0, 90.0, 70.0, 100.0, 59.0, 110.0, 30.0, 90.0, 30.0, -20.0, 19.0, 120.0, 8.0, -10.0, 30.0, 60.0, 50.0, 80.0, 39.0, 30.0, 100.0, 130.0, 70.0, 80.0, 66.0, 90.0, 90.0, 31.0, 115.0, 59.0, 50.0, 170.0, 40.0, 24.0, 10.0, 10.0, 130.0, 85.0, 60.0, 60.0, 30.0, 40.0, 10.0, 40.0, 70.0, 70.0, 40.0, 90.0, 15.0, 80.0, 40.0, 30.0, 30.0, 100.0, 70.0, 73.0, 40.0, 60.0, 140.0, 40.0, 40.0, 70.0, 102.0, 50.0, 30.0, 40.0, 150.0, 50.0, 80.0, 70.0, 120.0, 70.0, 80.0, 59.0, 60.0, 89.0, 50.0, 40.0, 50.0, 80.0, 70.0, 40.0, 100.0, 120.0, 90.0, 40.0, 40.0, 30.0, 90.0, 17.0, 80.0, 58.0, 120.0, 70.0, 120.0, 40.0, 100.0, 6.0, 40.0, 30.0, 100.0, 10.0, 6.0, 90.0, 40.0, 40.0, 80.0, 90.0, 90.0, 40.0, 80.0, 90.0, 30.0, 10.0, 160.0, 60.0, 70.0, 120.0, 30.0, 70.0, 7.0, 50.0, 10.0, 80.0, 20.0, 10.0, 11.0, 110.0, 30.0, 60.0, 50.0, 20.0, 29.0, 60.0, 30.0, 140.0, 20.0, 20.0, 80.0, -17.0, 26.0, 30.0, 40.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5846647444056936, "mean_inference_ms": 2.749993766379307, "mean_action_processing_ms": 0.782715950671359, "mean_env_wait_ms": 1.8309403727502263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038065195083618164, "StateBufferConnector_ms": 0.022286653518676758, "ViewRequirementAgentConnector_ms": 0.8087575435638428}, "num_episodes": 18, "episode_return_max": 920.0, "episode_return_min": 72.0, "episode_return_mean": 512.43}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.060232857879008, "num_env_steps_trained_throughput_per_sec": 15.060232857879008, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 259759.926, "restore_workers_time_ms": 0.015, "training_step_time_ms": 259759.873, "sample_time_ms": 4489.228, "learn_time_ms": 255248.296, "learn_throughput": 15.671, "synch_weights_time_ms": 15.669}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 21, "trial_id": "1841f_00000", "date": "2024-08-08_00-50-23", "timestamp": 1723092623, "time_this_iter_s": 265.6097309589386, "time_total_s": 5409.01029086113, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x16f98a0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5409.01029086113, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 52.99946666666668, "ram_util_percent": 78.9456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7256877752221302, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.5746301343773625, "policy_loss": -0.01217053778900014, "vf_loss": 7.585133049714044, "vf_explained_var": 0.003418484923684686, "kl": 0.00833810612488563, "entropy": 1.0872660925467048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 201885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 920.0, "episode_reward_min": 72.0, "episode_reward_mean": 544.86, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 54.486}, "custom_metrics": {}, "hist_stats": {"episode_reward": [317.0, 586.0, 242.0, 563.0, 282.0, 355.0, 561.0, 550.0, 455.0, 620.0, 390.0, 540.0, 430.0, 492.0, 370.0, 565.0, 479.0, 687.0, 72.0, 315.0, 450.0, 450.0, 391.0, 354.0, 537.0, 396.0, 669.0, 446.0, 661.0, 590.0, 458.0, 473.0, 720.0, 547.0, 448.0, 474.0, 537.0, 510.0, 630.0, 544.0, 440.0, 548.0, 390.0, 624.0, 399.0, 587.0, 586.0, 656.0, 680.0, 600.0, 620.0, 620.0, 249.0, 459.0, 460.0, 474.0, 574.0, 575.0, 355.0, 721.0, 740.0, 270.0, 587.0, 520.0, 572.0, 572.0, 706.0, 604.0, 436.0, 669.0, 735.0, 475.0, 565.0, 685.0, 749.0, 699.0, 635.0, 542.0, 590.0, 657.0, 400.0, 389.0, 644.0, 646.0, 920.0, 810.0, 551.0, 524.0, 436.0, 910.0, 530.0, 524.0, 670.0, 760.0, 854.0, 626.0, 690.0, 626.0, 660.0, 535.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [8.0, 60.0, 30.0, -27.0, 6.0, 20.0, 50.0, 20.0, 60.0, 90.0, 100.0, 60.0, -5.0, 70.0, 90.0, 120.0, 10.0, 70.0, 36.0, 35.0, 40.0, 10.0, 63.0, 10.0, -5.0, 50.0, -3.0, 20.0, 40.0, 17.0, 30.0, 20.0, 110.0, 51.0, 80.0, 70.0, 10.0, 28.0, 148.0, 16.0, 20.0, 23.0, 22.0, 20.0, 50.0, 30.0, 40.0, 17.0, 0.0, 60.0, 100.0, 60.0, -7.0, 0.0, -27.0, 80.0, 17.0, 40.0, 33.0, 59.0, 38.0, 110.0, 40.0, 127.0, 50.0, -80.0, 70.0, 60.0, 66.0, 80.0, 70.0, 0.0, 120.0, 40.0, 40.0, 70.0, 60.0, 40.0, 60.0, 50.0, 30.0, 70.0, 0.0, -16.0, 60.0, -5.0, 16.0, 60.0, 100.0, 140.0, 70.0, 40.0, 80.0, 70.0, 30.0, 20.0, 80.0, 80.0, 50.0, 100.0, 30.0, 40.0, 40.0, 20.0, 40.0, 20.0, 30.0, 60.0, 30.0, 80.0, 40.0, 50.0, 60.0, 90.0, 10.0, 40.0, 60.0, 30.0, 120.0, 40.0, 48.0, 35.0, 19.0, 60.0, 40.0, 46.0, -13.0, 80.0, 80.0, 35.0, 56.0, 90.0, 19.0, 20.0, 36.0, 20.0, 110.0, 64.0, 47.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 40.0, 70.0, 50.0, 20.0, 30.0, 90.0, 30.0, 60.0, 20.0, 30.0, 27.0, 80.0, 110.0, 40.0, 78.0, 40.0, 50.0, 40.0, 12.0, 50.0, 10.0, 137.0, 50.0, 30.0, 60.0, 29.0, 60.0, 110.0, 0.0, 68.0, 120.0, 30.0, 30.0, 120.0, 120.0, 22.0, 10.0, 50.0, 9.0, 14.0, -31.0, 30.0, 6.0, -54.0, 16.0, 38.0, 30.0, 40.0, 17.0, 68.0, -5.0, 20.0, 47.0, 50.0, 10.0, 20.0, 70.0, 20.0, 100.0, 10.0, 30.0, 50.0, 90.0, 30.0, 30.0, 100.0, 40.0, 55.0, 80.0, 40.0, 50.0, 10.0, 8.0, -13.0, 80.0, 10.0, 60.0, 50.0, 20.0, 40.0, 31.0, 50.0, 40.0, 40.0, 50.0, 80.0, 40.0, 26.0, 18.0, 57.0, 60.0, 15.0, 30.0, 30.0, -2.0, 40.0, 30.0, 43.0, 44.0, 40.0, 50.0, 30.0, 110.0, 50.0, 100.0, 3.0, 70.0, 40.0, 40.0, 60.0, 3.0, 60.0, 40.0, 60.0, 20.0, 60.0, 50.0, 90.0, 30.0, 50.0, 59.0, 110.0, 60.0, 110.0, 50.0, 17.0, 70.0, 100.0, 33.0, -7.0, 60.0, 30.0, 60.0, 23.0, 60.0, 25.0, 70.0, 80.0, 80.0, 100.0, 100.0, 45.0, 31.0, 60.0, 70.0, 80.0, 90.0, 100.0, 70.0, 50.0, 10.0, 70.0, 70.0, 40.0, 10.0, 21.0, 40.0, 20.0, 32.0, 80.0, 20.0, 25.0, 30.0, 70.0, 120.0, 51.0, 50.0, 52.0, 45.0, 100.0, 15.0, 20.0, 100.0, 20.0, 20.0, 50.0, 70.0, 60.0, 120.0, 80.0, 50.0, 70.0, 50.0, 110.0, 60.0, 39.0, 50.0, 50.0, 130.0, 60.0, 60.0, 90.0, 20.0, 18.0, 30.0, 60.0, 60.0, 26.0, 70.0, 50.0, 25.0, 57.0, 50.0, 10.0, 40.0, 109.0, -14.0, 30.0, 2.0, 160.0, 11.0, 50.0, 100.0, 10.0, 16.0, 40.0, 80.0, 70.0, 17.0, 80.0, 50.0, 40.0, 70.0, 60.0, 30.0, 140.0, 50.0, 20.0, 50.0, 40.0, 60.0, 30.0, 40.0, 40.0, 40.0, 70.0, 50.0, 90.0, 80.0, 40.0, 80.0, 100.0, 10.0, 30.0, 80.0, -12.0, 50.0, 100.0, 16.0, 60.0, 90.0, 80.0, 30.0, 100.0, 30.0, 27.0, 60.0, 20.0, 16.0, 20.0, 150.0, 50.0, 15.0, 70.0, 12.0, 60.0, 100.0, 40.0, 50.0, 6.0, 20.0, 90.0, 6.0, 60.0, 116.0, -4.0, 60.0, 26.0, -17.0, 90.0, 17.0, 120.0, 13.0, 35.0, 50.0, 60.0, 100.0, 18.0, 56.0, 80.0, 60.0, 90.0, 40.0, 50.0, 70.0, 30.0, 20.0, 40.0, 45.0, 50.0, 80.0, 30.0, 14.0, 70.0, 20.0, 100.0, 21.0, 70.0, 46.0, 70.0, 40.0, 60.0, 100.0, 60.0, 20.0, 21.0, 68.0, 70.0, 20.0, 70.0, 68.0, 30.0, 100.0, 90.0, 49.0, 54.0, 100.0, 60.0, 40.0, 110.0, 40.0, 32.0, 60.0, 120.0, 40.0, 120.0, 60.0, 130.0, 80.0, 30.0, 30.0, 70.0, 30.0, 60.0, 70.0, 20.0, 70.0, 120.0, 80.0, 60.0, 70.0, 60.0, 40.0, 30.0, 50.0, 110.0, 70.0, 110.0, 80.0, 70.0, 30.0, 30.0, 40.0, 50.0, 30.0, 90.0, 30.0, 80.0, 50.0, 70.0, 90.0, 40.0, 20.0, 50.0, 100.0, -5.0, 10.0, 60.0, 8.0, 20.0, 66.0, 50.0, 10.0, 20.0, 10.0, 60.0, 50.0, 38.0, 48.0, 21.0, 10.0, 80.0, 69.0, 53.0, 30.0, 80.0, 10.0, 90.0, 60.0, 20.0, 20.0, 70.0, 30.0, 40.0, 40.0, 50.0, 50.0, 20.0, 13.0, 100.0, 1.0, 50.0, 20.0, 40.0, 130.0, 60.0, 120.0, 20.0, 50.0, 10.0, 28.0, 60.0, 110.0, 16.0, 100.0, 30.0, 40.0, 100.0, 70.0, 60.0, 85.0, 60.0, 40.0, 20.0, 70.0, -26.0, 30.0, 10.0, 110.0, 20.0, 70.0, -18.0, 40.0, 19.0, 100.0, 70.0, 110.0, 50.0, 100.0, 58.0, 78.0, 40.0, 130.0, 35.0, 50.0, 70.0, 120.0, 110.0, 160.0, 40.0, 60.0, 30.0, 80.0, 80.0, -10.0, 50.0, 0.0, 20.0, 5.0, 10.0, 30.0, 20.0, 5.0, 90.0, 40.0, 29.0, 29.0, 60.0, 39.0, 40.0, 120.0, 60.0, 80.0, 100.0, 30.0, 44.0, 20.0, 40.0, 26.0, 70.0, 20.0, 70.0, 40.0, 70.0, 120.0, 60.0, 70.0, -28.0, 30.0, 110.0, 100.0, 40.0, 70.0, 100.0, 20.0, 54.0, 37.0, 70.0, 47.0, 50.0, 110.0, 60.0, 6.0, 80.0, 58.0, 66.0, 50.0, 20.0, 70.0, 110.0, 136.0, 90.0, 130.0, 0.0, 34.0, 17.0, 17.0, 90.0, 40.0, 60.0, 60.0, 60.0, 90.0, 70.0, 100.0, 59.0, 110.0, 30.0, 90.0, 30.0, -20.0, 19.0, 120.0, 8.0, -10.0, 30.0, 60.0, 50.0, 80.0, 39.0, 30.0, 100.0, 130.0, 70.0, 80.0, 66.0, 90.0, 90.0, 31.0, 115.0, 59.0, 50.0, 170.0, 40.0, 24.0, 10.0, 10.0, 130.0, 85.0, 60.0, 60.0, 30.0, 40.0, 10.0, 40.0, 70.0, 70.0, 40.0, 90.0, 15.0, 80.0, 40.0, 30.0, 30.0, 100.0, 70.0, 73.0, 40.0, 60.0, 140.0, 40.0, 40.0, 70.0, 102.0, 50.0, 30.0, 40.0, 150.0, 50.0, 80.0, 70.0, 120.0, 70.0, 80.0, 59.0, 60.0, 89.0, 50.0, 40.0, 50.0, 80.0, 70.0, 40.0, 100.0, 120.0, 90.0, 40.0, 40.0, 30.0, 90.0, 17.0, 80.0, 58.0, 120.0, 70.0, 120.0, 40.0, 100.0, 6.0, 40.0, 30.0, 100.0, 10.0, 6.0, 90.0, 40.0, 40.0, 80.0, 90.0, 90.0, 40.0, 80.0, 90.0, 30.0, 10.0, 160.0, 60.0, 70.0, 120.0, 30.0, 70.0, 7.0, 50.0, 10.0, 80.0, 20.0, 10.0, 11.0, 110.0, 30.0, 60.0, 50.0, 20.0, 29.0, 60.0, 30.0, 140.0, 20.0, 20.0, 80.0, -17.0, 26.0, 30.0, 40.0, 20.0, 60.0, 47.0, 40.0, 80.0, 50.0, 37.0, 50.0, 70.0, 50.0, 160.0, 30.0, 58.0, 30.0, 80.0, 90.0, 60.0, 60.0, 40.0, 128.0, 70.0, 210.0, 100.0, 60.0, 70.0, 60.0, 80.0, 20.0, 80.0, 110.0, 130.0, 10.0, 120.0, 80.0, 70.0, 50.0, 110.0, 50.0, 60.0, 110.0, 150.0, 70.0, 20.0, 5.0, 170.0, 50.0, 150.0, 30.0, -4.0, 30.0, 30.0, 150.0, 13.0, 49.0, -8.0, 90.0, 60.0, 90.0, 10.0, 50.0, 20.0, 20.0, 119.0, 12.0, -1.0, 60.0, -4.0, 30.0, 80.0, 60.0, 60.0, 140.0, 90.0, 100.0, 130.0, 90.0, 80.0, 60.0, 70.0, 50.0, 100.0, 52.0, 40.0, 40.0, 10.0, 30.0, 30.0, 18.0, 100.0, 150.0, 60.0, 30.0, 74.0, 60.0, 60.0, 16.0, 60.0, 18.0, 60.0, 36.0, 110.0, 130.0, 50.0, 130.0, 38.0, 14.0, 64.0, 90.0, 50.0, 44.0, 60.0, 60.0, 130.0, 80.0, 50.0, 60.0, 60.0, 100.0, 70.0, 30.0, 120.0, 90.0, 45.0, 110.0, 150.0, 80.0, 140.0, 120.0, 59.0, 50.0, 10.0, 110.0, 66.0, 80.0, 7.0, 99.0, 60.0, 65.0, 40.0, 29.0, 70.0, 100.0, 20.0, 50.0, 10.0, 70.0, 50.0, 140.0, 60.0, 150.0, 40.0, 67.0, 90.0, 47.0, 90.0, 30.0, 50.0, 64.0, 90.0, 68.0, 30.0, 70.0, 60.0, 70.0, 60.0, 50.0, 90.0, 80.0, 40.0, 70.0, 70.0, 100.0, 70.0, 45.0, 40.0, 89.0, 19.0, 46.0, 30.0, 30.0, 66.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5861503674882327, "mean_inference_ms": 2.7575080090035486, "mean_action_processing_ms": 0.7828694040326774, "mean_env_wait_ms": 1.8307973072036086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03764748573303223, "StateBufferConnector_ms": 0.020761966705322266, "ViewRequirementAgentConnector_ms": 0.7671341896057129}, "num_episodes": 18, "episode_return_max": 920.0, "episode_return_min": 72.0, "episode_return_mean": 544.86}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.36484950408534, "num_env_steps_trained_throughput_per_sec": 20.36484950408534, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 253829.565, "restore_workers_time_ms": 0.015, "training_step_time_ms": 253829.512, "sample_time_ms": 4461.318, "learn_time_ms": 249346.071, "learn_throughput": 16.042, "synch_weights_time_ms": 15.388}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 22, "trial_id": "1841f_00000", "date": "2024-08-08_00-53-40", "timestamp": 1723092820, "time_this_iter_s": 196.42838978767395, "time_total_s": 5605.438680648804, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238c160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5605.438680648804, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.7, "ram_util_percent": 78.59496402877699}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7512740103327555, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4813351526554905, "policy_loss": -0.01277396371176504, "vf_loss": 7.492457602605525, "vf_explained_var": 0.00017347114281659437, "kl": 0.008257555894671765, "entropy": 1.073026959951947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 211275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 920.0, "episode_reward_min": 72.0, "episode_reward_mean": 566.12, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -54.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 56.612}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.0, 315.0, 450.0, 450.0, 391.0, 354.0, 537.0, 396.0, 669.0, 446.0, 661.0, 590.0, 458.0, 473.0, 720.0, 547.0, 448.0, 474.0, 537.0, 510.0, 630.0, 544.0, 440.0, 548.0, 390.0, 624.0, 399.0, 587.0, 586.0, 656.0, 680.0, 600.0, 620.0, 620.0, 249.0, 459.0, 460.0, 474.0, 574.0, 575.0, 355.0, 721.0, 740.0, 270.0, 587.0, 520.0, 572.0, 572.0, 706.0, 604.0, 436.0, 669.0, 735.0, 475.0, 565.0, 685.0, 749.0, 699.0, 635.0, 542.0, 590.0, 657.0, 400.0, 389.0, 644.0, 646.0, 920.0, 810.0, 551.0, 524.0, 436.0, 910.0, 530.0, 524.0, 670.0, 760.0, 854.0, 626.0, 690.0, 626.0, 660.0, 535.0, 343.0, 596.0, 569.0, 606.0, 749.0, 629.0, 545.0, 898.0, 705.0, 680.0, 757.0, 477.0, 515.0, 370.0, 396.0, 690.0, 564.0, 521.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [22.0, 10.0, 50.0, 9.0, 14.0, -31.0, 30.0, 6.0, -54.0, 16.0, 38.0, 30.0, 40.0, 17.0, 68.0, -5.0, 20.0, 47.0, 50.0, 10.0, 20.0, 70.0, 20.0, 100.0, 10.0, 30.0, 50.0, 90.0, 30.0, 30.0, 100.0, 40.0, 55.0, 80.0, 40.0, 50.0, 10.0, 8.0, -13.0, 80.0, 10.0, 60.0, 50.0, 20.0, 40.0, 31.0, 50.0, 40.0, 40.0, 50.0, 80.0, 40.0, 26.0, 18.0, 57.0, 60.0, 15.0, 30.0, 30.0, -2.0, 40.0, 30.0, 43.0, 44.0, 40.0, 50.0, 30.0, 110.0, 50.0, 100.0, 3.0, 70.0, 40.0, 40.0, 60.0, 3.0, 60.0, 40.0, 60.0, 20.0, 60.0, 50.0, 90.0, 30.0, 50.0, 59.0, 110.0, 60.0, 110.0, 50.0, 17.0, 70.0, 100.0, 33.0, -7.0, 60.0, 30.0, 60.0, 23.0, 60.0, 25.0, 70.0, 80.0, 80.0, 100.0, 100.0, 45.0, 31.0, 60.0, 70.0, 80.0, 90.0, 100.0, 70.0, 50.0, 10.0, 70.0, 70.0, 40.0, 10.0, 21.0, 40.0, 20.0, 32.0, 80.0, 20.0, 25.0, 30.0, 70.0, 120.0, 51.0, 50.0, 52.0, 45.0, 100.0, 15.0, 20.0, 100.0, 20.0, 20.0, 50.0, 70.0, 60.0, 120.0, 80.0, 50.0, 70.0, 50.0, 110.0, 60.0, 39.0, 50.0, 50.0, 130.0, 60.0, 60.0, 90.0, 20.0, 18.0, 30.0, 60.0, 60.0, 26.0, 70.0, 50.0, 25.0, 57.0, 50.0, 10.0, 40.0, 109.0, -14.0, 30.0, 2.0, 160.0, 11.0, 50.0, 100.0, 10.0, 16.0, 40.0, 80.0, 70.0, 17.0, 80.0, 50.0, 40.0, 70.0, 60.0, 30.0, 140.0, 50.0, 20.0, 50.0, 40.0, 60.0, 30.0, 40.0, 40.0, 40.0, 70.0, 50.0, 90.0, 80.0, 40.0, 80.0, 100.0, 10.0, 30.0, 80.0, -12.0, 50.0, 100.0, 16.0, 60.0, 90.0, 80.0, 30.0, 100.0, 30.0, 27.0, 60.0, 20.0, 16.0, 20.0, 150.0, 50.0, 15.0, 70.0, 12.0, 60.0, 100.0, 40.0, 50.0, 6.0, 20.0, 90.0, 6.0, 60.0, 116.0, -4.0, 60.0, 26.0, -17.0, 90.0, 17.0, 120.0, 13.0, 35.0, 50.0, 60.0, 100.0, 18.0, 56.0, 80.0, 60.0, 90.0, 40.0, 50.0, 70.0, 30.0, 20.0, 40.0, 45.0, 50.0, 80.0, 30.0, 14.0, 70.0, 20.0, 100.0, 21.0, 70.0, 46.0, 70.0, 40.0, 60.0, 100.0, 60.0, 20.0, 21.0, 68.0, 70.0, 20.0, 70.0, 68.0, 30.0, 100.0, 90.0, 49.0, 54.0, 100.0, 60.0, 40.0, 110.0, 40.0, 32.0, 60.0, 120.0, 40.0, 120.0, 60.0, 130.0, 80.0, 30.0, 30.0, 70.0, 30.0, 60.0, 70.0, 20.0, 70.0, 120.0, 80.0, 60.0, 70.0, 60.0, 40.0, 30.0, 50.0, 110.0, 70.0, 110.0, 80.0, 70.0, 30.0, 30.0, 40.0, 50.0, 30.0, 90.0, 30.0, 80.0, 50.0, 70.0, 90.0, 40.0, 20.0, 50.0, 100.0, -5.0, 10.0, 60.0, 8.0, 20.0, 66.0, 50.0, 10.0, 20.0, 10.0, 60.0, 50.0, 38.0, 48.0, 21.0, 10.0, 80.0, 69.0, 53.0, 30.0, 80.0, 10.0, 90.0, 60.0, 20.0, 20.0, 70.0, 30.0, 40.0, 40.0, 50.0, 50.0, 20.0, 13.0, 100.0, 1.0, 50.0, 20.0, 40.0, 130.0, 60.0, 120.0, 20.0, 50.0, 10.0, 28.0, 60.0, 110.0, 16.0, 100.0, 30.0, 40.0, 100.0, 70.0, 60.0, 85.0, 60.0, 40.0, 20.0, 70.0, -26.0, 30.0, 10.0, 110.0, 20.0, 70.0, -18.0, 40.0, 19.0, 100.0, 70.0, 110.0, 50.0, 100.0, 58.0, 78.0, 40.0, 130.0, 35.0, 50.0, 70.0, 120.0, 110.0, 160.0, 40.0, 60.0, 30.0, 80.0, 80.0, -10.0, 50.0, 0.0, 20.0, 5.0, 10.0, 30.0, 20.0, 5.0, 90.0, 40.0, 29.0, 29.0, 60.0, 39.0, 40.0, 120.0, 60.0, 80.0, 100.0, 30.0, 44.0, 20.0, 40.0, 26.0, 70.0, 20.0, 70.0, 40.0, 70.0, 120.0, 60.0, 70.0, -28.0, 30.0, 110.0, 100.0, 40.0, 70.0, 100.0, 20.0, 54.0, 37.0, 70.0, 47.0, 50.0, 110.0, 60.0, 6.0, 80.0, 58.0, 66.0, 50.0, 20.0, 70.0, 110.0, 136.0, 90.0, 130.0, 0.0, 34.0, 17.0, 17.0, 90.0, 40.0, 60.0, 60.0, 60.0, 90.0, 70.0, 100.0, 59.0, 110.0, 30.0, 90.0, 30.0, -20.0, 19.0, 120.0, 8.0, -10.0, 30.0, 60.0, 50.0, 80.0, 39.0, 30.0, 100.0, 130.0, 70.0, 80.0, 66.0, 90.0, 90.0, 31.0, 115.0, 59.0, 50.0, 170.0, 40.0, 24.0, 10.0, 10.0, 130.0, 85.0, 60.0, 60.0, 30.0, 40.0, 10.0, 40.0, 70.0, 70.0, 40.0, 90.0, 15.0, 80.0, 40.0, 30.0, 30.0, 100.0, 70.0, 73.0, 40.0, 60.0, 140.0, 40.0, 40.0, 70.0, 102.0, 50.0, 30.0, 40.0, 150.0, 50.0, 80.0, 70.0, 120.0, 70.0, 80.0, 59.0, 60.0, 89.0, 50.0, 40.0, 50.0, 80.0, 70.0, 40.0, 100.0, 120.0, 90.0, 40.0, 40.0, 30.0, 90.0, 17.0, 80.0, 58.0, 120.0, 70.0, 120.0, 40.0, 100.0, 6.0, 40.0, 30.0, 100.0, 10.0, 6.0, 90.0, 40.0, 40.0, 80.0, 90.0, 90.0, 40.0, 80.0, 90.0, 30.0, 10.0, 160.0, 60.0, 70.0, 120.0, 30.0, 70.0, 7.0, 50.0, 10.0, 80.0, 20.0, 10.0, 11.0, 110.0, 30.0, 60.0, 50.0, 20.0, 29.0, 60.0, 30.0, 140.0, 20.0, 20.0, 80.0, -17.0, 26.0, 30.0, 40.0, 20.0, 60.0, 47.0, 40.0, 80.0, 50.0, 37.0, 50.0, 70.0, 50.0, 160.0, 30.0, 58.0, 30.0, 80.0, 90.0, 60.0, 60.0, 40.0, 128.0, 70.0, 210.0, 100.0, 60.0, 70.0, 60.0, 80.0, 20.0, 80.0, 110.0, 130.0, 10.0, 120.0, 80.0, 70.0, 50.0, 110.0, 50.0, 60.0, 110.0, 150.0, 70.0, 20.0, 5.0, 170.0, 50.0, 150.0, 30.0, -4.0, 30.0, 30.0, 150.0, 13.0, 49.0, -8.0, 90.0, 60.0, 90.0, 10.0, 50.0, 20.0, 20.0, 119.0, 12.0, -1.0, 60.0, -4.0, 30.0, 80.0, 60.0, 60.0, 140.0, 90.0, 100.0, 130.0, 90.0, 80.0, 60.0, 70.0, 50.0, 100.0, 52.0, 40.0, 40.0, 10.0, 30.0, 30.0, 18.0, 100.0, 150.0, 60.0, 30.0, 74.0, 60.0, 60.0, 16.0, 60.0, 18.0, 60.0, 36.0, 110.0, 130.0, 50.0, 130.0, 38.0, 14.0, 64.0, 90.0, 50.0, 44.0, 60.0, 60.0, 130.0, 80.0, 50.0, 60.0, 60.0, 100.0, 70.0, 30.0, 120.0, 90.0, 45.0, 110.0, 150.0, 80.0, 140.0, 120.0, 59.0, 50.0, 10.0, 110.0, 66.0, 80.0, 7.0, 99.0, 60.0, 65.0, 40.0, 29.0, 70.0, 100.0, 20.0, 50.0, 10.0, 70.0, 50.0, 140.0, 60.0, 150.0, 40.0, 67.0, 90.0, 47.0, 90.0, 30.0, 50.0, 64.0, 90.0, 68.0, 30.0, 70.0, 60.0, 70.0, 60.0, 50.0, 90.0, 80.0, 40.0, 70.0, 70.0, 100.0, 70.0, 45.0, 40.0, 89.0, 19.0, 46.0, 30.0, 30.0, 66.0, 10.0, 10.0, 30.0, 20.0, 70.0, 70.0, 37.0, 30.0, 6.0, 60.0, 130.0, 130.0, 87.0, -6.0, 60.0, 39.0, 40.0, 40.0, 50.0, 26.0, 10.0, 60.0, 66.0, 80.0, 53.0, 100.0, 40.0, 10.0, 70.0, 80.0, 30.0, 140.0, 37.0, 20.0, 60.0, 60.0, 40.0, 70.0, 59.0, 90.0, 59.0, 30.0, 110.0, 60.0, 100.0, 80.0, 60.0, 20.0, 150.0, 80.0, 70.0, 110.0, 130.0, 30.0, 60.0, 130.0, 50.0, 23.0, 50.0, -24.0, 60.0, 50.0, 30.0, 8.0, 100.0, 80.0, 80.0, 40.0, 37.0, 60.0, 40.0, 100.0, 30.0, 170.0, 80.0, 160.0, 80.0, 48.0, 50.0, 140.0, 60.0, 110.0, 110.0, 110.0, -5.0, 70.0, 60.0, 110.0, 70.0, 10.0, 70.0, 70.0, 60.0, 50.0, 30.0, 80.0, 60.0, 80.0, 70.0, 110.0, 90.0, 90.0, 80.0, 49.0, 8.0, 110.0, 80.0, 70.0, 40.0, 140.0, 30.0, 50.0, 50.0, 0.0, 10.0, 50.0, 70.0, 80.0, 117.0, 20.0, 60.0, 60.0, 87.0, 40.0, 60.0, 100.0, 40.0, 20.0, 20.0, 28.0, 40.0, 30.0, 48.0, 40.0, 0.0, -10.0, 20.0, 90.0, 90.0, 22.0, 16.0, 23.0, 90.0, 70.0, 60.0, 17.0, 100.0, 0.0, -26.0, 46.0, 100.0, 140.0, 40.0, 80.0, 80.0, 30.0, 40.0, 40.0, 120.0, 20.0, 30.0, 120.0, 10.0, 40.0, 110.0, 80.0, 30.0, 34.0, 50.0, 60.0, 60.0, 60.0, 30.0, 25.0, 50.0, 30.0, 91.0, 100.0, 25.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5798133088526702, "mean_inference_ms": 2.7536595264547135, "mean_action_processing_ms": 0.7803448360546347, "mean_env_wait_ms": 1.8236466594300111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038694143295288086, "StateBufferConnector_ms": 0.020400047302246094, "ViewRequirementAgentConnector_ms": 0.7001821994781494}, "num_episodes": 18, "episode_return_max": 920.0, "episode_return_min": 72.0, "episode_return_mean": 566.12}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.599986143166802, "num_env_steps_trained_throughput_per_sec": 20.599986143166802, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 247404.186, "restore_workers_time_ms": 0.015, "training_step_time_ms": 247404.132, "sample_time_ms": 4325.596, "learn_time_ms": 243057.034, "learn_throughput": 16.457, "synch_weights_time_ms": 14.658}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 23, "trial_id": "1841f_00000", "date": "2024-08-08_00-56-54", "timestamp": 1723093014, "time_this_iter_s": 194.18497323989868, "time_total_s": 5799.623653888702, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24c39d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5799.623653888702, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.437591240875914, "ram_util_percent": 77.80620437956205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5783384704869143, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.491544954312114, "policy_loss": -0.013125279555491472, "vf_loss": 7.502911742782186, "vf_explained_var": 0.0006098831233125145, "kl": 0.00879246133527752, "entropy": 1.0498531991681352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 220665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 981.0, "episode_reward_min": 249.0, "episode_reward_mean": 608.78, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -28.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 60.878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [587.0, 586.0, 656.0, 680.0, 600.0, 620.0, 620.0, 249.0, 459.0, 460.0, 474.0, 574.0, 575.0, 355.0, 721.0, 740.0, 270.0, 587.0, 520.0, 572.0, 572.0, 706.0, 604.0, 436.0, 669.0, 735.0, 475.0, 565.0, 685.0, 749.0, 699.0, 635.0, 542.0, 590.0, 657.0, 400.0, 389.0, 644.0, 646.0, 920.0, 810.0, 551.0, 524.0, 436.0, 910.0, 530.0, 524.0, 670.0, 760.0, 854.0, 626.0, 690.0, 626.0, 660.0, 535.0, 343.0, 596.0, 569.0, 606.0, 749.0, 629.0, 545.0, 898.0, 705.0, 680.0, 757.0, 477.0, 515.0, 370.0, 396.0, 690.0, 564.0, 521.0, 708.0, 620.0, 642.0, 456.0, 574.0, 545.0, 650.0, 699.0, 590.0, 796.0, 482.0, 769.0, 719.0, 465.0, 610.0, 496.0, 418.0, 750.0, 856.0, 578.0, 710.0, 760.0, 750.0, 526.0, 981.0, 570.0, 619.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 21.0, 70.0, 46.0, 70.0, 40.0, 60.0, 100.0, 60.0, 20.0, 21.0, 68.0, 70.0, 20.0, 70.0, 68.0, 30.0, 100.0, 90.0, 49.0, 54.0, 100.0, 60.0, 40.0, 110.0, 40.0, 32.0, 60.0, 120.0, 40.0, 120.0, 60.0, 130.0, 80.0, 30.0, 30.0, 70.0, 30.0, 60.0, 70.0, 20.0, 70.0, 120.0, 80.0, 60.0, 70.0, 60.0, 40.0, 30.0, 50.0, 110.0, 70.0, 110.0, 80.0, 70.0, 30.0, 30.0, 40.0, 50.0, 30.0, 90.0, 30.0, 80.0, 50.0, 70.0, 90.0, 40.0, 20.0, 50.0, 100.0, -5.0, 10.0, 60.0, 8.0, 20.0, 66.0, 50.0, 10.0, 20.0, 10.0, 60.0, 50.0, 38.0, 48.0, 21.0, 10.0, 80.0, 69.0, 53.0, 30.0, 80.0, 10.0, 90.0, 60.0, 20.0, 20.0, 70.0, 30.0, 40.0, 40.0, 50.0, 50.0, 20.0, 13.0, 100.0, 1.0, 50.0, 20.0, 40.0, 130.0, 60.0, 120.0, 20.0, 50.0, 10.0, 28.0, 60.0, 110.0, 16.0, 100.0, 30.0, 40.0, 100.0, 70.0, 60.0, 85.0, 60.0, 40.0, 20.0, 70.0, -26.0, 30.0, 10.0, 110.0, 20.0, 70.0, -18.0, 40.0, 19.0, 100.0, 70.0, 110.0, 50.0, 100.0, 58.0, 78.0, 40.0, 130.0, 35.0, 50.0, 70.0, 120.0, 110.0, 160.0, 40.0, 60.0, 30.0, 80.0, 80.0, -10.0, 50.0, 0.0, 20.0, 5.0, 10.0, 30.0, 20.0, 5.0, 90.0, 40.0, 29.0, 29.0, 60.0, 39.0, 40.0, 120.0, 60.0, 80.0, 100.0, 30.0, 44.0, 20.0, 40.0, 26.0, 70.0, 20.0, 70.0, 40.0, 70.0, 120.0, 60.0, 70.0, -28.0, 30.0, 110.0, 100.0, 40.0, 70.0, 100.0, 20.0, 54.0, 37.0, 70.0, 47.0, 50.0, 110.0, 60.0, 6.0, 80.0, 58.0, 66.0, 50.0, 20.0, 70.0, 110.0, 136.0, 90.0, 130.0, 0.0, 34.0, 17.0, 17.0, 90.0, 40.0, 60.0, 60.0, 60.0, 90.0, 70.0, 100.0, 59.0, 110.0, 30.0, 90.0, 30.0, -20.0, 19.0, 120.0, 8.0, -10.0, 30.0, 60.0, 50.0, 80.0, 39.0, 30.0, 100.0, 130.0, 70.0, 80.0, 66.0, 90.0, 90.0, 31.0, 115.0, 59.0, 50.0, 170.0, 40.0, 24.0, 10.0, 10.0, 130.0, 85.0, 60.0, 60.0, 30.0, 40.0, 10.0, 40.0, 70.0, 70.0, 40.0, 90.0, 15.0, 80.0, 40.0, 30.0, 30.0, 100.0, 70.0, 73.0, 40.0, 60.0, 140.0, 40.0, 40.0, 70.0, 102.0, 50.0, 30.0, 40.0, 150.0, 50.0, 80.0, 70.0, 120.0, 70.0, 80.0, 59.0, 60.0, 89.0, 50.0, 40.0, 50.0, 80.0, 70.0, 40.0, 100.0, 120.0, 90.0, 40.0, 40.0, 30.0, 90.0, 17.0, 80.0, 58.0, 120.0, 70.0, 120.0, 40.0, 100.0, 6.0, 40.0, 30.0, 100.0, 10.0, 6.0, 90.0, 40.0, 40.0, 80.0, 90.0, 90.0, 40.0, 80.0, 90.0, 30.0, 10.0, 160.0, 60.0, 70.0, 120.0, 30.0, 70.0, 7.0, 50.0, 10.0, 80.0, 20.0, 10.0, 11.0, 110.0, 30.0, 60.0, 50.0, 20.0, 29.0, 60.0, 30.0, 140.0, 20.0, 20.0, 80.0, -17.0, 26.0, 30.0, 40.0, 20.0, 60.0, 47.0, 40.0, 80.0, 50.0, 37.0, 50.0, 70.0, 50.0, 160.0, 30.0, 58.0, 30.0, 80.0, 90.0, 60.0, 60.0, 40.0, 128.0, 70.0, 210.0, 100.0, 60.0, 70.0, 60.0, 80.0, 20.0, 80.0, 110.0, 130.0, 10.0, 120.0, 80.0, 70.0, 50.0, 110.0, 50.0, 60.0, 110.0, 150.0, 70.0, 20.0, 5.0, 170.0, 50.0, 150.0, 30.0, -4.0, 30.0, 30.0, 150.0, 13.0, 49.0, -8.0, 90.0, 60.0, 90.0, 10.0, 50.0, 20.0, 20.0, 119.0, 12.0, -1.0, 60.0, -4.0, 30.0, 80.0, 60.0, 60.0, 140.0, 90.0, 100.0, 130.0, 90.0, 80.0, 60.0, 70.0, 50.0, 100.0, 52.0, 40.0, 40.0, 10.0, 30.0, 30.0, 18.0, 100.0, 150.0, 60.0, 30.0, 74.0, 60.0, 60.0, 16.0, 60.0, 18.0, 60.0, 36.0, 110.0, 130.0, 50.0, 130.0, 38.0, 14.0, 64.0, 90.0, 50.0, 44.0, 60.0, 60.0, 130.0, 80.0, 50.0, 60.0, 60.0, 100.0, 70.0, 30.0, 120.0, 90.0, 45.0, 110.0, 150.0, 80.0, 140.0, 120.0, 59.0, 50.0, 10.0, 110.0, 66.0, 80.0, 7.0, 99.0, 60.0, 65.0, 40.0, 29.0, 70.0, 100.0, 20.0, 50.0, 10.0, 70.0, 50.0, 140.0, 60.0, 150.0, 40.0, 67.0, 90.0, 47.0, 90.0, 30.0, 50.0, 64.0, 90.0, 68.0, 30.0, 70.0, 60.0, 70.0, 60.0, 50.0, 90.0, 80.0, 40.0, 70.0, 70.0, 100.0, 70.0, 45.0, 40.0, 89.0, 19.0, 46.0, 30.0, 30.0, 66.0, 10.0, 10.0, 30.0, 20.0, 70.0, 70.0, 37.0, 30.0, 6.0, 60.0, 130.0, 130.0, 87.0, -6.0, 60.0, 39.0, 40.0, 40.0, 50.0, 26.0, 10.0, 60.0, 66.0, 80.0, 53.0, 100.0, 40.0, 10.0, 70.0, 80.0, 30.0, 140.0, 37.0, 20.0, 60.0, 60.0, 40.0, 70.0, 59.0, 90.0, 59.0, 30.0, 110.0, 60.0, 100.0, 80.0, 60.0, 20.0, 150.0, 80.0, 70.0, 110.0, 130.0, 30.0, 60.0, 130.0, 50.0, 23.0, 50.0, -24.0, 60.0, 50.0, 30.0, 8.0, 100.0, 80.0, 80.0, 40.0, 37.0, 60.0, 40.0, 100.0, 30.0, 170.0, 80.0, 160.0, 80.0, 48.0, 50.0, 140.0, 60.0, 110.0, 110.0, 110.0, -5.0, 70.0, 60.0, 110.0, 70.0, 10.0, 70.0, 70.0, 60.0, 50.0, 30.0, 80.0, 60.0, 80.0, 70.0, 110.0, 90.0, 90.0, 80.0, 49.0, 8.0, 110.0, 80.0, 70.0, 40.0, 140.0, 30.0, 50.0, 50.0, 0.0, 10.0, 50.0, 70.0, 80.0, 117.0, 20.0, 60.0, 60.0, 87.0, 40.0, 60.0, 100.0, 40.0, 20.0, 20.0, 28.0, 40.0, 30.0, 48.0, 40.0, 0.0, -10.0, 20.0, 90.0, 90.0, 22.0, 16.0, 23.0, 90.0, 70.0, 60.0, 17.0, 100.0, 0.0, -26.0, 46.0, 100.0, 140.0, 40.0, 80.0, 80.0, 30.0, 40.0, 40.0, 120.0, 20.0, 30.0, 120.0, 10.0, 40.0, 110.0, 80.0, 30.0, 34.0, 50.0, 60.0, 60.0, 60.0, 30.0, 25.0, 50.0, 30.0, 91.0, 100.0, 25.0, 50.0, 120.0, 20.0, 50.0, 20.0, 110.0, 99.0, 100.0, 80.0, 29.0, 80.0, 60.0, 80.0, 30.0, 107.0, 70.0, 37.0, 40.0, 50.0, 80.0, 66.0, 60.0, 70.0, 120.0, 50.0, 120.0, 18.0, 50.0, 60.0, 80.0, 14.0, 10.0, 55.0, 38.0, 70.0, 50.0, 40.0, 13.0, 40.0, 50.0, 90.0, 48.0, -3.0, 80.0, 110.0, 39.0, 80.0, 30.0, 70.0, 70.0, 50.0, 20.0, 90.0, 75.0, 20.0, 100.0, 10.0, 60.0, 20.0, 50.0, 100.0, 50.0, 60.0, 70.0, 60.0, 60.0, 70.0, 80.0, 70.0, 60.0, 70.0, 98.0, 80.0, 80.0, 40.0, 60.0, 130.0, 45.0, 50.0, 56.0, 60.0, 40.0, 20.0, 40.0, -3.0, 50.0, 13.0, 100.0, 140.0, 60.0, 130.0, 120.0, 24.0, 30.0, 120.0, 40.0, 130.0, 43.0, 130.0, 89.0, 70.0, 70.0, 49.0, 70.0, 30.0, 40.0, 30.0, 28.0, 80.0, 70.0, 15.0, 120.0, 50.0, 70.0, 70.0, 18.0, 64.0, 170.0, 60.0, 100.0, 47.0, 90.0, 100.0, 110.0, 17.0, 90.0, 10.0, 5.0, 150.0, 47.0, 100.0, 20.0, 19.0, 30.0, 25.0, 90.0, 55.0, 60.0, 36.0, 60.0, 70.0, 60.0, 10.0, 70.0, 80.0, 30.0, 90.0, 60.0, 80.0, 10.0, 120.0, 50.0, 50.0, 23.0, 10.0, 100.0, 13.0, 40.0, 60.0, 50.0, 100.0, 90.0, 20.0, 60.0, 20.0, 15.0, 3.0, 20.0, 60.0, 70.0, 60.0, 120.0, 60.0, 110.0, 70.0, 70.0, 90.0, 60.0, 30.0, 70.0, 70.0, 50.0, 77.0, 120.0, 99.0, 80.0, 100.0, 130.0, 40.0, 60.0, 100.0, 0.0, 120.0, 20.0, 100.0, 30.0, 90.0, 20.0, 15.0, 123.0, 60.0, 110.0, 20.0, 130.0, 70.0, 20.0, 60.0, 170.0, 60.0, 50.0, 20.0, 120.0, 35.0, 100.0, 50.0, 5.0, 50.0, 110.0, 160.0, 30.0, 100.0, 40.0, 110.0, 50.0, 60.0, 100.0, 110.0, 110.0, 20.0, 70.0, 80.0, 90.0, 26.0, -18.0, 60.0, 80.0, 80.0, 70.0, 50.0, 53.0, 35.0, -17.0, 78.0, 80.0, 140.0, 70.0, 190.0, 100.0, 110.0, 100.0, 130.0, 20.0, 50.0, 60.0, 40.0, 80.0, 70.0, 40.0, 50.0, 80.0, 80.0, 60.0, 50.0, 50.0, 60.0, 56.0, 13.0, 50.0, 90.0, 180.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.563673074839035, "mean_inference_ms": 2.732290167060845, "mean_action_processing_ms": 0.7724394807099856, "mean_env_wait_ms": 1.8068362756412666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03697323799133301, "StateBufferConnector_ms": 0.015124082565307617, "ViewRequirementAgentConnector_ms": 0.581256628036499}, "num_episodes": 27, "episode_return_max": 981.0, "episode_return_min": 249.0, "episode_return_mean": 608.78}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.44972055908658, "num_env_steps_trained_throughput_per_sec": 20.44972055908658, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 241038.411, "restore_workers_time_ms": 0.015, "training_step_time_ms": 241038.356, "sample_time_ms": 4085.252, "learn_time_ms": 236931.5, "learn_throughput": 16.883, "synch_weights_time_ms": 14.909}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 24, "trial_id": "1841f_00000", "date": "2024-08-08_01-00-10", "timestamp": 1723093210, "time_this_iter_s": 195.61258482933044, "time_total_s": 5995.236238718033, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b249c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5995.236238718033, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 27.396028880866425, "ram_util_percent": 79.09386281588448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6619188052968097, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.7033507167848665, "policy_loss": -0.013421977705573138, "vf_loss": 7.715024217833092, "vf_explained_var": 0.0019923415872108697, "kl": 0.008742419284077197, "entropy": 1.0377339256901583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 230055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 981.0, "episode_reward_min": 143.0, "episode_reward_mean": 619.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -99.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 61.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.0, 572.0, 572.0, 706.0, 604.0, 436.0, 669.0, 735.0, 475.0, 565.0, 685.0, 749.0, 699.0, 635.0, 542.0, 590.0, 657.0, 400.0, 389.0, 644.0, 646.0, 920.0, 810.0, 551.0, 524.0, 436.0, 910.0, 530.0, 524.0, 670.0, 760.0, 854.0, 626.0, 690.0, 626.0, 660.0, 535.0, 343.0, 596.0, 569.0, 606.0, 749.0, 629.0, 545.0, 898.0, 705.0, 680.0, 757.0, 477.0, 515.0, 370.0, 396.0, 690.0, 564.0, 521.0, 708.0, 620.0, 642.0, 456.0, 574.0, 545.0, 650.0, 699.0, 590.0, 796.0, 482.0, 769.0, 719.0, 465.0, 610.0, 496.0, 418.0, 750.0, 856.0, 578.0, 710.0, 760.0, 750.0, 526.0, 981.0, 570.0, 619.0, 526.0, 413.0, 763.0, 664.0, 777.0, 143.0, 664.0, 717.0, 796.0, 592.0, 335.0, 951.0, 768.0, 556.0, 400.0, 653.0, 620.0, 547.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [44.0, 20.0, 40.0, 26.0, 70.0, 20.0, 70.0, 40.0, 70.0, 120.0, 60.0, 70.0, -28.0, 30.0, 110.0, 100.0, 40.0, 70.0, 100.0, 20.0, 54.0, 37.0, 70.0, 47.0, 50.0, 110.0, 60.0, 6.0, 80.0, 58.0, 66.0, 50.0, 20.0, 70.0, 110.0, 136.0, 90.0, 130.0, 0.0, 34.0, 17.0, 17.0, 90.0, 40.0, 60.0, 60.0, 60.0, 90.0, 70.0, 100.0, 59.0, 110.0, 30.0, 90.0, 30.0, -20.0, 19.0, 120.0, 8.0, -10.0, 30.0, 60.0, 50.0, 80.0, 39.0, 30.0, 100.0, 130.0, 70.0, 80.0, 66.0, 90.0, 90.0, 31.0, 115.0, 59.0, 50.0, 170.0, 40.0, 24.0, 10.0, 10.0, 130.0, 85.0, 60.0, 60.0, 30.0, 40.0, 10.0, 40.0, 70.0, 70.0, 40.0, 90.0, 15.0, 80.0, 40.0, 30.0, 30.0, 100.0, 70.0, 73.0, 40.0, 60.0, 140.0, 40.0, 40.0, 70.0, 102.0, 50.0, 30.0, 40.0, 150.0, 50.0, 80.0, 70.0, 120.0, 70.0, 80.0, 59.0, 60.0, 89.0, 50.0, 40.0, 50.0, 80.0, 70.0, 40.0, 100.0, 120.0, 90.0, 40.0, 40.0, 30.0, 90.0, 17.0, 80.0, 58.0, 120.0, 70.0, 120.0, 40.0, 100.0, 6.0, 40.0, 30.0, 100.0, 10.0, 6.0, 90.0, 40.0, 40.0, 80.0, 90.0, 90.0, 40.0, 80.0, 90.0, 30.0, 10.0, 160.0, 60.0, 70.0, 120.0, 30.0, 70.0, 7.0, 50.0, 10.0, 80.0, 20.0, 10.0, 11.0, 110.0, 30.0, 60.0, 50.0, 20.0, 29.0, 60.0, 30.0, 140.0, 20.0, 20.0, 80.0, -17.0, 26.0, 30.0, 40.0, 20.0, 60.0, 47.0, 40.0, 80.0, 50.0, 37.0, 50.0, 70.0, 50.0, 160.0, 30.0, 58.0, 30.0, 80.0, 90.0, 60.0, 60.0, 40.0, 128.0, 70.0, 210.0, 100.0, 60.0, 70.0, 60.0, 80.0, 20.0, 80.0, 110.0, 130.0, 10.0, 120.0, 80.0, 70.0, 50.0, 110.0, 50.0, 60.0, 110.0, 150.0, 70.0, 20.0, 5.0, 170.0, 50.0, 150.0, 30.0, -4.0, 30.0, 30.0, 150.0, 13.0, 49.0, -8.0, 90.0, 60.0, 90.0, 10.0, 50.0, 20.0, 20.0, 119.0, 12.0, -1.0, 60.0, -4.0, 30.0, 80.0, 60.0, 60.0, 140.0, 90.0, 100.0, 130.0, 90.0, 80.0, 60.0, 70.0, 50.0, 100.0, 52.0, 40.0, 40.0, 10.0, 30.0, 30.0, 18.0, 100.0, 150.0, 60.0, 30.0, 74.0, 60.0, 60.0, 16.0, 60.0, 18.0, 60.0, 36.0, 110.0, 130.0, 50.0, 130.0, 38.0, 14.0, 64.0, 90.0, 50.0, 44.0, 60.0, 60.0, 130.0, 80.0, 50.0, 60.0, 60.0, 100.0, 70.0, 30.0, 120.0, 90.0, 45.0, 110.0, 150.0, 80.0, 140.0, 120.0, 59.0, 50.0, 10.0, 110.0, 66.0, 80.0, 7.0, 99.0, 60.0, 65.0, 40.0, 29.0, 70.0, 100.0, 20.0, 50.0, 10.0, 70.0, 50.0, 140.0, 60.0, 150.0, 40.0, 67.0, 90.0, 47.0, 90.0, 30.0, 50.0, 64.0, 90.0, 68.0, 30.0, 70.0, 60.0, 70.0, 60.0, 50.0, 90.0, 80.0, 40.0, 70.0, 70.0, 100.0, 70.0, 45.0, 40.0, 89.0, 19.0, 46.0, 30.0, 30.0, 66.0, 10.0, 10.0, 30.0, 20.0, 70.0, 70.0, 37.0, 30.0, 6.0, 60.0, 130.0, 130.0, 87.0, -6.0, 60.0, 39.0, 40.0, 40.0, 50.0, 26.0, 10.0, 60.0, 66.0, 80.0, 53.0, 100.0, 40.0, 10.0, 70.0, 80.0, 30.0, 140.0, 37.0, 20.0, 60.0, 60.0, 40.0, 70.0, 59.0, 90.0, 59.0, 30.0, 110.0, 60.0, 100.0, 80.0, 60.0, 20.0, 150.0, 80.0, 70.0, 110.0, 130.0, 30.0, 60.0, 130.0, 50.0, 23.0, 50.0, -24.0, 60.0, 50.0, 30.0, 8.0, 100.0, 80.0, 80.0, 40.0, 37.0, 60.0, 40.0, 100.0, 30.0, 170.0, 80.0, 160.0, 80.0, 48.0, 50.0, 140.0, 60.0, 110.0, 110.0, 110.0, -5.0, 70.0, 60.0, 110.0, 70.0, 10.0, 70.0, 70.0, 60.0, 50.0, 30.0, 80.0, 60.0, 80.0, 70.0, 110.0, 90.0, 90.0, 80.0, 49.0, 8.0, 110.0, 80.0, 70.0, 40.0, 140.0, 30.0, 50.0, 50.0, 0.0, 10.0, 50.0, 70.0, 80.0, 117.0, 20.0, 60.0, 60.0, 87.0, 40.0, 60.0, 100.0, 40.0, 20.0, 20.0, 28.0, 40.0, 30.0, 48.0, 40.0, 0.0, -10.0, 20.0, 90.0, 90.0, 22.0, 16.0, 23.0, 90.0, 70.0, 60.0, 17.0, 100.0, 0.0, -26.0, 46.0, 100.0, 140.0, 40.0, 80.0, 80.0, 30.0, 40.0, 40.0, 120.0, 20.0, 30.0, 120.0, 10.0, 40.0, 110.0, 80.0, 30.0, 34.0, 50.0, 60.0, 60.0, 60.0, 30.0, 25.0, 50.0, 30.0, 91.0, 100.0, 25.0, 50.0, 120.0, 20.0, 50.0, 20.0, 110.0, 99.0, 100.0, 80.0, 29.0, 80.0, 60.0, 80.0, 30.0, 107.0, 70.0, 37.0, 40.0, 50.0, 80.0, 66.0, 60.0, 70.0, 120.0, 50.0, 120.0, 18.0, 50.0, 60.0, 80.0, 14.0, 10.0, 55.0, 38.0, 70.0, 50.0, 40.0, 13.0, 40.0, 50.0, 90.0, 48.0, -3.0, 80.0, 110.0, 39.0, 80.0, 30.0, 70.0, 70.0, 50.0, 20.0, 90.0, 75.0, 20.0, 100.0, 10.0, 60.0, 20.0, 50.0, 100.0, 50.0, 60.0, 70.0, 60.0, 60.0, 70.0, 80.0, 70.0, 60.0, 70.0, 98.0, 80.0, 80.0, 40.0, 60.0, 130.0, 45.0, 50.0, 56.0, 60.0, 40.0, 20.0, 40.0, -3.0, 50.0, 13.0, 100.0, 140.0, 60.0, 130.0, 120.0, 24.0, 30.0, 120.0, 40.0, 130.0, 43.0, 130.0, 89.0, 70.0, 70.0, 49.0, 70.0, 30.0, 40.0, 30.0, 28.0, 80.0, 70.0, 15.0, 120.0, 50.0, 70.0, 70.0, 18.0, 64.0, 170.0, 60.0, 100.0, 47.0, 90.0, 100.0, 110.0, 17.0, 90.0, 10.0, 5.0, 150.0, 47.0, 100.0, 20.0, 19.0, 30.0, 25.0, 90.0, 55.0, 60.0, 36.0, 60.0, 70.0, 60.0, 10.0, 70.0, 80.0, 30.0, 90.0, 60.0, 80.0, 10.0, 120.0, 50.0, 50.0, 23.0, 10.0, 100.0, 13.0, 40.0, 60.0, 50.0, 100.0, 90.0, 20.0, 60.0, 20.0, 15.0, 3.0, 20.0, 60.0, 70.0, 60.0, 120.0, 60.0, 110.0, 70.0, 70.0, 90.0, 60.0, 30.0, 70.0, 70.0, 50.0, 77.0, 120.0, 99.0, 80.0, 100.0, 130.0, 40.0, 60.0, 100.0, 0.0, 120.0, 20.0, 100.0, 30.0, 90.0, 20.0, 15.0, 123.0, 60.0, 110.0, 20.0, 130.0, 70.0, 20.0, 60.0, 170.0, 60.0, 50.0, 20.0, 120.0, 35.0, 100.0, 50.0, 5.0, 50.0, 110.0, 160.0, 30.0, 100.0, 40.0, 110.0, 50.0, 60.0, 100.0, 110.0, 110.0, 20.0, 70.0, 80.0, 90.0, 26.0, -18.0, 60.0, 80.0, 80.0, 70.0, 50.0, 53.0, 35.0, -17.0, 78.0, 80.0, 140.0, 70.0, 190.0, 100.0, 110.0, 100.0, 130.0, 20.0, 50.0, 60.0, 40.0, 80.0, 70.0, 40.0, 50.0, 80.0, 80.0, 60.0, 50.0, 50.0, 60.0, 56.0, 13.0, 50.0, 90.0, 180.0, 10.0, 30.0, 140.0, 70.0, 40.0, 50.0, 100.0, 32.0, -3.0, 17.0, 50.0, 15.0, 70.0, 80.0, -3.0, 57.0, 80.0, 31.0, 35.0, 16.0, 32.0, 126.0, 37.0, 70.0, 80.0, 90.0, 130.0, 70.0, 90.0, 70.0, 0.0, 130.0, 99.0, 40.0, 20.0, 150.0, 5.0, 20.0, 50.0, 60.0, 90.0, 30.0, 100.0, 130.0, 110.0, 88.0, 60.0, 50.0, 80.0, 60.0, 69.0, 0.0, -1.0, -14.0, -42.0, 40.0, 10.0, 30.0, 100.0, 0.0, 20.0, 100.0, 90.0, 90.0, 120.0, 70.0, 15.0, 50.0, 49.0, 90.0, -10.0, 101.0, 20.0, 140.0, 28.0, 150.0, 40.0, 69.0, 49.0, 60.0, 60.0, 80.0, 140.0, 40.0, 60.0, 80.0, 6.0, 130.0, 120.0, 60.0, 80.0, 15.0, 34.0, 60.0, 70.0, -17.0, 60.0, 70.0, 100.0, 70.0, 130.0, 70.0, 70.0, 70.0, -4.0, 13.0, 46.0, 80.0, -25.0, 19.0, -4.0, 82.0, 60.0, 90.0, 140.0, 60.0, 60.0, 110.0, 120.0, 114.0, 115.0, 28.0, 40.0, 120.0, 120.0, 80.0, 67.0, 57.0, 120.0, 86.0, 50.0, 10.0, 78.0, 70.0, 90.0, 50.0, 70.0, 8.0, 60.0, 20.0, 100.0, 50.0, 120.0, 60.0, -32.0, 41.0, 35.0, 60.0, 30.0, 6.0, 30.0, 140.0, 12.0, 60.0, 110.0, 90.0, 70.0, 70.0, 1.0, 60.0, 40.0, 60.0, 20.0, 90.0, 60.0, 160.0, -40.0, 100.0, 100.0, 50.0, 20.0, 80.0, 60.0, 96.0, 180.0, 25.0, 30.0, -99.0, 5.0, 110.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5359772068261743, "mean_inference_ms": 2.7028848914381394, "mean_action_processing_ms": 0.7627178024760002, "mean_env_wait_ms": 1.7839679930120855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01519465446472168, "StateBufferConnector_ms": 0.010567665100097656, "ViewRequirementAgentConnector_ms": 0.49952101707458496}, "num_episodes": 18, "episode_return_max": 981.0, "episode_return_min": 143.0, "episode_return_mean": 619.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.257904692449983, "num_env_steps_trained_throughput_per_sec": 20.257904692449983, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 235248.206, "restore_workers_time_ms": 0.015, "training_step_time_ms": 235248.151, "sample_time_ms": 3863.827, "learn_time_ms": 231361.888, "learn_throughput": 17.289, "synch_weights_time_ms": 15.498}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 25, "trial_id": "1841f_00000", "date": "2024-08-08_01-03-27", "timestamp": 1723093407, "time_this_iter_s": 197.46441793441772, "time_total_s": 6192.700656652451, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24c3e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6192.700656652451, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 27.190357142857142, "ram_util_percent": 79.6725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.739679701373981, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.699514242025991, "policy_loss": -0.013582909910015255, "vf_loss": 7.711365915284243, "vf_explained_var": 0.002955935278131812, "kl": 0.008656208862990244, "entropy": 1.0357597914176246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 239445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 981.0, "episode_reward_min": 143.0, "episode_reward_mean": 627.09, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -99.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 62.709}, "custom_metrics": {}, "hist_stats": {"episode_reward": [389.0, 644.0, 646.0, 920.0, 810.0, 551.0, 524.0, 436.0, 910.0, 530.0, 524.0, 670.0, 760.0, 854.0, 626.0, 690.0, 626.0, 660.0, 535.0, 343.0, 596.0, 569.0, 606.0, 749.0, 629.0, 545.0, 898.0, 705.0, 680.0, 757.0, 477.0, 515.0, 370.0, 396.0, 690.0, 564.0, 521.0, 708.0, 620.0, 642.0, 456.0, 574.0, 545.0, 650.0, 699.0, 590.0, 796.0, 482.0, 769.0, 719.0, 465.0, 610.0, 496.0, 418.0, 750.0, 856.0, 578.0, 710.0, 760.0, 750.0, 526.0, 981.0, 570.0, 619.0, 526.0, 413.0, 763.0, 664.0, 777.0, 143.0, 664.0, 717.0, 796.0, 592.0, 335.0, 951.0, 768.0, 556.0, 400.0, 653.0, 620.0, 547.0, 635.0, 340.0, 867.0, 650.0, 686.0, 571.0, 740.0, 680.0, 868.0, 610.0, 268.0, 482.0, 476.0, 853.0, 665.0, 774.0, 813.0, 592.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 140.0, 20.0, 20.0, 80.0, -17.0, 26.0, 30.0, 40.0, 20.0, 60.0, 47.0, 40.0, 80.0, 50.0, 37.0, 50.0, 70.0, 50.0, 160.0, 30.0, 58.0, 30.0, 80.0, 90.0, 60.0, 60.0, 40.0, 128.0, 70.0, 210.0, 100.0, 60.0, 70.0, 60.0, 80.0, 20.0, 80.0, 110.0, 130.0, 10.0, 120.0, 80.0, 70.0, 50.0, 110.0, 50.0, 60.0, 110.0, 150.0, 70.0, 20.0, 5.0, 170.0, 50.0, 150.0, 30.0, -4.0, 30.0, 30.0, 150.0, 13.0, 49.0, -8.0, 90.0, 60.0, 90.0, 10.0, 50.0, 20.0, 20.0, 119.0, 12.0, -1.0, 60.0, -4.0, 30.0, 80.0, 60.0, 60.0, 140.0, 90.0, 100.0, 130.0, 90.0, 80.0, 60.0, 70.0, 50.0, 100.0, 52.0, 40.0, 40.0, 10.0, 30.0, 30.0, 18.0, 100.0, 150.0, 60.0, 30.0, 74.0, 60.0, 60.0, 16.0, 60.0, 18.0, 60.0, 36.0, 110.0, 130.0, 50.0, 130.0, 38.0, 14.0, 64.0, 90.0, 50.0, 44.0, 60.0, 60.0, 130.0, 80.0, 50.0, 60.0, 60.0, 100.0, 70.0, 30.0, 120.0, 90.0, 45.0, 110.0, 150.0, 80.0, 140.0, 120.0, 59.0, 50.0, 10.0, 110.0, 66.0, 80.0, 7.0, 99.0, 60.0, 65.0, 40.0, 29.0, 70.0, 100.0, 20.0, 50.0, 10.0, 70.0, 50.0, 140.0, 60.0, 150.0, 40.0, 67.0, 90.0, 47.0, 90.0, 30.0, 50.0, 64.0, 90.0, 68.0, 30.0, 70.0, 60.0, 70.0, 60.0, 50.0, 90.0, 80.0, 40.0, 70.0, 70.0, 100.0, 70.0, 45.0, 40.0, 89.0, 19.0, 46.0, 30.0, 30.0, 66.0, 10.0, 10.0, 30.0, 20.0, 70.0, 70.0, 37.0, 30.0, 6.0, 60.0, 130.0, 130.0, 87.0, -6.0, 60.0, 39.0, 40.0, 40.0, 50.0, 26.0, 10.0, 60.0, 66.0, 80.0, 53.0, 100.0, 40.0, 10.0, 70.0, 80.0, 30.0, 140.0, 37.0, 20.0, 60.0, 60.0, 40.0, 70.0, 59.0, 90.0, 59.0, 30.0, 110.0, 60.0, 100.0, 80.0, 60.0, 20.0, 150.0, 80.0, 70.0, 110.0, 130.0, 30.0, 60.0, 130.0, 50.0, 23.0, 50.0, -24.0, 60.0, 50.0, 30.0, 8.0, 100.0, 80.0, 80.0, 40.0, 37.0, 60.0, 40.0, 100.0, 30.0, 170.0, 80.0, 160.0, 80.0, 48.0, 50.0, 140.0, 60.0, 110.0, 110.0, 110.0, -5.0, 70.0, 60.0, 110.0, 70.0, 10.0, 70.0, 70.0, 60.0, 50.0, 30.0, 80.0, 60.0, 80.0, 70.0, 110.0, 90.0, 90.0, 80.0, 49.0, 8.0, 110.0, 80.0, 70.0, 40.0, 140.0, 30.0, 50.0, 50.0, 0.0, 10.0, 50.0, 70.0, 80.0, 117.0, 20.0, 60.0, 60.0, 87.0, 40.0, 60.0, 100.0, 40.0, 20.0, 20.0, 28.0, 40.0, 30.0, 48.0, 40.0, 0.0, -10.0, 20.0, 90.0, 90.0, 22.0, 16.0, 23.0, 90.0, 70.0, 60.0, 17.0, 100.0, 0.0, -26.0, 46.0, 100.0, 140.0, 40.0, 80.0, 80.0, 30.0, 40.0, 40.0, 120.0, 20.0, 30.0, 120.0, 10.0, 40.0, 110.0, 80.0, 30.0, 34.0, 50.0, 60.0, 60.0, 60.0, 30.0, 25.0, 50.0, 30.0, 91.0, 100.0, 25.0, 50.0, 120.0, 20.0, 50.0, 20.0, 110.0, 99.0, 100.0, 80.0, 29.0, 80.0, 60.0, 80.0, 30.0, 107.0, 70.0, 37.0, 40.0, 50.0, 80.0, 66.0, 60.0, 70.0, 120.0, 50.0, 120.0, 18.0, 50.0, 60.0, 80.0, 14.0, 10.0, 55.0, 38.0, 70.0, 50.0, 40.0, 13.0, 40.0, 50.0, 90.0, 48.0, -3.0, 80.0, 110.0, 39.0, 80.0, 30.0, 70.0, 70.0, 50.0, 20.0, 90.0, 75.0, 20.0, 100.0, 10.0, 60.0, 20.0, 50.0, 100.0, 50.0, 60.0, 70.0, 60.0, 60.0, 70.0, 80.0, 70.0, 60.0, 70.0, 98.0, 80.0, 80.0, 40.0, 60.0, 130.0, 45.0, 50.0, 56.0, 60.0, 40.0, 20.0, 40.0, -3.0, 50.0, 13.0, 100.0, 140.0, 60.0, 130.0, 120.0, 24.0, 30.0, 120.0, 40.0, 130.0, 43.0, 130.0, 89.0, 70.0, 70.0, 49.0, 70.0, 30.0, 40.0, 30.0, 28.0, 80.0, 70.0, 15.0, 120.0, 50.0, 70.0, 70.0, 18.0, 64.0, 170.0, 60.0, 100.0, 47.0, 90.0, 100.0, 110.0, 17.0, 90.0, 10.0, 5.0, 150.0, 47.0, 100.0, 20.0, 19.0, 30.0, 25.0, 90.0, 55.0, 60.0, 36.0, 60.0, 70.0, 60.0, 10.0, 70.0, 80.0, 30.0, 90.0, 60.0, 80.0, 10.0, 120.0, 50.0, 50.0, 23.0, 10.0, 100.0, 13.0, 40.0, 60.0, 50.0, 100.0, 90.0, 20.0, 60.0, 20.0, 15.0, 3.0, 20.0, 60.0, 70.0, 60.0, 120.0, 60.0, 110.0, 70.0, 70.0, 90.0, 60.0, 30.0, 70.0, 70.0, 50.0, 77.0, 120.0, 99.0, 80.0, 100.0, 130.0, 40.0, 60.0, 100.0, 0.0, 120.0, 20.0, 100.0, 30.0, 90.0, 20.0, 15.0, 123.0, 60.0, 110.0, 20.0, 130.0, 70.0, 20.0, 60.0, 170.0, 60.0, 50.0, 20.0, 120.0, 35.0, 100.0, 50.0, 5.0, 50.0, 110.0, 160.0, 30.0, 100.0, 40.0, 110.0, 50.0, 60.0, 100.0, 110.0, 110.0, 20.0, 70.0, 80.0, 90.0, 26.0, -18.0, 60.0, 80.0, 80.0, 70.0, 50.0, 53.0, 35.0, -17.0, 78.0, 80.0, 140.0, 70.0, 190.0, 100.0, 110.0, 100.0, 130.0, 20.0, 50.0, 60.0, 40.0, 80.0, 70.0, 40.0, 50.0, 80.0, 80.0, 60.0, 50.0, 50.0, 60.0, 56.0, 13.0, 50.0, 90.0, 180.0, 10.0, 30.0, 140.0, 70.0, 40.0, 50.0, 100.0, 32.0, -3.0, 17.0, 50.0, 15.0, 70.0, 80.0, -3.0, 57.0, 80.0, 31.0, 35.0, 16.0, 32.0, 126.0, 37.0, 70.0, 80.0, 90.0, 130.0, 70.0, 90.0, 70.0, 0.0, 130.0, 99.0, 40.0, 20.0, 150.0, 5.0, 20.0, 50.0, 60.0, 90.0, 30.0, 100.0, 130.0, 110.0, 88.0, 60.0, 50.0, 80.0, 60.0, 69.0, 0.0, -1.0, -14.0, -42.0, 40.0, 10.0, 30.0, 100.0, 0.0, 20.0, 100.0, 90.0, 90.0, 120.0, 70.0, 15.0, 50.0, 49.0, 90.0, -10.0, 101.0, 20.0, 140.0, 28.0, 150.0, 40.0, 69.0, 49.0, 60.0, 60.0, 80.0, 140.0, 40.0, 60.0, 80.0, 6.0, 130.0, 120.0, 60.0, 80.0, 15.0, 34.0, 60.0, 70.0, -17.0, 60.0, 70.0, 100.0, 70.0, 130.0, 70.0, 70.0, 70.0, -4.0, 13.0, 46.0, 80.0, -25.0, 19.0, -4.0, 82.0, 60.0, 90.0, 140.0, 60.0, 60.0, 110.0, 120.0, 114.0, 115.0, 28.0, 40.0, 120.0, 120.0, 80.0, 67.0, 57.0, 120.0, 86.0, 50.0, 10.0, 78.0, 70.0, 90.0, 50.0, 70.0, 8.0, 60.0, 20.0, 100.0, 50.0, 120.0, 60.0, -32.0, 41.0, 35.0, 60.0, 30.0, 6.0, 30.0, 140.0, 12.0, 60.0, 110.0, 90.0, 70.0, 70.0, 1.0, 60.0, 40.0, 60.0, 20.0, 90.0, 60.0, 160.0, -40.0, 100.0, 100.0, 50.0, 20.0, 80.0, 60.0, 96.0, 180.0, 25.0, 30.0, -99.0, 5.0, 110.0, 60.0, 70.0, 150.0, -75.0, 70.0, 30.0, 50.0, 80.0, 130.0, 60.0, 70.0, 40.0, 80.0, 0.0, 30.0, 70.0, 0.0, 30.0, 30.0, 20.0, 40.0, 210.0, 80.0, 120.0, 80.0, 60.0, 70.0, 110.0, 10.0, 80.0, 47.0, 100.0, 110.0, 40.0, 10.0, 160.0, 50.0, 20.0, 80.0, 20.0, 60.0, 110.0, 79.0, 49.0, 90.0, 50.0, 10.0, 110.0, 80.0, 58.0, 50.0, 100.0, 120.0, 99.0, 70.0, 30.0, 20.0, 30.0, 13.0, 49.0, 40.0, 210.0, 100.0, 70.0, 60.0, 80.0, 30.0, 20.0, 40.0, 70.0, 60.0, 120.0, 80.0, 30.0, 110.0, 40.0, 80.0, 30.0, 30.0, 100.0, 60.0, 120.0, 100.0, 78.0, 100.0, 50.0, 50.0, 100.0, 80.0, 120.0, 70.0, 110.0, 60.0, 60.0, 40.0, 20.0, 40.0, 70.0, 60.0, 70.0, 80.0, 90.0, 15.0, 50.0, 50.0, 49.0, -40.0, 19.0, 10.0, 15.0, 10.0, 11.0, 1.0, 45.0, 11.0, 100.0, 58.0, 50.0, 26.0, 60.0, 120.0, 60.0, 23.0, 70.0, 133.0, -27.0, 46.0, 35.0, 60.0, 36.0, 40.0, 73.0, 90.0, 40.0, 120.0, 170.0, 110.0, 80.0, 20.0, 90.0, 60.0, 100.0, 50.0, 100.0, 0.0, 64.0, 87.0, 90.0, 54.0, 54.0, 66.0, 120.0, 70.0, 122.0, 76.0, 100.0, 20.0, 80.0, 70.0, 18.0, 98.0, 80.0, 40.0, 80.0, 120.0, 80.0, -17.0, 120.0, 120.0, 100.0, 90.0, 60.0, -12.0, 60.0, 44.0, 100.0, 140.0, 60.0, 40.0, 80.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.504648421157008, "mean_inference_ms": 2.6647012303761746, "mean_action_processing_ms": 0.752579696826727, "mean_env_wait_ms": 1.7600411430562435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014558076858520508, "StateBufferConnector_ms": 0.009136438369750977, "ViewRequirementAgentConnector_ms": 0.42395520210266113}, "num_episodes": 18, "episode_return_max": 981.0, "episode_return_min": 143.0, "episode_return_mean": 627.09}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.41215611770826, "num_env_steps_trained_throughput_per_sec": 20.41215611770826, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 229333.744, "restore_workers_time_ms": 0.015, "training_step_time_ms": 229333.689, "sample_time_ms": 3726.85, "learn_time_ms": 225583.814, "learn_throughput": 17.732, "synch_weights_time_ms": 15.908}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 26, "trial_id": "1841f_00000", "date": "2024-08-08_01-06-43", "timestamp": 1723093603, "time_this_iter_s": 195.97119998931885, "time_total_s": 6388.671856641769, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24c34c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6388.671856641769, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.287050359712232, "ram_util_percent": 79.00215827338128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.477271946347433, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.421025754595463, "policy_loss": -0.012764063688005986, "vf_loss": 7.43214946092762, "vf_explained_var": -0.0011674172771624482, "kl": 0.008201805361494566, "entropy": 1.0120234718211034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 248835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 981.0, "episode_reward_min": 143.0, "episode_reward_mean": 618.31, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -99.0}, "policy_reward_max": {"policy_0": 220.0}, "policy_reward_mean": {"policy_0": 61.831}, "custom_metrics": {}, "hist_stats": {"episode_reward": [535.0, 343.0, 596.0, 569.0, 606.0, 749.0, 629.0, 545.0, 898.0, 705.0, 680.0, 757.0, 477.0, 515.0, 370.0, 396.0, 690.0, 564.0, 521.0, 708.0, 620.0, 642.0, 456.0, 574.0, 545.0, 650.0, 699.0, 590.0, 796.0, 482.0, 769.0, 719.0, 465.0, 610.0, 496.0, 418.0, 750.0, 856.0, 578.0, 710.0, 760.0, 750.0, 526.0, 981.0, 570.0, 619.0, 526.0, 413.0, 763.0, 664.0, 777.0, 143.0, 664.0, 717.0, 796.0, 592.0, 335.0, 951.0, 768.0, 556.0, 400.0, 653.0, 620.0, 547.0, 635.0, 340.0, 867.0, 650.0, 686.0, 571.0, 740.0, 680.0, 868.0, 610.0, 268.0, 482.0, 476.0, 853.0, 665.0, 774.0, 813.0, 592.0, 603.0, 738.0, 456.0, 690.0, 763.0, 632.0, 740.0, 362.0, 502.0, 649.0, 485.0, 512.0, 689.0, 598.0, 875.0, 635.0, 337.0, 626.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 70.0, 45.0, 40.0, 89.0, 19.0, 46.0, 30.0, 30.0, 66.0, 10.0, 10.0, 30.0, 20.0, 70.0, 70.0, 37.0, 30.0, 6.0, 60.0, 130.0, 130.0, 87.0, -6.0, 60.0, 39.0, 40.0, 40.0, 50.0, 26.0, 10.0, 60.0, 66.0, 80.0, 53.0, 100.0, 40.0, 10.0, 70.0, 80.0, 30.0, 140.0, 37.0, 20.0, 60.0, 60.0, 40.0, 70.0, 59.0, 90.0, 59.0, 30.0, 110.0, 60.0, 100.0, 80.0, 60.0, 20.0, 150.0, 80.0, 70.0, 110.0, 130.0, 30.0, 60.0, 130.0, 50.0, 23.0, 50.0, -24.0, 60.0, 50.0, 30.0, 8.0, 100.0, 80.0, 80.0, 40.0, 37.0, 60.0, 40.0, 100.0, 30.0, 170.0, 80.0, 160.0, 80.0, 48.0, 50.0, 140.0, 60.0, 110.0, 110.0, 110.0, -5.0, 70.0, 60.0, 110.0, 70.0, 10.0, 70.0, 70.0, 60.0, 50.0, 30.0, 80.0, 60.0, 80.0, 70.0, 110.0, 90.0, 90.0, 80.0, 49.0, 8.0, 110.0, 80.0, 70.0, 40.0, 140.0, 30.0, 50.0, 50.0, 0.0, 10.0, 50.0, 70.0, 80.0, 117.0, 20.0, 60.0, 60.0, 87.0, 40.0, 60.0, 100.0, 40.0, 20.0, 20.0, 28.0, 40.0, 30.0, 48.0, 40.0, 0.0, -10.0, 20.0, 90.0, 90.0, 22.0, 16.0, 23.0, 90.0, 70.0, 60.0, 17.0, 100.0, 0.0, -26.0, 46.0, 100.0, 140.0, 40.0, 80.0, 80.0, 30.0, 40.0, 40.0, 120.0, 20.0, 30.0, 120.0, 10.0, 40.0, 110.0, 80.0, 30.0, 34.0, 50.0, 60.0, 60.0, 60.0, 30.0, 25.0, 50.0, 30.0, 91.0, 100.0, 25.0, 50.0, 120.0, 20.0, 50.0, 20.0, 110.0, 99.0, 100.0, 80.0, 29.0, 80.0, 60.0, 80.0, 30.0, 107.0, 70.0, 37.0, 40.0, 50.0, 80.0, 66.0, 60.0, 70.0, 120.0, 50.0, 120.0, 18.0, 50.0, 60.0, 80.0, 14.0, 10.0, 55.0, 38.0, 70.0, 50.0, 40.0, 13.0, 40.0, 50.0, 90.0, 48.0, -3.0, 80.0, 110.0, 39.0, 80.0, 30.0, 70.0, 70.0, 50.0, 20.0, 90.0, 75.0, 20.0, 100.0, 10.0, 60.0, 20.0, 50.0, 100.0, 50.0, 60.0, 70.0, 60.0, 60.0, 70.0, 80.0, 70.0, 60.0, 70.0, 98.0, 80.0, 80.0, 40.0, 60.0, 130.0, 45.0, 50.0, 56.0, 60.0, 40.0, 20.0, 40.0, -3.0, 50.0, 13.0, 100.0, 140.0, 60.0, 130.0, 120.0, 24.0, 30.0, 120.0, 40.0, 130.0, 43.0, 130.0, 89.0, 70.0, 70.0, 49.0, 70.0, 30.0, 40.0, 30.0, 28.0, 80.0, 70.0, 15.0, 120.0, 50.0, 70.0, 70.0, 18.0, 64.0, 170.0, 60.0, 100.0, 47.0, 90.0, 100.0, 110.0, 17.0, 90.0, 10.0, 5.0, 150.0, 47.0, 100.0, 20.0, 19.0, 30.0, 25.0, 90.0, 55.0, 60.0, 36.0, 60.0, 70.0, 60.0, 10.0, 70.0, 80.0, 30.0, 90.0, 60.0, 80.0, 10.0, 120.0, 50.0, 50.0, 23.0, 10.0, 100.0, 13.0, 40.0, 60.0, 50.0, 100.0, 90.0, 20.0, 60.0, 20.0, 15.0, 3.0, 20.0, 60.0, 70.0, 60.0, 120.0, 60.0, 110.0, 70.0, 70.0, 90.0, 60.0, 30.0, 70.0, 70.0, 50.0, 77.0, 120.0, 99.0, 80.0, 100.0, 130.0, 40.0, 60.0, 100.0, 0.0, 120.0, 20.0, 100.0, 30.0, 90.0, 20.0, 15.0, 123.0, 60.0, 110.0, 20.0, 130.0, 70.0, 20.0, 60.0, 170.0, 60.0, 50.0, 20.0, 120.0, 35.0, 100.0, 50.0, 5.0, 50.0, 110.0, 160.0, 30.0, 100.0, 40.0, 110.0, 50.0, 60.0, 100.0, 110.0, 110.0, 20.0, 70.0, 80.0, 90.0, 26.0, -18.0, 60.0, 80.0, 80.0, 70.0, 50.0, 53.0, 35.0, -17.0, 78.0, 80.0, 140.0, 70.0, 190.0, 100.0, 110.0, 100.0, 130.0, 20.0, 50.0, 60.0, 40.0, 80.0, 70.0, 40.0, 50.0, 80.0, 80.0, 60.0, 50.0, 50.0, 60.0, 56.0, 13.0, 50.0, 90.0, 180.0, 10.0, 30.0, 140.0, 70.0, 40.0, 50.0, 100.0, 32.0, -3.0, 17.0, 50.0, 15.0, 70.0, 80.0, -3.0, 57.0, 80.0, 31.0, 35.0, 16.0, 32.0, 126.0, 37.0, 70.0, 80.0, 90.0, 130.0, 70.0, 90.0, 70.0, 0.0, 130.0, 99.0, 40.0, 20.0, 150.0, 5.0, 20.0, 50.0, 60.0, 90.0, 30.0, 100.0, 130.0, 110.0, 88.0, 60.0, 50.0, 80.0, 60.0, 69.0, 0.0, -1.0, -14.0, -42.0, 40.0, 10.0, 30.0, 100.0, 0.0, 20.0, 100.0, 90.0, 90.0, 120.0, 70.0, 15.0, 50.0, 49.0, 90.0, -10.0, 101.0, 20.0, 140.0, 28.0, 150.0, 40.0, 69.0, 49.0, 60.0, 60.0, 80.0, 140.0, 40.0, 60.0, 80.0, 6.0, 130.0, 120.0, 60.0, 80.0, 15.0, 34.0, 60.0, 70.0, -17.0, 60.0, 70.0, 100.0, 70.0, 130.0, 70.0, 70.0, 70.0, -4.0, 13.0, 46.0, 80.0, -25.0, 19.0, -4.0, 82.0, 60.0, 90.0, 140.0, 60.0, 60.0, 110.0, 120.0, 114.0, 115.0, 28.0, 40.0, 120.0, 120.0, 80.0, 67.0, 57.0, 120.0, 86.0, 50.0, 10.0, 78.0, 70.0, 90.0, 50.0, 70.0, 8.0, 60.0, 20.0, 100.0, 50.0, 120.0, 60.0, -32.0, 41.0, 35.0, 60.0, 30.0, 6.0, 30.0, 140.0, 12.0, 60.0, 110.0, 90.0, 70.0, 70.0, 1.0, 60.0, 40.0, 60.0, 20.0, 90.0, 60.0, 160.0, -40.0, 100.0, 100.0, 50.0, 20.0, 80.0, 60.0, 96.0, 180.0, 25.0, 30.0, -99.0, 5.0, 110.0, 60.0, 70.0, 150.0, -75.0, 70.0, 30.0, 50.0, 80.0, 130.0, 60.0, 70.0, 40.0, 80.0, 0.0, 30.0, 70.0, 0.0, 30.0, 30.0, 20.0, 40.0, 210.0, 80.0, 120.0, 80.0, 60.0, 70.0, 110.0, 10.0, 80.0, 47.0, 100.0, 110.0, 40.0, 10.0, 160.0, 50.0, 20.0, 80.0, 20.0, 60.0, 110.0, 79.0, 49.0, 90.0, 50.0, 10.0, 110.0, 80.0, 58.0, 50.0, 100.0, 120.0, 99.0, 70.0, 30.0, 20.0, 30.0, 13.0, 49.0, 40.0, 210.0, 100.0, 70.0, 60.0, 80.0, 30.0, 20.0, 40.0, 70.0, 60.0, 120.0, 80.0, 30.0, 110.0, 40.0, 80.0, 30.0, 30.0, 100.0, 60.0, 120.0, 100.0, 78.0, 100.0, 50.0, 50.0, 100.0, 80.0, 120.0, 70.0, 110.0, 60.0, 60.0, 40.0, 20.0, 40.0, 70.0, 60.0, 70.0, 80.0, 90.0, 15.0, 50.0, 50.0, 49.0, -40.0, 19.0, 10.0, 15.0, 10.0, 11.0, 1.0, 45.0, 11.0, 100.0, 58.0, 50.0, 26.0, 60.0, 120.0, 60.0, 23.0, 70.0, 133.0, -27.0, 46.0, 35.0, 60.0, 36.0, 40.0, 73.0, 90.0, 40.0, 120.0, 170.0, 110.0, 80.0, 20.0, 90.0, 60.0, 100.0, 50.0, 100.0, 0.0, 64.0, 87.0, 90.0, 54.0, 54.0, 66.0, 120.0, 70.0, 122.0, 76.0, 100.0, 20.0, 80.0, 70.0, 18.0, 98.0, 80.0, 40.0, 80.0, 120.0, 80.0, -17.0, 120.0, 120.0, 100.0, 90.0, 60.0, -12.0, 60.0, 44.0, 100.0, 140.0, 60.0, 40.0, 80.0, 20.0, 220.0, 50.0, 100.0, 30.0, 18.0, 25.0, 35.0, 40.0, 60.0, 25.0, 30.0, 50.0, 140.0, 110.0, 80.0, 30.0, 60.0, 98.0, 90.0, 50.0, 70.0, 35.0, 40.0, 30.0, 90.0, -35.0, 40.0, 46.0, 110.0, 30.0, 70.0, 0.0, 130.0, 90.0, 90.0, 40.0, 80.0, 70.0, 10.0, 110.0, 40.0, 110.0, 70.0, 110.0, 38.0, 60.0, 30.0, 100.0, 65.0, 140.0, 50.0, 68.0, 130.0, 24.0, 70.0, 30.0, 70.0, 90.0, 30.0, 70.0, 60.0, 40.0, 90.0, 70.0, 30.0, 60.0, 100.0, 140.0, 80.0, 70.0, 70.0, 69.0, 60.0, 40.0, 60.0, 5.0, 34.0, -10.0, 0.0, 34.0, 60.0, 70.0, -5.0, -1.0, 150.0, 60.0, 60.0, 70.0, -32.0, 70.0, 40.0, 50.0, 25.0, 180.0, 59.0, -5.0, 0.0, 90.0, 70.0, 140.0, 70.0, 20.0, -5.0, 30.0, 70.0, 140.0, 60.0, 10.0, 70.0, 20.0, -5.0, 40.0, 60.0, 63.0, -15.0, 120.0, 80.0, 70.0, 80.0, 19.0, 80.0, 51.0, 40.0, 60.0, 48.0, 75.0, 40.0, 100.0, 55.0, 140.0, 64.0, 4.0, 50.0, 100.0, 50.0, 31.0, 20.0, 130.0, 79.0, 70.0, 90.0, 90.0, 95.0, 80.0, 120.0, 100.0, 120.0, 60.0, 90.0, 30.0, -55.0, 160.0, 30.0, 80.0, 60.0, 120.0, 100.0, 50.0, 60.0, 30.0, 60.0, 9.0, 90.0, 70.0, -7.0, 50.0, -5.0, 30.0, 20.0, 20.0, 100.0, 90.0, 40.0, 20.0, 50.0, 70.0, 26.0, 40.0, 50.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4685065938702393, "mean_inference_ms": 2.618152871615348, "mean_action_processing_ms": 0.7408218551394259, "mean_env_wait_ms": 1.731589851998483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013579845428466797, "StateBufferConnector_ms": 0.008855104446411133, "ViewRequirementAgentConnector_ms": 0.3801076412200928}, "num_episodes": 18, "episode_return_max": 981.0, "episode_return_min": 143.0, "episode_return_mean": 618.31}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.415422817749175, "num_env_steps_trained_throughput_per_sec": 20.415422817749175, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 223175.682, "restore_workers_time_ms": 0.013, "training_step_time_ms": 223175.631, "sample_time_ms": 3541.377, "learn_time_ms": 219612.702, "learn_throughput": 18.214, "synch_weights_time_ms": 14.259}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 27, "trial_id": "1841f_00000", "date": "2024-08-08_01-09-59", "timestamp": 1723093799, "time_this_iter_s": 195.94168996810913, "time_total_s": 6584.6135466098785, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24c3a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6584.6135466098785, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 21.321223021582735, "ram_util_percent": 79.1341726618705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.380133501923503, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.00063987687246, "policy_loss": -0.01216925502349588, "vf_loss": 8.01114105563829, "vf_explained_var": 0.004502591633568176, "kl": 0.00834042213587853, "entropy": 1.0016189185067361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 258225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 1039.0, "episode_reward_min": 143.0, "episode_reward_mean": 633.48, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -99.0}, "policy_reward_max": {"policy_0": 220.0}, "policy_reward_mean": {"policy_0": 63.348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [521.0, 708.0, 620.0, 642.0, 456.0, 574.0, 545.0, 650.0, 699.0, 590.0, 796.0, 482.0, 769.0, 719.0, 465.0, 610.0, 496.0, 418.0, 750.0, 856.0, 578.0, 710.0, 760.0, 750.0, 526.0, 981.0, 570.0, 619.0, 526.0, 413.0, 763.0, 664.0, 777.0, 143.0, 664.0, 717.0, 796.0, 592.0, 335.0, 951.0, 768.0, 556.0, 400.0, 653.0, 620.0, 547.0, 635.0, 340.0, 867.0, 650.0, 686.0, 571.0, 740.0, 680.0, 868.0, 610.0, 268.0, 482.0, 476.0, 853.0, 665.0, 774.0, 813.0, 592.0, 603.0, 738.0, 456.0, 690.0, 763.0, 632.0, 740.0, 362.0, 502.0, 649.0, 485.0, 512.0, 689.0, 598.0, 875.0, 635.0, 337.0, 626.0, 872.0, 632.0, 946.0, 890.0, 667.0, 775.0, 820.0, 500.0, 623.0, 680.0, 550.0, 605.0, 277.0, 530.0, 611.0, 1039.0, 680.0, 444.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 60.0, 30.0, 25.0, 50.0, 30.0, 91.0, 100.0, 25.0, 50.0, 120.0, 20.0, 50.0, 20.0, 110.0, 99.0, 100.0, 80.0, 29.0, 80.0, 60.0, 80.0, 30.0, 107.0, 70.0, 37.0, 40.0, 50.0, 80.0, 66.0, 60.0, 70.0, 120.0, 50.0, 120.0, 18.0, 50.0, 60.0, 80.0, 14.0, 10.0, 55.0, 38.0, 70.0, 50.0, 40.0, 13.0, 40.0, 50.0, 90.0, 48.0, -3.0, 80.0, 110.0, 39.0, 80.0, 30.0, 70.0, 70.0, 50.0, 20.0, 90.0, 75.0, 20.0, 100.0, 10.0, 60.0, 20.0, 50.0, 100.0, 50.0, 60.0, 70.0, 60.0, 60.0, 70.0, 80.0, 70.0, 60.0, 70.0, 98.0, 80.0, 80.0, 40.0, 60.0, 130.0, 45.0, 50.0, 56.0, 60.0, 40.0, 20.0, 40.0, -3.0, 50.0, 13.0, 100.0, 140.0, 60.0, 130.0, 120.0, 24.0, 30.0, 120.0, 40.0, 130.0, 43.0, 130.0, 89.0, 70.0, 70.0, 49.0, 70.0, 30.0, 40.0, 30.0, 28.0, 80.0, 70.0, 15.0, 120.0, 50.0, 70.0, 70.0, 18.0, 64.0, 170.0, 60.0, 100.0, 47.0, 90.0, 100.0, 110.0, 17.0, 90.0, 10.0, 5.0, 150.0, 47.0, 100.0, 20.0, 19.0, 30.0, 25.0, 90.0, 55.0, 60.0, 36.0, 60.0, 70.0, 60.0, 10.0, 70.0, 80.0, 30.0, 90.0, 60.0, 80.0, 10.0, 120.0, 50.0, 50.0, 23.0, 10.0, 100.0, 13.0, 40.0, 60.0, 50.0, 100.0, 90.0, 20.0, 60.0, 20.0, 15.0, 3.0, 20.0, 60.0, 70.0, 60.0, 120.0, 60.0, 110.0, 70.0, 70.0, 90.0, 60.0, 30.0, 70.0, 70.0, 50.0, 77.0, 120.0, 99.0, 80.0, 100.0, 130.0, 40.0, 60.0, 100.0, 0.0, 120.0, 20.0, 100.0, 30.0, 90.0, 20.0, 15.0, 123.0, 60.0, 110.0, 20.0, 130.0, 70.0, 20.0, 60.0, 170.0, 60.0, 50.0, 20.0, 120.0, 35.0, 100.0, 50.0, 5.0, 50.0, 110.0, 160.0, 30.0, 100.0, 40.0, 110.0, 50.0, 60.0, 100.0, 110.0, 110.0, 20.0, 70.0, 80.0, 90.0, 26.0, -18.0, 60.0, 80.0, 80.0, 70.0, 50.0, 53.0, 35.0, -17.0, 78.0, 80.0, 140.0, 70.0, 190.0, 100.0, 110.0, 100.0, 130.0, 20.0, 50.0, 60.0, 40.0, 80.0, 70.0, 40.0, 50.0, 80.0, 80.0, 60.0, 50.0, 50.0, 60.0, 56.0, 13.0, 50.0, 90.0, 180.0, 10.0, 30.0, 140.0, 70.0, 40.0, 50.0, 100.0, 32.0, -3.0, 17.0, 50.0, 15.0, 70.0, 80.0, -3.0, 57.0, 80.0, 31.0, 35.0, 16.0, 32.0, 126.0, 37.0, 70.0, 80.0, 90.0, 130.0, 70.0, 90.0, 70.0, 0.0, 130.0, 99.0, 40.0, 20.0, 150.0, 5.0, 20.0, 50.0, 60.0, 90.0, 30.0, 100.0, 130.0, 110.0, 88.0, 60.0, 50.0, 80.0, 60.0, 69.0, 0.0, -1.0, -14.0, -42.0, 40.0, 10.0, 30.0, 100.0, 0.0, 20.0, 100.0, 90.0, 90.0, 120.0, 70.0, 15.0, 50.0, 49.0, 90.0, -10.0, 101.0, 20.0, 140.0, 28.0, 150.0, 40.0, 69.0, 49.0, 60.0, 60.0, 80.0, 140.0, 40.0, 60.0, 80.0, 6.0, 130.0, 120.0, 60.0, 80.0, 15.0, 34.0, 60.0, 70.0, -17.0, 60.0, 70.0, 100.0, 70.0, 130.0, 70.0, 70.0, 70.0, -4.0, 13.0, 46.0, 80.0, -25.0, 19.0, -4.0, 82.0, 60.0, 90.0, 140.0, 60.0, 60.0, 110.0, 120.0, 114.0, 115.0, 28.0, 40.0, 120.0, 120.0, 80.0, 67.0, 57.0, 120.0, 86.0, 50.0, 10.0, 78.0, 70.0, 90.0, 50.0, 70.0, 8.0, 60.0, 20.0, 100.0, 50.0, 120.0, 60.0, -32.0, 41.0, 35.0, 60.0, 30.0, 6.0, 30.0, 140.0, 12.0, 60.0, 110.0, 90.0, 70.0, 70.0, 1.0, 60.0, 40.0, 60.0, 20.0, 90.0, 60.0, 160.0, -40.0, 100.0, 100.0, 50.0, 20.0, 80.0, 60.0, 96.0, 180.0, 25.0, 30.0, -99.0, 5.0, 110.0, 60.0, 70.0, 150.0, -75.0, 70.0, 30.0, 50.0, 80.0, 130.0, 60.0, 70.0, 40.0, 80.0, 0.0, 30.0, 70.0, 0.0, 30.0, 30.0, 20.0, 40.0, 210.0, 80.0, 120.0, 80.0, 60.0, 70.0, 110.0, 10.0, 80.0, 47.0, 100.0, 110.0, 40.0, 10.0, 160.0, 50.0, 20.0, 80.0, 20.0, 60.0, 110.0, 79.0, 49.0, 90.0, 50.0, 10.0, 110.0, 80.0, 58.0, 50.0, 100.0, 120.0, 99.0, 70.0, 30.0, 20.0, 30.0, 13.0, 49.0, 40.0, 210.0, 100.0, 70.0, 60.0, 80.0, 30.0, 20.0, 40.0, 70.0, 60.0, 120.0, 80.0, 30.0, 110.0, 40.0, 80.0, 30.0, 30.0, 100.0, 60.0, 120.0, 100.0, 78.0, 100.0, 50.0, 50.0, 100.0, 80.0, 120.0, 70.0, 110.0, 60.0, 60.0, 40.0, 20.0, 40.0, 70.0, 60.0, 70.0, 80.0, 90.0, 15.0, 50.0, 50.0, 49.0, -40.0, 19.0, 10.0, 15.0, 10.0, 11.0, 1.0, 45.0, 11.0, 100.0, 58.0, 50.0, 26.0, 60.0, 120.0, 60.0, 23.0, 70.0, 133.0, -27.0, 46.0, 35.0, 60.0, 36.0, 40.0, 73.0, 90.0, 40.0, 120.0, 170.0, 110.0, 80.0, 20.0, 90.0, 60.0, 100.0, 50.0, 100.0, 0.0, 64.0, 87.0, 90.0, 54.0, 54.0, 66.0, 120.0, 70.0, 122.0, 76.0, 100.0, 20.0, 80.0, 70.0, 18.0, 98.0, 80.0, 40.0, 80.0, 120.0, 80.0, -17.0, 120.0, 120.0, 100.0, 90.0, 60.0, -12.0, 60.0, 44.0, 100.0, 140.0, 60.0, 40.0, 80.0, 20.0, 220.0, 50.0, 100.0, 30.0, 18.0, 25.0, 35.0, 40.0, 60.0, 25.0, 30.0, 50.0, 140.0, 110.0, 80.0, 30.0, 60.0, 98.0, 90.0, 50.0, 70.0, 35.0, 40.0, 30.0, 90.0, -35.0, 40.0, 46.0, 110.0, 30.0, 70.0, 0.0, 130.0, 90.0, 90.0, 40.0, 80.0, 70.0, 10.0, 110.0, 40.0, 110.0, 70.0, 110.0, 38.0, 60.0, 30.0, 100.0, 65.0, 140.0, 50.0, 68.0, 130.0, 24.0, 70.0, 30.0, 70.0, 90.0, 30.0, 70.0, 60.0, 40.0, 90.0, 70.0, 30.0, 60.0, 100.0, 140.0, 80.0, 70.0, 70.0, 69.0, 60.0, 40.0, 60.0, 5.0, 34.0, -10.0, 0.0, 34.0, 60.0, 70.0, -5.0, -1.0, 150.0, 60.0, 60.0, 70.0, -32.0, 70.0, 40.0, 50.0, 25.0, 180.0, 59.0, -5.0, 0.0, 90.0, 70.0, 140.0, 70.0, 20.0, -5.0, 30.0, 70.0, 140.0, 60.0, 10.0, 70.0, 20.0, -5.0, 40.0, 60.0, 63.0, -15.0, 120.0, 80.0, 70.0, 80.0, 19.0, 80.0, 51.0, 40.0, 60.0, 48.0, 75.0, 40.0, 100.0, 55.0, 140.0, 64.0, 4.0, 50.0, 100.0, 50.0, 31.0, 20.0, 130.0, 79.0, 70.0, 90.0, 90.0, 95.0, 80.0, 120.0, 100.0, 120.0, 60.0, 90.0, 30.0, -55.0, 160.0, 30.0, 80.0, 60.0, 120.0, 100.0, 50.0, 60.0, 30.0, 60.0, 9.0, 90.0, 70.0, -7.0, 50.0, -5.0, 30.0, 20.0, 20.0, 100.0, 90.0, 40.0, 20.0, 50.0, 70.0, 26.0, 40.0, 50.0, 140.0, 55.0, 140.0, 18.0, 110.0, 130.0, 100.0, 99.0, 110.0, 80.0, 30.0, 100.0, 42.0, 30.0, 60.0, 28.0, 65.0, 40.0, 87.0, 110.0, 70.0, 90.0, 140.0, 178.0, 130.0, 90.0, 80.0, 70.0, 80.0, 8.0, 80.0, 70.0, 200.0, 40.0, 90.0, 80.0, 80.0, 40.0, 110.0, 100.0, 80.0, 220.0, 94.0, 40.0, -37.0, 0.0, 50.0, 80.0, 30.0, 50.0, 140.0, 67.0, 60.0, 80.0, 40.0, 130.0, 160.0, 20.0, 80.0, 88.0, 50.0, 100.0, 130.0, 40.0, 56.0, 60.0, 86.0, 20.0, 100.0, 170.0, 58.0, 40.0, 50.0, 40.0, 30.0, 50.0, 10.0, 10.0, 80.0, 140.0, 50.0, 90.0, 70.0, 80.0, 10.0, 36.0, 60.0, 17.0, 90.0, 120.0, 50.0, 80.0, 60.0, 80.0, 50.0, 40.0, 40.0, 190.0, 30.0, 60.0, 50.0, 30.0, 90.0, 70.0, 40.0, 40.0, 70.0, 20.0, 50.0, 60.0, 80.0, 70.0, 70.0, 66.0, 91.0, 26.0, 42.0, 30.0, 50.0, 80.0, 80.0, -11.0, 30.0, 80.0, 8.0, 40.0, 40.0, 40.0, 30.0, 0.0, 20.0, 10.0, 40.0, -14.0, 22.0, 110.0, 51.0, 4.0, 130.0, 67.0, 110.0, 0.0, 120.0, 32.0, 140.0, 70.0, 105.0, 50.0, 30.0, -6.0, 70.0, 26.0, 200.0, 25.0, 128.0, 90.0, 80.0, 150.0, 70.0, 80.0, 190.0, 120.0, 20.0, 70.0, 90.0, 20.0, 80.0, 70.0, 90.0, 60.0, 60.0, 34.0, 50.0, 70.0, -14.0, 27.0, 28.0, 50.0, 29.0, 110.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.434082086119822, "mean_inference_ms": 2.5751673954469396, "mean_action_processing_ms": 0.7299418710277016, "mean_env_wait_ms": 1.7053175529371674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011656045913696289, "StateBufferConnector_ms": 0.00865030288696289, "ViewRequirementAgentConnector_ms": 0.369307279586792}, "num_episodes": 18, "episode_return_max": 1039.0, "episode_return_min": 143.0, "episode_return_mean": 633.48}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.511261972527862, "num_env_steps_trained_throughput_per_sec": 20.511261972527862, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 216539.236, "restore_workers_time_ms": 0.012, "training_step_time_ms": 216539.186, "sample_time_ms": 3304.84, "learn_time_ms": 213212.553, "learn_throughput": 18.761, "synch_weights_time_ms": 14.345}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 28, "trial_id": "1841f_00000", "date": "2024-08-08_01-13-14", "timestamp": 1723093994, "time_this_iter_s": 195.02367997169495, "time_total_s": 6779.6372265815735, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b291b430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6779.6372265815735, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.41014492753623, "ram_util_percent": 79.28297101449274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.32325294900753, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.887171161162079, "policy_loss": -0.012397920953445097, "vf_loss": 7.897912023877438, "vf_explained_var": 0.0023155968537091954, "kl": 0.008285300734212494, "entropy": 0.927342241113813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 267615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 1060.0, "episode_reward_min": 143.0, "episode_reward_mean": 662.68, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -99.0}, "policy_reward_max": {"policy_0": 230.0}, "policy_reward_mean": {"policy_0": 66.268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [619.0, 526.0, 413.0, 763.0, 664.0, 777.0, 143.0, 664.0, 717.0, 796.0, 592.0, 335.0, 951.0, 768.0, 556.0, 400.0, 653.0, 620.0, 547.0, 635.0, 340.0, 867.0, 650.0, 686.0, 571.0, 740.0, 680.0, 868.0, 610.0, 268.0, 482.0, 476.0, 853.0, 665.0, 774.0, 813.0, 592.0, 603.0, 738.0, 456.0, 690.0, 763.0, 632.0, 740.0, 362.0, 502.0, 649.0, 485.0, 512.0, 689.0, 598.0, 875.0, 635.0, 337.0, 626.0, 872.0, 632.0, 946.0, 890.0, 667.0, 775.0, 820.0, 500.0, 623.0, 680.0, 550.0, 605.0, 277.0, 530.0, 611.0, 1039.0, 680.0, 444.0, 595.0, 885.0, 812.0, 634.0, 769.0, 1060.0, 591.0, 690.0, 560.0, 740.0, 928.0, 784.0, 748.0, 680.0, 725.0, 596.0, 870.0, 725.0, 729.0, 660.0, 1041.0, 775.0, 851.0, 599.0, 790.0, 634.0, 690.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 50.0, 50.0, 60.0, 56.0, 13.0, 50.0, 90.0, 180.0, 10.0, 30.0, 140.0, 70.0, 40.0, 50.0, 100.0, 32.0, -3.0, 17.0, 50.0, 15.0, 70.0, 80.0, -3.0, 57.0, 80.0, 31.0, 35.0, 16.0, 32.0, 126.0, 37.0, 70.0, 80.0, 90.0, 130.0, 70.0, 90.0, 70.0, 0.0, 130.0, 99.0, 40.0, 20.0, 150.0, 5.0, 20.0, 50.0, 60.0, 90.0, 30.0, 100.0, 130.0, 110.0, 88.0, 60.0, 50.0, 80.0, 60.0, 69.0, 0.0, -1.0, -14.0, -42.0, 40.0, 10.0, 30.0, 100.0, 0.0, 20.0, 100.0, 90.0, 90.0, 120.0, 70.0, 15.0, 50.0, 49.0, 90.0, -10.0, 101.0, 20.0, 140.0, 28.0, 150.0, 40.0, 69.0, 49.0, 60.0, 60.0, 80.0, 140.0, 40.0, 60.0, 80.0, 6.0, 130.0, 120.0, 60.0, 80.0, 15.0, 34.0, 60.0, 70.0, -17.0, 60.0, 70.0, 100.0, 70.0, 130.0, 70.0, 70.0, 70.0, -4.0, 13.0, 46.0, 80.0, -25.0, 19.0, -4.0, 82.0, 60.0, 90.0, 140.0, 60.0, 60.0, 110.0, 120.0, 114.0, 115.0, 28.0, 40.0, 120.0, 120.0, 80.0, 67.0, 57.0, 120.0, 86.0, 50.0, 10.0, 78.0, 70.0, 90.0, 50.0, 70.0, 8.0, 60.0, 20.0, 100.0, 50.0, 120.0, 60.0, -32.0, 41.0, 35.0, 60.0, 30.0, 6.0, 30.0, 140.0, 12.0, 60.0, 110.0, 90.0, 70.0, 70.0, 1.0, 60.0, 40.0, 60.0, 20.0, 90.0, 60.0, 160.0, -40.0, 100.0, 100.0, 50.0, 20.0, 80.0, 60.0, 96.0, 180.0, 25.0, 30.0, -99.0, 5.0, 110.0, 60.0, 70.0, 150.0, -75.0, 70.0, 30.0, 50.0, 80.0, 130.0, 60.0, 70.0, 40.0, 80.0, 0.0, 30.0, 70.0, 0.0, 30.0, 30.0, 20.0, 40.0, 210.0, 80.0, 120.0, 80.0, 60.0, 70.0, 110.0, 10.0, 80.0, 47.0, 100.0, 110.0, 40.0, 10.0, 160.0, 50.0, 20.0, 80.0, 20.0, 60.0, 110.0, 79.0, 49.0, 90.0, 50.0, 10.0, 110.0, 80.0, 58.0, 50.0, 100.0, 120.0, 99.0, 70.0, 30.0, 20.0, 30.0, 13.0, 49.0, 40.0, 210.0, 100.0, 70.0, 60.0, 80.0, 30.0, 20.0, 40.0, 70.0, 60.0, 120.0, 80.0, 30.0, 110.0, 40.0, 80.0, 30.0, 30.0, 100.0, 60.0, 120.0, 100.0, 78.0, 100.0, 50.0, 50.0, 100.0, 80.0, 120.0, 70.0, 110.0, 60.0, 60.0, 40.0, 20.0, 40.0, 70.0, 60.0, 70.0, 80.0, 90.0, 15.0, 50.0, 50.0, 49.0, -40.0, 19.0, 10.0, 15.0, 10.0, 11.0, 1.0, 45.0, 11.0, 100.0, 58.0, 50.0, 26.0, 60.0, 120.0, 60.0, 23.0, 70.0, 133.0, -27.0, 46.0, 35.0, 60.0, 36.0, 40.0, 73.0, 90.0, 40.0, 120.0, 170.0, 110.0, 80.0, 20.0, 90.0, 60.0, 100.0, 50.0, 100.0, 0.0, 64.0, 87.0, 90.0, 54.0, 54.0, 66.0, 120.0, 70.0, 122.0, 76.0, 100.0, 20.0, 80.0, 70.0, 18.0, 98.0, 80.0, 40.0, 80.0, 120.0, 80.0, -17.0, 120.0, 120.0, 100.0, 90.0, 60.0, -12.0, 60.0, 44.0, 100.0, 140.0, 60.0, 40.0, 80.0, 20.0, 220.0, 50.0, 100.0, 30.0, 18.0, 25.0, 35.0, 40.0, 60.0, 25.0, 30.0, 50.0, 140.0, 110.0, 80.0, 30.0, 60.0, 98.0, 90.0, 50.0, 70.0, 35.0, 40.0, 30.0, 90.0, -35.0, 40.0, 46.0, 110.0, 30.0, 70.0, 0.0, 130.0, 90.0, 90.0, 40.0, 80.0, 70.0, 10.0, 110.0, 40.0, 110.0, 70.0, 110.0, 38.0, 60.0, 30.0, 100.0, 65.0, 140.0, 50.0, 68.0, 130.0, 24.0, 70.0, 30.0, 70.0, 90.0, 30.0, 70.0, 60.0, 40.0, 90.0, 70.0, 30.0, 60.0, 100.0, 140.0, 80.0, 70.0, 70.0, 69.0, 60.0, 40.0, 60.0, 5.0, 34.0, -10.0, 0.0, 34.0, 60.0, 70.0, -5.0, -1.0, 150.0, 60.0, 60.0, 70.0, -32.0, 70.0, 40.0, 50.0, 25.0, 180.0, 59.0, -5.0, 0.0, 90.0, 70.0, 140.0, 70.0, 20.0, -5.0, 30.0, 70.0, 140.0, 60.0, 10.0, 70.0, 20.0, -5.0, 40.0, 60.0, 63.0, -15.0, 120.0, 80.0, 70.0, 80.0, 19.0, 80.0, 51.0, 40.0, 60.0, 48.0, 75.0, 40.0, 100.0, 55.0, 140.0, 64.0, 4.0, 50.0, 100.0, 50.0, 31.0, 20.0, 130.0, 79.0, 70.0, 90.0, 90.0, 95.0, 80.0, 120.0, 100.0, 120.0, 60.0, 90.0, 30.0, -55.0, 160.0, 30.0, 80.0, 60.0, 120.0, 100.0, 50.0, 60.0, 30.0, 60.0, 9.0, 90.0, 70.0, -7.0, 50.0, -5.0, 30.0, 20.0, 20.0, 100.0, 90.0, 40.0, 20.0, 50.0, 70.0, 26.0, 40.0, 50.0, 140.0, 55.0, 140.0, 18.0, 110.0, 130.0, 100.0, 99.0, 110.0, 80.0, 30.0, 100.0, 42.0, 30.0, 60.0, 28.0, 65.0, 40.0, 87.0, 110.0, 70.0, 90.0, 140.0, 178.0, 130.0, 90.0, 80.0, 70.0, 80.0, 8.0, 80.0, 70.0, 200.0, 40.0, 90.0, 80.0, 80.0, 40.0, 110.0, 100.0, 80.0, 220.0, 94.0, 40.0, -37.0, 0.0, 50.0, 80.0, 30.0, 50.0, 140.0, 67.0, 60.0, 80.0, 40.0, 130.0, 160.0, 20.0, 80.0, 88.0, 50.0, 100.0, 130.0, 40.0, 56.0, 60.0, 86.0, 20.0, 100.0, 170.0, 58.0, 40.0, 50.0, 40.0, 30.0, 50.0, 10.0, 10.0, 80.0, 140.0, 50.0, 90.0, 70.0, 80.0, 10.0, 36.0, 60.0, 17.0, 90.0, 120.0, 50.0, 80.0, 60.0, 80.0, 50.0, 40.0, 40.0, 190.0, 30.0, 60.0, 50.0, 30.0, 90.0, 70.0, 40.0, 40.0, 70.0, 20.0, 50.0, 60.0, 80.0, 70.0, 70.0, 66.0, 91.0, 26.0, 42.0, 30.0, 50.0, 80.0, 80.0, -11.0, 30.0, 80.0, 8.0, 40.0, 40.0, 40.0, 30.0, 0.0, 20.0, 10.0, 40.0, -14.0, 22.0, 110.0, 51.0, 4.0, 130.0, 67.0, 110.0, 0.0, 120.0, 32.0, 140.0, 70.0, 105.0, 50.0, 30.0, -6.0, 70.0, 26.0, 200.0, 25.0, 128.0, 90.0, 80.0, 150.0, 70.0, 80.0, 190.0, 120.0, 20.0, 70.0, 90.0, 20.0, 80.0, 70.0, 90.0, 60.0, 60.0, 34.0, 50.0, 70.0, -14.0, 27.0, 28.0, 50.0, 29.0, 110.0, 60.0, 110.0, 25.0, 80.0, 70.0, 40.0, 55.0, 15.0, 70.0, 80.0, 50.0, 120.0, 50.0, 78.0, 70.0, 120.0, 100.0, 117.0, 40.0, 55.0, 135.0, 100.0, 50.0, 60.0, 50.0, 27.0, 68.0, 130.0, 27.0, 110.0, 190.0, 50.0, 56.0, 99.0, 47.0, 3.0, 65.0, 20.0, 33.0, 230.0, 31.0, 110.0, 50.0, 110.0, 88.0, 70.0, 58.0, 90.0, 60.0, 80.0, 53.0, 70.0, 80.0, 160.0, 100.0, 110.0, 40.0, 160.0, 100.0, 100.0, 140.0, 130.0, 68.0, 60.0, 39.0, 6.0, 60.0, 80.0, 18.0, 40.0, 90.0, 60.0, 90.0, 50.0, 80.0, 120.0, 40.0, 150.0, 30.0, 50.0, 20.0, 40.0, 80.0, 40.0, 30.0, 50.0, 140.0, -20.0, 70.0, 50.0, 80.0, 70.0, 40.0, 30.0, 100.0, 70.0, 50.0, 70.0, 160.0, 60.0, 90.0, 50.0, 43.0, 90.0, 140.0, 45.0, 140.0, 120.0, 80.0, 120.0, 100.0, 150.0, 70.0, 70.0, 38.0, 70.0, 110.0, 30.0, 60.0, 66.0, 120.0, 80.0, 80.0, 60.0, 20.0, 80.0, 35.0, 120.0, 104.0, 90.0, 79.0, 20.0, 50.0, 100.0, 70.0, 90.0, 60.0, 50.0, 50.0, 110.0, 80.0, 70.0, 130.0, 15.0, -3.0, 110.0, 90.0, 110.0, 75.0, 120.0, 8.0, 70.0, 10.0, -12.0, 110.0, 34.0, 59.0, 130.0, 17.0, 9.0, 169.0, 90.0, 150.0, 170.0, 100.0, 30.0, 90.0, 20.0, 80.0, 100.0, 40.0, 50.0, 170.0, 90.0, 70.0, 70.0, 30.0, 100.0, 70.0, 60.0, 15.0, 100.0, 50.0, 80.0, 49.0, 60.0, 120.0, 70.0, 20.0, 60.0, 120.0, 40.0, 70.0, 90.0, 20.0, 110.0, 70.0, 50.0, 50.0, 60.0, 100.0, 100.0, 86.0, 60.0, 100.0, 150.0, 15.0, 120.0, 110.0, 130.0, 170.0, 40.0, 70.0, 90.0, 80.0, 95.0, 90.0, 40.0, 80.0, 90.0, 100.0, 70.0, 120.0, 80.0, 18.0, 180.0, 77.0, 90.0, 38.0, 90.0, 88.0, 102.0, 50.0, 20.0, 17.0, 70.0, 90.0, 70.0, 80.0, 50.0, 50.0, 90.0, 60.0, 100.0, 60.0, 70.0, 100.0, 100.0, 130.0, 40.0, 40.0, 60.0, 120.0, -5.0, 29.0, 30.0, 110.0, 140.0, 20.0, 80.0, 50.0, 70.0, 30.0, 80.0, 50.0, 70.0, 60.0, 80.0, 80.0, 40.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.385882111439602, "mean_inference_ms": 2.516454811707976, "mean_action_processing_ms": 0.7148614304472047, "mean_env_wait_ms": 1.6691207946833517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011857986450195312, "StateBufferConnector_ms": 0.008758783340454102, "ViewRequirementAgentConnector_ms": 0.3764224052429199}, "num_episodes": 27, "episode_return_max": 1060.0, "episode_return_min": 143.0, "episode_return_mean": 662.68}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.645919907069576, "num_env_steps_trained_throughput_per_sec": 20.645919907069576, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 209885.609, "restore_workers_time_ms": 0.012, "training_step_time_ms": 209885.559, "sample_time_ms": 3088.651, "learn_time_ms": 206776.32, "learn_throughput": 19.345, "synch_weights_time_ms": 13.034}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 29, "trial_id": "1841f_00000", "date": "2024-08-08_01-16-28", "timestamp": 1723094188, "time_this_iter_s": 193.75497889518738, "time_total_s": 6973.392205476761, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b291ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6973.392205476761, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 16.98722627737226, "ram_util_percent": 77.93211678832117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4921619435976616, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.688645967812584, "policy_loss": -0.012477078708855751, "vf_loss": 7.699530435751041, "vf_explained_var": -0.0005764327237146477, "kl": 0.007963064638103397, "entropy": 0.9287426486817666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 277005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 1060.0, "episode_reward_min": 268.0, "episode_reward_mean": 689.37, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -99.0}, "policy_reward_max": {"policy_0": 230.0}, "policy_reward_mean": {"policy_0": 68.937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [547.0, 635.0, 340.0, 867.0, 650.0, 686.0, 571.0, 740.0, 680.0, 868.0, 610.0, 268.0, 482.0, 476.0, 853.0, 665.0, 774.0, 813.0, 592.0, 603.0, 738.0, 456.0, 690.0, 763.0, 632.0, 740.0, 362.0, 502.0, 649.0, 485.0, 512.0, 689.0, 598.0, 875.0, 635.0, 337.0, 626.0, 872.0, 632.0, 946.0, 890.0, 667.0, 775.0, 820.0, 500.0, 623.0, 680.0, 550.0, 605.0, 277.0, 530.0, 611.0, 1039.0, 680.0, 444.0, 595.0, 885.0, 812.0, 634.0, 769.0, 1060.0, 591.0, 690.0, 560.0, 740.0, 928.0, 784.0, 748.0, 680.0, 725.0, 596.0, 870.0, 725.0, 729.0, 660.0, 1041.0, 775.0, 851.0, 599.0, 790.0, 634.0, 690.0, 882.0, 614.0, 849.0, 830.0, 1050.0, 524.0, 710.0, 678.0, 667.0, 704.0, 832.0, 558.0, 615.0, 864.0, 585.0, 960.0, 684.0, 1020.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 60.0, 96.0, 180.0, 25.0, 30.0, -99.0, 5.0, 110.0, 60.0, 70.0, 150.0, -75.0, 70.0, 30.0, 50.0, 80.0, 130.0, 60.0, 70.0, 40.0, 80.0, 0.0, 30.0, 70.0, 0.0, 30.0, 30.0, 20.0, 40.0, 210.0, 80.0, 120.0, 80.0, 60.0, 70.0, 110.0, 10.0, 80.0, 47.0, 100.0, 110.0, 40.0, 10.0, 160.0, 50.0, 20.0, 80.0, 20.0, 60.0, 110.0, 79.0, 49.0, 90.0, 50.0, 10.0, 110.0, 80.0, 58.0, 50.0, 100.0, 120.0, 99.0, 70.0, 30.0, 20.0, 30.0, 13.0, 49.0, 40.0, 210.0, 100.0, 70.0, 60.0, 80.0, 30.0, 20.0, 40.0, 70.0, 60.0, 120.0, 80.0, 30.0, 110.0, 40.0, 80.0, 30.0, 30.0, 100.0, 60.0, 120.0, 100.0, 78.0, 100.0, 50.0, 50.0, 100.0, 80.0, 120.0, 70.0, 110.0, 60.0, 60.0, 40.0, 20.0, 40.0, 70.0, 60.0, 70.0, 80.0, 90.0, 15.0, 50.0, 50.0, 49.0, -40.0, 19.0, 10.0, 15.0, 10.0, 11.0, 1.0, 45.0, 11.0, 100.0, 58.0, 50.0, 26.0, 60.0, 120.0, 60.0, 23.0, 70.0, 133.0, -27.0, 46.0, 35.0, 60.0, 36.0, 40.0, 73.0, 90.0, 40.0, 120.0, 170.0, 110.0, 80.0, 20.0, 90.0, 60.0, 100.0, 50.0, 100.0, 0.0, 64.0, 87.0, 90.0, 54.0, 54.0, 66.0, 120.0, 70.0, 122.0, 76.0, 100.0, 20.0, 80.0, 70.0, 18.0, 98.0, 80.0, 40.0, 80.0, 120.0, 80.0, -17.0, 120.0, 120.0, 100.0, 90.0, 60.0, -12.0, 60.0, 44.0, 100.0, 140.0, 60.0, 40.0, 80.0, 20.0, 220.0, 50.0, 100.0, 30.0, 18.0, 25.0, 35.0, 40.0, 60.0, 25.0, 30.0, 50.0, 140.0, 110.0, 80.0, 30.0, 60.0, 98.0, 90.0, 50.0, 70.0, 35.0, 40.0, 30.0, 90.0, -35.0, 40.0, 46.0, 110.0, 30.0, 70.0, 0.0, 130.0, 90.0, 90.0, 40.0, 80.0, 70.0, 10.0, 110.0, 40.0, 110.0, 70.0, 110.0, 38.0, 60.0, 30.0, 100.0, 65.0, 140.0, 50.0, 68.0, 130.0, 24.0, 70.0, 30.0, 70.0, 90.0, 30.0, 70.0, 60.0, 40.0, 90.0, 70.0, 30.0, 60.0, 100.0, 140.0, 80.0, 70.0, 70.0, 69.0, 60.0, 40.0, 60.0, 5.0, 34.0, -10.0, 0.0, 34.0, 60.0, 70.0, -5.0, -1.0, 150.0, 60.0, 60.0, 70.0, -32.0, 70.0, 40.0, 50.0, 25.0, 180.0, 59.0, -5.0, 0.0, 90.0, 70.0, 140.0, 70.0, 20.0, -5.0, 30.0, 70.0, 140.0, 60.0, 10.0, 70.0, 20.0, -5.0, 40.0, 60.0, 63.0, -15.0, 120.0, 80.0, 70.0, 80.0, 19.0, 80.0, 51.0, 40.0, 60.0, 48.0, 75.0, 40.0, 100.0, 55.0, 140.0, 64.0, 4.0, 50.0, 100.0, 50.0, 31.0, 20.0, 130.0, 79.0, 70.0, 90.0, 90.0, 95.0, 80.0, 120.0, 100.0, 120.0, 60.0, 90.0, 30.0, -55.0, 160.0, 30.0, 80.0, 60.0, 120.0, 100.0, 50.0, 60.0, 30.0, 60.0, 9.0, 90.0, 70.0, -7.0, 50.0, -5.0, 30.0, 20.0, 20.0, 100.0, 90.0, 40.0, 20.0, 50.0, 70.0, 26.0, 40.0, 50.0, 140.0, 55.0, 140.0, 18.0, 110.0, 130.0, 100.0, 99.0, 110.0, 80.0, 30.0, 100.0, 42.0, 30.0, 60.0, 28.0, 65.0, 40.0, 87.0, 110.0, 70.0, 90.0, 140.0, 178.0, 130.0, 90.0, 80.0, 70.0, 80.0, 8.0, 80.0, 70.0, 200.0, 40.0, 90.0, 80.0, 80.0, 40.0, 110.0, 100.0, 80.0, 220.0, 94.0, 40.0, -37.0, 0.0, 50.0, 80.0, 30.0, 50.0, 140.0, 67.0, 60.0, 80.0, 40.0, 130.0, 160.0, 20.0, 80.0, 88.0, 50.0, 100.0, 130.0, 40.0, 56.0, 60.0, 86.0, 20.0, 100.0, 170.0, 58.0, 40.0, 50.0, 40.0, 30.0, 50.0, 10.0, 10.0, 80.0, 140.0, 50.0, 90.0, 70.0, 80.0, 10.0, 36.0, 60.0, 17.0, 90.0, 120.0, 50.0, 80.0, 60.0, 80.0, 50.0, 40.0, 40.0, 190.0, 30.0, 60.0, 50.0, 30.0, 90.0, 70.0, 40.0, 40.0, 70.0, 20.0, 50.0, 60.0, 80.0, 70.0, 70.0, 66.0, 91.0, 26.0, 42.0, 30.0, 50.0, 80.0, 80.0, -11.0, 30.0, 80.0, 8.0, 40.0, 40.0, 40.0, 30.0, 0.0, 20.0, 10.0, 40.0, -14.0, 22.0, 110.0, 51.0, 4.0, 130.0, 67.0, 110.0, 0.0, 120.0, 32.0, 140.0, 70.0, 105.0, 50.0, 30.0, -6.0, 70.0, 26.0, 200.0, 25.0, 128.0, 90.0, 80.0, 150.0, 70.0, 80.0, 190.0, 120.0, 20.0, 70.0, 90.0, 20.0, 80.0, 70.0, 90.0, 60.0, 60.0, 34.0, 50.0, 70.0, -14.0, 27.0, 28.0, 50.0, 29.0, 110.0, 60.0, 110.0, 25.0, 80.0, 70.0, 40.0, 55.0, 15.0, 70.0, 80.0, 50.0, 120.0, 50.0, 78.0, 70.0, 120.0, 100.0, 117.0, 40.0, 55.0, 135.0, 100.0, 50.0, 60.0, 50.0, 27.0, 68.0, 130.0, 27.0, 110.0, 190.0, 50.0, 56.0, 99.0, 47.0, 3.0, 65.0, 20.0, 33.0, 230.0, 31.0, 110.0, 50.0, 110.0, 88.0, 70.0, 58.0, 90.0, 60.0, 80.0, 53.0, 70.0, 80.0, 160.0, 100.0, 110.0, 40.0, 160.0, 100.0, 100.0, 140.0, 130.0, 68.0, 60.0, 39.0, 6.0, 60.0, 80.0, 18.0, 40.0, 90.0, 60.0, 90.0, 50.0, 80.0, 120.0, 40.0, 150.0, 30.0, 50.0, 20.0, 40.0, 80.0, 40.0, 30.0, 50.0, 140.0, -20.0, 70.0, 50.0, 80.0, 70.0, 40.0, 30.0, 100.0, 70.0, 50.0, 70.0, 160.0, 60.0, 90.0, 50.0, 43.0, 90.0, 140.0, 45.0, 140.0, 120.0, 80.0, 120.0, 100.0, 150.0, 70.0, 70.0, 38.0, 70.0, 110.0, 30.0, 60.0, 66.0, 120.0, 80.0, 80.0, 60.0, 20.0, 80.0, 35.0, 120.0, 104.0, 90.0, 79.0, 20.0, 50.0, 100.0, 70.0, 90.0, 60.0, 50.0, 50.0, 110.0, 80.0, 70.0, 130.0, 15.0, -3.0, 110.0, 90.0, 110.0, 75.0, 120.0, 8.0, 70.0, 10.0, -12.0, 110.0, 34.0, 59.0, 130.0, 17.0, 9.0, 169.0, 90.0, 150.0, 170.0, 100.0, 30.0, 90.0, 20.0, 80.0, 100.0, 40.0, 50.0, 170.0, 90.0, 70.0, 70.0, 30.0, 100.0, 70.0, 60.0, 15.0, 100.0, 50.0, 80.0, 49.0, 60.0, 120.0, 70.0, 20.0, 60.0, 120.0, 40.0, 70.0, 90.0, 20.0, 110.0, 70.0, 50.0, 50.0, 60.0, 100.0, 100.0, 86.0, 60.0, 100.0, 150.0, 15.0, 120.0, 110.0, 130.0, 170.0, 40.0, 70.0, 90.0, 80.0, 95.0, 90.0, 40.0, 80.0, 90.0, 100.0, 70.0, 120.0, 80.0, 18.0, 180.0, 77.0, 90.0, 38.0, 90.0, 88.0, 102.0, 50.0, 20.0, 17.0, 70.0, 90.0, 70.0, 80.0, 50.0, 50.0, 90.0, 60.0, 100.0, 60.0, 70.0, 100.0, 100.0, 130.0, 40.0, 40.0, 60.0, 120.0, -5.0, 29.0, 30.0, 110.0, 140.0, 20.0, 80.0, 50.0, 70.0, 30.0, 80.0, 50.0, 70.0, 60.0, 80.0, 80.0, 40.0, 130.0, 90.0, 60.0, 56.0, 36.0, 110.0, 90.0, 120.0, 100.0, 80.0, 140.0, 70.0, 29.0, 95.0, 60.0, 70.0, 90.0, 50.0, 80.0, 50.0, 20.0, 90.0, 50.0, 190.0, 70.0, 30.0, 150.0, 60.0, 119.0, 50.0, 40.0, 155.0, 46.0, 120.0, 70.0, 19.0, 90.0, 70.0, 130.0, 70.0, 60.0, 160.0, 160.0, 180.0, 120.0, 80.0, 50.0, 30.0, 80.0, 80.0, 110.0, 10.0, 55.0, 100.0, -2.0, 100.0, 40.0, 89.0, 13.0, 49.0, 70.0, 90.0, 200.0, 60.0, 0.0, 50.0, 50.0, 50.0, 60.0, 80.0, 70.0, 10.0, 60.0, 160.0, 80.0, 40.0, 60.0, 50.0, 38.0, 100.0, 80.0, 50.0, 130.0, 30.0, 120.0, 30.0, 58.0, 40.0, 89.0, 80.0, 40.0, 70.0, 50.0, 30.0, 50.0, 70.0, 150.0, 77.0, 87.0, 90.0, 30.0, 110.0, 110.0, 160.0, 80.0, 16.0, 50.0, 51.0, 110.0, 100.0, 45.0, 20.0, 110.0, 25.0, 110.0, 90.0, 7.0, 29.0, 33.0, 110.0, 24.0, 70.0, 60.0, 120.0, 90.0, 27.0, 80.0, 8.0, 40.0, 70.0, 50.0, 140.0, 30.0, 130.0, 38.0, 50.0, 80.0, 60.0, 110.0, 46.0, 180.0, 59.0, 130.0, 50.0, 44.0, 140.0, 130.0, 30.0, 13.0, -13.0, 2.0, 80.0, 150.0, 100.0, 94.0, 80.0, 130.0, 46.0, 110.0, 90.0, 80.0, 23.0, 40.0, 50.0, 70.0, 70.0, 80.0, 130.0, 50.0, 130.0, 41.0, 140.0, 90.0, 220.0, 120.0, 40.0, 100.0, 95.0, 85.0, 60.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.355448934756247, "mean_inference_ms": 2.4801181236006404, "mean_action_processing_ms": 0.705488572840705, "mean_env_wait_ms": 1.6464253096106896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011909246444702148, "StateBufferConnector_ms": 0.008742094039916992, "ViewRequirementAgentConnector_ms": 0.369431734085083}, "num_episodes": 18, "episode_return_max": 1060.0, "episode_return_min": 268.0, "episode_return_mean": 689.37}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.606876427482543, "num_env_steps_trained_throughput_per_sec": 20.606876427482543, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 202400.712, "restore_workers_time_ms": 0.012, "training_step_time_ms": 202400.662, "sample_time_ms": 2870.004, "learn_time_ms": 199510.772, "learn_throughput": 20.049, "synch_weights_time_ms": 12.219}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 30, "trial_id": "1841f_00000", "date": "2024-08-08_01-19-42", "timestamp": 1723094382, "time_this_iter_s": 194.12227487564087, "time_total_s": 7167.514480352402, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x16f98a0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7167.514480352402, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.83941605839416, "ram_util_percent": 77.47518248175183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.592641000225902, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.850378434218792, "policy_loss": -0.011832069345433523, "vf_loss": 7.860629651543939, "vf_explained_var": -0.00023833972196609448, "kl": 0.007904228196570976, "entropy": 0.9362452875564908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 286395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 1060.0, "episode_reward_min": 277.0, "episode_reward_mean": 700.33, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -55.0}, "policy_reward_max": {"policy_0": 230.0}, "policy_reward_mean": {"policy_0": 70.033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [592.0, 603.0, 738.0, 456.0, 690.0, 763.0, 632.0, 740.0, 362.0, 502.0, 649.0, 485.0, 512.0, 689.0, 598.0, 875.0, 635.0, 337.0, 626.0, 872.0, 632.0, 946.0, 890.0, 667.0, 775.0, 820.0, 500.0, 623.0, 680.0, 550.0, 605.0, 277.0, 530.0, 611.0, 1039.0, 680.0, 444.0, 595.0, 885.0, 812.0, 634.0, 769.0, 1060.0, 591.0, 690.0, 560.0, 740.0, 928.0, 784.0, 748.0, 680.0, 725.0, 596.0, 870.0, 725.0, 729.0, 660.0, 1041.0, 775.0, 851.0, 599.0, 790.0, 634.0, 690.0, 882.0, 614.0, 849.0, 830.0, 1050.0, 524.0, 710.0, 678.0, 667.0, 704.0, 832.0, 558.0, 615.0, 864.0, 585.0, 960.0, 684.0, 1020.0, 745.0, 790.0, 795.0, 550.0, 820.0, 424.0, 723.0, 610.0, 929.0, 784.0, 550.0, 821.0, 725.0, 700.0, 571.0, 456.0, 748.0, 880.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, -12.0, 60.0, 44.0, 100.0, 140.0, 60.0, 40.0, 80.0, 20.0, 220.0, 50.0, 100.0, 30.0, 18.0, 25.0, 35.0, 40.0, 60.0, 25.0, 30.0, 50.0, 140.0, 110.0, 80.0, 30.0, 60.0, 98.0, 90.0, 50.0, 70.0, 35.0, 40.0, 30.0, 90.0, -35.0, 40.0, 46.0, 110.0, 30.0, 70.0, 0.0, 130.0, 90.0, 90.0, 40.0, 80.0, 70.0, 10.0, 110.0, 40.0, 110.0, 70.0, 110.0, 38.0, 60.0, 30.0, 100.0, 65.0, 140.0, 50.0, 68.0, 130.0, 24.0, 70.0, 30.0, 70.0, 90.0, 30.0, 70.0, 60.0, 40.0, 90.0, 70.0, 30.0, 60.0, 100.0, 140.0, 80.0, 70.0, 70.0, 69.0, 60.0, 40.0, 60.0, 5.0, 34.0, -10.0, 0.0, 34.0, 60.0, 70.0, -5.0, -1.0, 150.0, 60.0, 60.0, 70.0, -32.0, 70.0, 40.0, 50.0, 25.0, 180.0, 59.0, -5.0, 0.0, 90.0, 70.0, 140.0, 70.0, 20.0, -5.0, 30.0, 70.0, 140.0, 60.0, 10.0, 70.0, 20.0, -5.0, 40.0, 60.0, 63.0, -15.0, 120.0, 80.0, 70.0, 80.0, 19.0, 80.0, 51.0, 40.0, 60.0, 48.0, 75.0, 40.0, 100.0, 55.0, 140.0, 64.0, 4.0, 50.0, 100.0, 50.0, 31.0, 20.0, 130.0, 79.0, 70.0, 90.0, 90.0, 95.0, 80.0, 120.0, 100.0, 120.0, 60.0, 90.0, 30.0, -55.0, 160.0, 30.0, 80.0, 60.0, 120.0, 100.0, 50.0, 60.0, 30.0, 60.0, 9.0, 90.0, 70.0, -7.0, 50.0, -5.0, 30.0, 20.0, 20.0, 100.0, 90.0, 40.0, 20.0, 50.0, 70.0, 26.0, 40.0, 50.0, 140.0, 55.0, 140.0, 18.0, 110.0, 130.0, 100.0, 99.0, 110.0, 80.0, 30.0, 100.0, 42.0, 30.0, 60.0, 28.0, 65.0, 40.0, 87.0, 110.0, 70.0, 90.0, 140.0, 178.0, 130.0, 90.0, 80.0, 70.0, 80.0, 8.0, 80.0, 70.0, 200.0, 40.0, 90.0, 80.0, 80.0, 40.0, 110.0, 100.0, 80.0, 220.0, 94.0, 40.0, -37.0, 0.0, 50.0, 80.0, 30.0, 50.0, 140.0, 67.0, 60.0, 80.0, 40.0, 130.0, 160.0, 20.0, 80.0, 88.0, 50.0, 100.0, 130.0, 40.0, 56.0, 60.0, 86.0, 20.0, 100.0, 170.0, 58.0, 40.0, 50.0, 40.0, 30.0, 50.0, 10.0, 10.0, 80.0, 140.0, 50.0, 90.0, 70.0, 80.0, 10.0, 36.0, 60.0, 17.0, 90.0, 120.0, 50.0, 80.0, 60.0, 80.0, 50.0, 40.0, 40.0, 190.0, 30.0, 60.0, 50.0, 30.0, 90.0, 70.0, 40.0, 40.0, 70.0, 20.0, 50.0, 60.0, 80.0, 70.0, 70.0, 66.0, 91.0, 26.0, 42.0, 30.0, 50.0, 80.0, 80.0, -11.0, 30.0, 80.0, 8.0, 40.0, 40.0, 40.0, 30.0, 0.0, 20.0, 10.0, 40.0, -14.0, 22.0, 110.0, 51.0, 4.0, 130.0, 67.0, 110.0, 0.0, 120.0, 32.0, 140.0, 70.0, 105.0, 50.0, 30.0, -6.0, 70.0, 26.0, 200.0, 25.0, 128.0, 90.0, 80.0, 150.0, 70.0, 80.0, 190.0, 120.0, 20.0, 70.0, 90.0, 20.0, 80.0, 70.0, 90.0, 60.0, 60.0, 34.0, 50.0, 70.0, -14.0, 27.0, 28.0, 50.0, 29.0, 110.0, 60.0, 110.0, 25.0, 80.0, 70.0, 40.0, 55.0, 15.0, 70.0, 80.0, 50.0, 120.0, 50.0, 78.0, 70.0, 120.0, 100.0, 117.0, 40.0, 55.0, 135.0, 100.0, 50.0, 60.0, 50.0, 27.0, 68.0, 130.0, 27.0, 110.0, 190.0, 50.0, 56.0, 99.0, 47.0, 3.0, 65.0, 20.0, 33.0, 230.0, 31.0, 110.0, 50.0, 110.0, 88.0, 70.0, 58.0, 90.0, 60.0, 80.0, 53.0, 70.0, 80.0, 160.0, 100.0, 110.0, 40.0, 160.0, 100.0, 100.0, 140.0, 130.0, 68.0, 60.0, 39.0, 6.0, 60.0, 80.0, 18.0, 40.0, 90.0, 60.0, 90.0, 50.0, 80.0, 120.0, 40.0, 150.0, 30.0, 50.0, 20.0, 40.0, 80.0, 40.0, 30.0, 50.0, 140.0, -20.0, 70.0, 50.0, 80.0, 70.0, 40.0, 30.0, 100.0, 70.0, 50.0, 70.0, 160.0, 60.0, 90.0, 50.0, 43.0, 90.0, 140.0, 45.0, 140.0, 120.0, 80.0, 120.0, 100.0, 150.0, 70.0, 70.0, 38.0, 70.0, 110.0, 30.0, 60.0, 66.0, 120.0, 80.0, 80.0, 60.0, 20.0, 80.0, 35.0, 120.0, 104.0, 90.0, 79.0, 20.0, 50.0, 100.0, 70.0, 90.0, 60.0, 50.0, 50.0, 110.0, 80.0, 70.0, 130.0, 15.0, -3.0, 110.0, 90.0, 110.0, 75.0, 120.0, 8.0, 70.0, 10.0, -12.0, 110.0, 34.0, 59.0, 130.0, 17.0, 9.0, 169.0, 90.0, 150.0, 170.0, 100.0, 30.0, 90.0, 20.0, 80.0, 100.0, 40.0, 50.0, 170.0, 90.0, 70.0, 70.0, 30.0, 100.0, 70.0, 60.0, 15.0, 100.0, 50.0, 80.0, 49.0, 60.0, 120.0, 70.0, 20.0, 60.0, 120.0, 40.0, 70.0, 90.0, 20.0, 110.0, 70.0, 50.0, 50.0, 60.0, 100.0, 100.0, 86.0, 60.0, 100.0, 150.0, 15.0, 120.0, 110.0, 130.0, 170.0, 40.0, 70.0, 90.0, 80.0, 95.0, 90.0, 40.0, 80.0, 90.0, 100.0, 70.0, 120.0, 80.0, 18.0, 180.0, 77.0, 90.0, 38.0, 90.0, 88.0, 102.0, 50.0, 20.0, 17.0, 70.0, 90.0, 70.0, 80.0, 50.0, 50.0, 90.0, 60.0, 100.0, 60.0, 70.0, 100.0, 100.0, 130.0, 40.0, 40.0, 60.0, 120.0, -5.0, 29.0, 30.0, 110.0, 140.0, 20.0, 80.0, 50.0, 70.0, 30.0, 80.0, 50.0, 70.0, 60.0, 80.0, 80.0, 40.0, 130.0, 90.0, 60.0, 56.0, 36.0, 110.0, 90.0, 120.0, 100.0, 80.0, 140.0, 70.0, 29.0, 95.0, 60.0, 70.0, 90.0, 50.0, 80.0, 50.0, 20.0, 90.0, 50.0, 190.0, 70.0, 30.0, 150.0, 60.0, 119.0, 50.0, 40.0, 155.0, 46.0, 120.0, 70.0, 19.0, 90.0, 70.0, 130.0, 70.0, 60.0, 160.0, 160.0, 180.0, 120.0, 80.0, 50.0, 30.0, 80.0, 80.0, 110.0, 10.0, 55.0, 100.0, -2.0, 100.0, 40.0, 89.0, 13.0, 49.0, 70.0, 90.0, 200.0, 60.0, 0.0, 50.0, 50.0, 50.0, 60.0, 80.0, 70.0, 10.0, 60.0, 160.0, 80.0, 40.0, 60.0, 50.0, 38.0, 100.0, 80.0, 50.0, 130.0, 30.0, 120.0, 30.0, 58.0, 40.0, 89.0, 80.0, 40.0, 70.0, 50.0, 30.0, 50.0, 70.0, 150.0, 77.0, 87.0, 90.0, 30.0, 110.0, 110.0, 160.0, 80.0, 16.0, 50.0, 51.0, 110.0, 100.0, 45.0, 20.0, 110.0, 25.0, 110.0, 90.0, 7.0, 29.0, 33.0, 110.0, 24.0, 70.0, 60.0, 120.0, 90.0, 27.0, 80.0, 8.0, 40.0, 70.0, 50.0, 140.0, 30.0, 130.0, 38.0, 50.0, 80.0, 60.0, 110.0, 46.0, 180.0, 59.0, 130.0, 50.0, 44.0, 140.0, 130.0, 30.0, 13.0, -13.0, 2.0, 80.0, 150.0, 100.0, 94.0, 80.0, 130.0, 46.0, 110.0, 90.0, 80.0, 23.0, 40.0, 50.0, 70.0, 70.0, 80.0, 130.0, 50.0, 130.0, 41.0, 140.0, 90.0, 220.0, 120.0, 40.0, 100.0, 95.0, 85.0, 60.0, 70.0, 50.0, 70.0, 90.0, 80.0, 47.0, 80.0, 50.0, 98.0, 40.0, 140.0, 10.0, 50.0, 130.0, 90.0, 140.0, 90.0, 100.0, 60.0, 50.0, 70.0, 100.0, 100.0, 56.0, 90.0, 120.0, 19.0, 90.0, 120.0, 19.0, 81.0, 110.0, 30.0, 30.0, 150.0, 40.0, 30.0, 50.0, 80.0, 20.0, 10.0, 100.0, 150.0, 120.0, 130.0, 40.0, 50.0, 70.0, 30.0, 80.0, 50.0, 44.0, 60.0, 40.0, 70.0, 28.0, 60.0, 65.0, 1.0, 26.0, 30.0, 50.0, 60.0, 80.0, 120.0, 110.0, 30.0, 53.0, 110.0, 70.0, 40.0, 70.0, 69.0, 42.0, 90.0, 70.0, 40.0, 70.0, 60.0, 70.0, 29.0, 150.0, 60.0, 150.0, 100.0, 70.0, 130.0, 90.0, 50.0, 79.0, 50.0, 60.0, 30.0, -12.0, 60.0, 140.0, 80.0, 211.0, 80.0, 65.0, 70.0, 40.0, 10.0, 50.0, 110.0, 70.0, 20.0, 70.0, 70.0, 80.0, 30.0, 66.0, 100.0, 30.0, 90.0, 130.0, 115.0, 40.0, 70.0, 70.0, 110.0, 70.0, 60.0, 59.0, 79.0, 55.0, 162.0, 39.0, 57.0, 40.0, 104.0, 50.0, 50.0, 160.0, 30.0, 20.0, 100.0, 100.0, 100.0, 50.0, 40.0, 90.0, 16.0, 70.0, 5.0, 60.0, 60.0, 10.0, 60.0, 110.0, 90.0, 60.0, 30.0, 30.0, 120.0, 90.0, 20.0, -7.0, 10.0, 33.0, 70.0, 110.0, 130.0, 120.0, 34.0, 30.0, 40.0, 14.0, 90.0, 150.0, 30.0, 90.0, 30.0, 200.0, 50.0, 130.0, 80.0, 60.0, 40.0, 120.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.327718116479913, "mean_inference_ms": 2.446986544409938, "mean_action_processing_ms": 0.6968224602262114, "mean_env_wait_ms": 1.625325856548286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012203693389892578, "StateBufferConnector_ms": 0.008965015411376953, "ViewRequirementAgentConnector_ms": 0.38979053497314453}, "num_episodes": 18, "episode_return_max": 1060.0, "episode_return_min": 277.0, "episode_return_mean": 700.33}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.59706995406845, "num_env_steps_trained_throughput_per_sec": 20.59706995406845, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 195260.935, "restore_workers_time_ms": 0.012, "training_step_time_ms": 195260.887, "sample_time_ms": 2578.135, "learn_time_ms": 192662.873, "learn_throughput": 20.762, "synch_weights_time_ms": 11.646}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 31, "trial_id": "1841f_00000", "date": "2024-08-08_01-22-56", "timestamp": 1723094576, "time_this_iter_s": 194.21099591255188, "time_total_s": 7361.725476264954, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b291be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7361.725476264954, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 17.494909090909093, "ram_util_percent": 77.86399999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2633026989059832, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.760064171881467, "policy_loss": -0.012807786175475334, "vf_loss": 7.771234282898827, "vf_explained_var": -0.0005324349934046769, "kl": 0.008188345377914985, "entropy": 0.9002578440565652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 1070.0, "episode_reward_min": 277.0, "episode_reward_mean": 723.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -37.0}, "policy_reward_max": {"policy_0": 240.0}, "policy_reward_mean": {"policy_0": 72.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [626.0, 872.0, 632.0, 946.0, 890.0, 667.0, 775.0, 820.0, 500.0, 623.0, 680.0, 550.0, 605.0, 277.0, 530.0, 611.0, 1039.0, 680.0, 444.0, 595.0, 885.0, 812.0, 634.0, 769.0, 1060.0, 591.0, 690.0, 560.0, 740.0, 928.0, 784.0, 748.0, 680.0, 725.0, 596.0, 870.0, 725.0, 729.0, 660.0, 1041.0, 775.0, 851.0, 599.0, 790.0, 634.0, 690.0, 882.0, 614.0, 849.0, 830.0, 1050.0, 524.0, 710.0, 678.0, 667.0, 704.0, 832.0, 558.0, 615.0, 864.0, 585.0, 960.0, 684.0, 1020.0, 745.0, 790.0, 795.0, 550.0, 820.0, 424.0, 723.0, 610.0, 929.0, 784.0, 550.0, 821.0, 725.0, 700.0, 571.0, 456.0, 748.0, 880.0, 545.0, 539.0, 906.0, 610.0, 490.0, 883.0, 1070.0, 900.0, 694.0, 771.0, 586.0, 850.0, 949.0, 567.0, 578.0, 791.0, 757.0, 689.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 90.0, 40.0, 20.0, 50.0, 70.0, 26.0, 40.0, 50.0, 140.0, 55.0, 140.0, 18.0, 110.0, 130.0, 100.0, 99.0, 110.0, 80.0, 30.0, 100.0, 42.0, 30.0, 60.0, 28.0, 65.0, 40.0, 87.0, 110.0, 70.0, 90.0, 140.0, 178.0, 130.0, 90.0, 80.0, 70.0, 80.0, 8.0, 80.0, 70.0, 200.0, 40.0, 90.0, 80.0, 80.0, 40.0, 110.0, 100.0, 80.0, 220.0, 94.0, 40.0, -37.0, 0.0, 50.0, 80.0, 30.0, 50.0, 140.0, 67.0, 60.0, 80.0, 40.0, 130.0, 160.0, 20.0, 80.0, 88.0, 50.0, 100.0, 130.0, 40.0, 56.0, 60.0, 86.0, 20.0, 100.0, 170.0, 58.0, 40.0, 50.0, 40.0, 30.0, 50.0, 10.0, 10.0, 80.0, 140.0, 50.0, 90.0, 70.0, 80.0, 10.0, 36.0, 60.0, 17.0, 90.0, 120.0, 50.0, 80.0, 60.0, 80.0, 50.0, 40.0, 40.0, 190.0, 30.0, 60.0, 50.0, 30.0, 90.0, 70.0, 40.0, 40.0, 70.0, 20.0, 50.0, 60.0, 80.0, 70.0, 70.0, 66.0, 91.0, 26.0, 42.0, 30.0, 50.0, 80.0, 80.0, -11.0, 30.0, 80.0, 8.0, 40.0, 40.0, 40.0, 30.0, 0.0, 20.0, 10.0, 40.0, -14.0, 22.0, 110.0, 51.0, 4.0, 130.0, 67.0, 110.0, 0.0, 120.0, 32.0, 140.0, 70.0, 105.0, 50.0, 30.0, -6.0, 70.0, 26.0, 200.0, 25.0, 128.0, 90.0, 80.0, 150.0, 70.0, 80.0, 190.0, 120.0, 20.0, 70.0, 90.0, 20.0, 80.0, 70.0, 90.0, 60.0, 60.0, 34.0, 50.0, 70.0, -14.0, 27.0, 28.0, 50.0, 29.0, 110.0, 60.0, 110.0, 25.0, 80.0, 70.0, 40.0, 55.0, 15.0, 70.0, 80.0, 50.0, 120.0, 50.0, 78.0, 70.0, 120.0, 100.0, 117.0, 40.0, 55.0, 135.0, 100.0, 50.0, 60.0, 50.0, 27.0, 68.0, 130.0, 27.0, 110.0, 190.0, 50.0, 56.0, 99.0, 47.0, 3.0, 65.0, 20.0, 33.0, 230.0, 31.0, 110.0, 50.0, 110.0, 88.0, 70.0, 58.0, 90.0, 60.0, 80.0, 53.0, 70.0, 80.0, 160.0, 100.0, 110.0, 40.0, 160.0, 100.0, 100.0, 140.0, 130.0, 68.0, 60.0, 39.0, 6.0, 60.0, 80.0, 18.0, 40.0, 90.0, 60.0, 90.0, 50.0, 80.0, 120.0, 40.0, 150.0, 30.0, 50.0, 20.0, 40.0, 80.0, 40.0, 30.0, 50.0, 140.0, -20.0, 70.0, 50.0, 80.0, 70.0, 40.0, 30.0, 100.0, 70.0, 50.0, 70.0, 160.0, 60.0, 90.0, 50.0, 43.0, 90.0, 140.0, 45.0, 140.0, 120.0, 80.0, 120.0, 100.0, 150.0, 70.0, 70.0, 38.0, 70.0, 110.0, 30.0, 60.0, 66.0, 120.0, 80.0, 80.0, 60.0, 20.0, 80.0, 35.0, 120.0, 104.0, 90.0, 79.0, 20.0, 50.0, 100.0, 70.0, 90.0, 60.0, 50.0, 50.0, 110.0, 80.0, 70.0, 130.0, 15.0, -3.0, 110.0, 90.0, 110.0, 75.0, 120.0, 8.0, 70.0, 10.0, -12.0, 110.0, 34.0, 59.0, 130.0, 17.0, 9.0, 169.0, 90.0, 150.0, 170.0, 100.0, 30.0, 90.0, 20.0, 80.0, 100.0, 40.0, 50.0, 170.0, 90.0, 70.0, 70.0, 30.0, 100.0, 70.0, 60.0, 15.0, 100.0, 50.0, 80.0, 49.0, 60.0, 120.0, 70.0, 20.0, 60.0, 120.0, 40.0, 70.0, 90.0, 20.0, 110.0, 70.0, 50.0, 50.0, 60.0, 100.0, 100.0, 86.0, 60.0, 100.0, 150.0, 15.0, 120.0, 110.0, 130.0, 170.0, 40.0, 70.0, 90.0, 80.0, 95.0, 90.0, 40.0, 80.0, 90.0, 100.0, 70.0, 120.0, 80.0, 18.0, 180.0, 77.0, 90.0, 38.0, 90.0, 88.0, 102.0, 50.0, 20.0, 17.0, 70.0, 90.0, 70.0, 80.0, 50.0, 50.0, 90.0, 60.0, 100.0, 60.0, 70.0, 100.0, 100.0, 130.0, 40.0, 40.0, 60.0, 120.0, -5.0, 29.0, 30.0, 110.0, 140.0, 20.0, 80.0, 50.0, 70.0, 30.0, 80.0, 50.0, 70.0, 60.0, 80.0, 80.0, 40.0, 130.0, 90.0, 60.0, 56.0, 36.0, 110.0, 90.0, 120.0, 100.0, 80.0, 140.0, 70.0, 29.0, 95.0, 60.0, 70.0, 90.0, 50.0, 80.0, 50.0, 20.0, 90.0, 50.0, 190.0, 70.0, 30.0, 150.0, 60.0, 119.0, 50.0, 40.0, 155.0, 46.0, 120.0, 70.0, 19.0, 90.0, 70.0, 130.0, 70.0, 60.0, 160.0, 160.0, 180.0, 120.0, 80.0, 50.0, 30.0, 80.0, 80.0, 110.0, 10.0, 55.0, 100.0, -2.0, 100.0, 40.0, 89.0, 13.0, 49.0, 70.0, 90.0, 200.0, 60.0, 0.0, 50.0, 50.0, 50.0, 60.0, 80.0, 70.0, 10.0, 60.0, 160.0, 80.0, 40.0, 60.0, 50.0, 38.0, 100.0, 80.0, 50.0, 130.0, 30.0, 120.0, 30.0, 58.0, 40.0, 89.0, 80.0, 40.0, 70.0, 50.0, 30.0, 50.0, 70.0, 150.0, 77.0, 87.0, 90.0, 30.0, 110.0, 110.0, 160.0, 80.0, 16.0, 50.0, 51.0, 110.0, 100.0, 45.0, 20.0, 110.0, 25.0, 110.0, 90.0, 7.0, 29.0, 33.0, 110.0, 24.0, 70.0, 60.0, 120.0, 90.0, 27.0, 80.0, 8.0, 40.0, 70.0, 50.0, 140.0, 30.0, 130.0, 38.0, 50.0, 80.0, 60.0, 110.0, 46.0, 180.0, 59.0, 130.0, 50.0, 44.0, 140.0, 130.0, 30.0, 13.0, -13.0, 2.0, 80.0, 150.0, 100.0, 94.0, 80.0, 130.0, 46.0, 110.0, 90.0, 80.0, 23.0, 40.0, 50.0, 70.0, 70.0, 80.0, 130.0, 50.0, 130.0, 41.0, 140.0, 90.0, 220.0, 120.0, 40.0, 100.0, 95.0, 85.0, 60.0, 70.0, 50.0, 70.0, 90.0, 80.0, 47.0, 80.0, 50.0, 98.0, 40.0, 140.0, 10.0, 50.0, 130.0, 90.0, 140.0, 90.0, 100.0, 60.0, 50.0, 70.0, 100.0, 100.0, 56.0, 90.0, 120.0, 19.0, 90.0, 120.0, 19.0, 81.0, 110.0, 30.0, 30.0, 150.0, 40.0, 30.0, 50.0, 80.0, 20.0, 10.0, 100.0, 150.0, 120.0, 130.0, 40.0, 50.0, 70.0, 30.0, 80.0, 50.0, 44.0, 60.0, 40.0, 70.0, 28.0, 60.0, 65.0, 1.0, 26.0, 30.0, 50.0, 60.0, 80.0, 120.0, 110.0, 30.0, 53.0, 110.0, 70.0, 40.0, 70.0, 69.0, 42.0, 90.0, 70.0, 40.0, 70.0, 60.0, 70.0, 29.0, 150.0, 60.0, 150.0, 100.0, 70.0, 130.0, 90.0, 50.0, 79.0, 50.0, 60.0, 30.0, -12.0, 60.0, 140.0, 80.0, 211.0, 80.0, 65.0, 70.0, 40.0, 10.0, 50.0, 110.0, 70.0, 20.0, 70.0, 70.0, 80.0, 30.0, 66.0, 100.0, 30.0, 90.0, 130.0, 115.0, 40.0, 70.0, 70.0, 110.0, 70.0, 60.0, 59.0, 79.0, 55.0, 162.0, 39.0, 57.0, 40.0, 104.0, 50.0, 50.0, 160.0, 30.0, 20.0, 100.0, 100.0, 100.0, 50.0, 40.0, 90.0, 16.0, 70.0, 5.0, 60.0, 60.0, 10.0, 60.0, 110.0, 90.0, 60.0, 30.0, 30.0, 120.0, 90.0, 20.0, -7.0, 10.0, 33.0, 70.0, 110.0, 130.0, 120.0, 34.0, 30.0, 40.0, 14.0, 90.0, 150.0, 30.0, 90.0, 30.0, 200.0, 50.0, 130.0, 80.0, 60.0, 40.0, 120.0, 80.0, 30.0, 15.0, 190.0, 80.0, 80.0, 30.0, 40.0, 40.0, 40.0, 0.0, 60.0, 46.0, 83.0, 10.0, 40.0, 120.0, 120.0, 30.0, 20.0, 10.0, 80.0, 113.0, 93.0, 20.0, 130.0, 100.0, 60.0, 110.0, 60.0, 140.0, 90.0, 40.0, 50.0, 50.0, 20.0, 100.0, 80.0, 70.0, 40.0, 70.0, 40.0, 58.0, 40.0, 36.0, 40.0, 23.0, 13.0, 70.0, 150.0, 20.0, 140.0, 57.0, 70.0, 80.0, 60.0, 130.0, 50.0, 110.0, 86.0, 100.0, 110.0, 110.0, 90.0, 100.0, 30.0, 170.0, 90.0, 100.0, 170.0, 100.0, 70.0, 20.0, 150.0, 110.0, 60.0, 80.0, 160.0, 60.0, 120.0, 70.0, 30.0, 100.0, 180.0, 90.0, 60.0, 35.0, 60.0, 60.0, 50.0, 29.0, 10.0, 70.0, 80.0, 240.0, 40.0, 117.0, 70.0, 30.0, 44.0, 70.0, 110.0, 35.0, 30.0, 50.0, -7.0, 70.0, 60.0, 52.0, 6.0, 180.0, 130.0, 100.0, 70.0, 70.0, 70.0, 110.0, 140.0, 30.0, 30.0, 100.0, 85.0, 64.0, 80.0, 130.0, 110.0, 70.0, 50.0, 180.0, 30.0, 150.0, 120.0, 130.0, 35.0, 90.0, 59.0, 40.0, 10.0, 40.0, 15.0, 28.0, 70.0, 100.0, 50.0, 150.0, 10.0, 40.0, 80.0, 8.0, 50.0, 20.0, 75.0, -2.0, 40.0, 120.0, 80.0, 80.0, 70.0, 90.0, 160.0, 78.0, 70.0, 38.0, 40.0, 100.0, 30.0, 100.0, 150.0, 70.0, 80.0, 79.0, 80.0, 110.0, 130.0, 80.0, 50.0, 80.0, 30.0, 59.0, 50.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.302285743563902, "mean_inference_ms": 2.4165701796237817, "mean_action_processing_ms": 0.6887768935561038, "mean_env_wait_ms": 1.6056598103811417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012230396270751953, "StateBufferConnector_ms": 0.008912801742553711, "ViewRequirementAgentConnector_ms": 0.387117862701416}, "num_episodes": 18, "episode_return_max": 1070.0, "episode_return_min": 277.0, "episode_return_mean": 723.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.714712561795587, "num_env_steps_trained_throughput_per_sec": 20.714712561795587, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 194929.196, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194929.147, "sample_time_ms": 2412.066, "learn_time_ms": 192497.146, "learn_throughput": 20.78, "synch_weights_time_ms": 11.448}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 32, "trial_id": "1841f_00000", "date": "2024-08-08_01-26-09", "timestamp": 1723094769, "time_this_iter_s": 193.10993814468384, "time_total_s": 7554.835414409637, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b291bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7554.835414409637, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 16.98644688644689, "ram_util_percent": 77.96410256410255}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2444146612645213, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.897387315010745, "policy_loss": -0.012735217044584224, "vf_loss": 7.908578197339091, "vf_explained_var": 0.002240779065984253, "kl": 0.0077216615873577435, "entropy": 0.8645571144942404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 305175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 1070.0, "episode_reward_min": 270.0, "episode_reward_mean": 743.19, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -33.0}, "policy_reward_max": {"policy_0": 240.0}, "policy_reward_mean": {"policy_0": 74.319}, "custom_metrics": {}, "hist_stats": {"episode_reward": [634.0, 769.0, 1060.0, 591.0, 690.0, 560.0, 740.0, 928.0, 784.0, 748.0, 680.0, 725.0, 596.0, 870.0, 725.0, 729.0, 660.0, 1041.0, 775.0, 851.0, 599.0, 790.0, 634.0, 690.0, 882.0, 614.0, 849.0, 830.0, 1050.0, 524.0, 710.0, 678.0, 667.0, 704.0, 832.0, 558.0, 615.0, 864.0, 585.0, 960.0, 684.0, 1020.0, 745.0, 790.0, 795.0, 550.0, 820.0, 424.0, 723.0, 610.0, 929.0, 784.0, 550.0, 821.0, 725.0, 700.0, 571.0, 456.0, 748.0, 880.0, 545.0, 539.0, 906.0, 610.0, 490.0, 883.0, 1070.0, 900.0, 694.0, 771.0, 586.0, 850.0, 949.0, 567.0, 578.0, 791.0, 757.0, 689.0, 870.0, 955.0, 620.0, 730.0, 898.0, 872.0, 690.0, 880.0, 813.0, 830.0, 930.0, 622.0, 540.0, 574.0, 270.0, 933.0, 765.0, 1016.0, 830.0, 1030.0, 915.0, 445.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 56.0, 99.0, 47.0, 3.0, 65.0, 20.0, 33.0, 230.0, 31.0, 110.0, 50.0, 110.0, 88.0, 70.0, 58.0, 90.0, 60.0, 80.0, 53.0, 70.0, 80.0, 160.0, 100.0, 110.0, 40.0, 160.0, 100.0, 100.0, 140.0, 130.0, 68.0, 60.0, 39.0, 6.0, 60.0, 80.0, 18.0, 40.0, 90.0, 60.0, 90.0, 50.0, 80.0, 120.0, 40.0, 150.0, 30.0, 50.0, 20.0, 40.0, 80.0, 40.0, 30.0, 50.0, 140.0, -20.0, 70.0, 50.0, 80.0, 70.0, 40.0, 30.0, 100.0, 70.0, 50.0, 70.0, 160.0, 60.0, 90.0, 50.0, 43.0, 90.0, 140.0, 45.0, 140.0, 120.0, 80.0, 120.0, 100.0, 150.0, 70.0, 70.0, 38.0, 70.0, 110.0, 30.0, 60.0, 66.0, 120.0, 80.0, 80.0, 60.0, 20.0, 80.0, 35.0, 120.0, 104.0, 90.0, 79.0, 20.0, 50.0, 100.0, 70.0, 90.0, 60.0, 50.0, 50.0, 110.0, 80.0, 70.0, 130.0, 15.0, -3.0, 110.0, 90.0, 110.0, 75.0, 120.0, 8.0, 70.0, 10.0, -12.0, 110.0, 34.0, 59.0, 130.0, 17.0, 9.0, 169.0, 90.0, 150.0, 170.0, 100.0, 30.0, 90.0, 20.0, 80.0, 100.0, 40.0, 50.0, 170.0, 90.0, 70.0, 70.0, 30.0, 100.0, 70.0, 60.0, 15.0, 100.0, 50.0, 80.0, 49.0, 60.0, 120.0, 70.0, 20.0, 60.0, 120.0, 40.0, 70.0, 90.0, 20.0, 110.0, 70.0, 50.0, 50.0, 60.0, 100.0, 100.0, 86.0, 60.0, 100.0, 150.0, 15.0, 120.0, 110.0, 130.0, 170.0, 40.0, 70.0, 90.0, 80.0, 95.0, 90.0, 40.0, 80.0, 90.0, 100.0, 70.0, 120.0, 80.0, 18.0, 180.0, 77.0, 90.0, 38.0, 90.0, 88.0, 102.0, 50.0, 20.0, 17.0, 70.0, 90.0, 70.0, 80.0, 50.0, 50.0, 90.0, 60.0, 100.0, 60.0, 70.0, 100.0, 100.0, 130.0, 40.0, 40.0, 60.0, 120.0, -5.0, 29.0, 30.0, 110.0, 140.0, 20.0, 80.0, 50.0, 70.0, 30.0, 80.0, 50.0, 70.0, 60.0, 80.0, 80.0, 40.0, 130.0, 90.0, 60.0, 56.0, 36.0, 110.0, 90.0, 120.0, 100.0, 80.0, 140.0, 70.0, 29.0, 95.0, 60.0, 70.0, 90.0, 50.0, 80.0, 50.0, 20.0, 90.0, 50.0, 190.0, 70.0, 30.0, 150.0, 60.0, 119.0, 50.0, 40.0, 155.0, 46.0, 120.0, 70.0, 19.0, 90.0, 70.0, 130.0, 70.0, 60.0, 160.0, 160.0, 180.0, 120.0, 80.0, 50.0, 30.0, 80.0, 80.0, 110.0, 10.0, 55.0, 100.0, -2.0, 100.0, 40.0, 89.0, 13.0, 49.0, 70.0, 90.0, 200.0, 60.0, 0.0, 50.0, 50.0, 50.0, 60.0, 80.0, 70.0, 10.0, 60.0, 160.0, 80.0, 40.0, 60.0, 50.0, 38.0, 100.0, 80.0, 50.0, 130.0, 30.0, 120.0, 30.0, 58.0, 40.0, 89.0, 80.0, 40.0, 70.0, 50.0, 30.0, 50.0, 70.0, 150.0, 77.0, 87.0, 90.0, 30.0, 110.0, 110.0, 160.0, 80.0, 16.0, 50.0, 51.0, 110.0, 100.0, 45.0, 20.0, 110.0, 25.0, 110.0, 90.0, 7.0, 29.0, 33.0, 110.0, 24.0, 70.0, 60.0, 120.0, 90.0, 27.0, 80.0, 8.0, 40.0, 70.0, 50.0, 140.0, 30.0, 130.0, 38.0, 50.0, 80.0, 60.0, 110.0, 46.0, 180.0, 59.0, 130.0, 50.0, 44.0, 140.0, 130.0, 30.0, 13.0, -13.0, 2.0, 80.0, 150.0, 100.0, 94.0, 80.0, 130.0, 46.0, 110.0, 90.0, 80.0, 23.0, 40.0, 50.0, 70.0, 70.0, 80.0, 130.0, 50.0, 130.0, 41.0, 140.0, 90.0, 220.0, 120.0, 40.0, 100.0, 95.0, 85.0, 60.0, 70.0, 50.0, 70.0, 90.0, 80.0, 47.0, 80.0, 50.0, 98.0, 40.0, 140.0, 10.0, 50.0, 130.0, 90.0, 140.0, 90.0, 100.0, 60.0, 50.0, 70.0, 100.0, 100.0, 56.0, 90.0, 120.0, 19.0, 90.0, 120.0, 19.0, 81.0, 110.0, 30.0, 30.0, 150.0, 40.0, 30.0, 50.0, 80.0, 20.0, 10.0, 100.0, 150.0, 120.0, 130.0, 40.0, 50.0, 70.0, 30.0, 80.0, 50.0, 44.0, 60.0, 40.0, 70.0, 28.0, 60.0, 65.0, 1.0, 26.0, 30.0, 50.0, 60.0, 80.0, 120.0, 110.0, 30.0, 53.0, 110.0, 70.0, 40.0, 70.0, 69.0, 42.0, 90.0, 70.0, 40.0, 70.0, 60.0, 70.0, 29.0, 150.0, 60.0, 150.0, 100.0, 70.0, 130.0, 90.0, 50.0, 79.0, 50.0, 60.0, 30.0, -12.0, 60.0, 140.0, 80.0, 211.0, 80.0, 65.0, 70.0, 40.0, 10.0, 50.0, 110.0, 70.0, 20.0, 70.0, 70.0, 80.0, 30.0, 66.0, 100.0, 30.0, 90.0, 130.0, 115.0, 40.0, 70.0, 70.0, 110.0, 70.0, 60.0, 59.0, 79.0, 55.0, 162.0, 39.0, 57.0, 40.0, 104.0, 50.0, 50.0, 160.0, 30.0, 20.0, 100.0, 100.0, 100.0, 50.0, 40.0, 90.0, 16.0, 70.0, 5.0, 60.0, 60.0, 10.0, 60.0, 110.0, 90.0, 60.0, 30.0, 30.0, 120.0, 90.0, 20.0, -7.0, 10.0, 33.0, 70.0, 110.0, 130.0, 120.0, 34.0, 30.0, 40.0, 14.0, 90.0, 150.0, 30.0, 90.0, 30.0, 200.0, 50.0, 130.0, 80.0, 60.0, 40.0, 120.0, 80.0, 30.0, 15.0, 190.0, 80.0, 80.0, 30.0, 40.0, 40.0, 40.0, 0.0, 60.0, 46.0, 83.0, 10.0, 40.0, 120.0, 120.0, 30.0, 20.0, 10.0, 80.0, 113.0, 93.0, 20.0, 130.0, 100.0, 60.0, 110.0, 60.0, 140.0, 90.0, 40.0, 50.0, 50.0, 20.0, 100.0, 80.0, 70.0, 40.0, 70.0, 40.0, 58.0, 40.0, 36.0, 40.0, 23.0, 13.0, 70.0, 150.0, 20.0, 140.0, 57.0, 70.0, 80.0, 60.0, 130.0, 50.0, 110.0, 86.0, 100.0, 110.0, 110.0, 90.0, 100.0, 30.0, 170.0, 90.0, 100.0, 170.0, 100.0, 70.0, 20.0, 150.0, 110.0, 60.0, 80.0, 160.0, 60.0, 120.0, 70.0, 30.0, 100.0, 180.0, 90.0, 60.0, 35.0, 60.0, 60.0, 50.0, 29.0, 10.0, 70.0, 80.0, 240.0, 40.0, 117.0, 70.0, 30.0, 44.0, 70.0, 110.0, 35.0, 30.0, 50.0, -7.0, 70.0, 60.0, 52.0, 6.0, 180.0, 130.0, 100.0, 70.0, 70.0, 70.0, 110.0, 140.0, 30.0, 30.0, 100.0, 85.0, 64.0, 80.0, 130.0, 110.0, 70.0, 50.0, 180.0, 30.0, 150.0, 120.0, 130.0, 35.0, 90.0, 59.0, 40.0, 10.0, 40.0, 15.0, 28.0, 70.0, 100.0, 50.0, 150.0, 10.0, 40.0, 80.0, 8.0, 50.0, 20.0, 75.0, -2.0, 40.0, 120.0, 80.0, 80.0, 70.0, 90.0, 160.0, 78.0, 70.0, 38.0, 40.0, 100.0, 30.0, 100.0, 150.0, 70.0, 80.0, 79.0, 80.0, 110.0, 130.0, 80.0, 50.0, 80.0, 30.0, 59.0, 50.0, 20.0, 100.0, 120.0, 20.0, 60.0, 60.0, 30.0, 80.0, 70.0, 110.0, 220.0, 80.0, 150.0, 110.0, 90.0, 100.0, 150.0, 50.0, 45.0, 80.0, 100.0, 90.0, 110.0, 50.0, 70.0, 70.0, 30.0, 40.0, 40.0, 60.0, 60.0, 20.0, 60.0, 70.0, 100.0, 40.0, 40.0, 40.0, 120.0, 80.0, 160.0, 49.0, 140.0, 120.0, 170.0, 0.0, 130.0, 30.0, 120.0, 29.0, 110.0, 60.0, 70.0, 100.0, 140.0, 70.0, 65.0, 47.0, 110.0, 90.0, 120.0, 110.0, 160.0, 10.0, 100.0, 30.0, 100.0, 80.0, 50.0, 50.0, 0.0, 110.0, 60.0, 90.0, 70.0, 160.0, 90.0, 100.0, 60.0, 70.0, 70.0, 80.0, 90.0, -26.0, 31.0, 72.0, 100.0, 136.0, 130.0, 130.0, 70.0, 96.0, 90.0, 60.0, 105.0, 60.0, 130.0, 60.0, 39.0, 80.0, 110.0, 180.0, 120.0, 50.0, 100.0, 120.0, 60.0, 60.0, 120.0, 80.0, 40.0, 30.0, 40.0, 35.0, 160.0, 80.0, 49.0, 58.0, 80.0, 70.0, 20.0, 63.0, 40.0, 70.0, 32.0, 69.0, 100.0, 34.0, 50.0, 2.0, 80.0, 170.0, 70.0, 3.0, 100.0, 100.0, 38.0, 4.0, -33.0, 60.0, 62.0, 10.0, -3.0, 50.0, 149.0, 20.0, 0.0, -5.0, 13.0, 50.0, -14.0, 120.0, 80.0, 80.0, 80.0, 38.0, 129.0, 80.0, 150.0, 140.0, 36.0, 120.0, 75.0, 90.0, 100.0, 60.0, 120.0, 60.0, 40.0, 20.0, 80.0, 80.0, 200.0, 170.0, 100.0, 58.0, 110.0, 60.0, 38.0, 90.0, 110.0, 60.0, 60.0, 100.0, 140.0, 70.0, 80.0, 50.0, 160.0, 70.0, 40.0, 50.0, 137.0, 188.0, 100.0, 130.0, 75.0, 30.0, 100.0, 130.0, 90.0, 85.0, 1.0, 60.0, 90.0, 140.0, 70.0, 100.0, 140.0, 79.0, 150.0, 70.0, 30.0, 70.0, -5.0, -1.0, 80.0, 30.0, 140.0, -9.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.275437791527795, "mean_inference_ms": 2.386645676541458, "mean_action_processing_ms": 0.6802793735171082, "mean_env_wait_ms": 1.5835399741895655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01230764389038086, "StateBufferConnector_ms": 0.009049177169799805, "ViewRequirementAgentConnector_ms": 0.3950159549713135}, "num_episodes": 22, "episode_return_max": 1070.0, "episode_return_min": 270.0, "episode_return_mean": 743.19}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.719491063234294, "num_env_steps_trained_throughput_per_sec": 20.719491063234294, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 194817.2, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194817.153, "sample_time_ms": 2393.465, "learn_time_ms": 192403.544, "learn_throughput": 20.79, "synch_weights_time_ms": 11.773}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 33, "trial_id": "1841f_00000", "date": "2024-08-08_01-29-23", "timestamp": 1723094963, "time_this_iter_s": 193.06557893753052, "time_total_s": 7747.900993347168, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b291c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7747.900993347168, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.14395604395604, "ram_util_percent": 78.06410256410257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.435511234088447, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.072002411294923, "policy_loss": -0.01289102973414464, "vf_loss": 8.08325759645976, "vf_explained_var": -0.0012583730446771818, "kl": 0.00817923073340502, "entropy": 0.8479849653820387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 314565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 1070.0, "episode_reward_min": 201.0, "episode_reward_mean": 739.91, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -143.0}, "policy_reward_max": {"policy_0": 240.0}, "policy_reward_mean": {"policy_0": 73.991}, "custom_metrics": {}, "hist_stats": {"episode_reward": [690.0, 882.0, 614.0, 849.0, 830.0, 1050.0, 524.0, 710.0, 678.0, 667.0, 704.0, 832.0, 558.0, 615.0, 864.0, 585.0, 960.0, 684.0, 1020.0, 745.0, 790.0, 795.0, 550.0, 820.0, 424.0, 723.0, 610.0, 929.0, 784.0, 550.0, 821.0, 725.0, 700.0, 571.0, 456.0, 748.0, 880.0, 545.0, 539.0, 906.0, 610.0, 490.0, 883.0, 1070.0, 900.0, 694.0, 771.0, 586.0, 850.0, 949.0, 567.0, 578.0, 791.0, 757.0, 689.0, 870.0, 955.0, 620.0, 730.0, 898.0, 872.0, 690.0, 880.0, 813.0, 830.0, 930.0, 622.0, 540.0, 574.0, 270.0, 933.0, 765.0, 1016.0, 830.0, 1030.0, 915.0, 445.0, 1035.0, 539.0, 923.0, 691.0, 867.0, 710.0, 562.0, 525.0, 920.0, 819.0, 538.0, 435.0, 630.0, 859.0, 810.0, 862.0, 937.0, 517.0, 787.0, 800.0, 201.0, 1029.0, 855.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 30.0, 80.0, 50.0, 70.0, 60.0, 80.0, 80.0, 40.0, 130.0, 90.0, 60.0, 56.0, 36.0, 110.0, 90.0, 120.0, 100.0, 80.0, 140.0, 70.0, 29.0, 95.0, 60.0, 70.0, 90.0, 50.0, 80.0, 50.0, 20.0, 90.0, 50.0, 190.0, 70.0, 30.0, 150.0, 60.0, 119.0, 50.0, 40.0, 155.0, 46.0, 120.0, 70.0, 19.0, 90.0, 70.0, 130.0, 70.0, 60.0, 160.0, 160.0, 180.0, 120.0, 80.0, 50.0, 30.0, 80.0, 80.0, 110.0, 10.0, 55.0, 100.0, -2.0, 100.0, 40.0, 89.0, 13.0, 49.0, 70.0, 90.0, 200.0, 60.0, 0.0, 50.0, 50.0, 50.0, 60.0, 80.0, 70.0, 10.0, 60.0, 160.0, 80.0, 40.0, 60.0, 50.0, 38.0, 100.0, 80.0, 50.0, 130.0, 30.0, 120.0, 30.0, 58.0, 40.0, 89.0, 80.0, 40.0, 70.0, 50.0, 30.0, 50.0, 70.0, 150.0, 77.0, 87.0, 90.0, 30.0, 110.0, 110.0, 160.0, 80.0, 16.0, 50.0, 51.0, 110.0, 100.0, 45.0, 20.0, 110.0, 25.0, 110.0, 90.0, 7.0, 29.0, 33.0, 110.0, 24.0, 70.0, 60.0, 120.0, 90.0, 27.0, 80.0, 8.0, 40.0, 70.0, 50.0, 140.0, 30.0, 130.0, 38.0, 50.0, 80.0, 60.0, 110.0, 46.0, 180.0, 59.0, 130.0, 50.0, 44.0, 140.0, 130.0, 30.0, 13.0, -13.0, 2.0, 80.0, 150.0, 100.0, 94.0, 80.0, 130.0, 46.0, 110.0, 90.0, 80.0, 23.0, 40.0, 50.0, 70.0, 70.0, 80.0, 130.0, 50.0, 130.0, 41.0, 140.0, 90.0, 220.0, 120.0, 40.0, 100.0, 95.0, 85.0, 60.0, 70.0, 50.0, 70.0, 90.0, 80.0, 47.0, 80.0, 50.0, 98.0, 40.0, 140.0, 10.0, 50.0, 130.0, 90.0, 140.0, 90.0, 100.0, 60.0, 50.0, 70.0, 100.0, 100.0, 56.0, 90.0, 120.0, 19.0, 90.0, 120.0, 19.0, 81.0, 110.0, 30.0, 30.0, 150.0, 40.0, 30.0, 50.0, 80.0, 20.0, 10.0, 100.0, 150.0, 120.0, 130.0, 40.0, 50.0, 70.0, 30.0, 80.0, 50.0, 44.0, 60.0, 40.0, 70.0, 28.0, 60.0, 65.0, 1.0, 26.0, 30.0, 50.0, 60.0, 80.0, 120.0, 110.0, 30.0, 53.0, 110.0, 70.0, 40.0, 70.0, 69.0, 42.0, 90.0, 70.0, 40.0, 70.0, 60.0, 70.0, 29.0, 150.0, 60.0, 150.0, 100.0, 70.0, 130.0, 90.0, 50.0, 79.0, 50.0, 60.0, 30.0, -12.0, 60.0, 140.0, 80.0, 211.0, 80.0, 65.0, 70.0, 40.0, 10.0, 50.0, 110.0, 70.0, 20.0, 70.0, 70.0, 80.0, 30.0, 66.0, 100.0, 30.0, 90.0, 130.0, 115.0, 40.0, 70.0, 70.0, 110.0, 70.0, 60.0, 59.0, 79.0, 55.0, 162.0, 39.0, 57.0, 40.0, 104.0, 50.0, 50.0, 160.0, 30.0, 20.0, 100.0, 100.0, 100.0, 50.0, 40.0, 90.0, 16.0, 70.0, 5.0, 60.0, 60.0, 10.0, 60.0, 110.0, 90.0, 60.0, 30.0, 30.0, 120.0, 90.0, 20.0, -7.0, 10.0, 33.0, 70.0, 110.0, 130.0, 120.0, 34.0, 30.0, 40.0, 14.0, 90.0, 150.0, 30.0, 90.0, 30.0, 200.0, 50.0, 130.0, 80.0, 60.0, 40.0, 120.0, 80.0, 30.0, 15.0, 190.0, 80.0, 80.0, 30.0, 40.0, 40.0, 40.0, 0.0, 60.0, 46.0, 83.0, 10.0, 40.0, 120.0, 120.0, 30.0, 20.0, 10.0, 80.0, 113.0, 93.0, 20.0, 130.0, 100.0, 60.0, 110.0, 60.0, 140.0, 90.0, 40.0, 50.0, 50.0, 20.0, 100.0, 80.0, 70.0, 40.0, 70.0, 40.0, 58.0, 40.0, 36.0, 40.0, 23.0, 13.0, 70.0, 150.0, 20.0, 140.0, 57.0, 70.0, 80.0, 60.0, 130.0, 50.0, 110.0, 86.0, 100.0, 110.0, 110.0, 90.0, 100.0, 30.0, 170.0, 90.0, 100.0, 170.0, 100.0, 70.0, 20.0, 150.0, 110.0, 60.0, 80.0, 160.0, 60.0, 120.0, 70.0, 30.0, 100.0, 180.0, 90.0, 60.0, 35.0, 60.0, 60.0, 50.0, 29.0, 10.0, 70.0, 80.0, 240.0, 40.0, 117.0, 70.0, 30.0, 44.0, 70.0, 110.0, 35.0, 30.0, 50.0, -7.0, 70.0, 60.0, 52.0, 6.0, 180.0, 130.0, 100.0, 70.0, 70.0, 70.0, 110.0, 140.0, 30.0, 30.0, 100.0, 85.0, 64.0, 80.0, 130.0, 110.0, 70.0, 50.0, 180.0, 30.0, 150.0, 120.0, 130.0, 35.0, 90.0, 59.0, 40.0, 10.0, 40.0, 15.0, 28.0, 70.0, 100.0, 50.0, 150.0, 10.0, 40.0, 80.0, 8.0, 50.0, 20.0, 75.0, -2.0, 40.0, 120.0, 80.0, 80.0, 70.0, 90.0, 160.0, 78.0, 70.0, 38.0, 40.0, 100.0, 30.0, 100.0, 150.0, 70.0, 80.0, 79.0, 80.0, 110.0, 130.0, 80.0, 50.0, 80.0, 30.0, 59.0, 50.0, 20.0, 100.0, 120.0, 20.0, 60.0, 60.0, 30.0, 80.0, 70.0, 110.0, 220.0, 80.0, 150.0, 110.0, 90.0, 100.0, 150.0, 50.0, 45.0, 80.0, 100.0, 90.0, 110.0, 50.0, 70.0, 70.0, 30.0, 40.0, 40.0, 60.0, 60.0, 20.0, 60.0, 70.0, 100.0, 40.0, 40.0, 40.0, 120.0, 80.0, 160.0, 49.0, 140.0, 120.0, 170.0, 0.0, 130.0, 30.0, 120.0, 29.0, 110.0, 60.0, 70.0, 100.0, 140.0, 70.0, 65.0, 47.0, 110.0, 90.0, 120.0, 110.0, 160.0, 10.0, 100.0, 30.0, 100.0, 80.0, 50.0, 50.0, 0.0, 110.0, 60.0, 90.0, 70.0, 160.0, 90.0, 100.0, 60.0, 70.0, 70.0, 80.0, 90.0, -26.0, 31.0, 72.0, 100.0, 136.0, 130.0, 130.0, 70.0, 96.0, 90.0, 60.0, 105.0, 60.0, 130.0, 60.0, 39.0, 80.0, 110.0, 180.0, 120.0, 50.0, 100.0, 120.0, 60.0, 60.0, 120.0, 80.0, 40.0, 30.0, 40.0, 35.0, 160.0, 80.0, 49.0, 58.0, 80.0, 70.0, 20.0, 63.0, 40.0, 70.0, 32.0, 69.0, 100.0, 34.0, 50.0, 2.0, 80.0, 170.0, 70.0, 3.0, 100.0, 100.0, 38.0, 4.0, -33.0, 60.0, 62.0, 10.0, -3.0, 50.0, 149.0, 20.0, 0.0, -5.0, 13.0, 50.0, -14.0, 120.0, 80.0, 80.0, 80.0, 38.0, 129.0, 80.0, 150.0, 140.0, 36.0, 120.0, 75.0, 90.0, 100.0, 60.0, 120.0, 60.0, 40.0, 20.0, 80.0, 80.0, 200.0, 170.0, 100.0, 58.0, 110.0, 60.0, 38.0, 90.0, 110.0, 60.0, 60.0, 100.0, 140.0, 70.0, 80.0, 50.0, 160.0, 70.0, 40.0, 50.0, 137.0, 188.0, 100.0, 130.0, 75.0, 30.0, 100.0, 130.0, 90.0, 85.0, 1.0, 60.0, 90.0, 140.0, 70.0, 100.0, 140.0, 79.0, 150.0, 70.0, 30.0, 70.0, -5.0, -1.0, 80.0, 30.0, 140.0, -9.0, 40.0, 130.0, 90.0, 120.0, 82.0, 70.0, 90.0, 130.0, 133.0, 70.0, 120.0, 110.0, 90.0, 50.0, 70.0, 55.0, 50.0, 37.0, 40.0, 7.0, 30.0, 70.0, 120.0, 60.0, 107.0, 80.0, 120.0, 70.0, 89.0, 130.0, 77.0, 100.0, 45.0, 40.0, 60.0, 110.0, 70.0, 56.0, 40.0, 50.0, 120.0, 70.0, 69.0, 80.0, 60.0, 18.0, 80.0, 80.0, 220.0, 70.0, 120.0, 20.0, 89.0, 25.0, 50.0, 90.0, 70.0, 150.0, 40.0, 76.0, 100.0, 5.0, 90.0, 90.0, 70.0, 70.0, -31.0, 60.0, 99.0, 30.0, 79.0, 50.0, 45.0, 70.0, 20.0, 140.0, 30.0, 60.0, 40.0, 10.0, 60.0, 110.0, 90.0, 100.0, 110.0, 70.0, 90.0, 70.0, 30.0, 150.0, 100.0, 120.0, 30.0, 58.0, 60.0, 71.0, 40.0, 120.0, 100.0, 110.0, 110.0, 50.0, 60.0, 124.0, 28.0, 60.0, 0.0, -21.0, 130.0, 31.0, 76.0, 110.0, 90.0, 45.0, -14.0, 1.0, 23.0, 140.0, 40.0, 60.0, -60.0, 100.0, 30.0, 60.0, 80.0, 50.0, 40.0, 110.0, 60.0, 60.0, 40.0, 120.0, 60.0, 60.0, 100.0, 30.0, 90.0, 130.0, 70.0, 89.0, 110.0, 120.0, 60.0, 20.0, 100.0, 70.0, 90.0, 160.0, 60.0, 70.0, 60.0, 60.0, 140.0, 80.0, 27.0, 90.0, 120.0, 170.0, 60.0, 25.0, 90.0, 80.0, 120.0, 170.0, 17.0, 90.0, 90.0, 50.0, 80.0, 80.0, 160.0, 50.0, 47.0, 110.0, 30.0, 43.0, -2.0, 79.0, 90.0, 50.0, 20.0, 50.0, 99.0, 160.0, 140.0, 74.0, 14.0, 50.0, 20.0, 70.0, 110.0, 90.0, 60.0, 60.0, 70.0, 90.0, 90.0, 60.0, 90.0, 180.0, 10.0, 66.0, 70.0, 39.0, 21.0, 30.0, -143.0, -14.0, 60.0, 80.0, -8.0, 110.0, 110.0, 95.0, 210.0, 60.0, 70.0, 87.0, 20.0, 107.0, 160.0, 60.0, 130.0, 55.0, 80.0, 70.0, 90.0, 100.0, 70.0, 120.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2453781222270415, "mean_inference_ms": 2.35063209747767, "mean_action_processing_ms": 0.6711593955083682, "mean_env_wait_ms": 1.5624584224970182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01207280158996582, "StateBufferConnector_ms": 0.008929729461669922, "ViewRequirementAgentConnector_ms": 0.3845999240875244}, "num_episodes": 23, "episode_return_max": 1070.0, "episode_return_min": 201.0, "episode_return_mean": 739.91}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.666551042885754, "num_env_steps_trained_throughput_per_sec": 20.666551042885754, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 194611.977, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194611.931, "sample_time_ms": 2397.487, "learn_time_ms": 192194.282, "learn_throughput": 20.812, "synch_weights_time_ms": 11.686}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 34, "trial_id": "1841f_00000", "date": "2024-08-08_01-32-36", "timestamp": 1723095156, "time_this_iter_s": 193.55922889709473, "time_total_s": 7941.460222244263, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b291c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7941.460222244263, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 16.997445255474453, "ram_util_percent": 77.80583941605839}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3475511113548686, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.225216002408436, "policy_loss": -0.011946053136114321, "vf_loss": 8.23551272447117, "vf_explained_var": -0.0014676595584780009, "kl": 0.008246676124451768, "entropy": 0.8117973960118806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 323955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 1355.0, "episode_reward_min": 201.0, "episode_reward_mean": 756.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -143.0}, "policy_reward_max": {"policy_0": 240.0}, "policy_reward_mean": {"policy_0": 75.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1020.0, 745.0, 790.0, 795.0, 550.0, 820.0, 424.0, 723.0, 610.0, 929.0, 784.0, 550.0, 821.0, 725.0, 700.0, 571.0, 456.0, 748.0, 880.0, 545.0, 539.0, 906.0, 610.0, 490.0, 883.0, 1070.0, 900.0, 694.0, 771.0, 586.0, 850.0, 949.0, 567.0, 578.0, 791.0, 757.0, 689.0, 870.0, 955.0, 620.0, 730.0, 898.0, 872.0, 690.0, 880.0, 813.0, 830.0, 930.0, 622.0, 540.0, 574.0, 270.0, 933.0, 765.0, 1016.0, 830.0, 1030.0, 915.0, 445.0, 1035.0, 539.0, 923.0, 691.0, 867.0, 710.0, 562.0, 525.0, 920.0, 819.0, 538.0, 435.0, 630.0, 859.0, 810.0, 862.0, 937.0, 517.0, 787.0, 800.0, 201.0, 1029.0, 855.0, 1355.0, 664.0, 747.0, 645.0, 850.0, 660.0, 816.0, 573.0, 843.0, 1016.0, 1165.0, 955.0, 735.0, 766.0, 826.0, 660.0, 974.0, 725.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 90.0, 220.0, 120.0, 40.0, 100.0, 95.0, 85.0, 60.0, 70.0, 50.0, 70.0, 90.0, 80.0, 47.0, 80.0, 50.0, 98.0, 40.0, 140.0, 10.0, 50.0, 130.0, 90.0, 140.0, 90.0, 100.0, 60.0, 50.0, 70.0, 100.0, 100.0, 56.0, 90.0, 120.0, 19.0, 90.0, 120.0, 19.0, 81.0, 110.0, 30.0, 30.0, 150.0, 40.0, 30.0, 50.0, 80.0, 20.0, 10.0, 100.0, 150.0, 120.0, 130.0, 40.0, 50.0, 70.0, 30.0, 80.0, 50.0, 44.0, 60.0, 40.0, 70.0, 28.0, 60.0, 65.0, 1.0, 26.0, 30.0, 50.0, 60.0, 80.0, 120.0, 110.0, 30.0, 53.0, 110.0, 70.0, 40.0, 70.0, 69.0, 42.0, 90.0, 70.0, 40.0, 70.0, 60.0, 70.0, 29.0, 150.0, 60.0, 150.0, 100.0, 70.0, 130.0, 90.0, 50.0, 79.0, 50.0, 60.0, 30.0, -12.0, 60.0, 140.0, 80.0, 211.0, 80.0, 65.0, 70.0, 40.0, 10.0, 50.0, 110.0, 70.0, 20.0, 70.0, 70.0, 80.0, 30.0, 66.0, 100.0, 30.0, 90.0, 130.0, 115.0, 40.0, 70.0, 70.0, 110.0, 70.0, 60.0, 59.0, 79.0, 55.0, 162.0, 39.0, 57.0, 40.0, 104.0, 50.0, 50.0, 160.0, 30.0, 20.0, 100.0, 100.0, 100.0, 50.0, 40.0, 90.0, 16.0, 70.0, 5.0, 60.0, 60.0, 10.0, 60.0, 110.0, 90.0, 60.0, 30.0, 30.0, 120.0, 90.0, 20.0, -7.0, 10.0, 33.0, 70.0, 110.0, 130.0, 120.0, 34.0, 30.0, 40.0, 14.0, 90.0, 150.0, 30.0, 90.0, 30.0, 200.0, 50.0, 130.0, 80.0, 60.0, 40.0, 120.0, 80.0, 30.0, 15.0, 190.0, 80.0, 80.0, 30.0, 40.0, 40.0, 40.0, 0.0, 60.0, 46.0, 83.0, 10.0, 40.0, 120.0, 120.0, 30.0, 20.0, 10.0, 80.0, 113.0, 93.0, 20.0, 130.0, 100.0, 60.0, 110.0, 60.0, 140.0, 90.0, 40.0, 50.0, 50.0, 20.0, 100.0, 80.0, 70.0, 40.0, 70.0, 40.0, 58.0, 40.0, 36.0, 40.0, 23.0, 13.0, 70.0, 150.0, 20.0, 140.0, 57.0, 70.0, 80.0, 60.0, 130.0, 50.0, 110.0, 86.0, 100.0, 110.0, 110.0, 90.0, 100.0, 30.0, 170.0, 90.0, 100.0, 170.0, 100.0, 70.0, 20.0, 150.0, 110.0, 60.0, 80.0, 160.0, 60.0, 120.0, 70.0, 30.0, 100.0, 180.0, 90.0, 60.0, 35.0, 60.0, 60.0, 50.0, 29.0, 10.0, 70.0, 80.0, 240.0, 40.0, 117.0, 70.0, 30.0, 44.0, 70.0, 110.0, 35.0, 30.0, 50.0, -7.0, 70.0, 60.0, 52.0, 6.0, 180.0, 130.0, 100.0, 70.0, 70.0, 70.0, 110.0, 140.0, 30.0, 30.0, 100.0, 85.0, 64.0, 80.0, 130.0, 110.0, 70.0, 50.0, 180.0, 30.0, 150.0, 120.0, 130.0, 35.0, 90.0, 59.0, 40.0, 10.0, 40.0, 15.0, 28.0, 70.0, 100.0, 50.0, 150.0, 10.0, 40.0, 80.0, 8.0, 50.0, 20.0, 75.0, -2.0, 40.0, 120.0, 80.0, 80.0, 70.0, 90.0, 160.0, 78.0, 70.0, 38.0, 40.0, 100.0, 30.0, 100.0, 150.0, 70.0, 80.0, 79.0, 80.0, 110.0, 130.0, 80.0, 50.0, 80.0, 30.0, 59.0, 50.0, 20.0, 100.0, 120.0, 20.0, 60.0, 60.0, 30.0, 80.0, 70.0, 110.0, 220.0, 80.0, 150.0, 110.0, 90.0, 100.0, 150.0, 50.0, 45.0, 80.0, 100.0, 90.0, 110.0, 50.0, 70.0, 70.0, 30.0, 40.0, 40.0, 60.0, 60.0, 20.0, 60.0, 70.0, 100.0, 40.0, 40.0, 40.0, 120.0, 80.0, 160.0, 49.0, 140.0, 120.0, 170.0, 0.0, 130.0, 30.0, 120.0, 29.0, 110.0, 60.0, 70.0, 100.0, 140.0, 70.0, 65.0, 47.0, 110.0, 90.0, 120.0, 110.0, 160.0, 10.0, 100.0, 30.0, 100.0, 80.0, 50.0, 50.0, 0.0, 110.0, 60.0, 90.0, 70.0, 160.0, 90.0, 100.0, 60.0, 70.0, 70.0, 80.0, 90.0, -26.0, 31.0, 72.0, 100.0, 136.0, 130.0, 130.0, 70.0, 96.0, 90.0, 60.0, 105.0, 60.0, 130.0, 60.0, 39.0, 80.0, 110.0, 180.0, 120.0, 50.0, 100.0, 120.0, 60.0, 60.0, 120.0, 80.0, 40.0, 30.0, 40.0, 35.0, 160.0, 80.0, 49.0, 58.0, 80.0, 70.0, 20.0, 63.0, 40.0, 70.0, 32.0, 69.0, 100.0, 34.0, 50.0, 2.0, 80.0, 170.0, 70.0, 3.0, 100.0, 100.0, 38.0, 4.0, -33.0, 60.0, 62.0, 10.0, -3.0, 50.0, 149.0, 20.0, 0.0, -5.0, 13.0, 50.0, -14.0, 120.0, 80.0, 80.0, 80.0, 38.0, 129.0, 80.0, 150.0, 140.0, 36.0, 120.0, 75.0, 90.0, 100.0, 60.0, 120.0, 60.0, 40.0, 20.0, 80.0, 80.0, 200.0, 170.0, 100.0, 58.0, 110.0, 60.0, 38.0, 90.0, 110.0, 60.0, 60.0, 100.0, 140.0, 70.0, 80.0, 50.0, 160.0, 70.0, 40.0, 50.0, 137.0, 188.0, 100.0, 130.0, 75.0, 30.0, 100.0, 130.0, 90.0, 85.0, 1.0, 60.0, 90.0, 140.0, 70.0, 100.0, 140.0, 79.0, 150.0, 70.0, 30.0, 70.0, -5.0, -1.0, 80.0, 30.0, 140.0, -9.0, 40.0, 130.0, 90.0, 120.0, 82.0, 70.0, 90.0, 130.0, 133.0, 70.0, 120.0, 110.0, 90.0, 50.0, 70.0, 55.0, 50.0, 37.0, 40.0, 7.0, 30.0, 70.0, 120.0, 60.0, 107.0, 80.0, 120.0, 70.0, 89.0, 130.0, 77.0, 100.0, 45.0, 40.0, 60.0, 110.0, 70.0, 56.0, 40.0, 50.0, 120.0, 70.0, 69.0, 80.0, 60.0, 18.0, 80.0, 80.0, 220.0, 70.0, 120.0, 20.0, 89.0, 25.0, 50.0, 90.0, 70.0, 150.0, 40.0, 76.0, 100.0, 5.0, 90.0, 90.0, 70.0, 70.0, -31.0, 60.0, 99.0, 30.0, 79.0, 50.0, 45.0, 70.0, 20.0, 140.0, 30.0, 60.0, 40.0, 10.0, 60.0, 110.0, 90.0, 100.0, 110.0, 70.0, 90.0, 70.0, 30.0, 150.0, 100.0, 120.0, 30.0, 58.0, 60.0, 71.0, 40.0, 120.0, 100.0, 110.0, 110.0, 50.0, 60.0, 124.0, 28.0, 60.0, 0.0, -21.0, 130.0, 31.0, 76.0, 110.0, 90.0, 45.0, -14.0, 1.0, 23.0, 140.0, 40.0, 60.0, -60.0, 100.0, 30.0, 60.0, 80.0, 50.0, 40.0, 110.0, 60.0, 60.0, 40.0, 120.0, 60.0, 60.0, 100.0, 30.0, 90.0, 130.0, 70.0, 89.0, 110.0, 120.0, 60.0, 20.0, 100.0, 70.0, 90.0, 160.0, 60.0, 70.0, 60.0, 60.0, 140.0, 80.0, 27.0, 90.0, 120.0, 170.0, 60.0, 25.0, 90.0, 80.0, 120.0, 170.0, 17.0, 90.0, 90.0, 50.0, 80.0, 80.0, 160.0, 50.0, 47.0, 110.0, 30.0, 43.0, -2.0, 79.0, 90.0, 50.0, 20.0, 50.0, 99.0, 160.0, 140.0, 74.0, 14.0, 50.0, 20.0, 70.0, 110.0, 90.0, 60.0, 60.0, 70.0, 90.0, 90.0, 60.0, 90.0, 180.0, 10.0, 66.0, 70.0, 39.0, 21.0, 30.0, -143.0, -14.0, 60.0, 80.0, -8.0, 110.0, 110.0, 95.0, 210.0, 60.0, 70.0, 87.0, 20.0, 107.0, 160.0, 60.0, 130.0, 55.0, 80.0, 70.0, 90.0, 100.0, 70.0, 120.0, 80.0, 100.0, 150.0, 190.0, 180.0, 210.0, 115.0, 170.0, 120.0, 70.0, 50.0, 79.0, 9.0, 37.0, 39.0, 130.0, 20.0, 86.0, 100.0, 54.0, 110.0, 90.0, 78.0, 140.0, 100.0, 60.0, 50.0, 70.0, 30.0, 59.0, 70.0, 110.0, 30.0, 55.0, 37.0, 170.0, 28.0, 40.0, 50.0, 45.0, 80.0, 60.0, 70.0, 130.0, 60.0, 80.0, 110.0, 70.0, 110.0, 60.0, 100.0, 50.0, 50.0, 30.0, 20.0, 100.0, 30.0, 110.0, 60.0, 40.0, 170.0, 150.0, 130.0, 59.0, 49.0, 90.0, 70.0, 30.0, 150.0, 28.0, 60.0, 90.0, 70.0, 30.0, 40.0, 40.0, 90.0, 33.0, 50.0, 60.0, 70.0, 140.0, 90.0, 60.0, 130.0, 97.0, 78.0, 60.0, 18.0, 70.0, 100.0, 40.0, 178.0, 60.0, 160.0, 100.0, 88.0, 150.0, 110.0, 110.0, 20.0, 240.0, 140.0, 60.0, 30.0, 55.0, 130.0, 230.0, 110.0, 70.0, 100.0, 100.0, 120.0, 180.0, 100.0, 30.0, 32.0, 175.0, 38.0, 100.0, 80.0, 72.0, 40.0, 110.0, 60.0, 60.0, 13.0, 100.0, 100.0, 40.0, 140.0, 30.0, 100.0, 110.0, 70.0, 50.0, 60.0, 120.0, 69.0, 57.0, 100.0, 60.0, 150.0, 150.0, 80.0, 109.0, 110.0, 50.0, 70.0, 27.0, 20.0, 10.0, 50.0, 60.0, 160.0, 50.0, 60.0, 50.0, 140.0, 10.0, 70.0, 26.0, 90.0, 85.0, 130.0, 50.0, 130.0, 96.0, 60.0, 208.0, 99.0, 37.0, 60.0, 90.0, 120.0, 90.0, 100.0, 110.0, 43.0, 5.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.225112431420168, "mean_inference_ms": 2.3259341896778016, "mean_action_processing_ms": 0.6646720912847174, "mean_env_wait_ms": 1.5464033289996653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011845827102661133, "StateBufferConnector_ms": 0.008885622024536133, "ViewRequirementAgentConnector_ms": 0.3848142623901367}, "num_episodes": 18, "episode_return_max": 1355.0, "episode_return_min": 201.0, "episode_return_mean": 756.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.57207601163687, "num_env_steps_trained_throughput_per_sec": 20.57207601163687, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 194310.431, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194310.384, "sample_time_ms": 2380.614, "learn_time_ms": 191910.518, "learn_throughput": 20.843, "synch_weights_time_ms": 10.986}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 35, "trial_id": "1841f_00000", "date": "2024-08-08_01-35-51", "timestamp": 1723095351, "time_this_iter_s": 194.4492769241333, "time_total_s": 8135.909499168396, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b291c160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8135.909499168396, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.659272727272725, "ram_util_percent": 78.31709090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3646465029769814, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.055695423201378, "policy_loss": -0.013434472353422282, "vf_loss": 8.067460761105798, "vf_explained_var": -9.65267705460326e-06, "kl": 0.00834570906956694, "entropy": 0.8377154998885937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 333345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 1355.0, "episode_reward_min": 201.0, "episode_reward_mean": 767.96, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -143.0}, "policy_reward_max": {"policy_0": 240.0}, "policy_reward_mean": {"policy_0": 76.796}, "custom_metrics": {}, "hist_stats": {"episode_reward": [880.0, 545.0, 539.0, 906.0, 610.0, 490.0, 883.0, 1070.0, 900.0, 694.0, 771.0, 586.0, 850.0, 949.0, 567.0, 578.0, 791.0, 757.0, 689.0, 870.0, 955.0, 620.0, 730.0, 898.0, 872.0, 690.0, 880.0, 813.0, 830.0, 930.0, 622.0, 540.0, 574.0, 270.0, 933.0, 765.0, 1016.0, 830.0, 1030.0, 915.0, 445.0, 1035.0, 539.0, 923.0, 691.0, 867.0, 710.0, 562.0, 525.0, 920.0, 819.0, 538.0, 435.0, 630.0, 859.0, 810.0, 862.0, 937.0, 517.0, 787.0, 800.0, 201.0, 1029.0, 855.0, 1355.0, 664.0, 747.0, 645.0, 850.0, 660.0, 816.0, 573.0, 843.0, 1016.0, 1165.0, 955.0, 735.0, 766.0, 826.0, 660.0, 974.0, 725.0, 563.0, 641.0, 910.0, 888.0, 1006.0, 725.0, 596.0, 760.0, 720.0, 650.0, 839.0, 790.0, 1160.0, 679.0, 639.0, 860.0, 671.0, 790.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 30.0, 200.0, 50.0, 130.0, 80.0, 60.0, 40.0, 120.0, 80.0, 30.0, 15.0, 190.0, 80.0, 80.0, 30.0, 40.0, 40.0, 40.0, 0.0, 60.0, 46.0, 83.0, 10.0, 40.0, 120.0, 120.0, 30.0, 20.0, 10.0, 80.0, 113.0, 93.0, 20.0, 130.0, 100.0, 60.0, 110.0, 60.0, 140.0, 90.0, 40.0, 50.0, 50.0, 20.0, 100.0, 80.0, 70.0, 40.0, 70.0, 40.0, 58.0, 40.0, 36.0, 40.0, 23.0, 13.0, 70.0, 150.0, 20.0, 140.0, 57.0, 70.0, 80.0, 60.0, 130.0, 50.0, 110.0, 86.0, 100.0, 110.0, 110.0, 90.0, 100.0, 30.0, 170.0, 90.0, 100.0, 170.0, 100.0, 70.0, 20.0, 150.0, 110.0, 60.0, 80.0, 160.0, 60.0, 120.0, 70.0, 30.0, 100.0, 180.0, 90.0, 60.0, 35.0, 60.0, 60.0, 50.0, 29.0, 10.0, 70.0, 80.0, 240.0, 40.0, 117.0, 70.0, 30.0, 44.0, 70.0, 110.0, 35.0, 30.0, 50.0, -7.0, 70.0, 60.0, 52.0, 6.0, 180.0, 130.0, 100.0, 70.0, 70.0, 70.0, 110.0, 140.0, 30.0, 30.0, 100.0, 85.0, 64.0, 80.0, 130.0, 110.0, 70.0, 50.0, 180.0, 30.0, 150.0, 120.0, 130.0, 35.0, 90.0, 59.0, 40.0, 10.0, 40.0, 15.0, 28.0, 70.0, 100.0, 50.0, 150.0, 10.0, 40.0, 80.0, 8.0, 50.0, 20.0, 75.0, -2.0, 40.0, 120.0, 80.0, 80.0, 70.0, 90.0, 160.0, 78.0, 70.0, 38.0, 40.0, 100.0, 30.0, 100.0, 150.0, 70.0, 80.0, 79.0, 80.0, 110.0, 130.0, 80.0, 50.0, 80.0, 30.0, 59.0, 50.0, 20.0, 100.0, 120.0, 20.0, 60.0, 60.0, 30.0, 80.0, 70.0, 110.0, 220.0, 80.0, 150.0, 110.0, 90.0, 100.0, 150.0, 50.0, 45.0, 80.0, 100.0, 90.0, 110.0, 50.0, 70.0, 70.0, 30.0, 40.0, 40.0, 60.0, 60.0, 20.0, 60.0, 70.0, 100.0, 40.0, 40.0, 40.0, 120.0, 80.0, 160.0, 49.0, 140.0, 120.0, 170.0, 0.0, 130.0, 30.0, 120.0, 29.0, 110.0, 60.0, 70.0, 100.0, 140.0, 70.0, 65.0, 47.0, 110.0, 90.0, 120.0, 110.0, 160.0, 10.0, 100.0, 30.0, 100.0, 80.0, 50.0, 50.0, 0.0, 110.0, 60.0, 90.0, 70.0, 160.0, 90.0, 100.0, 60.0, 70.0, 70.0, 80.0, 90.0, -26.0, 31.0, 72.0, 100.0, 136.0, 130.0, 130.0, 70.0, 96.0, 90.0, 60.0, 105.0, 60.0, 130.0, 60.0, 39.0, 80.0, 110.0, 180.0, 120.0, 50.0, 100.0, 120.0, 60.0, 60.0, 120.0, 80.0, 40.0, 30.0, 40.0, 35.0, 160.0, 80.0, 49.0, 58.0, 80.0, 70.0, 20.0, 63.0, 40.0, 70.0, 32.0, 69.0, 100.0, 34.0, 50.0, 2.0, 80.0, 170.0, 70.0, 3.0, 100.0, 100.0, 38.0, 4.0, -33.0, 60.0, 62.0, 10.0, -3.0, 50.0, 149.0, 20.0, 0.0, -5.0, 13.0, 50.0, -14.0, 120.0, 80.0, 80.0, 80.0, 38.0, 129.0, 80.0, 150.0, 140.0, 36.0, 120.0, 75.0, 90.0, 100.0, 60.0, 120.0, 60.0, 40.0, 20.0, 80.0, 80.0, 200.0, 170.0, 100.0, 58.0, 110.0, 60.0, 38.0, 90.0, 110.0, 60.0, 60.0, 100.0, 140.0, 70.0, 80.0, 50.0, 160.0, 70.0, 40.0, 50.0, 137.0, 188.0, 100.0, 130.0, 75.0, 30.0, 100.0, 130.0, 90.0, 85.0, 1.0, 60.0, 90.0, 140.0, 70.0, 100.0, 140.0, 79.0, 150.0, 70.0, 30.0, 70.0, -5.0, -1.0, 80.0, 30.0, 140.0, -9.0, 40.0, 130.0, 90.0, 120.0, 82.0, 70.0, 90.0, 130.0, 133.0, 70.0, 120.0, 110.0, 90.0, 50.0, 70.0, 55.0, 50.0, 37.0, 40.0, 7.0, 30.0, 70.0, 120.0, 60.0, 107.0, 80.0, 120.0, 70.0, 89.0, 130.0, 77.0, 100.0, 45.0, 40.0, 60.0, 110.0, 70.0, 56.0, 40.0, 50.0, 120.0, 70.0, 69.0, 80.0, 60.0, 18.0, 80.0, 80.0, 220.0, 70.0, 120.0, 20.0, 89.0, 25.0, 50.0, 90.0, 70.0, 150.0, 40.0, 76.0, 100.0, 5.0, 90.0, 90.0, 70.0, 70.0, -31.0, 60.0, 99.0, 30.0, 79.0, 50.0, 45.0, 70.0, 20.0, 140.0, 30.0, 60.0, 40.0, 10.0, 60.0, 110.0, 90.0, 100.0, 110.0, 70.0, 90.0, 70.0, 30.0, 150.0, 100.0, 120.0, 30.0, 58.0, 60.0, 71.0, 40.0, 120.0, 100.0, 110.0, 110.0, 50.0, 60.0, 124.0, 28.0, 60.0, 0.0, -21.0, 130.0, 31.0, 76.0, 110.0, 90.0, 45.0, -14.0, 1.0, 23.0, 140.0, 40.0, 60.0, -60.0, 100.0, 30.0, 60.0, 80.0, 50.0, 40.0, 110.0, 60.0, 60.0, 40.0, 120.0, 60.0, 60.0, 100.0, 30.0, 90.0, 130.0, 70.0, 89.0, 110.0, 120.0, 60.0, 20.0, 100.0, 70.0, 90.0, 160.0, 60.0, 70.0, 60.0, 60.0, 140.0, 80.0, 27.0, 90.0, 120.0, 170.0, 60.0, 25.0, 90.0, 80.0, 120.0, 170.0, 17.0, 90.0, 90.0, 50.0, 80.0, 80.0, 160.0, 50.0, 47.0, 110.0, 30.0, 43.0, -2.0, 79.0, 90.0, 50.0, 20.0, 50.0, 99.0, 160.0, 140.0, 74.0, 14.0, 50.0, 20.0, 70.0, 110.0, 90.0, 60.0, 60.0, 70.0, 90.0, 90.0, 60.0, 90.0, 180.0, 10.0, 66.0, 70.0, 39.0, 21.0, 30.0, -143.0, -14.0, 60.0, 80.0, -8.0, 110.0, 110.0, 95.0, 210.0, 60.0, 70.0, 87.0, 20.0, 107.0, 160.0, 60.0, 130.0, 55.0, 80.0, 70.0, 90.0, 100.0, 70.0, 120.0, 80.0, 100.0, 150.0, 190.0, 180.0, 210.0, 115.0, 170.0, 120.0, 70.0, 50.0, 79.0, 9.0, 37.0, 39.0, 130.0, 20.0, 86.0, 100.0, 54.0, 110.0, 90.0, 78.0, 140.0, 100.0, 60.0, 50.0, 70.0, 30.0, 59.0, 70.0, 110.0, 30.0, 55.0, 37.0, 170.0, 28.0, 40.0, 50.0, 45.0, 80.0, 60.0, 70.0, 130.0, 60.0, 80.0, 110.0, 70.0, 110.0, 60.0, 100.0, 50.0, 50.0, 30.0, 20.0, 100.0, 30.0, 110.0, 60.0, 40.0, 170.0, 150.0, 130.0, 59.0, 49.0, 90.0, 70.0, 30.0, 150.0, 28.0, 60.0, 90.0, 70.0, 30.0, 40.0, 40.0, 90.0, 33.0, 50.0, 60.0, 70.0, 140.0, 90.0, 60.0, 130.0, 97.0, 78.0, 60.0, 18.0, 70.0, 100.0, 40.0, 178.0, 60.0, 160.0, 100.0, 88.0, 150.0, 110.0, 110.0, 20.0, 240.0, 140.0, 60.0, 30.0, 55.0, 130.0, 230.0, 110.0, 70.0, 100.0, 100.0, 120.0, 180.0, 100.0, 30.0, 32.0, 175.0, 38.0, 100.0, 80.0, 72.0, 40.0, 110.0, 60.0, 60.0, 13.0, 100.0, 100.0, 40.0, 140.0, 30.0, 100.0, 110.0, 70.0, 50.0, 60.0, 120.0, 69.0, 57.0, 100.0, 60.0, 150.0, 150.0, 80.0, 109.0, 110.0, 50.0, 70.0, 27.0, 20.0, 10.0, 50.0, 60.0, 160.0, 50.0, 60.0, 50.0, 140.0, 10.0, 70.0, 26.0, 90.0, 85.0, 130.0, 50.0, 130.0, 96.0, 60.0, 208.0, 99.0, 37.0, 60.0, 90.0, 120.0, 90.0, 100.0, 110.0, 43.0, 5.0, 70.0, 80.0, 100.0, -6.0, 50.0, 80.0, 30.0, 26.0, 37.0, 86.0, 80.0, 30.0, 60.0, 10.0, 80.0, 89.0, 30.0, 158.0, 76.0, 8.0, 100.0, 60.0, 90.0, 60.0, 130.0, 90.0, 90.0, 70.0, 70.0, 140.0, 110.0, 94.0, 82.0, 90.0, 63.0, 125.0, 100.0, 80.0, 59.0, 120.0, 75.0, 80.0, 110.0, 80.0, 99.0, 90.0, 160.0, 100.0, 67.0, 110.0, 110.0, 15.0, 160.0, 110.0, 20.0, 50.0, 130.0, 30.0, 40.0, 100.0, 70.0, 70.0, 22.0, 50.0, 90.0, 56.0, 110.0, 35.0, 13.0, 90.0, 60.0, 90.0, -20.0, 110.0, 80.0, 90.0, 110.0, 70.0, 50.0, 110.0, 70.0, 100.0, 80.0, 100.0, 60.0, 180.0, 70.0, 50.0, 40.0, 30.0, 10.0, 80.0, 60.0, 49.0, 100.0, 40.0, 130.0, 19.0, 59.0, 107.0, 6.0, 70.0, 80.0, 200.0, 40.0, 49.0, 50.0, 110.0, 160.0, 50.0, 30.0, 50.0, 60.0, 110.0, 90.0, 70.0, 130.0, 40.0, 110.0, 30.0, 100.0, 80.0, 50.0, 90.0, 120.0, 120.0, 120.0, 120.0, 140.0, 100.0, 220.0, 90.0, 40.0, 115.0, 68.0, 40.0, 60.0, 130.0, 90.0, 26.0, 20.0, 30.0, 110.0, 65.0, 120.0, 60.0, -2.0, 40.0, 59.0, 27.0, 130.0, 60.0, 60.0, 60.0, 80.0, 140.0, 70.0, 100.0, 120.0, 100.0, 70.0, 60.0, 50.0, 50.0, 30.0, 40.0, 71.0, 90.0, 100.0, 50.0, 130.0, 70.0, 50.0, 100.0, 80.0, 100.0, 60.0, 20.0, 100.0, 100.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.205690820873361, "mean_inference_ms": 2.3022733726815447, "mean_action_processing_ms": 0.6584894075376586, "mean_env_wait_ms": 1.5311244574714293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011692047119140625, "StateBufferConnector_ms": 0.00879979133605957, "ViewRequirementAgentConnector_ms": 0.36888909339904785}, "num_episodes": 18, "episode_return_max": 1355.0, "episode_return_min": 201.0, "episode_return_mean": 767.96}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.581886998602133, "num_env_steps_trained_throughput_per_sec": 20.581886998602133, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 194148.829, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194148.784, "sample_time_ms": 2366.85, "learn_time_ms": 191762.869, "learn_throughput": 20.859, "synch_weights_time_ms": 10.619}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 36, "trial_id": "1841f_00000", "date": "2024-08-08_01-39-05", "timestamp": 1723095545, "time_this_iter_s": 194.35443210601807, "time_total_s": 8330.263931274414, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b291cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8330.263931274414, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.765818181818183, "ram_util_percent": 78.02545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4664229551824137, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.282567788744633, "policy_loss": -0.011927076517301785, "vf_loss": 8.292953278386173, "vf_explained_var": 0.0026215336574152257, "kl": 0.007707900394962083, "entropy": 0.8026182885241077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 342735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 1355.0, "episode_reward_min": 201.0, "episode_reward_mean": 772.48, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -143.0}, "policy_reward_max": {"policy_0": 240.0}, "policy_reward_mean": {"policy_0": 77.248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [689.0, 870.0, 955.0, 620.0, 730.0, 898.0, 872.0, 690.0, 880.0, 813.0, 830.0, 930.0, 622.0, 540.0, 574.0, 270.0, 933.0, 765.0, 1016.0, 830.0, 1030.0, 915.0, 445.0, 1035.0, 539.0, 923.0, 691.0, 867.0, 710.0, 562.0, 525.0, 920.0, 819.0, 538.0, 435.0, 630.0, 859.0, 810.0, 862.0, 937.0, 517.0, 787.0, 800.0, 201.0, 1029.0, 855.0, 1355.0, 664.0, 747.0, 645.0, 850.0, 660.0, 816.0, 573.0, 843.0, 1016.0, 1165.0, 955.0, 735.0, 766.0, 826.0, 660.0, 974.0, 725.0, 563.0, 641.0, 910.0, 888.0, 1006.0, 725.0, 596.0, 760.0, 720.0, 650.0, 839.0, 790.0, 1160.0, 679.0, 639.0, 860.0, 671.0, 790.0, 586.0, 710.0, 765.0, 955.0, 564.0, 890.0, 1010.0, 569.0, 927.0, 773.0, 825.0, 590.0, 649.0, 829.0, 766.0, 913.0, 746.0, 751.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 110.0, 130.0, 80.0, 50.0, 80.0, 30.0, 59.0, 50.0, 20.0, 100.0, 120.0, 20.0, 60.0, 60.0, 30.0, 80.0, 70.0, 110.0, 220.0, 80.0, 150.0, 110.0, 90.0, 100.0, 150.0, 50.0, 45.0, 80.0, 100.0, 90.0, 110.0, 50.0, 70.0, 70.0, 30.0, 40.0, 40.0, 60.0, 60.0, 20.0, 60.0, 70.0, 100.0, 40.0, 40.0, 40.0, 120.0, 80.0, 160.0, 49.0, 140.0, 120.0, 170.0, 0.0, 130.0, 30.0, 120.0, 29.0, 110.0, 60.0, 70.0, 100.0, 140.0, 70.0, 65.0, 47.0, 110.0, 90.0, 120.0, 110.0, 160.0, 10.0, 100.0, 30.0, 100.0, 80.0, 50.0, 50.0, 0.0, 110.0, 60.0, 90.0, 70.0, 160.0, 90.0, 100.0, 60.0, 70.0, 70.0, 80.0, 90.0, -26.0, 31.0, 72.0, 100.0, 136.0, 130.0, 130.0, 70.0, 96.0, 90.0, 60.0, 105.0, 60.0, 130.0, 60.0, 39.0, 80.0, 110.0, 180.0, 120.0, 50.0, 100.0, 120.0, 60.0, 60.0, 120.0, 80.0, 40.0, 30.0, 40.0, 35.0, 160.0, 80.0, 49.0, 58.0, 80.0, 70.0, 20.0, 63.0, 40.0, 70.0, 32.0, 69.0, 100.0, 34.0, 50.0, 2.0, 80.0, 170.0, 70.0, 3.0, 100.0, 100.0, 38.0, 4.0, -33.0, 60.0, 62.0, 10.0, -3.0, 50.0, 149.0, 20.0, 0.0, -5.0, 13.0, 50.0, -14.0, 120.0, 80.0, 80.0, 80.0, 38.0, 129.0, 80.0, 150.0, 140.0, 36.0, 120.0, 75.0, 90.0, 100.0, 60.0, 120.0, 60.0, 40.0, 20.0, 80.0, 80.0, 200.0, 170.0, 100.0, 58.0, 110.0, 60.0, 38.0, 90.0, 110.0, 60.0, 60.0, 100.0, 140.0, 70.0, 80.0, 50.0, 160.0, 70.0, 40.0, 50.0, 137.0, 188.0, 100.0, 130.0, 75.0, 30.0, 100.0, 130.0, 90.0, 85.0, 1.0, 60.0, 90.0, 140.0, 70.0, 100.0, 140.0, 79.0, 150.0, 70.0, 30.0, 70.0, -5.0, -1.0, 80.0, 30.0, 140.0, -9.0, 40.0, 130.0, 90.0, 120.0, 82.0, 70.0, 90.0, 130.0, 133.0, 70.0, 120.0, 110.0, 90.0, 50.0, 70.0, 55.0, 50.0, 37.0, 40.0, 7.0, 30.0, 70.0, 120.0, 60.0, 107.0, 80.0, 120.0, 70.0, 89.0, 130.0, 77.0, 100.0, 45.0, 40.0, 60.0, 110.0, 70.0, 56.0, 40.0, 50.0, 120.0, 70.0, 69.0, 80.0, 60.0, 18.0, 80.0, 80.0, 220.0, 70.0, 120.0, 20.0, 89.0, 25.0, 50.0, 90.0, 70.0, 150.0, 40.0, 76.0, 100.0, 5.0, 90.0, 90.0, 70.0, 70.0, -31.0, 60.0, 99.0, 30.0, 79.0, 50.0, 45.0, 70.0, 20.0, 140.0, 30.0, 60.0, 40.0, 10.0, 60.0, 110.0, 90.0, 100.0, 110.0, 70.0, 90.0, 70.0, 30.0, 150.0, 100.0, 120.0, 30.0, 58.0, 60.0, 71.0, 40.0, 120.0, 100.0, 110.0, 110.0, 50.0, 60.0, 124.0, 28.0, 60.0, 0.0, -21.0, 130.0, 31.0, 76.0, 110.0, 90.0, 45.0, -14.0, 1.0, 23.0, 140.0, 40.0, 60.0, -60.0, 100.0, 30.0, 60.0, 80.0, 50.0, 40.0, 110.0, 60.0, 60.0, 40.0, 120.0, 60.0, 60.0, 100.0, 30.0, 90.0, 130.0, 70.0, 89.0, 110.0, 120.0, 60.0, 20.0, 100.0, 70.0, 90.0, 160.0, 60.0, 70.0, 60.0, 60.0, 140.0, 80.0, 27.0, 90.0, 120.0, 170.0, 60.0, 25.0, 90.0, 80.0, 120.0, 170.0, 17.0, 90.0, 90.0, 50.0, 80.0, 80.0, 160.0, 50.0, 47.0, 110.0, 30.0, 43.0, -2.0, 79.0, 90.0, 50.0, 20.0, 50.0, 99.0, 160.0, 140.0, 74.0, 14.0, 50.0, 20.0, 70.0, 110.0, 90.0, 60.0, 60.0, 70.0, 90.0, 90.0, 60.0, 90.0, 180.0, 10.0, 66.0, 70.0, 39.0, 21.0, 30.0, -143.0, -14.0, 60.0, 80.0, -8.0, 110.0, 110.0, 95.0, 210.0, 60.0, 70.0, 87.0, 20.0, 107.0, 160.0, 60.0, 130.0, 55.0, 80.0, 70.0, 90.0, 100.0, 70.0, 120.0, 80.0, 100.0, 150.0, 190.0, 180.0, 210.0, 115.0, 170.0, 120.0, 70.0, 50.0, 79.0, 9.0, 37.0, 39.0, 130.0, 20.0, 86.0, 100.0, 54.0, 110.0, 90.0, 78.0, 140.0, 100.0, 60.0, 50.0, 70.0, 30.0, 59.0, 70.0, 110.0, 30.0, 55.0, 37.0, 170.0, 28.0, 40.0, 50.0, 45.0, 80.0, 60.0, 70.0, 130.0, 60.0, 80.0, 110.0, 70.0, 110.0, 60.0, 100.0, 50.0, 50.0, 30.0, 20.0, 100.0, 30.0, 110.0, 60.0, 40.0, 170.0, 150.0, 130.0, 59.0, 49.0, 90.0, 70.0, 30.0, 150.0, 28.0, 60.0, 90.0, 70.0, 30.0, 40.0, 40.0, 90.0, 33.0, 50.0, 60.0, 70.0, 140.0, 90.0, 60.0, 130.0, 97.0, 78.0, 60.0, 18.0, 70.0, 100.0, 40.0, 178.0, 60.0, 160.0, 100.0, 88.0, 150.0, 110.0, 110.0, 20.0, 240.0, 140.0, 60.0, 30.0, 55.0, 130.0, 230.0, 110.0, 70.0, 100.0, 100.0, 120.0, 180.0, 100.0, 30.0, 32.0, 175.0, 38.0, 100.0, 80.0, 72.0, 40.0, 110.0, 60.0, 60.0, 13.0, 100.0, 100.0, 40.0, 140.0, 30.0, 100.0, 110.0, 70.0, 50.0, 60.0, 120.0, 69.0, 57.0, 100.0, 60.0, 150.0, 150.0, 80.0, 109.0, 110.0, 50.0, 70.0, 27.0, 20.0, 10.0, 50.0, 60.0, 160.0, 50.0, 60.0, 50.0, 140.0, 10.0, 70.0, 26.0, 90.0, 85.0, 130.0, 50.0, 130.0, 96.0, 60.0, 208.0, 99.0, 37.0, 60.0, 90.0, 120.0, 90.0, 100.0, 110.0, 43.0, 5.0, 70.0, 80.0, 100.0, -6.0, 50.0, 80.0, 30.0, 26.0, 37.0, 86.0, 80.0, 30.0, 60.0, 10.0, 80.0, 89.0, 30.0, 158.0, 76.0, 8.0, 100.0, 60.0, 90.0, 60.0, 130.0, 90.0, 90.0, 70.0, 70.0, 140.0, 110.0, 94.0, 82.0, 90.0, 63.0, 125.0, 100.0, 80.0, 59.0, 120.0, 75.0, 80.0, 110.0, 80.0, 99.0, 90.0, 160.0, 100.0, 67.0, 110.0, 110.0, 15.0, 160.0, 110.0, 20.0, 50.0, 130.0, 30.0, 40.0, 100.0, 70.0, 70.0, 22.0, 50.0, 90.0, 56.0, 110.0, 35.0, 13.0, 90.0, 60.0, 90.0, -20.0, 110.0, 80.0, 90.0, 110.0, 70.0, 50.0, 110.0, 70.0, 100.0, 80.0, 100.0, 60.0, 180.0, 70.0, 50.0, 40.0, 30.0, 10.0, 80.0, 60.0, 49.0, 100.0, 40.0, 130.0, 19.0, 59.0, 107.0, 6.0, 70.0, 80.0, 200.0, 40.0, 49.0, 50.0, 110.0, 160.0, 50.0, 30.0, 50.0, 60.0, 110.0, 90.0, 70.0, 130.0, 40.0, 110.0, 30.0, 100.0, 80.0, 50.0, 90.0, 120.0, 120.0, 120.0, 120.0, 140.0, 100.0, 220.0, 90.0, 40.0, 115.0, 68.0, 40.0, 60.0, 130.0, 90.0, 26.0, 20.0, 30.0, 110.0, 65.0, 120.0, 60.0, -2.0, 40.0, 59.0, 27.0, 130.0, 60.0, 60.0, 60.0, 80.0, 140.0, 70.0, 100.0, 120.0, 100.0, 70.0, 60.0, 50.0, 50.0, 30.0, 40.0, 71.0, 90.0, 100.0, 50.0, 130.0, 70.0, 50.0, 100.0, 80.0, 100.0, 60.0, 20.0, 100.0, 100.0, 110.0, 50.0, 80.0, 50.0, 120.0, 10.0, 30.0, -16.0, 40.0, 100.0, 122.0, 70.0, 60.0, 20.0, 40.0, 150.0, 60.0, 50.0, 80.0, 50.0, 130.0, 90.0, 35.0, 80.0, 30.0, 90.0, 110.0, 50.0, 180.0, 30.0, 70.0, 65.0, 100.0, 110.0, 120.0, 60.0, 90.0, 80.0, 90.0, 120.0, 120.0, 120.0, 70.0, -4.0, 18.0, 118.0, 40.0, 110.0, 20.0, 12.0, 60.0, 80.0, 80.0, 90.0, 90.0, 50.0, 110.0, 150.0, 30.0, 140.0, 70.0, 80.0, 70.0, 40.0, 60.0, 120.0, 110.0, 110.0, 130.0, 160.0, 130.0, 20.0, 140.0, 32.0, 0.0, 170.0, -4.0, 23.0, 10.0, 58.0, 120.0, 130.0, 70.0, 80.0, 70.0, 67.0, 170.0, 120.0, 50.0, 90.0, 80.0, 70.0, 90.0, 78.0, 110.0, 50.0, 75.0, 30.0, 50.0, 100.0, 120.0, 60.0, 80.0, 80.0, 210.0, 16.0, 110.0, 56.0, 28.0, 90.0, 95.0, 49.0, 50.0, 90.0, 140.0, 13.0, 106.0, 70.0, 30.0, 50.0, -8.0, 13.0, 60.0, 67.0, 60.0, 96.0, 80.0, 70.0, 140.0, -7.0, 70.0, 70.0, 60.0, 130.0, 70.0, 70.0, 20.0, 60.0, 110.0, 80.0, 159.0, 50.0, 100.0, 110.0, 55.0, 20.0, 140.0, 60.0, 120.0, 40.0, 71.0, 67.0, 96.0, 130.0, 80.0, 90.0, 70.0, 50.0, 140.0, 70.0, 120.0, 75.0, 110.0, 70.0, 110.0, 38.0, 98.0, 60.0, 20.0, 150.0, 15.0, 50.0, 40.0, 2.0, 23.0, 210.0, 33.0, 120.0, 70.0, 150.0, 53.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1868023590547785, "mean_inference_ms": 2.2794164507708903, "mean_action_processing_ms": 0.6526550681429231, "mean_env_wait_ms": 1.5167409355030985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01166677474975586, "StateBufferConnector_ms": 0.008906364440917969, "ViewRequirementAgentConnector_ms": 0.3701465129852295}, "num_episodes": 18, "episode_return_max": 1355.0, "episode_return_min": 201.0, "episode_return_mean": 772.48}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.711534502081648, "num_env_steps_trained_throughput_per_sec": 20.711534502081648, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 193868.709, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193868.661, "sample_time_ms": 2359.285, "learn_time_ms": 191490.067, "learn_throughput": 20.889, "synch_weights_time_ms": 10.844}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 37, "trial_id": "1841f_00000", "date": "2024-08-08_01-42-18", "timestamp": 1723095738, "time_this_iter_s": 193.13949489593506, "time_total_s": 8523.40342617035, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2450430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8523.40342617035, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.294505494505493, "ram_util_percent": 77.78754578754578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2398817277246645, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.180584413682817, "policy_loss": -0.011643166174190724, "vf_loss": 8.190705155412228, "vf_explained_var": -2.483226620732024e-05, "kl": 0.007612093586556529, "entropy": 0.7500530283291119, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 352125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 1355.0, "episode_reward_min": 201.0, "episode_reward_mean": 783.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 250.0}, "policy_reward_mean": {"policy_0": 78.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [445.0, 1035.0, 539.0, 923.0, 691.0, 867.0, 710.0, 562.0, 525.0, 920.0, 819.0, 538.0, 435.0, 630.0, 859.0, 810.0, 862.0, 937.0, 517.0, 787.0, 800.0, 201.0, 1029.0, 855.0, 1355.0, 664.0, 747.0, 645.0, 850.0, 660.0, 816.0, 573.0, 843.0, 1016.0, 1165.0, 955.0, 735.0, 766.0, 826.0, 660.0, 974.0, 725.0, 563.0, 641.0, 910.0, 888.0, 1006.0, 725.0, 596.0, 760.0, 720.0, 650.0, 839.0, 790.0, 1160.0, 679.0, 639.0, 860.0, 671.0, 790.0, 586.0, 710.0, 765.0, 955.0, 564.0, 890.0, 1010.0, 569.0, 927.0, 773.0, 825.0, 590.0, 649.0, 829.0, 766.0, 913.0, 746.0, 751.0, 950.0, 500.0, 1039.0, 783.0, 634.0, 960.0, 790.0, 1127.0, 959.0, 645.0, 837.0, 850.0, 775.0, 890.0, 723.0, 849.0, 930.0, 790.0, 920.0, 596.0, 773.0, 1079.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 30.0, 70.0, -5.0, -1.0, 80.0, 30.0, 140.0, -9.0, 40.0, 130.0, 90.0, 120.0, 82.0, 70.0, 90.0, 130.0, 133.0, 70.0, 120.0, 110.0, 90.0, 50.0, 70.0, 55.0, 50.0, 37.0, 40.0, 7.0, 30.0, 70.0, 120.0, 60.0, 107.0, 80.0, 120.0, 70.0, 89.0, 130.0, 77.0, 100.0, 45.0, 40.0, 60.0, 110.0, 70.0, 56.0, 40.0, 50.0, 120.0, 70.0, 69.0, 80.0, 60.0, 18.0, 80.0, 80.0, 220.0, 70.0, 120.0, 20.0, 89.0, 25.0, 50.0, 90.0, 70.0, 150.0, 40.0, 76.0, 100.0, 5.0, 90.0, 90.0, 70.0, 70.0, -31.0, 60.0, 99.0, 30.0, 79.0, 50.0, 45.0, 70.0, 20.0, 140.0, 30.0, 60.0, 40.0, 10.0, 60.0, 110.0, 90.0, 100.0, 110.0, 70.0, 90.0, 70.0, 30.0, 150.0, 100.0, 120.0, 30.0, 58.0, 60.0, 71.0, 40.0, 120.0, 100.0, 110.0, 110.0, 50.0, 60.0, 124.0, 28.0, 60.0, 0.0, -21.0, 130.0, 31.0, 76.0, 110.0, 90.0, 45.0, -14.0, 1.0, 23.0, 140.0, 40.0, 60.0, -60.0, 100.0, 30.0, 60.0, 80.0, 50.0, 40.0, 110.0, 60.0, 60.0, 40.0, 120.0, 60.0, 60.0, 100.0, 30.0, 90.0, 130.0, 70.0, 89.0, 110.0, 120.0, 60.0, 20.0, 100.0, 70.0, 90.0, 160.0, 60.0, 70.0, 60.0, 60.0, 140.0, 80.0, 27.0, 90.0, 120.0, 170.0, 60.0, 25.0, 90.0, 80.0, 120.0, 170.0, 17.0, 90.0, 90.0, 50.0, 80.0, 80.0, 160.0, 50.0, 47.0, 110.0, 30.0, 43.0, -2.0, 79.0, 90.0, 50.0, 20.0, 50.0, 99.0, 160.0, 140.0, 74.0, 14.0, 50.0, 20.0, 70.0, 110.0, 90.0, 60.0, 60.0, 70.0, 90.0, 90.0, 60.0, 90.0, 180.0, 10.0, 66.0, 70.0, 39.0, 21.0, 30.0, -143.0, -14.0, 60.0, 80.0, -8.0, 110.0, 110.0, 95.0, 210.0, 60.0, 70.0, 87.0, 20.0, 107.0, 160.0, 60.0, 130.0, 55.0, 80.0, 70.0, 90.0, 100.0, 70.0, 120.0, 80.0, 100.0, 150.0, 190.0, 180.0, 210.0, 115.0, 170.0, 120.0, 70.0, 50.0, 79.0, 9.0, 37.0, 39.0, 130.0, 20.0, 86.0, 100.0, 54.0, 110.0, 90.0, 78.0, 140.0, 100.0, 60.0, 50.0, 70.0, 30.0, 59.0, 70.0, 110.0, 30.0, 55.0, 37.0, 170.0, 28.0, 40.0, 50.0, 45.0, 80.0, 60.0, 70.0, 130.0, 60.0, 80.0, 110.0, 70.0, 110.0, 60.0, 100.0, 50.0, 50.0, 30.0, 20.0, 100.0, 30.0, 110.0, 60.0, 40.0, 170.0, 150.0, 130.0, 59.0, 49.0, 90.0, 70.0, 30.0, 150.0, 28.0, 60.0, 90.0, 70.0, 30.0, 40.0, 40.0, 90.0, 33.0, 50.0, 60.0, 70.0, 140.0, 90.0, 60.0, 130.0, 97.0, 78.0, 60.0, 18.0, 70.0, 100.0, 40.0, 178.0, 60.0, 160.0, 100.0, 88.0, 150.0, 110.0, 110.0, 20.0, 240.0, 140.0, 60.0, 30.0, 55.0, 130.0, 230.0, 110.0, 70.0, 100.0, 100.0, 120.0, 180.0, 100.0, 30.0, 32.0, 175.0, 38.0, 100.0, 80.0, 72.0, 40.0, 110.0, 60.0, 60.0, 13.0, 100.0, 100.0, 40.0, 140.0, 30.0, 100.0, 110.0, 70.0, 50.0, 60.0, 120.0, 69.0, 57.0, 100.0, 60.0, 150.0, 150.0, 80.0, 109.0, 110.0, 50.0, 70.0, 27.0, 20.0, 10.0, 50.0, 60.0, 160.0, 50.0, 60.0, 50.0, 140.0, 10.0, 70.0, 26.0, 90.0, 85.0, 130.0, 50.0, 130.0, 96.0, 60.0, 208.0, 99.0, 37.0, 60.0, 90.0, 120.0, 90.0, 100.0, 110.0, 43.0, 5.0, 70.0, 80.0, 100.0, -6.0, 50.0, 80.0, 30.0, 26.0, 37.0, 86.0, 80.0, 30.0, 60.0, 10.0, 80.0, 89.0, 30.0, 158.0, 76.0, 8.0, 100.0, 60.0, 90.0, 60.0, 130.0, 90.0, 90.0, 70.0, 70.0, 140.0, 110.0, 94.0, 82.0, 90.0, 63.0, 125.0, 100.0, 80.0, 59.0, 120.0, 75.0, 80.0, 110.0, 80.0, 99.0, 90.0, 160.0, 100.0, 67.0, 110.0, 110.0, 15.0, 160.0, 110.0, 20.0, 50.0, 130.0, 30.0, 40.0, 100.0, 70.0, 70.0, 22.0, 50.0, 90.0, 56.0, 110.0, 35.0, 13.0, 90.0, 60.0, 90.0, -20.0, 110.0, 80.0, 90.0, 110.0, 70.0, 50.0, 110.0, 70.0, 100.0, 80.0, 100.0, 60.0, 180.0, 70.0, 50.0, 40.0, 30.0, 10.0, 80.0, 60.0, 49.0, 100.0, 40.0, 130.0, 19.0, 59.0, 107.0, 6.0, 70.0, 80.0, 200.0, 40.0, 49.0, 50.0, 110.0, 160.0, 50.0, 30.0, 50.0, 60.0, 110.0, 90.0, 70.0, 130.0, 40.0, 110.0, 30.0, 100.0, 80.0, 50.0, 90.0, 120.0, 120.0, 120.0, 120.0, 140.0, 100.0, 220.0, 90.0, 40.0, 115.0, 68.0, 40.0, 60.0, 130.0, 90.0, 26.0, 20.0, 30.0, 110.0, 65.0, 120.0, 60.0, -2.0, 40.0, 59.0, 27.0, 130.0, 60.0, 60.0, 60.0, 80.0, 140.0, 70.0, 100.0, 120.0, 100.0, 70.0, 60.0, 50.0, 50.0, 30.0, 40.0, 71.0, 90.0, 100.0, 50.0, 130.0, 70.0, 50.0, 100.0, 80.0, 100.0, 60.0, 20.0, 100.0, 100.0, 110.0, 50.0, 80.0, 50.0, 120.0, 10.0, 30.0, -16.0, 40.0, 100.0, 122.0, 70.0, 60.0, 20.0, 40.0, 150.0, 60.0, 50.0, 80.0, 50.0, 130.0, 90.0, 35.0, 80.0, 30.0, 90.0, 110.0, 50.0, 180.0, 30.0, 70.0, 65.0, 100.0, 110.0, 120.0, 60.0, 90.0, 80.0, 90.0, 120.0, 120.0, 120.0, 70.0, -4.0, 18.0, 118.0, 40.0, 110.0, 20.0, 12.0, 60.0, 80.0, 80.0, 90.0, 90.0, 50.0, 110.0, 150.0, 30.0, 140.0, 70.0, 80.0, 70.0, 40.0, 60.0, 120.0, 110.0, 110.0, 130.0, 160.0, 130.0, 20.0, 140.0, 32.0, 0.0, 170.0, -4.0, 23.0, 10.0, 58.0, 120.0, 130.0, 70.0, 80.0, 70.0, 67.0, 170.0, 120.0, 50.0, 90.0, 80.0, 70.0, 90.0, 78.0, 110.0, 50.0, 75.0, 30.0, 50.0, 100.0, 120.0, 60.0, 80.0, 80.0, 210.0, 16.0, 110.0, 56.0, 28.0, 90.0, 95.0, 49.0, 50.0, 90.0, 140.0, 13.0, 106.0, 70.0, 30.0, 50.0, -8.0, 13.0, 60.0, 67.0, 60.0, 96.0, 80.0, 70.0, 140.0, -7.0, 70.0, 70.0, 60.0, 130.0, 70.0, 70.0, 20.0, 60.0, 110.0, 80.0, 159.0, 50.0, 100.0, 110.0, 55.0, 20.0, 140.0, 60.0, 120.0, 40.0, 71.0, 67.0, 96.0, 130.0, 80.0, 90.0, 70.0, 50.0, 140.0, 70.0, 120.0, 75.0, 110.0, 70.0, 110.0, 38.0, 98.0, 60.0, 20.0, 150.0, 15.0, 50.0, 40.0, 2.0, 23.0, 210.0, 33.0, 120.0, 70.0, 150.0, 53.0, 80.0, 110.0, 110.0, 60.0, 80.0, 30.0, 200.0, 90.0, 100.0, 90.0, 20.0, 100.0, 40.0, 90.0, 0.0, 36.0, 160.0, 44.0, 20.0, -10.0, 80.0, 110.0, 140.0, 100.0, 120.0, 160.0, 9.0, 130.0, 80.0, 110.0, 26.0, 70.0, 120.0, 80.0, 120.0, 90.0, 27.0, 50.0, 100.0, 100.0, 50.0, 20.0, 170.0, 55.0, 70.0, 60.0, 70.0, 30.0, 29.0, 80.0, 90.0, 80.0, 60.0, 150.0, 140.0, 100.0, 110.0, 50.0, 40.0, 140.0, 80.0, 110.0, 130.0, 100.0, 90.0, 60.0, 40.0, 50.0, 40.0, 90.0, 150.0, 150.0, 100.0, 90.0, 35.0, 190.0, 110.0, 130.0, 67.0, 105.0, 100.0, 90.0, 80.0, 100.0, 150.0, 120.0, 60.0, 50.0, 89.0, 120.0, 120.0, 60.0, 30.0, 30.0, 80.0, 30.0, 100.0, 110.0, 50.0, 35.0, 60.0, 80.0, 110.0, 130.0, 80.0, 70.0, 140.0, 34.0, 60.0, 73.0, 90.0, 180.0, 40.0, 160.0, 20.0, 50.0, 0.0, 100.0, 120.0, 90.0, 70.0, 110.0, 170.0, 120.0, 70.0, 40.0, 50.0, 50.0, 40.0, 55.0, 80.0, 50.0, 90.0, 90.0, 80.0, 110.0, 150.0, 60.0, 110.0, 70.0, 36.0, 110.0, 120.0, 80.0, 30.0, 40.0, 37.0, 120.0, 60.0, 90.0, 60.0, 90.0, 80.0, 100.0, 90.0, 110.0, 120.0, 10.0, 39.0, 150.0, 240.0, 100.0, 50.0, 40.0, 80.0, 80.0, 120.0, 60.0, 110.0, 50.0, 90.0, 60.0, 50.0, 100.0, 60.0, 50.0, 60.0, 20.0, 200.0, 100.0, 80.0, 160.0, 60.0, 110.0, 130.0, 100.0, 80.0, 60.0, 90.0, 50.0, 170.0, 110.0, 80.0, 40.0, 18.0, 60.0, 90.0, 40.0, 158.0, -170.0, 160.0, 49.0, 60.0, 27.0, 110.0, 70.0, 100.0, 100.0, 38.0, 59.0, 120.0, 80.0, 110.0, 120.0, 14.0, 200.0, 50.0, 250.0, 45.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1653778100964494, "mean_inference_ms": 2.252095202772898, "mean_action_processing_ms": 0.6458160942114336, "mean_env_wait_ms": 1.4999566751052162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011446475982666016, "StateBufferConnector_ms": 0.008743047714233398, "ViewRequirementAgentConnector_ms": 0.36168837547302246}, "num_episodes": 22, "episode_return_max": 1355.0, "episode_return_min": 201.0, "episode_return_mean": 783.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.64438548071068, "num_env_steps_trained_throughput_per_sec": 20.64438548071068, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 193742.956, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193742.907, "sample_time_ms": 2350.206, "learn_time_ms": 191373.518, "learn_throughput": 20.902, "synch_weights_time_ms": 10.489}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 38, "trial_id": "1841f_00000", "date": "2024-08-08_01-45-32", "timestamp": 1723095932, "time_this_iter_s": 193.76956176757812, "time_total_s": 8717.172987937927, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2450310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8717.172987937927, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.336496350364968, "ram_util_percent": 78.25620437956204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3820205288192335, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.781961621872533, "policy_loss": -0.01227008197216081, "vf_loss": 7.7926779968416096, "vf_explained_var": 0.000496740862965203, "kl": 0.0077685591349595275, "entropy": 0.7630719274314194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 361515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 1355.0, "episode_reward_min": 316.0, "episode_reward_mean": 808.26, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 250.0}, "policy_reward_mean": {"policy_0": 80.826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [855.0, 1355.0, 664.0, 747.0, 645.0, 850.0, 660.0, 816.0, 573.0, 843.0, 1016.0, 1165.0, 955.0, 735.0, 766.0, 826.0, 660.0, 974.0, 725.0, 563.0, 641.0, 910.0, 888.0, 1006.0, 725.0, 596.0, 760.0, 720.0, 650.0, 839.0, 790.0, 1160.0, 679.0, 639.0, 860.0, 671.0, 790.0, 586.0, 710.0, 765.0, 955.0, 564.0, 890.0, 1010.0, 569.0, 927.0, 773.0, 825.0, 590.0, 649.0, 829.0, 766.0, 913.0, 746.0, 751.0, 950.0, 500.0, 1039.0, 783.0, 634.0, 960.0, 790.0, 1127.0, 959.0, 645.0, 837.0, 850.0, 775.0, 890.0, 723.0, 849.0, 930.0, 790.0, 920.0, 596.0, 773.0, 1079.0, 1166.0, 544.0, 647.0, 719.0, 1005.0, 512.0, 790.0, 742.0, 725.0, 867.0, 1305.0, 865.0, 1040.0, 780.0, 843.0, 647.0, 1045.0, 1035.0, 1040.0, 610.0, 704.0, 945.0, 316.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 130.0, 55.0, 80.0, 70.0, 90.0, 100.0, 70.0, 120.0, 80.0, 100.0, 150.0, 190.0, 180.0, 210.0, 115.0, 170.0, 120.0, 70.0, 50.0, 79.0, 9.0, 37.0, 39.0, 130.0, 20.0, 86.0, 100.0, 54.0, 110.0, 90.0, 78.0, 140.0, 100.0, 60.0, 50.0, 70.0, 30.0, 59.0, 70.0, 110.0, 30.0, 55.0, 37.0, 170.0, 28.0, 40.0, 50.0, 45.0, 80.0, 60.0, 70.0, 130.0, 60.0, 80.0, 110.0, 70.0, 110.0, 60.0, 100.0, 50.0, 50.0, 30.0, 20.0, 100.0, 30.0, 110.0, 60.0, 40.0, 170.0, 150.0, 130.0, 59.0, 49.0, 90.0, 70.0, 30.0, 150.0, 28.0, 60.0, 90.0, 70.0, 30.0, 40.0, 40.0, 90.0, 33.0, 50.0, 60.0, 70.0, 140.0, 90.0, 60.0, 130.0, 97.0, 78.0, 60.0, 18.0, 70.0, 100.0, 40.0, 178.0, 60.0, 160.0, 100.0, 88.0, 150.0, 110.0, 110.0, 20.0, 240.0, 140.0, 60.0, 30.0, 55.0, 130.0, 230.0, 110.0, 70.0, 100.0, 100.0, 120.0, 180.0, 100.0, 30.0, 32.0, 175.0, 38.0, 100.0, 80.0, 72.0, 40.0, 110.0, 60.0, 60.0, 13.0, 100.0, 100.0, 40.0, 140.0, 30.0, 100.0, 110.0, 70.0, 50.0, 60.0, 120.0, 69.0, 57.0, 100.0, 60.0, 150.0, 150.0, 80.0, 109.0, 110.0, 50.0, 70.0, 27.0, 20.0, 10.0, 50.0, 60.0, 160.0, 50.0, 60.0, 50.0, 140.0, 10.0, 70.0, 26.0, 90.0, 85.0, 130.0, 50.0, 130.0, 96.0, 60.0, 208.0, 99.0, 37.0, 60.0, 90.0, 120.0, 90.0, 100.0, 110.0, 43.0, 5.0, 70.0, 80.0, 100.0, -6.0, 50.0, 80.0, 30.0, 26.0, 37.0, 86.0, 80.0, 30.0, 60.0, 10.0, 80.0, 89.0, 30.0, 158.0, 76.0, 8.0, 100.0, 60.0, 90.0, 60.0, 130.0, 90.0, 90.0, 70.0, 70.0, 140.0, 110.0, 94.0, 82.0, 90.0, 63.0, 125.0, 100.0, 80.0, 59.0, 120.0, 75.0, 80.0, 110.0, 80.0, 99.0, 90.0, 160.0, 100.0, 67.0, 110.0, 110.0, 15.0, 160.0, 110.0, 20.0, 50.0, 130.0, 30.0, 40.0, 100.0, 70.0, 70.0, 22.0, 50.0, 90.0, 56.0, 110.0, 35.0, 13.0, 90.0, 60.0, 90.0, -20.0, 110.0, 80.0, 90.0, 110.0, 70.0, 50.0, 110.0, 70.0, 100.0, 80.0, 100.0, 60.0, 180.0, 70.0, 50.0, 40.0, 30.0, 10.0, 80.0, 60.0, 49.0, 100.0, 40.0, 130.0, 19.0, 59.0, 107.0, 6.0, 70.0, 80.0, 200.0, 40.0, 49.0, 50.0, 110.0, 160.0, 50.0, 30.0, 50.0, 60.0, 110.0, 90.0, 70.0, 130.0, 40.0, 110.0, 30.0, 100.0, 80.0, 50.0, 90.0, 120.0, 120.0, 120.0, 120.0, 140.0, 100.0, 220.0, 90.0, 40.0, 115.0, 68.0, 40.0, 60.0, 130.0, 90.0, 26.0, 20.0, 30.0, 110.0, 65.0, 120.0, 60.0, -2.0, 40.0, 59.0, 27.0, 130.0, 60.0, 60.0, 60.0, 80.0, 140.0, 70.0, 100.0, 120.0, 100.0, 70.0, 60.0, 50.0, 50.0, 30.0, 40.0, 71.0, 90.0, 100.0, 50.0, 130.0, 70.0, 50.0, 100.0, 80.0, 100.0, 60.0, 20.0, 100.0, 100.0, 110.0, 50.0, 80.0, 50.0, 120.0, 10.0, 30.0, -16.0, 40.0, 100.0, 122.0, 70.0, 60.0, 20.0, 40.0, 150.0, 60.0, 50.0, 80.0, 50.0, 130.0, 90.0, 35.0, 80.0, 30.0, 90.0, 110.0, 50.0, 180.0, 30.0, 70.0, 65.0, 100.0, 110.0, 120.0, 60.0, 90.0, 80.0, 90.0, 120.0, 120.0, 120.0, 70.0, -4.0, 18.0, 118.0, 40.0, 110.0, 20.0, 12.0, 60.0, 80.0, 80.0, 90.0, 90.0, 50.0, 110.0, 150.0, 30.0, 140.0, 70.0, 80.0, 70.0, 40.0, 60.0, 120.0, 110.0, 110.0, 130.0, 160.0, 130.0, 20.0, 140.0, 32.0, 0.0, 170.0, -4.0, 23.0, 10.0, 58.0, 120.0, 130.0, 70.0, 80.0, 70.0, 67.0, 170.0, 120.0, 50.0, 90.0, 80.0, 70.0, 90.0, 78.0, 110.0, 50.0, 75.0, 30.0, 50.0, 100.0, 120.0, 60.0, 80.0, 80.0, 210.0, 16.0, 110.0, 56.0, 28.0, 90.0, 95.0, 49.0, 50.0, 90.0, 140.0, 13.0, 106.0, 70.0, 30.0, 50.0, -8.0, 13.0, 60.0, 67.0, 60.0, 96.0, 80.0, 70.0, 140.0, -7.0, 70.0, 70.0, 60.0, 130.0, 70.0, 70.0, 20.0, 60.0, 110.0, 80.0, 159.0, 50.0, 100.0, 110.0, 55.0, 20.0, 140.0, 60.0, 120.0, 40.0, 71.0, 67.0, 96.0, 130.0, 80.0, 90.0, 70.0, 50.0, 140.0, 70.0, 120.0, 75.0, 110.0, 70.0, 110.0, 38.0, 98.0, 60.0, 20.0, 150.0, 15.0, 50.0, 40.0, 2.0, 23.0, 210.0, 33.0, 120.0, 70.0, 150.0, 53.0, 80.0, 110.0, 110.0, 60.0, 80.0, 30.0, 200.0, 90.0, 100.0, 90.0, 20.0, 100.0, 40.0, 90.0, 0.0, 36.0, 160.0, 44.0, 20.0, -10.0, 80.0, 110.0, 140.0, 100.0, 120.0, 160.0, 9.0, 130.0, 80.0, 110.0, 26.0, 70.0, 120.0, 80.0, 120.0, 90.0, 27.0, 50.0, 100.0, 100.0, 50.0, 20.0, 170.0, 55.0, 70.0, 60.0, 70.0, 30.0, 29.0, 80.0, 90.0, 80.0, 60.0, 150.0, 140.0, 100.0, 110.0, 50.0, 40.0, 140.0, 80.0, 110.0, 130.0, 100.0, 90.0, 60.0, 40.0, 50.0, 40.0, 90.0, 150.0, 150.0, 100.0, 90.0, 35.0, 190.0, 110.0, 130.0, 67.0, 105.0, 100.0, 90.0, 80.0, 100.0, 150.0, 120.0, 60.0, 50.0, 89.0, 120.0, 120.0, 60.0, 30.0, 30.0, 80.0, 30.0, 100.0, 110.0, 50.0, 35.0, 60.0, 80.0, 110.0, 130.0, 80.0, 70.0, 140.0, 34.0, 60.0, 73.0, 90.0, 180.0, 40.0, 160.0, 20.0, 50.0, 0.0, 100.0, 120.0, 90.0, 70.0, 110.0, 170.0, 120.0, 70.0, 40.0, 50.0, 50.0, 40.0, 55.0, 80.0, 50.0, 90.0, 90.0, 80.0, 110.0, 150.0, 60.0, 110.0, 70.0, 36.0, 110.0, 120.0, 80.0, 30.0, 40.0, 37.0, 120.0, 60.0, 90.0, 60.0, 90.0, 80.0, 100.0, 90.0, 110.0, 120.0, 10.0, 39.0, 150.0, 240.0, 100.0, 50.0, 40.0, 80.0, 80.0, 120.0, 60.0, 110.0, 50.0, 90.0, 60.0, 50.0, 100.0, 60.0, 50.0, 60.0, 20.0, 200.0, 100.0, 80.0, 160.0, 60.0, 110.0, 130.0, 100.0, 80.0, 60.0, 90.0, 50.0, 170.0, 110.0, 80.0, 40.0, 18.0, 60.0, 90.0, 40.0, 158.0, -170.0, 160.0, 49.0, 60.0, 27.0, 110.0, 70.0, 100.0, 100.0, 38.0, 59.0, 120.0, 80.0, 110.0, 120.0, 14.0, 200.0, 50.0, 250.0, 45.0, 90.0, 150.0, 58.0, 160.0, 50.0, 210.0, 79.0, 170.0, 70.0, 79.0, 140.0, 137.0, 20.0, 90.0, 10.0, 30.0, 70.0, 40.0, 70.0, 50.0, 27.0, 135.0, 70.0, 60.0, 90.0, 22.0, 60.0, 90.0, 20.0, 70.0, 30.0, 90.0, 46.0, 70.0, 100.0, 70.0, -2.0, 170.0, 130.0, 5.0, 40.0, 140.0, 34.0, 70.0, 90.0, 180.0, 60.0, 100.0, 130.0, 100.0, 101.0, 120.0, 60.0, 50.0, 30.0, 20.0, 10.0, 90.0, 100.0, 16.0, 16.0, 70.0, 103.0, 50.0, 33.0, 44.0, 60.0, 100.0, 150.0, 80.0, 100.0, 80.0, 40.0, 100.0, 110.0, 70.0, 40.0, 70.0, 76.0, 46.0, 110.0, 140.0, 21.0, 10.0, 80.0, 70.0, 120.0, 120.0, -6.0, 110.0, 60.0, 80.0, 250.0, 60.0, 160.0, 80.0, -30.0, 120.0, 10.0, 90.0, 47.0, 65.0, 180.0, 140.0, 70.0, 150.0, 140.0, 120.0, 240.0, 90.0, 110.0, 110.0, 50.0, 60.0, 80.0, 70.0, 110.0, 70.0, 155.0, 70.0, 90.0, 100.0, 80.0, 50.0, 120.0, 170.0, 160.0, 80.0, 140.0, 90.0, 50.0, 120.0, 90.0, 140.0, 80.0, 70.0, 130.0, 60.0, 30.0, 30.0, 30.0, 54.0, 16.0, 100.0, 100.0, 194.0, 130.0, 80.0, 80.0, 29.0, 60.0, 7.0, 38.0, 40.0, 60.0, 10.0, 5.0, 140.0, 80.0, 220.0, 47.0, 70.0, 100.0, 120.0, 110.0, 130.0, 60.0, 90.0, 110.0, 110.0, 145.0, 160.0, 165.0, 10.0, 70.0, 70.0, 60.0, 140.0, 60.0, 130.0, 170.0, 80.0, 130.0, 90.0, 110.0, 110.0, 60.0, 190.0, 70.0, 90.0, 110.0, 30.0, 70.0, 90.0, 60.0, 40.0, 60.0, 30.0, 40.0, 80.0, 110.0, 15.0, 90.0, 72.0, -23.0, 80.0, 120.0, 40.0, 60.0, 180.0, 70.0, 110.0, 65.0, 130.0, 110.0, 170.0, 90.0, 50.0, 90.0, 60.0, 70.0, 10.0, 70.0, 50.0, 58.0, 19.0, 0.0, 50.0, -1.0, 30.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1449897355243697, "mean_inference_ms": 2.224860124398641, "mean_action_processing_ms": 0.6389130785094549, "mean_env_wait_ms": 1.4829206530660304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011837005615234375, "StateBufferConnector_ms": 0.0087432861328125, "ViewRequirementAgentConnector_ms": 0.35741758346557617}, "num_episodes": 23, "episode_return_max": 1355.0, "episode_return_min": 316.0, "episode_return_mean": 808.26}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.630654447482183, "num_env_steps_trained_throughput_per_sec": 20.630654447482183, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 193757.291, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193757.244, "sample_time_ms": 2367.089, "learn_time_ms": 191370.933, "learn_throughput": 20.902, "synch_weights_time_ms": 10.678}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 39, "trial_id": "1841f_00000", "date": "2024-08-08_01-48-46", "timestamp": 1723096126, "time_this_iter_s": 193.89696288108826, "time_total_s": 8911.069950819016, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24508b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8911.069950819016, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.304744525547445, "ram_util_percent": 78.17992700729927}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.342863802508678, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.11759520338747, "policy_loss": -0.011874958538004972, "vf_loss": 8.127975564160414, "vf_explained_var": 0.001953795003180052, "kl": 0.007472953155516686, "entropy": 0.7643290735598697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 370905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 1305.0, "episode_reward_min": 316.0, "episode_reward_mean": 800.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 270.0}, "policy_reward_mean": {"policy_0": 80.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [725.0, 563.0, 641.0, 910.0, 888.0, 1006.0, 725.0, 596.0, 760.0, 720.0, 650.0, 839.0, 790.0, 1160.0, 679.0, 639.0, 860.0, 671.0, 790.0, 586.0, 710.0, 765.0, 955.0, 564.0, 890.0, 1010.0, 569.0, 927.0, 773.0, 825.0, 590.0, 649.0, 829.0, 766.0, 913.0, 746.0, 751.0, 950.0, 500.0, 1039.0, 783.0, 634.0, 960.0, 790.0, 1127.0, 959.0, 645.0, 837.0, 850.0, 775.0, 890.0, 723.0, 849.0, 930.0, 790.0, 920.0, 596.0, 773.0, 1079.0, 1166.0, 544.0, 647.0, 719.0, 1005.0, 512.0, 790.0, 742.0, 725.0, 867.0, 1305.0, 865.0, 1040.0, 780.0, 843.0, 647.0, 1045.0, 1035.0, 1040.0, 610.0, 704.0, 945.0, 316.0, 1000.0, 798.0, 840.0, 640.0, 508.0, 397.0, 900.0, 941.0, 583.0, 796.0, 848.0, 799.0, 990.0, 779.0, 880.0, 1080.0, 1000.0, 575.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [37.0, 60.0, 90.0, 120.0, 90.0, 100.0, 110.0, 43.0, 5.0, 70.0, 80.0, 100.0, -6.0, 50.0, 80.0, 30.0, 26.0, 37.0, 86.0, 80.0, 30.0, 60.0, 10.0, 80.0, 89.0, 30.0, 158.0, 76.0, 8.0, 100.0, 60.0, 90.0, 60.0, 130.0, 90.0, 90.0, 70.0, 70.0, 140.0, 110.0, 94.0, 82.0, 90.0, 63.0, 125.0, 100.0, 80.0, 59.0, 120.0, 75.0, 80.0, 110.0, 80.0, 99.0, 90.0, 160.0, 100.0, 67.0, 110.0, 110.0, 15.0, 160.0, 110.0, 20.0, 50.0, 130.0, 30.0, 40.0, 100.0, 70.0, 70.0, 22.0, 50.0, 90.0, 56.0, 110.0, 35.0, 13.0, 90.0, 60.0, 90.0, -20.0, 110.0, 80.0, 90.0, 110.0, 70.0, 50.0, 110.0, 70.0, 100.0, 80.0, 100.0, 60.0, 180.0, 70.0, 50.0, 40.0, 30.0, 10.0, 80.0, 60.0, 49.0, 100.0, 40.0, 130.0, 19.0, 59.0, 107.0, 6.0, 70.0, 80.0, 200.0, 40.0, 49.0, 50.0, 110.0, 160.0, 50.0, 30.0, 50.0, 60.0, 110.0, 90.0, 70.0, 130.0, 40.0, 110.0, 30.0, 100.0, 80.0, 50.0, 90.0, 120.0, 120.0, 120.0, 120.0, 140.0, 100.0, 220.0, 90.0, 40.0, 115.0, 68.0, 40.0, 60.0, 130.0, 90.0, 26.0, 20.0, 30.0, 110.0, 65.0, 120.0, 60.0, -2.0, 40.0, 59.0, 27.0, 130.0, 60.0, 60.0, 60.0, 80.0, 140.0, 70.0, 100.0, 120.0, 100.0, 70.0, 60.0, 50.0, 50.0, 30.0, 40.0, 71.0, 90.0, 100.0, 50.0, 130.0, 70.0, 50.0, 100.0, 80.0, 100.0, 60.0, 20.0, 100.0, 100.0, 110.0, 50.0, 80.0, 50.0, 120.0, 10.0, 30.0, -16.0, 40.0, 100.0, 122.0, 70.0, 60.0, 20.0, 40.0, 150.0, 60.0, 50.0, 80.0, 50.0, 130.0, 90.0, 35.0, 80.0, 30.0, 90.0, 110.0, 50.0, 180.0, 30.0, 70.0, 65.0, 100.0, 110.0, 120.0, 60.0, 90.0, 80.0, 90.0, 120.0, 120.0, 120.0, 70.0, -4.0, 18.0, 118.0, 40.0, 110.0, 20.0, 12.0, 60.0, 80.0, 80.0, 90.0, 90.0, 50.0, 110.0, 150.0, 30.0, 140.0, 70.0, 80.0, 70.0, 40.0, 60.0, 120.0, 110.0, 110.0, 130.0, 160.0, 130.0, 20.0, 140.0, 32.0, 0.0, 170.0, -4.0, 23.0, 10.0, 58.0, 120.0, 130.0, 70.0, 80.0, 70.0, 67.0, 170.0, 120.0, 50.0, 90.0, 80.0, 70.0, 90.0, 78.0, 110.0, 50.0, 75.0, 30.0, 50.0, 100.0, 120.0, 60.0, 80.0, 80.0, 210.0, 16.0, 110.0, 56.0, 28.0, 90.0, 95.0, 49.0, 50.0, 90.0, 140.0, 13.0, 106.0, 70.0, 30.0, 50.0, -8.0, 13.0, 60.0, 67.0, 60.0, 96.0, 80.0, 70.0, 140.0, -7.0, 70.0, 70.0, 60.0, 130.0, 70.0, 70.0, 20.0, 60.0, 110.0, 80.0, 159.0, 50.0, 100.0, 110.0, 55.0, 20.0, 140.0, 60.0, 120.0, 40.0, 71.0, 67.0, 96.0, 130.0, 80.0, 90.0, 70.0, 50.0, 140.0, 70.0, 120.0, 75.0, 110.0, 70.0, 110.0, 38.0, 98.0, 60.0, 20.0, 150.0, 15.0, 50.0, 40.0, 2.0, 23.0, 210.0, 33.0, 120.0, 70.0, 150.0, 53.0, 80.0, 110.0, 110.0, 60.0, 80.0, 30.0, 200.0, 90.0, 100.0, 90.0, 20.0, 100.0, 40.0, 90.0, 0.0, 36.0, 160.0, 44.0, 20.0, -10.0, 80.0, 110.0, 140.0, 100.0, 120.0, 160.0, 9.0, 130.0, 80.0, 110.0, 26.0, 70.0, 120.0, 80.0, 120.0, 90.0, 27.0, 50.0, 100.0, 100.0, 50.0, 20.0, 170.0, 55.0, 70.0, 60.0, 70.0, 30.0, 29.0, 80.0, 90.0, 80.0, 60.0, 150.0, 140.0, 100.0, 110.0, 50.0, 40.0, 140.0, 80.0, 110.0, 130.0, 100.0, 90.0, 60.0, 40.0, 50.0, 40.0, 90.0, 150.0, 150.0, 100.0, 90.0, 35.0, 190.0, 110.0, 130.0, 67.0, 105.0, 100.0, 90.0, 80.0, 100.0, 150.0, 120.0, 60.0, 50.0, 89.0, 120.0, 120.0, 60.0, 30.0, 30.0, 80.0, 30.0, 100.0, 110.0, 50.0, 35.0, 60.0, 80.0, 110.0, 130.0, 80.0, 70.0, 140.0, 34.0, 60.0, 73.0, 90.0, 180.0, 40.0, 160.0, 20.0, 50.0, 0.0, 100.0, 120.0, 90.0, 70.0, 110.0, 170.0, 120.0, 70.0, 40.0, 50.0, 50.0, 40.0, 55.0, 80.0, 50.0, 90.0, 90.0, 80.0, 110.0, 150.0, 60.0, 110.0, 70.0, 36.0, 110.0, 120.0, 80.0, 30.0, 40.0, 37.0, 120.0, 60.0, 90.0, 60.0, 90.0, 80.0, 100.0, 90.0, 110.0, 120.0, 10.0, 39.0, 150.0, 240.0, 100.0, 50.0, 40.0, 80.0, 80.0, 120.0, 60.0, 110.0, 50.0, 90.0, 60.0, 50.0, 100.0, 60.0, 50.0, 60.0, 20.0, 200.0, 100.0, 80.0, 160.0, 60.0, 110.0, 130.0, 100.0, 80.0, 60.0, 90.0, 50.0, 170.0, 110.0, 80.0, 40.0, 18.0, 60.0, 90.0, 40.0, 158.0, -170.0, 160.0, 49.0, 60.0, 27.0, 110.0, 70.0, 100.0, 100.0, 38.0, 59.0, 120.0, 80.0, 110.0, 120.0, 14.0, 200.0, 50.0, 250.0, 45.0, 90.0, 150.0, 58.0, 160.0, 50.0, 210.0, 79.0, 170.0, 70.0, 79.0, 140.0, 137.0, 20.0, 90.0, 10.0, 30.0, 70.0, 40.0, 70.0, 50.0, 27.0, 135.0, 70.0, 60.0, 90.0, 22.0, 60.0, 90.0, 20.0, 70.0, 30.0, 90.0, 46.0, 70.0, 100.0, 70.0, -2.0, 170.0, 130.0, 5.0, 40.0, 140.0, 34.0, 70.0, 90.0, 180.0, 60.0, 100.0, 130.0, 100.0, 101.0, 120.0, 60.0, 50.0, 30.0, 20.0, 10.0, 90.0, 100.0, 16.0, 16.0, 70.0, 103.0, 50.0, 33.0, 44.0, 60.0, 100.0, 150.0, 80.0, 100.0, 80.0, 40.0, 100.0, 110.0, 70.0, 40.0, 70.0, 76.0, 46.0, 110.0, 140.0, 21.0, 10.0, 80.0, 70.0, 120.0, 120.0, -6.0, 110.0, 60.0, 80.0, 250.0, 60.0, 160.0, 80.0, -30.0, 120.0, 10.0, 90.0, 47.0, 65.0, 180.0, 140.0, 70.0, 150.0, 140.0, 120.0, 240.0, 90.0, 110.0, 110.0, 50.0, 60.0, 80.0, 70.0, 110.0, 70.0, 155.0, 70.0, 90.0, 100.0, 80.0, 50.0, 120.0, 170.0, 160.0, 80.0, 140.0, 90.0, 50.0, 120.0, 90.0, 140.0, 80.0, 70.0, 130.0, 60.0, 30.0, 30.0, 30.0, 54.0, 16.0, 100.0, 100.0, 194.0, 130.0, 80.0, 80.0, 29.0, 60.0, 7.0, 38.0, 40.0, 60.0, 10.0, 5.0, 140.0, 80.0, 220.0, 47.0, 70.0, 100.0, 120.0, 110.0, 130.0, 60.0, 90.0, 110.0, 110.0, 145.0, 160.0, 165.0, 10.0, 70.0, 70.0, 60.0, 140.0, 60.0, 130.0, 170.0, 80.0, 130.0, 90.0, 110.0, 110.0, 60.0, 190.0, 70.0, 90.0, 110.0, 30.0, 70.0, 90.0, 60.0, 40.0, 60.0, 30.0, 40.0, 80.0, 110.0, 15.0, 90.0, 72.0, -23.0, 80.0, 120.0, 40.0, 60.0, 180.0, 70.0, 110.0, 65.0, 130.0, 110.0, 170.0, 90.0, 50.0, 90.0, 60.0, 70.0, 10.0, 70.0, 50.0, 58.0, 19.0, 0.0, 50.0, -1.0, 30.0, 30.0, 70.0, 90.0, 110.0, 90.0, 110.0, 140.0, 50.0, 130.0, 40.0, 170.0, 130.0, 100.0, 50.0, 59.0, 110.0, 60.0, 120.0, 29.0, 30.0, 110.0, 40.0, 90.0, 30.0, 110.0, 80.0, 110.0, 130.0, 70.0, 120.0, 60.0, 130.0, 62.0, 110.0, 2.0, 33.0, 80.0, 60.0, 85.0, 33.0, 45.0, 70.0, 60.0, 90.0, 70.0, 120.0, 20.0, 32.0, -3.0, 48.0, 1.0, 30.0, 50.0, 30.0, 30.0, 50.0, 50.0, 20.0, 80.0, 17.0, 40.0, 140.0, 80.0, 120.0, 70.0, 100.0, 60.0, 70.0, 60.0, 100.0, 100.0, 80.0, 80.0, 170.0, 30.0, 90.0, 190.0, 60.0, 140.0, 82.0, 19.0, 60.0, 110.0, 24.0, 10.0, 80.0, 29.0, 60.0, 10.0, 100.0, 100.0, 270.0, 18.0, 30.0, 80.0, 30.0, 77.0, 68.0, 88.0, 100.0, 35.0, 110.0, 120.0, 110.0, 90.0, 75.0, 53.0, 110.0, 80.0, 40.0, 60.0, 90.0, 34.0, 60.0, 74.0, 90.0, 110.0, 90.0, 60.0, 91.0, 100.0, 131.0, 30.0, 100.0, 120.0, 140.0, 100.0, 59.0, 90.0, 80.0, 140.0, 70.0, 90.0, 90.0, 80.0, 50.0, 99.0, 130.0, 80.0, 40.0, 50.0, 70.0, 40.0, 90.0, 130.0, 130.0, 80.0, 100.0, 70.0, 70.0, 100.0, 160.0, 80.0, 160.0, 100.0, 90.0, 70.0, 150.0, 90.0, 130.0, 50.0, 150.0, 70.0, 90.0, 110.0, 50.0, 40.0, 150.0, 120.0, 90.0, 130.0, 60.0, 110.0, 20.0, 20.0, 68.0, 20.0, 50.0, 57.0, 60.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1298166554524354, "mean_inference_ms": 2.20459052763871, "mean_action_processing_ms": 0.6336974831642526, "mean_env_wait_ms": 1.470369480479861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011874914169311523, "StateBufferConnector_ms": 0.008778810501098633, "ViewRequirementAgentConnector_ms": 0.3578507900238037}, "num_episodes": 18, "episode_return_max": 1305.0, "episode_return_min": 316.0, "episode_return_mean": 800.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.67251567905168, "num_env_steps_trained_throughput_per_sec": 20.67251567905168, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 193695.657, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193695.61, "sample_time_ms": 2368.233, "learn_time_ms": 191307.965, "learn_throughput": 20.909, "synch_weights_time_ms": 10.8}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 40, "trial_id": "1841f_00000", "date": "2024-08-08_01-51-59", "timestamp": 1723096319, "time_this_iter_s": 193.50440120697021, "time_total_s": 9104.574352025986, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2450b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9104.574352025986, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.147080291970806, "ram_util_percent": 77.48941605839417}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3059227718458897, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.436175360440954, "policy_loss": -0.01178533203591899, "vf_loss": 8.446558491744426, "vf_explained_var": 0.0006347846553221552, "kl": 0.007011010056141799, "entropy": 0.7392926594383292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 380295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "env_runners": {"episode_reward_max": 1305.0, "episode_reward_min": 316.0, "episode_reward_mean": 822.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 270.0}, "policy_reward_mean": {"policy_0": 82.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [790.0, 586.0, 710.0, 765.0, 955.0, 564.0, 890.0, 1010.0, 569.0, 927.0, 773.0, 825.0, 590.0, 649.0, 829.0, 766.0, 913.0, 746.0, 751.0, 950.0, 500.0, 1039.0, 783.0, 634.0, 960.0, 790.0, 1127.0, 959.0, 645.0, 837.0, 850.0, 775.0, 890.0, 723.0, 849.0, 930.0, 790.0, 920.0, 596.0, 773.0, 1079.0, 1166.0, 544.0, 647.0, 719.0, 1005.0, 512.0, 790.0, 742.0, 725.0, 867.0, 1305.0, 865.0, 1040.0, 780.0, 843.0, 647.0, 1045.0, 1035.0, 1040.0, 610.0, 704.0, 945.0, 316.0, 1000.0, 798.0, 840.0, 640.0, 508.0, 397.0, 900.0, 941.0, 583.0, 796.0, 848.0, 799.0, 990.0, 779.0, 880.0, 1080.0, 1000.0, 575.0, 930.0, 787.0, 1030.0, 933.0, 1027.0, 660.0, 905.0, 780.0, 918.0, 720.0, 869.0, 1076.0, 1046.0, 617.0, 770.0, 1097.0, 970.0, 842.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 50.0, 100.0, 80.0, 100.0, 60.0, 20.0, 100.0, 100.0, 110.0, 50.0, 80.0, 50.0, 120.0, 10.0, 30.0, -16.0, 40.0, 100.0, 122.0, 70.0, 60.0, 20.0, 40.0, 150.0, 60.0, 50.0, 80.0, 50.0, 130.0, 90.0, 35.0, 80.0, 30.0, 90.0, 110.0, 50.0, 180.0, 30.0, 70.0, 65.0, 100.0, 110.0, 120.0, 60.0, 90.0, 80.0, 90.0, 120.0, 120.0, 120.0, 70.0, -4.0, 18.0, 118.0, 40.0, 110.0, 20.0, 12.0, 60.0, 80.0, 80.0, 90.0, 90.0, 50.0, 110.0, 150.0, 30.0, 140.0, 70.0, 80.0, 70.0, 40.0, 60.0, 120.0, 110.0, 110.0, 130.0, 160.0, 130.0, 20.0, 140.0, 32.0, 0.0, 170.0, -4.0, 23.0, 10.0, 58.0, 120.0, 130.0, 70.0, 80.0, 70.0, 67.0, 170.0, 120.0, 50.0, 90.0, 80.0, 70.0, 90.0, 78.0, 110.0, 50.0, 75.0, 30.0, 50.0, 100.0, 120.0, 60.0, 80.0, 80.0, 210.0, 16.0, 110.0, 56.0, 28.0, 90.0, 95.0, 49.0, 50.0, 90.0, 140.0, 13.0, 106.0, 70.0, 30.0, 50.0, -8.0, 13.0, 60.0, 67.0, 60.0, 96.0, 80.0, 70.0, 140.0, -7.0, 70.0, 70.0, 60.0, 130.0, 70.0, 70.0, 20.0, 60.0, 110.0, 80.0, 159.0, 50.0, 100.0, 110.0, 55.0, 20.0, 140.0, 60.0, 120.0, 40.0, 71.0, 67.0, 96.0, 130.0, 80.0, 90.0, 70.0, 50.0, 140.0, 70.0, 120.0, 75.0, 110.0, 70.0, 110.0, 38.0, 98.0, 60.0, 20.0, 150.0, 15.0, 50.0, 40.0, 2.0, 23.0, 210.0, 33.0, 120.0, 70.0, 150.0, 53.0, 80.0, 110.0, 110.0, 60.0, 80.0, 30.0, 200.0, 90.0, 100.0, 90.0, 20.0, 100.0, 40.0, 90.0, 0.0, 36.0, 160.0, 44.0, 20.0, -10.0, 80.0, 110.0, 140.0, 100.0, 120.0, 160.0, 9.0, 130.0, 80.0, 110.0, 26.0, 70.0, 120.0, 80.0, 120.0, 90.0, 27.0, 50.0, 100.0, 100.0, 50.0, 20.0, 170.0, 55.0, 70.0, 60.0, 70.0, 30.0, 29.0, 80.0, 90.0, 80.0, 60.0, 150.0, 140.0, 100.0, 110.0, 50.0, 40.0, 140.0, 80.0, 110.0, 130.0, 100.0, 90.0, 60.0, 40.0, 50.0, 40.0, 90.0, 150.0, 150.0, 100.0, 90.0, 35.0, 190.0, 110.0, 130.0, 67.0, 105.0, 100.0, 90.0, 80.0, 100.0, 150.0, 120.0, 60.0, 50.0, 89.0, 120.0, 120.0, 60.0, 30.0, 30.0, 80.0, 30.0, 100.0, 110.0, 50.0, 35.0, 60.0, 80.0, 110.0, 130.0, 80.0, 70.0, 140.0, 34.0, 60.0, 73.0, 90.0, 180.0, 40.0, 160.0, 20.0, 50.0, 0.0, 100.0, 120.0, 90.0, 70.0, 110.0, 170.0, 120.0, 70.0, 40.0, 50.0, 50.0, 40.0, 55.0, 80.0, 50.0, 90.0, 90.0, 80.0, 110.0, 150.0, 60.0, 110.0, 70.0, 36.0, 110.0, 120.0, 80.0, 30.0, 40.0, 37.0, 120.0, 60.0, 90.0, 60.0, 90.0, 80.0, 100.0, 90.0, 110.0, 120.0, 10.0, 39.0, 150.0, 240.0, 100.0, 50.0, 40.0, 80.0, 80.0, 120.0, 60.0, 110.0, 50.0, 90.0, 60.0, 50.0, 100.0, 60.0, 50.0, 60.0, 20.0, 200.0, 100.0, 80.0, 160.0, 60.0, 110.0, 130.0, 100.0, 80.0, 60.0, 90.0, 50.0, 170.0, 110.0, 80.0, 40.0, 18.0, 60.0, 90.0, 40.0, 158.0, -170.0, 160.0, 49.0, 60.0, 27.0, 110.0, 70.0, 100.0, 100.0, 38.0, 59.0, 120.0, 80.0, 110.0, 120.0, 14.0, 200.0, 50.0, 250.0, 45.0, 90.0, 150.0, 58.0, 160.0, 50.0, 210.0, 79.0, 170.0, 70.0, 79.0, 140.0, 137.0, 20.0, 90.0, 10.0, 30.0, 70.0, 40.0, 70.0, 50.0, 27.0, 135.0, 70.0, 60.0, 90.0, 22.0, 60.0, 90.0, 20.0, 70.0, 30.0, 90.0, 46.0, 70.0, 100.0, 70.0, -2.0, 170.0, 130.0, 5.0, 40.0, 140.0, 34.0, 70.0, 90.0, 180.0, 60.0, 100.0, 130.0, 100.0, 101.0, 120.0, 60.0, 50.0, 30.0, 20.0, 10.0, 90.0, 100.0, 16.0, 16.0, 70.0, 103.0, 50.0, 33.0, 44.0, 60.0, 100.0, 150.0, 80.0, 100.0, 80.0, 40.0, 100.0, 110.0, 70.0, 40.0, 70.0, 76.0, 46.0, 110.0, 140.0, 21.0, 10.0, 80.0, 70.0, 120.0, 120.0, -6.0, 110.0, 60.0, 80.0, 250.0, 60.0, 160.0, 80.0, -30.0, 120.0, 10.0, 90.0, 47.0, 65.0, 180.0, 140.0, 70.0, 150.0, 140.0, 120.0, 240.0, 90.0, 110.0, 110.0, 50.0, 60.0, 80.0, 70.0, 110.0, 70.0, 155.0, 70.0, 90.0, 100.0, 80.0, 50.0, 120.0, 170.0, 160.0, 80.0, 140.0, 90.0, 50.0, 120.0, 90.0, 140.0, 80.0, 70.0, 130.0, 60.0, 30.0, 30.0, 30.0, 54.0, 16.0, 100.0, 100.0, 194.0, 130.0, 80.0, 80.0, 29.0, 60.0, 7.0, 38.0, 40.0, 60.0, 10.0, 5.0, 140.0, 80.0, 220.0, 47.0, 70.0, 100.0, 120.0, 110.0, 130.0, 60.0, 90.0, 110.0, 110.0, 145.0, 160.0, 165.0, 10.0, 70.0, 70.0, 60.0, 140.0, 60.0, 130.0, 170.0, 80.0, 130.0, 90.0, 110.0, 110.0, 60.0, 190.0, 70.0, 90.0, 110.0, 30.0, 70.0, 90.0, 60.0, 40.0, 60.0, 30.0, 40.0, 80.0, 110.0, 15.0, 90.0, 72.0, -23.0, 80.0, 120.0, 40.0, 60.0, 180.0, 70.0, 110.0, 65.0, 130.0, 110.0, 170.0, 90.0, 50.0, 90.0, 60.0, 70.0, 10.0, 70.0, 50.0, 58.0, 19.0, 0.0, 50.0, -1.0, 30.0, 30.0, 70.0, 90.0, 110.0, 90.0, 110.0, 140.0, 50.0, 130.0, 40.0, 170.0, 130.0, 100.0, 50.0, 59.0, 110.0, 60.0, 120.0, 29.0, 30.0, 110.0, 40.0, 90.0, 30.0, 110.0, 80.0, 110.0, 130.0, 70.0, 120.0, 60.0, 130.0, 62.0, 110.0, 2.0, 33.0, 80.0, 60.0, 85.0, 33.0, 45.0, 70.0, 60.0, 90.0, 70.0, 120.0, 20.0, 32.0, -3.0, 48.0, 1.0, 30.0, 50.0, 30.0, 30.0, 50.0, 50.0, 20.0, 80.0, 17.0, 40.0, 140.0, 80.0, 120.0, 70.0, 100.0, 60.0, 70.0, 60.0, 100.0, 100.0, 80.0, 80.0, 170.0, 30.0, 90.0, 190.0, 60.0, 140.0, 82.0, 19.0, 60.0, 110.0, 24.0, 10.0, 80.0, 29.0, 60.0, 10.0, 100.0, 100.0, 270.0, 18.0, 30.0, 80.0, 30.0, 77.0, 68.0, 88.0, 100.0, 35.0, 110.0, 120.0, 110.0, 90.0, 75.0, 53.0, 110.0, 80.0, 40.0, 60.0, 90.0, 34.0, 60.0, 74.0, 90.0, 110.0, 90.0, 60.0, 91.0, 100.0, 131.0, 30.0, 100.0, 120.0, 140.0, 100.0, 59.0, 90.0, 80.0, 140.0, 70.0, 90.0, 90.0, 80.0, 50.0, 99.0, 130.0, 80.0, 40.0, 50.0, 70.0, 40.0, 90.0, 130.0, 130.0, 80.0, 100.0, 70.0, 70.0, 100.0, 160.0, 80.0, 160.0, 100.0, 90.0, 70.0, 150.0, 90.0, 130.0, 50.0, 150.0, 70.0, 90.0, 110.0, 50.0, 40.0, 150.0, 120.0, 90.0, 130.0, 60.0, 110.0, 20.0, 20.0, 68.0, 20.0, 50.0, 57.0, 60.0, 110.0, 100.0, 120.0, 150.0, 110.0, 40.0, 100.0, 80.0, 120.0, 70.0, 40.0, 46.0, 85.0, 160.0, 66.0, 130.0, 70.0, 80.0, 50.0, 70.0, 30.0, 60.0, 120.0, 140.0, 100.0, 110.0, 110.0, 110.0, 80.0, 100.0, 100.0, 90.0, 130.0, 80.0, 100.0, 80.0, 150.0, 83.0, 80.0, 60.0, 80.0, 90.0, 110.0, 90.0, 70.0, 70.0, 185.0, 150.0, 152.0, 30.0, 80.0, 90.0, 150.0, 60.0, 70.0, 30.0, 7.0, 81.0, 100.0, 12.0, 60.0, 90.0, 60.0, 82.0, 120.0, 120.0, 63.0, 100.0, 80.0, 100.0, 90.0, 60.0, 80.0, 40.0, 110.0, 60.0, 90.0, 90.0, 90.0, 70.0, 90.0, 75.0, 80.0, 170.0, -30.0, 80.0, 111.0, 150.0, 109.0, 80.0, 93.0, 40.0, 50.0, 70.0, 20.0, 100.0, 70.0, 50.0, 130.0, 90.0, 100.0, 110.0, 90.0, 120.0, 170.0, 120.0, 60.0, 80.0, 30.0, 59.0, 30.0, 130.0, 150.0, 50.0, 120.0, 130.0, 89.0, 90.0, 90.0, 120.0, 107.0, 115.0, 100.0, 40.0, 110.0, 131.0, 70.0, 130.0, 100.0, 90.0, 160.0, 40.0, 80.0, 60.0, 30.0, 70.0, 20.0, 50.0, 47.0, 190.0, 30.0, 50.0, 110.0, 130.0, 90.0, 100.0, 90.0, 50.0, 120.0, -20.0, 50.0, 120.0, 80.0, 80.0, 120.0, 60.0, 80.0, 104.0, 73.0, 260.0, 120.0, 90.0, 150.0, 130.0, 80.0, 80.0, 50.0, 70.0, 130.0, 80.0, 110.0, 80.0, 48.0, 60.0, 170.0, 80.0, 200.0, -43.0, 200.0, 29.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.115527802025501, "mean_inference_ms": 2.185250982543173, "mean_action_processing_ms": 0.6286925287376015, "mean_env_wait_ms": 1.4583696699348985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011943817138671875, "StateBufferConnector_ms": 0.008842945098876953, "ViewRequirementAgentConnector_ms": 0.36942338943481445}, "num_episodes": 18, "episode_return_max": 1305.0, "episode_return_min": 316.0, "episode_return_mean": 822.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.656136275979843, "num_env_steps_trained_throughput_per_sec": 20.656136275979843, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 1640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1640000, "timers": {"training_iteration_time_ms": 193640.125, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193640.077, "sample_time_ms": 2342.223, "learn_time_ms": 191278.836, "learn_throughput": 20.912, "synch_weights_time_ms": 10.619}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "done": false, "training_iteration": 41, "trial_id": "1841f_00000", "date": "2024-08-08_01-55-13", "timestamp": 1723096513, "time_this_iter_s": 193.65853881835938, "time_total_s": 9298.232890844345, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2450820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9298.232890844345, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 16.95036496350365, "ram_util_percent": 77.56313868613138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.396833213722617, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.354253386689452, "policy_loss": -0.01279997274428864, "vf_loss": 8.36546665558292, "vf_explained_var": 0.003386901996640986, "kl": 0.007933495520214514, "entropy": 0.7342459401256614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 389685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 1305.0, "episode_reward_min": 316.0, "episode_reward_mean": 834.73, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 270.0}, "policy_reward_mean": {"policy_0": 83.473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [751.0, 950.0, 500.0, 1039.0, 783.0, 634.0, 960.0, 790.0, 1127.0, 959.0, 645.0, 837.0, 850.0, 775.0, 890.0, 723.0, 849.0, 930.0, 790.0, 920.0, 596.0, 773.0, 1079.0, 1166.0, 544.0, 647.0, 719.0, 1005.0, 512.0, 790.0, 742.0, 725.0, 867.0, 1305.0, 865.0, 1040.0, 780.0, 843.0, 647.0, 1045.0, 1035.0, 1040.0, 610.0, 704.0, 945.0, 316.0, 1000.0, 798.0, 840.0, 640.0, 508.0, 397.0, 900.0, 941.0, 583.0, 796.0, 848.0, 799.0, 990.0, 779.0, 880.0, 1080.0, 1000.0, 575.0, 930.0, 787.0, 1030.0, 933.0, 1027.0, 660.0, 905.0, 780.0, 918.0, 720.0, 869.0, 1076.0, 1046.0, 617.0, 770.0, 1097.0, 970.0, 842.0, 710.0, 770.0, 800.0, 1140.0, 1034.0, 816.0, 894.0, 1000.0, 828.0, 555.0, 905.0, 902.0, 605.0, 1002.0, 845.0, 780.0, 790.0, 724.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 40.0, 2.0, 23.0, 210.0, 33.0, 120.0, 70.0, 150.0, 53.0, 80.0, 110.0, 110.0, 60.0, 80.0, 30.0, 200.0, 90.0, 100.0, 90.0, 20.0, 100.0, 40.0, 90.0, 0.0, 36.0, 160.0, 44.0, 20.0, -10.0, 80.0, 110.0, 140.0, 100.0, 120.0, 160.0, 9.0, 130.0, 80.0, 110.0, 26.0, 70.0, 120.0, 80.0, 120.0, 90.0, 27.0, 50.0, 100.0, 100.0, 50.0, 20.0, 170.0, 55.0, 70.0, 60.0, 70.0, 30.0, 29.0, 80.0, 90.0, 80.0, 60.0, 150.0, 140.0, 100.0, 110.0, 50.0, 40.0, 140.0, 80.0, 110.0, 130.0, 100.0, 90.0, 60.0, 40.0, 50.0, 40.0, 90.0, 150.0, 150.0, 100.0, 90.0, 35.0, 190.0, 110.0, 130.0, 67.0, 105.0, 100.0, 90.0, 80.0, 100.0, 150.0, 120.0, 60.0, 50.0, 89.0, 120.0, 120.0, 60.0, 30.0, 30.0, 80.0, 30.0, 100.0, 110.0, 50.0, 35.0, 60.0, 80.0, 110.0, 130.0, 80.0, 70.0, 140.0, 34.0, 60.0, 73.0, 90.0, 180.0, 40.0, 160.0, 20.0, 50.0, 0.0, 100.0, 120.0, 90.0, 70.0, 110.0, 170.0, 120.0, 70.0, 40.0, 50.0, 50.0, 40.0, 55.0, 80.0, 50.0, 90.0, 90.0, 80.0, 110.0, 150.0, 60.0, 110.0, 70.0, 36.0, 110.0, 120.0, 80.0, 30.0, 40.0, 37.0, 120.0, 60.0, 90.0, 60.0, 90.0, 80.0, 100.0, 90.0, 110.0, 120.0, 10.0, 39.0, 150.0, 240.0, 100.0, 50.0, 40.0, 80.0, 80.0, 120.0, 60.0, 110.0, 50.0, 90.0, 60.0, 50.0, 100.0, 60.0, 50.0, 60.0, 20.0, 200.0, 100.0, 80.0, 160.0, 60.0, 110.0, 130.0, 100.0, 80.0, 60.0, 90.0, 50.0, 170.0, 110.0, 80.0, 40.0, 18.0, 60.0, 90.0, 40.0, 158.0, -170.0, 160.0, 49.0, 60.0, 27.0, 110.0, 70.0, 100.0, 100.0, 38.0, 59.0, 120.0, 80.0, 110.0, 120.0, 14.0, 200.0, 50.0, 250.0, 45.0, 90.0, 150.0, 58.0, 160.0, 50.0, 210.0, 79.0, 170.0, 70.0, 79.0, 140.0, 137.0, 20.0, 90.0, 10.0, 30.0, 70.0, 40.0, 70.0, 50.0, 27.0, 135.0, 70.0, 60.0, 90.0, 22.0, 60.0, 90.0, 20.0, 70.0, 30.0, 90.0, 46.0, 70.0, 100.0, 70.0, -2.0, 170.0, 130.0, 5.0, 40.0, 140.0, 34.0, 70.0, 90.0, 180.0, 60.0, 100.0, 130.0, 100.0, 101.0, 120.0, 60.0, 50.0, 30.0, 20.0, 10.0, 90.0, 100.0, 16.0, 16.0, 70.0, 103.0, 50.0, 33.0, 44.0, 60.0, 100.0, 150.0, 80.0, 100.0, 80.0, 40.0, 100.0, 110.0, 70.0, 40.0, 70.0, 76.0, 46.0, 110.0, 140.0, 21.0, 10.0, 80.0, 70.0, 120.0, 120.0, -6.0, 110.0, 60.0, 80.0, 250.0, 60.0, 160.0, 80.0, -30.0, 120.0, 10.0, 90.0, 47.0, 65.0, 180.0, 140.0, 70.0, 150.0, 140.0, 120.0, 240.0, 90.0, 110.0, 110.0, 50.0, 60.0, 80.0, 70.0, 110.0, 70.0, 155.0, 70.0, 90.0, 100.0, 80.0, 50.0, 120.0, 170.0, 160.0, 80.0, 140.0, 90.0, 50.0, 120.0, 90.0, 140.0, 80.0, 70.0, 130.0, 60.0, 30.0, 30.0, 30.0, 54.0, 16.0, 100.0, 100.0, 194.0, 130.0, 80.0, 80.0, 29.0, 60.0, 7.0, 38.0, 40.0, 60.0, 10.0, 5.0, 140.0, 80.0, 220.0, 47.0, 70.0, 100.0, 120.0, 110.0, 130.0, 60.0, 90.0, 110.0, 110.0, 145.0, 160.0, 165.0, 10.0, 70.0, 70.0, 60.0, 140.0, 60.0, 130.0, 170.0, 80.0, 130.0, 90.0, 110.0, 110.0, 60.0, 190.0, 70.0, 90.0, 110.0, 30.0, 70.0, 90.0, 60.0, 40.0, 60.0, 30.0, 40.0, 80.0, 110.0, 15.0, 90.0, 72.0, -23.0, 80.0, 120.0, 40.0, 60.0, 180.0, 70.0, 110.0, 65.0, 130.0, 110.0, 170.0, 90.0, 50.0, 90.0, 60.0, 70.0, 10.0, 70.0, 50.0, 58.0, 19.0, 0.0, 50.0, -1.0, 30.0, 30.0, 70.0, 90.0, 110.0, 90.0, 110.0, 140.0, 50.0, 130.0, 40.0, 170.0, 130.0, 100.0, 50.0, 59.0, 110.0, 60.0, 120.0, 29.0, 30.0, 110.0, 40.0, 90.0, 30.0, 110.0, 80.0, 110.0, 130.0, 70.0, 120.0, 60.0, 130.0, 62.0, 110.0, 2.0, 33.0, 80.0, 60.0, 85.0, 33.0, 45.0, 70.0, 60.0, 90.0, 70.0, 120.0, 20.0, 32.0, -3.0, 48.0, 1.0, 30.0, 50.0, 30.0, 30.0, 50.0, 50.0, 20.0, 80.0, 17.0, 40.0, 140.0, 80.0, 120.0, 70.0, 100.0, 60.0, 70.0, 60.0, 100.0, 100.0, 80.0, 80.0, 170.0, 30.0, 90.0, 190.0, 60.0, 140.0, 82.0, 19.0, 60.0, 110.0, 24.0, 10.0, 80.0, 29.0, 60.0, 10.0, 100.0, 100.0, 270.0, 18.0, 30.0, 80.0, 30.0, 77.0, 68.0, 88.0, 100.0, 35.0, 110.0, 120.0, 110.0, 90.0, 75.0, 53.0, 110.0, 80.0, 40.0, 60.0, 90.0, 34.0, 60.0, 74.0, 90.0, 110.0, 90.0, 60.0, 91.0, 100.0, 131.0, 30.0, 100.0, 120.0, 140.0, 100.0, 59.0, 90.0, 80.0, 140.0, 70.0, 90.0, 90.0, 80.0, 50.0, 99.0, 130.0, 80.0, 40.0, 50.0, 70.0, 40.0, 90.0, 130.0, 130.0, 80.0, 100.0, 70.0, 70.0, 100.0, 160.0, 80.0, 160.0, 100.0, 90.0, 70.0, 150.0, 90.0, 130.0, 50.0, 150.0, 70.0, 90.0, 110.0, 50.0, 40.0, 150.0, 120.0, 90.0, 130.0, 60.0, 110.0, 20.0, 20.0, 68.0, 20.0, 50.0, 57.0, 60.0, 110.0, 100.0, 120.0, 150.0, 110.0, 40.0, 100.0, 80.0, 120.0, 70.0, 40.0, 46.0, 85.0, 160.0, 66.0, 130.0, 70.0, 80.0, 50.0, 70.0, 30.0, 60.0, 120.0, 140.0, 100.0, 110.0, 110.0, 110.0, 80.0, 100.0, 100.0, 90.0, 130.0, 80.0, 100.0, 80.0, 150.0, 83.0, 80.0, 60.0, 80.0, 90.0, 110.0, 90.0, 70.0, 70.0, 185.0, 150.0, 152.0, 30.0, 80.0, 90.0, 150.0, 60.0, 70.0, 30.0, 7.0, 81.0, 100.0, 12.0, 60.0, 90.0, 60.0, 82.0, 120.0, 120.0, 63.0, 100.0, 80.0, 100.0, 90.0, 60.0, 80.0, 40.0, 110.0, 60.0, 90.0, 90.0, 90.0, 70.0, 90.0, 75.0, 80.0, 170.0, -30.0, 80.0, 111.0, 150.0, 109.0, 80.0, 93.0, 40.0, 50.0, 70.0, 20.0, 100.0, 70.0, 50.0, 130.0, 90.0, 100.0, 110.0, 90.0, 120.0, 170.0, 120.0, 60.0, 80.0, 30.0, 59.0, 30.0, 130.0, 150.0, 50.0, 120.0, 130.0, 89.0, 90.0, 90.0, 120.0, 107.0, 115.0, 100.0, 40.0, 110.0, 131.0, 70.0, 130.0, 100.0, 90.0, 160.0, 40.0, 80.0, 60.0, 30.0, 70.0, 20.0, 50.0, 47.0, 190.0, 30.0, 50.0, 110.0, 130.0, 90.0, 100.0, 90.0, 50.0, 120.0, -20.0, 50.0, 120.0, 80.0, 80.0, 120.0, 60.0, 80.0, 104.0, 73.0, 260.0, 120.0, 90.0, 150.0, 130.0, 80.0, 80.0, 50.0, 70.0, 130.0, 80.0, 110.0, 80.0, 48.0, 60.0, 170.0, 80.0, 200.0, -43.0, 200.0, 29.0, 18.0, 70.0, 50.0, 50.0, 180.0, 40.0, 70.0, 80.0, 80.0, 0.0, 90.0, 60.0, 50.0, 90.0, 110.0, 70.0, 60.0, 80.0, 70.0, 100.0, 80.0, 90.0, 40.0, 70.0, 60.0, 110.0, 30.0, 40.0, 160.0, 70.0, 130.0, 120.0, 40.0, 80.0, 80.0, 110.0, 90.0, 80.0, 210.0, 160.0, 170.0, 120.0, 120.0, 100.0, 140.0, 150.0, 79.0, 110.0, 100.0, 70.0, 45.0, 100.0, 5.0, 90.0, 80.0, 100.0, 40.0, 230.0, 100.0, 11.0, 60.0, 90.0, 90.0, 110.0, 69.0, 67.0, 140.0, 140.0, 90.0, 48.0, 50.0, 10.0, 150.0, 130.0, 50.0, 130.0, 140.0, 120.0, 20.0, 120.0, 130.0, 55.0, 90.0, 220.0, 52.0, 50.0, 25.0, 70.0, 150.0, 70.0, 46.0, 70.0, 30.0, 28.0, 80.0, 50.0, 40.0, 80.0, 50.0, 80.0, 47.0, 60.0, 180.0, 160.0, 25.0, 70.0, 130.0, 60.0, 80.0, 60.0, 80.0, 110.0, 81.0, 190.0, 55.0, 70.0, 100.0, 4.0, 60.0, 140.0, 92.0, 51.0, 40.0, 90.0, 50.0, 40.0, 30.0, 59.0, 55.0, 100.0, 90.0, 110.0, 100.0, 170.0, 42.0, 130.0, 53.0, 90.0, 84.0, 140.0, 83.0, 92.0, 150.0, 43.0, 70.0, 130.0, 60.0, 100.0, 50.0, 100.0, 50.0, 110.0, 120.0, 80.0, 61.0, 80.0, 69.0, -10.0, 70.0, 100.0, 100.0, 70.0, 60.0, 50.0, 60.0, 70.0, 110.0, 70.0, 50.0, 120.0, 130.0, 80.0, 50.0, 20.0, 80.0, -6.0, 40.0, 80.0, 50.0, 230.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1019039324435123, "mean_inference_ms": 2.167339670627561, "mean_action_processing_ms": 0.6238958121801079, "mean_env_wait_ms": 1.4469026197712147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011890411376953125, "StateBufferConnector_ms": 0.008761167526245117, "ViewRequirementAgentConnector_ms": 0.36612939834594727}, "num_episodes": 18, "episode_return_max": 1305.0, "episode_return_min": 316.0, "episode_return_mean": 834.73}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.678375414793326, "num_env_steps_trained_throughput_per_sec": 20.678375414793326, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 193674.057, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193674.009, "sample_time_ms": 2323.736, "learn_time_ms": 191331.059, "learn_throughput": 20.906, "synch_weights_time_ms": 11.006}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 42, "trial_id": "1841f_00000", "date": "2024-08-08_01-58-27", "timestamp": 1723096707, "time_this_iter_s": 193.44830298423767, "time_total_s": 9491.681193828583, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24223a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9491.681193828583, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.14065934065934, "ram_util_percent": 77.58278388278387}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4239496419985835, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.402732033318223, "policy_loss": -0.012877409488331682, "vf_loss": 8.413971016429864, "vf_explained_var": 0.0015074934568394995, "kl": 0.008192145883437368, "entropy": 0.7217060097490255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 399075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "env_runners": {"episode_reward_max": 1305.0, "episode_reward_min": 316.0, "episode_reward_mean": 826.99, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -43.0}, "policy_reward_max": {"policy_0": 270.0}, "policy_reward_mean": {"policy_0": 82.699}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1079.0, 1166.0, 544.0, 647.0, 719.0, 1005.0, 512.0, 790.0, 742.0, 725.0, 867.0, 1305.0, 865.0, 1040.0, 780.0, 843.0, 647.0, 1045.0, 1035.0, 1040.0, 610.0, 704.0, 945.0, 316.0, 1000.0, 798.0, 840.0, 640.0, 508.0, 397.0, 900.0, 941.0, 583.0, 796.0, 848.0, 799.0, 990.0, 779.0, 880.0, 1080.0, 1000.0, 575.0, 930.0, 787.0, 1030.0, 933.0, 1027.0, 660.0, 905.0, 780.0, 918.0, 720.0, 869.0, 1076.0, 1046.0, 617.0, 770.0, 1097.0, 970.0, 842.0, 710.0, 770.0, 800.0, 1140.0, 1034.0, 816.0, 894.0, 1000.0, 828.0, 555.0, 905.0, 902.0, 605.0, 1002.0, 845.0, 780.0, 790.0, 724.0, 940.0, 740.0, 948.0, 1110.0, 846.0, 928.0, 910.0, 651.0, 746.0, 571.0, 779.0, 720.0, 772.0, 1010.0, 440.0, 639.0, 935.0, 556.0, 731.0, 690.0, 920.0, 715.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 80.0, 110.0, 120.0, 14.0, 200.0, 50.0, 250.0, 45.0, 90.0, 150.0, 58.0, 160.0, 50.0, 210.0, 79.0, 170.0, 70.0, 79.0, 140.0, 137.0, 20.0, 90.0, 10.0, 30.0, 70.0, 40.0, 70.0, 50.0, 27.0, 135.0, 70.0, 60.0, 90.0, 22.0, 60.0, 90.0, 20.0, 70.0, 30.0, 90.0, 46.0, 70.0, 100.0, 70.0, -2.0, 170.0, 130.0, 5.0, 40.0, 140.0, 34.0, 70.0, 90.0, 180.0, 60.0, 100.0, 130.0, 100.0, 101.0, 120.0, 60.0, 50.0, 30.0, 20.0, 10.0, 90.0, 100.0, 16.0, 16.0, 70.0, 103.0, 50.0, 33.0, 44.0, 60.0, 100.0, 150.0, 80.0, 100.0, 80.0, 40.0, 100.0, 110.0, 70.0, 40.0, 70.0, 76.0, 46.0, 110.0, 140.0, 21.0, 10.0, 80.0, 70.0, 120.0, 120.0, -6.0, 110.0, 60.0, 80.0, 250.0, 60.0, 160.0, 80.0, -30.0, 120.0, 10.0, 90.0, 47.0, 65.0, 180.0, 140.0, 70.0, 150.0, 140.0, 120.0, 240.0, 90.0, 110.0, 110.0, 50.0, 60.0, 80.0, 70.0, 110.0, 70.0, 155.0, 70.0, 90.0, 100.0, 80.0, 50.0, 120.0, 170.0, 160.0, 80.0, 140.0, 90.0, 50.0, 120.0, 90.0, 140.0, 80.0, 70.0, 130.0, 60.0, 30.0, 30.0, 30.0, 54.0, 16.0, 100.0, 100.0, 194.0, 130.0, 80.0, 80.0, 29.0, 60.0, 7.0, 38.0, 40.0, 60.0, 10.0, 5.0, 140.0, 80.0, 220.0, 47.0, 70.0, 100.0, 120.0, 110.0, 130.0, 60.0, 90.0, 110.0, 110.0, 145.0, 160.0, 165.0, 10.0, 70.0, 70.0, 60.0, 140.0, 60.0, 130.0, 170.0, 80.0, 130.0, 90.0, 110.0, 110.0, 60.0, 190.0, 70.0, 90.0, 110.0, 30.0, 70.0, 90.0, 60.0, 40.0, 60.0, 30.0, 40.0, 80.0, 110.0, 15.0, 90.0, 72.0, -23.0, 80.0, 120.0, 40.0, 60.0, 180.0, 70.0, 110.0, 65.0, 130.0, 110.0, 170.0, 90.0, 50.0, 90.0, 60.0, 70.0, 10.0, 70.0, 50.0, 58.0, 19.0, 0.0, 50.0, -1.0, 30.0, 30.0, 70.0, 90.0, 110.0, 90.0, 110.0, 140.0, 50.0, 130.0, 40.0, 170.0, 130.0, 100.0, 50.0, 59.0, 110.0, 60.0, 120.0, 29.0, 30.0, 110.0, 40.0, 90.0, 30.0, 110.0, 80.0, 110.0, 130.0, 70.0, 120.0, 60.0, 130.0, 62.0, 110.0, 2.0, 33.0, 80.0, 60.0, 85.0, 33.0, 45.0, 70.0, 60.0, 90.0, 70.0, 120.0, 20.0, 32.0, -3.0, 48.0, 1.0, 30.0, 50.0, 30.0, 30.0, 50.0, 50.0, 20.0, 80.0, 17.0, 40.0, 140.0, 80.0, 120.0, 70.0, 100.0, 60.0, 70.0, 60.0, 100.0, 100.0, 80.0, 80.0, 170.0, 30.0, 90.0, 190.0, 60.0, 140.0, 82.0, 19.0, 60.0, 110.0, 24.0, 10.0, 80.0, 29.0, 60.0, 10.0, 100.0, 100.0, 270.0, 18.0, 30.0, 80.0, 30.0, 77.0, 68.0, 88.0, 100.0, 35.0, 110.0, 120.0, 110.0, 90.0, 75.0, 53.0, 110.0, 80.0, 40.0, 60.0, 90.0, 34.0, 60.0, 74.0, 90.0, 110.0, 90.0, 60.0, 91.0, 100.0, 131.0, 30.0, 100.0, 120.0, 140.0, 100.0, 59.0, 90.0, 80.0, 140.0, 70.0, 90.0, 90.0, 80.0, 50.0, 99.0, 130.0, 80.0, 40.0, 50.0, 70.0, 40.0, 90.0, 130.0, 130.0, 80.0, 100.0, 70.0, 70.0, 100.0, 160.0, 80.0, 160.0, 100.0, 90.0, 70.0, 150.0, 90.0, 130.0, 50.0, 150.0, 70.0, 90.0, 110.0, 50.0, 40.0, 150.0, 120.0, 90.0, 130.0, 60.0, 110.0, 20.0, 20.0, 68.0, 20.0, 50.0, 57.0, 60.0, 110.0, 100.0, 120.0, 150.0, 110.0, 40.0, 100.0, 80.0, 120.0, 70.0, 40.0, 46.0, 85.0, 160.0, 66.0, 130.0, 70.0, 80.0, 50.0, 70.0, 30.0, 60.0, 120.0, 140.0, 100.0, 110.0, 110.0, 110.0, 80.0, 100.0, 100.0, 90.0, 130.0, 80.0, 100.0, 80.0, 150.0, 83.0, 80.0, 60.0, 80.0, 90.0, 110.0, 90.0, 70.0, 70.0, 185.0, 150.0, 152.0, 30.0, 80.0, 90.0, 150.0, 60.0, 70.0, 30.0, 7.0, 81.0, 100.0, 12.0, 60.0, 90.0, 60.0, 82.0, 120.0, 120.0, 63.0, 100.0, 80.0, 100.0, 90.0, 60.0, 80.0, 40.0, 110.0, 60.0, 90.0, 90.0, 90.0, 70.0, 90.0, 75.0, 80.0, 170.0, -30.0, 80.0, 111.0, 150.0, 109.0, 80.0, 93.0, 40.0, 50.0, 70.0, 20.0, 100.0, 70.0, 50.0, 130.0, 90.0, 100.0, 110.0, 90.0, 120.0, 170.0, 120.0, 60.0, 80.0, 30.0, 59.0, 30.0, 130.0, 150.0, 50.0, 120.0, 130.0, 89.0, 90.0, 90.0, 120.0, 107.0, 115.0, 100.0, 40.0, 110.0, 131.0, 70.0, 130.0, 100.0, 90.0, 160.0, 40.0, 80.0, 60.0, 30.0, 70.0, 20.0, 50.0, 47.0, 190.0, 30.0, 50.0, 110.0, 130.0, 90.0, 100.0, 90.0, 50.0, 120.0, -20.0, 50.0, 120.0, 80.0, 80.0, 120.0, 60.0, 80.0, 104.0, 73.0, 260.0, 120.0, 90.0, 150.0, 130.0, 80.0, 80.0, 50.0, 70.0, 130.0, 80.0, 110.0, 80.0, 48.0, 60.0, 170.0, 80.0, 200.0, -43.0, 200.0, 29.0, 18.0, 70.0, 50.0, 50.0, 180.0, 40.0, 70.0, 80.0, 80.0, 0.0, 90.0, 60.0, 50.0, 90.0, 110.0, 70.0, 60.0, 80.0, 70.0, 100.0, 80.0, 90.0, 40.0, 70.0, 60.0, 110.0, 30.0, 40.0, 160.0, 70.0, 130.0, 120.0, 40.0, 80.0, 80.0, 110.0, 90.0, 80.0, 210.0, 160.0, 170.0, 120.0, 120.0, 100.0, 140.0, 150.0, 79.0, 110.0, 100.0, 70.0, 45.0, 100.0, 5.0, 90.0, 80.0, 100.0, 40.0, 230.0, 100.0, 11.0, 60.0, 90.0, 90.0, 110.0, 69.0, 67.0, 140.0, 140.0, 90.0, 48.0, 50.0, 10.0, 150.0, 130.0, 50.0, 130.0, 140.0, 120.0, 20.0, 120.0, 130.0, 55.0, 90.0, 220.0, 52.0, 50.0, 25.0, 70.0, 150.0, 70.0, 46.0, 70.0, 30.0, 28.0, 80.0, 50.0, 40.0, 80.0, 50.0, 80.0, 47.0, 60.0, 180.0, 160.0, 25.0, 70.0, 130.0, 60.0, 80.0, 60.0, 80.0, 110.0, 81.0, 190.0, 55.0, 70.0, 100.0, 4.0, 60.0, 140.0, 92.0, 51.0, 40.0, 90.0, 50.0, 40.0, 30.0, 59.0, 55.0, 100.0, 90.0, 110.0, 100.0, 170.0, 42.0, 130.0, 53.0, 90.0, 84.0, 140.0, 83.0, 92.0, 150.0, 43.0, 70.0, 130.0, 60.0, 100.0, 50.0, 100.0, 50.0, 110.0, 120.0, 80.0, 61.0, 80.0, 69.0, -10.0, 70.0, 100.0, 100.0, 70.0, 60.0, 50.0, 60.0, 70.0, 110.0, 70.0, 50.0, 120.0, 130.0, 80.0, 50.0, 20.0, 80.0, -6.0, 40.0, 80.0, 50.0, 230.0, 100.0, 130.0, 130.0, 65.0, 40.0, 72.0, 130.0, 110.0, 50.0, 160.0, 53.0, 26.0, 80.0, 97.0, 60.0, 110.0, 90.0, 32.0, 65.0, 90.0, 90.0, 120.0, 100.0, 140.0, 70.0, 90.0, 110.0, 42.0, 26.0, 140.0, 110.0, 110.0, 80.0, 140.0, 110.0, 40.0, 130.0, 150.0, 50.0, 100.0, 200.0, 100.0, 106.0, 80.0, 120.0, 128.0, 70.0, 20.0, 95.0, 70.0, 57.0, 130.0, 80.0, 130.0, 127.0, 100.0, 50.0, 41.0, 60.0, 130.0, 80.0, 95.0, 50.0, 140.0, 20.0, 140.0, 40.0, 80.0, 120.0, 45.0, 180.0, 110.0, 45.0, 90.0, 50.0, 80.0, 40.0, 50.0, 90.0, 70.0, 26.0, 80.0, 67.0, 110.0, 60.0, 49.0, 60.0, 140.0, 30.0, 60.0, 90.0, 30.0, 60.0, 50.0, 51.0, 50.0, 90.0, 130.0, 2.0, 110.0, -2.0, 73.0, 73.0, 30.0, 50.0, 100.0, 130.0, 90.0, 40.0, 130.0, 63.0, 50.0, 100.0, 30.0, 160.0, 60.0, 50.0, 44.0, 56.0, 90.0, 80.0, 190.0, 90.0, 90.0, 50.0, 30.0, 60.0, 50.0, 61.0, 61.0, 90.0, 170.0, 90.0, 110.0, 70.0, 50.0, 140.0, 50.0, 160.0, 90.0, 80.0, 10.0, 30.0, 40.0, 70.0, -1.0, 40.0, 70.0, 51.0, 60.0, 70.0, 80.0, 240.0, 60.0, 30.0, 90.0, 40.0, 30.0, 0.0, 50.0, 19.0, 50.0, 70.0, 40.0, 129.0, 130.0, 100.0, 75.0, 180.0, 103.0, 58.0, 30.0, 150.0, 20.0, 30.0, 100.0, 40.0, 60.0, 36.0, 40.0, 50.0, 190.0, 50.0, 80.0, 90.0, 50.0, 33.0, 50.0, -2.0, 50.0, 140.0, 70.0, 40.0, 50.0, 150.0, 50.0, 30.0, 100.0, 120.0, 50.0, 30.0, 100.0, 100.0, 20.0, 80.0, 120.0, 50.0, 110.0, 110.0, 110.0, 120.0, 90.0, 50.0, 45.0, 30.0, 90.0, 70.0, 60.0, 20.0, 170.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.085947847783061, "mean_inference_ms": 2.1469422471203363, "mean_action_processing_ms": 0.6184537614979339, "mean_env_wait_ms": 1.4340608749051136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012398242950439453, "StateBufferConnector_ms": 0.008989095687866211, "ViewRequirementAgentConnector_ms": 0.3755166530609131}, "num_episodes": 22, "episode_return_max": 1305.0, "episode_return_min": 316.0, "episode_return_mean": 826.99}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.615417118552628, "num_env_steps_trained_throughput_per_sec": 20.615417118552628, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 1720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1720000, "timers": {"training_iteration_time_ms": 193771.518, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193771.47, "sample_time_ms": 2328.597, "learn_time_ms": 191423.802, "learn_throughput": 20.896, "synch_weights_time_ms": 10.994}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "done": false, "training_iteration": 43, "trial_id": "1841f_00000", "date": "2024-08-08_02-01-41", "timestamp": 1723096901, "time_this_iter_s": 194.03947687149048, "time_total_s": 9685.720670700073, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2422670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9685.720670700073, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.262545454545453, "ram_util_percent": 78.20472727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5335016316499193, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.329240211003377, "policy_loss": -0.01145976081032294, "vf_loss": 8.339267833595967, "vf_explained_var": 0.0019984204167375168, "kl": 0.0071606405481727045, "entropy": 0.7274758566936619, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 408465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 1140.0, "episode_reward_min": 316.0, "episode_reward_mean": 823.79, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -43.0}, "policy_reward_max": {"policy_0": 270.0}, "policy_reward_mean": {"policy_0": 82.379}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.0, 1000.0, 798.0, 840.0, 640.0, 508.0, 397.0, 900.0, 941.0, 583.0, 796.0, 848.0, 799.0, 990.0, 779.0, 880.0, 1080.0, 1000.0, 575.0, 930.0, 787.0, 1030.0, 933.0, 1027.0, 660.0, 905.0, 780.0, 918.0, 720.0, 869.0, 1076.0, 1046.0, 617.0, 770.0, 1097.0, 970.0, 842.0, 710.0, 770.0, 800.0, 1140.0, 1034.0, 816.0, 894.0, 1000.0, 828.0, 555.0, 905.0, 902.0, 605.0, 1002.0, 845.0, 780.0, 790.0, 724.0, 940.0, 740.0, 948.0, 1110.0, 846.0, 928.0, 910.0, 651.0, 746.0, 571.0, 779.0, 720.0, 772.0, 1010.0, 440.0, 639.0, 935.0, 556.0, 731.0, 690.0, 920.0, 715.0, 928.0, 898.0, 877.0, 479.0, 622.0, 707.0, 1006.0, 910.0, 933.0, 900.0, 482.0, 865.0, 970.0, 950.0, 1010.0, 1054.0, 647.0, 881.0, 969.0, 714.0, 970.0, 823.0, 740.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 70.0, 50.0, 58.0, 19.0, 0.0, 50.0, -1.0, 30.0, 30.0, 70.0, 90.0, 110.0, 90.0, 110.0, 140.0, 50.0, 130.0, 40.0, 170.0, 130.0, 100.0, 50.0, 59.0, 110.0, 60.0, 120.0, 29.0, 30.0, 110.0, 40.0, 90.0, 30.0, 110.0, 80.0, 110.0, 130.0, 70.0, 120.0, 60.0, 130.0, 62.0, 110.0, 2.0, 33.0, 80.0, 60.0, 85.0, 33.0, 45.0, 70.0, 60.0, 90.0, 70.0, 120.0, 20.0, 32.0, -3.0, 48.0, 1.0, 30.0, 50.0, 30.0, 30.0, 50.0, 50.0, 20.0, 80.0, 17.0, 40.0, 140.0, 80.0, 120.0, 70.0, 100.0, 60.0, 70.0, 60.0, 100.0, 100.0, 80.0, 80.0, 170.0, 30.0, 90.0, 190.0, 60.0, 140.0, 82.0, 19.0, 60.0, 110.0, 24.0, 10.0, 80.0, 29.0, 60.0, 10.0, 100.0, 100.0, 270.0, 18.0, 30.0, 80.0, 30.0, 77.0, 68.0, 88.0, 100.0, 35.0, 110.0, 120.0, 110.0, 90.0, 75.0, 53.0, 110.0, 80.0, 40.0, 60.0, 90.0, 34.0, 60.0, 74.0, 90.0, 110.0, 90.0, 60.0, 91.0, 100.0, 131.0, 30.0, 100.0, 120.0, 140.0, 100.0, 59.0, 90.0, 80.0, 140.0, 70.0, 90.0, 90.0, 80.0, 50.0, 99.0, 130.0, 80.0, 40.0, 50.0, 70.0, 40.0, 90.0, 130.0, 130.0, 80.0, 100.0, 70.0, 70.0, 100.0, 160.0, 80.0, 160.0, 100.0, 90.0, 70.0, 150.0, 90.0, 130.0, 50.0, 150.0, 70.0, 90.0, 110.0, 50.0, 40.0, 150.0, 120.0, 90.0, 130.0, 60.0, 110.0, 20.0, 20.0, 68.0, 20.0, 50.0, 57.0, 60.0, 110.0, 100.0, 120.0, 150.0, 110.0, 40.0, 100.0, 80.0, 120.0, 70.0, 40.0, 46.0, 85.0, 160.0, 66.0, 130.0, 70.0, 80.0, 50.0, 70.0, 30.0, 60.0, 120.0, 140.0, 100.0, 110.0, 110.0, 110.0, 80.0, 100.0, 100.0, 90.0, 130.0, 80.0, 100.0, 80.0, 150.0, 83.0, 80.0, 60.0, 80.0, 90.0, 110.0, 90.0, 70.0, 70.0, 185.0, 150.0, 152.0, 30.0, 80.0, 90.0, 150.0, 60.0, 70.0, 30.0, 7.0, 81.0, 100.0, 12.0, 60.0, 90.0, 60.0, 82.0, 120.0, 120.0, 63.0, 100.0, 80.0, 100.0, 90.0, 60.0, 80.0, 40.0, 110.0, 60.0, 90.0, 90.0, 90.0, 70.0, 90.0, 75.0, 80.0, 170.0, -30.0, 80.0, 111.0, 150.0, 109.0, 80.0, 93.0, 40.0, 50.0, 70.0, 20.0, 100.0, 70.0, 50.0, 130.0, 90.0, 100.0, 110.0, 90.0, 120.0, 170.0, 120.0, 60.0, 80.0, 30.0, 59.0, 30.0, 130.0, 150.0, 50.0, 120.0, 130.0, 89.0, 90.0, 90.0, 120.0, 107.0, 115.0, 100.0, 40.0, 110.0, 131.0, 70.0, 130.0, 100.0, 90.0, 160.0, 40.0, 80.0, 60.0, 30.0, 70.0, 20.0, 50.0, 47.0, 190.0, 30.0, 50.0, 110.0, 130.0, 90.0, 100.0, 90.0, 50.0, 120.0, -20.0, 50.0, 120.0, 80.0, 80.0, 120.0, 60.0, 80.0, 104.0, 73.0, 260.0, 120.0, 90.0, 150.0, 130.0, 80.0, 80.0, 50.0, 70.0, 130.0, 80.0, 110.0, 80.0, 48.0, 60.0, 170.0, 80.0, 200.0, -43.0, 200.0, 29.0, 18.0, 70.0, 50.0, 50.0, 180.0, 40.0, 70.0, 80.0, 80.0, 0.0, 90.0, 60.0, 50.0, 90.0, 110.0, 70.0, 60.0, 80.0, 70.0, 100.0, 80.0, 90.0, 40.0, 70.0, 60.0, 110.0, 30.0, 40.0, 160.0, 70.0, 130.0, 120.0, 40.0, 80.0, 80.0, 110.0, 90.0, 80.0, 210.0, 160.0, 170.0, 120.0, 120.0, 100.0, 140.0, 150.0, 79.0, 110.0, 100.0, 70.0, 45.0, 100.0, 5.0, 90.0, 80.0, 100.0, 40.0, 230.0, 100.0, 11.0, 60.0, 90.0, 90.0, 110.0, 69.0, 67.0, 140.0, 140.0, 90.0, 48.0, 50.0, 10.0, 150.0, 130.0, 50.0, 130.0, 140.0, 120.0, 20.0, 120.0, 130.0, 55.0, 90.0, 220.0, 52.0, 50.0, 25.0, 70.0, 150.0, 70.0, 46.0, 70.0, 30.0, 28.0, 80.0, 50.0, 40.0, 80.0, 50.0, 80.0, 47.0, 60.0, 180.0, 160.0, 25.0, 70.0, 130.0, 60.0, 80.0, 60.0, 80.0, 110.0, 81.0, 190.0, 55.0, 70.0, 100.0, 4.0, 60.0, 140.0, 92.0, 51.0, 40.0, 90.0, 50.0, 40.0, 30.0, 59.0, 55.0, 100.0, 90.0, 110.0, 100.0, 170.0, 42.0, 130.0, 53.0, 90.0, 84.0, 140.0, 83.0, 92.0, 150.0, 43.0, 70.0, 130.0, 60.0, 100.0, 50.0, 100.0, 50.0, 110.0, 120.0, 80.0, 61.0, 80.0, 69.0, -10.0, 70.0, 100.0, 100.0, 70.0, 60.0, 50.0, 60.0, 70.0, 110.0, 70.0, 50.0, 120.0, 130.0, 80.0, 50.0, 20.0, 80.0, -6.0, 40.0, 80.0, 50.0, 230.0, 100.0, 130.0, 130.0, 65.0, 40.0, 72.0, 130.0, 110.0, 50.0, 160.0, 53.0, 26.0, 80.0, 97.0, 60.0, 110.0, 90.0, 32.0, 65.0, 90.0, 90.0, 120.0, 100.0, 140.0, 70.0, 90.0, 110.0, 42.0, 26.0, 140.0, 110.0, 110.0, 80.0, 140.0, 110.0, 40.0, 130.0, 150.0, 50.0, 100.0, 200.0, 100.0, 106.0, 80.0, 120.0, 128.0, 70.0, 20.0, 95.0, 70.0, 57.0, 130.0, 80.0, 130.0, 127.0, 100.0, 50.0, 41.0, 60.0, 130.0, 80.0, 95.0, 50.0, 140.0, 20.0, 140.0, 40.0, 80.0, 120.0, 45.0, 180.0, 110.0, 45.0, 90.0, 50.0, 80.0, 40.0, 50.0, 90.0, 70.0, 26.0, 80.0, 67.0, 110.0, 60.0, 49.0, 60.0, 140.0, 30.0, 60.0, 90.0, 30.0, 60.0, 50.0, 51.0, 50.0, 90.0, 130.0, 2.0, 110.0, -2.0, 73.0, 73.0, 30.0, 50.0, 100.0, 130.0, 90.0, 40.0, 130.0, 63.0, 50.0, 100.0, 30.0, 160.0, 60.0, 50.0, 44.0, 56.0, 90.0, 80.0, 190.0, 90.0, 90.0, 50.0, 30.0, 60.0, 50.0, 61.0, 61.0, 90.0, 170.0, 90.0, 110.0, 70.0, 50.0, 140.0, 50.0, 160.0, 90.0, 80.0, 10.0, 30.0, 40.0, 70.0, -1.0, 40.0, 70.0, 51.0, 60.0, 70.0, 80.0, 240.0, 60.0, 30.0, 90.0, 40.0, 30.0, 0.0, 50.0, 19.0, 50.0, 70.0, 40.0, 129.0, 130.0, 100.0, 75.0, 180.0, 103.0, 58.0, 30.0, 150.0, 20.0, 30.0, 100.0, 40.0, 60.0, 36.0, 40.0, 50.0, 190.0, 50.0, 80.0, 90.0, 50.0, 33.0, 50.0, -2.0, 50.0, 140.0, 70.0, 40.0, 50.0, 150.0, 50.0, 30.0, 100.0, 120.0, 50.0, 30.0, 100.0, 100.0, 20.0, 80.0, 120.0, 50.0, 110.0, 110.0, 110.0, 120.0, 90.0, 50.0, 45.0, 30.0, 90.0, 70.0, 60.0, 20.0, 170.0, 90.0, 110.0, 68.0, 110.0, 20.0, 50.0, 100.0, 110.0, 80.0, 140.0, 140.0, 100.0, 134.0, 55.0, 160.0, 64.0, 140.0, 29.0, 60.0, 16.0, 140.0, 90.0, 97.0, 30.0, 70.0, 180.0, 110.0, 40.0, 70.0, 80.0, 110.0, 50.0, 40.0, 60.0, 50.0, 20.0, 39.0, 70.0, 60.0, 0.0, 90.0, 20.0, 70.0, 60.0, 30.0, 30.0, 71.0, 51.0, 140.0, 20.0, 130.0, 120.0, 46.0, 20.0, 70.0, 50.0, 80.0, 68.0, 120.0, 66.0, 67.0, 120.0, 60.0, 200.0, 80.0, 40.0, 150.0, 90.0, 80.0, 50.0, 136.0, 60.0, 80.0, 140.0, 90.0, 60.0, 180.0, 50.0, 140.0, 50.0, 60.0, 70.0, 40.0, 40.0, 130.0, 130.0, 150.0, 80.0, 80.0, 96.0, 117.0, 150.0, 60.0, 40.0, 80.0, 60.0, 210.0, 80.0, 70.0, 50.0, 100.0, 60.0, 30.0, 47.0, 50.0, 80.0, 40.0, 90.0, 50.0, 5.0, 30.0, 70.0, 160.0, 57.0, 60.0, 106.0, 60.0, 12.0, 45.0, 125.0, 170.0, 140.0, 120.0, 100.0, 70.0, 60.0, 120.0, 100.0, 60.0, 110.0, 90.0, 40.0, 90.0, 120.0, 90.0, 90.0, 120.0, 90.0, 140.0, 90.0, 80.0, 160.0, 110.0, 100.0, 170.0, 20.0, 90.0, 120.0, 70.0, 80.0, 90.0, 80.0, 70.0, 80.0, 80.0, 135.0, 140.0, 80.0, 180.0, 80.0, 129.0, 90.0, 220.0, 35.0, 8.0, 40.0, 100.0, 39.0, 5.0, 40.0, 70.0, 40.0, 130.0, 170.0, 50.0, 80.0, 40.0, 90.0, 120.0, 100.0, 61.0, 60.0, 100.0, 70.0, 30.0, 100.0, 99.0, 210.0, 140.0, 90.0, 70.0, 50.0, 70.0, 40.0, 90.0, 82.0, 140.0, 70.0, 52.0, 40.0, 80.0, 90.0, 40.0, 140.0, 150.0, 80.0, 80.0, 20.0, 110.0, 130.0, 130.0, 55.0, 100.0, 29.0, 60.0, 180.0, 90.0, 24.0, 25.0, 160.0, 100.0, 50.0, 70.0, 100.0, 100.0, 50.0, 100.0, 120.0, 50.0, 50.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.069157143888908, "mean_inference_ms": 2.126723305350052, "mean_action_processing_ms": 0.6129954287016444, "mean_env_wait_ms": 1.4210635891454944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012510538101196289, "StateBufferConnector_ms": 0.009270429611206055, "ViewRequirementAgentConnector_ms": 0.38849663734436035}, "num_episodes": 23, "episode_return_max": 1140.0, "episode_return_min": 316.0, "episode_return_mean": 823.79}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.595422105518377, "num_env_steps_trained_throughput_per_sec": 20.595422105518377, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 193838.363, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193838.316, "sample_time_ms": 2336.928, "learn_time_ms": 191481.986, "learn_throughput": 20.89, "synch_weights_time_ms": 11.375}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 44, "trial_id": "1841f_00000", "date": "2024-08-08_02-04-55", "timestamp": 1723097095, "time_this_iter_s": 194.22667026519775, "time_total_s": 9879.947340965271, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2422940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9879.947340965271, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.874545454545455, "ram_util_percent": 78.25272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4978546456787916, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.179217317589302, "policy_loss": -0.012433427056948297, "vf_loss": 8.190138841614809, "vf_explained_var": 0.0028981755843685585, "kl": 0.007559515217881532, "entropy": 0.717769240069821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 417855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 1291.0, "episode_reward_min": 440.0, "episode_reward_mean": 828.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -43.0}, "policy_reward_max": {"policy_0": 260.0}, "policy_reward_mean": {"policy_0": 82.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [575.0, 930.0, 787.0, 1030.0, 933.0, 1027.0, 660.0, 905.0, 780.0, 918.0, 720.0, 869.0, 1076.0, 1046.0, 617.0, 770.0, 1097.0, 970.0, 842.0, 710.0, 770.0, 800.0, 1140.0, 1034.0, 816.0, 894.0, 1000.0, 828.0, 555.0, 905.0, 902.0, 605.0, 1002.0, 845.0, 780.0, 790.0, 724.0, 940.0, 740.0, 948.0, 1110.0, 846.0, 928.0, 910.0, 651.0, 746.0, 571.0, 779.0, 720.0, 772.0, 1010.0, 440.0, 639.0, 935.0, 556.0, 731.0, 690.0, 920.0, 715.0, 928.0, 898.0, 877.0, 479.0, 622.0, 707.0, 1006.0, 910.0, 933.0, 900.0, 482.0, 865.0, 970.0, 950.0, 1010.0, 1054.0, 647.0, 881.0, 969.0, 714.0, 970.0, 823.0, 740.0, 1291.0, 787.0, 886.0, 660.0, 880.0, 740.0, 910.0, 515.0, 626.0, 850.0, 830.0, 801.0, 775.0, 758.0, 914.0, 791.0, 580.0, 977.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 110.0, 20.0, 20.0, 68.0, 20.0, 50.0, 57.0, 60.0, 110.0, 100.0, 120.0, 150.0, 110.0, 40.0, 100.0, 80.0, 120.0, 70.0, 40.0, 46.0, 85.0, 160.0, 66.0, 130.0, 70.0, 80.0, 50.0, 70.0, 30.0, 60.0, 120.0, 140.0, 100.0, 110.0, 110.0, 110.0, 80.0, 100.0, 100.0, 90.0, 130.0, 80.0, 100.0, 80.0, 150.0, 83.0, 80.0, 60.0, 80.0, 90.0, 110.0, 90.0, 70.0, 70.0, 185.0, 150.0, 152.0, 30.0, 80.0, 90.0, 150.0, 60.0, 70.0, 30.0, 7.0, 81.0, 100.0, 12.0, 60.0, 90.0, 60.0, 82.0, 120.0, 120.0, 63.0, 100.0, 80.0, 100.0, 90.0, 60.0, 80.0, 40.0, 110.0, 60.0, 90.0, 90.0, 90.0, 70.0, 90.0, 75.0, 80.0, 170.0, -30.0, 80.0, 111.0, 150.0, 109.0, 80.0, 93.0, 40.0, 50.0, 70.0, 20.0, 100.0, 70.0, 50.0, 130.0, 90.0, 100.0, 110.0, 90.0, 120.0, 170.0, 120.0, 60.0, 80.0, 30.0, 59.0, 30.0, 130.0, 150.0, 50.0, 120.0, 130.0, 89.0, 90.0, 90.0, 120.0, 107.0, 115.0, 100.0, 40.0, 110.0, 131.0, 70.0, 130.0, 100.0, 90.0, 160.0, 40.0, 80.0, 60.0, 30.0, 70.0, 20.0, 50.0, 47.0, 190.0, 30.0, 50.0, 110.0, 130.0, 90.0, 100.0, 90.0, 50.0, 120.0, -20.0, 50.0, 120.0, 80.0, 80.0, 120.0, 60.0, 80.0, 104.0, 73.0, 260.0, 120.0, 90.0, 150.0, 130.0, 80.0, 80.0, 50.0, 70.0, 130.0, 80.0, 110.0, 80.0, 48.0, 60.0, 170.0, 80.0, 200.0, -43.0, 200.0, 29.0, 18.0, 70.0, 50.0, 50.0, 180.0, 40.0, 70.0, 80.0, 80.0, 0.0, 90.0, 60.0, 50.0, 90.0, 110.0, 70.0, 60.0, 80.0, 70.0, 100.0, 80.0, 90.0, 40.0, 70.0, 60.0, 110.0, 30.0, 40.0, 160.0, 70.0, 130.0, 120.0, 40.0, 80.0, 80.0, 110.0, 90.0, 80.0, 210.0, 160.0, 170.0, 120.0, 120.0, 100.0, 140.0, 150.0, 79.0, 110.0, 100.0, 70.0, 45.0, 100.0, 5.0, 90.0, 80.0, 100.0, 40.0, 230.0, 100.0, 11.0, 60.0, 90.0, 90.0, 110.0, 69.0, 67.0, 140.0, 140.0, 90.0, 48.0, 50.0, 10.0, 150.0, 130.0, 50.0, 130.0, 140.0, 120.0, 20.0, 120.0, 130.0, 55.0, 90.0, 220.0, 52.0, 50.0, 25.0, 70.0, 150.0, 70.0, 46.0, 70.0, 30.0, 28.0, 80.0, 50.0, 40.0, 80.0, 50.0, 80.0, 47.0, 60.0, 180.0, 160.0, 25.0, 70.0, 130.0, 60.0, 80.0, 60.0, 80.0, 110.0, 81.0, 190.0, 55.0, 70.0, 100.0, 4.0, 60.0, 140.0, 92.0, 51.0, 40.0, 90.0, 50.0, 40.0, 30.0, 59.0, 55.0, 100.0, 90.0, 110.0, 100.0, 170.0, 42.0, 130.0, 53.0, 90.0, 84.0, 140.0, 83.0, 92.0, 150.0, 43.0, 70.0, 130.0, 60.0, 100.0, 50.0, 100.0, 50.0, 110.0, 120.0, 80.0, 61.0, 80.0, 69.0, -10.0, 70.0, 100.0, 100.0, 70.0, 60.0, 50.0, 60.0, 70.0, 110.0, 70.0, 50.0, 120.0, 130.0, 80.0, 50.0, 20.0, 80.0, -6.0, 40.0, 80.0, 50.0, 230.0, 100.0, 130.0, 130.0, 65.0, 40.0, 72.0, 130.0, 110.0, 50.0, 160.0, 53.0, 26.0, 80.0, 97.0, 60.0, 110.0, 90.0, 32.0, 65.0, 90.0, 90.0, 120.0, 100.0, 140.0, 70.0, 90.0, 110.0, 42.0, 26.0, 140.0, 110.0, 110.0, 80.0, 140.0, 110.0, 40.0, 130.0, 150.0, 50.0, 100.0, 200.0, 100.0, 106.0, 80.0, 120.0, 128.0, 70.0, 20.0, 95.0, 70.0, 57.0, 130.0, 80.0, 130.0, 127.0, 100.0, 50.0, 41.0, 60.0, 130.0, 80.0, 95.0, 50.0, 140.0, 20.0, 140.0, 40.0, 80.0, 120.0, 45.0, 180.0, 110.0, 45.0, 90.0, 50.0, 80.0, 40.0, 50.0, 90.0, 70.0, 26.0, 80.0, 67.0, 110.0, 60.0, 49.0, 60.0, 140.0, 30.0, 60.0, 90.0, 30.0, 60.0, 50.0, 51.0, 50.0, 90.0, 130.0, 2.0, 110.0, -2.0, 73.0, 73.0, 30.0, 50.0, 100.0, 130.0, 90.0, 40.0, 130.0, 63.0, 50.0, 100.0, 30.0, 160.0, 60.0, 50.0, 44.0, 56.0, 90.0, 80.0, 190.0, 90.0, 90.0, 50.0, 30.0, 60.0, 50.0, 61.0, 61.0, 90.0, 170.0, 90.0, 110.0, 70.0, 50.0, 140.0, 50.0, 160.0, 90.0, 80.0, 10.0, 30.0, 40.0, 70.0, -1.0, 40.0, 70.0, 51.0, 60.0, 70.0, 80.0, 240.0, 60.0, 30.0, 90.0, 40.0, 30.0, 0.0, 50.0, 19.0, 50.0, 70.0, 40.0, 129.0, 130.0, 100.0, 75.0, 180.0, 103.0, 58.0, 30.0, 150.0, 20.0, 30.0, 100.0, 40.0, 60.0, 36.0, 40.0, 50.0, 190.0, 50.0, 80.0, 90.0, 50.0, 33.0, 50.0, -2.0, 50.0, 140.0, 70.0, 40.0, 50.0, 150.0, 50.0, 30.0, 100.0, 120.0, 50.0, 30.0, 100.0, 100.0, 20.0, 80.0, 120.0, 50.0, 110.0, 110.0, 110.0, 120.0, 90.0, 50.0, 45.0, 30.0, 90.0, 70.0, 60.0, 20.0, 170.0, 90.0, 110.0, 68.0, 110.0, 20.0, 50.0, 100.0, 110.0, 80.0, 140.0, 140.0, 100.0, 134.0, 55.0, 160.0, 64.0, 140.0, 29.0, 60.0, 16.0, 140.0, 90.0, 97.0, 30.0, 70.0, 180.0, 110.0, 40.0, 70.0, 80.0, 110.0, 50.0, 40.0, 60.0, 50.0, 20.0, 39.0, 70.0, 60.0, 0.0, 90.0, 20.0, 70.0, 60.0, 30.0, 30.0, 71.0, 51.0, 140.0, 20.0, 130.0, 120.0, 46.0, 20.0, 70.0, 50.0, 80.0, 68.0, 120.0, 66.0, 67.0, 120.0, 60.0, 200.0, 80.0, 40.0, 150.0, 90.0, 80.0, 50.0, 136.0, 60.0, 80.0, 140.0, 90.0, 60.0, 180.0, 50.0, 140.0, 50.0, 60.0, 70.0, 40.0, 40.0, 130.0, 130.0, 150.0, 80.0, 80.0, 96.0, 117.0, 150.0, 60.0, 40.0, 80.0, 60.0, 210.0, 80.0, 70.0, 50.0, 100.0, 60.0, 30.0, 47.0, 50.0, 80.0, 40.0, 90.0, 50.0, 5.0, 30.0, 70.0, 160.0, 57.0, 60.0, 106.0, 60.0, 12.0, 45.0, 125.0, 170.0, 140.0, 120.0, 100.0, 70.0, 60.0, 120.0, 100.0, 60.0, 110.0, 90.0, 40.0, 90.0, 120.0, 90.0, 90.0, 120.0, 90.0, 140.0, 90.0, 80.0, 160.0, 110.0, 100.0, 170.0, 20.0, 90.0, 120.0, 70.0, 80.0, 90.0, 80.0, 70.0, 80.0, 80.0, 135.0, 140.0, 80.0, 180.0, 80.0, 129.0, 90.0, 220.0, 35.0, 8.0, 40.0, 100.0, 39.0, 5.0, 40.0, 70.0, 40.0, 130.0, 170.0, 50.0, 80.0, 40.0, 90.0, 120.0, 100.0, 61.0, 60.0, 100.0, 70.0, 30.0, 100.0, 99.0, 210.0, 140.0, 90.0, 70.0, 50.0, 70.0, 40.0, 90.0, 82.0, 140.0, 70.0, 52.0, 40.0, 80.0, 90.0, 40.0, 140.0, 150.0, 80.0, 80.0, 20.0, 110.0, 130.0, 130.0, 55.0, 100.0, 29.0, 60.0, 180.0, 90.0, 24.0, 25.0, 160.0, 100.0, 50.0, 70.0, 100.0, 100.0, 50.0, 100.0, 120.0, 50.0, 50.0, 50.0, 90.0, 127.0, 180.0, 170.0, 180.0, 160.0, 44.0, 130.0, 120.0, 90.0, 80.0, 60.0, 70.0, 50.0, 30.0, 130.0, 100.0, 80.0, 77.0, 110.0, 90.0, 150.0, 90.0, 76.0, 110.0, 85.0, 100.0, 90.0, -8.0, 103.0, 100.0, 90.0, 30.0, 120.0, 40.0, 20.0, 90.0, 30.0, 90.0, 50.0, 50.0, 100.0, 50.0, 120.0, 80.0, 200.0, 60.0, 90.0, 60.0, 70.0, 30.0, 140.0, 30.0, 30.0, 30.0, 120.0, 130.0, 110.0, 80.0, 40.0, 80.0, 80.0, 90.0, 60.0, 90.0, 60.0, 220.0, 100.0, 80.0, 50.0, 50.0, 37.0, 30.0, 40.0, 68.0, 70.0, 40.0, 60.0, 70.0, 50.0, 230.0, 70.0, 30.0, 50.0, 30.0, 90.0, 19.0, 50.0, 37.0, 20.0, 70.0, 70.0, 140.0, 70.0, 80.0, 120.0, 80.0, 130.0, 50.0, 40.0, 20.0, 60.0, 110.0, 110.0, 30.0, 90.0, 100.0, 130.0, 70.0, 110.0, 90.0, 110.0, 43.0, 8.0, 50.0, 80.0, 80.0, 160.0, 110.0, 70.0, 40.0, 28.0, 88.0, 50.0, 100.0, 90.0, 130.0, 69.0, 60.0, 120.0, 180.0, 160.0, 90.0, 60.0, 10.0, 50.0, 20.0, 60.0, 16.0, 112.0, 80.0, 97.0, 100.0, 90.0, 170.0, 90.0, 100.0, 92.0, 98.0, -3.0, 60.0, 48.0, 90.0, 70.0, 57.0, 90.0, 70.0, 156.0, 100.0, 50.0, 90.0, 10.0, 60.0, 60.0, 40.0, 80.0, 80.0, 90.0, 30.0, 40.0, 140.0, 140.0, 150.0, 40.0, 30.0, 120.0, 139.0, 58.0, 60.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0569684524713963, "mean_inference_ms": 2.1112513336500083, "mean_action_processing_ms": 0.6089669312895724, "mean_env_wait_ms": 1.4114455250400448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017260313034057617, "StateBufferConnector_ms": 0.009261369705200195, "ViewRequirementAgentConnector_ms": 0.38657140731811523}, "num_episodes": 18, "episode_return_max": 1291.0, "episode_return_min": 440.0, "episode_return_mean": 828.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.523279517902296, "num_env_steps_trained_throughput_per_sec": 20.523279517902296, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 193884.593, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193884.547, "sample_time_ms": 2343.319, "learn_time_ms": 191521.614, "learn_throughput": 20.885, "synch_weights_time_ms": 11.666}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 45, "trial_id": "1841f_00000", "date": "2024-08-08_02-08-10", "timestamp": 1723097290, "time_this_iter_s": 194.9238781929016, "time_total_s": 10074.871219158173, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2422ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10074.871219158173, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.832727272727272, "ram_util_percent": 78.048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5204701713924083, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.4127433281737, "policy_loss": -0.011667128169960694, "vf_loss": 8.422970354671296, "vf_explained_var": 0.002371511659937037, "kl": 0.007200503842918144, "entropy": 0.6949250698533936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 427245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 1366.0, "episode_reward_min": 440.0, "episode_reward_mean": 816.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -43.0}, "policy_reward_max": {"policy_0": 330.0}, "policy_reward_mean": {"policy_0": 81.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [842.0, 710.0, 770.0, 800.0, 1140.0, 1034.0, 816.0, 894.0, 1000.0, 828.0, 555.0, 905.0, 902.0, 605.0, 1002.0, 845.0, 780.0, 790.0, 724.0, 940.0, 740.0, 948.0, 1110.0, 846.0, 928.0, 910.0, 651.0, 746.0, 571.0, 779.0, 720.0, 772.0, 1010.0, 440.0, 639.0, 935.0, 556.0, 731.0, 690.0, 920.0, 715.0, 928.0, 898.0, 877.0, 479.0, 622.0, 707.0, 1006.0, 910.0, 933.0, 900.0, 482.0, 865.0, 970.0, 950.0, 1010.0, 1054.0, 647.0, 881.0, 969.0, 714.0, 970.0, 823.0, 740.0, 1291.0, 787.0, 886.0, 660.0, 880.0, 740.0, 910.0, 515.0, 626.0, 850.0, 830.0, 801.0, 775.0, 758.0, 914.0, 791.0, 580.0, 977.0, 600.0, 893.0, 659.0, 685.0, 632.0, 826.0, 675.0, 862.0, 788.0, 790.0, 873.0, 1366.0, 1285.0, 885.0, 614.0, 590.0, 722.0, 775.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 48.0, 60.0, 170.0, 80.0, 200.0, -43.0, 200.0, 29.0, 18.0, 70.0, 50.0, 50.0, 180.0, 40.0, 70.0, 80.0, 80.0, 0.0, 90.0, 60.0, 50.0, 90.0, 110.0, 70.0, 60.0, 80.0, 70.0, 100.0, 80.0, 90.0, 40.0, 70.0, 60.0, 110.0, 30.0, 40.0, 160.0, 70.0, 130.0, 120.0, 40.0, 80.0, 80.0, 110.0, 90.0, 80.0, 210.0, 160.0, 170.0, 120.0, 120.0, 100.0, 140.0, 150.0, 79.0, 110.0, 100.0, 70.0, 45.0, 100.0, 5.0, 90.0, 80.0, 100.0, 40.0, 230.0, 100.0, 11.0, 60.0, 90.0, 90.0, 110.0, 69.0, 67.0, 140.0, 140.0, 90.0, 48.0, 50.0, 10.0, 150.0, 130.0, 50.0, 130.0, 140.0, 120.0, 20.0, 120.0, 130.0, 55.0, 90.0, 220.0, 52.0, 50.0, 25.0, 70.0, 150.0, 70.0, 46.0, 70.0, 30.0, 28.0, 80.0, 50.0, 40.0, 80.0, 50.0, 80.0, 47.0, 60.0, 180.0, 160.0, 25.0, 70.0, 130.0, 60.0, 80.0, 60.0, 80.0, 110.0, 81.0, 190.0, 55.0, 70.0, 100.0, 4.0, 60.0, 140.0, 92.0, 51.0, 40.0, 90.0, 50.0, 40.0, 30.0, 59.0, 55.0, 100.0, 90.0, 110.0, 100.0, 170.0, 42.0, 130.0, 53.0, 90.0, 84.0, 140.0, 83.0, 92.0, 150.0, 43.0, 70.0, 130.0, 60.0, 100.0, 50.0, 100.0, 50.0, 110.0, 120.0, 80.0, 61.0, 80.0, 69.0, -10.0, 70.0, 100.0, 100.0, 70.0, 60.0, 50.0, 60.0, 70.0, 110.0, 70.0, 50.0, 120.0, 130.0, 80.0, 50.0, 20.0, 80.0, -6.0, 40.0, 80.0, 50.0, 230.0, 100.0, 130.0, 130.0, 65.0, 40.0, 72.0, 130.0, 110.0, 50.0, 160.0, 53.0, 26.0, 80.0, 97.0, 60.0, 110.0, 90.0, 32.0, 65.0, 90.0, 90.0, 120.0, 100.0, 140.0, 70.0, 90.0, 110.0, 42.0, 26.0, 140.0, 110.0, 110.0, 80.0, 140.0, 110.0, 40.0, 130.0, 150.0, 50.0, 100.0, 200.0, 100.0, 106.0, 80.0, 120.0, 128.0, 70.0, 20.0, 95.0, 70.0, 57.0, 130.0, 80.0, 130.0, 127.0, 100.0, 50.0, 41.0, 60.0, 130.0, 80.0, 95.0, 50.0, 140.0, 20.0, 140.0, 40.0, 80.0, 120.0, 45.0, 180.0, 110.0, 45.0, 90.0, 50.0, 80.0, 40.0, 50.0, 90.0, 70.0, 26.0, 80.0, 67.0, 110.0, 60.0, 49.0, 60.0, 140.0, 30.0, 60.0, 90.0, 30.0, 60.0, 50.0, 51.0, 50.0, 90.0, 130.0, 2.0, 110.0, -2.0, 73.0, 73.0, 30.0, 50.0, 100.0, 130.0, 90.0, 40.0, 130.0, 63.0, 50.0, 100.0, 30.0, 160.0, 60.0, 50.0, 44.0, 56.0, 90.0, 80.0, 190.0, 90.0, 90.0, 50.0, 30.0, 60.0, 50.0, 61.0, 61.0, 90.0, 170.0, 90.0, 110.0, 70.0, 50.0, 140.0, 50.0, 160.0, 90.0, 80.0, 10.0, 30.0, 40.0, 70.0, -1.0, 40.0, 70.0, 51.0, 60.0, 70.0, 80.0, 240.0, 60.0, 30.0, 90.0, 40.0, 30.0, 0.0, 50.0, 19.0, 50.0, 70.0, 40.0, 129.0, 130.0, 100.0, 75.0, 180.0, 103.0, 58.0, 30.0, 150.0, 20.0, 30.0, 100.0, 40.0, 60.0, 36.0, 40.0, 50.0, 190.0, 50.0, 80.0, 90.0, 50.0, 33.0, 50.0, -2.0, 50.0, 140.0, 70.0, 40.0, 50.0, 150.0, 50.0, 30.0, 100.0, 120.0, 50.0, 30.0, 100.0, 100.0, 20.0, 80.0, 120.0, 50.0, 110.0, 110.0, 110.0, 120.0, 90.0, 50.0, 45.0, 30.0, 90.0, 70.0, 60.0, 20.0, 170.0, 90.0, 110.0, 68.0, 110.0, 20.0, 50.0, 100.0, 110.0, 80.0, 140.0, 140.0, 100.0, 134.0, 55.0, 160.0, 64.0, 140.0, 29.0, 60.0, 16.0, 140.0, 90.0, 97.0, 30.0, 70.0, 180.0, 110.0, 40.0, 70.0, 80.0, 110.0, 50.0, 40.0, 60.0, 50.0, 20.0, 39.0, 70.0, 60.0, 0.0, 90.0, 20.0, 70.0, 60.0, 30.0, 30.0, 71.0, 51.0, 140.0, 20.0, 130.0, 120.0, 46.0, 20.0, 70.0, 50.0, 80.0, 68.0, 120.0, 66.0, 67.0, 120.0, 60.0, 200.0, 80.0, 40.0, 150.0, 90.0, 80.0, 50.0, 136.0, 60.0, 80.0, 140.0, 90.0, 60.0, 180.0, 50.0, 140.0, 50.0, 60.0, 70.0, 40.0, 40.0, 130.0, 130.0, 150.0, 80.0, 80.0, 96.0, 117.0, 150.0, 60.0, 40.0, 80.0, 60.0, 210.0, 80.0, 70.0, 50.0, 100.0, 60.0, 30.0, 47.0, 50.0, 80.0, 40.0, 90.0, 50.0, 5.0, 30.0, 70.0, 160.0, 57.0, 60.0, 106.0, 60.0, 12.0, 45.0, 125.0, 170.0, 140.0, 120.0, 100.0, 70.0, 60.0, 120.0, 100.0, 60.0, 110.0, 90.0, 40.0, 90.0, 120.0, 90.0, 90.0, 120.0, 90.0, 140.0, 90.0, 80.0, 160.0, 110.0, 100.0, 170.0, 20.0, 90.0, 120.0, 70.0, 80.0, 90.0, 80.0, 70.0, 80.0, 80.0, 135.0, 140.0, 80.0, 180.0, 80.0, 129.0, 90.0, 220.0, 35.0, 8.0, 40.0, 100.0, 39.0, 5.0, 40.0, 70.0, 40.0, 130.0, 170.0, 50.0, 80.0, 40.0, 90.0, 120.0, 100.0, 61.0, 60.0, 100.0, 70.0, 30.0, 100.0, 99.0, 210.0, 140.0, 90.0, 70.0, 50.0, 70.0, 40.0, 90.0, 82.0, 140.0, 70.0, 52.0, 40.0, 80.0, 90.0, 40.0, 140.0, 150.0, 80.0, 80.0, 20.0, 110.0, 130.0, 130.0, 55.0, 100.0, 29.0, 60.0, 180.0, 90.0, 24.0, 25.0, 160.0, 100.0, 50.0, 70.0, 100.0, 100.0, 50.0, 100.0, 120.0, 50.0, 50.0, 50.0, 90.0, 127.0, 180.0, 170.0, 180.0, 160.0, 44.0, 130.0, 120.0, 90.0, 80.0, 60.0, 70.0, 50.0, 30.0, 130.0, 100.0, 80.0, 77.0, 110.0, 90.0, 150.0, 90.0, 76.0, 110.0, 85.0, 100.0, 90.0, -8.0, 103.0, 100.0, 90.0, 30.0, 120.0, 40.0, 20.0, 90.0, 30.0, 90.0, 50.0, 50.0, 100.0, 50.0, 120.0, 80.0, 200.0, 60.0, 90.0, 60.0, 70.0, 30.0, 140.0, 30.0, 30.0, 30.0, 120.0, 130.0, 110.0, 80.0, 40.0, 80.0, 80.0, 90.0, 60.0, 90.0, 60.0, 220.0, 100.0, 80.0, 50.0, 50.0, 37.0, 30.0, 40.0, 68.0, 70.0, 40.0, 60.0, 70.0, 50.0, 230.0, 70.0, 30.0, 50.0, 30.0, 90.0, 19.0, 50.0, 37.0, 20.0, 70.0, 70.0, 140.0, 70.0, 80.0, 120.0, 80.0, 130.0, 50.0, 40.0, 20.0, 60.0, 110.0, 110.0, 30.0, 90.0, 100.0, 130.0, 70.0, 110.0, 90.0, 110.0, 43.0, 8.0, 50.0, 80.0, 80.0, 160.0, 110.0, 70.0, 40.0, 28.0, 88.0, 50.0, 100.0, 90.0, 130.0, 69.0, 60.0, 120.0, 180.0, 160.0, 90.0, 60.0, 10.0, 50.0, 20.0, 60.0, 16.0, 112.0, 80.0, 97.0, 100.0, 90.0, 170.0, 90.0, 100.0, 92.0, 98.0, -3.0, 60.0, 48.0, 90.0, 70.0, 57.0, 90.0, 70.0, 156.0, 100.0, 50.0, 90.0, 10.0, 60.0, 60.0, 40.0, 80.0, 80.0, 90.0, 30.0, 40.0, 140.0, 140.0, 150.0, 40.0, 30.0, 120.0, 139.0, 58.0, 60.0, 100.0, 60.0, 42.0, 140.0, 95.0, -19.0, 100.0, 20.0, 12.0, 100.0, 50.0, 80.0, 70.0, 40.0, 15.0, 140.0, 80.0, 150.0, 140.0, 120.0, 58.0, 30.0, 110.0, 30.0, 140.0, 70.0, 39.0, 50.0, 50.0, 80.0, 60.0, 40.0, 160.0, 100.0, 60.0, 60.0, 15.0, 90.0, 30.0, 60.0, 70.0, 100.0, 70.0, 9.0, 70.0, 40.0, 130.0, 100.0, -12.0, 55.0, 70.0, 70.0, 40.0, 110.0, 40.0, 118.0, 110.0, 60.0, 120.0, 70.0, 88.0, 80.0, 110.0, 90.0, 70.0, 23.0, 60.0, 169.0, 23.0, -10.0, 60.0, 6.0, 110.0, 70.0, 130.0, 90.0, 45.0, 91.0, 140.0, 60.0, 120.0, 140.0, 80.0, 50.0, 70.0, 100.0, 50.0, 150.0, 70.0, -2.0, 80.0, 10.0, 120.0, 240.0, 140.0, 80.0, 40.0, 50.0, 40.0, 40.0, 30.0, 90.0, 80.0, 100.0, 80.0, 76.0, 27.0, 100.0, 110.0, 70.0, 140.0, 124.0, 150.0, 330.0, 130.0, 70.0, 112.0, 100.0, 180.0, 30.0, 140.0, 110.0, 180.0, 80.0, 100.0, 230.0, 60.0, 90.0, 175.0, 120.0, 140.0, 73.0, 210.0, 70.0, 82.0, 10.0, 70.0, 80.0, 80.0, 140.0, 70.0, 2.0, 160.0, 50.0, 28.0, 90.0, 90.0, 37.0, 7.0, 60.0, 90.0, 45.0, 84.0, 50.0, 70.0, 50.0, 60.0, 100.0, 45.0, 80.0, 6.0, 80.0, 60.0, 90.0, 70.0, 75.0, 110.0, 47.0, 60.0, 70.0, 60.0, 50.0, 20.0, 80.0, 160.0, 90.0, 25.0, 120.0, 150.0, 20.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.045715592096542, "mean_inference_ms": 2.0968556224587114, "mean_action_processing_ms": 0.6052564281583297, "mean_env_wait_ms": 1.4025173096005146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017308712005615234, "StateBufferConnector_ms": 0.009291648864746094, "ViewRequirementAgentConnector_ms": 0.3792724609375}, "num_episodes": 18, "episode_return_max": 1366.0, "episode_return_min": 440.0, "episode_return_mean": 816.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.608038305493075, "num_env_steps_trained_throughput_per_sec": 20.608038305493075, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 193859.931, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193859.884, "sample_time_ms": 2333.446, "learn_time_ms": 191506.992, "learn_throughput": 20.887, "synch_weights_time_ms": 11.687}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 46, "trial_id": "1841f_00000", "date": "2024-08-08_02-11-24", "timestamp": 1723097484, "time_this_iter_s": 194.10999298095703, "time_total_s": 10268.98121213913, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2422f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10268.98121213913, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.264000000000003, "ram_util_percent": 77.72363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6588120124972288, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.135404966585932, "policy_loss": -0.012224063012278833, "vf_loss": 8.146111026282508, "vf_explained_var": 0.0016768726804893745, "kl": 0.007590045771547239, "entropy": 0.677522066067329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 436635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 440.0, "episode_reward_mean": 823.98, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -19.0}, "policy_reward_max": {"policy_0": 330.0}, "policy_reward_mean": {"policy_0": 82.398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1110.0, 846.0, 928.0, 910.0, 651.0, 746.0, 571.0, 779.0, 720.0, 772.0, 1010.0, 440.0, 639.0, 935.0, 556.0, 731.0, 690.0, 920.0, 715.0, 928.0, 898.0, 877.0, 479.0, 622.0, 707.0, 1006.0, 910.0, 933.0, 900.0, 482.0, 865.0, 970.0, 950.0, 1010.0, 1054.0, 647.0, 881.0, 969.0, 714.0, 970.0, 823.0, 740.0, 1291.0, 787.0, 886.0, 660.0, 880.0, 740.0, 910.0, 515.0, 626.0, 850.0, 830.0, 801.0, 775.0, 758.0, 914.0, 791.0, 580.0, 977.0, 600.0, 893.0, 659.0, 685.0, 632.0, 826.0, 675.0, 862.0, 788.0, 790.0, 873.0, 1366.0, 1285.0, 885.0, 614.0, 590.0, 722.0, 775.0, 1030.0, 508.0, 573.0, 1030.0, 1081.0, 921.0, 906.0, 782.0, 840.0, 853.0, 920.0, 749.0, 960.0, 868.0, 902.0, 600.0, 972.0, 672.0, 1085.0, 1480.0, 738.0, 833.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 80.0, 140.0, 110.0, 40.0, 130.0, 150.0, 50.0, 100.0, 200.0, 100.0, 106.0, 80.0, 120.0, 128.0, 70.0, 20.0, 95.0, 70.0, 57.0, 130.0, 80.0, 130.0, 127.0, 100.0, 50.0, 41.0, 60.0, 130.0, 80.0, 95.0, 50.0, 140.0, 20.0, 140.0, 40.0, 80.0, 120.0, 45.0, 180.0, 110.0, 45.0, 90.0, 50.0, 80.0, 40.0, 50.0, 90.0, 70.0, 26.0, 80.0, 67.0, 110.0, 60.0, 49.0, 60.0, 140.0, 30.0, 60.0, 90.0, 30.0, 60.0, 50.0, 51.0, 50.0, 90.0, 130.0, 2.0, 110.0, -2.0, 73.0, 73.0, 30.0, 50.0, 100.0, 130.0, 90.0, 40.0, 130.0, 63.0, 50.0, 100.0, 30.0, 160.0, 60.0, 50.0, 44.0, 56.0, 90.0, 80.0, 190.0, 90.0, 90.0, 50.0, 30.0, 60.0, 50.0, 61.0, 61.0, 90.0, 170.0, 90.0, 110.0, 70.0, 50.0, 140.0, 50.0, 160.0, 90.0, 80.0, 10.0, 30.0, 40.0, 70.0, -1.0, 40.0, 70.0, 51.0, 60.0, 70.0, 80.0, 240.0, 60.0, 30.0, 90.0, 40.0, 30.0, 0.0, 50.0, 19.0, 50.0, 70.0, 40.0, 129.0, 130.0, 100.0, 75.0, 180.0, 103.0, 58.0, 30.0, 150.0, 20.0, 30.0, 100.0, 40.0, 60.0, 36.0, 40.0, 50.0, 190.0, 50.0, 80.0, 90.0, 50.0, 33.0, 50.0, -2.0, 50.0, 140.0, 70.0, 40.0, 50.0, 150.0, 50.0, 30.0, 100.0, 120.0, 50.0, 30.0, 100.0, 100.0, 20.0, 80.0, 120.0, 50.0, 110.0, 110.0, 110.0, 120.0, 90.0, 50.0, 45.0, 30.0, 90.0, 70.0, 60.0, 20.0, 170.0, 90.0, 110.0, 68.0, 110.0, 20.0, 50.0, 100.0, 110.0, 80.0, 140.0, 140.0, 100.0, 134.0, 55.0, 160.0, 64.0, 140.0, 29.0, 60.0, 16.0, 140.0, 90.0, 97.0, 30.0, 70.0, 180.0, 110.0, 40.0, 70.0, 80.0, 110.0, 50.0, 40.0, 60.0, 50.0, 20.0, 39.0, 70.0, 60.0, 0.0, 90.0, 20.0, 70.0, 60.0, 30.0, 30.0, 71.0, 51.0, 140.0, 20.0, 130.0, 120.0, 46.0, 20.0, 70.0, 50.0, 80.0, 68.0, 120.0, 66.0, 67.0, 120.0, 60.0, 200.0, 80.0, 40.0, 150.0, 90.0, 80.0, 50.0, 136.0, 60.0, 80.0, 140.0, 90.0, 60.0, 180.0, 50.0, 140.0, 50.0, 60.0, 70.0, 40.0, 40.0, 130.0, 130.0, 150.0, 80.0, 80.0, 96.0, 117.0, 150.0, 60.0, 40.0, 80.0, 60.0, 210.0, 80.0, 70.0, 50.0, 100.0, 60.0, 30.0, 47.0, 50.0, 80.0, 40.0, 90.0, 50.0, 5.0, 30.0, 70.0, 160.0, 57.0, 60.0, 106.0, 60.0, 12.0, 45.0, 125.0, 170.0, 140.0, 120.0, 100.0, 70.0, 60.0, 120.0, 100.0, 60.0, 110.0, 90.0, 40.0, 90.0, 120.0, 90.0, 90.0, 120.0, 90.0, 140.0, 90.0, 80.0, 160.0, 110.0, 100.0, 170.0, 20.0, 90.0, 120.0, 70.0, 80.0, 90.0, 80.0, 70.0, 80.0, 80.0, 135.0, 140.0, 80.0, 180.0, 80.0, 129.0, 90.0, 220.0, 35.0, 8.0, 40.0, 100.0, 39.0, 5.0, 40.0, 70.0, 40.0, 130.0, 170.0, 50.0, 80.0, 40.0, 90.0, 120.0, 100.0, 61.0, 60.0, 100.0, 70.0, 30.0, 100.0, 99.0, 210.0, 140.0, 90.0, 70.0, 50.0, 70.0, 40.0, 90.0, 82.0, 140.0, 70.0, 52.0, 40.0, 80.0, 90.0, 40.0, 140.0, 150.0, 80.0, 80.0, 20.0, 110.0, 130.0, 130.0, 55.0, 100.0, 29.0, 60.0, 180.0, 90.0, 24.0, 25.0, 160.0, 100.0, 50.0, 70.0, 100.0, 100.0, 50.0, 100.0, 120.0, 50.0, 50.0, 50.0, 90.0, 127.0, 180.0, 170.0, 180.0, 160.0, 44.0, 130.0, 120.0, 90.0, 80.0, 60.0, 70.0, 50.0, 30.0, 130.0, 100.0, 80.0, 77.0, 110.0, 90.0, 150.0, 90.0, 76.0, 110.0, 85.0, 100.0, 90.0, -8.0, 103.0, 100.0, 90.0, 30.0, 120.0, 40.0, 20.0, 90.0, 30.0, 90.0, 50.0, 50.0, 100.0, 50.0, 120.0, 80.0, 200.0, 60.0, 90.0, 60.0, 70.0, 30.0, 140.0, 30.0, 30.0, 30.0, 120.0, 130.0, 110.0, 80.0, 40.0, 80.0, 80.0, 90.0, 60.0, 90.0, 60.0, 220.0, 100.0, 80.0, 50.0, 50.0, 37.0, 30.0, 40.0, 68.0, 70.0, 40.0, 60.0, 70.0, 50.0, 230.0, 70.0, 30.0, 50.0, 30.0, 90.0, 19.0, 50.0, 37.0, 20.0, 70.0, 70.0, 140.0, 70.0, 80.0, 120.0, 80.0, 130.0, 50.0, 40.0, 20.0, 60.0, 110.0, 110.0, 30.0, 90.0, 100.0, 130.0, 70.0, 110.0, 90.0, 110.0, 43.0, 8.0, 50.0, 80.0, 80.0, 160.0, 110.0, 70.0, 40.0, 28.0, 88.0, 50.0, 100.0, 90.0, 130.0, 69.0, 60.0, 120.0, 180.0, 160.0, 90.0, 60.0, 10.0, 50.0, 20.0, 60.0, 16.0, 112.0, 80.0, 97.0, 100.0, 90.0, 170.0, 90.0, 100.0, 92.0, 98.0, -3.0, 60.0, 48.0, 90.0, 70.0, 57.0, 90.0, 70.0, 156.0, 100.0, 50.0, 90.0, 10.0, 60.0, 60.0, 40.0, 80.0, 80.0, 90.0, 30.0, 40.0, 140.0, 140.0, 150.0, 40.0, 30.0, 120.0, 139.0, 58.0, 60.0, 100.0, 60.0, 42.0, 140.0, 95.0, -19.0, 100.0, 20.0, 12.0, 100.0, 50.0, 80.0, 70.0, 40.0, 15.0, 140.0, 80.0, 150.0, 140.0, 120.0, 58.0, 30.0, 110.0, 30.0, 140.0, 70.0, 39.0, 50.0, 50.0, 80.0, 60.0, 40.0, 160.0, 100.0, 60.0, 60.0, 15.0, 90.0, 30.0, 60.0, 70.0, 100.0, 70.0, 9.0, 70.0, 40.0, 130.0, 100.0, -12.0, 55.0, 70.0, 70.0, 40.0, 110.0, 40.0, 118.0, 110.0, 60.0, 120.0, 70.0, 88.0, 80.0, 110.0, 90.0, 70.0, 23.0, 60.0, 169.0, 23.0, -10.0, 60.0, 6.0, 110.0, 70.0, 130.0, 90.0, 45.0, 91.0, 140.0, 60.0, 120.0, 140.0, 80.0, 50.0, 70.0, 100.0, 50.0, 150.0, 70.0, -2.0, 80.0, 10.0, 120.0, 240.0, 140.0, 80.0, 40.0, 50.0, 40.0, 40.0, 30.0, 90.0, 80.0, 100.0, 80.0, 76.0, 27.0, 100.0, 110.0, 70.0, 140.0, 124.0, 150.0, 330.0, 130.0, 70.0, 112.0, 100.0, 180.0, 30.0, 140.0, 110.0, 180.0, 80.0, 100.0, 230.0, 60.0, 90.0, 175.0, 120.0, 140.0, 73.0, 210.0, 70.0, 82.0, 10.0, 70.0, 80.0, 80.0, 140.0, 70.0, 2.0, 160.0, 50.0, 28.0, 90.0, 90.0, 37.0, 7.0, 60.0, 90.0, 45.0, 84.0, 50.0, 70.0, 50.0, 60.0, 100.0, 45.0, 80.0, 6.0, 80.0, 60.0, 90.0, 70.0, 75.0, 110.0, 47.0, 60.0, 70.0, 60.0, 50.0, 20.0, 80.0, 160.0, 90.0, 25.0, 120.0, 150.0, 20.0, 60.0, 110.0, 120.0, 80.0, 90.0, 70.0, 110.0, 110.0, 110.0, 80.0, 150.0, 70.0, 0.0, 50.0, 60.0, 50.0, 94.0, 90.0, 50.0, 4.0, 40.0, 36.0, 107.0, 30.0, 40.0, 60.0, 50.0, 80.0, 20.0, 20.0, 130.0, 110.0, 80.0, 120.0, 110.0, 80.0, 160.0, 70.0, 140.0, 90.0, 70.0, 100.0, 90.0, 150.0, 70.0, 197.0, 140.0, 64.0, 60.0, 140.0, 70.0, 140.0, 40.0, 46.0, 90.0, 90.0, 115.0, 70.0, 50.0, 130.0, 150.0, 148.0, 90.0, 90.0, 140.0, 90.0, 19.0, 60.0, 110.0, 69.0, 90.0, 60.0, 44.0, 60.0, 78.0, 91.0, 130.0, 120.0, 50.0, 70.0, 79.0, 150.0, 100.0, 40.0, 150.0, 60.0, 70.0, 60.0, 30.0, 90.0, 90.0, 100.0, 88.0, 70.0, 80.0, 200.0, 95.0, 60.0, 30.0, 100.0, 30.0, 109.0, 120.0, 110.0, 50.0, 140.0, 140.0, 35.0, 56.0, 90.0, 70.0, 40.0, 60.0, 90.0, 39.0, 100.0, 120.0, 70.0, 20.0, 130.0, 80.0, 120.0, 120.0, 150.0, 40.0, 60.0, 50.0, 130.0, 150.0, 80.0, 60.0, 140.0, 230.0, 53.0, 40.0, 40.0, 40.0, 65.0, 90.0, 70.0, 100.0, 90.0, 100.0, 78.0, 87.0, 50.0, 70.0, 90.0, 60.0, 137.0, 140.0, 40.0, 150.0, 20.0, 90.0, 30.0, 20.0, 70.0, 60.0, 20.0, 100.0, 50.0, 90.0, 140.0, 112.0, 130.0, 100.0, 100.0, 120.0, 60.0, 70.0, 60.0, 100.0, 140.0, 30.0, 20.0, 70.0, 47.0, 65.0, 70.0, 70.0, 48.0, 150.0, 110.0, 140.0, 90.0, 100.0, 60.0, 27.0, 160.0, 200.0, 170.0, 130.0, 120.0, 40.0, 230.0, 150.0, 150.0, 120.0, 260.0, 110.0, 70.0, 70.0, 90.0, 110.0, 89.0, 120.0, 50.0, 90.0, 39.0, 10.0, 140.0, 50.0, 90.0, 100.0, 10.0, 90.0, 67.0, 90.0, 90.0, 106.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.034111135748791, "mean_inference_ms": 2.0825566495599217, "mean_action_processing_ms": 0.6012295014713374, "mean_env_wait_ms": 1.3919156304992197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017238378524780273, "StateBufferConnector_ms": 0.009372234344482422, "ViewRequirementAgentConnector_ms": 0.38302016258239746}, "num_episodes": 22, "episode_return_max": 1480.0, "episode_return_min": 440.0, "episode_return_mean": 823.98}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.65996768727588, "num_env_steps_trained_throughput_per_sec": 20.65996768727588, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 1880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1880000, "timers": {"training_iteration_time_ms": 193908.135, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193908.09, "sample_time_ms": 2340.782, "learn_time_ms": 191547.853, "learn_throughput": 20.883, "synch_weights_time_ms": 11.731}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "done": false, "training_iteration": 47, "trial_id": "1841f_00000", "date": "2024-08-08_02-14-38", "timestamp": 1723097678, "time_this_iter_s": 193.62131309509277, "time_total_s": 10462.602525234222, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b339b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10462.602525234222, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.423722627737224, "ram_util_percent": 78.17992700729927}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.933929971930064, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.003508323094588, "policy_loss": -0.011910996985020706, "vf_loss": 8.0138747877968, "vf_explained_var": 0.0037259959565183985, "kl": 0.007722645789414787, "entropy": 0.7083455504542088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 446025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 420.0, "episode_reward_mean": 829.94, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 330.0}, "policy_reward_mean": {"policy_0": 82.994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [622.0, 707.0, 1006.0, 910.0, 933.0, 900.0, 482.0, 865.0, 970.0, 950.0, 1010.0, 1054.0, 647.0, 881.0, 969.0, 714.0, 970.0, 823.0, 740.0, 1291.0, 787.0, 886.0, 660.0, 880.0, 740.0, 910.0, 515.0, 626.0, 850.0, 830.0, 801.0, 775.0, 758.0, 914.0, 791.0, 580.0, 977.0, 600.0, 893.0, 659.0, 685.0, 632.0, 826.0, 675.0, 862.0, 788.0, 790.0, 873.0, 1366.0, 1285.0, 885.0, 614.0, 590.0, 722.0, 775.0, 1030.0, 508.0, 573.0, 1030.0, 1081.0, 921.0, 906.0, 782.0, 840.0, 853.0, 920.0, 749.0, 960.0, 868.0, 902.0, 600.0, 972.0, 672.0, 1085.0, 1480.0, 738.0, 833.0, 1182.0, 1115.0, 775.0, 785.0, 960.0, 918.0, 888.0, 893.0, 810.0, 753.0, 720.0, 1090.0, 643.0, 863.0, 651.0, 648.0, 740.0, 862.0, 420.0, 628.0, 1090.0, 507.0, 506.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 70.0, 60.0, 30.0, 30.0, 71.0, 51.0, 140.0, 20.0, 130.0, 120.0, 46.0, 20.0, 70.0, 50.0, 80.0, 68.0, 120.0, 66.0, 67.0, 120.0, 60.0, 200.0, 80.0, 40.0, 150.0, 90.0, 80.0, 50.0, 136.0, 60.0, 80.0, 140.0, 90.0, 60.0, 180.0, 50.0, 140.0, 50.0, 60.0, 70.0, 40.0, 40.0, 130.0, 130.0, 150.0, 80.0, 80.0, 96.0, 117.0, 150.0, 60.0, 40.0, 80.0, 60.0, 210.0, 80.0, 70.0, 50.0, 100.0, 60.0, 30.0, 47.0, 50.0, 80.0, 40.0, 90.0, 50.0, 5.0, 30.0, 70.0, 160.0, 57.0, 60.0, 106.0, 60.0, 12.0, 45.0, 125.0, 170.0, 140.0, 120.0, 100.0, 70.0, 60.0, 120.0, 100.0, 60.0, 110.0, 90.0, 40.0, 90.0, 120.0, 90.0, 90.0, 120.0, 90.0, 140.0, 90.0, 80.0, 160.0, 110.0, 100.0, 170.0, 20.0, 90.0, 120.0, 70.0, 80.0, 90.0, 80.0, 70.0, 80.0, 80.0, 135.0, 140.0, 80.0, 180.0, 80.0, 129.0, 90.0, 220.0, 35.0, 8.0, 40.0, 100.0, 39.0, 5.0, 40.0, 70.0, 40.0, 130.0, 170.0, 50.0, 80.0, 40.0, 90.0, 120.0, 100.0, 61.0, 60.0, 100.0, 70.0, 30.0, 100.0, 99.0, 210.0, 140.0, 90.0, 70.0, 50.0, 70.0, 40.0, 90.0, 82.0, 140.0, 70.0, 52.0, 40.0, 80.0, 90.0, 40.0, 140.0, 150.0, 80.0, 80.0, 20.0, 110.0, 130.0, 130.0, 55.0, 100.0, 29.0, 60.0, 180.0, 90.0, 24.0, 25.0, 160.0, 100.0, 50.0, 70.0, 100.0, 100.0, 50.0, 100.0, 120.0, 50.0, 50.0, 50.0, 90.0, 127.0, 180.0, 170.0, 180.0, 160.0, 44.0, 130.0, 120.0, 90.0, 80.0, 60.0, 70.0, 50.0, 30.0, 130.0, 100.0, 80.0, 77.0, 110.0, 90.0, 150.0, 90.0, 76.0, 110.0, 85.0, 100.0, 90.0, -8.0, 103.0, 100.0, 90.0, 30.0, 120.0, 40.0, 20.0, 90.0, 30.0, 90.0, 50.0, 50.0, 100.0, 50.0, 120.0, 80.0, 200.0, 60.0, 90.0, 60.0, 70.0, 30.0, 140.0, 30.0, 30.0, 30.0, 120.0, 130.0, 110.0, 80.0, 40.0, 80.0, 80.0, 90.0, 60.0, 90.0, 60.0, 220.0, 100.0, 80.0, 50.0, 50.0, 37.0, 30.0, 40.0, 68.0, 70.0, 40.0, 60.0, 70.0, 50.0, 230.0, 70.0, 30.0, 50.0, 30.0, 90.0, 19.0, 50.0, 37.0, 20.0, 70.0, 70.0, 140.0, 70.0, 80.0, 120.0, 80.0, 130.0, 50.0, 40.0, 20.0, 60.0, 110.0, 110.0, 30.0, 90.0, 100.0, 130.0, 70.0, 110.0, 90.0, 110.0, 43.0, 8.0, 50.0, 80.0, 80.0, 160.0, 110.0, 70.0, 40.0, 28.0, 88.0, 50.0, 100.0, 90.0, 130.0, 69.0, 60.0, 120.0, 180.0, 160.0, 90.0, 60.0, 10.0, 50.0, 20.0, 60.0, 16.0, 112.0, 80.0, 97.0, 100.0, 90.0, 170.0, 90.0, 100.0, 92.0, 98.0, -3.0, 60.0, 48.0, 90.0, 70.0, 57.0, 90.0, 70.0, 156.0, 100.0, 50.0, 90.0, 10.0, 60.0, 60.0, 40.0, 80.0, 80.0, 90.0, 30.0, 40.0, 140.0, 140.0, 150.0, 40.0, 30.0, 120.0, 139.0, 58.0, 60.0, 100.0, 60.0, 42.0, 140.0, 95.0, -19.0, 100.0, 20.0, 12.0, 100.0, 50.0, 80.0, 70.0, 40.0, 15.0, 140.0, 80.0, 150.0, 140.0, 120.0, 58.0, 30.0, 110.0, 30.0, 140.0, 70.0, 39.0, 50.0, 50.0, 80.0, 60.0, 40.0, 160.0, 100.0, 60.0, 60.0, 15.0, 90.0, 30.0, 60.0, 70.0, 100.0, 70.0, 9.0, 70.0, 40.0, 130.0, 100.0, -12.0, 55.0, 70.0, 70.0, 40.0, 110.0, 40.0, 118.0, 110.0, 60.0, 120.0, 70.0, 88.0, 80.0, 110.0, 90.0, 70.0, 23.0, 60.0, 169.0, 23.0, -10.0, 60.0, 6.0, 110.0, 70.0, 130.0, 90.0, 45.0, 91.0, 140.0, 60.0, 120.0, 140.0, 80.0, 50.0, 70.0, 100.0, 50.0, 150.0, 70.0, -2.0, 80.0, 10.0, 120.0, 240.0, 140.0, 80.0, 40.0, 50.0, 40.0, 40.0, 30.0, 90.0, 80.0, 100.0, 80.0, 76.0, 27.0, 100.0, 110.0, 70.0, 140.0, 124.0, 150.0, 330.0, 130.0, 70.0, 112.0, 100.0, 180.0, 30.0, 140.0, 110.0, 180.0, 80.0, 100.0, 230.0, 60.0, 90.0, 175.0, 120.0, 140.0, 73.0, 210.0, 70.0, 82.0, 10.0, 70.0, 80.0, 80.0, 140.0, 70.0, 2.0, 160.0, 50.0, 28.0, 90.0, 90.0, 37.0, 7.0, 60.0, 90.0, 45.0, 84.0, 50.0, 70.0, 50.0, 60.0, 100.0, 45.0, 80.0, 6.0, 80.0, 60.0, 90.0, 70.0, 75.0, 110.0, 47.0, 60.0, 70.0, 60.0, 50.0, 20.0, 80.0, 160.0, 90.0, 25.0, 120.0, 150.0, 20.0, 60.0, 110.0, 120.0, 80.0, 90.0, 70.0, 110.0, 110.0, 110.0, 80.0, 150.0, 70.0, 0.0, 50.0, 60.0, 50.0, 94.0, 90.0, 50.0, 4.0, 40.0, 36.0, 107.0, 30.0, 40.0, 60.0, 50.0, 80.0, 20.0, 20.0, 130.0, 110.0, 80.0, 120.0, 110.0, 80.0, 160.0, 70.0, 140.0, 90.0, 70.0, 100.0, 90.0, 150.0, 70.0, 197.0, 140.0, 64.0, 60.0, 140.0, 70.0, 140.0, 40.0, 46.0, 90.0, 90.0, 115.0, 70.0, 50.0, 130.0, 150.0, 148.0, 90.0, 90.0, 140.0, 90.0, 19.0, 60.0, 110.0, 69.0, 90.0, 60.0, 44.0, 60.0, 78.0, 91.0, 130.0, 120.0, 50.0, 70.0, 79.0, 150.0, 100.0, 40.0, 150.0, 60.0, 70.0, 60.0, 30.0, 90.0, 90.0, 100.0, 88.0, 70.0, 80.0, 200.0, 95.0, 60.0, 30.0, 100.0, 30.0, 109.0, 120.0, 110.0, 50.0, 140.0, 140.0, 35.0, 56.0, 90.0, 70.0, 40.0, 60.0, 90.0, 39.0, 100.0, 120.0, 70.0, 20.0, 130.0, 80.0, 120.0, 120.0, 150.0, 40.0, 60.0, 50.0, 130.0, 150.0, 80.0, 60.0, 140.0, 230.0, 53.0, 40.0, 40.0, 40.0, 65.0, 90.0, 70.0, 100.0, 90.0, 100.0, 78.0, 87.0, 50.0, 70.0, 90.0, 60.0, 137.0, 140.0, 40.0, 150.0, 20.0, 90.0, 30.0, 20.0, 70.0, 60.0, 20.0, 100.0, 50.0, 90.0, 140.0, 112.0, 130.0, 100.0, 100.0, 120.0, 60.0, 70.0, 60.0, 100.0, 140.0, 30.0, 20.0, 70.0, 47.0, 65.0, 70.0, 70.0, 48.0, 150.0, 110.0, 140.0, 90.0, 100.0, 60.0, 27.0, 160.0, 200.0, 170.0, 130.0, 120.0, 40.0, 230.0, 150.0, 150.0, 120.0, 260.0, 110.0, 70.0, 70.0, 90.0, 110.0, 89.0, 120.0, 50.0, 90.0, 39.0, 10.0, 140.0, 50.0, 90.0, 100.0, 10.0, 90.0, 67.0, 90.0, 90.0, 106.0, 90.0, 53.0, 120.0, 150.0, 190.0, 180.0, 110.0, 39.0, 130.0, 120.0, 150.0, 150.0, 110.0, 100.0, 190.0, 50.0, 80.0, 60.0, 145.0, 80.0, 120.0, 47.0, 70.0, 110.0, 110.0, 58.0, 70.0, 60.0, 80.0, 50.0, 90.0, 40.0, -5.0, 70.0, 110.0, 20.0, 170.0, 60.0, 70.0, 160.0, 70.0, 100.0, 60.0, 90.0, 190.0, 130.0, 40.0, 120.0, 90.0, 70.0, 80.0, 110.0, 60.0, 88.0, 60.0, 160.0, 100.0, 160.0, 60.0, 40.0, 80.0, 100.0, 38.0, 40.0, 190.0, 90.0, 100.0, 40.0, 70.0, 140.0, 120.0, 80.0, 30.0, 38.0, 150.0, 90.0, 167.0, 70.0, 8.0, 140.0, 120.0, 90.0, 50.0, 170.0, 110.0, 40.0, 10.0, 60.0, 120.0, 40.0, 190.0, 32.0, 70.0, -100.0, 110.0, 100.0, 80.0, 74.0, 107.0, 90.0, 100.0, 101.0, 100.0, 50.0, 30.0, 20.0, -11.0, 50.0, 70.0, 210.0, 140.0, 100.0, 70.0, 130.0, 150.0, 60.0, 90.0, 100.0, 130.0, 120.0, 20.0, 60.0, 102.0, 60.0, 80.0, 40.0, -9.0, 130.0, 130.0, 30.0, 60.0, 40.0, 90.0, 23.0, 190.0, 70.0, 120.0, 80.0, 120.0, 70.0, 110.0, 50.0, 50.0, 32.0, 60.0, 90.0, 39.0, 90.0, 60.0, 70.0, 50.0, 130.0, 60.0, 38.0, 70.0, 30.0, 70.0, 100.0, 40.0, 60.0, -3.0, 20.0, 70.0, 199.0, 47.0, 40.0, 140.0, 69.0, 90.0, 68.0, 90.0, 71.0, 57.0, 68.0, 89.0, 110.0, 50.0, 70.0, 146.0, 111.0, 30.0, 30.0, 13.0, 60.0, -28.0, 8.0, 90.0, 127.0, 80.0, 10.0, 80.0, 60.0, 51.0, 22.0, 130.0, 110.0, 28.0, 70.0, 70.0, 7.0, 140.0, 130.0, 100.0, 170.0, 130.0, 130.0, 130.0, 40.0, 70.0, 50.0, 90.0, 40.0, 50.0, 40.0, 17.0, 66.0, 50.0, 58.0, 16.0, 80.0, 71.0, 80.0, 10.0, 62.0, 70.0, 80.0, 70.0, 50.0, 13.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0206857366261484, "mean_inference_ms": 2.0648469754980114, "mean_action_processing_ms": 0.5975419687449086, "mean_env_wait_ms": 1.3836612267808222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017247438430786133, "StateBufferConnector_ms": 0.009714365005493164, "ViewRequirementAgentConnector_ms": 0.38924288749694824}, "num_episodes": 23, "episode_return_max": 1480.0, "episode_return_min": 420.0, "episode_return_mean": 829.94}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.70288832682751, "num_env_steps_trained_throughput_per_sec": 20.70288832682751, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 193853.382, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193853.339, "sample_time_ms": 2341.085, "learn_time_ms": 191492.819, "learn_throughput": 20.889, "synch_weights_time_ms": 11.85}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 48, "trial_id": "1841f_00000", "date": "2024-08-08_02-17-51", "timestamp": 1723097871, "time_this_iter_s": 193.2212038040161, "time_total_s": 10655.823729038239, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b339b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10655.823729038239, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.295604395604396, "ram_util_percent": 77.9912087912088}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5681782849236163, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.218751885055607, "policy_loss": -0.011831089147268393, "vf_loss": 8.229070635370045, "vf_explained_var": -0.0006112656844690585, "kl": 0.007561695893934588, "entropy": 0.6675394066130391, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 455415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 315.0, "episode_reward_mean": 822.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 330.0}, "policy_reward_mean": {"policy_0": 82.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [740.0, 1291.0, 787.0, 886.0, 660.0, 880.0, 740.0, 910.0, 515.0, 626.0, 850.0, 830.0, 801.0, 775.0, 758.0, 914.0, 791.0, 580.0, 977.0, 600.0, 893.0, 659.0, 685.0, 632.0, 826.0, 675.0, 862.0, 788.0, 790.0, 873.0, 1366.0, 1285.0, 885.0, 614.0, 590.0, 722.0, 775.0, 1030.0, 508.0, 573.0, 1030.0, 1081.0, 921.0, 906.0, 782.0, 840.0, 853.0, 920.0, 749.0, 960.0, 868.0, 902.0, 600.0, 972.0, 672.0, 1085.0, 1480.0, 738.0, 833.0, 1182.0, 1115.0, 775.0, 785.0, 960.0, 918.0, 888.0, 893.0, 810.0, 753.0, 720.0, 1090.0, 643.0, 863.0, 651.0, 648.0, 740.0, 862.0, 420.0, 628.0, 1090.0, 507.0, 506.0, 720.0, 315.0, 756.0, 842.0, 1119.0, 790.0, 690.0, 933.0, 760.0, 820.0, 821.0, 707.0, 613.0, 991.0, 936.0, 1206.0, 970.0, 700.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 70.0, 100.0, 100.0, 50.0, 100.0, 120.0, 50.0, 50.0, 50.0, 90.0, 127.0, 180.0, 170.0, 180.0, 160.0, 44.0, 130.0, 120.0, 90.0, 80.0, 60.0, 70.0, 50.0, 30.0, 130.0, 100.0, 80.0, 77.0, 110.0, 90.0, 150.0, 90.0, 76.0, 110.0, 85.0, 100.0, 90.0, -8.0, 103.0, 100.0, 90.0, 30.0, 120.0, 40.0, 20.0, 90.0, 30.0, 90.0, 50.0, 50.0, 100.0, 50.0, 120.0, 80.0, 200.0, 60.0, 90.0, 60.0, 70.0, 30.0, 140.0, 30.0, 30.0, 30.0, 120.0, 130.0, 110.0, 80.0, 40.0, 80.0, 80.0, 90.0, 60.0, 90.0, 60.0, 220.0, 100.0, 80.0, 50.0, 50.0, 37.0, 30.0, 40.0, 68.0, 70.0, 40.0, 60.0, 70.0, 50.0, 230.0, 70.0, 30.0, 50.0, 30.0, 90.0, 19.0, 50.0, 37.0, 20.0, 70.0, 70.0, 140.0, 70.0, 80.0, 120.0, 80.0, 130.0, 50.0, 40.0, 20.0, 60.0, 110.0, 110.0, 30.0, 90.0, 100.0, 130.0, 70.0, 110.0, 90.0, 110.0, 43.0, 8.0, 50.0, 80.0, 80.0, 160.0, 110.0, 70.0, 40.0, 28.0, 88.0, 50.0, 100.0, 90.0, 130.0, 69.0, 60.0, 120.0, 180.0, 160.0, 90.0, 60.0, 10.0, 50.0, 20.0, 60.0, 16.0, 112.0, 80.0, 97.0, 100.0, 90.0, 170.0, 90.0, 100.0, 92.0, 98.0, -3.0, 60.0, 48.0, 90.0, 70.0, 57.0, 90.0, 70.0, 156.0, 100.0, 50.0, 90.0, 10.0, 60.0, 60.0, 40.0, 80.0, 80.0, 90.0, 30.0, 40.0, 140.0, 140.0, 150.0, 40.0, 30.0, 120.0, 139.0, 58.0, 60.0, 100.0, 60.0, 42.0, 140.0, 95.0, -19.0, 100.0, 20.0, 12.0, 100.0, 50.0, 80.0, 70.0, 40.0, 15.0, 140.0, 80.0, 150.0, 140.0, 120.0, 58.0, 30.0, 110.0, 30.0, 140.0, 70.0, 39.0, 50.0, 50.0, 80.0, 60.0, 40.0, 160.0, 100.0, 60.0, 60.0, 15.0, 90.0, 30.0, 60.0, 70.0, 100.0, 70.0, 9.0, 70.0, 40.0, 130.0, 100.0, -12.0, 55.0, 70.0, 70.0, 40.0, 110.0, 40.0, 118.0, 110.0, 60.0, 120.0, 70.0, 88.0, 80.0, 110.0, 90.0, 70.0, 23.0, 60.0, 169.0, 23.0, -10.0, 60.0, 6.0, 110.0, 70.0, 130.0, 90.0, 45.0, 91.0, 140.0, 60.0, 120.0, 140.0, 80.0, 50.0, 70.0, 100.0, 50.0, 150.0, 70.0, -2.0, 80.0, 10.0, 120.0, 240.0, 140.0, 80.0, 40.0, 50.0, 40.0, 40.0, 30.0, 90.0, 80.0, 100.0, 80.0, 76.0, 27.0, 100.0, 110.0, 70.0, 140.0, 124.0, 150.0, 330.0, 130.0, 70.0, 112.0, 100.0, 180.0, 30.0, 140.0, 110.0, 180.0, 80.0, 100.0, 230.0, 60.0, 90.0, 175.0, 120.0, 140.0, 73.0, 210.0, 70.0, 82.0, 10.0, 70.0, 80.0, 80.0, 140.0, 70.0, 2.0, 160.0, 50.0, 28.0, 90.0, 90.0, 37.0, 7.0, 60.0, 90.0, 45.0, 84.0, 50.0, 70.0, 50.0, 60.0, 100.0, 45.0, 80.0, 6.0, 80.0, 60.0, 90.0, 70.0, 75.0, 110.0, 47.0, 60.0, 70.0, 60.0, 50.0, 20.0, 80.0, 160.0, 90.0, 25.0, 120.0, 150.0, 20.0, 60.0, 110.0, 120.0, 80.0, 90.0, 70.0, 110.0, 110.0, 110.0, 80.0, 150.0, 70.0, 0.0, 50.0, 60.0, 50.0, 94.0, 90.0, 50.0, 4.0, 40.0, 36.0, 107.0, 30.0, 40.0, 60.0, 50.0, 80.0, 20.0, 20.0, 130.0, 110.0, 80.0, 120.0, 110.0, 80.0, 160.0, 70.0, 140.0, 90.0, 70.0, 100.0, 90.0, 150.0, 70.0, 197.0, 140.0, 64.0, 60.0, 140.0, 70.0, 140.0, 40.0, 46.0, 90.0, 90.0, 115.0, 70.0, 50.0, 130.0, 150.0, 148.0, 90.0, 90.0, 140.0, 90.0, 19.0, 60.0, 110.0, 69.0, 90.0, 60.0, 44.0, 60.0, 78.0, 91.0, 130.0, 120.0, 50.0, 70.0, 79.0, 150.0, 100.0, 40.0, 150.0, 60.0, 70.0, 60.0, 30.0, 90.0, 90.0, 100.0, 88.0, 70.0, 80.0, 200.0, 95.0, 60.0, 30.0, 100.0, 30.0, 109.0, 120.0, 110.0, 50.0, 140.0, 140.0, 35.0, 56.0, 90.0, 70.0, 40.0, 60.0, 90.0, 39.0, 100.0, 120.0, 70.0, 20.0, 130.0, 80.0, 120.0, 120.0, 150.0, 40.0, 60.0, 50.0, 130.0, 150.0, 80.0, 60.0, 140.0, 230.0, 53.0, 40.0, 40.0, 40.0, 65.0, 90.0, 70.0, 100.0, 90.0, 100.0, 78.0, 87.0, 50.0, 70.0, 90.0, 60.0, 137.0, 140.0, 40.0, 150.0, 20.0, 90.0, 30.0, 20.0, 70.0, 60.0, 20.0, 100.0, 50.0, 90.0, 140.0, 112.0, 130.0, 100.0, 100.0, 120.0, 60.0, 70.0, 60.0, 100.0, 140.0, 30.0, 20.0, 70.0, 47.0, 65.0, 70.0, 70.0, 48.0, 150.0, 110.0, 140.0, 90.0, 100.0, 60.0, 27.0, 160.0, 200.0, 170.0, 130.0, 120.0, 40.0, 230.0, 150.0, 150.0, 120.0, 260.0, 110.0, 70.0, 70.0, 90.0, 110.0, 89.0, 120.0, 50.0, 90.0, 39.0, 10.0, 140.0, 50.0, 90.0, 100.0, 10.0, 90.0, 67.0, 90.0, 90.0, 106.0, 90.0, 53.0, 120.0, 150.0, 190.0, 180.0, 110.0, 39.0, 130.0, 120.0, 150.0, 150.0, 110.0, 100.0, 190.0, 50.0, 80.0, 60.0, 145.0, 80.0, 120.0, 47.0, 70.0, 110.0, 110.0, 58.0, 70.0, 60.0, 80.0, 50.0, 90.0, 40.0, -5.0, 70.0, 110.0, 20.0, 170.0, 60.0, 70.0, 160.0, 70.0, 100.0, 60.0, 90.0, 190.0, 130.0, 40.0, 120.0, 90.0, 70.0, 80.0, 110.0, 60.0, 88.0, 60.0, 160.0, 100.0, 160.0, 60.0, 40.0, 80.0, 100.0, 38.0, 40.0, 190.0, 90.0, 100.0, 40.0, 70.0, 140.0, 120.0, 80.0, 30.0, 38.0, 150.0, 90.0, 167.0, 70.0, 8.0, 140.0, 120.0, 90.0, 50.0, 170.0, 110.0, 40.0, 10.0, 60.0, 120.0, 40.0, 190.0, 32.0, 70.0, -100.0, 110.0, 100.0, 80.0, 74.0, 107.0, 90.0, 100.0, 101.0, 100.0, 50.0, 30.0, 20.0, -11.0, 50.0, 70.0, 210.0, 140.0, 100.0, 70.0, 130.0, 150.0, 60.0, 90.0, 100.0, 130.0, 120.0, 20.0, 60.0, 102.0, 60.0, 80.0, 40.0, -9.0, 130.0, 130.0, 30.0, 60.0, 40.0, 90.0, 23.0, 190.0, 70.0, 120.0, 80.0, 120.0, 70.0, 110.0, 50.0, 50.0, 32.0, 60.0, 90.0, 39.0, 90.0, 60.0, 70.0, 50.0, 130.0, 60.0, 38.0, 70.0, 30.0, 70.0, 100.0, 40.0, 60.0, -3.0, 20.0, 70.0, 199.0, 47.0, 40.0, 140.0, 69.0, 90.0, 68.0, 90.0, 71.0, 57.0, 68.0, 89.0, 110.0, 50.0, 70.0, 146.0, 111.0, 30.0, 30.0, 13.0, 60.0, -28.0, 8.0, 90.0, 127.0, 80.0, 10.0, 80.0, 60.0, 51.0, 22.0, 130.0, 110.0, 28.0, 70.0, 70.0, 7.0, 140.0, 130.0, 100.0, 170.0, 130.0, 130.0, 130.0, 40.0, 70.0, 50.0, 90.0, 40.0, 50.0, 40.0, 17.0, 66.0, 50.0, 58.0, 16.0, 80.0, 71.0, 80.0, 10.0, 62.0, 70.0, 80.0, 70.0, 50.0, 13.0, 0.0, 50.0, 70.0, 30.0, 50.0, 35.0, 60.0, 160.0, 85.0, 110.0, 70.0, 60.0, 33.0, 7.0, -5.0, 0.0, 20.0, 30.0, 90.0, 40.0, 40.0, 100.0, 25.0, 60.0, 90.0, 90.0, 120.0, 60.0, 30.0, 100.0, 81.0, 70.0, 120.0, 69.0, 190.0, 100.0, 100.0, 42.0, 91.0, 40.0, 20.0, 50.0, 250.0, 91.0, 100.0, 70.0, 110.0, 110.0, 78.0, 200.0, 60.0, 50.0, 110.0, 40.0, 140.0, 70.0, 80.0, 50.0, 60.0, 70.0, 120.0, 40.0, 30.0, 20.0, 30.0, 50.0, 120.0, 100.0, 70.0, 220.0, 10.0, 150.0, 160.0, 72.0, 60.0, 80.0, 90.0, 171.0, 60.0, 110.0, -20.0, 90.0, 90.0, 40.0, 50.0, 70.0, 150.0, 100.0, 70.0, 0.0, 100.0, 120.0, 100.0, 80.0, 60.0, 40.0, 90.0, 100.0, 140.0, 60.0, 30.0, 49.0, 60.0, 90.0, 89.0, 130.0, 80.0, 70.0, 60.0, 83.0, 110.0, 40.0, 40.0, 70.0, 160.0, 90.0, 19.0, 78.0, 100.0, 70.0, 40.0, 70.0, 60.0, 20.0, 40.0, 10.0, 120.0, 140.0, 10.0, 17.0, 126.0, 60.0, 70.0, 144.0, 110.0, 70.0, 50.0, 147.0, 50.0, 50.0, 240.0, 110.0, 130.0, 140.0, 104.0, 100.0, 90.0, 90.0, 22.0, 30.0, 120.0, 160.0, 90.0, 150.0, 100.0, 110.0, 100.0, 97.0, 89.0, 160.0, 150.0, 50.0, 60.0, 80.0, 200.0, 40.0, 100.0, 110.0, 100.0, 120.0, 110.0, 71.0, 80.0, 120.0, 23.0, 19.0, 20.0, 70.0, 37.0, 130.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.010253375270911, "mean_inference_ms": 2.0513206869178786, "mean_action_processing_ms": 0.5951896255720368, "mean_env_wait_ms": 1.3745461923923203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016939640045166016, "StateBufferConnector_ms": 0.009432315826416016, "ViewRequirementAgentConnector_ms": 0.3800981044769287}, "num_episodes": 18, "episode_return_max": 1480.0, "episode_return_min": 315.0, "episode_return_mean": 822.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.4832677963276, "num_env_steps_trained_throughput_per_sec": 20.4832677963276, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 1960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1960000, "timers": {"training_iteration_time_ms": 193992.892, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193992.848, "sample_time_ms": 2331.352, "learn_time_ms": 191642.026, "learn_throughput": 20.872, "synch_weights_time_ms": 11.915}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "done": false, "training_iteration": 49, "trial_id": "1841f_00000", "date": "2024-08-08_02-21-06", "timestamp": 1723098066, "time_this_iter_s": 195.2925989627838, "time_total_s": 10851.116328001022, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b291b550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10851.116328001022, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 29.94927536231884, "ram_util_percent": 79.07644927536231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.489272445560898, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.216390377365617, "policy_loss": -0.012684630336876189, "vf_loss": 8.227586861895803, "vf_explained_var": -0.0013497005763272254, "kl": 0.007440700847862163, "entropy": 0.6126626026040068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 464805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 315.0, "episode_reward_mean": 842.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 330.0}, "policy_reward_mean": {"policy_0": 84.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [977.0, 600.0, 893.0, 659.0, 685.0, 632.0, 826.0, 675.0, 862.0, 788.0, 790.0, 873.0, 1366.0, 1285.0, 885.0, 614.0, 590.0, 722.0, 775.0, 1030.0, 508.0, 573.0, 1030.0, 1081.0, 921.0, 906.0, 782.0, 840.0, 853.0, 920.0, 749.0, 960.0, 868.0, 902.0, 600.0, 972.0, 672.0, 1085.0, 1480.0, 738.0, 833.0, 1182.0, 1115.0, 775.0, 785.0, 960.0, 918.0, 888.0, 893.0, 810.0, 753.0, 720.0, 1090.0, 643.0, 863.0, 651.0, 648.0, 740.0, 862.0, 420.0, 628.0, 1090.0, 507.0, 506.0, 720.0, 315.0, 756.0, 842.0, 1119.0, 790.0, 690.0, 933.0, 760.0, 820.0, 821.0, 707.0, 613.0, 991.0, 936.0, 1206.0, 970.0, 700.0, 755.0, 1098.0, 964.0, 1030.0, 1116.0, 938.0, 900.0, 570.0, 904.0, 1100.0, 858.0, 956.0, 833.0, 705.0, 658.0, 965.0, 1094.0, 880.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 140.0, 150.0, 40.0, 30.0, 120.0, 139.0, 58.0, 60.0, 100.0, 60.0, 42.0, 140.0, 95.0, -19.0, 100.0, 20.0, 12.0, 100.0, 50.0, 80.0, 70.0, 40.0, 15.0, 140.0, 80.0, 150.0, 140.0, 120.0, 58.0, 30.0, 110.0, 30.0, 140.0, 70.0, 39.0, 50.0, 50.0, 80.0, 60.0, 40.0, 160.0, 100.0, 60.0, 60.0, 15.0, 90.0, 30.0, 60.0, 70.0, 100.0, 70.0, 9.0, 70.0, 40.0, 130.0, 100.0, -12.0, 55.0, 70.0, 70.0, 40.0, 110.0, 40.0, 118.0, 110.0, 60.0, 120.0, 70.0, 88.0, 80.0, 110.0, 90.0, 70.0, 23.0, 60.0, 169.0, 23.0, -10.0, 60.0, 6.0, 110.0, 70.0, 130.0, 90.0, 45.0, 91.0, 140.0, 60.0, 120.0, 140.0, 80.0, 50.0, 70.0, 100.0, 50.0, 150.0, 70.0, -2.0, 80.0, 10.0, 120.0, 240.0, 140.0, 80.0, 40.0, 50.0, 40.0, 40.0, 30.0, 90.0, 80.0, 100.0, 80.0, 76.0, 27.0, 100.0, 110.0, 70.0, 140.0, 124.0, 150.0, 330.0, 130.0, 70.0, 112.0, 100.0, 180.0, 30.0, 140.0, 110.0, 180.0, 80.0, 100.0, 230.0, 60.0, 90.0, 175.0, 120.0, 140.0, 73.0, 210.0, 70.0, 82.0, 10.0, 70.0, 80.0, 80.0, 140.0, 70.0, 2.0, 160.0, 50.0, 28.0, 90.0, 90.0, 37.0, 7.0, 60.0, 90.0, 45.0, 84.0, 50.0, 70.0, 50.0, 60.0, 100.0, 45.0, 80.0, 6.0, 80.0, 60.0, 90.0, 70.0, 75.0, 110.0, 47.0, 60.0, 70.0, 60.0, 50.0, 20.0, 80.0, 160.0, 90.0, 25.0, 120.0, 150.0, 20.0, 60.0, 110.0, 120.0, 80.0, 90.0, 70.0, 110.0, 110.0, 110.0, 80.0, 150.0, 70.0, 0.0, 50.0, 60.0, 50.0, 94.0, 90.0, 50.0, 4.0, 40.0, 36.0, 107.0, 30.0, 40.0, 60.0, 50.0, 80.0, 20.0, 20.0, 130.0, 110.0, 80.0, 120.0, 110.0, 80.0, 160.0, 70.0, 140.0, 90.0, 70.0, 100.0, 90.0, 150.0, 70.0, 197.0, 140.0, 64.0, 60.0, 140.0, 70.0, 140.0, 40.0, 46.0, 90.0, 90.0, 115.0, 70.0, 50.0, 130.0, 150.0, 148.0, 90.0, 90.0, 140.0, 90.0, 19.0, 60.0, 110.0, 69.0, 90.0, 60.0, 44.0, 60.0, 78.0, 91.0, 130.0, 120.0, 50.0, 70.0, 79.0, 150.0, 100.0, 40.0, 150.0, 60.0, 70.0, 60.0, 30.0, 90.0, 90.0, 100.0, 88.0, 70.0, 80.0, 200.0, 95.0, 60.0, 30.0, 100.0, 30.0, 109.0, 120.0, 110.0, 50.0, 140.0, 140.0, 35.0, 56.0, 90.0, 70.0, 40.0, 60.0, 90.0, 39.0, 100.0, 120.0, 70.0, 20.0, 130.0, 80.0, 120.0, 120.0, 150.0, 40.0, 60.0, 50.0, 130.0, 150.0, 80.0, 60.0, 140.0, 230.0, 53.0, 40.0, 40.0, 40.0, 65.0, 90.0, 70.0, 100.0, 90.0, 100.0, 78.0, 87.0, 50.0, 70.0, 90.0, 60.0, 137.0, 140.0, 40.0, 150.0, 20.0, 90.0, 30.0, 20.0, 70.0, 60.0, 20.0, 100.0, 50.0, 90.0, 140.0, 112.0, 130.0, 100.0, 100.0, 120.0, 60.0, 70.0, 60.0, 100.0, 140.0, 30.0, 20.0, 70.0, 47.0, 65.0, 70.0, 70.0, 48.0, 150.0, 110.0, 140.0, 90.0, 100.0, 60.0, 27.0, 160.0, 200.0, 170.0, 130.0, 120.0, 40.0, 230.0, 150.0, 150.0, 120.0, 260.0, 110.0, 70.0, 70.0, 90.0, 110.0, 89.0, 120.0, 50.0, 90.0, 39.0, 10.0, 140.0, 50.0, 90.0, 100.0, 10.0, 90.0, 67.0, 90.0, 90.0, 106.0, 90.0, 53.0, 120.0, 150.0, 190.0, 180.0, 110.0, 39.0, 130.0, 120.0, 150.0, 150.0, 110.0, 100.0, 190.0, 50.0, 80.0, 60.0, 145.0, 80.0, 120.0, 47.0, 70.0, 110.0, 110.0, 58.0, 70.0, 60.0, 80.0, 50.0, 90.0, 40.0, -5.0, 70.0, 110.0, 20.0, 170.0, 60.0, 70.0, 160.0, 70.0, 100.0, 60.0, 90.0, 190.0, 130.0, 40.0, 120.0, 90.0, 70.0, 80.0, 110.0, 60.0, 88.0, 60.0, 160.0, 100.0, 160.0, 60.0, 40.0, 80.0, 100.0, 38.0, 40.0, 190.0, 90.0, 100.0, 40.0, 70.0, 140.0, 120.0, 80.0, 30.0, 38.0, 150.0, 90.0, 167.0, 70.0, 8.0, 140.0, 120.0, 90.0, 50.0, 170.0, 110.0, 40.0, 10.0, 60.0, 120.0, 40.0, 190.0, 32.0, 70.0, -100.0, 110.0, 100.0, 80.0, 74.0, 107.0, 90.0, 100.0, 101.0, 100.0, 50.0, 30.0, 20.0, -11.0, 50.0, 70.0, 210.0, 140.0, 100.0, 70.0, 130.0, 150.0, 60.0, 90.0, 100.0, 130.0, 120.0, 20.0, 60.0, 102.0, 60.0, 80.0, 40.0, -9.0, 130.0, 130.0, 30.0, 60.0, 40.0, 90.0, 23.0, 190.0, 70.0, 120.0, 80.0, 120.0, 70.0, 110.0, 50.0, 50.0, 32.0, 60.0, 90.0, 39.0, 90.0, 60.0, 70.0, 50.0, 130.0, 60.0, 38.0, 70.0, 30.0, 70.0, 100.0, 40.0, 60.0, -3.0, 20.0, 70.0, 199.0, 47.0, 40.0, 140.0, 69.0, 90.0, 68.0, 90.0, 71.0, 57.0, 68.0, 89.0, 110.0, 50.0, 70.0, 146.0, 111.0, 30.0, 30.0, 13.0, 60.0, -28.0, 8.0, 90.0, 127.0, 80.0, 10.0, 80.0, 60.0, 51.0, 22.0, 130.0, 110.0, 28.0, 70.0, 70.0, 7.0, 140.0, 130.0, 100.0, 170.0, 130.0, 130.0, 130.0, 40.0, 70.0, 50.0, 90.0, 40.0, 50.0, 40.0, 17.0, 66.0, 50.0, 58.0, 16.0, 80.0, 71.0, 80.0, 10.0, 62.0, 70.0, 80.0, 70.0, 50.0, 13.0, 0.0, 50.0, 70.0, 30.0, 50.0, 35.0, 60.0, 160.0, 85.0, 110.0, 70.0, 60.0, 33.0, 7.0, -5.0, 0.0, 20.0, 30.0, 90.0, 40.0, 40.0, 100.0, 25.0, 60.0, 90.0, 90.0, 120.0, 60.0, 30.0, 100.0, 81.0, 70.0, 120.0, 69.0, 190.0, 100.0, 100.0, 42.0, 91.0, 40.0, 20.0, 50.0, 250.0, 91.0, 100.0, 70.0, 110.0, 110.0, 78.0, 200.0, 60.0, 50.0, 110.0, 40.0, 140.0, 70.0, 80.0, 50.0, 60.0, 70.0, 120.0, 40.0, 30.0, 20.0, 30.0, 50.0, 120.0, 100.0, 70.0, 220.0, 10.0, 150.0, 160.0, 72.0, 60.0, 80.0, 90.0, 171.0, 60.0, 110.0, -20.0, 90.0, 90.0, 40.0, 50.0, 70.0, 150.0, 100.0, 70.0, 0.0, 100.0, 120.0, 100.0, 80.0, 60.0, 40.0, 90.0, 100.0, 140.0, 60.0, 30.0, 49.0, 60.0, 90.0, 89.0, 130.0, 80.0, 70.0, 60.0, 83.0, 110.0, 40.0, 40.0, 70.0, 160.0, 90.0, 19.0, 78.0, 100.0, 70.0, 40.0, 70.0, 60.0, 20.0, 40.0, 10.0, 120.0, 140.0, 10.0, 17.0, 126.0, 60.0, 70.0, 144.0, 110.0, 70.0, 50.0, 147.0, 50.0, 50.0, 240.0, 110.0, 130.0, 140.0, 104.0, 100.0, 90.0, 90.0, 22.0, 30.0, 120.0, 160.0, 90.0, 150.0, 100.0, 110.0, 100.0, 97.0, 89.0, 160.0, 150.0, 50.0, 60.0, 80.0, 200.0, 40.0, 100.0, 110.0, 100.0, 120.0, 110.0, 71.0, 80.0, 120.0, 23.0, 19.0, 20.0, 70.0, 37.0, 130.0, 130.0, 160.0, 90.0, 100.0, 120.0, 16.0, 70.0, 70.0, 40.0, 40.0, 49.0, 120.0, 140.0, 89.0, 140.0, 50.0, 160.0, 59.0, 130.0, 80.0, 130.0, 90.0, 72.0, 132.0, 210.0, 20.0, 60.0, 70.0, 70.0, 160.0, 80.0, 190.0, 80.0, 50.0, 100.0, 70.0, 130.0, 130.0, 80.0, 150.0, 50.0, 130.0, 152.0, 156.0, 120.0, 46.0, 102.0, 140.0, 40.0, 130.0, 100.0, 80.0, 140.0, 59.0, 40.0, 50.0, 140.0, 119.0, 110.0, 80.0, 120.0, 150.0, 130.0, 20.0, 100.0, 110.0, 70.0, 130.0, 30.0, 100.0, 60.0, 60.0, 27.0, 120.0, 40.0, 58.0, 50.0, 69.0, 40.0, 70.0, 36.0, 70.0, 90.0, 200.0, 45.0, 70.0, 60.0, 49.0, 120.0, 120.0, 80.0, 120.0, 160.0, 80.0, 100.0, 130.0, 110.0, 160.0, 50.0, 90.0, 100.0, 50.0, 160.0, 40.0, 80.0, 120.0, 120.0, 35.0, 87.0, 66.0, 100.0, 136.0, 50.0, 100.0, 60.0, 70.0, 170.0, 100.0, 30.0, 180.0, 60.0, 110.0, 90.0, 80.0, 60.0, 26.0, 110.0, 60.0, 160.0, 47.0, 90.0, 60.0, 90.0, 93.0, 153.0, 60.0, 8.0, 17.0, 92.0, 80.0, 52.0, 40.0, 64.0, 30.0, 64.0, 50.0, 40.0, 100.0, 50.0, 180.0, 40.0, 130.0, 150.0, 135.0, 70.0, 70.0, 70.0, 120.0, 100.0, 110.0, 10.0, 190.0, 120.0, 80.0, 37.0, 120.0, 80.0, 67.0, 190.0, 120.0, 90.0, 100.0, 90.0, 130.0, 120.0, 50.0, 110.0, 40.0, 150.0, 80.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0000017793020133, "mean_inference_ms": 2.0394062488064226, "mean_action_processing_ms": 0.5935439610451467, "mean_env_wait_ms": 1.3669723224295336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012398719787597656, "StateBufferConnector_ms": 0.009625911712646484, "ViewRequirementAgentConnector_ms": 0.3864765167236328}, "num_episodes": 18, "episode_return_max": 1480.0, "episode_return_min": 315.0, "episode_return_mean": 842.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.64370836208741, "num_env_steps_trained_throughput_per_sec": 20.64370836208741, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 194019.894, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194019.847, "sample_time_ms": 2359.804, "learn_time_ms": 191640.391, "learn_throughput": 20.872, "synch_weights_time_ms": 12.031}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 50, "trial_id": "1841f_00000", "date": "2024-08-08_02-24-20", "timestamp": 1723098260, "time_this_iter_s": 193.77435302734375, "time_total_s": 11044.890681028366, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2450820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11044.890681028366, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 28.67043795620438, "ram_util_percent": 79.08029197080292}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.833990073680116, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.37799109066891, "policy_loss": -0.012221333506855324, "vf_loss": 8.388738733561784, "vf_explained_var": 0.0010198249476659285, "kl": 0.00736844599306139, "entropy": 0.6074728285955291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 474195.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 315.0, "episode_reward_mean": 861.38, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 260.0}, "policy_reward_mean": {"policy_0": 86.138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [775.0, 1030.0, 508.0, 573.0, 1030.0, 1081.0, 921.0, 906.0, 782.0, 840.0, 853.0, 920.0, 749.0, 960.0, 868.0, 902.0, 600.0, 972.0, 672.0, 1085.0, 1480.0, 738.0, 833.0, 1182.0, 1115.0, 775.0, 785.0, 960.0, 918.0, 888.0, 893.0, 810.0, 753.0, 720.0, 1090.0, 643.0, 863.0, 651.0, 648.0, 740.0, 862.0, 420.0, 628.0, 1090.0, 507.0, 506.0, 720.0, 315.0, 756.0, 842.0, 1119.0, 790.0, 690.0, 933.0, 760.0, 820.0, 821.0, 707.0, 613.0, 991.0, 936.0, 1206.0, 970.0, 700.0, 755.0, 1098.0, 964.0, 1030.0, 1116.0, 938.0, 900.0, 570.0, 904.0, 1100.0, 858.0, 956.0, 833.0, 705.0, 658.0, 965.0, 1094.0, 880.0, 880.0, 870.0, 1011.0, 1079.0, 1108.0, 1025.0, 627.0, 941.0, 1080.0, 807.0, 659.0, 1159.0, 1086.0, 951.0, 970.0, 693.0, 885.0, 769.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 20.0, 80.0, 160.0, 90.0, 25.0, 120.0, 150.0, 20.0, 60.0, 110.0, 120.0, 80.0, 90.0, 70.0, 110.0, 110.0, 110.0, 80.0, 150.0, 70.0, 0.0, 50.0, 60.0, 50.0, 94.0, 90.0, 50.0, 4.0, 40.0, 36.0, 107.0, 30.0, 40.0, 60.0, 50.0, 80.0, 20.0, 20.0, 130.0, 110.0, 80.0, 120.0, 110.0, 80.0, 160.0, 70.0, 140.0, 90.0, 70.0, 100.0, 90.0, 150.0, 70.0, 197.0, 140.0, 64.0, 60.0, 140.0, 70.0, 140.0, 40.0, 46.0, 90.0, 90.0, 115.0, 70.0, 50.0, 130.0, 150.0, 148.0, 90.0, 90.0, 140.0, 90.0, 19.0, 60.0, 110.0, 69.0, 90.0, 60.0, 44.0, 60.0, 78.0, 91.0, 130.0, 120.0, 50.0, 70.0, 79.0, 150.0, 100.0, 40.0, 150.0, 60.0, 70.0, 60.0, 30.0, 90.0, 90.0, 100.0, 88.0, 70.0, 80.0, 200.0, 95.0, 60.0, 30.0, 100.0, 30.0, 109.0, 120.0, 110.0, 50.0, 140.0, 140.0, 35.0, 56.0, 90.0, 70.0, 40.0, 60.0, 90.0, 39.0, 100.0, 120.0, 70.0, 20.0, 130.0, 80.0, 120.0, 120.0, 150.0, 40.0, 60.0, 50.0, 130.0, 150.0, 80.0, 60.0, 140.0, 230.0, 53.0, 40.0, 40.0, 40.0, 65.0, 90.0, 70.0, 100.0, 90.0, 100.0, 78.0, 87.0, 50.0, 70.0, 90.0, 60.0, 137.0, 140.0, 40.0, 150.0, 20.0, 90.0, 30.0, 20.0, 70.0, 60.0, 20.0, 100.0, 50.0, 90.0, 140.0, 112.0, 130.0, 100.0, 100.0, 120.0, 60.0, 70.0, 60.0, 100.0, 140.0, 30.0, 20.0, 70.0, 47.0, 65.0, 70.0, 70.0, 48.0, 150.0, 110.0, 140.0, 90.0, 100.0, 60.0, 27.0, 160.0, 200.0, 170.0, 130.0, 120.0, 40.0, 230.0, 150.0, 150.0, 120.0, 260.0, 110.0, 70.0, 70.0, 90.0, 110.0, 89.0, 120.0, 50.0, 90.0, 39.0, 10.0, 140.0, 50.0, 90.0, 100.0, 10.0, 90.0, 67.0, 90.0, 90.0, 106.0, 90.0, 53.0, 120.0, 150.0, 190.0, 180.0, 110.0, 39.0, 130.0, 120.0, 150.0, 150.0, 110.0, 100.0, 190.0, 50.0, 80.0, 60.0, 145.0, 80.0, 120.0, 47.0, 70.0, 110.0, 110.0, 58.0, 70.0, 60.0, 80.0, 50.0, 90.0, 40.0, -5.0, 70.0, 110.0, 20.0, 170.0, 60.0, 70.0, 160.0, 70.0, 100.0, 60.0, 90.0, 190.0, 130.0, 40.0, 120.0, 90.0, 70.0, 80.0, 110.0, 60.0, 88.0, 60.0, 160.0, 100.0, 160.0, 60.0, 40.0, 80.0, 100.0, 38.0, 40.0, 190.0, 90.0, 100.0, 40.0, 70.0, 140.0, 120.0, 80.0, 30.0, 38.0, 150.0, 90.0, 167.0, 70.0, 8.0, 140.0, 120.0, 90.0, 50.0, 170.0, 110.0, 40.0, 10.0, 60.0, 120.0, 40.0, 190.0, 32.0, 70.0, -100.0, 110.0, 100.0, 80.0, 74.0, 107.0, 90.0, 100.0, 101.0, 100.0, 50.0, 30.0, 20.0, -11.0, 50.0, 70.0, 210.0, 140.0, 100.0, 70.0, 130.0, 150.0, 60.0, 90.0, 100.0, 130.0, 120.0, 20.0, 60.0, 102.0, 60.0, 80.0, 40.0, -9.0, 130.0, 130.0, 30.0, 60.0, 40.0, 90.0, 23.0, 190.0, 70.0, 120.0, 80.0, 120.0, 70.0, 110.0, 50.0, 50.0, 32.0, 60.0, 90.0, 39.0, 90.0, 60.0, 70.0, 50.0, 130.0, 60.0, 38.0, 70.0, 30.0, 70.0, 100.0, 40.0, 60.0, -3.0, 20.0, 70.0, 199.0, 47.0, 40.0, 140.0, 69.0, 90.0, 68.0, 90.0, 71.0, 57.0, 68.0, 89.0, 110.0, 50.0, 70.0, 146.0, 111.0, 30.0, 30.0, 13.0, 60.0, -28.0, 8.0, 90.0, 127.0, 80.0, 10.0, 80.0, 60.0, 51.0, 22.0, 130.0, 110.0, 28.0, 70.0, 70.0, 7.0, 140.0, 130.0, 100.0, 170.0, 130.0, 130.0, 130.0, 40.0, 70.0, 50.0, 90.0, 40.0, 50.0, 40.0, 17.0, 66.0, 50.0, 58.0, 16.0, 80.0, 71.0, 80.0, 10.0, 62.0, 70.0, 80.0, 70.0, 50.0, 13.0, 0.0, 50.0, 70.0, 30.0, 50.0, 35.0, 60.0, 160.0, 85.0, 110.0, 70.0, 60.0, 33.0, 7.0, -5.0, 0.0, 20.0, 30.0, 90.0, 40.0, 40.0, 100.0, 25.0, 60.0, 90.0, 90.0, 120.0, 60.0, 30.0, 100.0, 81.0, 70.0, 120.0, 69.0, 190.0, 100.0, 100.0, 42.0, 91.0, 40.0, 20.0, 50.0, 250.0, 91.0, 100.0, 70.0, 110.0, 110.0, 78.0, 200.0, 60.0, 50.0, 110.0, 40.0, 140.0, 70.0, 80.0, 50.0, 60.0, 70.0, 120.0, 40.0, 30.0, 20.0, 30.0, 50.0, 120.0, 100.0, 70.0, 220.0, 10.0, 150.0, 160.0, 72.0, 60.0, 80.0, 90.0, 171.0, 60.0, 110.0, -20.0, 90.0, 90.0, 40.0, 50.0, 70.0, 150.0, 100.0, 70.0, 0.0, 100.0, 120.0, 100.0, 80.0, 60.0, 40.0, 90.0, 100.0, 140.0, 60.0, 30.0, 49.0, 60.0, 90.0, 89.0, 130.0, 80.0, 70.0, 60.0, 83.0, 110.0, 40.0, 40.0, 70.0, 160.0, 90.0, 19.0, 78.0, 100.0, 70.0, 40.0, 70.0, 60.0, 20.0, 40.0, 10.0, 120.0, 140.0, 10.0, 17.0, 126.0, 60.0, 70.0, 144.0, 110.0, 70.0, 50.0, 147.0, 50.0, 50.0, 240.0, 110.0, 130.0, 140.0, 104.0, 100.0, 90.0, 90.0, 22.0, 30.0, 120.0, 160.0, 90.0, 150.0, 100.0, 110.0, 100.0, 97.0, 89.0, 160.0, 150.0, 50.0, 60.0, 80.0, 200.0, 40.0, 100.0, 110.0, 100.0, 120.0, 110.0, 71.0, 80.0, 120.0, 23.0, 19.0, 20.0, 70.0, 37.0, 130.0, 130.0, 160.0, 90.0, 100.0, 120.0, 16.0, 70.0, 70.0, 40.0, 40.0, 49.0, 120.0, 140.0, 89.0, 140.0, 50.0, 160.0, 59.0, 130.0, 80.0, 130.0, 90.0, 72.0, 132.0, 210.0, 20.0, 60.0, 70.0, 70.0, 160.0, 80.0, 190.0, 80.0, 50.0, 100.0, 70.0, 130.0, 130.0, 80.0, 150.0, 50.0, 130.0, 152.0, 156.0, 120.0, 46.0, 102.0, 140.0, 40.0, 130.0, 100.0, 80.0, 140.0, 59.0, 40.0, 50.0, 140.0, 119.0, 110.0, 80.0, 120.0, 150.0, 130.0, 20.0, 100.0, 110.0, 70.0, 130.0, 30.0, 100.0, 60.0, 60.0, 27.0, 120.0, 40.0, 58.0, 50.0, 69.0, 40.0, 70.0, 36.0, 70.0, 90.0, 200.0, 45.0, 70.0, 60.0, 49.0, 120.0, 120.0, 80.0, 120.0, 160.0, 80.0, 100.0, 130.0, 110.0, 160.0, 50.0, 90.0, 100.0, 50.0, 160.0, 40.0, 80.0, 120.0, 120.0, 35.0, 87.0, 66.0, 100.0, 136.0, 50.0, 100.0, 60.0, 70.0, 170.0, 100.0, 30.0, 180.0, 60.0, 110.0, 90.0, 80.0, 60.0, 26.0, 110.0, 60.0, 160.0, 47.0, 90.0, 60.0, 90.0, 93.0, 153.0, 60.0, 8.0, 17.0, 92.0, 80.0, 52.0, 40.0, 64.0, 30.0, 64.0, 50.0, 40.0, 100.0, 50.0, 180.0, 40.0, 130.0, 150.0, 135.0, 70.0, 70.0, 70.0, 120.0, 100.0, 110.0, 10.0, 190.0, 120.0, 80.0, 37.0, 120.0, 80.0, 67.0, 190.0, 120.0, 90.0, 100.0, 90.0, 130.0, 120.0, 50.0, 110.0, 40.0, 150.0, 80.0, 10.0, 120.0, 70.0, 130.0, 100.0, 70.0, 50.0, 50.0, 140.0, 100.0, 50.0, 100.0, 100.0, 60.0, 60.0, 80.0, 110.0, 80.0, 140.0, 120.0, 20.0, 60.0, 90.0, 42.0, 139.0, 245.0, 160.0, 50.0, 25.0, 110.0, 90.0, 120.0, 50.0, 80.0, 140.0, 65.0, 140.0, 140.0, 160.0, 80.0, 104.0, 110.0, 130.0, 60.0, 99.0, 50.0, 210.0, 79.0, 120.0, 140.0, 110.0, 110.0, 140.0, 119.0, 20.0, 80.0, 70.0, 200.0, 120.0, 120.0, 46.0, 17.0, 90.0, 130.0, 28.0, 60.0, 160.0, -10.0, 90.0, 50.0, 12.0, 27.0, 100.0, 120.0, 130.0, 110.0, 100.0, 74.0, 110.0, 40.0, 130.0, 140.0, 230.0, 70.0, 150.0, 100.0, 100.0, 50.0, 90.0, 60.0, 90.0, 32.0, 110.0, 120.0, 22.0, 90.0, 120.0, 68.0, 100.0, 75.0, 70.0, 79.0, 35.0, 29.0, 20.0, 140.0, 57.0, 120.0, 89.0, 20.0, 70.0, 60.0, 70.0, 110.0, 150.0, 250.0, 160.0, 50.0, 49.0, 120.0, 140.0, 200.0, 150.0, 109.0, 22.0, 50.0, 25.0, 160.0, 70.0, 140.0, 160.0, 90.0, 123.0, -24.0, 120.0, 110.0, 83.0, 79.0, 120.0, 160.0, 90.0, 54.0, 30.0, 130.0, 39.0, 180.0, 67.0, 90.0, 210.0, 50.0, 120.0, 10.0, 110.0, 16.0, 130.0, 90.0, 57.0, 60.0, 90.0, 20.0, 110.0, 110.0, 25.0, 100.0, 60.0, 100.0, 80.0, 100.0, 80.0, 140.0, 90.0, 18.0, 50.0, 130.0, 61.0, 50.0, 90.0, 100.0, 100.0, 80.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.989849468588448, "mean_inference_ms": 2.027858885532485, "mean_action_processing_ms": 0.5919046457007301, "mean_env_wait_ms": 1.3596917639106803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01242828369140625, "StateBufferConnector_ms": 0.009613752365112305, "ViewRequirementAgentConnector_ms": 0.395125150680542}, "num_episodes": 18, "episode_return_max": 1480.0, "episode_return_min": 315.0, "episode_return_mean": 861.38}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.65312278483738, "num_env_steps_trained_throughput_per_sec": 20.65312278483738, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 194022.719, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194022.673, "sample_time_ms": 2377.25, "learn_time_ms": 191625.45, "learn_throughput": 20.874, "synch_weights_time_ms": 12.193}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 51, "trial_id": "1841f_00000", "date": "2024-08-08_02-27-34", "timestamp": 1723098454, "time_this_iter_s": 193.6828637123108, "time_total_s": 11238.573544740677, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24235e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11238.573544740677, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 28.52773722627737, "ram_util_percent": 78.66788321167881}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5758732546378758, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.072765059161364, "policy_loss": -0.01195078604744055, "vf_loss": 8.083304541103375, "vf_explained_var": -0.0008818441813492293, "kl": 0.00705651562487241, "entropy": 0.6194472125575692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 483585.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 1210.0, "episode_reward_min": 135.0, "episode_reward_mean": 853.58, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 85.358}, "custom_metrics": {}, "hist_stats": {"episode_reward": [833.0, 1182.0, 1115.0, 775.0, 785.0, 960.0, 918.0, 888.0, 893.0, 810.0, 753.0, 720.0, 1090.0, 643.0, 863.0, 651.0, 648.0, 740.0, 862.0, 420.0, 628.0, 1090.0, 507.0, 506.0, 720.0, 315.0, 756.0, 842.0, 1119.0, 790.0, 690.0, 933.0, 760.0, 820.0, 821.0, 707.0, 613.0, 991.0, 936.0, 1206.0, 970.0, 700.0, 755.0, 1098.0, 964.0, 1030.0, 1116.0, 938.0, 900.0, 570.0, 904.0, 1100.0, 858.0, 956.0, 833.0, 705.0, 658.0, 965.0, 1094.0, 880.0, 880.0, 870.0, 1011.0, 1079.0, 1108.0, 1025.0, 627.0, 941.0, 1080.0, 807.0, 659.0, 1159.0, 1086.0, 951.0, 970.0, 693.0, 885.0, 769.0, 1004.0, 1160.0, 668.0, 1110.0, 667.0, 761.0, 960.0, 1004.0, 910.0, 1071.0, 971.0, 893.0, 831.0, 813.0, 135.0, 692.0, 653.0, 1210.0, 770.0, 659.0, 834.0, 689.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 50.0, 90.0, 100.0, 10.0, 90.0, 67.0, 90.0, 90.0, 106.0, 90.0, 53.0, 120.0, 150.0, 190.0, 180.0, 110.0, 39.0, 130.0, 120.0, 150.0, 150.0, 110.0, 100.0, 190.0, 50.0, 80.0, 60.0, 145.0, 80.0, 120.0, 47.0, 70.0, 110.0, 110.0, 58.0, 70.0, 60.0, 80.0, 50.0, 90.0, 40.0, -5.0, 70.0, 110.0, 20.0, 170.0, 60.0, 70.0, 160.0, 70.0, 100.0, 60.0, 90.0, 190.0, 130.0, 40.0, 120.0, 90.0, 70.0, 80.0, 110.0, 60.0, 88.0, 60.0, 160.0, 100.0, 160.0, 60.0, 40.0, 80.0, 100.0, 38.0, 40.0, 190.0, 90.0, 100.0, 40.0, 70.0, 140.0, 120.0, 80.0, 30.0, 38.0, 150.0, 90.0, 167.0, 70.0, 8.0, 140.0, 120.0, 90.0, 50.0, 170.0, 110.0, 40.0, 10.0, 60.0, 120.0, 40.0, 190.0, 32.0, 70.0, -100.0, 110.0, 100.0, 80.0, 74.0, 107.0, 90.0, 100.0, 101.0, 100.0, 50.0, 30.0, 20.0, -11.0, 50.0, 70.0, 210.0, 140.0, 100.0, 70.0, 130.0, 150.0, 60.0, 90.0, 100.0, 130.0, 120.0, 20.0, 60.0, 102.0, 60.0, 80.0, 40.0, -9.0, 130.0, 130.0, 30.0, 60.0, 40.0, 90.0, 23.0, 190.0, 70.0, 120.0, 80.0, 120.0, 70.0, 110.0, 50.0, 50.0, 32.0, 60.0, 90.0, 39.0, 90.0, 60.0, 70.0, 50.0, 130.0, 60.0, 38.0, 70.0, 30.0, 70.0, 100.0, 40.0, 60.0, -3.0, 20.0, 70.0, 199.0, 47.0, 40.0, 140.0, 69.0, 90.0, 68.0, 90.0, 71.0, 57.0, 68.0, 89.0, 110.0, 50.0, 70.0, 146.0, 111.0, 30.0, 30.0, 13.0, 60.0, -28.0, 8.0, 90.0, 127.0, 80.0, 10.0, 80.0, 60.0, 51.0, 22.0, 130.0, 110.0, 28.0, 70.0, 70.0, 7.0, 140.0, 130.0, 100.0, 170.0, 130.0, 130.0, 130.0, 40.0, 70.0, 50.0, 90.0, 40.0, 50.0, 40.0, 17.0, 66.0, 50.0, 58.0, 16.0, 80.0, 71.0, 80.0, 10.0, 62.0, 70.0, 80.0, 70.0, 50.0, 13.0, 0.0, 50.0, 70.0, 30.0, 50.0, 35.0, 60.0, 160.0, 85.0, 110.0, 70.0, 60.0, 33.0, 7.0, -5.0, 0.0, 20.0, 30.0, 90.0, 40.0, 40.0, 100.0, 25.0, 60.0, 90.0, 90.0, 120.0, 60.0, 30.0, 100.0, 81.0, 70.0, 120.0, 69.0, 190.0, 100.0, 100.0, 42.0, 91.0, 40.0, 20.0, 50.0, 250.0, 91.0, 100.0, 70.0, 110.0, 110.0, 78.0, 200.0, 60.0, 50.0, 110.0, 40.0, 140.0, 70.0, 80.0, 50.0, 60.0, 70.0, 120.0, 40.0, 30.0, 20.0, 30.0, 50.0, 120.0, 100.0, 70.0, 220.0, 10.0, 150.0, 160.0, 72.0, 60.0, 80.0, 90.0, 171.0, 60.0, 110.0, -20.0, 90.0, 90.0, 40.0, 50.0, 70.0, 150.0, 100.0, 70.0, 0.0, 100.0, 120.0, 100.0, 80.0, 60.0, 40.0, 90.0, 100.0, 140.0, 60.0, 30.0, 49.0, 60.0, 90.0, 89.0, 130.0, 80.0, 70.0, 60.0, 83.0, 110.0, 40.0, 40.0, 70.0, 160.0, 90.0, 19.0, 78.0, 100.0, 70.0, 40.0, 70.0, 60.0, 20.0, 40.0, 10.0, 120.0, 140.0, 10.0, 17.0, 126.0, 60.0, 70.0, 144.0, 110.0, 70.0, 50.0, 147.0, 50.0, 50.0, 240.0, 110.0, 130.0, 140.0, 104.0, 100.0, 90.0, 90.0, 22.0, 30.0, 120.0, 160.0, 90.0, 150.0, 100.0, 110.0, 100.0, 97.0, 89.0, 160.0, 150.0, 50.0, 60.0, 80.0, 200.0, 40.0, 100.0, 110.0, 100.0, 120.0, 110.0, 71.0, 80.0, 120.0, 23.0, 19.0, 20.0, 70.0, 37.0, 130.0, 130.0, 160.0, 90.0, 100.0, 120.0, 16.0, 70.0, 70.0, 40.0, 40.0, 49.0, 120.0, 140.0, 89.0, 140.0, 50.0, 160.0, 59.0, 130.0, 80.0, 130.0, 90.0, 72.0, 132.0, 210.0, 20.0, 60.0, 70.0, 70.0, 160.0, 80.0, 190.0, 80.0, 50.0, 100.0, 70.0, 130.0, 130.0, 80.0, 150.0, 50.0, 130.0, 152.0, 156.0, 120.0, 46.0, 102.0, 140.0, 40.0, 130.0, 100.0, 80.0, 140.0, 59.0, 40.0, 50.0, 140.0, 119.0, 110.0, 80.0, 120.0, 150.0, 130.0, 20.0, 100.0, 110.0, 70.0, 130.0, 30.0, 100.0, 60.0, 60.0, 27.0, 120.0, 40.0, 58.0, 50.0, 69.0, 40.0, 70.0, 36.0, 70.0, 90.0, 200.0, 45.0, 70.0, 60.0, 49.0, 120.0, 120.0, 80.0, 120.0, 160.0, 80.0, 100.0, 130.0, 110.0, 160.0, 50.0, 90.0, 100.0, 50.0, 160.0, 40.0, 80.0, 120.0, 120.0, 35.0, 87.0, 66.0, 100.0, 136.0, 50.0, 100.0, 60.0, 70.0, 170.0, 100.0, 30.0, 180.0, 60.0, 110.0, 90.0, 80.0, 60.0, 26.0, 110.0, 60.0, 160.0, 47.0, 90.0, 60.0, 90.0, 93.0, 153.0, 60.0, 8.0, 17.0, 92.0, 80.0, 52.0, 40.0, 64.0, 30.0, 64.0, 50.0, 40.0, 100.0, 50.0, 180.0, 40.0, 130.0, 150.0, 135.0, 70.0, 70.0, 70.0, 120.0, 100.0, 110.0, 10.0, 190.0, 120.0, 80.0, 37.0, 120.0, 80.0, 67.0, 190.0, 120.0, 90.0, 100.0, 90.0, 130.0, 120.0, 50.0, 110.0, 40.0, 150.0, 80.0, 10.0, 120.0, 70.0, 130.0, 100.0, 70.0, 50.0, 50.0, 140.0, 100.0, 50.0, 100.0, 100.0, 60.0, 60.0, 80.0, 110.0, 80.0, 140.0, 120.0, 20.0, 60.0, 90.0, 42.0, 139.0, 245.0, 160.0, 50.0, 25.0, 110.0, 90.0, 120.0, 50.0, 80.0, 140.0, 65.0, 140.0, 140.0, 160.0, 80.0, 104.0, 110.0, 130.0, 60.0, 99.0, 50.0, 210.0, 79.0, 120.0, 140.0, 110.0, 110.0, 140.0, 119.0, 20.0, 80.0, 70.0, 200.0, 120.0, 120.0, 46.0, 17.0, 90.0, 130.0, 28.0, 60.0, 160.0, -10.0, 90.0, 50.0, 12.0, 27.0, 100.0, 120.0, 130.0, 110.0, 100.0, 74.0, 110.0, 40.0, 130.0, 140.0, 230.0, 70.0, 150.0, 100.0, 100.0, 50.0, 90.0, 60.0, 90.0, 32.0, 110.0, 120.0, 22.0, 90.0, 120.0, 68.0, 100.0, 75.0, 70.0, 79.0, 35.0, 29.0, 20.0, 140.0, 57.0, 120.0, 89.0, 20.0, 70.0, 60.0, 70.0, 110.0, 150.0, 250.0, 160.0, 50.0, 49.0, 120.0, 140.0, 200.0, 150.0, 109.0, 22.0, 50.0, 25.0, 160.0, 70.0, 140.0, 160.0, 90.0, 123.0, -24.0, 120.0, 110.0, 83.0, 79.0, 120.0, 160.0, 90.0, 54.0, 30.0, 130.0, 39.0, 180.0, 67.0, 90.0, 210.0, 50.0, 120.0, 10.0, 110.0, 16.0, 130.0, 90.0, 57.0, 60.0, 90.0, 20.0, 110.0, 110.0, 25.0, 100.0, 60.0, 100.0, 80.0, 100.0, 80.0, 140.0, 90.0, 18.0, 50.0, 130.0, 61.0, 50.0, 90.0, 100.0, 100.0, 80.0, 90.0, 130.0, 47.0, 120.0, 68.0, 100.0, 110.0, 90.0, 159.0, 100.0, 80.0, 100.0, 110.0, 80.0, 110.0, 140.0, 140.0, 210.0, 70.0, 110.0, 90.0, 44.0, 90.0, 40.0, 64.0, 120.0, 50.0, 50.0, 110.0, 30.0, 70.0, 150.0, 70.0, 140.0, 90.0, 210.0, 40.0, 110.0, 50.0, 180.0, 70.0, 130.0, 85.0, 1.0, 15.0, 150.0, 49.0, -8.0, 150.0, 39.0, 56.0, 70.0, 50.0, 49.0, 43.0, 163.0, 70.0, 90.0, 16.0, 70.0, 140.0, 110.0, 110.0, 140.0, 70.0, 100.0, 70.0, 80.0, 90.0, 100.0, 90.0, 20.0, 22.0, 150.0, 30.0, 180.0, 160.0, 22.0, 160.0, 200.0, 60.0, 50.0, 70.0, 150.0, 110.0, 120.0, 90.0, 40.0, 120.0, 70.0, 90.0, 164.0, 70.0, 127.0, 180.0, 100.0, 90.0, 90.0, 70.0, 110.0, 70.0, 90.0, 15.0, 100.0, 70.0, 210.0, 36.0, 100.0, 50.0, 180.0, 120.0, 13.0, 130.0, 60.0, 60.0, 210.0, 70.0, 130.0, 60.0, 30.0, 130.0, 50.0, 180.0, 40.0, 116.0, 100.0, 15.0, 120.0, 120.0, 0.0, 90.0, 85.0, 31.0, 110.0, 60.0, 100.0, 80.0, 20.0, 197.0, 40.0, 90.0, 40.0, 10.0, 30.0, 30.0, 20.0, 2.0, -19.0, -58.0, 50.0, 30.0, 120.0, 130.0, 43.0, -24.0, 90.0, 90.0, 30.0, 63.0, 60.0, 90.0, 110.0, 22.0, 110.0, 12.0, 60.0, 59.0, 32.0, 40.0, 88.0, 120.0, 140.0, 280.0, 100.0, 110.0, 100.0, 130.0, 40.0, 70.0, 90.0, 150.0, 110.0, 30.0, 170.0, 34.0, 60.0, 70.0, 100.0, 90.0, 66.0, 40.0, 59.0, 150.0, 30.0, 20.0, 10.0, 110.0, 60.0, 70.0, 80.0, 70.0, 90.0, 130.0, -2.0, 70.0, 26.0, 130.0, 50.0, 70.0, 150.0, 120.0, 100.0, 74.0, 50.0, 40.0, 40.0, 20.0, 220.0, 45.0, 60.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9779455384118867, "mean_inference_ms": 2.014806477396299, "mean_action_processing_ms": 0.5904679362050516, "mean_env_wait_ms": 1.3513466174754531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012579202651977539, "StateBufferConnector_ms": 0.010940074920654297, "ViewRequirementAgentConnector_ms": 0.39227795600891113}, "num_episodes": 22, "episode_return_max": 1210.0, "episode_return_min": 135.0, "episode_return_mean": 853.58}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.606890120589213, "num_env_steps_trained_throughput_per_sec": 20.606890120589213, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 194089.823, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194089.777, "sample_time_ms": 2383.892, "learn_time_ms": 191686.086, "learn_throughput": 20.867, "synch_weights_time_ms": 12.027}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 52, "trial_id": "1841f_00000", "date": "2024-08-08_02-30-48", "timestamp": 1723098648, "time_this_iter_s": 194.12005591392517, "time_total_s": 11432.693600654602, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2423ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11432.693600654602, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 29.115636363636362, "ram_util_percent": 78.96763636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.603084594347733, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.465502274099885, "policy_loss": -0.012039893425438708, "vf_loss": 8.476019854083482, "vf_explained_var": 0.0016006313573818998, "kl": 0.007611594479016603, "entropy": 0.582516428177603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 492975.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "env_runners": {"episode_reward_max": 1291.0, "episode_reward_min": 135.0, "episode_reward_mean": 874.76, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -58.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 87.476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [506.0, 720.0, 315.0, 756.0, 842.0, 1119.0, 790.0, 690.0, 933.0, 760.0, 820.0, 821.0, 707.0, 613.0, 991.0, 936.0, 1206.0, 970.0, 700.0, 755.0, 1098.0, 964.0, 1030.0, 1116.0, 938.0, 900.0, 570.0, 904.0, 1100.0, 858.0, 956.0, 833.0, 705.0, 658.0, 965.0, 1094.0, 880.0, 880.0, 870.0, 1011.0, 1079.0, 1108.0, 1025.0, 627.0, 941.0, 1080.0, 807.0, 659.0, 1159.0, 1086.0, 951.0, 970.0, 693.0, 885.0, 769.0, 1004.0, 1160.0, 668.0, 1110.0, 667.0, 761.0, 960.0, 1004.0, 910.0, 1071.0, 971.0, 893.0, 831.0, 813.0, 135.0, 692.0, 653.0, 1210.0, 770.0, 659.0, 834.0, 689.0, 920.0, 993.0, 679.0, 912.0, 960.0, 915.0, 730.0, 764.0, 849.0, 1033.0, 1270.0, 1291.0, 1078.0, 634.0, 940.0, 941.0, 841.0, 668.0, 800.0, 784.0, 1130.0, 960.0, 800.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [71.0, 80.0, 10.0, 62.0, 70.0, 80.0, 70.0, 50.0, 13.0, 0.0, 50.0, 70.0, 30.0, 50.0, 35.0, 60.0, 160.0, 85.0, 110.0, 70.0, 60.0, 33.0, 7.0, -5.0, 0.0, 20.0, 30.0, 90.0, 40.0, 40.0, 100.0, 25.0, 60.0, 90.0, 90.0, 120.0, 60.0, 30.0, 100.0, 81.0, 70.0, 120.0, 69.0, 190.0, 100.0, 100.0, 42.0, 91.0, 40.0, 20.0, 50.0, 250.0, 91.0, 100.0, 70.0, 110.0, 110.0, 78.0, 200.0, 60.0, 50.0, 110.0, 40.0, 140.0, 70.0, 80.0, 50.0, 60.0, 70.0, 120.0, 40.0, 30.0, 20.0, 30.0, 50.0, 120.0, 100.0, 70.0, 220.0, 10.0, 150.0, 160.0, 72.0, 60.0, 80.0, 90.0, 171.0, 60.0, 110.0, -20.0, 90.0, 90.0, 40.0, 50.0, 70.0, 150.0, 100.0, 70.0, 0.0, 100.0, 120.0, 100.0, 80.0, 60.0, 40.0, 90.0, 100.0, 140.0, 60.0, 30.0, 49.0, 60.0, 90.0, 89.0, 130.0, 80.0, 70.0, 60.0, 83.0, 110.0, 40.0, 40.0, 70.0, 160.0, 90.0, 19.0, 78.0, 100.0, 70.0, 40.0, 70.0, 60.0, 20.0, 40.0, 10.0, 120.0, 140.0, 10.0, 17.0, 126.0, 60.0, 70.0, 144.0, 110.0, 70.0, 50.0, 147.0, 50.0, 50.0, 240.0, 110.0, 130.0, 140.0, 104.0, 100.0, 90.0, 90.0, 22.0, 30.0, 120.0, 160.0, 90.0, 150.0, 100.0, 110.0, 100.0, 97.0, 89.0, 160.0, 150.0, 50.0, 60.0, 80.0, 200.0, 40.0, 100.0, 110.0, 100.0, 120.0, 110.0, 71.0, 80.0, 120.0, 23.0, 19.0, 20.0, 70.0, 37.0, 130.0, 130.0, 160.0, 90.0, 100.0, 120.0, 16.0, 70.0, 70.0, 40.0, 40.0, 49.0, 120.0, 140.0, 89.0, 140.0, 50.0, 160.0, 59.0, 130.0, 80.0, 130.0, 90.0, 72.0, 132.0, 210.0, 20.0, 60.0, 70.0, 70.0, 160.0, 80.0, 190.0, 80.0, 50.0, 100.0, 70.0, 130.0, 130.0, 80.0, 150.0, 50.0, 130.0, 152.0, 156.0, 120.0, 46.0, 102.0, 140.0, 40.0, 130.0, 100.0, 80.0, 140.0, 59.0, 40.0, 50.0, 140.0, 119.0, 110.0, 80.0, 120.0, 150.0, 130.0, 20.0, 100.0, 110.0, 70.0, 130.0, 30.0, 100.0, 60.0, 60.0, 27.0, 120.0, 40.0, 58.0, 50.0, 69.0, 40.0, 70.0, 36.0, 70.0, 90.0, 200.0, 45.0, 70.0, 60.0, 49.0, 120.0, 120.0, 80.0, 120.0, 160.0, 80.0, 100.0, 130.0, 110.0, 160.0, 50.0, 90.0, 100.0, 50.0, 160.0, 40.0, 80.0, 120.0, 120.0, 35.0, 87.0, 66.0, 100.0, 136.0, 50.0, 100.0, 60.0, 70.0, 170.0, 100.0, 30.0, 180.0, 60.0, 110.0, 90.0, 80.0, 60.0, 26.0, 110.0, 60.0, 160.0, 47.0, 90.0, 60.0, 90.0, 93.0, 153.0, 60.0, 8.0, 17.0, 92.0, 80.0, 52.0, 40.0, 64.0, 30.0, 64.0, 50.0, 40.0, 100.0, 50.0, 180.0, 40.0, 130.0, 150.0, 135.0, 70.0, 70.0, 70.0, 120.0, 100.0, 110.0, 10.0, 190.0, 120.0, 80.0, 37.0, 120.0, 80.0, 67.0, 190.0, 120.0, 90.0, 100.0, 90.0, 130.0, 120.0, 50.0, 110.0, 40.0, 150.0, 80.0, 10.0, 120.0, 70.0, 130.0, 100.0, 70.0, 50.0, 50.0, 140.0, 100.0, 50.0, 100.0, 100.0, 60.0, 60.0, 80.0, 110.0, 80.0, 140.0, 120.0, 20.0, 60.0, 90.0, 42.0, 139.0, 245.0, 160.0, 50.0, 25.0, 110.0, 90.0, 120.0, 50.0, 80.0, 140.0, 65.0, 140.0, 140.0, 160.0, 80.0, 104.0, 110.0, 130.0, 60.0, 99.0, 50.0, 210.0, 79.0, 120.0, 140.0, 110.0, 110.0, 140.0, 119.0, 20.0, 80.0, 70.0, 200.0, 120.0, 120.0, 46.0, 17.0, 90.0, 130.0, 28.0, 60.0, 160.0, -10.0, 90.0, 50.0, 12.0, 27.0, 100.0, 120.0, 130.0, 110.0, 100.0, 74.0, 110.0, 40.0, 130.0, 140.0, 230.0, 70.0, 150.0, 100.0, 100.0, 50.0, 90.0, 60.0, 90.0, 32.0, 110.0, 120.0, 22.0, 90.0, 120.0, 68.0, 100.0, 75.0, 70.0, 79.0, 35.0, 29.0, 20.0, 140.0, 57.0, 120.0, 89.0, 20.0, 70.0, 60.0, 70.0, 110.0, 150.0, 250.0, 160.0, 50.0, 49.0, 120.0, 140.0, 200.0, 150.0, 109.0, 22.0, 50.0, 25.0, 160.0, 70.0, 140.0, 160.0, 90.0, 123.0, -24.0, 120.0, 110.0, 83.0, 79.0, 120.0, 160.0, 90.0, 54.0, 30.0, 130.0, 39.0, 180.0, 67.0, 90.0, 210.0, 50.0, 120.0, 10.0, 110.0, 16.0, 130.0, 90.0, 57.0, 60.0, 90.0, 20.0, 110.0, 110.0, 25.0, 100.0, 60.0, 100.0, 80.0, 100.0, 80.0, 140.0, 90.0, 18.0, 50.0, 130.0, 61.0, 50.0, 90.0, 100.0, 100.0, 80.0, 90.0, 130.0, 47.0, 120.0, 68.0, 100.0, 110.0, 90.0, 159.0, 100.0, 80.0, 100.0, 110.0, 80.0, 110.0, 140.0, 140.0, 210.0, 70.0, 110.0, 90.0, 44.0, 90.0, 40.0, 64.0, 120.0, 50.0, 50.0, 110.0, 30.0, 70.0, 150.0, 70.0, 140.0, 90.0, 210.0, 40.0, 110.0, 50.0, 180.0, 70.0, 130.0, 85.0, 1.0, 15.0, 150.0, 49.0, -8.0, 150.0, 39.0, 56.0, 70.0, 50.0, 49.0, 43.0, 163.0, 70.0, 90.0, 16.0, 70.0, 140.0, 110.0, 110.0, 140.0, 70.0, 100.0, 70.0, 80.0, 90.0, 100.0, 90.0, 20.0, 22.0, 150.0, 30.0, 180.0, 160.0, 22.0, 160.0, 200.0, 60.0, 50.0, 70.0, 150.0, 110.0, 120.0, 90.0, 40.0, 120.0, 70.0, 90.0, 164.0, 70.0, 127.0, 180.0, 100.0, 90.0, 90.0, 70.0, 110.0, 70.0, 90.0, 15.0, 100.0, 70.0, 210.0, 36.0, 100.0, 50.0, 180.0, 120.0, 13.0, 130.0, 60.0, 60.0, 210.0, 70.0, 130.0, 60.0, 30.0, 130.0, 50.0, 180.0, 40.0, 116.0, 100.0, 15.0, 120.0, 120.0, 0.0, 90.0, 85.0, 31.0, 110.0, 60.0, 100.0, 80.0, 20.0, 197.0, 40.0, 90.0, 40.0, 10.0, 30.0, 30.0, 20.0, 2.0, -19.0, -58.0, 50.0, 30.0, 120.0, 130.0, 43.0, -24.0, 90.0, 90.0, 30.0, 63.0, 60.0, 90.0, 110.0, 22.0, 110.0, 12.0, 60.0, 59.0, 32.0, 40.0, 88.0, 120.0, 140.0, 280.0, 100.0, 110.0, 100.0, 130.0, 40.0, 70.0, 90.0, 150.0, 110.0, 30.0, 170.0, 34.0, 60.0, 70.0, 100.0, 90.0, 66.0, 40.0, 59.0, 150.0, 30.0, 20.0, 10.0, 110.0, 60.0, 70.0, 80.0, 70.0, 90.0, 130.0, -2.0, 70.0, 26.0, 130.0, 50.0, 70.0, 150.0, 120.0, 100.0, 74.0, 50.0, 40.0, 40.0, 20.0, 220.0, 45.0, 60.0, 40.0, 30.0, 100.0, 130.0, 80.0, 90.0, 60.0, 150.0, 110.0, 120.0, 50.0, 30.0, 106.0, 66.0, 140.0, 110.0, 4.0, 170.0, 77.0, 110.0, 180.0, 80.0, 160.0, 10.0, 10.0, 15.0, 130.0, 110.0, 70.0, 34.0, 60.0, 163.0, 20.0, 141.0, 96.0, 28.0, 90.0, 64.0, 81.0, 89.0, 140.0, 180.0, 90.0, 100.0, 110.0, 90.0, 90.0, 90.0, 50.0, 110.0, 50.0, 40.0, 130.0, 170.0, 65.0, 70.0, 80.0, 80.0, 90.0, 50.0, 140.0, 130.0, 80.0, 46.0, 110.0, 95.0, 110.0, 40.0, 59.0, 50.0, 10.0, 80.0, 108.0, 6.0, 50.0, 100.0, 80.0, 180.0, 20.0, 90.0, 50.0, 31.0, 100.0, 110.0, 90.0, 46.0, 112.0, 30.0, 80.0, 160.0, 90.0, 117.0, 120.0, 80.0, 140.0, 140.0, 80.0, 66.0, 70.0, 100.0, 120.0, 130.0, 130.0, 80.0, 160.0, 140.0, 160.0, 70.0, 180.0, 70.0, 150.0, 200.0, 120.0, 124.0, 100.0, 129.0, 220.0, 80.0, 130.0, 109.0, 79.0, 260.0, 30.0, 110.0, 115.0, 23.0, 150.0, 80.0, 110.0, 60.0, 140.0, 140.0, 30.0, 37.0, 5.0, 36.0, 40.0, 50.0, 140.0, 110.0, 46.0, 120.0, 50.0, 70.0, 90.0, 110.0, 100.0, 80.0, 60.0, 110.0, 150.0, 42.0, 109.0, 40.0, 120.0, 100.0, 90.0, 80.0, 60.0, 110.0, 190.0, 90.0, 98.0, 94.0, 110.0, 50.0, 140.0, 70.0, 100.0, 70.0, 19.0, 100.0, 109.0, 57.0, 16.0, 47.0, 90.0, 130.0, 39.0, 40.0, 40.0, 20.0, 140.0, 90.0, 110.0, 60.0, 78.0, 170.0, 60.0, 41.0, 31.0, 80.0, 230.0, 70.0, -44.0, 58.0, 100.0, 80.0, 140.0, 50.0, 20.0, 130.0, 140.0, 210.0, 140.0, 110.0, 50.0, 90.0, 50.0, 120.0, 90.0, 130.0, 60.0, 130.0, 50.0, 70.0, 39.0, 110.0, 71.0, 180.0, 120.0, 60.0, 65.0, 77.0, 42.0, 16.0, 230.0, 90.0, 100.0, 100.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9669528957489166, "mean_inference_ms": 2.0014974372242564, "mean_action_processing_ms": 0.5882101059918748, "mean_env_wait_ms": 1.342809186130362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012559652328491211, "StateBufferConnector_ms": 0.010782480239868164, "ViewRequirementAgentConnector_ms": 0.3927896022796631}, "num_episodes": 23, "episode_return_max": 1291.0, "episode_return_min": 135.0, "episode_return_mean": 874.76}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.620817681086272, "num_env_steps_trained_throughput_per_sec": 20.620817681086272, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 2120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2120000, "timers": {"training_iteration_time_ms": 194084.741, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194084.695, "sample_time_ms": 2394.477, "learn_time_ms": 191670.396, "learn_throughput": 20.869, "synch_weights_time_ms": 11.989}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "done": false, "training_iteration": 53, "trial_id": "1841f_00000", "date": "2024-08-08_02-34-02", "timestamp": 1723098842, "time_this_iter_s": 193.9895510673523, "time_total_s": 11626.683151721954, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2423e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11626.683151721954, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 22.544160583941608, "ram_util_percent": 78.17226277372264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.553499822393139, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.511521485057502, "policy_loss": -0.012513476796299458, "vf_loss": 8.522461406212138, "vf_explained_var": -0.0011754046359889931, "kl": 0.00786775412645523, "entropy": 0.5701443872227074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 502365.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 1291.0, "episode_reward_min": 135.0, "episode_reward_mean": 895.88, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -58.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 89.588}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0, 755.0, 1098.0, 964.0, 1030.0, 1116.0, 938.0, 900.0, 570.0, 904.0, 1100.0, 858.0, 956.0, 833.0, 705.0, 658.0, 965.0, 1094.0, 880.0, 880.0, 870.0, 1011.0, 1079.0, 1108.0, 1025.0, 627.0, 941.0, 1080.0, 807.0, 659.0, 1159.0, 1086.0, 951.0, 970.0, 693.0, 885.0, 769.0, 1004.0, 1160.0, 668.0, 1110.0, 667.0, 761.0, 960.0, 1004.0, 910.0, 1071.0, 971.0, 893.0, 831.0, 813.0, 135.0, 692.0, 653.0, 1210.0, 770.0, 659.0, 834.0, 689.0, 920.0, 993.0, 679.0, 912.0, 960.0, 915.0, 730.0, 764.0, 849.0, 1033.0, 1270.0, 1291.0, 1078.0, 634.0, 940.0, 941.0, 841.0, 668.0, 800.0, 784.0, 1130.0, 960.0, 800.0, 748.0, 1075.0, 654.0, 640.0, 1228.0, 898.0, 989.0, 1118.0, 722.0, 1105.0, 1070.0, 976.0, 835.0, 665.0, 938.0, 1006.0, 730.0, 1210.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [71.0, 80.0, 120.0, 23.0, 19.0, 20.0, 70.0, 37.0, 130.0, 130.0, 160.0, 90.0, 100.0, 120.0, 16.0, 70.0, 70.0, 40.0, 40.0, 49.0, 120.0, 140.0, 89.0, 140.0, 50.0, 160.0, 59.0, 130.0, 80.0, 130.0, 90.0, 72.0, 132.0, 210.0, 20.0, 60.0, 70.0, 70.0, 160.0, 80.0, 190.0, 80.0, 50.0, 100.0, 70.0, 130.0, 130.0, 80.0, 150.0, 50.0, 130.0, 152.0, 156.0, 120.0, 46.0, 102.0, 140.0, 40.0, 130.0, 100.0, 80.0, 140.0, 59.0, 40.0, 50.0, 140.0, 119.0, 110.0, 80.0, 120.0, 150.0, 130.0, 20.0, 100.0, 110.0, 70.0, 130.0, 30.0, 100.0, 60.0, 60.0, 27.0, 120.0, 40.0, 58.0, 50.0, 69.0, 40.0, 70.0, 36.0, 70.0, 90.0, 200.0, 45.0, 70.0, 60.0, 49.0, 120.0, 120.0, 80.0, 120.0, 160.0, 80.0, 100.0, 130.0, 110.0, 160.0, 50.0, 90.0, 100.0, 50.0, 160.0, 40.0, 80.0, 120.0, 120.0, 35.0, 87.0, 66.0, 100.0, 136.0, 50.0, 100.0, 60.0, 70.0, 170.0, 100.0, 30.0, 180.0, 60.0, 110.0, 90.0, 80.0, 60.0, 26.0, 110.0, 60.0, 160.0, 47.0, 90.0, 60.0, 90.0, 93.0, 153.0, 60.0, 8.0, 17.0, 92.0, 80.0, 52.0, 40.0, 64.0, 30.0, 64.0, 50.0, 40.0, 100.0, 50.0, 180.0, 40.0, 130.0, 150.0, 135.0, 70.0, 70.0, 70.0, 120.0, 100.0, 110.0, 10.0, 190.0, 120.0, 80.0, 37.0, 120.0, 80.0, 67.0, 190.0, 120.0, 90.0, 100.0, 90.0, 130.0, 120.0, 50.0, 110.0, 40.0, 150.0, 80.0, 10.0, 120.0, 70.0, 130.0, 100.0, 70.0, 50.0, 50.0, 140.0, 100.0, 50.0, 100.0, 100.0, 60.0, 60.0, 80.0, 110.0, 80.0, 140.0, 120.0, 20.0, 60.0, 90.0, 42.0, 139.0, 245.0, 160.0, 50.0, 25.0, 110.0, 90.0, 120.0, 50.0, 80.0, 140.0, 65.0, 140.0, 140.0, 160.0, 80.0, 104.0, 110.0, 130.0, 60.0, 99.0, 50.0, 210.0, 79.0, 120.0, 140.0, 110.0, 110.0, 140.0, 119.0, 20.0, 80.0, 70.0, 200.0, 120.0, 120.0, 46.0, 17.0, 90.0, 130.0, 28.0, 60.0, 160.0, -10.0, 90.0, 50.0, 12.0, 27.0, 100.0, 120.0, 130.0, 110.0, 100.0, 74.0, 110.0, 40.0, 130.0, 140.0, 230.0, 70.0, 150.0, 100.0, 100.0, 50.0, 90.0, 60.0, 90.0, 32.0, 110.0, 120.0, 22.0, 90.0, 120.0, 68.0, 100.0, 75.0, 70.0, 79.0, 35.0, 29.0, 20.0, 140.0, 57.0, 120.0, 89.0, 20.0, 70.0, 60.0, 70.0, 110.0, 150.0, 250.0, 160.0, 50.0, 49.0, 120.0, 140.0, 200.0, 150.0, 109.0, 22.0, 50.0, 25.0, 160.0, 70.0, 140.0, 160.0, 90.0, 123.0, -24.0, 120.0, 110.0, 83.0, 79.0, 120.0, 160.0, 90.0, 54.0, 30.0, 130.0, 39.0, 180.0, 67.0, 90.0, 210.0, 50.0, 120.0, 10.0, 110.0, 16.0, 130.0, 90.0, 57.0, 60.0, 90.0, 20.0, 110.0, 110.0, 25.0, 100.0, 60.0, 100.0, 80.0, 100.0, 80.0, 140.0, 90.0, 18.0, 50.0, 130.0, 61.0, 50.0, 90.0, 100.0, 100.0, 80.0, 90.0, 130.0, 47.0, 120.0, 68.0, 100.0, 110.0, 90.0, 159.0, 100.0, 80.0, 100.0, 110.0, 80.0, 110.0, 140.0, 140.0, 210.0, 70.0, 110.0, 90.0, 44.0, 90.0, 40.0, 64.0, 120.0, 50.0, 50.0, 110.0, 30.0, 70.0, 150.0, 70.0, 140.0, 90.0, 210.0, 40.0, 110.0, 50.0, 180.0, 70.0, 130.0, 85.0, 1.0, 15.0, 150.0, 49.0, -8.0, 150.0, 39.0, 56.0, 70.0, 50.0, 49.0, 43.0, 163.0, 70.0, 90.0, 16.0, 70.0, 140.0, 110.0, 110.0, 140.0, 70.0, 100.0, 70.0, 80.0, 90.0, 100.0, 90.0, 20.0, 22.0, 150.0, 30.0, 180.0, 160.0, 22.0, 160.0, 200.0, 60.0, 50.0, 70.0, 150.0, 110.0, 120.0, 90.0, 40.0, 120.0, 70.0, 90.0, 164.0, 70.0, 127.0, 180.0, 100.0, 90.0, 90.0, 70.0, 110.0, 70.0, 90.0, 15.0, 100.0, 70.0, 210.0, 36.0, 100.0, 50.0, 180.0, 120.0, 13.0, 130.0, 60.0, 60.0, 210.0, 70.0, 130.0, 60.0, 30.0, 130.0, 50.0, 180.0, 40.0, 116.0, 100.0, 15.0, 120.0, 120.0, 0.0, 90.0, 85.0, 31.0, 110.0, 60.0, 100.0, 80.0, 20.0, 197.0, 40.0, 90.0, 40.0, 10.0, 30.0, 30.0, 20.0, 2.0, -19.0, -58.0, 50.0, 30.0, 120.0, 130.0, 43.0, -24.0, 90.0, 90.0, 30.0, 63.0, 60.0, 90.0, 110.0, 22.0, 110.0, 12.0, 60.0, 59.0, 32.0, 40.0, 88.0, 120.0, 140.0, 280.0, 100.0, 110.0, 100.0, 130.0, 40.0, 70.0, 90.0, 150.0, 110.0, 30.0, 170.0, 34.0, 60.0, 70.0, 100.0, 90.0, 66.0, 40.0, 59.0, 150.0, 30.0, 20.0, 10.0, 110.0, 60.0, 70.0, 80.0, 70.0, 90.0, 130.0, -2.0, 70.0, 26.0, 130.0, 50.0, 70.0, 150.0, 120.0, 100.0, 74.0, 50.0, 40.0, 40.0, 20.0, 220.0, 45.0, 60.0, 40.0, 30.0, 100.0, 130.0, 80.0, 90.0, 60.0, 150.0, 110.0, 120.0, 50.0, 30.0, 106.0, 66.0, 140.0, 110.0, 4.0, 170.0, 77.0, 110.0, 180.0, 80.0, 160.0, 10.0, 10.0, 15.0, 130.0, 110.0, 70.0, 34.0, 60.0, 163.0, 20.0, 141.0, 96.0, 28.0, 90.0, 64.0, 81.0, 89.0, 140.0, 180.0, 90.0, 100.0, 110.0, 90.0, 90.0, 90.0, 50.0, 110.0, 50.0, 40.0, 130.0, 170.0, 65.0, 70.0, 80.0, 80.0, 90.0, 50.0, 140.0, 130.0, 80.0, 46.0, 110.0, 95.0, 110.0, 40.0, 59.0, 50.0, 10.0, 80.0, 108.0, 6.0, 50.0, 100.0, 80.0, 180.0, 20.0, 90.0, 50.0, 31.0, 100.0, 110.0, 90.0, 46.0, 112.0, 30.0, 80.0, 160.0, 90.0, 117.0, 120.0, 80.0, 140.0, 140.0, 80.0, 66.0, 70.0, 100.0, 120.0, 130.0, 130.0, 80.0, 160.0, 140.0, 160.0, 70.0, 180.0, 70.0, 150.0, 200.0, 120.0, 124.0, 100.0, 129.0, 220.0, 80.0, 130.0, 109.0, 79.0, 260.0, 30.0, 110.0, 115.0, 23.0, 150.0, 80.0, 110.0, 60.0, 140.0, 140.0, 30.0, 37.0, 5.0, 36.0, 40.0, 50.0, 140.0, 110.0, 46.0, 120.0, 50.0, 70.0, 90.0, 110.0, 100.0, 80.0, 60.0, 110.0, 150.0, 42.0, 109.0, 40.0, 120.0, 100.0, 90.0, 80.0, 60.0, 110.0, 190.0, 90.0, 98.0, 94.0, 110.0, 50.0, 140.0, 70.0, 100.0, 70.0, 19.0, 100.0, 109.0, 57.0, 16.0, 47.0, 90.0, 130.0, 39.0, 40.0, 40.0, 20.0, 140.0, 90.0, 110.0, 60.0, 78.0, 170.0, 60.0, 41.0, 31.0, 80.0, 230.0, 70.0, -44.0, 58.0, 100.0, 80.0, 140.0, 50.0, 20.0, 130.0, 140.0, 210.0, 140.0, 110.0, 50.0, 90.0, 50.0, 120.0, 90.0, 130.0, 60.0, 130.0, 50.0, 70.0, 39.0, 110.0, 71.0, 180.0, 120.0, 60.0, 65.0, 77.0, 42.0, 16.0, 230.0, 90.0, 100.0, 100.0, 20.0, 70.0, 14.0, 140.0, 90.0, 120.0, 70.0, 34.0, 70.0, 60.0, 80.0, 58.0, 66.0, 104.0, 180.0, 90.0, 110.0, 180.0, 140.0, 77.0, 70.0, 70.0, 43.0, 87.0, 35.0, -4.0, 26.0, 259.0, -4.0, 120.0, 22.0, 70.0, 40.0, 40.0, 60.0, 30.0, 70.0, 100.0, 60.0, 90.0, 80.0, 160.0, 110.0, 160.0, 60.0, 273.0, 142.0, -5.0, 108.0, 140.0, 80.0, 84.0, 100.0, 200.0, 100.0, 50.0, 70.0, 30.0, 70.0, 44.0, 150.0, 50.0, 190.0, 70.0, 130.0, 80.0, 120.0, 59.0, 120.0, 120.0, 50.0, 120.0, 130.0, 120.0, 60.0, 80.0, 98.0, 110.0, 160.0, 160.0, 80.0, 102.0, 100.0, 60.0, 105.0, 120.0, 60.0, 50.0, -5.0, 50.0, 80.0, 70.0, 127.0, 140.0, 88.0, 80.0, 120.0, 60.0, 150.0, 140.0, 130.0, 170.0, 110.0, 130.0, 110.0, 70.0, 130.0, 80.0, 170.0, 70.0, 30.0, 160.0, 50.0, 90.0, 100.0, 70.0, 50.0, 69.0, 117.0, 170.0, 100.0, 148.0, 130.0, 70.0, 60.0, 100.0, 158.0, 39.0, 90.0, -20.0, 60.0, 60.0, 60.0, 30.0, 100.0, 17.0, 80.0, 40.0, 40.0, 80.0, 158.0, 84.0, 63.0, 160.0, 90.0, 147.0, 40.0, 118.0, 110.0, 57.0, 69.0, 100.0, -20.0, 120.0, 74.0, 190.0, 140.0, 42.0, 70.0, 130.0, 160.0, 120.0, 70.0, 70.0, -14.0, 33.0, 204.0, -5.0, 70.0, 90.0, 92.0, 100.0, 120.0, 140.0, 150.0, 120.0, 90.0, 60.0, 100.0, 210.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.958931202982712, "mean_inference_ms": 1.9913985944722032, "mean_action_processing_ms": 0.5852895134980877, "mean_env_wait_ms": 1.336333057508693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012401580810546875, "StateBufferConnector_ms": 0.010697603225708008, "ViewRequirementAgentConnector_ms": 0.3879580497741699}, "num_episodes": 18, "episode_return_max": 1291.0, "episode_return_min": 135.0, "episode_return_mean": 895.88}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.553802351433017, "num_env_steps_trained_throughput_per_sec": 20.553802351433017, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 194124.069, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194124.023, "sample_time_ms": 2373.149, "learn_time_ms": 191731.437, "learn_throughput": 20.863, "synch_weights_time_ms": 11.681}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 54, "trial_id": "1841f_00000", "date": "2024-08-08_02-37-16", "timestamp": 1723099036, "time_this_iter_s": 194.61939096450806, "time_total_s": 11821.302542686462, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b336a1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11821.302542686462, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 18.977536231884056, "ram_util_percent": 77.1445652173913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.96734203267783, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.556638833585257, "policy_loss": -0.012656889581671967, "vf_loss": 8.567801928088562, "vf_explained_var": 0.0037172658501849515, "kl": 0.0074689231590590426, "entropy": 0.5754962111846073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 511755.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "env_runners": {"episode_reward_max": 1291.0, "episode_reward_min": 135.0, "episode_reward_mean": 891.93, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -58.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 89.193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [880.0, 880.0, 870.0, 1011.0, 1079.0, 1108.0, 1025.0, 627.0, 941.0, 1080.0, 807.0, 659.0, 1159.0, 1086.0, 951.0, 970.0, 693.0, 885.0, 769.0, 1004.0, 1160.0, 668.0, 1110.0, 667.0, 761.0, 960.0, 1004.0, 910.0, 1071.0, 971.0, 893.0, 831.0, 813.0, 135.0, 692.0, 653.0, 1210.0, 770.0, 659.0, 834.0, 689.0, 920.0, 993.0, 679.0, 912.0, 960.0, 915.0, 730.0, 764.0, 849.0, 1033.0, 1270.0, 1291.0, 1078.0, 634.0, 940.0, 941.0, 841.0, 668.0, 800.0, 784.0, 1130.0, 960.0, 800.0, 748.0, 1075.0, 654.0, 640.0, 1228.0, 898.0, 989.0, 1118.0, 722.0, 1105.0, 1070.0, 976.0, 835.0, 665.0, 938.0, 1006.0, 730.0, 1210.0, 992.0, 921.0, 1282.0, 626.0, 777.0, 1002.0, 908.0, 611.0, 890.0, 667.0, 1190.0, 1050.0, 1120.0, 764.0, 762.0, 900.0, 722.0, 565.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 90.0, 130.0, 120.0, 50.0, 110.0, 40.0, 150.0, 80.0, 10.0, 120.0, 70.0, 130.0, 100.0, 70.0, 50.0, 50.0, 140.0, 100.0, 50.0, 100.0, 100.0, 60.0, 60.0, 80.0, 110.0, 80.0, 140.0, 120.0, 20.0, 60.0, 90.0, 42.0, 139.0, 245.0, 160.0, 50.0, 25.0, 110.0, 90.0, 120.0, 50.0, 80.0, 140.0, 65.0, 140.0, 140.0, 160.0, 80.0, 104.0, 110.0, 130.0, 60.0, 99.0, 50.0, 210.0, 79.0, 120.0, 140.0, 110.0, 110.0, 140.0, 119.0, 20.0, 80.0, 70.0, 200.0, 120.0, 120.0, 46.0, 17.0, 90.0, 130.0, 28.0, 60.0, 160.0, -10.0, 90.0, 50.0, 12.0, 27.0, 100.0, 120.0, 130.0, 110.0, 100.0, 74.0, 110.0, 40.0, 130.0, 140.0, 230.0, 70.0, 150.0, 100.0, 100.0, 50.0, 90.0, 60.0, 90.0, 32.0, 110.0, 120.0, 22.0, 90.0, 120.0, 68.0, 100.0, 75.0, 70.0, 79.0, 35.0, 29.0, 20.0, 140.0, 57.0, 120.0, 89.0, 20.0, 70.0, 60.0, 70.0, 110.0, 150.0, 250.0, 160.0, 50.0, 49.0, 120.0, 140.0, 200.0, 150.0, 109.0, 22.0, 50.0, 25.0, 160.0, 70.0, 140.0, 160.0, 90.0, 123.0, -24.0, 120.0, 110.0, 83.0, 79.0, 120.0, 160.0, 90.0, 54.0, 30.0, 130.0, 39.0, 180.0, 67.0, 90.0, 210.0, 50.0, 120.0, 10.0, 110.0, 16.0, 130.0, 90.0, 57.0, 60.0, 90.0, 20.0, 110.0, 110.0, 25.0, 100.0, 60.0, 100.0, 80.0, 100.0, 80.0, 140.0, 90.0, 18.0, 50.0, 130.0, 61.0, 50.0, 90.0, 100.0, 100.0, 80.0, 90.0, 130.0, 47.0, 120.0, 68.0, 100.0, 110.0, 90.0, 159.0, 100.0, 80.0, 100.0, 110.0, 80.0, 110.0, 140.0, 140.0, 210.0, 70.0, 110.0, 90.0, 44.0, 90.0, 40.0, 64.0, 120.0, 50.0, 50.0, 110.0, 30.0, 70.0, 150.0, 70.0, 140.0, 90.0, 210.0, 40.0, 110.0, 50.0, 180.0, 70.0, 130.0, 85.0, 1.0, 15.0, 150.0, 49.0, -8.0, 150.0, 39.0, 56.0, 70.0, 50.0, 49.0, 43.0, 163.0, 70.0, 90.0, 16.0, 70.0, 140.0, 110.0, 110.0, 140.0, 70.0, 100.0, 70.0, 80.0, 90.0, 100.0, 90.0, 20.0, 22.0, 150.0, 30.0, 180.0, 160.0, 22.0, 160.0, 200.0, 60.0, 50.0, 70.0, 150.0, 110.0, 120.0, 90.0, 40.0, 120.0, 70.0, 90.0, 164.0, 70.0, 127.0, 180.0, 100.0, 90.0, 90.0, 70.0, 110.0, 70.0, 90.0, 15.0, 100.0, 70.0, 210.0, 36.0, 100.0, 50.0, 180.0, 120.0, 13.0, 130.0, 60.0, 60.0, 210.0, 70.0, 130.0, 60.0, 30.0, 130.0, 50.0, 180.0, 40.0, 116.0, 100.0, 15.0, 120.0, 120.0, 0.0, 90.0, 85.0, 31.0, 110.0, 60.0, 100.0, 80.0, 20.0, 197.0, 40.0, 90.0, 40.0, 10.0, 30.0, 30.0, 20.0, 2.0, -19.0, -58.0, 50.0, 30.0, 120.0, 130.0, 43.0, -24.0, 90.0, 90.0, 30.0, 63.0, 60.0, 90.0, 110.0, 22.0, 110.0, 12.0, 60.0, 59.0, 32.0, 40.0, 88.0, 120.0, 140.0, 280.0, 100.0, 110.0, 100.0, 130.0, 40.0, 70.0, 90.0, 150.0, 110.0, 30.0, 170.0, 34.0, 60.0, 70.0, 100.0, 90.0, 66.0, 40.0, 59.0, 150.0, 30.0, 20.0, 10.0, 110.0, 60.0, 70.0, 80.0, 70.0, 90.0, 130.0, -2.0, 70.0, 26.0, 130.0, 50.0, 70.0, 150.0, 120.0, 100.0, 74.0, 50.0, 40.0, 40.0, 20.0, 220.0, 45.0, 60.0, 40.0, 30.0, 100.0, 130.0, 80.0, 90.0, 60.0, 150.0, 110.0, 120.0, 50.0, 30.0, 106.0, 66.0, 140.0, 110.0, 4.0, 170.0, 77.0, 110.0, 180.0, 80.0, 160.0, 10.0, 10.0, 15.0, 130.0, 110.0, 70.0, 34.0, 60.0, 163.0, 20.0, 141.0, 96.0, 28.0, 90.0, 64.0, 81.0, 89.0, 140.0, 180.0, 90.0, 100.0, 110.0, 90.0, 90.0, 90.0, 50.0, 110.0, 50.0, 40.0, 130.0, 170.0, 65.0, 70.0, 80.0, 80.0, 90.0, 50.0, 140.0, 130.0, 80.0, 46.0, 110.0, 95.0, 110.0, 40.0, 59.0, 50.0, 10.0, 80.0, 108.0, 6.0, 50.0, 100.0, 80.0, 180.0, 20.0, 90.0, 50.0, 31.0, 100.0, 110.0, 90.0, 46.0, 112.0, 30.0, 80.0, 160.0, 90.0, 117.0, 120.0, 80.0, 140.0, 140.0, 80.0, 66.0, 70.0, 100.0, 120.0, 130.0, 130.0, 80.0, 160.0, 140.0, 160.0, 70.0, 180.0, 70.0, 150.0, 200.0, 120.0, 124.0, 100.0, 129.0, 220.0, 80.0, 130.0, 109.0, 79.0, 260.0, 30.0, 110.0, 115.0, 23.0, 150.0, 80.0, 110.0, 60.0, 140.0, 140.0, 30.0, 37.0, 5.0, 36.0, 40.0, 50.0, 140.0, 110.0, 46.0, 120.0, 50.0, 70.0, 90.0, 110.0, 100.0, 80.0, 60.0, 110.0, 150.0, 42.0, 109.0, 40.0, 120.0, 100.0, 90.0, 80.0, 60.0, 110.0, 190.0, 90.0, 98.0, 94.0, 110.0, 50.0, 140.0, 70.0, 100.0, 70.0, 19.0, 100.0, 109.0, 57.0, 16.0, 47.0, 90.0, 130.0, 39.0, 40.0, 40.0, 20.0, 140.0, 90.0, 110.0, 60.0, 78.0, 170.0, 60.0, 41.0, 31.0, 80.0, 230.0, 70.0, -44.0, 58.0, 100.0, 80.0, 140.0, 50.0, 20.0, 130.0, 140.0, 210.0, 140.0, 110.0, 50.0, 90.0, 50.0, 120.0, 90.0, 130.0, 60.0, 130.0, 50.0, 70.0, 39.0, 110.0, 71.0, 180.0, 120.0, 60.0, 65.0, 77.0, 42.0, 16.0, 230.0, 90.0, 100.0, 100.0, 20.0, 70.0, 14.0, 140.0, 90.0, 120.0, 70.0, 34.0, 70.0, 60.0, 80.0, 58.0, 66.0, 104.0, 180.0, 90.0, 110.0, 180.0, 140.0, 77.0, 70.0, 70.0, 43.0, 87.0, 35.0, -4.0, 26.0, 259.0, -4.0, 120.0, 22.0, 70.0, 40.0, 40.0, 60.0, 30.0, 70.0, 100.0, 60.0, 90.0, 80.0, 160.0, 110.0, 160.0, 60.0, 273.0, 142.0, -5.0, 108.0, 140.0, 80.0, 84.0, 100.0, 200.0, 100.0, 50.0, 70.0, 30.0, 70.0, 44.0, 150.0, 50.0, 190.0, 70.0, 130.0, 80.0, 120.0, 59.0, 120.0, 120.0, 50.0, 120.0, 130.0, 120.0, 60.0, 80.0, 98.0, 110.0, 160.0, 160.0, 80.0, 102.0, 100.0, 60.0, 105.0, 120.0, 60.0, 50.0, -5.0, 50.0, 80.0, 70.0, 127.0, 140.0, 88.0, 80.0, 120.0, 60.0, 150.0, 140.0, 130.0, 170.0, 110.0, 130.0, 110.0, 70.0, 130.0, 80.0, 170.0, 70.0, 30.0, 160.0, 50.0, 90.0, 100.0, 70.0, 50.0, 69.0, 117.0, 170.0, 100.0, 148.0, 130.0, 70.0, 60.0, 100.0, 158.0, 39.0, 90.0, -20.0, 60.0, 60.0, 60.0, 30.0, 100.0, 17.0, 80.0, 40.0, 40.0, 80.0, 158.0, 84.0, 63.0, 160.0, 90.0, 147.0, 40.0, 118.0, 110.0, 57.0, 69.0, 100.0, -20.0, 120.0, 74.0, 190.0, 140.0, 42.0, 70.0, 130.0, 160.0, 120.0, 70.0, 70.0, -14.0, 33.0, 204.0, -5.0, 70.0, 90.0, 92.0, 100.0, 120.0, 140.0, 150.0, 120.0, 90.0, 60.0, 100.0, 210.0, 120.0, 86.0, 110.0, 106.0, 140.0, 70.0, 140.0, 150.0, 80.0, 70.0, 40.0, 90.0, 107.0, 140.0, 50.0, 100.0, 54.0, 40.0, 90.0, 90.0, 160.0, 86.0, 220.0, 160.0, 110.0, 150.0, 120.0, 106.0, 100.0, 160.0, 70.0, 90.0, 30.0, 90.0, 80.0, 99.0, 50.0, 37.0, 30.0, 100.0, 20.0, 150.0, -4.0, 120.0, 147.0, 29.0, 130.0, 80.0, 15.0, 40.0, 70.0, 90.0, 43.0, 96.0, 130.0, 170.0, 90.0, 146.0, 52.0, 76.0, 109.0, 100.0, 70.0, 60.0, 70.0, 58.0, 210.0, 130.0, 30.0, 70.0, 110.0, 66.0, 40.0, 95.0, 90.0, 50.0, 121.0, 70.0, -50.0, 30.0, 99.0, 80.0, 80.0, 20.0, 40.0, 200.0, 110.0, 50.0, 70.0, 150.0, 90.0, 90.0, 70.0, 79.0, 70.0, 10.0, 40.0, 78.0, 130.0, 50.0, 50.0, 60.0, 110.0, 120.0, 80.0, 80.0, 70.0, 140.0, 240.0, 180.0, 110.0, 110.0, 60.0, 110.0, 170.0, 80.0, 150.0, 90.0, 110.0, 20.0, 150.0, 90.0, 160.0, 230.0, 130.0, 170.0, 60.0, 70.0, 60.0, 100.0, 50.0, 110.0, 110.0, 20.0, 143.0, 140.0, 50.0, 20.0, 68.0, 110.0, -7.0, 110.0, 150.0, 30.0, 70.0, 46.0, 36.0, 40.0, 30.0, 160.0, 90.0, 150.0, 120.0, 50.0, 50.0, 110.0, 50.0, 100.0, 150.0, 50.0, 70.0, 60.0, 149.0, 50.0, 29.0, 29.0, 95.0, 30.0, 80.0, 130.0, 70.0, 20.0, 51.0, 40.0, 20.0, 70.0, 170.0, 70.0, 70.0, 14.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9510541737127773, "mean_inference_ms": 1.9815401731838813, "mean_action_processing_ms": 0.5824536974504965, "mean_env_wait_ms": 1.3300628060783057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012865781784057617, "StateBufferConnector_ms": 0.010653257369995117, "ViewRequirementAgentConnector_ms": 0.38793396949768066}, "num_episodes": 18, "episode_return_max": 1291.0, "episode_return_min": 135.0, "episode_return_mean": 891.93}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.600281680084397, "num_env_steps_trained_throughput_per_sec": 20.600281680084397, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 2200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2200000, "timers": {"training_iteration_time_ms": 194051.217, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194051.17, "sample_time_ms": 2352.203, "learn_time_ms": 191679.456, "learn_throughput": 20.868, "synch_weights_time_ms": 11.619}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "done": false, "training_iteration": 55, "trial_id": "1841f_00000", "date": "2024-08-08_02-40-31", "timestamp": 1723099231, "time_this_iter_s": 194.1829719543457, "time_total_s": 12015.485514640808, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b336a940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12015.485514640808, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.16934306569343, "ram_util_percent": 76.48357664233576}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9490366251577838, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.750171822861741, "policy_loss": -0.012031591140156308, "vf_loss": 8.760734934700183, "vf_explained_var": 0.011773068658587016, "kl": 0.007342429834422616, "entropy": 0.5426169740887115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 521145.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 1334.0, "episode_reward_min": 135.0, "episode_reward_mean": 910.53, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -58.0}, "policy_reward_max": {"policy_0": 290.0}, "policy_reward_mean": {"policy_0": 91.053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [769.0, 1004.0, 1160.0, 668.0, 1110.0, 667.0, 761.0, 960.0, 1004.0, 910.0, 1071.0, 971.0, 893.0, 831.0, 813.0, 135.0, 692.0, 653.0, 1210.0, 770.0, 659.0, 834.0, 689.0, 920.0, 993.0, 679.0, 912.0, 960.0, 915.0, 730.0, 764.0, 849.0, 1033.0, 1270.0, 1291.0, 1078.0, 634.0, 940.0, 941.0, 841.0, 668.0, 800.0, 784.0, 1130.0, 960.0, 800.0, 748.0, 1075.0, 654.0, 640.0, 1228.0, 898.0, 989.0, 1118.0, 722.0, 1105.0, 1070.0, 976.0, 835.0, 665.0, 938.0, 1006.0, 730.0, 1210.0, 992.0, 921.0, 1282.0, 626.0, 777.0, 1002.0, 908.0, 611.0, 890.0, 667.0, 1190.0, 1050.0, 1120.0, 764.0, 762.0, 900.0, 722.0, 565.0, 949.0, 1058.0, 960.0, 680.0, 1195.0, 1240.0, 1060.0, 1334.0, 762.0, 837.0, 924.0, 1044.0, 1170.0, 1226.0, 890.0, 1120.0, 1033.0, 1089.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [18.0, 50.0, 130.0, 61.0, 50.0, 90.0, 100.0, 100.0, 80.0, 90.0, 130.0, 47.0, 120.0, 68.0, 100.0, 110.0, 90.0, 159.0, 100.0, 80.0, 100.0, 110.0, 80.0, 110.0, 140.0, 140.0, 210.0, 70.0, 110.0, 90.0, 44.0, 90.0, 40.0, 64.0, 120.0, 50.0, 50.0, 110.0, 30.0, 70.0, 150.0, 70.0, 140.0, 90.0, 210.0, 40.0, 110.0, 50.0, 180.0, 70.0, 130.0, 85.0, 1.0, 15.0, 150.0, 49.0, -8.0, 150.0, 39.0, 56.0, 70.0, 50.0, 49.0, 43.0, 163.0, 70.0, 90.0, 16.0, 70.0, 140.0, 110.0, 110.0, 140.0, 70.0, 100.0, 70.0, 80.0, 90.0, 100.0, 90.0, 20.0, 22.0, 150.0, 30.0, 180.0, 160.0, 22.0, 160.0, 200.0, 60.0, 50.0, 70.0, 150.0, 110.0, 120.0, 90.0, 40.0, 120.0, 70.0, 90.0, 164.0, 70.0, 127.0, 180.0, 100.0, 90.0, 90.0, 70.0, 110.0, 70.0, 90.0, 15.0, 100.0, 70.0, 210.0, 36.0, 100.0, 50.0, 180.0, 120.0, 13.0, 130.0, 60.0, 60.0, 210.0, 70.0, 130.0, 60.0, 30.0, 130.0, 50.0, 180.0, 40.0, 116.0, 100.0, 15.0, 120.0, 120.0, 0.0, 90.0, 85.0, 31.0, 110.0, 60.0, 100.0, 80.0, 20.0, 197.0, 40.0, 90.0, 40.0, 10.0, 30.0, 30.0, 20.0, 2.0, -19.0, -58.0, 50.0, 30.0, 120.0, 130.0, 43.0, -24.0, 90.0, 90.0, 30.0, 63.0, 60.0, 90.0, 110.0, 22.0, 110.0, 12.0, 60.0, 59.0, 32.0, 40.0, 88.0, 120.0, 140.0, 280.0, 100.0, 110.0, 100.0, 130.0, 40.0, 70.0, 90.0, 150.0, 110.0, 30.0, 170.0, 34.0, 60.0, 70.0, 100.0, 90.0, 66.0, 40.0, 59.0, 150.0, 30.0, 20.0, 10.0, 110.0, 60.0, 70.0, 80.0, 70.0, 90.0, 130.0, -2.0, 70.0, 26.0, 130.0, 50.0, 70.0, 150.0, 120.0, 100.0, 74.0, 50.0, 40.0, 40.0, 20.0, 220.0, 45.0, 60.0, 40.0, 30.0, 100.0, 130.0, 80.0, 90.0, 60.0, 150.0, 110.0, 120.0, 50.0, 30.0, 106.0, 66.0, 140.0, 110.0, 4.0, 170.0, 77.0, 110.0, 180.0, 80.0, 160.0, 10.0, 10.0, 15.0, 130.0, 110.0, 70.0, 34.0, 60.0, 163.0, 20.0, 141.0, 96.0, 28.0, 90.0, 64.0, 81.0, 89.0, 140.0, 180.0, 90.0, 100.0, 110.0, 90.0, 90.0, 90.0, 50.0, 110.0, 50.0, 40.0, 130.0, 170.0, 65.0, 70.0, 80.0, 80.0, 90.0, 50.0, 140.0, 130.0, 80.0, 46.0, 110.0, 95.0, 110.0, 40.0, 59.0, 50.0, 10.0, 80.0, 108.0, 6.0, 50.0, 100.0, 80.0, 180.0, 20.0, 90.0, 50.0, 31.0, 100.0, 110.0, 90.0, 46.0, 112.0, 30.0, 80.0, 160.0, 90.0, 117.0, 120.0, 80.0, 140.0, 140.0, 80.0, 66.0, 70.0, 100.0, 120.0, 130.0, 130.0, 80.0, 160.0, 140.0, 160.0, 70.0, 180.0, 70.0, 150.0, 200.0, 120.0, 124.0, 100.0, 129.0, 220.0, 80.0, 130.0, 109.0, 79.0, 260.0, 30.0, 110.0, 115.0, 23.0, 150.0, 80.0, 110.0, 60.0, 140.0, 140.0, 30.0, 37.0, 5.0, 36.0, 40.0, 50.0, 140.0, 110.0, 46.0, 120.0, 50.0, 70.0, 90.0, 110.0, 100.0, 80.0, 60.0, 110.0, 150.0, 42.0, 109.0, 40.0, 120.0, 100.0, 90.0, 80.0, 60.0, 110.0, 190.0, 90.0, 98.0, 94.0, 110.0, 50.0, 140.0, 70.0, 100.0, 70.0, 19.0, 100.0, 109.0, 57.0, 16.0, 47.0, 90.0, 130.0, 39.0, 40.0, 40.0, 20.0, 140.0, 90.0, 110.0, 60.0, 78.0, 170.0, 60.0, 41.0, 31.0, 80.0, 230.0, 70.0, -44.0, 58.0, 100.0, 80.0, 140.0, 50.0, 20.0, 130.0, 140.0, 210.0, 140.0, 110.0, 50.0, 90.0, 50.0, 120.0, 90.0, 130.0, 60.0, 130.0, 50.0, 70.0, 39.0, 110.0, 71.0, 180.0, 120.0, 60.0, 65.0, 77.0, 42.0, 16.0, 230.0, 90.0, 100.0, 100.0, 20.0, 70.0, 14.0, 140.0, 90.0, 120.0, 70.0, 34.0, 70.0, 60.0, 80.0, 58.0, 66.0, 104.0, 180.0, 90.0, 110.0, 180.0, 140.0, 77.0, 70.0, 70.0, 43.0, 87.0, 35.0, -4.0, 26.0, 259.0, -4.0, 120.0, 22.0, 70.0, 40.0, 40.0, 60.0, 30.0, 70.0, 100.0, 60.0, 90.0, 80.0, 160.0, 110.0, 160.0, 60.0, 273.0, 142.0, -5.0, 108.0, 140.0, 80.0, 84.0, 100.0, 200.0, 100.0, 50.0, 70.0, 30.0, 70.0, 44.0, 150.0, 50.0, 190.0, 70.0, 130.0, 80.0, 120.0, 59.0, 120.0, 120.0, 50.0, 120.0, 130.0, 120.0, 60.0, 80.0, 98.0, 110.0, 160.0, 160.0, 80.0, 102.0, 100.0, 60.0, 105.0, 120.0, 60.0, 50.0, -5.0, 50.0, 80.0, 70.0, 127.0, 140.0, 88.0, 80.0, 120.0, 60.0, 150.0, 140.0, 130.0, 170.0, 110.0, 130.0, 110.0, 70.0, 130.0, 80.0, 170.0, 70.0, 30.0, 160.0, 50.0, 90.0, 100.0, 70.0, 50.0, 69.0, 117.0, 170.0, 100.0, 148.0, 130.0, 70.0, 60.0, 100.0, 158.0, 39.0, 90.0, -20.0, 60.0, 60.0, 60.0, 30.0, 100.0, 17.0, 80.0, 40.0, 40.0, 80.0, 158.0, 84.0, 63.0, 160.0, 90.0, 147.0, 40.0, 118.0, 110.0, 57.0, 69.0, 100.0, -20.0, 120.0, 74.0, 190.0, 140.0, 42.0, 70.0, 130.0, 160.0, 120.0, 70.0, 70.0, -14.0, 33.0, 204.0, -5.0, 70.0, 90.0, 92.0, 100.0, 120.0, 140.0, 150.0, 120.0, 90.0, 60.0, 100.0, 210.0, 120.0, 86.0, 110.0, 106.0, 140.0, 70.0, 140.0, 150.0, 80.0, 70.0, 40.0, 90.0, 107.0, 140.0, 50.0, 100.0, 54.0, 40.0, 90.0, 90.0, 160.0, 86.0, 220.0, 160.0, 110.0, 150.0, 120.0, 106.0, 100.0, 160.0, 70.0, 90.0, 30.0, 90.0, 80.0, 99.0, 50.0, 37.0, 30.0, 100.0, 20.0, 150.0, -4.0, 120.0, 147.0, 29.0, 130.0, 80.0, 15.0, 40.0, 70.0, 90.0, 43.0, 96.0, 130.0, 170.0, 90.0, 146.0, 52.0, 76.0, 109.0, 100.0, 70.0, 60.0, 70.0, 58.0, 210.0, 130.0, 30.0, 70.0, 110.0, 66.0, 40.0, 95.0, 90.0, 50.0, 121.0, 70.0, -50.0, 30.0, 99.0, 80.0, 80.0, 20.0, 40.0, 200.0, 110.0, 50.0, 70.0, 150.0, 90.0, 90.0, 70.0, 79.0, 70.0, 10.0, 40.0, 78.0, 130.0, 50.0, 50.0, 60.0, 110.0, 120.0, 80.0, 80.0, 70.0, 140.0, 240.0, 180.0, 110.0, 110.0, 60.0, 110.0, 170.0, 80.0, 150.0, 90.0, 110.0, 20.0, 150.0, 90.0, 160.0, 230.0, 130.0, 170.0, 60.0, 70.0, 60.0, 100.0, 50.0, 110.0, 110.0, 20.0, 143.0, 140.0, 50.0, 20.0, 68.0, 110.0, -7.0, 110.0, 150.0, 30.0, 70.0, 46.0, 36.0, 40.0, 30.0, 160.0, 90.0, 150.0, 120.0, 50.0, 50.0, 110.0, 50.0, 100.0, 150.0, 50.0, 70.0, 60.0, 149.0, 50.0, 29.0, 29.0, 95.0, 30.0, 80.0, 130.0, 70.0, 20.0, 51.0, 40.0, 20.0, 70.0, 170.0, 70.0, 70.0, 14.0, 40.0, 130.0, 20.0, 80.0, 60.0, 130.0, 90.0, 89.0, 50.0, 230.0, 70.0, 140.0, 88.0, 120.0, 90.0, 50.0, 100.0, 80.0, 120.0, 200.0, 70.0, 90.0, 130.0, 86.0, 210.0, 90.0, 89.0, 36.0, 90.0, 39.0, 100.0, 80.0, 130.0, 60.0, 20.0, 80.0, 20.0, 90.0, 60.0, 50.0, 90.0, 129.0, 180.0, 80.0, 120.0, 160.0, 169.0, 140.0, 110.0, 67.0, 40.0, 60.0, 90.0, 140.0, 150.0, 100.0, 200.0, 130.0, 100.0, 160.0, 110.0, 120.0, 140.0, 110.0, 140.0, 60.0, 80.0, 100.0, 60.0, 145.0, 105.0, 170.0, 116.0, 120.0, 110.0, 240.0, 153.0, 120.0, 130.0, 41.0, 134.0, 137.0, 60.0, 100.0, 54.0, 140.0, 70.0, 70.0, 70.0, 6.0, 55.0, 130.0, -51.0, 22.0, 60.0, 28.0, 110.0, 70.0, 290.0, 98.0, 80.0, 51.0, 70.0, 47.0, 140.0, 30.0, 80.0, 130.0, 65.0, 201.0, 110.0, 90.0, 150.0, 47.0, 110.0, 100.0, 70.0, 110.0, 120.0, 160.0, 87.0, 140.0, 130.0, 170.0, 80.0, 130.0, 90.0, 110.0, 140.0, 70.0, 110.0, 110.0, 160.0, 180.0, 69.0, 120.0, 110.0, 110.0, 137.0, 180.0, 50.0, 60.0, 80.0, 70.0, 110.0, 90.0, 50.0, 170.0, 60.0, 140.0, 60.0, 110.0, 150.0, 70.0, 150.0, 80.0, 50.0, 150.0, 110.0, 140.0, 110.0, 60.0, 220.0, 140.0, 150.0, 90.0, 113.0, 64.0, -30.0, 86.0, 140.0, 70.0, 40.0, 100.0, 130.0, 90.0, 150.0, 130.0, 59.0, 140.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.943319003205126, "mean_inference_ms": 1.9721576541948576, "mean_action_processing_ms": 0.579742395166247, "mean_env_wait_ms": 1.3239857019352825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012872457504272461, "StateBufferConnector_ms": 0.010786294937133789, "ViewRequirementAgentConnector_ms": 0.37712645530700684}, "num_episodes": 18, "episode_return_max": 1334.0, "episode_return_min": 135.0, "episode_return_mean": 910.53}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.635943979681937, "num_env_steps_trained_throughput_per_sec": 20.635943979681937, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 194024.969, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194024.923, "sample_time_ms": 2342.116, "learn_time_ms": 191663.381, "learn_throughput": 20.87, "synch_weights_time_ms": 11.324}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 56, "trial_id": "1841f_00000", "date": "2024-08-08_02-43-44", "timestamp": 1723099424, "time_this_iter_s": 193.84517788887024, "time_total_s": 12209.330692529678, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b336a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12209.330692529678, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.28181818181818, "ram_util_percent": 76.4869090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8880520062197768, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.69284992202783, "policy_loss": -0.011299206144042527, "vf_loss": 8.70288817554998, "vf_explained_var": 0.003045620463780575, "kl": 0.006304814204086285, "entropy": 0.5239825244655751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 530535.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 1334.0, "episode_reward_min": 565.0, "episode_reward_mean": 942.42, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -51.0}, "policy_reward_max": {"policy_0": 290.0}, "policy_reward_mean": {"policy_0": 94.242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [689.0, 920.0, 993.0, 679.0, 912.0, 960.0, 915.0, 730.0, 764.0, 849.0, 1033.0, 1270.0, 1291.0, 1078.0, 634.0, 940.0, 941.0, 841.0, 668.0, 800.0, 784.0, 1130.0, 960.0, 800.0, 748.0, 1075.0, 654.0, 640.0, 1228.0, 898.0, 989.0, 1118.0, 722.0, 1105.0, 1070.0, 976.0, 835.0, 665.0, 938.0, 1006.0, 730.0, 1210.0, 992.0, 921.0, 1282.0, 626.0, 777.0, 1002.0, 908.0, 611.0, 890.0, 667.0, 1190.0, 1050.0, 1120.0, 764.0, 762.0, 900.0, 722.0, 565.0, 949.0, 1058.0, 960.0, 680.0, 1195.0, 1240.0, 1060.0, 1334.0, 762.0, 837.0, 924.0, 1044.0, 1170.0, 1226.0, 890.0, 1120.0, 1033.0, 1089.0, 1105.0, 1043.0, 986.0, 1037.0, 1017.0, 1036.0, 797.0, 1060.0, 1070.0, 899.0, 1067.0, 1109.0, 1040.0, 863.0, 617.0, 832.0, 1075.0, 940.0, 1209.0, 900.0, 1066.0, 966.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 74.0, 50.0, 40.0, 40.0, 20.0, 220.0, 45.0, 60.0, 40.0, 30.0, 100.0, 130.0, 80.0, 90.0, 60.0, 150.0, 110.0, 120.0, 50.0, 30.0, 106.0, 66.0, 140.0, 110.0, 4.0, 170.0, 77.0, 110.0, 180.0, 80.0, 160.0, 10.0, 10.0, 15.0, 130.0, 110.0, 70.0, 34.0, 60.0, 163.0, 20.0, 141.0, 96.0, 28.0, 90.0, 64.0, 81.0, 89.0, 140.0, 180.0, 90.0, 100.0, 110.0, 90.0, 90.0, 90.0, 50.0, 110.0, 50.0, 40.0, 130.0, 170.0, 65.0, 70.0, 80.0, 80.0, 90.0, 50.0, 140.0, 130.0, 80.0, 46.0, 110.0, 95.0, 110.0, 40.0, 59.0, 50.0, 10.0, 80.0, 108.0, 6.0, 50.0, 100.0, 80.0, 180.0, 20.0, 90.0, 50.0, 31.0, 100.0, 110.0, 90.0, 46.0, 112.0, 30.0, 80.0, 160.0, 90.0, 117.0, 120.0, 80.0, 140.0, 140.0, 80.0, 66.0, 70.0, 100.0, 120.0, 130.0, 130.0, 80.0, 160.0, 140.0, 160.0, 70.0, 180.0, 70.0, 150.0, 200.0, 120.0, 124.0, 100.0, 129.0, 220.0, 80.0, 130.0, 109.0, 79.0, 260.0, 30.0, 110.0, 115.0, 23.0, 150.0, 80.0, 110.0, 60.0, 140.0, 140.0, 30.0, 37.0, 5.0, 36.0, 40.0, 50.0, 140.0, 110.0, 46.0, 120.0, 50.0, 70.0, 90.0, 110.0, 100.0, 80.0, 60.0, 110.0, 150.0, 42.0, 109.0, 40.0, 120.0, 100.0, 90.0, 80.0, 60.0, 110.0, 190.0, 90.0, 98.0, 94.0, 110.0, 50.0, 140.0, 70.0, 100.0, 70.0, 19.0, 100.0, 109.0, 57.0, 16.0, 47.0, 90.0, 130.0, 39.0, 40.0, 40.0, 20.0, 140.0, 90.0, 110.0, 60.0, 78.0, 170.0, 60.0, 41.0, 31.0, 80.0, 230.0, 70.0, -44.0, 58.0, 100.0, 80.0, 140.0, 50.0, 20.0, 130.0, 140.0, 210.0, 140.0, 110.0, 50.0, 90.0, 50.0, 120.0, 90.0, 130.0, 60.0, 130.0, 50.0, 70.0, 39.0, 110.0, 71.0, 180.0, 120.0, 60.0, 65.0, 77.0, 42.0, 16.0, 230.0, 90.0, 100.0, 100.0, 20.0, 70.0, 14.0, 140.0, 90.0, 120.0, 70.0, 34.0, 70.0, 60.0, 80.0, 58.0, 66.0, 104.0, 180.0, 90.0, 110.0, 180.0, 140.0, 77.0, 70.0, 70.0, 43.0, 87.0, 35.0, -4.0, 26.0, 259.0, -4.0, 120.0, 22.0, 70.0, 40.0, 40.0, 60.0, 30.0, 70.0, 100.0, 60.0, 90.0, 80.0, 160.0, 110.0, 160.0, 60.0, 273.0, 142.0, -5.0, 108.0, 140.0, 80.0, 84.0, 100.0, 200.0, 100.0, 50.0, 70.0, 30.0, 70.0, 44.0, 150.0, 50.0, 190.0, 70.0, 130.0, 80.0, 120.0, 59.0, 120.0, 120.0, 50.0, 120.0, 130.0, 120.0, 60.0, 80.0, 98.0, 110.0, 160.0, 160.0, 80.0, 102.0, 100.0, 60.0, 105.0, 120.0, 60.0, 50.0, -5.0, 50.0, 80.0, 70.0, 127.0, 140.0, 88.0, 80.0, 120.0, 60.0, 150.0, 140.0, 130.0, 170.0, 110.0, 130.0, 110.0, 70.0, 130.0, 80.0, 170.0, 70.0, 30.0, 160.0, 50.0, 90.0, 100.0, 70.0, 50.0, 69.0, 117.0, 170.0, 100.0, 148.0, 130.0, 70.0, 60.0, 100.0, 158.0, 39.0, 90.0, -20.0, 60.0, 60.0, 60.0, 30.0, 100.0, 17.0, 80.0, 40.0, 40.0, 80.0, 158.0, 84.0, 63.0, 160.0, 90.0, 147.0, 40.0, 118.0, 110.0, 57.0, 69.0, 100.0, -20.0, 120.0, 74.0, 190.0, 140.0, 42.0, 70.0, 130.0, 160.0, 120.0, 70.0, 70.0, -14.0, 33.0, 204.0, -5.0, 70.0, 90.0, 92.0, 100.0, 120.0, 140.0, 150.0, 120.0, 90.0, 60.0, 100.0, 210.0, 120.0, 86.0, 110.0, 106.0, 140.0, 70.0, 140.0, 150.0, 80.0, 70.0, 40.0, 90.0, 107.0, 140.0, 50.0, 100.0, 54.0, 40.0, 90.0, 90.0, 160.0, 86.0, 220.0, 160.0, 110.0, 150.0, 120.0, 106.0, 100.0, 160.0, 70.0, 90.0, 30.0, 90.0, 80.0, 99.0, 50.0, 37.0, 30.0, 100.0, 20.0, 150.0, -4.0, 120.0, 147.0, 29.0, 130.0, 80.0, 15.0, 40.0, 70.0, 90.0, 43.0, 96.0, 130.0, 170.0, 90.0, 146.0, 52.0, 76.0, 109.0, 100.0, 70.0, 60.0, 70.0, 58.0, 210.0, 130.0, 30.0, 70.0, 110.0, 66.0, 40.0, 95.0, 90.0, 50.0, 121.0, 70.0, -50.0, 30.0, 99.0, 80.0, 80.0, 20.0, 40.0, 200.0, 110.0, 50.0, 70.0, 150.0, 90.0, 90.0, 70.0, 79.0, 70.0, 10.0, 40.0, 78.0, 130.0, 50.0, 50.0, 60.0, 110.0, 120.0, 80.0, 80.0, 70.0, 140.0, 240.0, 180.0, 110.0, 110.0, 60.0, 110.0, 170.0, 80.0, 150.0, 90.0, 110.0, 20.0, 150.0, 90.0, 160.0, 230.0, 130.0, 170.0, 60.0, 70.0, 60.0, 100.0, 50.0, 110.0, 110.0, 20.0, 143.0, 140.0, 50.0, 20.0, 68.0, 110.0, -7.0, 110.0, 150.0, 30.0, 70.0, 46.0, 36.0, 40.0, 30.0, 160.0, 90.0, 150.0, 120.0, 50.0, 50.0, 110.0, 50.0, 100.0, 150.0, 50.0, 70.0, 60.0, 149.0, 50.0, 29.0, 29.0, 95.0, 30.0, 80.0, 130.0, 70.0, 20.0, 51.0, 40.0, 20.0, 70.0, 170.0, 70.0, 70.0, 14.0, 40.0, 130.0, 20.0, 80.0, 60.0, 130.0, 90.0, 89.0, 50.0, 230.0, 70.0, 140.0, 88.0, 120.0, 90.0, 50.0, 100.0, 80.0, 120.0, 200.0, 70.0, 90.0, 130.0, 86.0, 210.0, 90.0, 89.0, 36.0, 90.0, 39.0, 100.0, 80.0, 130.0, 60.0, 20.0, 80.0, 20.0, 90.0, 60.0, 50.0, 90.0, 129.0, 180.0, 80.0, 120.0, 160.0, 169.0, 140.0, 110.0, 67.0, 40.0, 60.0, 90.0, 140.0, 150.0, 100.0, 200.0, 130.0, 100.0, 160.0, 110.0, 120.0, 140.0, 110.0, 140.0, 60.0, 80.0, 100.0, 60.0, 145.0, 105.0, 170.0, 116.0, 120.0, 110.0, 240.0, 153.0, 120.0, 130.0, 41.0, 134.0, 137.0, 60.0, 100.0, 54.0, 140.0, 70.0, 70.0, 70.0, 6.0, 55.0, 130.0, -51.0, 22.0, 60.0, 28.0, 110.0, 70.0, 290.0, 98.0, 80.0, 51.0, 70.0, 47.0, 140.0, 30.0, 80.0, 130.0, 65.0, 201.0, 110.0, 90.0, 150.0, 47.0, 110.0, 100.0, 70.0, 110.0, 120.0, 160.0, 87.0, 140.0, 130.0, 170.0, 80.0, 130.0, 90.0, 110.0, 140.0, 70.0, 110.0, 110.0, 160.0, 180.0, 69.0, 120.0, 110.0, 110.0, 137.0, 180.0, 50.0, 60.0, 80.0, 70.0, 110.0, 90.0, 50.0, 170.0, 60.0, 140.0, 60.0, 110.0, 150.0, 70.0, 150.0, 80.0, 50.0, 150.0, 110.0, 140.0, 110.0, 60.0, 220.0, 140.0, 150.0, 90.0, 113.0, 64.0, -30.0, 86.0, 140.0, 70.0, 40.0, 100.0, 130.0, 90.0, 150.0, 130.0, 59.0, 140.0, 180.0, 106.0, 68.0, 41.0, 90.0, 160.0, 120.0, 140.0, 140.0, 150.0, 90.0, 50.0, 73.0, 120.0, 140.0, 50.0, 210.0, 100.0, 30.0, 170.0, 100.0, 40.0, 176.0, 120.0, 230.0, 70.0, 55.0, 50.0, 95.0, 100.0, 50.0, 70.0, 59.0, 120.0, 86.0, 80.0, 129.0, 210.0, 53.0, 110.0, 120.0, 150.0, 160.0, 100.0, 90.0, 150.0, 78.0, 140.0, 30.0, 59.0, 60.0, 114.0, 188.0, 100.0, 77.0, 98.0, 110.0, 108.0, 35.0, 90.0, 116.0, 60.0, 40.0, 48.0, 130.0, 150.0, 200.0, 30.0, 29.0, 60.0, 50.0, 40.0, 130.0, 70.0, 150.0, 60.0, 80.0, 130.0, 130.0, 160.0, 110.0, 70.0, 100.0, 140.0, 100.0, 130.0, 110.0, 80.0, 140.0, 110.0, 90.0, 90.0, 140.0, 40.0, 90.0, 69.0, 70.0, 80.0, 190.0, 70.0, 60.0, 80.0, 150.0, 50.0, 140.0, 80.0, 54.0, 130.0, 83.0, 130.0, 170.0, 170.0, 50.0, 36.0, 80.0, 128.0, 67.0, 140.0, 118.0, 80.0, 240.0, 80.0, 40.0, 120.0, 50.0, 110.0, 60.0, 220.0, 70.0, 240.0, 50.0, 60.0, 100.0, 56.0, 140.0, 73.0, 50.0, 70.0, 130.0, 64.0, 120.0, 20.0, 10.0, 61.0, 70.0, 66.0, 185.0, 74.0, 36.0, 30.0, 65.0, 38.0, 150.0, 120.0, 20.0, 50.0, 80.0, 120.0, 140.0, 49.0, 65.0, 120.0, 50.0, 60.0, 130.0, 190.0, 60.0, 210.0, 100.0, 75.0, 80.0, 40.0, 20.0, 110.0, 150.0, 120.0, 130.0, 30.0, 200.0, 60.0, 80.0, 200.0, 120.0, 78.0, 160.0, 130.0, 130.0, 160.0, 101.0, 120.0, 10.0, 60.0, 60.0, 190.0, 110.0, 100.0, 90.0, 90.0, 50.0, 90.0, 60.0, 160.0, 140.0, 46.0, 110.0, 150.0, 30.0, 150.0, 70.0, 100.0, 110.0, 70.0, 100.0, 110.0, 126.0, 70.0, 87.0, 146.0, 80.0, 68.0, 109.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9338252051220604, "mean_inference_ms": 1.9613546692417096, "mean_action_processing_ms": 0.5766093130789028, "mean_env_wait_ms": 1.317092256296103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012992620468139648, "StateBufferConnector_ms": 0.009448051452636719, "ViewRequirementAgentConnector_ms": 0.3850514888763428}, "num_episodes": 22, "episode_return_max": 1334.0, "episode_return_min": 565.0, "episode_return_mean": 942.42}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.7352994511878, "num_env_steps_trained_throughput_per_sec": 20.7352994511878, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 193954.63, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193954.584, "sample_time_ms": 2336.452, "learn_time_ms": 191598.8, "learn_throughput": 20.877, "synch_weights_time_ms": 11.285}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 57, "trial_id": "1841f_00000", "date": "2024-08-08_02-46-57", "timestamp": 1723099617, "time_this_iter_s": 192.91835594177246, "time_total_s": 12402.24904847145, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b336a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12402.24904847145, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.15955882352941, "ram_util_percent": 76.49963235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8734483069124312, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.577332710788147, "policy_loss": -0.011958367614143978, "vf_loss": 8.587864250623888, "vf_explained_var": -0.0059348091784630595, "kl": 0.007134123685378428, "entropy": 0.521340148400067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 539925.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 1334.0, "episode_reward_min": 565.0, "episode_reward_mean": 959.79, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -51.0}, "policy_reward_max": {"policy_0": 333.0}, "policy_reward_mean": {"policy_0": 95.979}, "custom_metrics": {}, "hist_stats": {"episode_reward": [800.0, 748.0, 1075.0, 654.0, 640.0, 1228.0, 898.0, 989.0, 1118.0, 722.0, 1105.0, 1070.0, 976.0, 835.0, 665.0, 938.0, 1006.0, 730.0, 1210.0, 992.0, 921.0, 1282.0, 626.0, 777.0, 1002.0, 908.0, 611.0, 890.0, 667.0, 1190.0, 1050.0, 1120.0, 764.0, 762.0, 900.0, 722.0, 565.0, 949.0, 1058.0, 960.0, 680.0, 1195.0, 1240.0, 1060.0, 1334.0, 762.0, 837.0, 924.0, 1044.0, 1170.0, 1226.0, 890.0, 1120.0, 1033.0, 1089.0, 1105.0, 1043.0, 986.0, 1037.0, 1017.0, 1036.0, 797.0, 1060.0, 1070.0, 899.0, 1067.0, 1109.0, 1040.0, 863.0, 617.0, 832.0, 1075.0, 940.0, 1209.0, 900.0, 1066.0, 966.0, 904.0, 926.0, 993.0, 977.0, 1092.0, 1093.0, 1020.0, 1225.0, 1099.0, 1110.0, 1077.0, 624.0, 1222.0, 849.0, 1080.0, 980.0, 1017.0, 857.0, 840.0, 920.0, 628.0, 1004.0, 981.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 65.0, 77.0, 42.0, 16.0, 230.0, 90.0, 100.0, 100.0, 20.0, 70.0, 14.0, 140.0, 90.0, 120.0, 70.0, 34.0, 70.0, 60.0, 80.0, 58.0, 66.0, 104.0, 180.0, 90.0, 110.0, 180.0, 140.0, 77.0, 70.0, 70.0, 43.0, 87.0, 35.0, -4.0, 26.0, 259.0, -4.0, 120.0, 22.0, 70.0, 40.0, 40.0, 60.0, 30.0, 70.0, 100.0, 60.0, 90.0, 80.0, 160.0, 110.0, 160.0, 60.0, 273.0, 142.0, -5.0, 108.0, 140.0, 80.0, 84.0, 100.0, 200.0, 100.0, 50.0, 70.0, 30.0, 70.0, 44.0, 150.0, 50.0, 190.0, 70.0, 130.0, 80.0, 120.0, 59.0, 120.0, 120.0, 50.0, 120.0, 130.0, 120.0, 60.0, 80.0, 98.0, 110.0, 160.0, 160.0, 80.0, 102.0, 100.0, 60.0, 105.0, 120.0, 60.0, 50.0, -5.0, 50.0, 80.0, 70.0, 127.0, 140.0, 88.0, 80.0, 120.0, 60.0, 150.0, 140.0, 130.0, 170.0, 110.0, 130.0, 110.0, 70.0, 130.0, 80.0, 170.0, 70.0, 30.0, 160.0, 50.0, 90.0, 100.0, 70.0, 50.0, 69.0, 117.0, 170.0, 100.0, 148.0, 130.0, 70.0, 60.0, 100.0, 158.0, 39.0, 90.0, -20.0, 60.0, 60.0, 60.0, 30.0, 100.0, 17.0, 80.0, 40.0, 40.0, 80.0, 158.0, 84.0, 63.0, 160.0, 90.0, 147.0, 40.0, 118.0, 110.0, 57.0, 69.0, 100.0, -20.0, 120.0, 74.0, 190.0, 140.0, 42.0, 70.0, 130.0, 160.0, 120.0, 70.0, 70.0, -14.0, 33.0, 204.0, -5.0, 70.0, 90.0, 92.0, 100.0, 120.0, 140.0, 150.0, 120.0, 90.0, 60.0, 100.0, 210.0, 120.0, 86.0, 110.0, 106.0, 140.0, 70.0, 140.0, 150.0, 80.0, 70.0, 40.0, 90.0, 107.0, 140.0, 50.0, 100.0, 54.0, 40.0, 90.0, 90.0, 160.0, 86.0, 220.0, 160.0, 110.0, 150.0, 120.0, 106.0, 100.0, 160.0, 70.0, 90.0, 30.0, 90.0, 80.0, 99.0, 50.0, 37.0, 30.0, 100.0, 20.0, 150.0, -4.0, 120.0, 147.0, 29.0, 130.0, 80.0, 15.0, 40.0, 70.0, 90.0, 43.0, 96.0, 130.0, 170.0, 90.0, 146.0, 52.0, 76.0, 109.0, 100.0, 70.0, 60.0, 70.0, 58.0, 210.0, 130.0, 30.0, 70.0, 110.0, 66.0, 40.0, 95.0, 90.0, 50.0, 121.0, 70.0, -50.0, 30.0, 99.0, 80.0, 80.0, 20.0, 40.0, 200.0, 110.0, 50.0, 70.0, 150.0, 90.0, 90.0, 70.0, 79.0, 70.0, 10.0, 40.0, 78.0, 130.0, 50.0, 50.0, 60.0, 110.0, 120.0, 80.0, 80.0, 70.0, 140.0, 240.0, 180.0, 110.0, 110.0, 60.0, 110.0, 170.0, 80.0, 150.0, 90.0, 110.0, 20.0, 150.0, 90.0, 160.0, 230.0, 130.0, 170.0, 60.0, 70.0, 60.0, 100.0, 50.0, 110.0, 110.0, 20.0, 143.0, 140.0, 50.0, 20.0, 68.0, 110.0, -7.0, 110.0, 150.0, 30.0, 70.0, 46.0, 36.0, 40.0, 30.0, 160.0, 90.0, 150.0, 120.0, 50.0, 50.0, 110.0, 50.0, 100.0, 150.0, 50.0, 70.0, 60.0, 149.0, 50.0, 29.0, 29.0, 95.0, 30.0, 80.0, 130.0, 70.0, 20.0, 51.0, 40.0, 20.0, 70.0, 170.0, 70.0, 70.0, 14.0, 40.0, 130.0, 20.0, 80.0, 60.0, 130.0, 90.0, 89.0, 50.0, 230.0, 70.0, 140.0, 88.0, 120.0, 90.0, 50.0, 100.0, 80.0, 120.0, 200.0, 70.0, 90.0, 130.0, 86.0, 210.0, 90.0, 89.0, 36.0, 90.0, 39.0, 100.0, 80.0, 130.0, 60.0, 20.0, 80.0, 20.0, 90.0, 60.0, 50.0, 90.0, 129.0, 180.0, 80.0, 120.0, 160.0, 169.0, 140.0, 110.0, 67.0, 40.0, 60.0, 90.0, 140.0, 150.0, 100.0, 200.0, 130.0, 100.0, 160.0, 110.0, 120.0, 140.0, 110.0, 140.0, 60.0, 80.0, 100.0, 60.0, 145.0, 105.0, 170.0, 116.0, 120.0, 110.0, 240.0, 153.0, 120.0, 130.0, 41.0, 134.0, 137.0, 60.0, 100.0, 54.0, 140.0, 70.0, 70.0, 70.0, 6.0, 55.0, 130.0, -51.0, 22.0, 60.0, 28.0, 110.0, 70.0, 290.0, 98.0, 80.0, 51.0, 70.0, 47.0, 140.0, 30.0, 80.0, 130.0, 65.0, 201.0, 110.0, 90.0, 150.0, 47.0, 110.0, 100.0, 70.0, 110.0, 120.0, 160.0, 87.0, 140.0, 130.0, 170.0, 80.0, 130.0, 90.0, 110.0, 140.0, 70.0, 110.0, 110.0, 160.0, 180.0, 69.0, 120.0, 110.0, 110.0, 137.0, 180.0, 50.0, 60.0, 80.0, 70.0, 110.0, 90.0, 50.0, 170.0, 60.0, 140.0, 60.0, 110.0, 150.0, 70.0, 150.0, 80.0, 50.0, 150.0, 110.0, 140.0, 110.0, 60.0, 220.0, 140.0, 150.0, 90.0, 113.0, 64.0, -30.0, 86.0, 140.0, 70.0, 40.0, 100.0, 130.0, 90.0, 150.0, 130.0, 59.0, 140.0, 180.0, 106.0, 68.0, 41.0, 90.0, 160.0, 120.0, 140.0, 140.0, 150.0, 90.0, 50.0, 73.0, 120.0, 140.0, 50.0, 210.0, 100.0, 30.0, 170.0, 100.0, 40.0, 176.0, 120.0, 230.0, 70.0, 55.0, 50.0, 95.0, 100.0, 50.0, 70.0, 59.0, 120.0, 86.0, 80.0, 129.0, 210.0, 53.0, 110.0, 120.0, 150.0, 160.0, 100.0, 90.0, 150.0, 78.0, 140.0, 30.0, 59.0, 60.0, 114.0, 188.0, 100.0, 77.0, 98.0, 110.0, 108.0, 35.0, 90.0, 116.0, 60.0, 40.0, 48.0, 130.0, 150.0, 200.0, 30.0, 29.0, 60.0, 50.0, 40.0, 130.0, 70.0, 150.0, 60.0, 80.0, 130.0, 130.0, 160.0, 110.0, 70.0, 100.0, 140.0, 100.0, 130.0, 110.0, 80.0, 140.0, 110.0, 90.0, 90.0, 140.0, 40.0, 90.0, 69.0, 70.0, 80.0, 190.0, 70.0, 60.0, 80.0, 150.0, 50.0, 140.0, 80.0, 54.0, 130.0, 83.0, 130.0, 170.0, 170.0, 50.0, 36.0, 80.0, 128.0, 67.0, 140.0, 118.0, 80.0, 240.0, 80.0, 40.0, 120.0, 50.0, 110.0, 60.0, 220.0, 70.0, 240.0, 50.0, 60.0, 100.0, 56.0, 140.0, 73.0, 50.0, 70.0, 130.0, 64.0, 120.0, 20.0, 10.0, 61.0, 70.0, 66.0, 185.0, 74.0, 36.0, 30.0, 65.0, 38.0, 150.0, 120.0, 20.0, 50.0, 80.0, 120.0, 140.0, 49.0, 65.0, 120.0, 50.0, 60.0, 130.0, 190.0, 60.0, 210.0, 100.0, 75.0, 80.0, 40.0, 20.0, 110.0, 150.0, 120.0, 130.0, 30.0, 200.0, 60.0, 80.0, 200.0, 120.0, 78.0, 160.0, 130.0, 130.0, 160.0, 101.0, 120.0, 10.0, 60.0, 60.0, 190.0, 110.0, 100.0, 90.0, 90.0, 50.0, 90.0, 60.0, 160.0, 140.0, 46.0, 110.0, 150.0, 30.0, 150.0, 70.0, 100.0, 110.0, 70.0, 100.0, 110.0, 126.0, 70.0, 87.0, 146.0, 80.0, 68.0, 109.0, 70.0, 130.0, 90.0, 117.0, 130.0, 30.0, 70.0, 47.0, 80.0, 140.0, 100.0, 90.0, 103.0, 140.0, 130.0, 90.0, 90.0, 60.0, 100.0, 23.0, 110.0, 130.0, 63.0, 30.0, 90.0, 130.0, 150.0, 70.0, 30.0, 190.0, 68.0, 180.0, 79.0, 62.0, 55.0, 53.0, 70.0, 80.0, 140.0, 190.0, 171.0, 180.0, 42.0, 80.0, 100.0, 130.0, 160.0, 114.0, 100.0, 15.0, 140.0, 100.0, 110.0, 130.0, 70.0, 150.0, 100.0, 67.0, 170.0, 56.0, 110.0, 50.0, 160.0, 100.0, 140.0, 40.0, 110.0, 100.0, 160.0, 50.0, 80.0, 160.0, 200.0, 49.0, 86.0, 250.0, 110.0, 90.0, 50.0, 150.0, 110.0, 130.0, 16.0, 70.0, 56.0, 110.0, 108.0, 130.0, 219.0, 150.0, 140.0, 100.0, 110.0, 160.0, 210.0, 110.0, 20.0, 80.0, 90.0, 90.0, 140.0, 110.0, 40.0, 215.0, 87.0, 170.0, 30.0, 150.0, 49.0, 86.0, 70.0, 32.0, 130.0, 50.0, 70.0, 80.0, 62.0, 90.0, 10.0, 30.0, 333.0, 90.0, 190.0, 200.0, 54.0, 59.0, 50.0, 130.0, 46.0, 70.0, 50.0, 180.0, 10.0, 110.0, 140.0, 90.0, 54.0, 90.0, 90.0, 35.0, 140.0, 80.0, 70.0, 80.0, 160.0, 120.0, 120.0, 120.0, 130.0, 60.0, 90.0, 80.0, 80.0, 160.0, 256.0, 60.0, 84.0, 40.0, 70.0, 60.0, 114.0, 130.0, 90.0, 80.0, 73.0, 180.0, 90.0, 170.0, 30.0, 60.0, 120.0, 80.0, 60.0, 80.0, 40.0, 109.0, 68.0, 80.0, 110.0, 110.0, 170.0, 100.0, 70.0, 100.0, 30.0, 40.0, 110.0, 40.0, 130.0, 50.0, 80.0, 150.0, 110.0, 80.0, 140.0, 30.0, 100.0, 40.0, 60.0, 130.0, 35.0, 40.0, 100.0, 151.0, 39.0, 90.0, 53.0, 60.0, 70.0, -10.0, 170.0, 100.0, 70.0, 30.0, 100.0, 150.0, 127.0, 80.0, 77.0, 100.0, 180.0, 10.0, 110.0, 130.0, 49.0, 62.0, 100.0, 110.0, 140.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9231762998517565, "mean_inference_ms": 1.9498368401511903, "mean_action_processing_ms": 0.5735228086988416, "mean_env_wait_ms": 1.3100611980237944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012614965438842773, "StateBufferConnector_ms": 0.009088754653930664, "ViewRequirementAgentConnector_ms": 0.373215913772583}, "num_episodes": 23, "episode_return_max": 1334.0, "episode_return_min": 565.0, "episode_return_mean": 959.79}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.767651416439758, "num_env_steps_trained_throughput_per_sec": 20.767651416439758, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 193894.378, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193894.332, "sample_time_ms": 2332.907, "learn_time_ms": 191542.083, "learn_throughput": 20.883, "synch_weights_time_ms": 11.432}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 58, "trial_id": "1841f_00000", "date": "2024-08-08_02-50-10", "timestamp": 1723099810, "time_this_iter_s": 192.6175012588501, "time_total_s": 12594.8665497303, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3372790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12594.8665497303, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.34395604395604, "ram_util_percent": 76.0135531135531}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.06031274916138, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.286053938606676, "policy_loss": -0.012613928974400293, "vf_loss": 8.297144495006313, "vf_explained_var": -0.006498539695343651, "kl": 0.007616865645900382, "entropy": 0.5514599130176507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 549315.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "env_runners": {"episode_reward_max": 1334.0, "episode_reward_min": 452.0, "episode_reward_mean": 970.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -51.0}, "policy_reward_max": {"policy_0": 333.0}, "policy_reward_mean": {"policy_0": 97.06}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1210.0, 992.0, 921.0, 1282.0, 626.0, 777.0, 1002.0, 908.0, 611.0, 890.0, 667.0, 1190.0, 1050.0, 1120.0, 764.0, 762.0, 900.0, 722.0, 565.0, 949.0, 1058.0, 960.0, 680.0, 1195.0, 1240.0, 1060.0, 1334.0, 762.0, 837.0, 924.0, 1044.0, 1170.0, 1226.0, 890.0, 1120.0, 1033.0, 1089.0, 1105.0, 1043.0, 986.0, 1037.0, 1017.0, 1036.0, 797.0, 1060.0, 1070.0, 899.0, 1067.0, 1109.0, 1040.0, 863.0, 617.0, 832.0, 1075.0, 940.0, 1209.0, 900.0, 1066.0, 966.0, 904.0, 926.0, 993.0, 977.0, 1092.0, 1093.0, 1020.0, 1225.0, 1099.0, 1110.0, 1077.0, 624.0, 1222.0, 849.0, 1080.0, 980.0, 1017.0, 857.0, 840.0, 920.0, 628.0, 1004.0, 981.0, 1269.0, 700.0, 706.0, 1000.0, 970.0, 957.0, 769.0, 452.0, 1166.0, 770.0, 1152.0, 1070.0, 1205.0, 732.0, 918.0, 1101.0, 1080.0, 1261.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 120.0, 140.0, 150.0, 120.0, 90.0, 60.0, 100.0, 210.0, 120.0, 86.0, 110.0, 106.0, 140.0, 70.0, 140.0, 150.0, 80.0, 70.0, 40.0, 90.0, 107.0, 140.0, 50.0, 100.0, 54.0, 40.0, 90.0, 90.0, 160.0, 86.0, 220.0, 160.0, 110.0, 150.0, 120.0, 106.0, 100.0, 160.0, 70.0, 90.0, 30.0, 90.0, 80.0, 99.0, 50.0, 37.0, 30.0, 100.0, 20.0, 150.0, -4.0, 120.0, 147.0, 29.0, 130.0, 80.0, 15.0, 40.0, 70.0, 90.0, 43.0, 96.0, 130.0, 170.0, 90.0, 146.0, 52.0, 76.0, 109.0, 100.0, 70.0, 60.0, 70.0, 58.0, 210.0, 130.0, 30.0, 70.0, 110.0, 66.0, 40.0, 95.0, 90.0, 50.0, 121.0, 70.0, -50.0, 30.0, 99.0, 80.0, 80.0, 20.0, 40.0, 200.0, 110.0, 50.0, 70.0, 150.0, 90.0, 90.0, 70.0, 79.0, 70.0, 10.0, 40.0, 78.0, 130.0, 50.0, 50.0, 60.0, 110.0, 120.0, 80.0, 80.0, 70.0, 140.0, 240.0, 180.0, 110.0, 110.0, 60.0, 110.0, 170.0, 80.0, 150.0, 90.0, 110.0, 20.0, 150.0, 90.0, 160.0, 230.0, 130.0, 170.0, 60.0, 70.0, 60.0, 100.0, 50.0, 110.0, 110.0, 20.0, 143.0, 140.0, 50.0, 20.0, 68.0, 110.0, -7.0, 110.0, 150.0, 30.0, 70.0, 46.0, 36.0, 40.0, 30.0, 160.0, 90.0, 150.0, 120.0, 50.0, 50.0, 110.0, 50.0, 100.0, 150.0, 50.0, 70.0, 60.0, 149.0, 50.0, 29.0, 29.0, 95.0, 30.0, 80.0, 130.0, 70.0, 20.0, 51.0, 40.0, 20.0, 70.0, 170.0, 70.0, 70.0, 14.0, 40.0, 130.0, 20.0, 80.0, 60.0, 130.0, 90.0, 89.0, 50.0, 230.0, 70.0, 140.0, 88.0, 120.0, 90.0, 50.0, 100.0, 80.0, 120.0, 200.0, 70.0, 90.0, 130.0, 86.0, 210.0, 90.0, 89.0, 36.0, 90.0, 39.0, 100.0, 80.0, 130.0, 60.0, 20.0, 80.0, 20.0, 90.0, 60.0, 50.0, 90.0, 129.0, 180.0, 80.0, 120.0, 160.0, 169.0, 140.0, 110.0, 67.0, 40.0, 60.0, 90.0, 140.0, 150.0, 100.0, 200.0, 130.0, 100.0, 160.0, 110.0, 120.0, 140.0, 110.0, 140.0, 60.0, 80.0, 100.0, 60.0, 145.0, 105.0, 170.0, 116.0, 120.0, 110.0, 240.0, 153.0, 120.0, 130.0, 41.0, 134.0, 137.0, 60.0, 100.0, 54.0, 140.0, 70.0, 70.0, 70.0, 6.0, 55.0, 130.0, -51.0, 22.0, 60.0, 28.0, 110.0, 70.0, 290.0, 98.0, 80.0, 51.0, 70.0, 47.0, 140.0, 30.0, 80.0, 130.0, 65.0, 201.0, 110.0, 90.0, 150.0, 47.0, 110.0, 100.0, 70.0, 110.0, 120.0, 160.0, 87.0, 140.0, 130.0, 170.0, 80.0, 130.0, 90.0, 110.0, 140.0, 70.0, 110.0, 110.0, 160.0, 180.0, 69.0, 120.0, 110.0, 110.0, 137.0, 180.0, 50.0, 60.0, 80.0, 70.0, 110.0, 90.0, 50.0, 170.0, 60.0, 140.0, 60.0, 110.0, 150.0, 70.0, 150.0, 80.0, 50.0, 150.0, 110.0, 140.0, 110.0, 60.0, 220.0, 140.0, 150.0, 90.0, 113.0, 64.0, -30.0, 86.0, 140.0, 70.0, 40.0, 100.0, 130.0, 90.0, 150.0, 130.0, 59.0, 140.0, 180.0, 106.0, 68.0, 41.0, 90.0, 160.0, 120.0, 140.0, 140.0, 150.0, 90.0, 50.0, 73.0, 120.0, 140.0, 50.0, 210.0, 100.0, 30.0, 170.0, 100.0, 40.0, 176.0, 120.0, 230.0, 70.0, 55.0, 50.0, 95.0, 100.0, 50.0, 70.0, 59.0, 120.0, 86.0, 80.0, 129.0, 210.0, 53.0, 110.0, 120.0, 150.0, 160.0, 100.0, 90.0, 150.0, 78.0, 140.0, 30.0, 59.0, 60.0, 114.0, 188.0, 100.0, 77.0, 98.0, 110.0, 108.0, 35.0, 90.0, 116.0, 60.0, 40.0, 48.0, 130.0, 150.0, 200.0, 30.0, 29.0, 60.0, 50.0, 40.0, 130.0, 70.0, 150.0, 60.0, 80.0, 130.0, 130.0, 160.0, 110.0, 70.0, 100.0, 140.0, 100.0, 130.0, 110.0, 80.0, 140.0, 110.0, 90.0, 90.0, 140.0, 40.0, 90.0, 69.0, 70.0, 80.0, 190.0, 70.0, 60.0, 80.0, 150.0, 50.0, 140.0, 80.0, 54.0, 130.0, 83.0, 130.0, 170.0, 170.0, 50.0, 36.0, 80.0, 128.0, 67.0, 140.0, 118.0, 80.0, 240.0, 80.0, 40.0, 120.0, 50.0, 110.0, 60.0, 220.0, 70.0, 240.0, 50.0, 60.0, 100.0, 56.0, 140.0, 73.0, 50.0, 70.0, 130.0, 64.0, 120.0, 20.0, 10.0, 61.0, 70.0, 66.0, 185.0, 74.0, 36.0, 30.0, 65.0, 38.0, 150.0, 120.0, 20.0, 50.0, 80.0, 120.0, 140.0, 49.0, 65.0, 120.0, 50.0, 60.0, 130.0, 190.0, 60.0, 210.0, 100.0, 75.0, 80.0, 40.0, 20.0, 110.0, 150.0, 120.0, 130.0, 30.0, 200.0, 60.0, 80.0, 200.0, 120.0, 78.0, 160.0, 130.0, 130.0, 160.0, 101.0, 120.0, 10.0, 60.0, 60.0, 190.0, 110.0, 100.0, 90.0, 90.0, 50.0, 90.0, 60.0, 160.0, 140.0, 46.0, 110.0, 150.0, 30.0, 150.0, 70.0, 100.0, 110.0, 70.0, 100.0, 110.0, 126.0, 70.0, 87.0, 146.0, 80.0, 68.0, 109.0, 70.0, 130.0, 90.0, 117.0, 130.0, 30.0, 70.0, 47.0, 80.0, 140.0, 100.0, 90.0, 103.0, 140.0, 130.0, 90.0, 90.0, 60.0, 100.0, 23.0, 110.0, 130.0, 63.0, 30.0, 90.0, 130.0, 150.0, 70.0, 30.0, 190.0, 68.0, 180.0, 79.0, 62.0, 55.0, 53.0, 70.0, 80.0, 140.0, 190.0, 171.0, 180.0, 42.0, 80.0, 100.0, 130.0, 160.0, 114.0, 100.0, 15.0, 140.0, 100.0, 110.0, 130.0, 70.0, 150.0, 100.0, 67.0, 170.0, 56.0, 110.0, 50.0, 160.0, 100.0, 140.0, 40.0, 110.0, 100.0, 160.0, 50.0, 80.0, 160.0, 200.0, 49.0, 86.0, 250.0, 110.0, 90.0, 50.0, 150.0, 110.0, 130.0, 16.0, 70.0, 56.0, 110.0, 108.0, 130.0, 219.0, 150.0, 140.0, 100.0, 110.0, 160.0, 210.0, 110.0, 20.0, 80.0, 90.0, 90.0, 140.0, 110.0, 40.0, 215.0, 87.0, 170.0, 30.0, 150.0, 49.0, 86.0, 70.0, 32.0, 130.0, 50.0, 70.0, 80.0, 62.0, 90.0, 10.0, 30.0, 333.0, 90.0, 190.0, 200.0, 54.0, 59.0, 50.0, 130.0, 46.0, 70.0, 50.0, 180.0, 10.0, 110.0, 140.0, 90.0, 54.0, 90.0, 90.0, 35.0, 140.0, 80.0, 70.0, 80.0, 160.0, 120.0, 120.0, 120.0, 130.0, 60.0, 90.0, 80.0, 80.0, 160.0, 256.0, 60.0, 84.0, 40.0, 70.0, 60.0, 114.0, 130.0, 90.0, 80.0, 73.0, 180.0, 90.0, 170.0, 30.0, 60.0, 120.0, 80.0, 60.0, 80.0, 40.0, 109.0, 68.0, 80.0, 110.0, 110.0, 170.0, 100.0, 70.0, 100.0, 30.0, 40.0, 110.0, 40.0, 130.0, 50.0, 80.0, 150.0, 110.0, 80.0, 140.0, 30.0, 100.0, 40.0, 60.0, 130.0, 35.0, 40.0, 100.0, 151.0, 39.0, 90.0, 53.0, 60.0, 70.0, -10.0, 170.0, 100.0, 70.0, 30.0, 100.0, 150.0, 127.0, 80.0, 77.0, 100.0, 180.0, 10.0, 110.0, 130.0, 49.0, 62.0, 100.0, 110.0, 140.0, 90.0, 60.0, 50.0, 160.0, 230.0, 165.0, 80.0, 50.0, 120.0, 170.0, 184.0, 40.0, 100.0, 60.0, 60.0, 20.0, 80.0, 100.0, 120.0, 90.0, 30.0, 25.0, 210.0, 52.0, 80.0, 40.0, 80.0, 20.0, 50.0, 60.0, 89.0, 130.0, 140.0, 60.0, 50.0, 100.0, 100.0, 50.0, 90.0, 120.0, 160.0, 70.0, 40.0, 90.0, 110.0, 50.0, 90.0, 100.0, 140.0, 170.0, 110.0, 70.0, 79.0, 80.0, 190.0, 80.0, 100.0, 98.0, 30.0, 150.0, 80.0, 50.0, 80.0, 40.0, 130.0, 89.0, 36.0, 120.0, 31.0, 130.0, 63.0, 10.0, 130.0, 22.0, 50.0, -15.0, 42.0, 103.0, 90.0, 34.0, -14.0, 90.0, 140.0, 110.0, 80.0, 310.0, 40.0, 80.0, 130.0, 126.0, 60.0, 140.0, 80.0, 100.0, 40.0, 93.0, 89.0, 29.0, 49.0, 80.0, 70.0, 130.0, 70.0, 100.0, 68.0, 75.0, 40.0, 180.0, 180.0, 239.0, 70.0, 27.0, 68.0, 160.0, 140.0, 120.0, 68.0, 100.0, 127.0, 130.0, 130.0, 120.0, 80.0, 110.0, 110.0, 40.0, 170.0, 75.0, 80.0, 270.0, 150.0, 60.0, 60.0, 69.0, 110.0, 150.0, 18.0, 93.0, 12.0, 100.0, 60.0, 100.0, 100.0, 70.0, 90.0, 155.0, 60.0, 110.0, 43.0, 100.0, 90.0, 130.0, 70.0, 166.0, 130.0, 120.0, 80.0, 100.0, 5.0, 160.0, 140.0, 150.0, 60.0, 90.0, 50.0, 150.0, 80.0, 120.0, 100.0, 160.0, 120.0, 180.0, 65.0, 11.0, 130.0, 190.0, 250.0, 220.0, 69.0, -4.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.915002511722453, "mean_inference_ms": 1.9412276069643355, "mean_action_processing_ms": 0.5712599977768054, "mean_env_wait_ms": 1.3047918598956307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012569189071655273, "StateBufferConnector_ms": 0.009137868881225586, "ViewRequirementAgentConnector_ms": 0.37551236152648926}, "num_episodes": 18, "episode_return_max": 1334.0, "episode_return_min": 452.0, "episode_return_mean": 970.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.78306851308303, "num_env_steps_trained_throughput_per_sec": 20.78306851308303, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 2360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2360000, "timers": {"training_iteration_time_ms": 193612.68, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193612.633, "sample_time_ms": 2294.913, "learn_time_ms": 191298.12, "learn_throughput": 20.91, "synch_weights_time_ms": 11.361}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "done": false, "training_iteration": 59, "trial_id": "1841f_00000", "date": "2024-08-08_02-53-23", "timestamp": 1723100003, "time_this_iter_s": 192.47652792930603, "time_total_s": 12787.343077659607, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33721f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12787.343077659607, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 16.947426470588233, "ram_util_percent": 76.48566176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.069037014207901, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.215422206641005, "policy_loss": -0.011827782019652937, "vf_loss": 8.225810655313559, "vf_explained_var": -0.015344268051834024, "kl": 0.007196670580271754, "entropy": 0.5597263667212762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 558705.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 1334.0, "episode_reward_min": 452.0, "episode_reward_mean": 968.38, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -51.0}, "policy_reward_max": {"policy_0": 333.0}, "policy_reward_mean": {"policy_0": 96.838}, "custom_metrics": {}, "hist_stats": {"episode_reward": [565.0, 949.0, 1058.0, 960.0, 680.0, 1195.0, 1240.0, 1060.0, 1334.0, 762.0, 837.0, 924.0, 1044.0, 1170.0, 1226.0, 890.0, 1120.0, 1033.0, 1089.0, 1105.0, 1043.0, 986.0, 1037.0, 1017.0, 1036.0, 797.0, 1060.0, 1070.0, 899.0, 1067.0, 1109.0, 1040.0, 863.0, 617.0, 832.0, 1075.0, 940.0, 1209.0, 900.0, 1066.0, 966.0, 904.0, 926.0, 993.0, 977.0, 1092.0, 1093.0, 1020.0, 1225.0, 1099.0, 1110.0, 1077.0, 624.0, 1222.0, 849.0, 1080.0, 980.0, 1017.0, 857.0, 840.0, 920.0, 628.0, 1004.0, 981.0, 1269.0, 700.0, 706.0, 1000.0, 970.0, 957.0, 769.0, 452.0, 1166.0, 770.0, 1152.0, 1070.0, 1205.0, 732.0, 918.0, 1101.0, 1080.0, 1261.0, 1013.0, 1190.0, 975.0, 1129.0, 714.0, 639.0, 732.0, 713.0, 879.0, 601.0, 902.0, 800.0, 1168.0, 899.0, 795.0, 1060.0, 1033.0, 930.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 51.0, 40.0, 20.0, 70.0, 170.0, 70.0, 70.0, 14.0, 40.0, 130.0, 20.0, 80.0, 60.0, 130.0, 90.0, 89.0, 50.0, 230.0, 70.0, 140.0, 88.0, 120.0, 90.0, 50.0, 100.0, 80.0, 120.0, 200.0, 70.0, 90.0, 130.0, 86.0, 210.0, 90.0, 89.0, 36.0, 90.0, 39.0, 100.0, 80.0, 130.0, 60.0, 20.0, 80.0, 20.0, 90.0, 60.0, 50.0, 90.0, 129.0, 180.0, 80.0, 120.0, 160.0, 169.0, 140.0, 110.0, 67.0, 40.0, 60.0, 90.0, 140.0, 150.0, 100.0, 200.0, 130.0, 100.0, 160.0, 110.0, 120.0, 140.0, 110.0, 140.0, 60.0, 80.0, 100.0, 60.0, 145.0, 105.0, 170.0, 116.0, 120.0, 110.0, 240.0, 153.0, 120.0, 130.0, 41.0, 134.0, 137.0, 60.0, 100.0, 54.0, 140.0, 70.0, 70.0, 70.0, 6.0, 55.0, 130.0, -51.0, 22.0, 60.0, 28.0, 110.0, 70.0, 290.0, 98.0, 80.0, 51.0, 70.0, 47.0, 140.0, 30.0, 80.0, 130.0, 65.0, 201.0, 110.0, 90.0, 150.0, 47.0, 110.0, 100.0, 70.0, 110.0, 120.0, 160.0, 87.0, 140.0, 130.0, 170.0, 80.0, 130.0, 90.0, 110.0, 140.0, 70.0, 110.0, 110.0, 160.0, 180.0, 69.0, 120.0, 110.0, 110.0, 137.0, 180.0, 50.0, 60.0, 80.0, 70.0, 110.0, 90.0, 50.0, 170.0, 60.0, 140.0, 60.0, 110.0, 150.0, 70.0, 150.0, 80.0, 50.0, 150.0, 110.0, 140.0, 110.0, 60.0, 220.0, 140.0, 150.0, 90.0, 113.0, 64.0, -30.0, 86.0, 140.0, 70.0, 40.0, 100.0, 130.0, 90.0, 150.0, 130.0, 59.0, 140.0, 180.0, 106.0, 68.0, 41.0, 90.0, 160.0, 120.0, 140.0, 140.0, 150.0, 90.0, 50.0, 73.0, 120.0, 140.0, 50.0, 210.0, 100.0, 30.0, 170.0, 100.0, 40.0, 176.0, 120.0, 230.0, 70.0, 55.0, 50.0, 95.0, 100.0, 50.0, 70.0, 59.0, 120.0, 86.0, 80.0, 129.0, 210.0, 53.0, 110.0, 120.0, 150.0, 160.0, 100.0, 90.0, 150.0, 78.0, 140.0, 30.0, 59.0, 60.0, 114.0, 188.0, 100.0, 77.0, 98.0, 110.0, 108.0, 35.0, 90.0, 116.0, 60.0, 40.0, 48.0, 130.0, 150.0, 200.0, 30.0, 29.0, 60.0, 50.0, 40.0, 130.0, 70.0, 150.0, 60.0, 80.0, 130.0, 130.0, 160.0, 110.0, 70.0, 100.0, 140.0, 100.0, 130.0, 110.0, 80.0, 140.0, 110.0, 90.0, 90.0, 140.0, 40.0, 90.0, 69.0, 70.0, 80.0, 190.0, 70.0, 60.0, 80.0, 150.0, 50.0, 140.0, 80.0, 54.0, 130.0, 83.0, 130.0, 170.0, 170.0, 50.0, 36.0, 80.0, 128.0, 67.0, 140.0, 118.0, 80.0, 240.0, 80.0, 40.0, 120.0, 50.0, 110.0, 60.0, 220.0, 70.0, 240.0, 50.0, 60.0, 100.0, 56.0, 140.0, 73.0, 50.0, 70.0, 130.0, 64.0, 120.0, 20.0, 10.0, 61.0, 70.0, 66.0, 185.0, 74.0, 36.0, 30.0, 65.0, 38.0, 150.0, 120.0, 20.0, 50.0, 80.0, 120.0, 140.0, 49.0, 65.0, 120.0, 50.0, 60.0, 130.0, 190.0, 60.0, 210.0, 100.0, 75.0, 80.0, 40.0, 20.0, 110.0, 150.0, 120.0, 130.0, 30.0, 200.0, 60.0, 80.0, 200.0, 120.0, 78.0, 160.0, 130.0, 130.0, 160.0, 101.0, 120.0, 10.0, 60.0, 60.0, 190.0, 110.0, 100.0, 90.0, 90.0, 50.0, 90.0, 60.0, 160.0, 140.0, 46.0, 110.0, 150.0, 30.0, 150.0, 70.0, 100.0, 110.0, 70.0, 100.0, 110.0, 126.0, 70.0, 87.0, 146.0, 80.0, 68.0, 109.0, 70.0, 130.0, 90.0, 117.0, 130.0, 30.0, 70.0, 47.0, 80.0, 140.0, 100.0, 90.0, 103.0, 140.0, 130.0, 90.0, 90.0, 60.0, 100.0, 23.0, 110.0, 130.0, 63.0, 30.0, 90.0, 130.0, 150.0, 70.0, 30.0, 190.0, 68.0, 180.0, 79.0, 62.0, 55.0, 53.0, 70.0, 80.0, 140.0, 190.0, 171.0, 180.0, 42.0, 80.0, 100.0, 130.0, 160.0, 114.0, 100.0, 15.0, 140.0, 100.0, 110.0, 130.0, 70.0, 150.0, 100.0, 67.0, 170.0, 56.0, 110.0, 50.0, 160.0, 100.0, 140.0, 40.0, 110.0, 100.0, 160.0, 50.0, 80.0, 160.0, 200.0, 49.0, 86.0, 250.0, 110.0, 90.0, 50.0, 150.0, 110.0, 130.0, 16.0, 70.0, 56.0, 110.0, 108.0, 130.0, 219.0, 150.0, 140.0, 100.0, 110.0, 160.0, 210.0, 110.0, 20.0, 80.0, 90.0, 90.0, 140.0, 110.0, 40.0, 215.0, 87.0, 170.0, 30.0, 150.0, 49.0, 86.0, 70.0, 32.0, 130.0, 50.0, 70.0, 80.0, 62.0, 90.0, 10.0, 30.0, 333.0, 90.0, 190.0, 200.0, 54.0, 59.0, 50.0, 130.0, 46.0, 70.0, 50.0, 180.0, 10.0, 110.0, 140.0, 90.0, 54.0, 90.0, 90.0, 35.0, 140.0, 80.0, 70.0, 80.0, 160.0, 120.0, 120.0, 120.0, 130.0, 60.0, 90.0, 80.0, 80.0, 160.0, 256.0, 60.0, 84.0, 40.0, 70.0, 60.0, 114.0, 130.0, 90.0, 80.0, 73.0, 180.0, 90.0, 170.0, 30.0, 60.0, 120.0, 80.0, 60.0, 80.0, 40.0, 109.0, 68.0, 80.0, 110.0, 110.0, 170.0, 100.0, 70.0, 100.0, 30.0, 40.0, 110.0, 40.0, 130.0, 50.0, 80.0, 150.0, 110.0, 80.0, 140.0, 30.0, 100.0, 40.0, 60.0, 130.0, 35.0, 40.0, 100.0, 151.0, 39.0, 90.0, 53.0, 60.0, 70.0, -10.0, 170.0, 100.0, 70.0, 30.0, 100.0, 150.0, 127.0, 80.0, 77.0, 100.0, 180.0, 10.0, 110.0, 130.0, 49.0, 62.0, 100.0, 110.0, 140.0, 90.0, 60.0, 50.0, 160.0, 230.0, 165.0, 80.0, 50.0, 120.0, 170.0, 184.0, 40.0, 100.0, 60.0, 60.0, 20.0, 80.0, 100.0, 120.0, 90.0, 30.0, 25.0, 210.0, 52.0, 80.0, 40.0, 80.0, 20.0, 50.0, 60.0, 89.0, 130.0, 140.0, 60.0, 50.0, 100.0, 100.0, 50.0, 90.0, 120.0, 160.0, 70.0, 40.0, 90.0, 110.0, 50.0, 90.0, 100.0, 140.0, 170.0, 110.0, 70.0, 79.0, 80.0, 190.0, 80.0, 100.0, 98.0, 30.0, 150.0, 80.0, 50.0, 80.0, 40.0, 130.0, 89.0, 36.0, 120.0, 31.0, 130.0, 63.0, 10.0, 130.0, 22.0, 50.0, -15.0, 42.0, 103.0, 90.0, 34.0, -14.0, 90.0, 140.0, 110.0, 80.0, 310.0, 40.0, 80.0, 130.0, 126.0, 60.0, 140.0, 80.0, 100.0, 40.0, 93.0, 89.0, 29.0, 49.0, 80.0, 70.0, 130.0, 70.0, 100.0, 68.0, 75.0, 40.0, 180.0, 180.0, 239.0, 70.0, 27.0, 68.0, 160.0, 140.0, 120.0, 68.0, 100.0, 127.0, 130.0, 130.0, 120.0, 80.0, 110.0, 110.0, 40.0, 170.0, 75.0, 80.0, 270.0, 150.0, 60.0, 60.0, 69.0, 110.0, 150.0, 18.0, 93.0, 12.0, 100.0, 60.0, 100.0, 100.0, 70.0, 90.0, 155.0, 60.0, 110.0, 43.0, 100.0, 90.0, 130.0, 70.0, 166.0, 130.0, 120.0, 80.0, 100.0, 5.0, 160.0, 140.0, 150.0, 60.0, 90.0, 50.0, 150.0, 80.0, 120.0, 100.0, 160.0, 120.0, 180.0, 65.0, 11.0, 130.0, 190.0, 250.0, 220.0, 69.0, -4.0, 150.0, 79.0, 90.0, 80.0, 260.0, 80.0, 100.0, 60.0, 34.0, 80.0, 150.0, 60.0, 230.0, 170.0, 110.0, 60.0, 130.0, 150.0, 90.0, 150.0, 40.0, 60.0, 65.0, 110.0, 70.0, 50.0, 100.0, 170.0, 60.0, 70.0, 220.0, 170.0, 69.0, 100.0, 140.0, 150.0, 130.0, 50.0, 140.0, 140.0, 40.0, 80.0, 60.0, 60.0, 50.0, 16.0, 32.0, 70.0, 106.0, 110.0, 130.0, 80.0, 47.0, 6.0, 60.0, 140.0, 99.0, 60.0, 77.0, 60.0, 10.0, 27.0, 36.0, 47.0, 70.0, 70.0, 130.0, 72.0, 120.0, 100.0, 60.0, 110.0, 60.0, 27.0, 130.0, 60.0, -4.0, 130.0, 80.0, 80.0, 40.0, 50.0, 130.0, 60.0, 50.0, 140.0, 130.0, 140.0, -41.0, 110.0, 110.0, 100.0, 6.0, 80.0, 49.0, 110.0, 50.0, 80.0, 16.0, 50.0, 60.0, 170.0, 66.0, 46.0, 40.0, 150.0, 95.0, 60.0, 180.0, 45.0, 50.0, 100.0, 0.0, 230.0, 120.0, 0.0, 130.0, 70.0, 80.0, 70.0, 0.0, 100.0, 140.0, 110.0, 138.0, 140.0, 120.0, 110.0, 130.0, 60.0, 120.0, 50.0, 170.0, 50.0, 71.0, 70.0, 150.0, 38.0, 100.0, 90.0, 110.0, 130.0, 70.0, 60.0, 90.0, 70.0, 70.0, 70.0, 100.0, 55.0, 80.0, 120.0, 100.0, 90.0, 170.0, 40.0, 120.0, 70.0, 130.0, 70.0, 150.0, 140.0, 40.0, 110.0, 90.0, 7.0, 150.0, 130.0, 170.0, 26.0, 170.0, 130.0, 70.0, 50.0, 70.0, 80.0, 150.0, 100.0, 130.0, 80.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9069267728075407, "mean_inference_ms": 1.9328386217598166, "mean_action_processing_ms": 0.5691045406223612, "mean_env_wait_ms": 1.2997594321486414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012601852416992188, "StateBufferConnector_ms": 0.0091705322265625, "ViewRequirementAgentConnector_ms": 0.37772083282470703}, "num_episodes": 18, "episode_return_max": 1334.0, "episode_return_min": 452.0, "episode_return_mean": 968.38}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.863320343180973, "num_env_steps_trained_throughput_per_sec": 20.863320343180973, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 193408.721, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193408.675, "sample_time_ms": 2259.879, "learn_time_ms": 191129.101, "learn_throughput": 20.928, "synch_weights_time_ms": 11.298}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 60, "trial_id": "1841f_00000", "date": "2024-08-08_02-56-34", "timestamp": 1723100194, "time_this_iter_s": 191.7327058315277, "time_total_s": 12979.075783491135, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3372c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12979.075783491135, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 16.85166051660517, "ram_util_percent": 76.22509225092251}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.986903225677336, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.362589915847373, "policy_loss": -0.011885596576163643, "vf_loss": 8.372970822063117, "vf_explained_var": -0.010306366094258139, "kl": 0.007523431943341308, "entropy": 0.5496384399640547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 568095.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "env_runners": {"episode_reward_max": 1340.0, "episode_reward_min": 389.0, "episode_reward_mean": 938.74, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -84.0}, "policy_reward_max": {"policy_0": 333.0}, "policy_reward_mean": {"policy_0": 93.874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1037.0, 1017.0, 1036.0, 797.0, 1060.0, 1070.0, 899.0, 1067.0, 1109.0, 1040.0, 863.0, 617.0, 832.0, 1075.0, 940.0, 1209.0, 900.0, 1066.0, 966.0, 904.0, 926.0, 993.0, 977.0, 1092.0, 1093.0, 1020.0, 1225.0, 1099.0, 1110.0, 1077.0, 624.0, 1222.0, 849.0, 1080.0, 980.0, 1017.0, 857.0, 840.0, 920.0, 628.0, 1004.0, 981.0, 1269.0, 700.0, 706.0, 1000.0, 970.0, 957.0, 769.0, 452.0, 1166.0, 770.0, 1152.0, 1070.0, 1205.0, 732.0, 918.0, 1101.0, 1080.0, 1261.0, 1013.0, 1190.0, 975.0, 1129.0, 714.0, 639.0, 732.0, 713.0, 879.0, 601.0, 902.0, 800.0, 1168.0, 899.0, 795.0, 1060.0, 1033.0, 930.0, 627.0, 1340.0, 1093.0, 857.0, 769.0, 865.0, 389.0, 1005.0, 519.0, 970.0, 800.0, 1224.0, 777.0, 808.0, 941.0, 1103.0, 722.0, 1117.0, 830.0, 728.0, 730.0, 1092.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 59.0, 120.0, 86.0, 80.0, 129.0, 210.0, 53.0, 110.0, 120.0, 150.0, 160.0, 100.0, 90.0, 150.0, 78.0, 140.0, 30.0, 59.0, 60.0, 114.0, 188.0, 100.0, 77.0, 98.0, 110.0, 108.0, 35.0, 90.0, 116.0, 60.0, 40.0, 48.0, 130.0, 150.0, 200.0, 30.0, 29.0, 60.0, 50.0, 40.0, 130.0, 70.0, 150.0, 60.0, 80.0, 130.0, 130.0, 160.0, 110.0, 70.0, 100.0, 140.0, 100.0, 130.0, 110.0, 80.0, 140.0, 110.0, 90.0, 90.0, 140.0, 40.0, 90.0, 69.0, 70.0, 80.0, 190.0, 70.0, 60.0, 80.0, 150.0, 50.0, 140.0, 80.0, 54.0, 130.0, 83.0, 130.0, 170.0, 170.0, 50.0, 36.0, 80.0, 128.0, 67.0, 140.0, 118.0, 80.0, 240.0, 80.0, 40.0, 120.0, 50.0, 110.0, 60.0, 220.0, 70.0, 240.0, 50.0, 60.0, 100.0, 56.0, 140.0, 73.0, 50.0, 70.0, 130.0, 64.0, 120.0, 20.0, 10.0, 61.0, 70.0, 66.0, 185.0, 74.0, 36.0, 30.0, 65.0, 38.0, 150.0, 120.0, 20.0, 50.0, 80.0, 120.0, 140.0, 49.0, 65.0, 120.0, 50.0, 60.0, 130.0, 190.0, 60.0, 210.0, 100.0, 75.0, 80.0, 40.0, 20.0, 110.0, 150.0, 120.0, 130.0, 30.0, 200.0, 60.0, 80.0, 200.0, 120.0, 78.0, 160.0, 130.0, 130.0, 160.0, 101.0, 120.0, 10.0, 60.0, 60.0, 190.0, 110.0, 100.0, 90.0, 90.0, 50.0, 90.0, 60.0, 160.0, 140.0, 46.0, 110.0, 150.0, 30.0, 150.0, 70.0, 100.0, 110.0, 70.0, 100.0, 110.0, 126.0, 70.0, 87.0, 146.0, 80.0, 68.0, 109.0, 70.0, 130.0, 90.0, 117.0, 130.0, 30.0, 70.0, 47.0, 80.0, 140.0, 100.0, 90.0, 103.0, 140.0, 130.0, 90.0, 90.0, 60.0, 100.0, 23.0, 110.0, 130.0, 63.0, 30.0, 90.0, 130.0, 150.0, 70.0, 30.0, 190.0, 68.0, 180.0, 79.0, 62.0, 55.0, 53.0, 70.0, 80.0, 140.0, 190.0, 171.0, 180.0, 42.0, 80.0, 100.0, 130.0, 160.0, 114.0, 100.0, 15.0, 140.0, 100.0, 110.0, 130.0, 70.0, 150.0, 100.0, 67.0, 170.0, 56.0, 110.0, 50.0, 160.0, 100.0, 140.0, 40.0, 110.0, 100.0, 160.0, 50.0, 80.0, 160.0, 200.0, 49.0, 86.0, 250.0, 110.0, 90.0, 50.0, 150.0, 110.0, 130.0, 16.0, 70.0, 56.0, 110.0, 108.0, 130.0, 219.0, 150.0, 140.0, 100.0, 110.0, 160.0, 210.0, 110.0, 20.0, 80.0, 90.0, 90.0, 140.0, 110.0, 40.0, 215.0, 87.0, 170.0, 30.0, 150.0, 49.0, 86.0, 70.0, 32.0, 130.0, 50.0, 70.0, 80.0, 62.0, 90.0, 10.0, 30.0, 333.0, 90.0, 190.0, 200.0, 54.0, 59.0, 50.0, 130.0, 46.0, 70.0, 50.0, 180.0, 10.0, 110.0, 140.0, 90.0, 54.0, 90.0, 90.0, 35.0, 140.0, 80.0, 70.0, 80.0, 160.0, 120.0, 120.0, 120.0, 130.0, 60.0, 90.0, 80.0, 80.0, 160.0, 256.0, 60.0, 84.0, 40.0, 70.0, 60.0, 114.0, 130.0, 90.0, 80.0, 73.0, 180.0, 90.0, 170.0, 30.0, 60.0, 120.0, 80.0, 60.0, 80.0, 40.0, 109.0, 68.0, 80.0, 110.0, 110.0, 170.0, 100.0, 70.0, 100.0, 30.0, 40.0, 110.0, 40.0, 130.0, 50.0, 80.0, 150.0, 110.0, 80.0, 140.0, 30.0, 100.0, 40.0, 60.0, 130.0, 35.0, 40.0, 100.0, 151.0, 39.0, 90.0, 53.0, 60.0, 70.0, -10.0, 170.0, 100.0, 70.0, 30.0, 100.0, 150.0, 127.0, 80.0, 77.0, 100.0, 180.0, 10.0, 110.0, 130.0, 49.0, 62.0, 100.0, 110.0, 140.0, 90.0, 60.0, 50.0, 160.0, 230.0, 165.0, 80.0, 50.0, 120.0, 170.0, 184.0, 40.0, 100.0, 60.0, 60.0, 20.0, 80.0, 100.0, 120.0, 90.0, 30.0, 25.0, 210.0, 52.0, 80.0, 40.0, 80.0, 20.0, 50.0, 60.0, 89.0, 130.0, 140.0, 60.0, 50.0, 100.0, 100.0, 50.0, 90.0, 120.0, 160.0, 70.0, 40.0, 90.0, 110.0, 50.0, 90.0, 100.0, 140.0, 170.0, 110.0, 70.0, 79.0, 80.0, 190.0, 80.0, 100.0, 98.0, 30.0, 150.0, 80.0, 50.0, 80.0, 40.0, 130.0, 89.0, 36.0, 120.0, 31.0, 130.0, 63.0, 10.0, 130.0, 22.0, 50.0, -15.0, 42.0, 103.0, 90.0, 34.0, -14.0, 90.0, 140.0, 110.0, 80.0, 310.0, 40.0, 80.0, 130.0, 126.0, 60.0, 140.0, 80.0, 100.0, 40.0, 93.0, 89.0, 29.0, 49.0, 80.0, 70.0, 130.0, 70.0, 100.0, 68.0, 75.0, 40.0, 180.0, 180.0, 239.0, 70.0, 27.0, 68.0, 160.0, 140.0, 120.0, 68.0, 100.0, 127.0, 130.0, 130.0, 120.0, 80.0, 110.0, 110.0, 40.0, 170.0, 75.0, 80.0, 270.0, 150.0, 60.0, 60.0, 69.0, 110.0, 150.0, 18.0, 93.0, 12.0, 100.0, 60.0, 100.0, 100.0, 70.0, 90.0, 155.0, 60.0, 110.0, 43.0, 100.0, 90.0, 130.0, 70.0, 166.0, 130.0, 120.0, 80.0, 100.0, 5.0, 160.0, 140.0, 150.0, 60.0, 90.0, 50.0, 150.0, 80.0, 120.0, 100.0, 160.0, 120.0, 180.0, 65.0, 11.0, 130.0, 190.0, 250.0, 220.0, 69.0, -4.0, 150.0, 79.0, 90.0, 80.0, 260.0, 80.0, 100.0, 60.0, 34.0, 80.0, 150.0, 60.0, 230.0, 170.0, 110.0, 60.0, 130.0, 150.0, 90.0, 150.0, 40.0, 60.0, 65.0, 110.0, 70.0, 50.0, 100.0, 170.0, 60.0, 70.0, 220.0, 170.0, 69.0, 100.0, 140.0, 150.0, 130.0, 50.0, 140.0, 140.0, 40.0, 80.0, 60.0, 60.0, 50.0, 16.0, 32.0, 70.0, 106.0, 110.0, 130.0, 80.0, 47.0, 6.0, 60.0, 140.0, 99.0, 60.0, 77.0, 60.0, 10.0, 27.0, 36.0, 47.0, 70.0, 70.0, 130.0, 72.0, 120.0, 100.0, 60.0, 110.0, 60.0, 27.0, 130.0, 60.0, -4.0, 130.0, 80.0, 80.0, 40.0, 50.0, 130.0, 60.0, 50.0, 140.0, 130.0, 140.0, -41.0, 110.0, 110.0, 100.0, 6.0, 80.0, 49.0, 110.0, 50.0, 80.0, 16.0, 50.0, 60.0, 170.0, 66.0, 46.0, 40.0, 150.0, 95.0, 60.0, 180.0, 45.0, 50.0, 100.0, 0.0, 230.0, 120.0, 0.0, 130.0, 70.0, 80.0, 70.0, 0.0, 100.0, 140.0, 110.0, 138.0, 140.0, 120.0, 110.0, 130.0, 60.0, 120.0, 50.0, 170.0, 50.0, 71.0, 70.0, 150.0, 38.0, 100.0, 90.0, 110.0, 130.0, 70.0, 60.0, 90.0, 70.0, 70.0, 70.0, 100.0, 55.0, 80.0, 120.0, 100.0, 90.0, 170.0, 40.0, 120.0, 70.0, 130.0, 70.0, 150.0, 140.0, 40.0, 110.0, 90.0, 7.0, 150.0, 130.0, 170.0, 26.0, 170.0, 130.0, 70.0, 50.0, 70.0, 80.0, 150.0, 100.0, 130.0, 80.0, 70.0, 76.0, 110.0, -20.0, 80.0, 25.0, 140.0, 80.0, 30.0, 47.0, 59.0, 90.0, 130.0, 150.0, 260.0, 130.0, 70.0, 100.0, 70.0, 70.0, 270.0, 80.0, 79.0, 41.0, 110.0, 101.0, 190.0, 103.0, 109.0, 160.0, 120.0, 73.0, 170.0, 110.0, 50.0, 60.0, 40.0, 60.0, 90.0, 74.0, 130.0, 60.0, 100.0, 70.0, 180.0, 86.0, 56.0, -2.0, 39.0, 80.0, 100.0, 50.0, 10.0, 140.0, 80.0, 100.0, 190.0, 20.0, 65.0, 160.0, 50.0, 78.0, 140.0, -84.0, 60.0, 80.0, -34.0, 30.0, 130.0, -71.0, 60.0, 80.0, 108.0, 47.0, 150.0, 160.0, 50.0, 80.0, 140.0, 140.0, 50.0, 16.0, 40.0, 40.0, 53.0, 90.0, 42.0, 20.0, 140.0, 32.0, 46.0, 50.0, 50.0, 70.0, 80.0, 120.0, 190.0, 40.0, 70.0, 250.0, 50.0, 140.0, 66.0, 20.0, 150.0, 82.0, 25.0, 76.0, 90.0, 150.0, 1.0, 152.0, 160.0, 140.0, 100.0, 170.0, 92.0, 100.0, 90.0, 100.0, 120.0, 150.0, 40.0, 40.0, 8.0, 120.0, 69.0, 90.0, 70.0, 130.0, 60.0, 100.0, 100.0, 110.0, 80.0, 120.0, 59.0, 30.0, 100.0, 90.0, 19.0, -2.0, 70.0, 60.0, 150.0, 110.0, 50.0, 73.0, 200.0, 100.0, 130.0, 167.0, 60.0, 120.0, 140.0, 80.0, 130.0, 140.0, 60.0, 86.0, 120.0, 30.0, 107.0, 39.0, 148.0, 50.0, 140.0, 30.0, 8.0, 60.0, 110.0, 120.0, 180.0, 124.0, 73.0, 108.0, 80.0, 190.0, 42.0, 70.0, 130.0, 13.0, 50.0, 29.0, 119.0, 140.0, 120.0, 120.0, 110.0, 79.0, 50.0, 50.0, 30.0, 50.0, 110.0, 180.0, 70.0, 79.0, 90.0, 10.0, 59.0, 140.0, 40.0, 70.0, 40.0, 90.0, 30.0, 40.0, 130.0, 120.0, 30.0, 70.0, 110.0, 210.0, 60.0, 140.0, 90.0, 71.0, 61.0, 120.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.898271601793066, "mean_inference_ms": 1.9249283782235553, "mean_action_processing_ms": 0.566853001803781, "mean_env_wait_ms": 1.2934917889813269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012001276016235352, "StateBufferConnector_ms": 0.00890350341796875, "ViewRequirementAgentConnector_ms": 0.3790304660797119}, "num_episodes": 22, "episode_return_max": 1340.0, "episode_return_min": 389.0, "episode_return_mean": 938.74}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.65590853610048, "num_env_steps_trained_throughput_per_sec": 20.65590853610048, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 2440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2440000, "timers": {"training_iteration_time_ms": 193406.109, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193406.063, "sample_time_ms": 2252.717, "learn_time_ms": 191133.766, "learn_throughput": 20.928, "synch_weights_time_ms": 11.369}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "done": false, "training_iteration": 61, "trial_id": "1841f_00000", "date": "2024-08-08_02-59-48", "timestamp": 1723100388, "time_this_iter_s": 193.6597752571106, "time_total_s": 13172.735558748245, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3372790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13172.735558748245, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 18.990145985401462, "ram_util_percent": 76.60474452554743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.374785899608153, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.223479206747394, "policy_loss": -0.011063590475047628, "vf_loss": 8.233228361162261, "vf_explained_var": -0.004950555686117869, "kl": 0.006572139814870258, "entropy": 0.5633081477988389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 577485.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 1340.0, "episode_reward_min": 389.0, "episode_reward_mean": 909.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -84.0}, "policy_reward_max": {"policy_0": 333.0}, "policy_reward_mean": {"policy_0": 90.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [966.0, 904.0, 926.0, 993.0, 977.0, 1092.0, 1093.0, 1020.0, 1225.0, 1099.0, 1110.0, 1077.0, 624.0, 1222.0, 849.0, 1080.0, 980.0, 1017.0, 857.0, 840.0, 920.0, 628.0, 1004.0, 981.0, 1269.0, 700.0, 706.0, 1000.0, 970.0, 957.0, 769.0, 452.0, 1166.0, 770.0, 1152.0, 1070.0, 1205.0, 732.0, 918.0, 1101.0, 1080.0, 1261.0, 1013.0, 1190.0, 975.0, 1129.0, 714.0, 639.0, 732.0, 713.0, 879.0, 601.0, 902.0, 800.0, 1168.0, 899.0, 795.0, 1060.0, 1033.0, 930.0, 627.0, 1340.0, 1093.0, 857.0, 769.0, 865.0, 389.0, 1005.0, 519.0, 970.0, 800.0, 1224.0, 777.0, 808.0, 941.0, 1103.0, 722.0, 1117.0, 830.0, 728.0, 730.0, 1092.0, 922.0, 762.0, 910.0, 545.0, 795.0, 889.0, 850.0, 1042.0, 990.0, 884.0, 948.0, 910.0, 660.0, 495.0, 981.0, 715.0, 671.0, 786.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 100.0, 110.0, 126.0, 70.0, 87.0, 146.0, 80.0, 68.0, 109.0, 70.0, 130.0, 90.0, 117.0, 130.0, 30.0, 70.0, 47.0, 80.0, 140.0, 100.0, 90.0, 103.0, 140.0, 130.0, 90.0, 90.0, 60.0, 100.0, 23.0, 110.0, 130.0, 63.0, 30.0, 90.0, 130.0, 150.0, 70.0, 30.0, 190.0, 68.0, 180.0, 79.0, 62.0, 55.0, 53.0, 70.0, 80.0, 140.0, 190.0, 171.0, 180.0, 42.0, 80.0, 100.0, 130.0, 160.0, 114.0, 100.0, 15.0, 140.0, 100.0, 110.0, 130.0, 70.0, 150.0, 100.0, 67.0, 170.0, 56.0, 110.0, 50.0, 160.0, 100.0, 140.0, 40.0, 110.0, 100.0, 160.0, 50.0, 80.0, 160.0, 200.0, 49.0, 86.0, 250.0, 110.0, 90.0, 50.0, 150.0, 110.0, 130.0, 16.0, 70.0, 56.0, 110.0, 108.0, 130.0, 219.0, 150.0, 140.0, 100.0, 110.0, 160.0, 210.0, 110.0, 20.0, 80.0, 90.0, 90.0, 140.0, 110.0, 40.0, 215.0, 87.0, 170.0, 30.0, 150.0, 49.0, 86.0, 70.0, 32.0, 130.0, 50.0, 70.0, 80.0, 62.0, 90.0, 10.0, 30.0, 333.0, 90.0, 190.0, 200.0, 54.0, 59.0, 50.0, 130.0, 46.0, 70.0, 50.0, 180.0, 10.0, 110.0, 140.0, 90.0, 54.0, 90.0, 90.0, 35.0, 140.0, 80.0, 70.0, 80.0, 160.0, 120.0, 120.0, 120.0, 130.0, 60.0, 90.0, 80.0, 80.0, 160.0, 256.0, 60.0, 84.0, 40.0, 70.0, 60.0, 114.0, 130.0, 90.0, 80.0, 73.0, 180.0, 90.0, 170.0, 30.0, 60.0, 120.0, 80.0, 60.0, 80.0, 40.0, 109.0, 68.0, 80.0, 110.0, 110.0, 170.0, 100.0, 70.0, 100.0, 30.0, 40.0, 110.0, 40.0, 130.0, 50.0, 80.0, 150.0, 110.0, 80.0, 140.0, 30.0, 100.0, 40.0, 60.0, 130.0, 35.0, 40.0, 100.0, 151.0, 39.0, 90.0, 53.0, 60.0, 70.0, -10.0, 170.0, 100.0, 70.0, 30.0, 100.0, 150.0, 127.0, 80.0, 77.0, 100.0, 180.0, 10.0, 110.0, 130.0, 49.0, 62.0, 100.0, 110.0, 140.0, 90.0, 60.0, 50.0, 160.0, 230.0, 165.0, 80.0, 50.0, 120.0, 170.0, 184.0, 40.0, 100.0, 60.0, 60.0, 20.0, 80.0, 100.0, 120.0, 90.0, 30.0, 25.0, 210.0, 52.0, 80.0, 40.0, 80.0, 20.0, 50.0, 60.0, 89.0, 130.0, 140.0, 60.0, 50.0, 100.0, 100.0, 50.0, 90.0, 120.0, 160.0, 70.0, 40.0, 90.0, 110.0, 50.0, 90.0, 100.0, 140.0, 170.0, 110.0, 70.0, 79.0, 80.0, 190.0, 80.0, 100.0, 98.0, 30.0, 150.0, 80.0, 50.0, 80.0, 40.0, 130.0, 89.0, 36.0, 120.0, 31.0, 130.0, 63.0, 10.0, 130.0, 22.0, 50.0, -15.0, 42.0, 103.0, 90.0, 34.0, -14.0, 90.0, 140.0, 110.0, 80.0, 310.0, 40.0, 80.0, 130.0, 126.0, 60.0, 140.0, 80.0, 100.0, 40.0, 93.0, 89.0, 29.0, 49.0, 80.0, 70.0, 130.0, 70.0, 100.0, 68.0, 75.0, 40.0, 180.0, 180.0, 239.0, 70.0, 27.0, 68.0, 160.0, 140.0, 120.0, 68.0, 100.0, 127.0, 130.0, 130.0, 120.0, 80.0, 110.0, 110.0, 40.0, 170.0, 75.0, 80.0, 270.0, 150.0, 60.0, 60.0, 69.0, 110.0, 150.0, 18.0, 93.0, 12.0, 100.0, 60.0, 100.0, 100.0, 70.0, 90.0, 155.0, 60.0, 110.0, 43.0, 100.0, 90.0, 130.0, 70.0, 166.0, 130.0, 120.0, 80.0, 100.0, 5.0, 160.0, 140.0, 150.0, 60.0, 90.0, 50.0, 150.0, 80.0, 120.0, 100.0, 160.0, 120.0, 180.0, 65.0, 11.0, 130.0, 190.0, 250.0, 220.0, 69.0, -4.0, 150.0, 79.0, 90.0, 80.0, 260.0, 80.0, 100.0, 60.0, 34.0, 80.0, 150.0, 60.0, 230.0, 170.0, 110.0, 60.0, 130.0, 150.0, 90.0, 150.0, 40.0, 60.0, 65.0, 110.0, 70.0, 50.0, 100.0, 170.0, 60.0, 70.0, 220.0, 170.0, 69.0, 100.0, 140.0, 150.0, 130.0, 50.0, 140.0, 140.0, 40.0, 80.0, 60.0, 60.0, 50.0, 16.0, 32.0, 70.0, 106.0, 110.0, 130.0, 80.0, 47.0, 6.0, 60.0, 140.0, 99.0, 60.0, 77.0, 60.0, 10.0, 27.0, 36.0, 47.0, 70.0, 70.0, 130.0, 72.0, 120.0, 100.0, 60.0, 110.0, 60.0, 27.0, 130.0, 60.0, -4.0, 130.0, 80.0, 80.0, 40.0, 50.0, 130.0, 60.0, 50.0, 140.0, 130.0, 140.0, -41.0, 110.0, 110.0, 100.0, 6.0, 80.0, 49.0, 110.0, 50.0, 80.0, 16.0, 50.0, 60.0, 170.0, 66.0, 46.0, 40.0, 150.0, 95.0, 60.0, 180.0, 45.0, 50.0, 100.0, 0.0, 230.0, 120.0, 0.0, 130.0, 70.0, 80.0, 70.0, 0.0, 100.0, 140.0, 110.0, 138.0, 140.0, 120.0, 110.0, 130.0, 60.0, 120.0, 50.0, 170.0, 50.0, 71.0, 70.0, 150.0, 38.0, 100.0, 90.0, 110.0, 130.0, 70.0, 60.0, 90.0, 70.0, 70.0, 70.0, 100.0, 55.0, 80.0, 120.0, 100.0, 90.0, 170.0, 40.0, 120.0, 70.0, 130.0, 70.0, 150.0, 140.0, 40.0, 110.0, 90.0, 7.0, 150.0, 130.0, 170.0, 26.0, 170.0, 130.0, 70.0, 50.0, 70.0, 80.0, 150.0, 100.0, 130.0, 80.0, 70.0, 76.0, 110.0, -20.0, 80.0, 25.0, 140.0, 80.0, 30.0, 47.0, 59.0, 90.0, 130.0, 150.0, 260.0, 130.0, 70.0, 100.0, 70.0, 70.0, 270.0, 80.0, 79.0, 41.0, 110.0, 101.0, 190.0, 103.0, 109.0, 160.0, 120.0, 73.0, 170.0, 110.0, 50.0, 60.0, 40.0, 60.0, 90.0, 74.0, 130.0, 60.0, 100.0, 70.0, 180.0, 86.0, 56.0, -2.0, 39.0, 80.0, 100.0, 50.0, 10.0, 140.0, 80.0, 100.0, 190.0, 20.0, 65.0, 160.0, 50.0, 78.0, 140.0, -84.0, 60.0, 80.0, -34.0, 30.0, 130.0, -71.0, 60.0, 80.0, 108.0, 47.0, 150.0, 160.0, 50.0, 80.0, 140.0, 140.0, 50.0, 16.0, 40.0, 40.0, 53.0, 90.0, 42.0, 20.0, 140.0, 32.0, 46.0, 50.0, 50.0, 70.0, 80.0, 120.0, 190.0, 40.0, 70.0, 250.0, 50.0, 140.0, 66.0, 20.0, 150.0, 82.0, 25.0, 76.0, 90.0, 150.0, 1.0, 152.0, 160.0, 140.0, 100.0, 170.0, 92.0, 100.0, 90.0, 100.0, 120.0, 150.0, 40.0, 40.0, 8.0, 120.0, 69.0, 90.0, 70.0, 130.0, 60.0, 100.0, 100.0, 110.0, 80.0, 120.0, 59.0, 30.0, 100.0, 90.0, 19.0, -2.0, 70.0, 60.0, 150.0, 110.0, 50.0, 73.0, 200.0, 100.0, 130.0, 167.0, 60.0, 120.0, 140.0, 80.0, 130.0, 140.0, 60.0, 86.0, 120.0, 30.0, 107.0, 39.0, 148.0, 50.0, 140.0, 30.0, 8.0, 60.0, 110.0, 120.0, 180.0, 124.0, 73.0, 108.0, 80.0, 190.0, 42.0, 70.0, 130.0, 13.0, 50.0, 29.0, 119.0, 140.0, 120.0, 120.0, 110.0, 79.0, 50.0, 50.0, 30.0, 50.0, 110.0, 180.0, 70.0, 79.0, 90.0, 10.0, 59.0, 140.0, 40.0, 70.0, 40.0, 90.0, 30.0, 40.0, 130.0, 120.0, 30.0, 70.0, 110.0, 210.0, 60.0, 140.0, 90.0, 71.0, 61.0, 120.0, 160.0, 100.0, 80.0, 110.0, 67.0, 40.0, 180.0, 137.0, 69.0, 79.0, 60.0, 60.0, 90.0, 37.0, 35.0, 220.0, 50.0, 80.0, 70.0, 50.0, 70.0, 70.0, 70.0, 40.0, 160.0, 90.0, 100.0, 110.0, 70.0, 130.0, 70.0, -7.0, 50.0, -38.0, 140.0, 100.0, 49.0, 131.0, 60.0, 70.0, -10.0, 90.0, 34.0, 77.0, 110.0, 90.0, 30.0, 138.0, 80.0, 120.0, 26.0, 120.0, 120.0, 110.0, 90.0, 127.0, 27.0, 43.0, 88.0, 134.0, 30.0, 20.0, 80.0, 190.0, 140.0, -2.0, 190.0, 78.0, 59.0, 87.0, 8.0, 160.0, 110.0, 170.0, 59.0, 110.0, 66.0, 150.0, 90.0, 27.0, 100.0, 100.0, 70.0, 150.0, 60.0, 70.0, 110.0, 80.0, 110.0, 100.0, 140.0, 140.0, 100.0, 100.0, 59.0, 29.0, 18.0, 120.0, 39.0, 240.0, 39.0, 120.0, 80.0, 130.0, 114.0, 220.0, 70.0, 110.0, 50.0, 46.0, 8.0, 130.0, 60.0, 110.0, 100.0, 60.0, 100.0, 120.0, 160.0, 40.0, 30.0, 80.0, 160.0, 70.0, 80.0, 20.0, 50.0, 20.0, 60.0, 70.0, 50.0, 50.0, 50.0, 50.0, 22.0, 40.0, 40.0, 50.0, 31.0, 130.0, 32.0, 90.0, 70.0, 70.0, 119.0, 70.0, 47.0, 120.0, 102.0, 193.0, 100.0, 80.0, 26.0, 50.0, 60.0, 80.0, 140.0, 49.0, 50.0, 50.0, 130.0, 90.0, 90.0, 28.0, 25.0, 30.0, -2.0, 120.0, 40.0, 130.0, 120.0, 210.0, 140.0, 110.0, 90.0, 3.0, 27.0, 50.0, 120.0, 70.0, -34.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8905545086426423, "mean_inference_ms": 1.9150435438110498, "mean_action_processing_ms": 0.5646471141006272, "mean_env_wait_ms": 1.289105357686553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011919498443603516, "StateBufferConnector_ms": 0.008937597274780273, "ViewRequirementAgentConnector_ms": 0.3759176731109619}, "num_episodes": 18, "episode_return_max": 1340.0, "episode_return_min": 389.0, "episode_return_mean": 909.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.763655486155773, "num_env_steps_trained_throughput_per_sec": 20.763655486155773, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 193259.556, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193259.51, "sample_time_ms": 2245.122, "learn_time_ms": 190994.925, "learn_throughput": 20.943, "synch_weights_time_ms": 11.315}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 62, "trial_id": "1841f_00000", "date": "2024-08-08_03-03-01", "timestamp": 1723100581, "time_this_iter_s": 192.65389585494995, "time_total_s": 13365.389454603195, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3369550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13365.389454603195, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 17.26153846153846, "ram_util_percent": 76.64798534798535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.060770663552391, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.418842756100737, "policy_loss": -0.010941469235592685, "vf_loss": 8.42840757436011, "vf_explained_var": -0.004234015865447803, "kl": 0.006883244584894832, "entropy": 0.5325056870080158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 586875.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "env_runners": {"episode_reward_max": 1340.0, "episode_reward_min": 383.0, "episode_reward_mean": 896.98, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 328.0}, "policy_reward_mean": {"policy_0": 89.698}, "custom_metrics": {}, "hist_stats": {"episode_reward": [981.0, 1269.0, 700.0, 706.0, 1000.0, 970.0, 957.0, 769.0, 452.0, 1166.0, 770.0, 1152.0, 1070.0, 1205.0, 732.0, 918.0, 1101.0, 1080.0, 1261.0, 1013.0, 1190.0, 975.0, 1129.0, 714.0, 639.0, 732.0, 713.0, 879.0, 601.0, 902.0, 800.0, 1168.0, 899.0, 795.0, 1060.0, 1033.0, 930.0, 627.0, 1340.0, 1093.0, 857.0, 769.0, 865.0, 389.0, 1005.0, 519.0, 970.0, 800.0, 1224.0, 777.0, 808.0, 941.0, 1103.0, 722.0, 1117.0, 830.0, 728.0, 730.0, 1092.0, 922.0, 762.0, 910.0, 545.0, 795.0, 889.0, 850.0, 1042.0, 990.0, 884.0, 948.0, 910.0, 660.0, 495.0, 981.0, 715.0, 671.0, 786.0, 1215.0, 1043.0, 937.0, 1040.0, 1020.0, 882.0, 1047.0, 383.0, 967.0, 955.0, 995.0, 438.0, 618.0, 445.0, 1092.0, 987.0, 1002.0, 1257.0, 1034.0, 945.0, 1006.0, 1136.0, 762.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 10.0, 110.0, 130.0, 49.0, 62.0, 100.0, 110.0, 140.0, 90.0, 60.0, 50.0, 160.0, 230.0, 165.0, 80.0, 50.0, 120.0, 170.0, 184.0, 40.0, 100.0, 60.0, 60.0, 20.0, 80.0, 100.0, 120.0, 90.0, 30.0, 25.0, 210.0, 52.0, 80.0, 40.0, 80.0, 20.0, 50.0, 60.0, 89.0, 130.0, 140.0, 60.0, 50.0, 100.0, 100.0, 50.0, 90.0, 120.0, 160.0, 70.0, 40.0, 90.0, 110.0, 50.0, 90.0, 100.0, 140.0, 170.0, 110.0, 70.0, 79.0, 80.0, 190.0, 80.0, 100.0, 98.0, 30.0, 150.0, 80.0, 50.0, 80.0, 40.0, 130.0, 89.0, 36.0, 120.0, 31.0, 130.0, 63.0, 10.0, 130.0, 22.0, 50.0, -15.0, 42.0, 103.0, 90.0, 34.0, -14.0, 90.0, 140.0, 110.0, 80.0, 310.0, 40.0, 80.0, 130.0, 126.0, 60.0, 140.0, 80.0, 100.0, 40.0, 93.0, 89.0, 29.0, 49.0, 80.0, 70.0, 130.0, 70.0, 100.0, 68.0, 75.0, 40.0, 180.0, 180.0, 239.0, 70.0, 27.0, 68.0, 160.0, 140.0, 120.0, 68.0, 100.0, 127.0, 130.0, 130.0, 120.0, 80.0, 110.0, 110.0, 40.0, 170.0, 75.0, 80.0, 270.0, 150.0, 60.0, 60.0, 69.0, 110.0, 150.0, 18.0, 93.0, 12.0, 100.0, 60.0, 100.0, 100.0, 70.0, 90.0, 155.0, 60.0, 110.0, 43.0, 100.0, 90.0, 130.0, 70.0, 166.0, 130.0, 120.0, 80.0, 100.0, 5.0, 160.0, 140.0, 150.0, 60.0, 90.0, 50.0, 150.0, 80.0, 120.0, 100.0, 160.0, 120.0, 180.0, 65.0, 11.0, 130.0, 190.0, 250.0, 220.0, 69.0, -4.0, 150.0, 79.0, 90.0, 80.0, 260.0, 80.0, 100.0, 60.0, 34.0, 80.0, 150.0, 60.0, 230.0, 170.0, 110.0, 60.0, 130.0, 150.0, 90.0, 150.0, 40.0, 60.0, 65.0, 110.0, 70.0, 50.0, 100.0, 170.0, 60.0, 70.0, 220.0, 170.0, 69.0, 100.0, 140.0, 150.0, 130.0, 50.0, 140.0, 140.0, 40.0, 80.0, 60.0, 60.0, 50.0, 16.0, 32.0, 70.0, 106.0, 110.0, 130.0, 80.0, 47.0, 6.0, 60.0, 140.0, 99.0, 60.0, 77.0, 60.0, 10.0, 27.0, 36.0, 47.0, 70.0, 70.0, 130.0, 72.0, 120.0, 100.0, 60.0, 110.0, 60.0, 27.0, 130.0, 60.0, -4.0, 130.0, 80.0, 80.0, 40.0, 50.0, 130.0, 60.0, 50.0, 140.0, 130.0, 140.0, -41.0, 110.0, 110.0, 100.0, 6.0, 80.0, 49.0, 110.0, 50.0, 80.0, 16.0, 50.0, 60.0, 170.0, 66.0, 46.0, 40.0, 150.0, 95.0, 60.0, 180.0, 45.0, 50.0, 100.0, 0.0, 230.0, 120.0, 0.0, 130.0, 70.0, 80.0, 70.0, 0.0, 100.0, 140.0, 110.0, 138.0, 140.0, 120.0, 110.0, 130.0, 60.0, 120.0, 50.0, 170.0, 50.0, 71.0, 70.0, 150.0, 38.0, 100.0, 90.0, 110.0, 130.0, 70.0, 60.0, 90.0, 70.0, 70.0, 70.0, 100.0, 55.0, 80.0, 120.0, 100.0, 90.0, 170.0, 40.0, 120.0, 70.0, 130.0, 70.0, 150.0, 140.0, 40.0, 110.0, 90.0, 7.0, 150.0, 130.0, 170.0, 26.0, 170.0, 130.0, 70.0, 50.0, 70.0, 80.0, 150.0, 100.0, 130.0, 80.0, 70.0, 76.0, 110.0, -20.0, 80.0, 25.0, 140.0, 80.0, 30.0, 47.0, 59.0, 90.0, 130.0, 150.0, 260.0, 130.0, 70.0, 100.0, 70.0, 70.0, 270.0, 80.0, 79.0, 41.0, 110.0, 101.0, 190.0, 103.0, 109.0, 160.0, 120.0, 73.0, 170.0, 110.0, 50.0, 60.0, 40.0, 60.0, 90.0, 74.0, 130.0, 60.0, 100.0, 70.0, 180.0, 86.0, 56.0, -2.0, 39.0, 80.0, 100.0, 50.0, 10.0, 140.0, 80.0, 100.0, 190.0, 20.0, 65.0, 160.0, 50.0, 78.0, 140.0, -84.0, 60.0, 80.0, -34.0, 30.0, 130.0, -71.0, 60.0, 80.0, 108.0, 47.0, 150.0, 160.0, 50.0, 80.0, 140.0, 140.0, 50.0, 16.0, 40.0, 40.0, 53.0, 90.0, 42.0, 20.0, 140.0, 32.0, 46.0, 50.0, 50.0, 70.0, 80.0, 120.0, 190.0, 40.0, 70.0, 250.0, 50.0, 140.0, 66.0, 20.0, 150.0, 82.0, 25.0, 76.0, 90.0, 150.0, 1.0, 152.0, 160.0, 140.0, 100.0, 170.0, 92.0, 100.0, 90.0, 100.0, 120.0, 150.0, 40.0, 40.0, 8.0, 120.0, 69.0, 90.0, 70.0, 130.0, 60.0, 100.0, 100.0, 110.0, 80.0, 120.0, 59.0, 30.0, 100.0, 90.0, 19.0, -2.0, 70.0, 60.0, 150.0, 110.0, 50.0, 73.0, 200.0, 100.0, 130.0, 167.0, 60.0, 120.0, 140.0, 80.0, 130.0, 140.0, 60.0, 86.0, 120.0, 30.0, 107.0, 39.0, 148.0, 50.0, 140.0, 30.0, 8.0, 60.0, 110.0, 120.0, 180.0, 124.0, 73.0, 108.0, 80.0, 190.0, 42.0, 70.0, 130.0, 13.0, 50.0, 29.0, 119.0, 140.0, 120.0, 120.0, 110.0, 79.0, 50.0, 50.0, 30.0, 50.0, 110.0, 180.0, 70.0, 79.0, 90.0, 10.0, 59.0, 140.0, 40.0, 70.0, 40.0, 90.0, 30.0, 40.0, 130.0, 120.0, 30.0, 70.0, 110.0, 210.0, 60.0, 140.0, 90.0, 71.0, 61.0, 120.0, 160.0, 100.0, 80.0, 110.0, 67.0, 40.0, 180.0, 137.0, 69.0, 79.0, 60.0, 60.0, 90.0, 37.0, 35.0, 220.0, 50.0, 80.0, 70.0, 50.0, 70.0, 70.0, 70.0, 40.0, 160.0, 90.0, 100.0, 110.0, 70.0, 130.0, 70.0, -7.0, 50.0, -38.0, 140.0, 100.0, 49.0, 131.0, 60.0, 70.0, -10.0, 90.0, 34.0, 77.0, 110.0, 90.0, 30.0, 138.0, 80.0, 120.0, 26.0, 120.0, 120.0, 110.0, 90.0, 127.0, 27.0, 43.0, 88.0, 134.0, 30.0, 20.0, 80.0, 190.0, 140.0, -2.0, 190.0, 78.0, 59.0, 87.0, 8.0, 160.0, 110.0, 170.0, 59.0, 110.0, 66.0, 150.0, 90.0, 27.0, 100.0, 100.0, 70.0, 150.0, 60.0, 70.0, 110.0, 80.0, 110.0, 100.0, 140.0, 140.0, 100.0, 100.0, 59.0, 29.0, 18.0, 120.0, 39.0, 240.0, 39.0, 120.0, 80.0, 130.0, 114.0, 220.0, 70.0, 110.0, 50.0, 46.0, 8.0, 130.0, 60.0, 110.0, 100.0, 60.0, 100.0, 120.0, 160.0, 40.0, 30.0, 80.0, 160.0, 70.0, 80.0, 20.0, 50.0, 20.0, 60.0, 70.0, 50.0, 50.0, 50.0, 50.0, 22.0, 40.0, 40.0, 50.0, 31.0, 130.0, 32.0, 90.0, 70.0, 70.0, 119.0, 70.0, 47.0, 120.0, 102.0, 193.0, 100.0, 80.0, 26.0, 50.0, 60.0, 80.0, 140.0, 49.0, 50.0, 50.0, 130.0, 90.0, 90.0, 28.0, 25.0, 30.0, -2.0, 120.0, 40.0, 130.0, 120.0, 210.0, 140.0, 110.0, 90.0, 3.0, 27.0, 50.0, 120.0, 70.0, -34.0, 76.0, 170.0, 160.0, 97.0, 79.0, 103.0, 40.0, 280.0, 120.0, 90.0, 143.0, 44.0, 79.0, 150.0, 49.0, 140.0, 130.0, 170.0, 90.0, 48.0, 140.0, 110.0, 60.0, 98.0, 50.0, 120.0, 130.0, 79.0, 70.0, 80.0, 140.0, 160.0, 120.0, 40.0, 90.0, 60.0, 80.0, 140.0, 100.0, 110.0, 100.0, 120.0, 110.0, 110.0, 110.0, 40.0, 30.0, 240.0, 20.0, 140.0, 160.0, 60.0, 60.0, 130.0, 49.0, 170.0, 50.0, 70.0, 44.0, 89.0, 48.0, 130.0, 109.0, 90.0, 150.0, 190.0, 130.0, 80.0, 70.0, 50.0, 160.0, 69.0, 14.0, -290.0, 110.0, 9.0, 80.0, 45.0, 60.0, 126.0, 60.0, 140.0, 70.0, 82.0, 240.0, 90.0, 65.0, 30.0, 130.0, 60.0, 68.0, 60.0, 150.0, 109.0, 70.0, 50.0, 110.0, 108.0, 180.0, 50.0, 95.0, 26.0, 150.0, 70.0, 110.0, -4.0, 72.0, 110.0, 116.0, 250.0, 41.0, -12.0, 0.0, 20.0, 70.0, -10.0, 129.0, 100.0, 70.0, 30.0, 80.0, 14.0, 40.0, 45.0, 90.0, 39.0, 0.0, 140.0, 40.0, 130.0, -48.0, -6.0, 20.0, 170.0, 140.0, 19.0, 58.0, 3.0, 109.0, -20.0, 120.0, 90.0, 50.0, 196.0, 110.0, 150.0, 120.0, 66.0, 50.0, 140.0, 76.0, 110.0, 74.0, 90.0, 140.0, 200.0, 22.0, 160.0, 99.0, 16.0, 89.0, 140.0, 80.0, 110.0, 30.0, 108.0, 150.0, 60.0, 65.0, 170.0, 70.0, 140.0, 70.0, 130.0, 89.0, 110.0, 100.0, 200.0, 20.0, 328.0, 50.0, 170.0, 120.0, 50.0, 77.0, 95.0, 66.0, 226.0, 130.0, 50.0, 140.0, 50.0, 110.0, 120.0, 120.0, 239.0, 54.0, 60.0, -48.0, 100.0, 12.0, 45.0, 80.0, 140.0, 170.0, 70.0, 208.0, 170.0, 13.0, 98.0, 130.0, 80.0, -3.0, 70.0, 189.0, 170.0, 50.0, 170.0, 70.0, 210.0, 70.0, 185.0, 36.0, 80.0, 110.0, 130.0, 100.0, 30.0, -15.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8818364369633735, "mean_inference_ms": 1.9049974814640098, "mean_action_processing_ms": 0.562069320500175, "mean_env_wait_ms": 1.2830045273709545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012937784194946289, "StateBufferConnector_ms": 0.009190797805786133, "ViewRequirementAgentConnector_ms": 0.3849983215332031}, "num_episodes": 23, "episode_return_max": 1340.0, "episode_return_min": 383.0, "episode_return_mean": 896.98}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.641330390767504, "num_env_steps_trained_throughput_per_sec": 20.641330390767504, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 2520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2520000, "timers": {"training_iteration_time_ms": 193240.279, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193240.233, "sample_time_ms": 2236.168, "learn_time_ms": 190984.907, "learn_throughput": 20.944, "synch_weights_time_ms": 11.046}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "done": false, "training_iteration": 63, "trial_id": "1841f_00000", "date": "2024-08-08_03-06-14", "timestamp": 1723100774, "time_this_iter_s": 193.79725694656372, "time_total_s": 13559.186711549759, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3369040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13559.186711549759, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 20.84014598540146, "ram_util_percent": 77.18759124087592}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3526510955172735, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.489286065025452, "policy_loss": -0.011826074043466363, "vf_loss": 8.49965603724836, "vf_explained_var": -0.026578935241292966, "kl": 0.007280497955846243, "entropy": 0.5630280202982652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 596265.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 1340.0, "episode_reward_min": 383.0, "episode_reward_mean": 888.46, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 328.0}, "policy_reward_mean": {"policy_0": 88.846}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1261.0, 1013.0, 1190.0, 975.0, 1129.0, 714.0, 639.0, 732.0, 713.0, 879.0, 601.0, 902.0, 800.0, 1168.0, 899.0, 795.0, 1060.0, 1033.0, 930.0, 627.0, 1340.0, 1093.0, 857.0, 769.0, 865.0, 389.0, 1005.0, 519.0, 970.0, 800.0, 1224.0, 777.0, 808.0, 941.0, 1103.0, 722.0, 1117.0, 830.0, 728.0, 730.0, 1092.0, 922.0, 762.0, 910.0, 545.0, 795.0, 889.0, 850.0, 1042.0, 990.0, 884.0, 948.0, 910.0, 660.0, 495.0, 981.0, 715.0, 671.0, 786.0, 1215.0, 1043.0, 937.0, 1040.0, 1020.0, 882.0, 1047.0, 383.0, 967.0, 955.0, 995.0, 438.0, 618.0, 445.0, 1092.0, 987.0, 1002.0, 1257.0, 1034.0, 945.0, 1006.0, 1136.0, 762.0, 874.0, 894.0, 826.0, 1160.0, 970.0, 652.0, 1006.0, 833.0, 847.0, 993.0, 1000.0, 1134.0, 1050.0, 811.0, 897.0, 834.0, 695.0, 670.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 65.0, 11.0, 130.0, 190.0, 250.0, 220.0, 69.0, -4.0, 150.0, 79.0, 90.0, 80.0, 260.0, 80.0, 100.0, 60.0, 34.0, 80.0, 150.0, 60.0, 230.0, 170.0, 110.0, 60.0, 130.0, 150.0, 90.0, 150.0, 40.0, 60.0, 65.0, 110.0, 70.0, 50.0, 100.0, 170.0, 60.0, 70.0, 220.0, 170.0, 69.0, 100.0, 140.0, 150.0, 130.0, 50.0, 140.0, 140.0, 40.0, 80.0, 60.0, 60.0, 50.0, 16.0, 32.0, 70.0, 106.0, 110.0, 130.0, 80.0, 47.0, 6.0, 60.0, 140.0, 99.0, 60.0, 77.0, 60.0, 10.0, 27.0, 36.0, 47.0, 70.0, 70.0, 130.0, 72.0, 120.0, 100.0, 60.0, 110.0, 60.0, 27.0, 130.0, 60.0, -4.0, 130.0, 80.0, 80.0, 40.0, 50.0, 130.0, 60.0, 50.0, 140.0, 130.0, 140.0, -41.0, 110.0, 110.0, 100.0, 6.0, 80.0, 49.0, 110.0, 50.0, 80.0, 16.0, 50.0, 60.0, 170.0, 66.0, 46.0, 40.0, 150.0, 95.0, 60.0, 180.0, 45.0, 50.0, 100.0, 0.0, 230.0, 120.0, 0.0, 130.0, 70.0, 80.0, 70.0, 0.0, 100.0, 140.0, 110.0, 138.0, 140.0, 120.0, 110.0, 130.0, 60.0, 120.0, 50.0, 170.0, 50.0, 71.0, 70.0, 150.0, 38.0, 100.0, 90.0, 110.0, 130.0, 70.0, 60.0, 90.0, 70.0, 70.0, 70.0, 100.0, 55.0, 80.0, 120.0, 100.0, 90.0, 170.0, 40.0, 120.0, 70.0, 130.0, 70.0, 150.0, 140.0, 40.0, 110.0, 90.0, 7.0, 150.0, 130.0, 170.0, 26.0, 170.0, 130.0, 70.0, 50.0, 70.0, 80.0, 150.0, 100.0, 130.0, 80.0, 70.0, 76.0, 110.0, -20.0, 80.0, 25.0, 140.0, 80.0, 30.0, 47.0, 59.0, 90.0, 130.0, 150.0, 260.0, 130.0, 70.0, 100.0, 70.0, 70.0, 270.0, 80.0, 79.0, 41.0, 110.0, 101.0, 190.0, 103.0, 109.0, 160.0, 120.0, 73.0, 170.0, 110.0, 50.0, 60.0, 40.0, 60.0, 90.0, 74.0, 130.0, 60.0, 100.0, 70.0, 180.0, 86.0, 56.0, -2.0, 39.0, 80.0, 100.0, 50.0, 10.0, 140.0, 80.0, 100.0, 190.0, 20.0, 65.0, 160.0, 50.0, 78.0, 140.0, -84.0, 60.0, 80.0, -34.0, 30.0, 130.0, -71.0, 60.0, 80.0, 108.0, 47.0, 150.0, 160.0, 50.0, 80.0, 140.0, 140.0, 50.0, 16.0, 40.0, 40.0, 53.0, 90.0, 42.0, 20.0, 140.0, 32.0, 46.0, 50.0, 50.0, 70.0, 80.0, 120.0, 190.0, 40.0, 70.0, 250.0, 50.0, 140.0, 66.0, 20.0, 150.0, 82.0, 25.0, 76.0, 90.0, 150.0, 1.0, 152.0, 160.0, 140.0, 100.0, 170.0, 92.0, 100.0, 90.0, 100.0, 120.0, 150.0, 40.0, 40.0, 8.0, 120.0, 69.0, 90.0, 70.0, 130.0, 60.0, 100.0, 100.0, 110.0, 80.0, 120.0, 59.0, 30.0, 100.0, 90.0, 19.0, -2.0, 70.0, 60.0, 150.0, 110.0, 50.0, 73.0, 200.0, 100.0, 130.0, 167.0, 60.0, 120.0, 140.0, 80.0, 130.0, 140.0, 60.0, 86.0, 120.0, 30.0, 107.0, 39.0, 148.0, 50.0, 140.0, 30.0, 8.0, 60.0, 110.0, 120.0, 180.0, 124.0, 73.0, 108.0, 80.0, 190.0, 42.0, 70.0, 130.0, 13.0, 50.0, 29.0, 119.0, 140.0, 120.0, 120.0, 110.0, 79.0, 50.0, 50.0, 30.0, 50.0, 110.0, 180.0, 70.0, 79.0, 90.0, 10.0, 59.0, 140.0, 40.0, 70.0, 40.0, 90.0, 30.0, 40.0, 130.0, 120.0, 30.0, 70.0, 110.0, 210.0, 60.0, 140.0, 90.0, 71.0, 61.0, 120.0, 160.0, 100.0, 80.0, 110.0, 67.0, 40.0, 180.0, 137.0, 69.0, 79.0, 60.0, 60.0, 90.0, 37.0, 35.0, 220.0, 50.0, 80.0, 70.0, 50.0, 70.0, 70.0, 70.0, 40.0, 160.0, 90.0, 100.0, 110.0, 70.0, 130.0, 70.0, -7.0, 50.0, -38.0, 140.0, 100.0, 49.0, 131.0, 60.0, 70.0, -10.0, 90.0, 34.0, 77.0, 110.0, 90.0, 30.0, 138.0, 80.0, 120.0, 26.0, 120.0, 120.0, 110.0, 90.0, 127.0, 27.0, 43.0, 88.0, 134.0, 30.0, 20.0, 80.0, 190.0, 140.0, -2.0, 190.0, 78.0, 59.0, 87.0, 8.0, 160.0, 110.0, 170.0, 59.0, 110.0, 66.0, 150.0, 90.0, 27.0, 100.0, 100.0, 70.0, 150.0, 60.0, 70.0, 110.0, 80.0, 110.0, 100.0, 140.0, 140.0, 100.0, 100.0, 59.0, 29.0, 18.0, 120.0, 39.0, 240.0, 39.0, 120.0, 80.0, 130.0, 114.0, 220.0, 70.0, 110.0, 50.0, 46.0, 8.0, 130.0, 60.0, 110.0, 100.0, 60.0, 100.0, 120.0, 160.0, 40.0, 30.0, 80.0, 160.0, 70.0, 80.0, 20.0, 50.0, 20.0, 60.0, 70.0, 50.0, 50.0, 50.0, 50.0, 22.0, 40.0, 40.0, 50.0, 31.0, 130.0, 32.0, 90.0, 70.0, 70.0, 119.0, 70.0, 47.0, 120.0, 102.0, 193.0, 100.0, 80.0, 26.0, 50.0, 60.0, 80.0, 140.0, 49.0, 50.0, 50.0, 130.0, 90.0, 90.0, 28.0, 25.0, 30.0, -2.0, 120.0, 40.0, 130.0, 120.0, 210.0, 140.0, 110.0, 90.0, 3.0, 27.0, 50.0, 120.0, 70.0, -34.0, 76.0, 170.0, 160.0, 97.0, 79.0, 103.0, 40.0, 280.0, 120.0, 90.0, 143.0, 44.0, 79.0, 150.0, 49.0, 140.0, 130.0, 170.0, 90.0, 48.0, 140.0, 110.0, 60.0, 98.0, 50.0, 120.0, 130.0, 79.0, 70.0, 80.0, 140.0, 160.0, 120.0, 40.0, 90.0, 60.0, 80.0, 140.0, 100.0, 110.0, 100.0, 120.0, 110.0, 110.0, 110.0, 40.0, 30.0, 240.0, 20.0, 140.0, 160.0, 60.0, 60.0, 130.0, 49.0, 170.0, 50.0, 70.0, 44.0, 89.0, 48.0, 130.0, 109.0, 90.0, 150.0, 190.0, 130.0, 80.0, 70.0, 50.0, 160.0, 69.0, 14.0, -290.0, 110.0, 9.0, 80.0, 45.0, 60.0, 126.0, 60.0, 140.0, 70.0, 82.0, 240.0, 90.0, 65.0, 30.0, 130.0, 60.0, 68.0, 60.0, 150.0, 109.0, 70.0, 50.0, 110.0, 108.0, 180.0, 50.0, 95.0, 26.0, 150.0, 70.0, 110.0, -4.0, 72.0, 110.0, 116.0, 250.0, 41.0, -12.0, 0.0, 20.0, 70.0, -10.0, 129.0, 100.0, 70.0, 30.0, 80.0, 14.0, 40.0, 45.0, 90.0, 39.0, 0.0, 140.0, 40.0, 130.0, -48.0, -6.0, 20.0, 170.0, 140.0, 19.0, 58.0, 3.0, 109.0, -20.0, 120.0, 90.0, 50.0, 196.0, 110.0, 150.0, 120.0, 66.0, 50.0, 140.0, 76.0, 110.0, 74.0, 90.0, 140.0, 200.0, 22.0, 160.0, 99.0, 16.0, 89.0, 140.0, 80.0, 110.0, 30.0, 108.0, 150.0, 60.0, 65.0, 170.0, 70.0, 140.0, 70.0, 130.0, 89.0, 110.0, 100.0, 200.0, 20.0, 328.0, 50.0, 170.0, 120.0, 50.0, 77.0, 95.0, 66.0, 226.0, 130.0, 50.0, 140.0, 50.0, 110.0, 120.0, 120.0, 239.0, 54.0, 60.0, -48.0, 100.0, 12.0, 45.0, 80.0, 140.0, 170.0, 70.0, 208.0, 170.0, 13.0, 98.0, 130.0, 80.0, -3.0, 70.0, 189.0, 170.0, 50.0, 170.0, 70.0, 210.0, 70.0, 185.0, 36.0, 80.0, 110.0, 130.0, 100.0, 30.0, -15.0, 36.0, 79.0, 80.0, 50.0, 110.0, 120.0, 140.0, 105.0, 80.0, 60.0, 50.0, 190.0, 19.0, 90.0, 140.0, 80.0, 50.0, 100.0, 95.0, 50.0, 80.0, 120.0, 80.0, 60.0, 40.0, 80.0, 90.0, 110.0, 67.0, 80.0, 99.0, 132.0, 160.0, 78.0, 79.0, 240.0, 70.0, 41.0, 130.0, 150.0, 80.0, 210.0, 110.0, 130.0, 50.0, 70.0, 140.0, 50.0, 50.0, 70.0, 90.0, 140.0, 80.0, 100.0, 26.0, 30.0, 150.0, 40.0, 60.0, 20.0, 6.0, 140.0, 40.0, 145.0, 60.0, 58.0, 88.0, 200.0, 34.0, 121.0, 120.0, 130.0, 77.0, 120.0, 80.0, 40.0, 70.0, 37.0, 60.0, 100.0, 119.0, 80.0, 107.0, 45.0, 45.0, 33.0, 90.0, 120.0, 150.0, 150.0, 27.0, 120.0, 95.0, 70.0, 170.0, 80.0, 169.0, 39.0, 40.0, 110.0, 100.0, 70.0, 20.0, 130.0, 70.0, 130.0, 70.0, 180.0, 120.0, 30.0, 180.0, 110.0, 170.0, 140.0, 160.0, 177.0, 117.0, 70.0, 80.0, -10.0, 120.0, 120.0, 70.0, 150.0, 90.0, 80.0, 55.0, 170.0, 140.0, 25.0, 150.0, 120.0, 3.0, 110.0, 50.0, 50.0, 70.0, 38.0, 100.0, 90.0, 180.0, -1.0, 40.0, 190.0, 48.0, 120.0, 157.0, 100.0, 43.0, 70.0, 130.0, -7.0, 70.0, 190.0, 40.0, 76.0, 130.0, 90.0, 69.0, 99.0, 77.0, 50.0, 90.0, 100.0, 70.0, 15.0, 60.0, 40.0, 130.0, 40.0, 100.0, 70.0, 40.0, 56.0, 60.0, 80.0, 60.0, 110.0, 50.0, 54.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8762219217069986, "mean_inference_ms": 1.8975944146495405, "mean_action_processing_ms": 0.5600951720139504, "mean_env_wait_ms": 1.278548252492985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0129547119140625, "StateBufferConnector_ms": 0.009215116500854492, "ViewRequirementAgentConnector_ms": 0.3858809471130371}, "num_episodes": 18, "episode_return_max": 1340.0, "episode_return_min": 383.0, "episode_return_mean": 888.46}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.568972632791745, "num_env_steps_trained_throughput_per_sec": 20.568972632791745, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 193225.926, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193225.88, "sample_time_ms": 2279.85, "learn_time_ms": 190927.06, "learn_throughput": 20.95, "synch_weights_time_ms": 10.651}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 64, "trial_id": "1841f_00000", "date": "2024-08-08_03-09-29", "timestamp": 1723100969, "time_this_iter_s": 194.47884273529053, "time_total_s": 13753.66555428505, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3369790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13753.66555428505, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 19.04072727272727, "ram_util_percent": 76.972}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.05338737482207, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.748455143076416, "policy_loss": -0.013401726449872501, "vf_loss": 8.760314850710705, "vf_explained_var": -0.02451970345549944, "kl": 0.007710031711899953, "entropy": 0.5405178305122672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 605655.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "env_runners": {"episode_reward_max": 1340.0, "episode_reward_min": 383.0, "episode_reward_mean": 897.09, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 328.0}, "policy_reward_mean": {"policy_0": 89.709}, "custom_metrics": {}, "hist_stats": {"episode_reward": [930.0, 627.0, 1340.0, 1093.0, 857.0, 769.0, 865.0, 389.0, 1005.0, 519.0, 970.0, 800.0, 1224.0, 777.0, 808.0, 941.0, 1103.0, 722.0, 1117.0, 830.0, 728.0, 730.0, 1092.0, 922.0, 762.0, 910.0, 545.0, 795.0, 889.0, 850.0, 1042.0, 990.0, 884.0, 948.0, 910.0, 660.0, 495.0, 981.0, 715.0, 671.0, 786.0, 1215.0, 1043.0, 937.0, 1040.0, 1020.0, 882.0, 1047.0, 383.0, 967.0, 955.0, 995.0, 438.0, 618.0, 445.0, 1092.0, 987.0, 1002.0, 1257.0, 1034.0, 945.0, 1006.0, 1136.0, 762.0, 874.0, 894.0, 826.0, 1160.0, 970.0, 652.0, 1006.0, 833.0, 847.0, 993.0, 1000.0, 1134.0, 1050.0, 811.0, 897.0, 834.0, 695.0, 670.0, 1062.0, 724.0, 776.0, 865.0, 830.0, 870.0, 1080.0, 974.0, 1011.0, 1141.0, 878.0, 1008.0, 1085.0, 859.0, 1048.0, 1100.0, 804.0, 1251.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 70.0, 50.0, 70.0, 80.0, 150.0, 100.0, 130.0, 80.0, 70.0, 76.0, 110.0, -20.0, 80.0, 25.0, 140.0, 80.0, 30.0, 47.0, 59.0, 90.0, 130.0, 150.0, 260.0, 130.0, 70.0, 100.0, 70.0, 70.0, 270.0, 80.0, 79.0, 41.0, 110.0, 101.0, 190.0, 103.0, 109.0, 160.0, 120.0, 73.0, 170.0, 110.0, 50.0, 60.0, 40.0, 60.0, 90.0, 74.0, 130.0, 60.0, 100.0, 70.0, 180.0, 86.0, 56.0, -2.0, 39.0, 80.0, 100.0, 50.0, 10.0, 140.0, 80.0, 100.0, 190.0, 20.0, 65.0, 160.0, 50.0, 78.0, 140.0, -84.0, 60.0, 80.0, -34.0, 30.0, 130.0, -71.0, 60.0, 80.0, 108.0, 47.0, 150.0, 160.0, 50.0, 80.0, 140.0, 140.0, 50.0, 16.0, 40.0, 40.0, 53.0, 90.0, 42.0, 20.0, 140.0, 32.0, 46.0, 50.0, 50.0, 70.0, 80.0, 120.0, 190.0, 40.0, 70.0, 250.0, 50.0, 140.0, 66.0, 20.0, 150.0, 82.0, 25.0, 76.0, 90.0, 150.0, 1.0, 152.0, 160.0, 140.0, 100.0, 170.0, 92.0, 100.0, 90.0, 100.0, 120.0, 150.0, 40.0, 40.0, 8.0, 120.0, 69.0, 90.0, 70.0, 130.0, 60.0, 100.0, 100.0, 110.0, 80.0, 120.0, 59.0, 30.0, 100.0, 90.0, 19.0, -2.0, 70.0, 60.0, 150.0, 110.0, 50.0, 73.0, 200.0, 100.0, 130.0, 167.0, 60.0, 120.0, 140.0, 80.0, 130.0, 140.0, 60.0, 86.0, 120.0, 30.0, 107.0, 39.0, 148.0, 50.0, 140.0, 30.0, 8.0, 60.0, 110.0, 120.0, 180.0, 124.0, 73.0, 108.0, 80.0, 190.0, 42.0, 70.0, 130.0, 13.0, 50.0, 29.0, 119.0, 140.0, 120.0, 120.0, 110.0, 79.0, 50.0, 50.0, 30.0, 50.0, 110.0, 180.0, 70.0, 79.0, 90.0, 10.0, 59.0, 140.0, 40.0, 70.0, 40.0, 90.0, 30.0, 40.0, 130.0, 120.0, 30.0, 70.0, 110.0, 210.0, 60.0, 140.0, 90.0, 71.0, 61.0, 120.0, 160.0, 100.0, 80.0, 110.0, 67.0, 40.0, 180.0, 137.0, 69.0, 79.0, 60.0, 60.0, 90.0, 37.0, 35.0, 220.0, 50.0, 80.0, 70.0, 50.0, 70.0, 70.0, 70.0, 40.0, 160.0, 90.0, 100.0, 110.0, 70.0, 130.0, 70.0, -7.0, 50.0, -38.0, 140.0, 100.0, 49.0, 131.0, 60.0, 70.0, -10.0, 90.0, 34.0, 77.0, 110.0, 90.0, 30.0, 138.0, 80.0, 120.0, 26.0, 120.0, 120.0, 110.0, 90.0, 127.0, 27.0, 43.0, 88.0, 134.0, 30.0, 20.0, 80.0, 190.0, 140.0, -2.0, 190.0, 78.0, 59.0, 87.0, 8.0, 160.0, 110.0, 170.0, 59.0, 110.0, 66.0, 150.0, 90.0, 27.0, 100.0, 100.0, 70.0, 150.0, 60.0, 70.0, 110.0, 80.0, 110.0, 100.0, 140.0, 140.0, 100.0, 100.0, 59.0, 29.0, 18.0, 120.0, 39.0, 240.0, 39.0, 120.0, 80.0, 130.0, 114.0, 220.0, 70.0, 110.0, 50.0, 46.0, 8.0, 130.0, 60.0, 110.0, 100.0, 60.0, 100.0, 120.0, 160.0, 40.0, 30.0, 80.0, 160.0, 70.0, 80.0, 20.0, 50.0, 20.0, 60.0, 70.0, 50.0, 50.0, 50.0, 50.0, 22.0, 40.0, 40.0, 50.0, 31.0, 130.0, 32.0, 90.0, 70.0, 70.0, 119.0, 70.0, 47.0, 120.0, 102.0, 193.0, 100.0, 80.0, 26.0, 50.0, 60.0, 80.0, 140.0, 49.0, 50.0, 50.0, 130.0, 90.0, 90.0, 28.0, 25.0, 30.0, -2.0, 120.0, 40.0, 130.0, 120.0, 210.0, 140.0, 110.0, 90.0, 3.0, 27.0, 50.0, 120.0, 70.0, -34.0, 76.0, 170.0, 160.0, 97.0, 79.0, 103.0, 40.0, 280.0, 120.0, 90.0, 143.0, 44.0, 79.0, 150.0, 49.0, 140.0, 130.0, 170.0, 90.0, 48.0, 140.0, 110.0, 60.0, 98.0, 50.0, 120.0, 130.0, 79.0, 70.0, 80.0, 140.0, 160.0, 120.0, 40.0, 90.0, 60.0, 80.0, 140.0, 100.0, 110.0, 100.0, 120.0, 110.0, 110.0, 110.0, 40.0, 30.0, 240.0, 20.0, 140.0, 160.0, 60.0, 60.0, 130.0, 49.0, 170.0, 50.0, 70.0, 44.0, 89.0, 48.0, 130.0, 109.0, 90.0, 150.0, 190.0, 130.0, 80.0, 70.0, 50.0, 160.0, 69.0, 14.0, -290.0, 110.0, 9.0, 80.0, 45.0, 60.0, 126.0, 60.0, 140.0, 70.0, 82.0, 240.0, 90.0, 65.0, 30.0, 130.0, 60.0, 68.0, 60.0, 150.0, 109.0, 70.0, 50.0, 110.0, 108.0, 180.0, 50.0, 95.0, 26.0, 150.0, 70.0, 110.0, -4.0, 72.0, 110.0, 116.0, 250.0, 41.0, -12.0, 0.0, 20.0, 70.0, -10.0, 129.0, 100.0, 70.0, 30.0, 80.0, 14.0, 40.0, 45.0, 90.0, 39.0, 0.0, 140.0, 40.0, 130.0, -48.0, -6.0, 20.0, 170.0, 140.0, 19.0, 58.0, 3.0, 109.0, -20.0, 120.0, 90.0, 50.0, 196.0, 110.0, 150.0, 120.0, 66.0, 50.0, 140.0, 76.0, 110.0, 74.0, 90.0, 140.0, 200.0, 22.0, 160.0, 99.0, 16.0, 89.0, 140.0, 80.0, 110.0, 30.0, 108.0, 150.0, 60.0, 65.0, 170.0, 70.0, 140.0, 70.0, 130.0, 89.0, 110.0, 100.0, 200.0, 20.0, 328.0, 50.0, 170.0, 120.0, 50.0, 77.0, 95.0, 66.0, 226.0, 130.0, 50.0, 140.0, 50.0, 110.0, 120.0, 120.0, 239.0, 54.0, 60.0, -48.0, 100.0, 12.0, 45.0, 80.0, 140.0, 170.0, 70.0, 208.0, 170.0, 13.0, 98.0, 130.0, 80.0, -3.0, 70.0, 189.0, 170.0, 50.0, 170.0, 70.0, 210.0, 70.0, 185.0, 36.0, 80.0, 110.0, 130.0, 100.0, 30.0, -15.0, 36.0, 79.0, 80.0, 50.0, 110.0, 120.0, 140.0, 105.0, 80.0, 60.0, 50.0, 190.0, 19.0, 90.0, 140.0, 80.0, 50.0, 100.0, 95.0, 50.0, 80.0, 120.0, 80.0, 60.0, 40.0, 80.0, 90.0, 110.0, 67.0, 80.0, 99.0, 132.0, 160.0, 78.0, 79.0, 240.0, 70.0, 41.0, 130.0, 150.0, 80.0, 210.0, 110.0, 130.0, 50.0, 70.0, 140.0, 50.0, 50.0, 70.0, 90.0, 140.0, 80.0, 100.0, 26.0, 30.0, 150.0, 40.0, 60.0, 20.0, 6.0, 140.0, 40.0, 145.0, 60.0, 58.0, 88.0, 200.0, 34.0, 121.0, 120.0, 130.0, 77.0, 120.0, 80.0, 40.0, 70.0, 37.0, 60.0, 100.0, 119.0, 80.0, 107.0, 45.0, 45.0, 33.0, 90.0, 120.0, 150.0, 150.0, 27.0, 120.0, 95.0, 70.0, 170.0, 80.0, 169.0, 39.0, 40.0, 110.0, 100.0, 70.0, 20.0, 130.0, 70.0, 130.0, 70.0, 180.0, 120.0, 30.0, 180.0, 110.0, 170.0, 140.0, 160.0, 177.0, 117.0, 70.0, 80.0, -10.0, 120.0, 120.0, 70.0, 150.0, 90.0, 80.0, 55.0, 170.0, 140.0, 25.0, 150.0, 120.0, 3.0, 110.0, 50.0, 50.0, 70.0, 38.0, 100.0, 90.0, 180.0, -1.0, 40.0, 190.0, 48.0, 120.0, 157.0, 100.0, 43.0, 70.0, 130.0, -7.0, 70.0, 190.0, 40.0, 76.0, 130.0, 90.0, 69.0, 99.0, 77.0, 50.0, 90.0, 100.0, 70.0, 15.0, 60.0, 40.0, 130.0, 40.0, 100.0, 70.0, 40.0, 56.0, 60.0, 80.0, 60.0, 110.0, 50.0, 54.0, 90.0, 130.0, 32.0, 190.0, 100.0, 150.0, 100.0, 130.0, 10.0, 120.0, 100.0, 70.0, 137.0, 75.0, 170.0, 40.0, 30.0, 40.0, 50.0, 65.0, 47.0, 120.0, 30.0, 69.0, 57.0, 30.0, 140.0, 50.0, 90.0, 130.0, 60.0, 85.0, 140.0, 90.0, 180.0, 70.0, 110.0, 30.0, 80.0, 60.0, 20.0, 50.0, 50.0, 60.0, 140.0, 80.0, 160.0, 60.0, 100.0, 70.0, 60.0, 159.0, 133.0, 50.0, 68.0, 50.0, 70.0, 130.0, 80.0, 80.0, 50.0, 150.0, 40.0, 80.0, 60.0, 130.0, 100.0, 160.0, 80.0, 210.0, 70.0, 130.0, 130.0, 90.0, 100.0, 120.0, 40.0, 130.0, 45.0, 70.0, 119.0, 160.0, 80.0, 190.0, 40.0, 80.0, 100.0, 88.0, 130.0, 91.0, 52.0, 69.0, 250.0, 80.0, 23.0, 120.0, 99.0, 130.0, 120.0, 140.0, 110.0, 190.0, 110.0, 1.0, 80.0, 50.0, 107.0, 50.0, 110.0, 110.0, 70.0, 110.0, 90.0, 150.0, 120.0, 100.0, 120.0, 130.0, 27.0, 91.0, 70.0, 70.0, 200.0, 45.0, 150.0, 70.0, 70.0, 90.0, 192.0, 48.0, 150.0, 50.0, 77.0, 150.0, 50.0, 110.0, 22.0, 40.0, 100.0, 110.0, 150.0, 159.0, 119.0, 30.0, 115.0, 75.0, 63.0, 70.0, 120.0, 177.0, 120.0, 120.0, 140.0, 160.0, 130.0, 100.0, 40.0, 170.0, 50.0, 80.0, 110.0, 18.0, 40.0, 69.0, 77.0, 60.0, 63.0, 190.0, 60.0, 118.0, 109.0, 210.0, 150.0, 167.0, 130.0, 80.0, 114.0, 110.0, 88.0, 110.0, 92.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.871159429218873, "mean_inference_ms": 1.8906205276283266, "mean_action_processing_ms": 0.558186424993756, "mean_env_wait_ms": 1.274222804432643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012847423553466797, "StateBufferConnector_ms": 0.009140253067016602, "ViewRequirementAgentConnector_ms": 0.38184237480163574}, "num_episodes": 18, "episode_return_max": 1340.0, "episode_return_min": 383.0, "episode_return_mean": 897.09}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.6648305886371, "num_env_steps_trained_throughput_per_sec": 20.6648305886371, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 2600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2600000, "timers": {"training_iteration_time_ms": 193165.274, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193165.226, "sample_time_ms": 2282.209, "learn_time_ms": 190863.989, "learn_throughput": 20.957, "synch_weights_time_ms": 10.281}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "done": false, "training_iteration": 65, "trial_id": "1841f_00000", "date": "2024-08-08_03-12-43", "timestamp": 1723101163, "time_this_iter_s": 193.57344102859497, "time_total_s": 13947.238995313644, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3359430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13947.238995313644, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.56167883211679, "ram_util_percent": 76.70839416058394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.399179844112315, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.420140663021035, "policy_loss": -0.012472064417146675, "vf_loss": 8.431050343559193, "vf_explained_var": -0.010075018777887915, "kl": 0.007811908147997538, "entropy": 0.5558065914910949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 615045.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 383.0, "episode_reward_mean": 906.91, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 328.0}, "policy_reward_mean": {"policy_0": 90.691}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1092.0, 922.0, 762.0, 910.0, 545.0, 795.0, 889.0, 850.0, 1042.0, 990.0, 884.0, 948.0, 910.0, 660.0, 495.0, 981.0, 715.0, 671.0, 786.0, 1215.0, 1043.0, 937.0, 1040.0, 1020.0, 882.0, 1047.0, 383.0, 967.0, 955.0, 995.0, 438.0, 618.0, 445.0, 1092.0, 987.0, 1002.0, 1257.0, 1034.0, 945.0, 1006.0, 1136.0, 762.0, 874.0, 894.0, 826.0, 1160.0, 970.0, 652.0, 1006.0, 833.0, 847.0, 993.0, 1000.0, 1134.0, 1050.0, 811.0, 897.0, 834.0, 695.0, 670.0, 1062.0, 724.0, 776.0, 865.0, 830.0, 870.0, 1080.0, 974.0, 1011.0, 1141.0, 878.0, 1008.0, 1085.0, 859.0, 1048.0, 1100.0, 804.0, 1251.0, 813.0, 674.0, 921.0, 1258.0, 681.0, 865.0, 1395.0, 963.0, 1042.0, 879.0, 789.0, 616.0, 891.0, 1343.0, 856.0, 939.0, 984.0, 793.0, 867.0, 565.0, 1100.0, 892.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 110.0, 210.0, 60.0, 140.0, 90.0, 71.0, 61.0, 120.0, 160.0, 100.0, 80.0, 110.0, 67.0, 40.0, 180.0, 137.0, 69.0, 79.0, 60.0, 60.0, 90.0, 37.0, 35.0, 220.0, 50.0, 80.0, 70.0, 50.0, 70.0, 70.0, 70.0, 40.0, 160.0, 90.0, 100.0, 110.0, 70.0, 130.0, 70.0, -7.0, 50.0, -38.0, 140.0, 100.0, 49.0, 131.0, 60.0, 70.0, -10.0, 90.0, 34.0, 77.0, 110.0, 90.0, 30.0, 138.0, 80.0, 120.0, 26.0, 120.0, 120.0, 110.0, 90.0, 127.0, 27.0, 43.0, 88.0, 134.0, 30.0, 20.0, 80.0, 190.0, 140.0, -2.0, 190.0, 78.0, 59.0, 87.0, 8.0, 160.0, 110.0, 170.0, 59.0, 110.0, 66.0, 150.0, 90.0, 27.0, 100.0, 100.0, 70.0, 150.0, 60.0, 70.0, 110.0, 80.0, 110.0, 100.0, 140.0, 140.0, 100.0, 100.0, 59.0, 29.0, 18.0, 120.0, 39.0, 240.0, 39.0, 120.0, 80.0, 130.0, 114.0, 220.0, 70.0, 110.0, 50.0, 46.0, 8.0, 130.0, 60.0, 110.0, 100.0, 60.0, 100.0, 120.0, 160.0, 40.0, 30.0, 80.0, 160.0, 70.0, 80.0, 20.0, 50.0, 20.0, 60.0, 70.0, 50.0, 50.0, 50.0, 50.0, 22.0, 40.0, 40.0, 50.0, 31.0, 130.0, 32.0, 90.0, 70.0, 70.0, 119.0, 70.0, 47.0, 120.0, 102.0, 193.0, 100.0, 80.0, 26.0, 50.0, 60.0, 80.0, 140.0, 49.0, 50.0, 50.0, 130.0, 90.0, 90.0, 28.0, 25.0, 30.0, -2.0, 120.0, 40.0, 130.0, 120.0, 210.0, 140.0, 110.0, 90.0, 3.0, 27.0, 50.0, 120.0, 70.0, -34.0, 76.0, 170.0, 160.0, 97.0, 79.0, 103.0, 40.0, 280.0, 120.0, 90.0, 143.0, 44.0, 79.0, 150.0, 49.0, 140.0, 130.0, 170.0, 90.0, 48.0, 140.0, 110.0, 60.0, 98.0, 50.0, 120.0, 130.0, 79.0, 70.0, 80.0, 140.0, 160.0, 120.0, 40.0, 90.0, 60.0, 80.0, 140.0, 100.0, 110.0, 100.0, 120.0, 110.0, 110.0, 110.0, 40.0, 30.0, 240.0, 20.0, 140.0, 160.0, 60.0, 60.0, 130.0, 49.0, 170.0, 50.0, 70.0, 44.0, 89.0, 48.0, 130.0, 109.0, 90.0, 150.0, 190.0, 130.0, 80.0, 70.0, 50.0, 160.0, 69.0, 14.0, -290.0, 110.0, 9.0, 80.0, 45.0, 60.0, 126.0, 60.0, 140.0, 70.0, 82.0, 240.0, 90.0, 65.0, 30.0, 130.0, 60.0, 68.0, 60.0, 150.0, 109.0, 70.0, 50.0, 110.0, 108.0, 180.0, 50.0, 95.0, 26.0, 150.0, 70.0, 110.0, -4.0, 72.0, 110.0, 116.0, 250.0, 41.0, -12.0, 0.0, 20.0, 70.0, -10.0, 129.0, 100.0, 70.0, 30.0, 80.0, 14.0, 40.0, 45.0, 90.0, 39.0, 0.0, 140.0, 40.0, 130.0, -48.0, -6.0, 20.0, 170.0, 140.0, 19.0, 58.0, 3.0, 109.0, -20.0, 120.0, 90.0, 50.0, 196.0, 110.0, 150.0, 120.0, 66.0, 50.0, 140.0, 76.0, 110.0, 74.0, 90.0, 140.0, 200.0, 22.0, 160.0, 99.0, 16.0, 89.0, 140.0, 80.0, 110.0, 30.0, 108.0, 150.0, 60.0, 65.0, 170.0, 70.0, 140.0, 70.0, 130.0, 89.0, 110.0, 100.0, 200.0, 20.0, 328.0, 50.0, 170.0, 120.0, 50.0, 77.0, 95.0, 66.0, 226.0, 130.0, 50.0, 140.0, 50.0, 110.0, 120.0, 120.0, 239.0, 54.0, 60.0, -48.0, 100.0, 12.0, 45.0, 80.0, 140.0, 170.0, 70.0, 208.0, 170.0, 13.0, 98.0, 130.0, 80.0, -3.0, 70.0, 189.0, 170.0, 50.0, 170.0, 70.0, 210.0, 70.0, 185.0, 36.0, 80.0, 110.0, 130.0, 100.0, 30.0, -15.0, 36.0, 79.0, 80.0, 50.0, 110.0, 120.0, 140.0, 105.0, 80.0, 60.0, 50.0, 190.0, 19.0, 90.0, 140.0, 80.0, 50.0, 100.0, 95.0, 50.0, 80.0, 120.0, 80.0, 60.0, 40.0, 80.0, 90.0, 110.0, 67.0, 80.0, 99.0, 132.0, 160.0, 78.0, 79.0, 240.0, 70.0, 41.0, 130.0, 150.0, 80.0, 210.0, 110.0, 130.0, 50.0, 70.0, 140.0, 50.0, 50.0, 70.0, 90.0, 140.0, 80.0, 100.0, 26.0, 30.0, 150.0, 40.0, 60.0, 20.0, 6.0, 140.0, 40.0, 145.0, 60.0, 58.0, 88.0, 200.0, 34.0, 121.0, 120.0, 130.0, 77.0, 120.0, 80.0, 40.0, 70.0, 37.0, 60.0, 100.0, 119.0, 80.0, 107.0, 45.0, 45.0, 33.0, 90.0, 120.0, 150.0, 150.0, 27.0, 120.0, 95.0, 70.0, 170.0, 80.0, 169.0, 39.0, 40.0, 110.0, 100.0, 70.0, 20.0, 130.0, 70.0, 130.0, 70.0, 180.0, 120.0, 30.0, 180.0, 110.0, 170.0, 140.0, 160.0, 177.0, 117.0, 70.0, 80.0, -10.0, 120.0, 120.0, 70.0, 150.0, 90.0, 80.0, 55.0, 170.0, 140.0, 25.0, 150.0, 120.0, 3.0, 110.0, 50.0, 50.0, 70.0, 38.0, 100.0, 90.0, 180.0, -1.0, 40.0, 190.0, 48.0, 120.0, 157.0, 100.0, 43.0, 70.0, 130.0, -7.0, 70.0, 190.0, 40.0, 76.0, 130.0, 90.0, 69.0, 99.0, 77.0, 50.0, 90.0, 100.0, 70.0, 15.0, 60.0, 40.0, 130.0, 40.0, 100.0, 70.0, 40.0, 56.0, 60.0, 80.0, 60.0, 110.0, 50.0, 54.0, 90.0, 130.0, 32.0, 190.0, 100.0, 150.0, 100.0, 130.0, 10.0, 120.0, 100.0, 70.0, 137.0, 75.0, 170.0, 40.0, 30.0, 40.0, 50.0, 65.0, 47.0, 120.0, 30.0, 69.0, 57.0, 30.0, 140.0, 50.0, 90.0, 130.0, 60.0, 85.0, 140.0, 90.0, 180.0, 70.0, 110.0, 30.0, 80.0, 60.0, 20.0, 50.0, 50.0, 60.0, 140.0, 80.0, 160.0, 60.0, 100.0, 70.0, 60.0, 159.0, 133.0, 50.0, 68.0, 50.0, 70.0, 130.0, 80.0, 80.0, 50.0, 150.0, 40.0, 80.0, 60.0, 130.0, 100.0, 160.0, 80.0, 210.0, 70.0, 130.0, 130.0, 90.0, 100.0, 120.0, 40.0, 130.0, 45.0, 70.0, 119.0, 160.0, 80.0, 190.0, 40.0, 80.0, 100.0, 88.0, 130.0, 91.0, 52.0, 69.0, 250.0, 80.0, 23.0, 120.0, 99.0, 130.0, 120.0, 140.0, 110.0, 190.0, 110.0, 1.0, 80.0, 50.0, 107.0, 50.0, 110.0, 110.0, 70.0, 110.0, 90.0, 150.0, 120.0, 100.0, 120.0, 130.0, 27.0, 91.0, 70.0, 70.0, 200.0, 45.0, 150.0, 70.0, 70.0, 90.0, 192.0, 48.0, 150.0, 50.0, 77.0, 150.0, 50.0, 110.0, 22.0, 40.0, 100.0, 110.0, 150.0, 159.0, 119.0, 30.0, 115.0, 75.0, 63.0, 70.0, 120.0, 177.0, 120.0, 120.0, 140.0, 160.0, 130.0, 100.0, 40.0, 170.0, 50.0, 80.0, 110.0, 18.0, 40.0, 69.0, 77.0, 60.0, 63.0, 190.0, 60.0, 118.0, 109.0, 210.0, 150.0, 167.0, 130.0, 80.0, 114.0, 110.0, 88.0, 110.0, 92.0, 80.0, 60.0, 49.0, 59.0, 100.0, 140.0, 60.0, 100.0, 65.0, 100.0, 39.0, 70.0, 100.0, 43.0, 21.0, 100.0, 70.0, 17.0, 110.0, 104.0, 113.0, 130.0, 70.0, 140.0, 110.0, 60.0, 50.0, 118.0, 80.0, 50.0, 120.0, 250.0, 100.0, 70.0, 170.0, 140.0, 80.0, 128.0, 150.0, 50.0, 170.0, 60.0, 140.0, 70.0, 30.0, 106.0, 55.0, 14.0, 20.0, 16.0, 129.0, 20.0, 200.0, 90.0, 40.0, 39.0, 100.0, 80.0, 107.0, 60.0, 140.0, 90.0, 150.0, 130.0, 145.0, 180.0, 240.0, 80.0, 70.0, 170.0, 120.0, 70.0, 200.0, 185.0, 140.0, 55.0, -7.0, 30.0, 80.0, 90.0, 150.0, 102.0, 220.0, 50.0, 90.0, 110.0, 70.0, 140.0, 70.0, 40.0, 50.0, 40.0, 39.0, 50.0, 100.0, 80.0, 160.0, 180.0, 90.0, 90.0, 30.0, 46.0, 141.0, 140.0, 53.0, 40.0, 60.0, 30.0, 200.0, 49.0, 10.0, 150.0, 63.0, 16.0, 40.0, -1.0, 40.0, 140.0, 108.0, 50.0, 40.0, 48.0, 126.0, 200.0, -5.0, 120.0, 82.0, 60.0, 90.0, 130.0, 150.0, 179.0, 42.0, 110.0, 70.0, 152.0, 240.0, 70.0, 140.0, 190.0, 121.0, 90.0, 170.0, -12.0, 77.0, 40.0, 50.0, 160.0, 100.0, 60.0, 160.0, 110.0, 160.0, 50.0, 109.0, 70.0, 60.0, 90.0, 70.0, 60.0, 70.0, 80.0, 190.0, 84.0, 20.0, 190.0, 40.0, 100.0, 140.0, 70.0, 16.0, 50.0, 50.0, 100.0, 120.0, 87.0, 50.0, 140.0, 80.0, 100.0, 193.0, -42.0, 65.0, 110.0, 50.0, 170.0, 150.0, 40.0, 81.0, 50.0, 7.0, 90.0, 100.0, 120.0, 90.0, 40.0, 20.0, -19.0, 40.0, 77.0, 130.0, 100.0, 30.0, 140.0, 200.0, 100.0, 90.0, 110.0, 130.0, 70.0, 50.0, 190.0, 203.0, 32.0, 30.0, 28.0, 80.0, 79.0, 110.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8649858548635927, "mean_inference_ms": 1.8825391602493777, "mean_action_processing_ms": 0.5559145305596291, "mean_env_wait_ms": 1.2692087215625594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012902021408081055, "StateBufferConnector_ms": 0.00921487808227539, "ViewRequirementAgentConnector_ms": 0.3778960704803467}, "num_episodes": 22, "episode_return_max": 1395.0, "episode_return_min": 383.0, "episode_return_mean": 906.91}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.677664437869012, "num_env_steps_trained_throughput_per_sec": 20.677664437869012, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 193126.165, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193126.116, "sample_time_ms": 2277.719, "learn_time_ms": 190829.183, "learn_throughput": 20.961, "synch_weights_time_ms": 10.681}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 66, "trial_id": "1841f_00000", "date": "2024-08-08_03-15-56", "timestamp": 1723101356, "time_this_iter_s": 193.45442986488342, "time_total_s": 14140.693425178528, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33593a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14140.693425178528, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.536630036630036, "ram_util_percent": 77.4930402930403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9226032202870953, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.720286435999682, "policy_loss": -0.01344407861243985, "vf_loss": 8.732194673164457, "vf_explained_var": -0.004915623295421417, "kl": 0.0076792061989015515, "entropy": 0.5352808639994318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 624435.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 383.0, "episode_reward_mean": 924.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 328.0}, "policy_reward_mean": {"policy_0": 92.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1020.0, 882.0, 1047.0, 383.0, 967.0, 955.0, 995.0, 438.0, 618.0, 445.0, 1092.0, 987.0, 1002.0, 1257.0, 1034.0, 945.0, 1006.0, 1136.0, 762.0, 874.0, 894.0, 826.0, 1160.0, 970.0, 652.0, 1006.0, 833.0, 847.0, 993.0, 1000.0, 1134.0, 1050.0, 811.0, 897.0, 834.0, 695.0, 670.0, 1062.0, 724.0, 776.0, 865.0, 830.0, 870.0, 1080.0, 974.0, 1011.0, 1141.0, 878.0, 1008.0, 1085.0, 859.0, 1048.0, 1100.0, 804.0, 1251.0, 813.0, 674.0, 921.0, 1258.0, 681.0, 865.0, 1395.0, 963.0, 1042.0, 879.0, 789.0, 616.0, 891.0, 1343.0, 856.0, 939.0, 984.0, 793.0, 867.0, 565.0, 1100.0, 892.0, 986.0, 1180.0, 1207.0, 797.0, 937.0, 1002.0, 766.0, 1030.0, 512.0, 1103.0, 732.0, 822.0, 988.0, 898.0, 1071.0, 734.0, 1230.0, 773.0, 965.0, 927.0, 1070.0, 971.0, 1170.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 120.0, 110.0, 110.0, 110.0, 40.0, 30.0, 240.0, 20.0, 140.0, 160.0, 60.0, 60.0, 130.0, 49.0, 170.0, 50.0, 70.0, 44.0, 89.0, 48.0, 130.0, 109.0, 90.0, 150.0, 190.0, 130.0, 80.0, 70.0, 50.0, 160.0, 69.0, 14.0, -290.0, 110.0, 9.0, 80.0, 45.0, 60.0, 126.0, 60.0, 140.0, 70.0, 82.0, 240.0, 90.0, 65.0, 30.0, 130.0, 60.0, 68.0, 60.0, 150.0, 109.0, 70.0, 50.0, 110.0, 108.0, 180.0, 50.0, 95.0, 26.0, 150.0, 70.0, 110.0, -4.0, 72.0, 110.0, 116.0, 250.0, 41.0, -12.0, 0.0, 20.0, 70.0, -10.0, 129.0, 100.0, 70.0, 30.0, 80.0, 14.0, 40.0, 45.0, 90.0, 39.0, 0.0, 140.0, 40.0, 130.0, -48.0, -6.0, 20.0, 170.0, 140.0, 19.0, 58.0, 3.0, 109.0, -20.0, 120.0, 90.0, 50.0, 196.0, 110.0, 150.0, 120.0, 66.0, 50.0, 140.0, 76.0, 110.0, 74.0, 90.0, 140.0, 200.0, 22.0, 160.0, 99.0, 16.0, 89.0, 140.0, 80.0, 110.0, 30.0, 108.0, 150.0, 60.0, 65.0, 170.0, 70.0, 140.0, 70.0, 130.0, 89.0, 110.0, 100.0, 200.0, 20.0, 328.0, 50.0, 170.0, 120.0, 50.0, 77.0, 95.0, 66.0, 226.0, 130.0, 50.0, 140.0, 50.0, 110.0, 120.0, 120.0, 239.0, 54.0, 60.0, -48.0, 100.0, 12.0, 45.0, 80.0, 140.0, 170.0, 70.0, 208.0, 170.0, 13.0, 98.0, 130.0, 80.0, -3.0, 70.0, 189.0, 170.0, 50.0, 170.0, 70.0, 210.0, 70.0, 185.0, 36.0, 80.0, 110.0, 130.0, 100.0, 30.0, -15.0, 36.0, 79.0, 80.0, 50.0, 110.0, 120.0, 140.0, 105.0, 80.0, 60.0, 50.0, 190.0, 19.0, 90.0, 140.0, 80.0, 50.0, 100.0, 95.0, 50.0, 80.0, 120.0, 80.0, 60.0, 40.0, 80.0, 90.0, 110.0, 67.0, 80.0, 99.0, 132.0, 160.0, 78.0, 79.0, 240.0, 70.0, 41.0, 130.0, 150.0, 80.0, 210.0, 110.0, 130.0, 50.0, 70.0, 140.0, 50.0, 50.0, 70.0, 90.0, 140.0, 80.0, 100.0, 26.0, 30.0, 150.0, 40.0, 60.0, 20.0, 6.0, 140.0, 40.0, 145.0, 60.0, 58.0, 88.0, 200.0, 34.0, 121.0, 120.0, 130.0, 77.0, 120.0, 80.0, 40.0, 70.0, 37.0, 60.0, 100.0, 119.0, 80.0, 107.0, 45.0, 45.0, 33.0, 90.0, 120.0, 150.0, 150.0, 27.0, 120.0, 95.0, 70.0, 170.0, 80.0, 169.0, 39.0, 40.0, 110.0, 100.0, 70.0, 20.0, 130.0, 70.0, 130.0, 70.0, 180.0, 120.0, 30.0, 180.0, 110.0, 170.0, 140.0, 160.0, 177.0, 117.0, 70.0, 80.0, -10.0, 120.0, 120.0, 70.0, 150.0, 90.0, 80.0, 55.0, 170.0, 140.0, 25.0, 150.0, 120.0, 3.0, 110.0, 50.0, 50.0, 70.0, 38.0, 100.0, 90.0, 180.0, -1.0, 40.0, 190.0, 48.0, 120.0, 157.0, 100.0, 43.0, 70.0, 130.0, -7.0, 70.0, 190.0, 40.0, 76.0, 130.0, 90.0, 69.0, 99.0, 77.0, 50.0, 90.0, 100.0, 70.0, 15.0, 60.0, 40.0, 130.0, 40.0, 100.0, 70.0, 40.0, 56.0, 60.0, 80.0, 60.0, 110.0, 50.0, 54.0, 90.0, 130.0, 32.0, 190.0, 100.0, 150.0, 100.0, 130.0, 10.0, 120.0, 100.0, 70.0, 137.0, 75.0, 170.0, 40.0, 30.0, 40.0, 50.0, 65.0, 47.0, 120.0, 30.0, 69.0, 57.0, 30.0, 140.0, 50.0, 90.0, 130.0, 60.0, 85.0, 140.0, 90.0, 180.0, 70.0, 110.0, 30.0, 80.0, 60.0, 20.0, 50.0, 50.0, 60.0, 140.0, 80.0, 160.0, 60.0, 100.0, 70.0, 60.0, 159.0, 133.0, 50.0, 68.0, 50.0, 70.0, 130.0, 80.0, 80.0, 50.0, 150.0, 40.0, 80.0, 60.0, 130.0, 100.0, 160.0, 80.0, 210.0, 70.0, 130.0, 130.0, 90.0, 100.0, 120.0, 40.0, 130.0, 45.0, 70.0, 119.0, 160.0, 80.0, 190.0, 40.0, 80.0, 100.0, 88.0, 130.0, 91.0, 52.0, 69.0, 250.0, 80.0, 23.0, 120.0, 99.0, 130.0, 120.0, 140.0, 110.0, 190.0, 110.0, 1.0, 80.0, 50.0, 107.0, 50.0, 110.0, 110.0, 70.0, 110.0, 90.0, 150.0, 120.0, 100.0, 120.0, 130.0, 27.0, 91.0, 70.0, 70.0, 200.0, 45.0, 150.0, 70.0, 70.0, 90.0, 192.0, 48.0, 150.0, 50.0, 77.0, 150.0, 50.0, 110.0, 22.0, 40.0, 100.0, 110.0, 150.0, 159.0, 119.0, 30.0, 115.0, 75.0, 63.0, 70.0, 120.0, 177.0, 120.0, 120.0, 140.0, 160.0, 130.0, 100.0, 40.0, 170.0, 50.0, 80.0, 110.0, 18.0, 40.0, 69.0, 77.0, 60.0, 63.0, 190.0, 60.0, 118.0, 109.0, 210.0, 150.0, 167.0, 130.0, 80.0, 114.0, 110.0, 88.0, 110.0, 92.0, 80.0, 60.0, 49.0, 59.0, 100.0, 140.0, 60.0, 100.0, 65.0, 100.0, 39.0, 70.0, 100.0, 43.0, 21.0, 100.0, 70.0, 17.0, 110.0, 104.0, 113.0, 130.0, 70.0, 140.0, 110.0, 60.0, 50.0, 118.0, 80.0, 50.0, 120.0, 250.0, 100.0, 70.0, 170.0, 140.0, 80.0, 128.0, 150.0, 50.0, 170.0, 60.0, 140.0, 70.0, 30.0, 106.0, 55.0, 14.0, 20.0, 16.0, 129.0, 20.0, 200.0, 90.0, 40.0, 39.0, 100.0, 80.0, 107.0, 60.0, 140.0, 90.0, 150.0, 130.0, 145.0, 180.0, 240.0, 80.0, 70.0, 170.0, 120.0, 70.0, 200.0, 185.0, 140.0, 55.0, -7.0, 30.0, 80.0, 90.0, 150.0, 102.0, 220.0, 50.0, 90.0, 110.0, 70.0, 140.0, 70.0, 40.0, 50.0, 40.0, 39.0, 50.0, 100.0, 80.0, 160.0, 180.0, 90.0, 90.0, 30.0, 46.0, 141.0, 140.0, 53.0, 40.0, 60.0, 30.0, 200.0, 49.0, 10.0, 150.0, 63.0, 16.0, 40.0, -1.0, 40.0, 140.0, 108.0, 50.0, 40.0, 48.0, 126.0, 200.0, -5.0, 120.0, 82.0, 60.0, 90.0, 130.0, 150.0, 179.0, 42.0, 110.0, 70.0, 152.0, 240.0, 70.0, 140.0, 190.0, 121.0, 90.0, 170.0, -12.0, 77.0, 40.0, 50.0, 160.0, 100.0, 60.0, 160.0, 110.0, 160.0, 50.0, 109.0, 70.0, 60.0, 90.0, 70.0, 60.0, 70.0, 80.0, 190.0, 84.0, 20.0, 190.0, 40.0, 100.0, 140.0, 70.0, 16.0, 50.0, 50.0, 100.0, 120.0, 87.0, 50.0, 140.0, 80.0, 100.0, 193.0, -42.0, 65.0, 110.0, 50.0, 170.0, 150.0, 40.0, 81.0, 50.0, 7.0, 90.0, 100.0, 120.0, 90.0, 40.0, 20.0, -19.0, 40.0, 77.0, 130.0, 100.0, 30.0, 140.0, 200.0, 100.0, 90.0, 110.0, 130.0, 70.0, 50.0, 190.0, 203.0, 32.0, 30.0, 28.0, 80.0, 79.0, 110.0, 90.0, 84.0, 57.0, 70.0, 190.0, 73.0, 82.0, 60.0, 100.0, 170.0, 100.0, 170.0, 140.0, 150.0, 110.0, 40.0, 80.0, 150.0, 120.0, 140.0, 80.0, 160.0, 90.0, 120.0, 160.0, 100.0, 106.0, 170.0, 110.0, 61.0, 130.0, 94.0, 100.0, 50.0, -5.0, 150.0, 38.0, 120.0, 150.0, 70.0, 30.0, 24.0, 80.0, 90.0, 100.0, 110.0, 80.0, 63.0, 130.0, 90.0, 170.0, 100.0, 130.0, 160.0, 80.0, 120.0, 130.0, 25.0, 17.0, 90.0, 150.0, 80.0, 30.0, 102.0, 85.0, 90.0, 80.0, 100.0, 90.0, 29.0, 80.0, 140.0, 70.0, 20.0, 70.0, 110.0, 170.0, 80.0, 210.0, 120.0, 40.0, 70.0, 23.0, 40.0, 33.0, 80.0, 30.0, 20.0, 6.0, 110.0, 100.0, 100.0, 98.0, 70.0, 138.0, 60.0, 117.0, 120.0, 90.0, 160.0, 150.0, 80.0, 49.0, 160.0, 46.0, 80.0, 70.0, 130.0, 40.0, 37.0, 40.0, 110.0, 80.0, 127.0, 140.0, 100.0, 90.0, 60.0, -5.0, 80.0, 40.0, 60.0, 190.0, 89.0, 140.0, 90.0, 120.0, 60.0, 60.0, 49.0, 130.0, 30.0, 120.0, 130.0, 70.0, 220.0, 80.0, 38.0, 38.0, 102.0, 70.0, 128.0, 130.0, 138.0, 110.0, 110.0, 110.0, 58.0, 90.0, 90.0, 107.0, 29.0, 50.0, 99.0, 10.0, 159.0, 90.0, 70.0, 100.0, 47.0, 80.0, 70.0, 200.0, 150.0, 80.0, 140.0, 60.0, 100.0, 200.0, 70.0, 160.0, 170.0, -21.0, 60.0, 4.0, 140.0, 70.0, 110.0, 140.0, 70.0, 30.0, 130.0, 190.0, 85.0, 60.0, 80.0, 100.0, 70.0, 60.0, 70.0, 120.0, 80.0, 120.0, 130.0, 80.0, 120.0, 110.0, 24.0, 60.0, 123.0, 80.0, 100.0, 140.0, 170.0, 100.0, 100.0, 40.0, 80.0, 90.0, 100.0, 150.0, 60.0, 170.0, 69.0, 27.0, 130.0, 100.0, 106.0, 119.0, 120.0, 70.0, 60.0, 70.0, 70.0, 110.0, 170.0, 160.0, 70.0, 140.0, 220.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8578909390831007, "mean_inference_ms": 1.8741805361186283, "mean_action_processing_ms": 0.5533784963350706, "mean_env_wait_ms": 1.2648423784053864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012509346008300781, "StateBufferConnector_ms": 0.009022235870361328, "ViewRequirementAgentConnector_ms": 0.36894750595092773}, "num_episodes": 23, "episode_return_max": 1395.0, "episode_return_min": 383.0, "episode_return_mean": 924.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.659015030667714, "num_env_steps_trained_throughput_per_sec": 20.659015030667714, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 2680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2680000, "timers": {"training_iteration_time_ms": 193197.396, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193197.349, "sample_time_ms": 2280.499, "learn_time_ms": 190897.256, "learn_throughput": 20.954, "synch_weights_time_ms": 10.844}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "done": false, "training_iteration": 67, "trial_id": "1841f_00000", "date": "2024-08-08_03-19-10", "timestamp": 1723101550, "time_this_iter_s": 193.6301200389862, "time_total_s": 14334.323545217514, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3359790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14334.323545217514, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.413138686131386, "ram_util_percent": 77.17262773722629}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9187357644557443, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.56149025628615, "policy_loss": -0.01221461054515411, "vf_loss": 8.572316010234456, "vf_explained_var": -0.0025823513920695635, "kl": 0.006944244759948354, "entropy": 0.5126538155558772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 633825.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 512.0, "episode_reward_mean": 943.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -42.0}, "policy_reward_max": {"policy_0": 250.0}, "policy_reward_mean": {"policy_0": 94.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [762.0, 874.0, 894.0, 826.0, 1160.0, 970.0, 652.0, 1006.0, 833.0, 847.0, 993.0, 1000.0, 1134.0, 1050.0, 811.0, 897.0, 834.0, 695.0, 670.0, 1062.0, 724.0, 776.0, 865.0, 830.0, 870.0, 1080.0, 974.0, 1011.0, 1141.0, 878.0, 1008.0, 1085.0, 859.0, 1048.0, 1100.0, 804.0, 1251.0, 813.0, 674.0, 921.0, 1258.0, 681.0, 865.0, 1395.0, 963.0, 1042.0, 879.0, 789.0, 616.0, 891.0, 1343.0, 856.0, 939.0, 984.0, 793.0, 867.0, 565.0, 1100.0, 892.0, 986.0, 1180.0, 1207.0, 797.0, 937.0, 1002.0, 766.0, 1030.0, 512.0, 1103.0, 732.0, 822.0, 988.0, 898.0, 1071.0, 734.0, 1230.0, 773.0, 965.0, 927.0, 1070.0, 971.0, 1170.0, 992.0, 894.0, 824.0, 1088.0, 1207.0, 1030.0, 969.0, 869.0, 1150.0, 1247.0, 1039.0, 1175.0, 1200.0, 960.0, 622.0, 1160.0, 805.0, 868.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 185.0, 36.0, 80.0, 110.0, 130.0, 100.0, 30.0, -15.0, 36.0, 79.0, 80.0, 50.0, 110.0, 120.0, 140.0, 105.0, 80.0, 60.0, 50.0, 190.0, 19.0, 90.0, 140.0, 80.0, 50.0, 100.0, 95.0, 50.0, 80.0, 120.0, 80.0, 60.0, 40.0, 80.0, 90.0, 110.0, 67.0, 80.0, 99.0, 132.0, 160.0, 78.0, 79.0, 240.0, 70.0, 41.0, 130.0, 150.0, 80.0, 210.0, 110.0, 130.0, 50.0, 70.0, 140.0, 50.0, 50.0, 70.0, 90.0, 140.0, 80.0, 100.0, 26.0, 30.0, 150.0, 40.0, 60.0, 20.0, 6.0, 140.0, 40.0, 145.0, 60.0, 58.0, 88.0, 200.0, 34.0, 121.0, 120.0, 130.0, 77.0, 120.0, 80.0, 40.0, 70.0, 37.0, 60.0, 100.0, 119.0, 80.0, 107.0, 45.0, 45.0, 33.0, 90.0, 120.0, 150.0, 150.0, 27.0, 120.0, 95.0, 70.0, 170.0, 80.0, 169.0, 39.0, 40.0, 110.0, 100.0, 70.0, 20.0, 130.0, 70.0, 130.0, 70.0, 180.0, 120.0, 30.0, 180.0, 110.0, 170.0, 140.0, 160.0, 177.0, 117.0, 70.0, 80.0, -10.0, 120.0, 120.0, 70.0, 150.0, 90.0, 80.0, 55.0, 170.0, 140.0, 25.0, 150.0, 120.0, 3.0, 110.0, 50.0, 50.0, 70.0, 38.0, 100.0, 90.0, 180.0, -1.0, 40.0, 190.0, 48.0, 120.0, 157.0, 100.0, 43.0, 70.0, 130.0, -7.0, 70.0, 190.0, 40.0, 76.0, 130.0, 90.0, 69.0, 99.0, 77.0, 50.0, 90.0, 100.0, 70.0, 15.0, 60.0, 40.0, 130.0, 40.0, 100.0, 70.0, 40.0, 56.0, 60.0, 80.0, 60.0, 110.0, 50.0, 54.0, 90.0, 130.0, 32.0, 190.0, 100.0, 150.0, 100.0, 130.0, 10.0, 120.0, 100.0, 70.0, 137.0, 75.0, 170.0, 40.0, 30.0, 40.0, 50.0, 65.0, 47.0, 120.0, 30.0, 69.0, 57.0, 30.0, 140.0, 50.0, 90.0, 130.0, 60.0, 85.0, 140.0, 90.0, 180.0, 70.0, 110.0, 30.0, 80.0, 60.0, 20.0, 50.0, 50.0, 60.0, 140.0, 80.0, 160.0, 60.0, 100.0, 70.0, 60.0, 159.0, 133.0, 50.0, 68.0, 50.0, 70.0, 130.0, 80.0, 80.0, 50.0, 150.0, 40.0, 80.0, 60.0, 130.0, 100.0, 160.0, 80.0, 210.0, 70.0, 130.0, 130.0, 90.0, 100.0, 120.0, 40.0, 130.0, 45.0, 70.0, 119.0, 160.0, 80.0, 190.0, 40.0, 80.0, 100.0, 88.0, 130.0, 91.0, 52.0, 69.0, 250.0, 80.0, 23.0, 120.0, 99.0, 130.0, 120.0, 140.0, 110.0, 190.0, 110.0, 1.0, 80.0, 50.0, 107.0, 50.0, 110.0, 110.0, 70.0, 110.0, 90.0, 150.0, 120.0, 100.0, 120.0, 130.0, 27.0, 91.0, 70.0, 70.0, 200.0, 45.0, 150.0, 70.0, 70.0, 90.0, 192.0, 48.0, 150.0, 50.0, 77.0, 150.0, 50.0, 110.0, 22.0, 40.0, 100.0, 110.0, 150.0, 159.0, 119.0, 30.0, 115.0, 75.0, 63.0, 70.0, 120.0, 177.0, 120.0, 120.0, 140.0, 160.0, 130.0, 100.0, 40.0, 170.0, 50.0, 80.0, 110.0, 18.0, 40.0, 69.0, 77.0, 60.0, 63.0, 190.0, 60.0, 118.0, 109.0, 210.0, 150.0, 167.0, 130.0, 80.0, 114.0, 110.0, 88.0, 110.0, 92.0, 80.0, 60.0, 49.0, 59.0, 100.0, 140.0, 60.0, 100.0, 65.0, 100.0, 39.0, 70.0, 100.0, 43.0, 21.0, 100.0, 70.0, 17.0, 110.0, 104.0, 113.0, 130.0, 70.0, 140.0, 110.0, 60.0, 50.0, 118.0, 80.0, 50.0, 120.0, 250.0, 100.0, 70.0, 170.0, 140.0, 80.0, 128.0, 150.0, 50.0, 170.0, 60.0, 140.0, 70.0, 30.0, 106.0, 55.0, 14.0, 20.0, 16.0, 129.0, 20.0, 200.0, 90.0, 40.0, 39.0, 100.0, 80.0, 107.0, 60.0, 140.0, 90.0, 150.0, 130.0, 145.0, 180.0, 240.0, 80.0, 70.0, 170.0, 120.0, 70.0, 200.0, 185.0, 140.0, 55.0, -7.0, 30.0, 80.0, 90.0, 150.0, 102.0, 220.0, 50.0, 90.0, 110.0, 70.0, 140.0, 70.0, 40.0, 50.0, 40.0, 39.0, 50.0, 100.0, 80.0, 160.0, 180.0, 90.0, 90.0, 30.0, 46.0, 141.0, 140.0, 53.0, 40.0, 60.0, 30.0, 200.0, 49.0, 10.0, 150.0, 63.0, 16.0, 40.0, -1.0, 40.0, 140.0, 108.0, 50.0, 40.0, 48.0, 126.0, 200.0, -5.0, 120.0, 82.0, 60.0, 90.0, 130.0, 150.0, 179.0, 42.0, 110.0, 70.0, 152.0, 240.0, 70.0, 140.0, 190.0, 121.0, 90.0, 170.0, -12.0, 77.0, 40.0, 50.0, 160.0, 100.0, 60.0, 160.0, 110.0, 160.0, 50.0, 109.0, 70.0, 60.0, 90.0, 70.0, 60.0, 70.0, 80.0, 190.0, 84.0, 20.0, 190.0, 40.0, 100.0, 140.0, 70.0, 16.0, 50.0, 50.0, 100.0, 120.0, 87.0, 50.0, 140.0, 80.0, 100.0, 193.0, -42.0, 65.0, 110.0, 50.0, 170.0, 150.0, 40.0, 81.0, 50.0, 7.0, 90.0, 100.0, 120.0, 90.0, 40.0, 20.0, -19.0, 40.0, 77.0, 130.0, 100.0, 30.0, 140.0, 200.0, 100.0, 90.0, 110.0, 130.0, 70.0, 50.0, 190.0, 203.0, 32.0, 30.0, 28.0, 80.0, 79.0, 110.0, 90.0, 84.0, 57.0, 70.0, 190.0, 73.0, 82.0, 60.0, 100.0, 170.0, 100.0, 170.0, 140.0, 150.0, 110.0, 40.0, 80.0, 150.0, 120.0, 140.0, 80.0, 160.0, 90.0, 120.0, 160.0, 100.0, 106.0, 170.0, 110.0, 61.0, 130.0, 94.0, 100.0, 50.0, -5.0, 150.0, 38.0, 120.0, 150.0, 70.0, 30.0, 24.0, 80.0, 90.0, 100.0, 110.0, 80.0, 63.0, 130.0, 90.0, 170.0, 100.0, 130.0, 160.0, 80.0, 120.0, 130.0, 25.0, 17.0, 90.0, 150.0, 80.0, 30.0, 102.0, 85.0, 90.0, 80.0, 100.0, 90.0, 29.0, 80.0, 140.0, 70.0, 20.0, 70.0, 110.0, 170.0, 80.0, 210.0, 120.0, 40.0, 70.0, 23.0, 40.0, 33.0, 80.0, 30.0, 20.0, 6.0, 110.0, 100.0, 100.0, 98.0, 70.0, 138.0, 60.0, 117.0, 120.0, 90.0, 160.0, 150.0, 80.0, 49.0, 160.0, 46.0, 80.0, 70.0, 130.0, 40.0, 37.0, 40.0, 110.0, 80.0, 127.0, 140.0, 100.0, 90.0, 60.0, -5.0, 80.0, 40.0, 60.0, 190.0, 89.0, 140.0, 90.0, 120.0, 60.0, 60.0, 49.0, 130.0, 30.0, 120.0, 130.0, 70.0, 220.0, 80.0, 38.0, 38.0, 102.0, 70.0, 128.0, 130.0, 138.0, 110.0, 110.0, 110.0, 58.0, 90.0, 90.0, 107.0, 29.0, 50.0, 99.0, 10.0, 159.0, 90.0, 70.0, 100.0, 47.0, 80.0, 70.0, 200.0, 150.0, 80.0, 140.0, 60.0, 100.0, 200.0, 70.0, 160.0, 170.0, -21.0, 60.0, 4.0, 140.0, 70.0, 110.0, 140.0, 70.0, 30.0, 130.0, 190.0, 85.0, 60.0, 80.0, 100.0, 70.0, 60.0, 70.0, 120.0, 80.0, 120.0, 130.0, 80.0, 120.0, 110.0, 24.0, 60.0, 123.0, 80.0, 100.0, 140.0, 170.0, 100.0, 100.0, 40.0, 80.0, 90.0, 100.0, 150.0, 60.0, 170.0, 69.0, 27.0, 130.0, 100.0, 106.0, 119.0, 120.0, 70.0, 60.0, 70.0, 70.0, 110.0, 170.0, 160.0, 70.0, 140.0, 220.0, 100.0, 80.0, 110.0, 86.0, 38.0, 100.0, 133.0, 130.0, 130.0, 115.0, 70.0, 80.0, 110.0, 90.0, 60.0, 120.0, 60.0, 124.0, 97.0, 84.0, 69.0, 33.0, 230.0, 89.0, 90.0, 110.0, 86.0, 100.0, 94.0, 20.0, -28.0, 120.0, 20.0, 90.0, 200.0, 110.0, 18.0, 150.0, 130.0, 110.0, 140.0, 107.0, 70.0, 200.0, 110.0, 120.0, 50.0, 90.0, 210.0, 180.0, 70.0, 100.0, 80.0, 30.0, 160.0, 130.0, 130.0, 100.0, 70.0, 100.0, 130.0, 100.0, 160.0, 115.0, 84.0, 70.0, 90.0, 110.0, 40.0, 70.0, 130.0, 70.0, 69.0, 150.0, 130.0, 30.0, 110.0, 50.0, 100.0, 90.0, 70.0, 130.0, 90.0, 100.0, 130.0, 190.0, 190.0, 70.0, 100.0, 80.0, 70.0, 150.0, 160.0, 120.0, 120.0, 120.0, 120.0, 37.0, 110.0, 180.0, 130.0, 90.0, 70.0, 69.0, 90.0, 210.0, 50.0, 160.0, 140.0, 50.0, 110.0, 60.0, 100.0, 110.0, 55.0, 210.0, 110.0, 160.0, 140.0, 110.0, 120.0, 120.0, 80.0, 70.0, 70.0, 40.0, 170.0, 220.0, 130.0, 170.0, 130.0, 70.0, 60.0, 140.0, 60.0, 90.0, 100.0, 70.0, 140.0, 160.0, 70.0, 90.0, -27.0, 150.0, 75.0, 50.0, 95.0, 113.0, 11.0, 5.0, 60.0, 140.0, 140.0, 90.0, 60.0, 70.0, 80.0, 50.0, 210.0, 110.0, 210.0, 60.0, 47.0, 40.0, 110.0, 69.0, 170.0, 40.0, 100.0, 120.0, 49.0, 81.0, 73.0, 40.0, 68.0, 110.0, 130.0, 122.0, 94.0, 50.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8536167734263858, "mean_inference_ms": 1.8687705149295197, "mean_action_processing_ms": 0.5520367578522853, "mean_env_wait_ms": 1.260286346004971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011740684509277344, "StateBufferConnector_ms": 0.008846044540405273, "ViewRequirementAgentConnector_ms": 0.3656129837036133}, "num_episodes": 18, "episode_return_max": 1395.0, "episode_return_min": 512.0, "episode_return_mean": 943.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.694380060324903, "num_env_steps_trained_throughput_per_sec": 20.694380060324903, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 193265.592, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193265.544, "sample_time_ms": 2281.97, "learn_time_ms": 190963.884, "learn_throughput": 20.946, "synch_weights_time_ms": 10.571}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 68, "trial_id": "1841f_00000", "date": "2024-08-08_03-22-23", "timestamp": 1723101743, "time_this_iter_s": 193.29690074920654, "time_total_s": 14527.62044596672, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3359a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14527.62044596672, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 16.935766423357666, "ram_util_percent": 75.73613138686132}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.079256482652455, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.292926626540602, "policy_loss": -0.01304628802599788, "vf_loss": 8.304477879287589, "vf_explained_var": -0.004849908730219474, "kl": 0.007475155293379645, "entropy": 0.567882213012352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 643215.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 512.0, "episode_reward_mean": 946.34, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -49.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 94.634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [670.0, 1062.0, 724.0, 776.0, 865.0, 830.0, 870.0, 1080.0, 974.0, 1011.0, 1141.0, 878.0, 1008.0, 1085.0, 859.0, 1048.0, 1100.0, 804.0, 1251.0, 813.0, 674.0, 921.0, 1258.0, 681.0, 865.0, 1395.0, 963.0, 1042.0, 879.0, 789.0, 616.0, 891.0, 1343.0, 856.0, 939.0, 984.0, 793.0, 867.0, 565.0, 1100.0, 892.0, 986.0, 1180.0, 1207.0, 797.0, 937.0, 1002.0, 766.0, 1030.0, 512.0, 1103.0, 732.0, 822.0, 988.0, 898.0, 1071.0, 734.0, 1230.0, 773.0, 965.0, 927.0, 1070.0, 971.0, 1170.0, 992.0, 894.0, 824.0, 1088.0, 1207.0, 1030.0, 969.0, 869.0, 1150.0, 1247.0, 1039.0, 1175.0, 1200.0, 960.0, 622.0, 1160.0, 805.0, 868.0, 886.0, 779.0, 707.0, 633.0, 530.0, 934.0, 969.0, 1076.0, 1315.0, 760.0, 1042.0, 1096.0, 1155.0, 741.0, 1009.0, 1048.0, 745.0, 1077.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 40.0, 56.0, 60.0, 80.0, 60.0, 110.0, 50.0, 54.0, 90.0, 130.0, 32.0, 190.0, 100.0, 150.0, 100.0, 130.0, 10.0, 120.0, 100.0, 70.0, 137.0, 75.0, 170.0, 40.0, 30.0, 40.0, 50.0, 65.0, 47.0, 120.0, 30.0, 69.0, 57.0, 30.0, 140.0, 50.0, 90.0, 130.0, 60.0, 85.0, 140.0, 90.0, 180.0, 70.0, 110.0, 30.0, 80.0, 60.0, 20.0, 50.0, 50.0, 60.0, 140.0, 80.0, 160.0, 60.0, 100.0, 70.0, 60.0, 159.0, 133.0, 50.0, 68.0, 50.0, 70.0, 130.0, 80.0, 80.0, 50.0, 150.0, 40.0, 80.0, 60.0, 130.0, 100.0, 160.0, 80.0, 210.0, 70.0, 130.0, 130.0, 90.0, 100.0, 120.0, 40.0, 130.0, 45.0, 70.0, 119.0, 160.0, 80.0, 190.0, 40.0, 80.0, 100.0, 88.0, 130.0, 91.0, 52.0, 69.0, 250.0, 80.0, 23.0, 120.0, 99.0, 130.0, 120.0, 140.0, 110.0, 190.0, 110.0, 1.0, 80.0, 50.0, 107.0, 50.0, 110.0, 110.0, 70.0, 110.0, 90.0, 150.0, 120.0, 100.0, 120.0, 130.0, 27.0, 91.0, 70.0, 70.0, 200.0, 45.0, 150.0, 70.0, 70.0, 90.0, 192.0, 48.0, 150.0, 50.0, 77.0, 150.0, 50.0, 110.0, 22.0, 40.0, 100.0, 110.0, 150.0, 159.0, 119.0, 30.0, 115.0, 75.0, 63.0, 70.0, 120.0, 177.0, 120.0, 120.0, 140.0, 160.0, 130.0, 100.0, 40.0, 170.0, 50.0, 80.0, 110.0, 18.0, 40.0, 69.0, 77.0, 60.0, 63.0, 190.0, 60.0, 118.0, 109.0, 210.0, 150.0, 167.0, 130.0, 80.0, 114.0, 110.0, 88.0, 110.0, 92.0, 80.0, 60.0, 49.0, 59.0, 100.0, 140.0, 60.0, 100.0, 65.0, 100.0, 39.0, 70.0, 100.0, 43.0, 21.0, 100.0, 70.0, 17.0, 110.0, 104.0, 113.0, 130.0, 70.0, 140.0, 110.0, 60.0, 50.0, 118.0, 80.0, 50.0, 120.0, 250.0, 100.0, 70.0, 170.0, 140.0, 80.0, 128.0, 150.0, 50.0, 170.0, 60.0, 140.0, 70.0, 30.0, 106.0, 55.0, 14.0, 20.0, 16.0, 129.0, 20.0, 200.0, 90.0, 40.0, 39.0, 100.0, 80.0, 107.0, 60.0, 140.0, 90.0, 150.0, 130.0, 145.0, 180.0, 240.0, 80.0, 70.0, 170.0, 120.0, 70.0, 200.0, 185.0, 140.0, 55.0, -7.0, 30.0, 80.0, 90.0, 150.0, 102.0, 220.0, 50.0, 90.0, 110.0, 70.0, 140.0, 70.0, 40.0, 50.0, 40.0, 39.0, 50.0, 100.0, 80.0, 160.0, 180.0, 90.0, 90.0, 30.0, 46.0, 141.0, 140.0, 53.0, 40.0, 60.0, 30.0, 200.0, 49.0, 10.0, 150.0, 63.0, 16.0, 40.0, -1.0, 40.0, 140.0, 108.0, 50.0, 40.0, 48.0, 126.0, 200.0, -5.0, 120.0, 82.0, 60.0, 90.0, 130.0, 150.0, 179.0, 42.0, 110.0, 70.0, 152.0, 240.0, 70.0, 140.0, 190.0, 121.0, 90.0, 170.0, -12.0, 77.0, 40.0, 50.0, 160.0, 100.0, 60.0, 160.0, 110.0, 160.0, 50.0, 109.0, 70.0, 60.0, 90.0, 70.0, 60.0, 70.0, 80.0, 190.0, 84.0, 20.0, 190.0, 40.0, 100.0, 140.0, 70.0, 16.0, 50.0, 50.0, 100.0, 120.0, 87.0, 50.0, 140.0, 80.0, 100.0, 193.0, -42.0, 65.0, 110.0, 50.0, 170.0, 150.0, 40.0, 81.0, 50.0, 7.0, 90.0, 100.0, 120.0, 90.0, 40.0, 20.0, -19.0, 40.0, 77.0, 130.0, 100.0, 30.0, 140.0, 200.0, 100.0, 90.0, 110.0, 130.0, 70.0, 50.0, 190.0, 203.0, 32.0, 30.0, 28.0, 80.0, 79.0, 110.0, 90.0, 84.0, 57.0, 70.0, 190.0, 73.0, 82.0, 60.0, 100.0, 170.0, 100.0, 170.0, 140.0, 150.0, 110.0, 40.0, 80.0, 150.0, 120.0, 140.0, 80.0, 160.0, 90.0, 120.0, 160.0, 100.0, 106.0, 170.0, 110.0, 61.0, 130.0, 94.0, 100.0, 50.0, -5.0, 150.0, 38.0, 120.0, 150.0, 70.0, 30.0, 24.0, 80.0, 90.0, 100.0, 110.0, 80.0, 63.0, 130.0, 90.0, 170.0, 100.0, 130.0, 160.0, 80.0, 120.0, 130.0, 25.0, 17.0, 90.0, 150.0, 80.0, 30.0, 102.0, 85.0, 90.0, 80.0, 100.0, 90.0, 29.0, 80.0, 140.0, 70.0, 20.0, 70.0, 110.0, 170.0, 80.0, 210.0, 120.0, 40.0, 70.0, 23.0, 40.0, 33.0, 80.0, 30.0, 20.0, 6.0, 110.0, 100.0, 100.0, 98.0, 70.0, 138.0, 60.0, 117.0, 120.0, 90.0, 160.0, 150.0, 80.0, 49.0, 160.0, 46.0, 80.0, 70.0, 130.0, 40.0, 37.0, 40.0, 110.0, 80.0, 127.0, 140.0, 100.0, 90.0, 60.0, -5.0, 80.0, 40.0, 60.0, 190.0, 89.0, 140.0, 90.0, 120.0, 60.0, 60.0, 49.0, 130.0, 30.0, 120.0, 130.0, 70.0, 220.0, 80.0, 38.0, 38.0, 102.0, 70.0, 128.0, 130.0, 138.0, 110.0, 110.0, 110.0, 58.0, 90.0, 90.0, 107.0, 29.0, 50.0, 99.0, 10.0, 159.0, 90.0, 70.0, 100.0, 47.0, 80.0, 70.0, 200.0, 150.0, 80.0, 140.0, 60.0, 100.0, 200.0, 70.0, 160.0, 170.0, -21.0, 60.0, 4.0, 140.0, 70.0, 110.0, 140.0, 70.0, 30.0, 130.0, 190.0, 85.0, 60.0, 80.0, 100.0, 70.0, 60.0, 70.0, 120.0, 80.0, 120.0, 130.0, 80.0, 120.0, 110.0, 24.0, 60.0, 123.0, 80.0, 100.0, 140.0, 170.0, 100.0, 100.0, 40.0, 80.0, 90.0, 100.0, 150.0, 60.0, 170.0, 69.0, 27.0, 130.0, 100.0, 106.0, 119.0, 120.0, 70.0, 60.0, 70.0, 70.0, 110.0, 170.0, 160.0, 70.0, 140.0, 220.0, 100.0, 80.0, 110.0, 86.0, 38.0, 100.0, 133.0, 130.0, 130.0, 115.0, 70.0, 80.0, 110.0, 90.0, 60.0, 120.0, 60.0, 124.0, 97.0, 84.0, 69.0, 33.0, 230.0, 89.0, 90.0, 110.0, 86.0, 100.0, 94.0, 20.0, -28.0, 120.0, 20.0, 90.0, 200.0, 110.0, 18.0, 150.0, 130.0, 110.0, 140.0, 107.0, 70.0, 200.0, 110.0, 120.0, 50.0, 90.0, 210.0, 180.0, 70.0, 100.0, 80.0, 30.0, 160.0, 130.0, 130.0, 100.0, 70.0, 100.0, 130.0, 100.0, 160.0, 115.0, 84.0, 70.0, 90.0, 110.0, 40.0, 70.0, 130.0, 70.0, 69.0, 150.0, 130.0, 30.0, 110.0, 50.0, 100.0, 90.0, 70.0, 130.0, 90.0, 100.0, 130.0, 190.0, 190.0, 70.0, 100.0, 80.0, 70.0, 150.0, 160.0, 120.0, 120.0, 120.0, 120.0, 37.0, 110.0, 180.0, 130.0, 90.0, 70.0, 69.0, 90.0, 210.0, 50.0, 160.0, 140.0, 50.0, 110.0, 60.0, 100.0, 110.0, 55.0, 210.0, 110.0, 160.0, 140.0, 110.0, 120.0, 120.0, 80.0, 70.0, 70.0, 40.0, 170.0, 220.0, 130.0, 170.0, 130.0, 70.0, 60.0, 140.0, 60.0, 90.0, 100.0, 70.0, 140.0, 160.0, 70.0, 90.0, -27.0, 150.0, 75.0, 50.0, 95.0, 113.0, 11.0, 5.0, 60.0, 140.0, 140.0, 90.0, 60.0, 70.0, 80.0, 50.0, 210.0, 110.0, 210.0, 60.0, 47.0, 40.0, 110.0, 69.0, 170.0, 40.0, 100.0, 120.0, 49.0, 81.0, 73.0, 40.0, 68.0, 110.0, 130.0, 122.0, 94.0, 50.0, 100.0, 120.0, 60.0, 28.0, 56.0, 190.0, 90.0, 48.0, 134.0, 90.0, 70.0, 70.0, 140.0, 35.0, 30.0, 19.0, 50.0, 146.0, 119.0, 120.0, 50.0, 100.0, 190.0, 110.0, 60.0, 50.0, 15.0, 132.0, 29.0, -49.0, 70.0, 100.0, 60.0, 40.0, 60.0, 30.0, 100.0, 60.0, 130.0, 31.0, 22.0, 50.0, 80.0, 0.0, 60.0, 30.0, 80.0, 60.0, 20.0, 80.0, 70.0, 100.0, 260.0, 35.0, 60.0, 80.0, 70.0, 140.0, 60.0, 20.0, 109.0, 220.0, 80.0, 80.0, 60.0, 80.0, 120.0, 90.0, 80.0, 89.0, 70.0, 160.0, 140.0, 70.0, 130.0, 90.0, 190.0, 130.0, 52.0, 90.0, 24.0, 31.0, 210.0, 149.0, 47.0, 130.0, 38.0, 300.0, 120.0, 220.0, 70.0, 60.0, 70.0, 100.0, 120.0, 80.0, 90.0, 40.0, 30.0, 100.0, 70.0, 190.0, 50.0, 106.0, 80.0, 76.0, 90.0, 90.0, 140.0, 110.0, 110.0, 55.0, 60.0, 130.0, 180.0, 150.0, 80.0, 170.0, 61.0, 70.0, 140.0, 90.0, 120.0, 70.0, 80.0, 160.0, 80.0, 200.0, 250.0, 35.0, 70.0, 40.0, -13.0, 100.0, 100.0, 140.0, 90.0, 110.0, 40.0, 74.0, 60.0, 50.0, 39.0, 120.0, 100.0, 170.0, 160.0, 80.0, 70.0, 140.0, 80.0, 70.0, 89.0, 90.0, 110.0, 89.0, 90.0, 90.0, 120.0, 160.0, 140.0, 30.0, 94.0, 90.0, 25.0, 54.0, 83.0, 70.0, 108.0, 42.0, 149.0, 70.0, 168.0, 170.0, 60.0, 100.0, 70.0, 59.0, 160.0, 70.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8477029871576107, "mean_inference_ms": 1.862725816887737, "mean_action_processing_ms": 0.5503291150763698, "mean_env_wait_ms": 1.2563146814346913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011637210845947266, "StateBufferConnector_ms": 0.008693933486938477, "ViewRequirementAgentConnector_ms": 0.3594226837158203}, "num_episodes": 18, "episode_return_max": 1395.0, "episode_return_min": 512.0, "episode_return_mean": 946.34}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.77465778473254, "num_env_steps_trained_throughput_per_sec": 20.77465778473254, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 2760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2760000, "timers": {"training_iteration_time_ms": 193273.384, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193273.337, "sample_time_ms": 2281.087, "learn_time_ms": 190972.622, "learn_throughput": 20.945, "synch_weights_time_ms": 10.708}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "done": false, "training_iteration": 69, "trial_id": "1841f_00000", "date": "2024-08-08_03-25-36", "timestamp": 1723101936, "time_this_iter_s": 192.5528600215912, "time_total_s": 14720.173305988312, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3359dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14720.173305988312, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 16.87205882352941, "ram_util_percent": 75.67132352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1702060224910893, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.659865775123572, "policy_loss": -0.013471952985381536, "vf_loss": 8.671875296410915, "vf_explained_var": -0.006176999982553549, "kl": 0.0073121195568298875, "entropy": 0.539049292226442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 652605.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 512.0, "episode_reward_mean": 948.48, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -51.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 94.848}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1251.0, 813.0, 674.0, 921.0, 1258.0, 681.0, 865.0, 1395.0, 963.0, 1042.0, 879.0, 789.0, 616.0, 891.0, 1343.0, 856.0, 939.0, 984.0, 793.0, 867.0, 565.0, 1100.0, 892.0, 986.0, 1180.0, 1207.0, 797.0, 937.0, 1002.0, 766.0, 1030.0, 512.0, 1103.0, 732.0, 822.0, 988.0, 898.0, 1071.0, 734.0, 1230.0, 773.0, 965.0, 927.0, 1070.0, 971.0, 1170.0, 992.0, 894.0, 824.0, 1088.0, 1207.0, 1030.0, 969.0, 869.0, 1150.0, 1247.0, 1039.0, 1175.0, 1200.0, 960.0, 622.0, 1160.0, 805.0, 868.0, 886.0, 779.0, 707.0, 633.0, 530.0, 934.0, 969.0, 1076.0, 1315.0, 760.0, 1042.0, 1096.0, 1155.0, 741.0, 1009.0, 1048.0, 745.0, 1077.0, 690.0, 1410.0, 1062.0, 771.0, 989.0, 1060.0, 1117.0, 1191.0, 666.0, 772.0, 658.0, 1086.0, 515.0, 1326.0, 852.0, 987.0, 970.0, 877.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [210.0, 150.0, 167.0, 130.0, 80.0, 114.0, 110.0, 88.0, 110.0, 92.0, 80.0, 60.0, 49.0, 59.0, 100.0, 140.0, 60.0, 100.0, 65.0, 100.0, 39.0, 70.0, 100.0, 43.0, 21.0, 100.0, 70.0, 17.0, 110.0, 104.0, 113.0, 130.0, 70.0, 140.0, 110.0, 60.0, 50.0, 118.0, 80.0, 50.0, 120.0, 250.0, 100.0, 70.0, 170.0, 140.0, 80.0, 128.0, 150.0, 50.0, 170.0, 60.0, 140.0, 70.0, 30.0, 106.0, 55.0, 14.0, 20.0, 16.0, 129.0, 20.0, 200.0, 90.0, 40.0, 39.0, 100.0, 80.0, 107.0, 60.0, 140.0, 90.0, 150.0, 130.0, 145.0, 180.0, 240.0, 80.0, 70.0, 170.0, 120.0, 70.0, 200.0, 185.0, 140.0, 55.0, -7.0, 30.0, 80.0, 90.0, 150.0, 102.0, 220.0, 50.0, 90.0, 110.0, 70.0, 140.0, 70.0, 40.0, 50.0, 40.0, 39.0, 50.0, 100.0, 80.0, 160.0, 180.0, 90.0, 90.0, 30.0, 46.0, 141.0, 140.0, 53.0, 40.0, 60.0, 30.0, 200.0, 49.0, 10.0, 150.0, 63.0, 16.0, 40.0, -1.0, 40.0, 140.0, 108.0, 50.0, 40.0, 48.0, 126.0, 200.0, -5.0, 120.0, 82.0, 60.0, 90.0, 130.0, 150.0, 179.0, 42.0, 110.0, 70.0, 152.0, 240.0, 70.0, 140.0, 190.0, 121.0, 90.0, 170.0, -12.0, 77.0, 40.0, 50.0, 160.0, 100.0, 60.0, 160.0, 110.0, 160.0, 50.0, 109.0, 70.0, 60.0, 90.0, 70.0, 60.0, 70.0, 80.0, 190.0, 84.0, 20.0, 190.0, 40.0, 100.0, 140.0, 70.0, 16.0, 50.0, 50.0, 100.0, 120.0, 87.0, 50.0, 140.0, 80.0, 100.0, 193.0, -42.0, 65.0, 110.0, 50.0, 170.0, 150.0, 40.0, 81.0, 50.0, 7.0, 90.0, 100.0, 120.0, 90.0, 40.0, 20.0, -19.0, 40.0, 77.0, 130.0, 100.0, 30.0, 140.0, 200.0, 100.0, 90.0, 110.0, 130.0, 70.0, 50.0, 190.0, 203.0, 32.0, 30.0, 28.0, 80.0, 79.0, 110.0, 90.0, 84.0, 57.0, 70.0, 190.0, 73.0, 82.0, 60.0, 100.0, 170.0, 100.0, 170.0, 140.0, 150.0, 110.0, 40.0, 80.0, 150.0, 120.0, 140.0, 80.0, 160.0, 90.0, 120.0, 160.0, 100.0, 106.0, 170.0, 110.0, 61.0, 130.0, 94.0, 100.0, 50.0, -5.0, 150.0, 38.0, 120.0, 150.0, 70.0, 30.0, 24.0, 80.0, 90.0, 100.0, 110.0, 80.0, 63.0, 130.0, 90.0, 170.0, 100.0, 130.0, 160.0, 80.0, 120.0, 130.0, 25.0, 17.0, 90.0, 150.0, 80.0, 30.0, 102.0, 85.0, 90.0, 80.0, 100.0, 90.0, 29.0, 80.0, 140.0, 70.0, 20.0, 70.0, 110.0, 170.0, 80.0, 210.0, 120.0, 40.0, 70.0, 23.0, 40.0, 33.0, 80.0, 30.0, 20.0, 6.0, 110.0, 100.0, 100.0, 98.0, 70.0, 138.0, 60.0, 117.0, 120.0, 90.0, 160.0, 150.0, 80.0, 49.0, 160.0, 46.0, 80.0, 70.0, 130.0, 40.0, 37.0, 40.0, 110.0, 80.0, 127.0, 140.0, 100.0, 90.0, 60.0, -5.0, 80.0, 40.0, 60.0, 190.0, 89.0, 140.0, 90.0, 120.0, 60.0, 60.0, 49.0, 130.0, 30.0, 120.0, 130.0, 70.0, 220.0, 80.0, 38.0, 38.0, 102.0, 70.0, 128.0, 130.0, 138.0, 110.0, 110.0, 110.0, 58.0, 90.0, 90.0, 107.0, 29.0, 50.0, 99.0, 10.0, 159.0, 90.0, 70.0, 100.0, 47.0, 80.0, 70.0, 200.0, 150.0, 80.0, 140.0, 60.0, 100.0, 200.0, 70.0, 160.0, 170.0, -21.0, 60.0, 4.0, 140.0, 70.0, 110.0, 140.0, 70.0, 30.0, 130.0, 190.0, 85.0, 60.0, 80.0, 100.0, 70.0, 60.0, 70.0, 120.0, 80.0, 120.0, 130.0, 80.0, 120.0, 110.0, 24.0, 60.0, 123.0, 80.0, 100.0, 140.0, 170.0, 100.0, 100.0, 40.0, 80.0, 90.0, 100.0, 150.0, 60.0, 170.0, 69.0, 27.0, 130.0, 100.0, 106.0, 119.0, 120.0, 70.0, 60.0, 70.0, 70.0, 110.0, 170.0, 160.0, 70.0, 140.0, 220.0, 100.0, 80.0, 110.0, 86.0, 38.0, 100.0, 133.0, 130.0, 130.0, 115.0, 70.0, 80.0, 110.0, 90.0, 60.0, 120.0, 60.0, 124.0, 97.0, 84.0, 69.0, 33.0, 230.0, 89.0, 90.0, 110.0, 86.0, 100.0, 94.0, 20.0, -28.0, 120.0, 20.0, 90.0, 200.0, 110.0, 18.0, 150.0, 130.0, 110.0, 140.0, 107.0, 70.0, 200.0, 110.0, 120.0, 50.0, 90.0, 210.0, 180.0, 70.0, 100.0, 80.0, 30.0, 160.0, 130.0, 130.0, 100.0, 70.0, 100.0, 130.0, 100.0, 160.0, 115.0, 84.0, 70.0, 90.0, 110.0, 40.0, 70.0, 130.0, 70.0, 69.0, 150.0, 130.0, 30.0, 110.0, 50.0, 100.0, 90.0, 70.0, 130.0, 90.0, 100.0, 130.0, 190.0, 190.0, 70.0, 100.0, 80.0, 70.0, 150.0, 160.0, 120.0, 120.0, 120.0, 120.0, 37.0, 110.0, 180.0, 130.0, 90.0, 70.0, 69.0, 90.0, 210.0, 50.0, 160.0, 140.0, 50.0, 110.0, 60.0, 100.0, 110.0, 55.0, 210.0, 110.0, 160.0, 140.0, 110.0, 120.0, 120.0, 80.0, 70.0, 70.0, 40.0, 170.0, 220.0, 130.0, 170.0, 130.0, 70.0, 60.0, 140.0, 60.0, 90.0, 100.0, 70.0, 140.0, 160.0, 70.0, 90.0, -27.0, 150.0, 75.0, 50.0, 95.0, 113.0, 11.0, 5.0, 60.0, 140.0, 140.0, 90.0, 60.0, 70.0, 80.0, 50.0, 210.0, 110.0, 210.0, 60.0, 47.0, 40.0, 110.0, 69.0, 170.0, 40.0, 100.0, 120.0, 49.0, 81.0, 73.0, 40.0, 68.0, 110.0, 130.0, 122.0, 94.0, 50.0, 100.0, 120.0, 60.0, 28.0, 56.0, 190.0, 90.0, 48.0, 134.0, 90.0, 70.0, 70.0, 140.0, 35.0, 30.0, 19.0, 50.0, 146.0, 119.0, 120.0, 50.0, 100.0, 190.0, 110.0, 60.0, 50.0, 15.0, 132.0, 29.0, -49.0, 70.0, 100.0, 60.0, 40.0, 60.0, 30.0, 100.0, 60.0, 130.0, 31.0, 22.0, 50.0, 80.0, 0.0, 60.0, 30.0, 80.0, 60.0, 20.0, 80.0, 70.0, 100.0, 260.0, 35.0, 60.0, 80.0, 70.0, 140.0, 60.0, 20.0, 109.0, 220.0, 80.0, 80.0, 60.0, 80.0, 120.0, 90.0, 80.0, 89.0, 70.0, 160.0, 140.0, 70.0, 130.0, 90.0, 190.0, 130.0, 52.0, 90.0, 24.0, 31.0, 210.0, 149.0, 47.0, 130.0, 38.0, 300.0, 120.0, 220.0, 70.0, 60.0, 70.0, 100.0, 120.0, 80.0, 90.0, 40.0, 30.0, 100.0, 70.0, 190.0, 50.0, 106.0, 80.0, 76.0, 90.0, 90.0, 140.0, 110.0, 110.0, 55.0, 60.0, 130.0, 180.0, 150.0, 80.0, 170.0, 61.0, 70.0, 140.0, 90.0, 120.0, 70.0, 80.0, 160.0, 80.0, 200.0, 250.0, 35.0, 70.0, 40.0, -13.0, 100.0, 100.0, 140.0, 90.0, 110.0, 40.0, 74.0, 60.0, 50.0, 39.0, 120.0, 100.0, 170.0, 160.0, 80.0, 70.0, 140.0, 80.0, 70.0, 89.0, 90.0, 110.0, 89.0, 90.0, 90.0, 120.0, 160.0, 140.0, 30.0, 94.0, 90.0, 25.0, 54.0, 83.0, 70.0, 108.0, 42.0, 149.0, 70.0, 168.0, 170.0, 60.0, 100.0, 70.0, 59.0, 160.0, 70.0, 150.0, 10.0, 50.0, 80.0, 50.0, 60.0, 90.0, 70.0, 120.0, 80.0, 80.0, 90.0, 150.0, 50.0, 170.0, 160.0, 110.0, 130.0, 160.0, 180.0, 210.0, 170.0, 97.0, 80.0, 57.0, -12.0, 180.0, 110.0, 120.0, 90.0, 170.0, 40.0, 200.0, 90.0, 50.0, 150.0, 46.0, 50.0, 40.0, 5.0, 100.0, 220.0, 100.0, 130.0, 28.0, 70.0, 100.0, 41.0, 140.0, 90.0, 70.0, 60.0, 100.0, 100.0, 140.0, 150.0, 130.0, 70.0, 180.0, 110.0, 20.0, 70.0, 112.0, 100.0, 100.0, 108.0, 156.0, 181.0, 90.0, 70.0, 130.0, 82.0, 90.0, 260.0, 90.0, 41.0, 90.0, 140.0, 138.0, 110.0, 150.0, 100.0, 80.0, 9.0, 10.0, 60.0, 80.0, 10.0, 110.0, -3.0, 210.0, 54.0, 108.0, 28.0, 18.0, 80.0, 100.0, 200.0, 69.0, 160.0, -45.0, 100.0, -31.0, 170.0, 70.0, -13.0, 32.0, 30.0, 60.0, 170.0, 70.0, 93.0, 80.0, 115.0, 140.0, 160.0, -2.0, 200.0, 60.0, 100.0, 140.0, 160.0, -51.0, 90.0, 47.0, 20.0, 50.0, 100.0, 65.0, 34.0, 0.0, 60.0, 200.0, 110.0, 160.0, 50.0, 260.0, 60.0, 70.0, 186.0, 170.0, 110.0, 130.0, 50.0, 110.0, 140.0, 50.0, 90.0, 56.0, 36.0, 80.0, 69.0, 100.0, 33.0, 200.0, 45.0, 100.0, 140.0, 150.0, 80.0, 70.0, 110.0, 160.0, 60.0, 80.0, 70.0, 170.0, 80.0, 70.0, 40.0, 130.0, 110.0, 140.0, 18.0, -2.0, 53.0, 18.0, 140.0, 140.0, 200.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.841704142207347, "mean_inference_ms": 1.856804532757292, "mean_action_processing_ms": 0.5486570569778838, "mean_env_wait_ms": 1.2524507833014138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011740684509277344, "StateBufferConnector_ms": 0.008774042129516602, "ViewRequirementAgentConnector_ms": 0.3664240837097168}, "num_episodes": 18, "episode_return_max": 1410.0, "episode_return_min": 512.0, "episode_return_mean": 948.48}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.736203745478484, "num_env_steps_trained_throughput_per_sec": 20.736203745478484, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 193390.914, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193390.867, "sample_time_ms": 2280.44, "learn_time_ms": 191091.158, "learn_throughput": 20.932, "synch_weights_time_ms": 10.552}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 70, "trial_id": "1841f_00000", "date": "2024-08-08_03-28-48", "timestamp": 1723102128, "time_this_iter_s": 192.9105019569397, "time_total_s": 14913.083807945251, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33ab940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14913.083807945251, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 16.96227106227106, "ram_util_percent": 75.94395604395606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6682292971875086, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.629876227322987, "policy_loss": -0.013806221199222405, "vf_loss": 8.642084223165298, "vf_explained_var": -0.0025911673824119364, "kl": 0.00799113480701203, "entropy": 0.5317473406291491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 661995.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 512.0, "episode_reward_mean": 961.71, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -51.0}, "policy_reward_max": {"policy_0": 330.0}, "policy_reward_mean": {"policy_0": 96.171}, "custom_metrics": {}, "hist_stats": {"episode_reward": [892.0, 986.0, 1180.0, 1207.0, 797.0, 937.0, 1002.0, 766.0, 1030.0, 512.0, 1103.0, 732.0, 822.0, 988.0, 898.0, 1071.0, 734.0, 1230.0, 773.0, 965.0, 927.0, 1070.0, 971.0, 1170.0, 992.0, 894.0, 824.0, 1088.0, 1207.0, 1030.0, 969.0, 869.0, 1150.0, 1247.0, 1039.0, 1175.0, 1200.0, 960.0, 622.0, 1160.0, 805.0, 868.0, 886.0, 779.0, 707.0, 633.0, 530.0, 934.0, 969.0, 1076.0, 1315.0, 760.0, 1042.0, 1096.0, 1155.0, 741.0, 1009.0, 1048.0, 745.0, 1077.0, 690.0, 1410.0, 1062.0, 771.0, 989.0, 1060.0, 1117.0, 1191.0, 666.0, 772.0, 658.0, 1086.0, 515.0, 1326.0, 852.0, 987.0, 970.0, 877.0, 1320.0, 783.0, 925.0, 1190.0, 609.0, 675.0, 1145.0, 1045.0, 1055.0, 809.0, 915.0, 1220.0, 1019.0, 1004.0, 899.0, 1174.0, 1036.0, 1028.0, 800.0, 1343.0, 784.0, 1030.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 190.0, 203.0, 32.0, 30.0, 28.0, 80.0, 79.0, 110.0, 90.0, 84.0, 57.0, 70.0, 190.0, 73.0, 82.0, 60.0, 100.0, 170.0, 100.0, 170.0, 140.0, 150.0, 110.0, 40.0, 80.0, 150.0, 120.0, 140.0, 80.0, 160.0, 90.0, 120.0, 160.0, 100.0, 106.0, 170.0, 110.0, 61.0, 130.0, 94.0, 100.0, 50.0, -5.0, 150.0, 38.0, 120.0, 150.0, 70.0, 30.0, 24.0, 80.0, 90.0, 100.0, 110.0, 80.0, 63.0, 130.0, 90.0, 170.0, 100.0, 130.0, 160.0, 80.0, 120.0, 130.0, 25.0, 17.0, 90.0, 150.0, 80.0, 30.0, 102.0, 85.0, 90.0, 80.0, 100.0, 90.0, 29.0, 80.0, 140.0, 70.0, 20.0, 70.0, 110.0, 170.0, 80.0, 210.0, 120.0, 40.0, 70.0, 23.0, 40.0, 33.0, 80.0, 30.0, 20.0, 6.0, 110.0, 100.0, 100.0, 98.0, 70.0, 138.0, 60.0, 117.0, 120.0, 90.0, 160.0, 150.0, 80.0, 49.0, 160.0, 46.0, 80.0, 70.0, 130.0, 40.0, 37.0, 40.0, 110.0, 80.0, 127.0, 140.0, 100.0, 90.0, 60.0, -5.0, 80.0, 40.0, 60.0, 190.0, 89.0, 140.0, 90.0, 120.0, 60.0, 60.0, 49.0, 130.0, 30.0, 120.0, 130.0, 70.0, 220.0, 80.0, 38.0, 38.0, 102.0, 70.0, 128.0, 130.0, 138.0, 110.0, 110.0, 110.0, 58.0, 90.0, 90.0, 107.0, 29.0, 50.0, 99.0, 10.0, 159.0, 90.0, 70.0, 100.0, 47.0, 80.0, 70.0, 200.0, 150.0, 80.0, 140.0, 60.0, 100.0, 200.0, 70.0, 160.0, 170.0, -21.0, 60.0, 4.0, 140.0, 70.0, 110.0, 140.0, 70.0, 30.0, 130.0, 190.0, 85.0, 60.0, 80.0, 100.0, 70.0, 60.0, 70.0, 120.0, 80.0, 120.0, 130.0, 80.0, 120.0, 110.0, 24.0, 60.0, 123.0, 80.0, 100.0, 140.0, 170.0, 100.0, 100.0, 40.0, 80.0, 90.0, 100.0, 150.0, 60.0, 170.0, 69.0, 27.0, 130.0, 100.0, 106.0, 119.0, 120.0, 70.0, 60.0, 70.0, 70.0, 110.0, 170.0, 160.0, 70.0, 140.0, 220.0, 100.0, 80.0, 110.0, 86.0, 38.0, 100.0, 133.0, 130.0, 130.0, 115.0, 70.0, 80.0, 110.0, 90.0, 60.0, 120.0, 60.0, 124.0, 97.0, 84.0, 69.0, 33.0, 230.0, 89.0, 90.0, 110.0, 86.0, 100.0, 94.0, 20.0, -28.0, 120.0, 20.0, 90.0, 200.0, 110.0, 18.0, 150.0, 130.0, 110.0, 140.0, 107.0, 70.0, 200.0, 110.0, 120.0, 50.0, 90.0, 210.0, 180.0, 70.0, 100.0, 80.0, 30.0, 160.0, 130.0, 130.0, 100.0, 70.0, 100.0, 130.0, 100.0, 160.0, 115.0, 84.0, 70.0, 90.0, 110.0, 40.0, 70.0, 130.0, 70.0, 69.0, 150.0, 130.0, 30.0, 110.0, 50.0, 100.0, 90.0, 70.0, 130.0, 90.0, 100.0, 130.0, 190.0, 190.0, 70.0, 100.0, 80.0, 70.0, 150.0, 160.0, 120.0, 120.0, 120.0, 120.0, 37.0, 110.0, 180.0, 130.0, 90.0, 70.0, 69.0, 90.0, 210.0, 50.0, 160.0, 140.0, 50.0, 110.0, 60.0, 100.0, 110.0, 55.0, 210.0, 110.0, 160.0, 140.0, 110.0, 120.0, 120.0, 80.0, 70.0, 70.0, 40.0, 170.0, 220.0, 130.0, 170.0, 130.0, 70.0, 60.0, 140.0, 60.0, 90.0, 100.0, 70.0, 140.0, 160.0, 70.0, 90.0, -27.0, 150.0, 75.0, 50.0, 95.0, 113.0, 11.0, 5.0, 60.0, 140.0, 140.0, 90.0, 60.0, 70.0, 80.0, 50.0, 210.0, 110.0, 210.0, 60.0, 47.0, 40.0, 110.0, 69.0, 170.0, 40.0, 100.0, 120.0, 49.0, 81.0, 73.0, 40.0, 68.0, 110.0, 130.0, 122.0, 94.0, 50.0, 100.0, 120.0, 60.0, 28.0, 56.0, 190.0, 90.0, 48.0, 134.0, 90.0, 70.0, 70.0, 140.0, 35.0, 30.0, 19.0, 50.0, 146.0, 119.0, 120.0, 50.0, 100.0, 190.0, 110.0, 60.0, 50.0, 15.0, 132.0, 29.0, -49.0, 70.0, 100.0, 60.0, 40.0, 60.0, 30.0, 100.0, 60.0, 130.0, 31.0, 22.0, 50.0, 80.0, 0.0, 60.0, 30.0, 80.0, 60.0, 20.0, 80.0, 70.0, 100.0, 260.0, 35.0, 60.0, 80.0, 70.0, 140.0, 60.0, 20.0, 109.0, 220.0, 80.0, 80.0, 60.0, 80.0, 120.0, 90.0, 80.0, 89.0, 70.0, 160.0, 140.0, 70.0, 130.0, 90.0, 190.0, 130.0, 52.0, 90.0, 24.0, 31.0, 210.0, 149.0, 47.0, 130.0, 38.0, 300.0, 120.0, 220.0, 70.0, 60.0, 70.0, 100.0, 120.0, 80.0, 90.0, 40.0, 30.0, 100.0, 70.0, 190.0, 50.0, 106.0, 80.0, 76.0, 90.0, 90.0, 140.0, 110.0, 110.0, 55.0, 60.0, 130.0, 180.0, 150.0, 80.0, 170.0, 61.0, 70.0, 140.0, 90.0, 120.0, 70.0, 80.0, 160.0, 80.0, 200.0, 250.0, 35.0, 70.0, 40.0, -13.0, 100.0, 100.0, 140.0, 90.0, 110.0, 40.0, 74.0, 60.0, 50.0, 39.0, 120.0, 100.0, 170.0, 160.0, 80.0, 70.0, 140.0, 80.0, 70.0, 89.0, 90.0, 110.0, 89.0, 90.0, 90.0, 120.0, 160.0, 140.0, 30.0, 94.0, 90.0, 25.0, 54.0, 83.0, 70.0, 108.0, 42.0, 149.0, 70.0, 168.0, 170.0, 60.0, 100.0, 70.0, 59.0, 160.0, 70.0, 150.0, 10.0, 50.0, 80.0, 50.0, 60.0, 90.0, 70.0, 120.0, 80.0, 80.0, 90.0, 150.0, 50.0, 170.0, 160.0, 110.0, 130.0, 160.0, 180.0, 210.0, 170.0, 97.0, 80.0, 57.0, -12.0, 180.0, 110.0, 120.0, 90.0, 170.0, 40.0, 200.0, 90.0, 50.0, 150.0, 46.0, 50.0, 40.0, 5.0, 100.0, 220.0, 100.0, 130.0, 28.0, 70.0, 100.0, 41.0, 140.0, 90.0, 70.0, 60.0, 100.0, 100.0, 140.0, 150.0, 130.0, 70.0, 180.0, 110.0, 20.0, 70.0, 112.0, 100.0, 100.0, 108.0, 156.0, 181.0, 90.0, 70.0, 130.0, 82.0, 90.0, 260.0, 90.0, 41.0, 90.0, 140.0, 138.0, 110.0, 150.0, 100.0, 80.0, 9.0, 10.0, 60.0, 80.0, 10.0, 110.0, -3.0, 210.0, 54.0, 108.0, 28.0, 18.0, 80.0, 100.0, 200.0, 69.0, 160.0, -45.0, 100.0, -31.0, 170.0, 70.0, -13.0, 32.0, 30.0, 60.0, 170.0, 70.0, 93.0, 80.0, 115.0, 140.0, 160.0, -2.0, 200.0, 60.0, 100.0, 140.0, 160.0, -51.0, 90.0, 47.0, 20.0, 50.0, 100.0, 65.0, 34.0, 0.0, 60.0, 200.0, 110.0, 160.0, 50.0, 260.0, 60.0, 70.0, 186.0, 170.0, 110.0, 130.0, 50.0, 110.0, 140.0, 50.0, 90.0, 56.0, 36.0, 80.0, 69.0, 100.0, 33.0, 200.0, 45.0, 100.0, 140.0, 150.0, 80.0, 70.0, 110.0, 160.0, 60.0, 80.0, 70.0, 170.0, 80.0, 70.0, 40.0, 130.0, 110.0, 140.0, 18.0, -2.0, 53.0, 18.0, 140.0, 140.0, 200.0, 60.0, 140.0, 70.0, 200.0, 100.0, 200.0, 120.0, 130.0, 140.0, 90.0, 130.0, 40.0, 36.0, 90.0, 40.0, 60.0, 170.0, 110.0, 77.0, 80.0, 80.0, 80.0, 190.0, 50.0, 140.0, 63.0, 75.0, 50.0, 70.0, 38.0, 169.0, 120.0, 140.0, 110.0, 100.0, 200.0, 100.0, 140.0, 180.0, 50.0, 50.0, 40.0, 90.0, 50.0, 60.0, 90.0, 60.0, 70.0, 60.0, 49.0, 40.0, 67.0, 100.0, 60.0, 60.0, 98.0, 40.0, 70.0, 90.0, 20.0, 70.0, 80.0, 110.0, 140.0, 55.0, 130.0, 150.0, 50.0, 150.0, 150.0, 130.0, 110.0, 80.0, 100.0, 150.0, 110.0, 70.0, 70.0, 170.0, 120.0, 65.0, 130.0, 160.0, 99.0, 136.0, 40.0, 100.0, 40.0, 80.0, 200.0, 70.0, 60.0, 100.0, 90.0, 52.0, 50.0, 160.0, 51.0, 150.0, 39.0, 57.0, 70.0, 104.0, 80.0, 90.0, 60.0, 100.0, 70.0, 50.0, 141.0, 150.0, 190.0, 110.0, 50.0, 160.0, 90.0, 120.0, 130.0, 100.0, 120.0, 150.0, 140.0, 130.0, 69.0, 92.0, 60.0, 98.0, 100.0, 100.0, 90.0, 140.0, 120.0, 150.0, 90.0, 105.0, 59.0, 140.0, 20.0, 100.0, 110.0, 110.0, 130.0, 80.0, 38.0, 100.0, 80.0, 60.0, 75.0, 56.0, 200.0, 80.0, 120.0, 90.0, 70.0, 90.0, 90.0, 196.0, 150.0, 128.0, 90.0, 150.0, 53.0, 87.0, 110.0, 80.0, 110.0, 90.0, 126.0, 100.0, 170.0, 110.0, 130.0, 95.0, 180.0, 30.0, 140.0, 40.0, 50.0, 83.0, 170.0, 110.0, 135.0, 130.0, 30.0, 83.0, 120.0, 40.0, 110.0, 52.0, 50.0, 50.0, 104.0, 70.0, 80.0, 140.0, 120.0, 119.0, 330.0, 90.0, 140.0, 150.0, 120.0, 100.0, 130.0, 110.0, 70.0, 50.0, 80.0, 50.0, 49.0, 25.0, 90.0, 80.0, 90.0, 90.0, 70.0, 130.0, 140.0, 200.0, 60.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8345949181050505, "mean_inference_ms": 1.8497092989422015, "mean_action_processing_ms": 0.5466257893001943, "mean_env_wait_ms": 1.2478257594458164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012010574340820312, "StateBufferConnector_ms": 0.009075164794921875, "ViewRequirementAgentConnector_ms": 0.3711354732513428}, "num_episodes": 22, "episode_return_max": 1410.0, "episode_return_min": 512.0, "episode_return_mean": 961.71}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.63624120919835, "num_env_steps_trained_throughput_per_sec": 20.63624120919835, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 2840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2840000, "timers": {"training_iteration_time_ms": 193409.369, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193409.323, "sample_time_ms": 2278.462, "learn_time_ms": 191111.65, "learn_throughput": 20.93, "synch_weights_time_ms": 10.55}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "done": false, "training_iteration": 71, "trial_id": "1841f_00000", "date": "2024-08-08_03-32-02", "timestamp": 1723102322, "time_this_iter_s": 193.84488081932068, "time_total_s": 15106.928688764572, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33ab700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15106.928688764572, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.264963503649636, "ram_util_percent": 75.1817518248175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9198991537094114, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.417798433364771, "policy_loss": -0.013444250168021435, "vf_loss": 8.429697099458169, "vf_explained_var": -0.006433940314637205, "kl": 0.007727935163885075, "entropy": 0.5567463912617284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 671385.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 515.0, "episode_reward_mean": 972.78, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -51.0}, "policy_reward_max": {"policy_0": 336.0}, "policy_reward_mean": {"policy_0": 97.278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1170.0, 992.0, 894.0, 824.0, 1088.0, 1207.0, 1030.0, 969.0, 869.0, 1150.0, 1247.0, 1039.0, 1175.0, 1200.0, 960.0, 622.0, 1160.0, 805.0, 868.0, 886.0, 779.0, 707.0, 633.0, 530.0, 934.0, 969.0, 1076.0, 1315.0, 760.0, 1042.0, 1096.0, 1155.0, 741.0, 1009.0, 1048.0, 745.0, 1077.0, 690.0, 1410.0, 1062.0, 771.0, 989.0, 1060.0, 1117.0, 1191.0, 666.0, 772.0, 658.0, 1086.0, 515.0, 1326.0, 852.0, 987.0, 970.0, 877.0, 1320.0, 783.0, 925.0, 1190.0, 609.0, 675.0, 1145.0, 1045.0, 1055.0, 809.0, 915.0, 1220.0, 1019.0, 1004.0, 899.0, 1174.0, 1036.0, 1028.0, 800.0, 1343.0, 784.0, 1030.0, 774.0, 1201.0, 1077.0, 757.0, 1149.0, 679.0, 705.0, 950.0, 759.0, 942.0, 950.0, 1160.0, 790.0, 1249.0, 1115.0, 947.0, 1323.0, 769.0, 873.0, 1248.0, 1174.0, 999.0, 1110.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 70.0, 70.0, 110.0, 170.0, 160.0, 70.0, 140.0, 220.0, 100.0, 80.0, 110.0, 86.0, 38.0, 100.0, 133.0, 130.0, 130.0, 115.0, 70.0, 80.0, 110.0, 90.0, 60.0, 120.0, 60.0, 124.0, 97.0, 84.0, 69.0, 33.0, 230.0, 89.0, 90.0, 110.0, 86.0, 100.0, 94.0, 20.0, -28.0, 120.0, 20.0, 90.0, 200.0, 110.0, 18.0, 150.0, 130.0, 110.0, 140.0, 107.0, 70.0, 200.0, 110.0, 120.0, 50.0, 90.0, 210.0, 180.0, 70.0, 100.0, 80.0, 30.0, 160.0, 130.0, 130.0, 100.0, 70.0, 100.0, 130.0, 100.0, 160.0, 115.0, 84.0, 70.0, 90.0, 110.0, 40.0, 70.0, 130.0, 70.0, 69.0, 150.0, 130.0, 30.0, 110.0, 50.0, 100.0, 90.0, 70.0, 130.0, 90.0, 100.0, 130.0, 190.0, 190.0, 70.0, 100.0, 80.0, 70.0, 150.0, 160.0, 120.0, 120.0, 120.0, 120.0, 37.0, 110.0, 180.0, 130.0, 90.0, 70.0, 69.0, 90.0, 210.0, 50.0, 160.0, 140.0, 50.0, 110.0, 60.0, 100.0, 110.0, 55.0, 210.0, 110.0, 160.0, 140.0, 110.0, 120.0, 120.0, 80.0, 70.0, 70.0, 40.0, 170.0, 220.0, 130.0, 170.0, 130.0, 70.0, 60.0, 140.0, 60.0, 90.0, 100.0, 70.0, 140.0, 160.0, 70.0, 90.0, -27.0, 150.0, 75.0, 50.0, 95.0, 113.0, 11.0, 5.0, 60.0, 140.0, 140.0, 90.0, 60.0, 70.0, 80.0, 50.0, 210.0, 110.0, 210.0, 60.0, 47.0, 40.0, 110.0, 69.0, 170.0, 40.0, 100.0, 120.0, 49.0, 81.0, 73.0, 40.0, 68.0, 110.0, 130.0, 122.0, 94.0, 50.0, 100.0, 120.0, 60.0, 28.0, 56.0, 190.0, 90.0, 48.0, 134.0, 90.0, 70.0, 70.0, 140.0, 35.0, 30.0, 19.0, 50.0, 146.0, 119.0, 120.0, 50.0, 100.0, 190.0, 110.0, 60.0, 50.0, 15.0, 132.0, 29.0, -49.0, 70.0, 100.0, 60.0, 40.0, 60.0, 30.0, 100.0, 60.0, 130.0, 31.0, 22.0, 50.0, 80.0, 0.0, 60.0, 30.0, 80.0, 60.0, 20.0, 80.0, 70.0, 100.0, 260.0, 35.0, 60.0, 80.0, 70.0, 140.0, 60.0, 20.0, 109.0, 220.0, 80.0, 80.0, 60.0, 80.0, 120.0, 90.0, 80.0, 89.0, 70.0, 160.0, 140.0, 70.0, 130.0, 90.0, 190.0, 130.0, 52.0, 90.0, 24.0, 31.0, 210.0, 149.0, 47.0, 130.0, 38.0, 300.0, 120.0, 220.0, 70.0, 60.0, 70.0, 100.0, 120.0, 80.0, 90.0, 40.0, 30.0, 100.0, 70.0, 190.0, 50.0, 106.0, 80.0, 76.0, 90.0, 90.0, 140.0, 110.0, 110.0, 55.0, 60.0, 130.0, 180.0, 150.0, 80.0, 170.0, 61.0, 70.0, 140.0, 90.0, 120.0, 70.0, 80.0, 160.0, 80.0, 200.0, 250.0, 35.0, 70.0, 40.0, -13.0, 100.0, 100.0, 140.0, 90.0, 110.0, 40.0, 74.0, 60.0, 50.0, 39.0, 120.0, 100.0, 170.0, 160.0, 80.0, 70.0, 140.0, 80.0, 70.0, 89.0, 90.0, 110.0, 89.0, 90.0, 90.0, 120.0, 160.0, 140.0, 30.0, 94.0, 90.0, 25.0, 54.0, 83.0, 70.0, 108.0, 42.0, 149.0, 70.0, 168.0, 170.0, 60.0, 100.0, 70.0, 59.0, 160.0, 70.0, 150.0, 10.0, 50.0, 80.0, 50.0, 60.0, 90.0, 70.0, 120.0, 80.0, 80.0, 90.0, 150.0, 50.0, 170.0, 160.0, 110.0, 130.0, 160.0, 180.0, 210.0, 170.0, 97.0, 80.0, 57.0, -12.0, 180.0, 110.0, 120.0, 90.0, 170.0, 40.0, 200.0, 90.0, 50.0, 150.0, 46.0, 50.0, 40.0, 5.0, 100.0, 220.0, 100.0, 130.0, 28.0, 70.0, 100.0, 41.0, 140.0, 90.0, 70.0, 60.0, 100.0, 100.0, 140.0, 150.0, 130.0, 70.0, 180.0, 110.0, 20.0, 70.0, 112.0, 100.0, 100.0, 108.0, 156.0, 181.0, 90.0, 70.0, 130.0, 82.0, 90.0, 260.0, 90.0, 41.0, 90.0, 140.0, 138.0, 110.0, 150.0, 100.0, 80.0, 9.0, 10.0, 60.0, 80.0, 10.0, 110.0, -3.0, 210.0, 54.0, 108.0, 28.0, 18.0, 80.0, 100.0, 200.0, 69.0, 160.0, -45.0, 100.0, -31.0, 170.0, 70.0, -13.0, 32.0, 30.0, 60.0, 170.0, 70.0, 93.0, 80.0, 115.0, 140.0, 160.0, -2.0, 200.0, 60.0, 100.0, 140.0, 160.0, -51.0, 90.0, 47.0, 20.0, 50.0, 100.0, 65.0, 34.0, 0.0, 60.0, 200.0, 110.0, 160.0, 50.0, 260.0, 60.0, 70.0, 186.0, 170.0, 110.0, 130.0, 50.0, 110.0, 140.0, 50.0, 90.0, 56.0, 36.0, 80.0, 69.0, 100.0, 33.0, 200.0, 45.0, 100.0, 140.0, 150.0, 80.0, 70.0, 110.0, 160.0, 60.0, 80.0, 70.0, 170.0, 80.0, 70.0, 40.0, 130.0, 110.0, 140.0, 18.0, -2.0, 53.0, 18.0, 140.0, 140.0, 200.0, 60.0, 140.0, 70.0, 200.0, 100.0, 200.0, 120.0, 130.0, 140.0, 90.0, 130.0, 40.0, 36.0, 90.0, 40.0, 60.0, 170.0, 110.0, 77.0, 80.0, 80.0, 80.0, 190.0, 50.0, 140.0, 63.0, 75.0, 50.0, 70.0, 38.0, 169.0, 120.0, 140.0, 110.0, 100.0, 200.0, 100.0, 140.0, 180.0, 50.0, 50.0, 40.0, 90.0, 50.0, 60.0, 90.0, 60.0, 70.0, 60.0, 49.0, 40.0, 67.0, 100.0, 60.0, 60.0, 98.0, 40.0, 70.0, 90.0, 20.0, 70.0, 80.0, 110.0, 140.0, 55.0, 130.0, 150.0, 50.0, 150.0, 150.0, 130.0, 110.0, 80.0, 100.0, 150.0, 110.0, 70.0, 70.0, 170.0, 120.0, 65.0, 130.0, 160.0, 99.0, 136.0, 40.0, 100.0, 40.0, 80.0, 200.0, 70.0, 60.0, 100.0, 90.0, 52.0, 50.0, 160.0, 51.0, 150.0, 39.0, 57.0, 70.0, 104.0, 80.0, 90.0, 60.0, 100.0, 70.0, 50.0, 141.0, 150.0, 190.0, 110.0, 50.0, 160.0, 90.0, 120.0, 130.0, 100.0, 120.0, 150.0, 140.0, 130.0, 69.0, 92.0, 60.0, 98.0, 100.0, 100.0, 90.0, 140.0, 120.0, 150.0, 90.0, 105.0, 59.0, 140.0, 20.0, 100.0, 110.0, 110.0, 130.0, 80.0, 38.0, 100.0, 80.0, 60.0, 75.0, 56.0, 200.0, 80.0, 120.0, 90.0, 70.0, 90.0, 90.0, 196.0, 150.0, 128.0, 90.0, 150.0, 53.0, 87.0, 110.0, 80.0, 110.0, 90.0, 126.0, 100.0, 170.0, 110.0, 130.0, 95.0, 180.0, 30.0, 140.0, 40.0, 50.0, 83.0, 170.0, 110.0, 135.0, 130.0, 30.0, 83.0, 120.0, 40.0, 110.0, 52.0, 50.0, 50.0, 104.0, 70.0, 80.0, 140.0, 120.0, 119.0, 330.0, 90.0, 140.0, 150.0, 120.0, 100.0, 130.0, 110.0, 70.0, 50.0, 80.0, 50.0, 49.0, 25.0, 90.0, 80.0, 90.0, 90.0, 70.0, 130.0, 140.0, 200.0, 60.0, 80.0, 100.0, 80.0, 10.0, 90.0, 30.0, 40.0, 149.0, 85.0, 70.0, 120.0, 36.0, 160.0, 83.0, 90.0, 160.0, 100.0, 130.0, 230.0, 55.0, 157.0, 50.0, 120.0, 64.0, 100.0, 160.0, 40.0, 190.0, 140.0, 130.0, 83.0, 60.0, 53.0, 190.0, 60.0, 70.0, 0.0, 110.0, -50.0, 100.0, 164.0, 130.0, 100.0, 80.0, 74.0, 200.0, 40.0, 70.0, 65.0, 210.0, 180.0, 60.0, 110.0, 70.0, 55.0, 140.0, 90.0, 40.0, 60.0, -6.0, 60.0, 28.0, 109.0, 180.0, 38.0, 79.0, 35.0, 30.0, 100.0, 87.0, 19.0, 100.0, 70.0, 90.0, 240.0, 10.0, 125.0, 80.0, 70.0, 80.0, 85.0, 30.0, 54.0, 60.0, 110.0, 40.0, 70.0, 35.0, 50.0, 70.0, 240.0, 55.0, 60.0, 89.0, 90.0, 100.0, 90.0, 98.0, 120.0, 120.0, 120.0, 50.0, 90.0, 80.0, 100.0, 60.0, 120.0, 110.0, 100.0, 120.0, 120.0, 150.0, 100.0, 70.0, 80.0, 140.0, 100.0, 150.0, 140.0, 90.0, 140.0, 159.0, 130.0, 100.0, 0.0, 60.0, 30.0, 41.0, 110.0, 80.0, 80.0, 170.0, 140.0, 200.0, 100.0, 170.0, 80.0, 89.0, 110.0, 80.0, 110.0, 70.0, 90.0, 90.0, 150.0, 85.0, 80.0, 160.0, 120.0, 100.0, 170.0, 120.0, 48.0, 150.0, 90.0, 200.0, 120.0, 30.0, 90.0, 70.0, 29.0, 100.0, 150.0, 41.0, 190.0, 336.0, 60.0, 130.0, 175.0, 61.0, 80.0, 80.0, 170.0, 60.0, 70.0, 100.0, 29.0, 50.0, 110.0, 40.0, 60.0, 60.0, 126.0, 80.0, 60.0, 100.0, 24.0, 120.0, 70.0, 183.0, 50.0, 220.0, 43.0, 190.0, 160.0, 93.0, 50.0, 90.0, 170.0, 102.0, 130.0, 79.0, 100.0, 60.0, 115.0, 130.0, 90.0, 150.0, 170.0, 200.0, 80.0, 80.0, 110.0, 130.0, 140.0, 115.0, 110.0, 70.0, 75.0, 80.0, 89.0, 80.0, 100.0, 120.0, 80.0, 120.0, 90.0, 30.0, 190.0, 140.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8274265415229143, "mean_inference_ms": 1.84246564048815, "mean_action_processing_ms": 0.5446159410876433, "mean_env_wait_ms": 1.2430996848186309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016321182250976562, "StateBufferConnector_ms": 0.00926351547241211, "ViewRequirementAgentConnector_ms": 0.3789944648742676}, "num_episodes": 23, "episode_return_max": 1410.0, "episode_return_min": 515.0, "episode_return_mean": 972.78}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.719811968737854, "num_env_steps_trained_throughput_per_sec": 20.719811968737854, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 193450.133, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193450.087, "sample_time_ms": 2272.077, "learn_time_ms": 191158.586, "learn_throughput": 20.925, "synch_weights_time_ms": 10.752}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 72, "trial_id": "1841f_00000", "date": "2024-08-08_03-35-15", "timestamp": 1723102515, "time_this_iter_s": 193.06192898750305, "time_total_s": 15299.990617752075, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33abb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15299.990617752075, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.303663003663004, "ram_util_percent": 75.16666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7288463208875973, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.564028009692954, "policy_loss": -0.013336692892160778, "vf_loss": 8.575894682755232, "vf_explained_var": -0.008621538777193957, "kl": 0.007350133450856495, "entropy": 0.5391946548026718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 680775.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 515.0, "episode_reward_mean": 956.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -51.0}, "policy_reward_max": {"policy_0": 336.0}, "policy_reward_mean": {"policy_0": 95.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [868.0, 886.0, 779.0, 707.0, 633.0, 530.0, 934.0, 969.0, 1076.0, 1315.0, 760.0, 1042.0, 1096.0, 1155.0, 741.0, 1009.0, 1048.0, 745.0, 1077.0, 690.0, 1410.0, 1062.0, 771.0, 989.0, 1060.0, 1117.0, 1191.0, 666.0, 772.0, 658.0, 1086.0, 515.0, 1326.0, 852.0, 987.0, 970.0, 877.0, 1320.0, 783.0, 925.0, 1190.0, 609.0, 675.0, 1145.0, 1045.0, 1055.0, 809.0, 915.0, 1220.0, 1019.0, 1004.0, 899.0, 1174.0, 1036.0, 1028.0, 800.0, 1343.0, 784.0, 1030.0, 774.0, 1201.0, 1077.0, 757.0, 1149.0, 679.0, 705.0, 950.0, 759.0, 942.0, 950.0, 1160.0, 790.0, 1249.0, 1115.0, 947.0, 1323.0, 769.0, 873.0, 1248.0, 1174.0, 999.0, 1110.0, 930.0, 554.0, 1160.0, 1171.0, 1063.0, 899.0, 1133.0, 681.0, 1035.0, 880.0, 838.0, 840.0, 1022.0, 933.0, 1027.0, 752.0, 1235.0, 645.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [81.0, 73.0, 40.0, 68.0, 110.0, 130.0, 122.0, 94.0, 50.0, 100.0, 120.0, 60.0, 28.0, 56.0, 190.0, 90.0, 48.0, 134.0, 90.0, 70.0, 70.0, 140.0, 35.0, 30.0, 19.0, 50.0, 146.0, 119.0, 120.0, 50.0, 100.0, 190.0, 110.0, 60.0, 50.0, 15.0, 132.0, 29.0, -49.0, 70.0, 100.0, 60.0, 40.0, 60.0, 30.0, 100.0, 60.0, 130.0, 31.0, 22.0, 50.0, 80.0, 0.0, 60.0, 30.0, 80.0, 60.0, 20.0, 80.0, 70.0, 100.0, 260.0, 35.0, 60.0, 80.0, 70.0, 140.0, 60.0, 20.0, 109.0, 220.0, 80.0, 80.0, 60.0, 80.0, 120.0, 90.0, 80.0, 89.0, 70.0, 160.0, 140.0, 70.0, 130.0, 90.0, 190.0, 130.0, 52.0, 90.0, 24.0, 31.0, 210.0, 149.0, 47.0, 130.0, 38.0, 300.0, 120.0, 220.0, 70.0, 60.0, 70.0, 100.0, 120.0, 80.0, 90.0, 40.0, 30.0, 100.0, 70.0, 190.0, 50.0, 106.0, 80.0, 76.0, 90.0, 90.0, 140.0, 110.0, 110.0, 55.0, 60.0, 130.0, 180.0, 150.0, 80.0, 170.0, 61.0, 70.0, 140.0, 90.0, 120.0, 70.0, 80.0, 160.0, 80.0, 200.0, 250.0, 35.0, 70.0, 40.0, -13.0, 100.0, 100.0, 140.0, 90.0, 110.0, 40.0, 74.0, 60.0, 50.0, 39.0, 120.0, 100.0, 170.0, 160.0, 80.0, 70.0, 140.0, 80.0, 70.0, 89.0, 90.0, 110.0, 89.0, 90.0, 90.0, 120.0, 160.0, 140.0, 30.0, 94.0, 90.0, 25.0, 54.0, 83.0, 70.0, 108.0, 42.0, 149.0, 70.0, 168.0, 170.0, 60.0, 100.0, 70.0, 59.0, 160.0, 70.0, 150.0, 10.0, 50.0, 80.0, 50.0, 60.0, 90.0, 70.0, 120.0, 80.0, 80.0, 90.0, 150.0, 50.0, 170.0, 160.0, 110.0, 130.0, 160.0, 180.0, 210.0, 170.0, 97.0, 80.0, 57.0, -12.0, 180.0, 110.0, 120.0, 90.0, 170.0, 40.0, 200.0, 90.0, 50.0, 150.0, 46.0, 50.0, 40.0, 5.0, 100.0, 220.0, 100.0, 130.0, 28.0, 70.0, 100.0, 41.0, 140.0, 90.0, 70.0, 60.0, 100.0, 100.0, 140.0, 150.0, 130.0, 70.0, 180.0, 110.0, 20.0, 70.0, 112.0, 100.0, 100.0, 108.0, 156.0, 181.0, 90.0, 70.0, 130.0, 82.0, 90.0, 260.0, 90.0, 41.0, 90.0, 140.0, 138.0, 110.0, 150.0, 100.0, 80.0, 9.0, 10.0, 60.0, 80.0, 10.0, 110.0, -3.0, 210.0, 54.0, 108.0, 28.0, 18.0, 80.0, 100.0, 200.0, 69.0, 160.0, -45.0, 100.0, -31.0, 170.0, 70.0, -13.0, 32.0, 30.0, 60.0, 170.0, 70.0, 93.0, 80.0, 115.0, 140.0, 160.0, -2.0, 200.0, 60.0, 100.0, 140.0, 160.0, -51.0, 90.0, 47.0, 20.0, 50.0, 100.0, 65.0, 34.0, 0.0, 60.0, 200.0, 110.0, 160.0, 50.0, 260.0, 60.0, 70.0, 186.0, 170.0, 110.0, 130.0, 50.0, 110.0, 140.0, 50.0, 90.0, 56.0, 36.0, 80.0, 69.0, 100.0, 33.0, 200.0, 45.0, 100.0, 140.0, 150.0, 80.0, 70.0, 110.0, 160.0, 60.0, 80.0, 70.0, 170.0, 80.0, 70.0, 40.0, 130.0, 110.0, 140.0, 18.0, -2.0, 53.0, 18.0, 140.0, 140.0, 200.0, 60.0, 140.0, 70.0, 200.0, 100.0, 200.0, 120.0, 130.0, 140.0, 90.0, 130.0, 40.0, 36.0, 90.0, 40.0, 60.0, 170.0, 110.0, 77.0, 80.0, 80.0, 80.0, 190.0, 50.0, 140.0, 63.0, 75.0, 50.0, 70.0, 38.0, 169.0, 120.0, 140.0, 110.0, 100.0, 200.0, 100.0, 140.0, 180.0, 50.0, 50.0, 40.0, 90.0, 50.0, 60.0, 90.0, 60.0, 70.0, 60.0, 49.0, 40.0, 67.0, 100.0, 60.0, 60.0, 98.0, 40.0, 70.0, 90.0, 20.0, 70.0, 80.0, 110.0, 140.0, 55.0, 130.0, 150.0, 50.0, 150.0, 150.0, 130.0, 110.0, 80.0, 100.0, 150.0, 110.0, 70.0, 70.0, 170.0, 120.0, 65.0, 130.0, 160.0, 99.0, 136.0, 40.0, 100.0, 40.0, 80.0, 200.0, 70.0, 60.0, 100.0, 90.0, 52.0, 50.0, 160.0, 51.0, 150.0, 39.0, 57.0, 70.0, 104.0, 80.0, 90.0, 60.0, 100.0, 70.0, 50.0, 141.0, 150.0, 190.0, 110.0, 50.0, 160.0, 90.0, 120.0, 130.0, 100.0, 120.0, 150.0, 140.0, 130.0, 69.0, 92.0, 60.0, 98.0, 100.0, 100.0, 90.0, 140.0, 120.0, 150.0, 90.0, 105.0, 59.0, 140.0, 20.0, 100.0, 110.0, 110.0, 130.0, 80.0, 38.0, 100.0, 80.0, 60.0, 75.0, 56.0, 200.0, 80.0, 120.0, 90.0, 70.0, 90.0, 90.0, 196.0, 150.0, 128.0, 90.0, 150.0, 53.0, 87.0, 110.0, 80.0, 110.0, 90.0, 126.0, 100.0, 170.0, 110.0, 130.0, 95.0, 180.0, 30.0, 140.0, 40.0, 50.0, 83.0, 170.0, 110.0, 135.0, 130.0, 30.0, 83.0, 120.0, 40.0, 110.0, 52.0, 50.0, 50.0, 104.0, 70.0, 80.0, 140.0, 120.0, 119.0, 330.0, 90.0, 140.0, 150.0, 120.0, 100.0, 130.0, 110.0, 70.0, 50.0, 80.0, 50.0, 49.0, 25.0, 90.0, 80.0, 90.0, 90.0, 70.0, 130.0, 140.0, 200.0, 60.0, 80.0, 100.0, 80.0, 10.0, 90.0, 30.0, 40.0, 149.0, 85.0, 70.0, 120.0, 36.0, 160.0, 83.0, 90.0, 160.0, 100.0, 130.0, 230.0, 55.0, 157.0, 50.0, 120.0, 64.0, 100.0, 160.0, 40.0, 190.0, 140.0, 130.0, 83.0, 60.0, 53.0, 190.0, 60.0, 70.0, 0.0, 110.0, -50.0, 100.0, 164.0, 130.0, 100.0, 80.0, 74.0, 200.0, 40.0, 70.0, 65.0, 210.0, 180.0, 60.0, 110.0, 70.0, 55.0, 140.0, 90.0, 40.0, 60.0, -6.0, 60.0, 28.0, 109.0, 180.0, 38.0, 79.0, 35.0, 30.0, 100.0, 87.0, 19.0, 100.0, 70.0, 90.0, 240.0, 10.0, 125.0, 80.0, 70.0, 80.0, 85.0, 30.0, 54.0, 60.0, 110.0, 40.0, 70.0, 35.0, 50.0, 70.0, 240.0, 55.0, 60.0, 89.0, 90.0, 100.0, 90.0, 98.0, 120.0, 120.0, 120.0, 50.0, 90.0, 80.0, 100.0, 60.0, 120.0, 110.0, 100.0, 120.0, 120.0, 150.0, 100.0, 70.0, 80.0, 140.0, 100.0, 150.0, 140.0, 90.0, 140.0, 159.0, 130.0, 100.0, 0.0, 60.0, 30.0, 41.0, 110.0, 80.0, 80.0, 170.0, 140.0, 200.0, 100.0, 170.0, 80.0, 89.0, 110.0, 80.0, 110.0, 70.0, 90.0, 90.0, 150.0, 85.0, 80.0, 160.0, 120.0, 100.0, 170.0, 120.0, 48.0, 150.0, 90.0, 200.0, 120.0, 30.0, 90.0, 70.0, 29.0, 100.0, 150.0, 41.0, 190.0, 336.0, 60.0, 130.0, 175.0, 61.0, 80.0, 80.0, 170.0, 60.0, 70.0, 100.0, 29.0, 50.0, 110.0, 40.0, 60.0, 60.0, 126.0, 80.0, 60.0, 100.0, 24.0, 120.0, 70.0, 183.0, 50.0, 220.0, 43.0, 190.0, 160.0, 93.0, 50.0, 90.0, 170.0, 102.0, 130.0, 79.0, 100.0, 60.0, 115.0, 130.0, 90.0, 150.0, 170.0, 200.0, 80.0, 80.0, 110.0, 130.0, 140.0, 115.0, 110.0, 70.0, 75.0, 80.0, 89.0, 80.0, 100.0, 120.0, 80.0, 120.0, 90.0, 30.0, 190.0, 140.0, 160.0, 18.0, 90.0, 68.0, 107.0, 190.0, 168.0, 107.0, 70.0, 70.0, 42.0, 50.0, 70.0, 27.0, 90.0, 40.0, 17.0, 60.0, 70.0, 70.0, 60.0, 210.0, 180.0, 90.0, 90.0, 100.0, 60.0, 150.0, 90.0, 120.0, 70.0, 130.0, 114.0, 97.0, 190.0, 53.0, 220.0, 80.0, 150.0, 47.0, 90.0, 60.0, 44.0, 40.0, 140.0, 190.0, 80.0, 123.0, 96.0, 150.0, 140.0, 130.0, 140.0, 97.0, 40.0, 60.0, 160.0, 37.0, 115.0, 50.0, 70.0, 140.0, 180.0, 87.0, 79.0, 50.0, 140.0, 120.0, 130.0, 77.0, 130.0, 90.0, 70.0, 60.0, 80.0, 60.0, 50.0, 69.0, 44.0, 80.0, 78.0, 150.0, 120.0, 110.0, 70.0, 120.0, 35.0, 50.0, 190.0, 140.0, 50.0, 100.0, 40.0, 110.0, 40.0, 170.0, 90.0, 30.0, 90.0, 100.0, 110.0, 150.0, 80.0, 105.0, 70.0, 110.0, 84.0, 50.0, 34.0, 58.0, 97.0, 60.0, 70.0, 60.0, 110.0, 110.0, 150.0, 30.0, 50.0, 130.0, 70.0, 25.0, 70.0, 128.0, 140.0, 109.0, 110.0, 140.0, 130.0, 80.0, 90.0, 140.0, 140.0, 80.0, 20.0, 107.0, 80.0, 37.0, 180.0, 80.0, 69.0, 100.0, 110.0, 98.0, 130.0, 120.0, 90.0, 130.0, 70.0, 120.0, 59.0, 80.0, 80.0, 100.0, 50.0, 58.0, 112.0, 140.0, 44.0, 28.0, 60.0, 130.0, 80.0, 120.0, 80.0, 200.0, 120.0, 145.0, 50.0, 100.0, 210.0, 30.0, 60.0, 110.0, 110.0, 80.0, 20.0, 110.0, 60.0, 45.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8217051693506376, "mean_inference_ms": 1.8368084099230353, "mean_action_processing_ms": 0.543053143910185, "mean_env_wait_ms": 1.2394820253930714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01640009880065918, "StateBufferConnector_ms": 0.009372234344482422, "ViewRequirementAgentConnector_ms": 0.38668107986450195}, "num_episodes": 18, "episode_return_max": 1410.0, "episode_return_min": 515.0, "episode_return_mean": 956.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.762295159475087, "num_env_steps_trained_throughput_per_sec": 20.762295159475087, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 2920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2920000, "timers": {"training_iteration_time_ms": 193337.23, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193337.184, "sample_time_ms": 2264.181, "learn_time_ms": 191053.574, "learn_throughput": 20.937, "synch_weights_time_ms": 10.73}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "done": false, "training_iteration": 73, "trial_id": "1841f_00000", "date": "2024-08-08_03-38-28", "timestamp": 1723102708, "time_this_iter_s": 192.66797995567322, "time_total_s": 15492.658597707748, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b562e280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15492.658597707748, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 16.924908424908423, "ram_util_percent": 75.90952380952382}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.664535561505471, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.354503628443352, "policy_loss": -0.013287920323763384, "vf_loss": 8.36629997086855, "vf_explained_var": -0.009921276664581542, "kl": 0.0074578967577290664, "entropy": 0.556499614838721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 690165.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 515.0, "episode_reward_mean": 957.57, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -51.0}, "policy_reward_max": {"policy_0": 336.0}, "policy_reward_mean": {"policy_0": 95.757}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1077.0, 690.0, 1410.0, 1062.0, 771.0, 989.0, 1060.0, 1117.0, 1191.0, 666.0, 772.0, 658.0, 1086.0, 515.0, 1326.0, 852.0, 987.0, 970.0, 877.0, 1320.0, 783.0, 925.0, 1190.0, 609.0, 675.0, 1145.0, 1045.0, 1055.0, 809.0, 915.0, 1220.0, 1019.0, 1004.0, 899.0, 1174.0, 1036.0, 1028.0, 800.0, 1343.0, 784.0, 1030.0, 774.0, 1201.0, 1077.0, 757.0, 1149.0, 679.0, 705.0, 950.0, 759.0, 942.0, 950.0, 1160.0, 790.0, 1249.0, 1115.0, 947.0, 1323.0, 769.0, 873.0, 1248.0, 1174.0, 999.0, 1110.0, 930.0, 554.0, 1160.0, 1171.0, 1063.0, 899.0, 1133.0, 681.0, 1035.0, 880.0, 838.0, 840.0, 1022.0, 933.0, 1027.0, 752.0, 1235.0, 645.0, 662.0, 621.0, 968.0, 968.0, 981.0, 656.0, 1200.0, 950.0, 960.0, 1087.0, 1167.0, 620.0, 847.0, 977.0, 960.0, 1002.0, 1024.0, 725.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 168.0, 170.0, 60.0, 100.0, 70.0, 59.0, 160.0, 70.0, 150.0, 10.0, 50.0, 80.0, 50.0, 60.0, 90.0, 70.0, 120.0, 80.0, 80.0, 90.0, 150.0, 50.0, 170.0, 160.0, 110.0, 130.0, 160.0, 180.0, 210.0, 170.0, 97.0, 80.0, 57.0, -12.0, 180.0, 110.0, 120.0, 90.0, 170.0, 40.0, 200.0, 90.0, 50.0, 150.0, 46.0, 50.0, 40.0, 5.0, 100.0, 220.0, 100.0, 130.0, 28.0, 70.0, 100.0, 41.0, 140.0, 90.0, 70.0, 60.0, 100.0, 100.0, 140.0, 150.0, 130.0, 70.0, 180.0, 110.0, 20.0, 70.0, 112.0, 100.0, 100.0, 108.0, 156.0, 181.0, 90.0, 70.0, 130.0, 82.0, 90.0, 260.0, 90.0, 41.0, 90.0, 140.0, 138.0, 110.0, 150.0, 100.0, 80.0, 9.0, 10.0, 60.0, 80.0, 10.0, 110.0, -3.0, 210.0, 54.0, 108.0, 28.0, 18.0, 80.0, 100.0, 200.0, 69.0, 160.0, -45.0, 100.0, -31.0, 170.0, 70.0, -13.0, 32.0, 30.0, 60.0, 170.0, 70.0, 93.0, 80.0, 115.0, 140.0, 160.0, -2.0, 200.0, 60.0, 100.0, 140.0, 160.0, -51.0, 90.0, 47.0, 20.0, 50.0, 100.0, 65.0, 34.0, 0.0, 60.0, 200.0, 110.0, 160.0, 50.0, 260.0, 60.0, 70.0, 186.0, 170.0, 110.0, 130.0, 50.0, 110.0, 140.0, 50.0, 90.0, 56.0, 36.0, 80.0, 69.0, 100.0, 33.0, 200.0, 45.0, 100.0, 140.0, 150.0, 80.0, 70.0, 110.0, 160.0, 60.0, 80.0, 70.0, 170.0, 80.0, 70.0, 40.0, 130.0, 110.0, 140.0, 18.0, -2.0, 53.0, 18.0, 140.0, 140.0, 200.0, 60.0, 140.0, 70.0, 200.0, 100.0, 200.0, 120.0, 130.0, 140.0, 90.0, 130.0, 40.0, 36.0, 90.0, 40.0, 60.0, 170.0, 110.0, 77.0, 80.0, 80.0, 80.0, 190.0, 50.0, 140.0, 63.0, 75.0, 50.0, 70.0, 38.0, 169.0, 120.0, 140.0, 110.0, 100.0, 200.0, 100.0, 140.0, 180.0, 50.0, 50.0, 40.0, 90.0, 50.0, 60.0, 90.0, 60.0, 70.0, 60.0, 49.0, 40.0, 67.0, 100.0, 60.0, 60.0, 98.0, 40.0, 70.0, 90.0, 20.0, 70.0, 80.0, 110.0, 140.0, 55.0, 130.0, 150.0, 50.0, 150.0, 150.0, 130.0, 110.0, 80.0, 100.0, 150.0, 110.0, 70.0, 70.0, 170.0, 120.0, 65.0, 130.0, 160.0, 99.0, 136.0, 40.0, 100.0, 40.0, 80.0, 200.0, 70.0, 60.0, 100.0, 90.0, 52.0, 50.0, 160.0, 51.0, 150.0, 39.0, 57.0, 70.0, 104.0, 80.0, 90.0, 60.0, 100.0, 70.0, 50.0, 141.0, 150.0, 190.0, 110.0, 50.0, 160.0, 90.0, 120.0, 130.0, 100.0, 120.0, 150.0, 140.0, 130.0, 69.0, 92.0, 60.0, 98.0, 100.0, 100.0, 90.0, 140.0, 120.0, 150.0, 90.0, 105.0, 59.0, 140.0, 20.0, 100.0, 110.0, 110.0, 130.0, 80.0, 38.0, 100.0, 80.0, 60.0, 75.0, 56.0, 200.0, 80.0, 120.0, 90.0, 70.0, 90.0, 90.0, 196.0, 150.0, 128.0, 90.0, 150.0, 53.0, 87.0, 110.0, 80.0, 110.0, 90.0, 126.0, 100.0, 170.0, 110.0, 130.0, 95.0, 180.0, 30.0, 140.0, 40.0, 50.0, 83.0, 170.0, 110.0, 135.0, 130.0, 30.0, 83.0, 120.0, 40.0, 110.0, 52.0, 50.0, 50.0, 104.0, 70.0, 80.0, 140.0, 120.0, 119.0, 330.0, 90.0, 140.0, 150.0, 120.0, 100.0, 130.0, 110.0, 70.0, 50.0, 80.0, 50.0, 49.0, 25.0, 90.0, 80.0, 90.0, 90.0, 70.0, 130.0, 140.0, 200.0, 60.0, 80.0, 100.0, 80.0, 10.0, 90.0, 30.0, 40.0, 149.0, 85.0, 70.0, 120.0, 36.0, 160.0, 83.0, 90.0, 160.0, 100.0, 130.0, 230.0, 55.0, 157.0, 50.0, 120.0, 64.0, 100.0, 160.0, 40.0, 190.0, 140.0, 130.0, 83.0, 60.0, 53.0, 190.0, 60.0, 70.0, 0.0, 110.0, -50.0, 100.0, 164.0, 130.0, 100.0, 80.0, 74.0, 200.0, 40.0, 70.0, 65.0, 210.0, 180.0, 60.0, 110.0, 70.0, 55.0, 140.0, 90.0, 40.0, 60.0, -6.0, 60.0, 28.0, 109.0, 180.0, 38.0, 79.0, 35.0, 30.0, 100.0, 87.0, 19.0, 100.0, 70.0, 90.0, 240.0, 10.0, 125.0, 80.0, 70.0, 80.0, 85.0, 30.0, 54.0, 60.0, 110.0, 40.0, 70.0, 35.0, 50.0, 70.0, 240.0, 55.0, 60.0, 89.0, 90.0, 100.0, 90.0, 98.0, 120.0, 120.0, 120.0, 50.0, 90.0, 80.0, 100.0, 60.0, 120.0, 110.0, 100.0, 120.0, 120.0, 150.0, 100.0, 70.0, 80.0, 140.0, 100.0, 150.0, 140.0, 90.0, 140.0, 159.0, 130.0, 100.0, 0.0, 60.0, 30.0, 41.0, 110.0, 80.0, 80.0, 170.0, 140.0, 200.0, 100.0, 170.0, 80.0, 89.0, 110.0, 80.0, 110.0, 70.0, 90.0, 90.0, 150.0, 85.0, 80.0, 160.0, 120.0, 100.0, 170.0, 120.0, 48.0, 150.0, 90.0, 200.0, 120.0, 30.0, 90.0, 70.0, 29.0, 100.0, 150.0, 41.0, 190.0, 336.0, 60.0, 130.0, 175.0, 61.0, 80.0, 80.0, 170.0, 60.0, 70.0, 100.0, 29.0, 50.0, 110.0, 40.0, 60.0, 60.0, 126.0, 80.0, 60.0, 100.0, 24.0, 120.0, 70.0, 183.0, 50.0, 220.0, 43.0, 190.0, 160.0, 93.0, 50.0, 90.0, 170.0, 102.0, 130.0, 79.0, 100.0, 60.0, 115.0, 130.0, 90.0, 150.0, 170.0, 200.0, 80.0, 80.0, 110.0, 130.0, 140.0, 115.0, 110.0, 70.0, 75.0, 80.0, 89.0, 80.0, 100.0, 120.0, 80.0, 120.0, 90.0, 30.0, 190.0, 140.0, 160.0, 18.0, 90.0, 68.0, 107.0, 190.0, 168.0, 107.0, 70.0, 70.0, 42.0, 50.0, 70.0, 27.0, 90.0, 40.0, 17.0, 60.0, 70.0, 70.0, 60.0, 210.0, 180.0, 90.0, 90.0, 100.0, 60.0, 150.0, 90.0, 120.0, 70.0, 130.0, 114.0, 97.0, 190.0, 53.0, 220.0, 80.0, 150.0, 47.0, 90.0, 60.0, 44.0, 40.0, 140.0, 190.0, 80.0, 123.0, 96.0, 150.0, 140.0, 130.0, 140.0, 97.0, 40.0, 60.0, 160.0, 37.0, 115.0, 50.0, 70.0, 140.0, 180.0, 87.0, 79.0, 50.0, 140.0, 120.0, 130.0, 77.0, 130.0, 90.0, 70.0, 60.0, 80.0, 60.0, 50.0, 69.0, 44.0, 80.0, 78.0, 150.0, 120.0, 110.0, 70.0, 120.0, 35.0, 50.0, 190.0, 140.0, 50.0, 100.0, 40.0, 110.0, 40.0, 170.0, 90.0, 30.0, 90.0, 100.0, 110.0, 150.0, 80.0, 105.0, 70.0, 110.0, 84.0, 50.0, 34.0, 58.0, 97.0, 60.0, 70.0, 60.0, 110.0, 110.0, 150.0, 30.0, 50.0, 130.0, 70.0, 25.0, 70.0, 128.0, 140.0, 109.0, 110.0, 140.0, 130.0, 80.0, 90.0, 140.0, 140.0, 80.0, 20.0, 107.0, 80.0, 37.0, 180.0, 80.0, 69.0, 100.0, 110.0, 98.0, 130.0, 120.0, 90.0, 130.0, 70.0, 120.0, 59.0, 80.0, 80.0, 100.0, 50.0, 58.0, 112.0, 140.0, 44.0, 28.0, 60.0, 130.0, 80.0, 120.0, 80.0, 200.0, 120.0, 145.0, 50.0, 100.0, 210.0, 30.0, 60.0, 110.0, 110.0, 80.0, 20.0, 110.0, 60.0, 45.0, 20.0, -25.0, 110.0, 40.0, 80.0, 83.0, 100.0, -16.0, 100.0, 90.0, 100.0, 60.0, -7.0, 100.0, 28.0, 20.0, 50.0, 70.0, 30.0, 110.0, 160.0, 80.0, 100.0, 50.0, 190.0, 63.0, 100.0, 80.0, 70.0, 200.0, 35.0, 190.0, 100.0, 3.0, 30.0, 15.0, 180.0, 140.0, 110.0, 120.0, 80.0, 120.0, 150.0, 150.0, 90.0, 135.0, 50.0, 105.0, 50.0, 60.0, 71.0, 26.0, 120.0, 200.0, 60.0, 90.0, 50.0, 80.0, -10.0, 0.0, 40.0, 55.0, 55.0, 100.0, 112.0, 246.0, 205.0, 120.0, 150.0, 97.0, 60.0, 130.0, 40.0, 90.0, 150.0, 90.0, 120.0, 110.0, 70.0, 80.0, 70.0, 40.0, 200.0, 90.0, 110.0, 80.0, 80.0, 130.0, 80.0, 50.0, 100.0, 190.0, 80.0, 190.0, 80.0, 70.0, 120.0, 100.0, 85.0, 90.0, 82.0, 100.0, 110.0, 230.0, 90.0, 140.0, 150.0, 93.0, 90.0, 64.0, 100.0, 40.0, 80.0, 110.0, 30.0, 90.0, 100.0, 70.0, 20.0, 30.0, 50.0, 70.0, 70.0, 100.0, 25.0, 120.0, 90.0, 120.0, 42.0, 110.0, 100.0, 159.0, 58.0, 70.0, 50.0, 90.0, 60.0, 130.0, 20.0, 160.0, 180.0, 70.0, 110.0, 20.0, 180.0, 160.0, 170.0, 30.0, 40.0, 120.0, 60.0, 160.0, 117.0, 78.0, 120.0, 46.0, 120.0, 51.0, 160.0, 40.0, 110.0, 44.0, 130.0, 160.0, 120.0, 30.0, 70.0, 70.0, 120.0, 140.0, 140.0, 130.0, 100.0, 33.0, 110.0, 20.0, 12.0, 60.0, 80.0, 140.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8161644246714714, "mean_inference_ms": 1.8313157936279225, "mean_action_processing_ms": 0.5415347764008389, "mean_env_wait_ms": 1.2359802828869306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01642465591430664, "StateBufferConnector_ms": 0.009575843811035156, "ViewRequirementAgentConnector_ms": 0.388019323348999}, "num_episodes": 18, "episode_return_max": 1410.0, "episode_return_min": 515.0, "episode_return_mean": 957.57}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.748279663026157, "num_env_steps_trained_throughput_per_sec": 20.748279663026157, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 193169.17, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193169.126, "sample_time_ms": 2221.425, "learn_time_ms": 190927.979, "learn_throughput": 20.95, "synch_weights_time_ms": 11.058}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 74, "trial_id": "1841f_00000", "date": "2024-08-08_03-41-41", "timestamp": 1723102901, "time_this_iter_s": 192.79627799987793, "time_total_s": 15685.454875707626, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b562e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15685.454875707626, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 16.83113553113553, "ram_util_percent": 75.77252747252747}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.697947339508861, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.51754937613734, "policy_loss": -0.013797991447243939, "vf_loss": 8.529858545043345, "vf_explained_var": -0.008768836784159668, "kl": 0.007444099888716635, "entropy": 0.5421000094903797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 699555.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "env_runners": {"episode_reward_max": 1349.0, "episode_reward_min": 554.0, "episode_reward_mean": 967.96, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 336.0}, "policy_reward_mean": {"policy_0": 96.796}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1190.0, 609.0, 675.0, 1145.0, 1045.0, 1055.0, 809.0, 915.0, 1220.0, 1019.0, 1004.0, 899.0, 1174.0, 1036.0, 1028.0, 800.0, 1343.0, 784.0, 1030.0, 774.0, 1201.0, 1077.0, 757.0, 1149.0, 679.0, 705.0, 950.0, 759.0, 942.0, 950.0, 1160.0, 790.0, 1249.0, 1115.0, 947.0, 1323.0, 769.0, 873.0, 1248.0, 1174.0, 999.0, 1110.0, 930.0, 554.0, 1160.0, 1171.0, 1063.0, 899.0, 1133.0, 681.0, 1035.0, 880.0, 838.0, 840.0, 1022.0, 933.0, 1027.0, 752.0, 1235.0, 645.0, 662.0, 621.0, 968.0, 968.0, 981.0, 656.0, 1200.0, 950.0, 960.0, 1087.0, 1167.0, 620.0, 847.0, 977.0, 960.0, 1002.0, 1024.0, 725.0, 1349.0, 940.0, 1196.0, 875.0, 1149.0, 990.0, 1150.0, 923.0, 798.0, 1083.0, 690.0, 809.0, 865.0, 821.0, 1097.0, 1030.0, 1232.0, 806.0, 1200.0, 1050.0, 1162.0, 928.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 140.0, 110.0, 100.0, 200.0, 100.0, 140.0, 180.0, 50.0, 50.0, 40.0, 90.0, 50.0, 60.0, 90.0, 60.0, 70.0, 60.0, 49.0, 40.0, 67.0, 100.0, 60.0, 60.0, 98.0, 40.0, 70.0, 90.0, 20.0, 70.0, 80.0, 110.0, 140.0, 55.0, 130.0, 150.0, 50.0, 150.0, 150.0, 130.0, 110.0, 80.0, 100.0, 150.0, 110.0, 70.0, 70.0, 170.0, 120.0, 65.0, 130.0, 160.0, 99.0, 136.0, 40.0, 100.0, 40.0, 80.0, 200.0, 70.0, 60.0, 100.0, 90.0, 52.0, 50.0, 160.0, 51.0, 150.0, 39.0, 57.0, 70.0, 104.0, 80.0, 90.0, 60.0, 100.0, 70.0, 50.0, 141.0, 150.0, 190.0, 110.0, 50.0, 160.0, 90.0, 120.0, 130.0, 100.0, 120.0, 150.0, 140.0, 130.0, 69.0, 92.0, 60.0, 98.0, 100.0, 100.0, 90.0, 140.0, 120.0, 150.0, 90.0, 105.0, 59.0, 140.0, 20.0, 100.0, 110.0, 110.0, 130.0, 80.0, 38.0, 100.0, 80.0, 60.0, 75.0, 56.0, 200.0, 80.0, 120.0, 90.0, 70.0, 90.0, 90.0, 196.0, 150.0, 128.0, 90.0, 150.0, 53.0, 87.0, 110.0, 80.0, 110.0, 90.0, 126.0, 100.0, 170.0, 110.0, 130.0, 95.0, 180.0, 30.0, 140.0, 40.0, 50.0, 83.0, 170.0, 110.0, 135.0, 130.0, 30.0, 83.0, 120.0, 40.0, 110.0, 52.0, 50.0, 50.0, 104.0, 70.0, 80.0, 140.0, 120.0, 119.0, 330.0, 90.0, 140.0, 150.0, 120.0, 100.0, 130.0, 110.0, 70.0, 50.0, 80.0, 50.0, 49.0, 25.0, 90.0, 80.0, 90.0, 90.0, 70.0, 130.0, 140.0, 200.0, 60.0, 80.0, 100.0, 80.0, 10.0, 90.0, 30.0, 40.0, 149.0, 85.0, 70.0, 120.0, 36.0, 160.0, 83.0, 90.0, 160.0, 100.0, 130.0, 230.0, 55.0, 157.0, 50.0, 120.0, 64.0, 100.0, 160.0, 40.0, 190.0, 140.0, 130.0, 83.0, 60.0, 53.0, 190.0, 60.0, 70.0, 0.0, 110.0, -50.0, 100.0, 164.0, 130.0, 100.0, 80.0, 74.0, 200.0, 40.0, 70.0, 65.0, 210.0, 180.0, 60.0, 110.0, 70.0, 55.0, 140.0, 90.0, 40.0, 60.0, -6.0, 60.0, 28.0, 109.0, 180.0, 38.0, 79.0, 35.0, 30.0, 100.0, 87.0, 19.0, 100.0, 70.0, 90.0, 240.0, 10.0, 125.0, 80.0, 70.0, 80.0, 85.0, 30.0, 54.0, 60.0, 110.0, 40.0, 70.0, 35.0, 50.0, 70.0, 240.0, 55.0, 60.0, 89.0, 90.0, 100.0, 90.0, 98.0, 120.0, 120.0, 120.0, 50.0, 90.0, 80.0, 100.0, 60.0, 120.0, 110.0, 100.0, 120.0, 120.0, 150.0, 100.0, 70.0, 80.0, 140.0, 100.0, 150.0, 140.0, 90.0, 140.0, 159.0, 130.0, 100.0, 0.0, 60.0, 30.0, 41.0, 110.0, 80.0, 80.0, 170.0, 140.0, 200.0, 100.0, 170.0, 80.0, 89.0, 110.0, 80.0, 110.0, 70.0, 90.0, 90.0, 150.0, 85.0, 80.0, 160.0, 120.0, 100.0, 170.0, 120.0, 48.0, 150.0, 90.0, 200.0, 120.0, 30.0, 90.0, 70.0, 29.0, 100.0, 150.0, 41.0, 190.0, 336.0, 60.0, 130.0, 175.0, 61.0, 80.0, 80.0, 170.0, 60.0, 70.0, 100.0, 29.0, 50.0, 110.0, 40.0, 60.0, 60.0, 126.0, 80.0, 60.0, 100.0, 24.0, 120.0, 70.0, 183.0, 50.0, 220.0, 43.0, 190.0, 160.0, 93.0, 50.0, 90.0, 170.0, 102.0, 130.0, 79.0, 100.0, 60.0, 115.0, 130.0, 90.0, 150.0, 170.0, 200.0, 80.0, 80.0, 110.0, 130.0, 140.0, 115.0, 110.0, 70.0, 75.0, 80.0, 89.0, 80.0, 100.0, 120.0, 80.0, 120.0, 90.0, 30.0, 190.0, 140.0, 160.0, 18.0, 90.0, 68.0, 107.0, 190.0, 168.0, 107.0, 70.0, 70.0, 42.0, 50.0, 70.0, 27.0, 90.0, 40.0, 17.0, 60.0, 70.0, 70.0, 60.0, 210.0, 180.0, 90.0, 90.0, 100.0, 60.0, 150.0, 90.0, 120.0, 70.0, 130.0, 114.0, 97.0, 190.0, 53.0, 220.0, 80.0, 150.0, 47.0, 90.0, 60.0, 44.0, 40.0, 140.0, 190.0, 80.0, 123.0, 96.0, 150.0, 140.0, 130.0, 140.0, 97.0, 40.0, 60.0, 160.0, 37.0, 115.0, 50.0, 70.0, 140.0, 180.0, 87.0, 79.0, 50.0, 140.0, 120.0, 130.0, 77.0, 130.0, 90.0, 70.0, 60.0, 80.0, 60.0, 50.0, 69.0, 44.0, 80.0, 78.0, 150.0, 120.0, 110.0, 70.0, 120.0, 35.0, 50.0, 190.0, 140.0, 50.0, 100.0, 40.0, 110.0, 40.0, 170.0, 90.0, 30.0, 90.0, 100.0, 110.0, 150.0, 80.0, 105.0, 70.0, 110.0, 84.0, 50.0, 34.0, 58.0, 97.0, 60.0, 70.0, 60.0, 110.0, 110.0, 150.0, 30.0, 50.0, 130.0, 70.0, 25.0, 70.0, 128.0, 140.0, 109.0, 110.0, 140.0, 130.0, 80.0, 90.0, 140.0, 140.0, 80.0, 20.0, 107.0, 80.0, 37.0, 180.0, 80.0, 69.0, 100.0, 110.0, 98.0, 130.0, 120.0, 90.0, 130.0, 70.0, 120.0, 59.0, 80.0, 80.0, 100.0, 50.0, 58.0, 112.0, 140.0, 44.0, 28.0, 60.0, 130.0, 80.0, 120.0, 80.0, 200.0, 120.0, 145.0, 50.0, 100.0, 210.0, 30.0, 60.0, 110.0, 110.0, 80.0, 20.0, 110.0, 60.0, 45.0, 20.0, -25.0, 110.0, 40.0, 80.0, 83.0, 100.0, -16.0, 100.0, 90.0, 100.0, 60.0, -7.0, 100.0, 28.0, 20.0, 50.0, 70.0, 30.0, 110.0, 160.0, 80.0, 100.0, 50.0, 190.0, 63.0, 100.0, 80.0, 70.0, 200.0, 35.0, 190.0, 100.0, 3.0, 30.0, 15.0, 180.0, 140.0, 110.0, 120.0, 80.0, 120.0, 150.0, 150.0, 90.0, 135.0, 50.0, 105.0, 50.0, 60.0, 71.0, 26.0, 120.0, 200.0, 60.0, 90.0, 50.0, 80.0, -10.0, 0.0, 40.0, 55.0, 55.0, 100.0, 112.0, 246.0, 205.0, 120.0, 150.0, 97.0, 60.0, 130.0, 40.0, 90.0, 150.0, 90.0, 120.0, 110.0, 70.0, 80.0, 70.0, 40.0, 200.0, 90.0, 110.0, 80.0, 80.0, 130.0, 80.0, 50.0, 100.0, 190.0, 80.0, 190.0, 80.0, 70.0, 120.0, 100.0, 85.0, 90.0, 82.0, 100.0, 110.0, 230.0, 90.0, 140.0, 150.0, 93.0, 90.0, 64.0, 100.0, 40.0, 80.0, 110.0, 30.0, 90.0, 100.0, 70.0, 20.0, 30.0, 50.0, 70.0, 70.0, 100.0, 25.0, 120.0, 90.0, 120.0, 42.0, 110.0, 100.0, 159.0, 58.0, 70.0, 50.0, 90.0, 60.0, 130.0, 20.0, 160.0, 180.0, 70.0, 110.0, 20.0, 180.0, 160.0, 170.0, 30.0, 40.0, 120.0, 60.0, 160.0, 117.0, 78.0, 120.0, 46.0, 120.0, 51.0, 160.0, 40.0, 110.0, 44.0, 130.0, 160.0, 120.0, 30.0, 70.0, 70.0, 120.0, 140.0, 140.0, 130.0, 100.0, 33.0, 110.0, 20.0, 12.0, 60.0, 80.0, 140.0, 40.0, 60.0, 160.0, 100.0, 110.0, 220.0, 140.0, 220.0, 80.0, 150.0, 109.0, 30.0, 90.0, 90.0, 80.0, 200.0, 100.0, 100.0, 50.0, 90.0, 110.0, 145.0, 150.0, 85.0, 100.0, 100.0, 90.0, 56.0, 150.0, 140.0, 180.0, 120.0, 87.0, 80.0, 130.0, 120.0, 60.0, 60.0, 10.0, 70.0, 138.0, 190.0, 150.0, 60.0, 100.0, 160.0, 90.0, 69.0, 110.0, 80.0, 140.0, 50.0, 60.0, 120.0, 70.0, 110.0, 160.0, 80.0, 130.0, 100.0, 110.0, 190.0, 140.0, 77.0, 150.0, 70.0, 140.0, 173.0, 60.0, 100.0, 50.0, 110.0, 66.0, 40.0, 100.0, 180.0, 43.0, 80.0, 110.0, 124.0, 70.0, 100.0, 90.0, 80.0, 100.0, 60.0, 108.0, 0.0, 140.0, 70.0, 50.0, 150.0, 157.0, 70.0, 60.0, 150.0, 36.0, 120.0, 40.0, 110.0, 190.0, 44.0, 20.0, 60.0, 110.0, 100.0, 76.0, 30.0, 100.0, 60.0, 90.0, 90.0, 50.0, 90.0, 160.0, 20.0, 12.0, 170.0, 64.0, 33.0, 120.0, 80.0, 50.0, 50.0, 110.0, 138.0, 84.0, 75.0, 78.0, 110.0, 90.0, 44.0, 70.0, 60.0, 150.0, 120.0, 160.0, 54.0, 70.0, 52.0, 41.0, 110.0, 50.0, 90.0, 70.0, 210.0, 160.0, 204.0, 63.0, 90.0, 50.0, 120.0, 90.0, 100.0, 140.0, 170.0, 70.0, 40.0, 70.0, 80.0, 150.0, 100.0, 20.0, 210.0, 100.0, 119.0, 48.0, 295.0, 70.0, 170.0, 100.0, 80.0, 80.0, 80.0, 220.0, 109.0, 57.0, 40.0, 40.0, 50.0, 50.0, 80.0, 150.0, 100.0, 100.0, 220.0, 110.0, 40.0, 140.0, 160.0, 100.0, 70.0, 180.0, 60.0, 80.0, 160.0, 130.0, 100.0, 110.0, 70.0, 90.0, 60.0, 56.0, 150.0, 221.0, 110.0, 110.0, 95.0, 110.0, 170.0, 80.0, 10.0, 90.0, 90.0, 130.0, 120.0, 110.0, -22.0, 120.0, 150.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.810559303203737, "mean_inference_ms": 1.8263938775622122, "mean_action_processing_ms": 0.5397834001861882, "mean_env_wait_ms": 1.2313958533894485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016249656677246094, "StateBufferConnector_ms": 0.009438753128051758, "ViewRequirementAgentConnector_ms": 0.3819262981414795}, "num_episodes": 22, "episode_return_max": 1349.0, "episode_return_min": 554.0, "episode_return_mean": 967.96}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.748616395086373, "num_env_steps_trained_throughput_per_sec": 20.748616395086373, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 3000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3000000, "timers": {"training_iteration_time_ms": 193091.005, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193090.962, "sample_time_ms": 2218.56, "learn_time_ms": 190852.517, "learn_throughput": 20.959, "synch_weights_time_ms": 11.278}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "done": false, "training_iteration": 75, "trial_id": "1841f_00000", "date": "2024-08-08_03-44-54", "timestamp": 1723103094, "time_this_iter_s": 192.7907190322876, "time_total_s": 15878.245594739914, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b562eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15878.245594739914, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.623529411764707, "ram_util_percent": 76.18272058823528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6237458421589848, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.533956842503736, "policy_loss": -0.013897734525771187, "vf_loss": 8.546324761251546, "vf_explained_var": 4.7269035071229786e-05, "kl": 0.007649072877970491, "entropy": 0.5723813073767133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 708945.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 1782.0, "episode_reward_min": 554.0, "episode_reward_mean": 965.48, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 432.0}, "policy_reward_mean": {"policy_0": 96.548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1030.0, 774.0, 1201.0, 1077.0, 757.0, 1149.0, 679.0, 705.0, 950.0, 759.0, 942.0, 950.0, 1160.0, 790.0, 1249.0, 1115.0, 947.0, 1323.0, 769.0, 873.0, 1248.0, 1174.0, 999.0, 1110.0, 930.0, 554.0, 1160.0, 1171.0, 1063.0, 899.0, 1133.0, 681.0, 1035.0, 880.0, 838.0, 840.0, 1022.0, 933.0, 1027.0, 752.0, 1235.0, 645.0, 662.0, 621.0, 968.0, 968.0, 981.0, 656.0, 1200.0, 950.0, 960.0, 1087.0, 1167.0, 620.0, 847.0, 977.0, 960.0, 1002.0, 1024.0, 725.0, 1349.0, 940.0, 1196.0, 875.0, 1149.0, 990.0, 1150.0, 923.0, 798.0, 1083.0, 690.0, 809.0, 865.0, 821.0, 1097.0, 1030.0, 1232.0, 806.0, 1200.0, 1050.0, 1162.0, 928.0, 840.0, 840.0, 902.0, 890.0, 1782.0, 1027.0, 949.0, 1237.0, 1131.0, 851.0, 960.0, 840.0, 678.0, 1106.0, 885.0, 892.0, 725.0, 967.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 80.0, 90.0, 90.0, 70.0, 130.0, 140.0, 200.0, 60.0, 80.0, 100.0, 80.0, 10.0, 90.0, 30.0, 40.0, 149.0, 85.0, 70.0, 120.0, 36.0, 160.0, 83.0, 90.0, 160.0, 100.0, 130.0, 230.0, 55.0, 157.0, 50.0, 120.0, 64.0, 100.0, 160.0, 40.0, 190.0, 140.0, 130.0, 83.0, 60.0, 53.0, 190.0, 60.0, 70.0, 0.0, 110.0, -50.0, 100.0, 164.0, 130.0, 100.0, 80.0, 74.0, 200.0, 40.0, 70.0, 65.0, 210.0, 180.0, 60.0, 110.0, 70.0, 55.0, 140.0, 90.0, 40.0, 60.0, -6.0, 60.0, 28.0, 109.0, 180.0, 38.0, 79.0, 35.0, 30.0, 100.0, 87.0, 19.0, 100.0, 70.0, 90.0, 240.0, 10.0, 125.0, 80.0, 70.0, 80.0, 85.0, 30.0, 54.0, 60.0, 110.0, 40.0, 70.0, 35.0, 50.0, 70.0, 240.0, 55.0, 60.0, 89.0, 90.0, 100.0, 90.0, 98.0, 120.0, 120.0, 120.0, 50.0, 90.0, 80.0, 100.0, 60.0, 120.0, 110.0, 100.0, 120.0, 120.0, 150.0, 100.0, 70.0, 80.0, 140.0, 100.0, 150.0, 140.0, 90.0, 140.0, 159.0, 130.0, 100.0, 0.0, 60.0, 30.0, 41.0, 110.0, 80.0, 80.0, 170.0, 140.0, 200.0, 100.0, 170.0, 80.0, 89.0, 110.0, 80.0, 110.0, 70.0, 90.0, 90.0, 150.0, 85.0, 80.0, 160.0, 120.0, 100.0, 170.0, 120.0, 48.0, 150.0, 90.0, 200.0, 120.0, 30.0, 90.0, 70.0, 29.0, 100.0, 150.0, 41.0, 190.0, 336.0, 60.0, 130.0, 175.0, 61.0, 80.0, 80.0, 170.0, 60.0, 70.0, 100.0, 29.0, 50.0, 110.0, 40.0, 60.0, 60.0, 126.0, 80.0, 60.0, 100.0, 24.0, 120.0, 70.0, 183.0, 50.0, 220.0, 43.0, 190.0, 160.0, 93.0, 50.0, 90.0, 170.0, 102.0, 130.0, 79.0, 100.0, 60.0, 115.0, 130.0, 90.0, 150.0, 170.0, 200.0, 80.0, 80.0, 110.0, 130.0, 140.0, 115.0, 110.0, 70.0, 75.0, 80.0, 89.0, 80.0, 100.0, 120.0, 80.0, 120.0, 90.0, 30.0, 190.0, 140.0, 160.0, 18.0, 90.0, 68.0, 107.0, 190.0, 168.0, 107.0, 70.0, 70.0, 42.0, 50.0, 70.0, 27.0, 90.0, 40.0, 17.0, 60.0, 70.0, 70.0, 60.0, 210.0, 180.0, 90.0, 90.0, 100.0, 60.0, 150.0, 90.0, 120.0, 70.0, 130.0, 114.0, 97.0, 190.0, 53.0, 220.0, 80.0, 150.0, 47.0, 90.0, 60.0, 44.0, 40.0, 140.0, 190.0, 80.0, 123.0, 96.0, 150.0, 140.0, 130.0, 140.0, 97.0, 40.0, 60.0, 160.0, 37.0, 115.0, 50.0, 70.0, 140.0, 180.0, 87.0, 79.0, 50.0, 140.0, 120.0, 130.0, 77.0, 130.0, 90.0, 70.0, 60.0, 80.0, 60.0, 50.0, 69.0, 44.0, 80.0, 78.0, 150.0, 120.0, 110.0, 70.0, 120.0, 35.0, 50.0, 190.0, 140.0, 50.0, 100.0, 40.0, 110.0, 40.0, 170.0, 90.0, 30.0, 90.0, 100.0, 110.0, 150.0, 80.0, 105.0, 70.0, 110.0, 84.0, 50.0, 34.0, 58.0, 97.0, 60.0, 70.0, 60.0, 110.0, 110.0, 150.0, 30.0, 50.0, 130.0, 70.0, 25.0, 70.0, 128.0, 140.0, 109.0, 110.0, 140.0, 130.0, 80.0, 90.0, 140.0, 140.0, 80.0, 20.0, 107.0, 80.0, 37.0, 180.0, 80.0, 69.0, 100.0, 110.0, 98.0, 130.0, 120.0, 90.0, 130.0, 70.0, 120.0, 59.0, 80.0, 80.0, 100.0, 50.0, 58.0, 112.0, 140.0, 44.0, 28.0, 60.0, 130.0, 80.0, 120.0, 80.0, 200.0, 120.0, 145.0, 50.0, 100.0, 210.0, 30.0, 60.0, 110.0, 110.0, 80.0, 20.0, 110.0, 60.0, 45.0, 20.0, -25.0, 110.0, 40.0, 80.0, 83.0, 100.0, -16.0, 100.0, 90.0, 100.0, 60.0, -7.0, 100.0, 28.0, 20.0, 50.0, 70.0, 30.0, 110.0, 160.0, 80.0, 100.0, 50.0, 190.0, 63.0, 100.0, 80.0, 70.0, 200.0, 35.0, 190.0, 100.0, 3.0, 30.0, 15.0, 180.0, 140.0, 110.0, 120.0, 80.0, 120.0, 150.0, 150.0, 90.0, 135.0, 50.0, 105.0, 50.0, 60.0, 71.0, 26.0, 120.0, 200.0, 60.0, 90.0, 50.0, 80.0, -10.0, 0.0, 40.0, 55.0, 55.0, 100.0, 112.0, 246.0, 205.0, 120.0, 150.0, 97.0, 60.0, 130.0, 40.0, 90.0, 150.0, 90.0, 120.0, 110.0, 70.0, 80.0, 70.0, 40.0, 200.0, 90.0, 110.0, 80.0, 80.0, 130.0, 80.0, 50.0, 100.0, 190.0, 80.0, 190.0, 80.0, 70.0, 120.0, 100.0, 85.0, 90.0, 82.0, 100.0, 110.0, 230.0, 90.0, 140.0, 150.0, 93.0, 90.0, 64.0, 100.0, 40.0, 80.0, 110.0, 30.0, 90.0, 100.0, 70.0, 20.0, 30.0, 50.0, 70.0, 70.0, 100.0, 25.0, 120.0, 90.0, 120.0, 42.0, 110.0, 100.0, 159.0, 58.0, 70.0, 50.0, 90.0, 60.0, 130.0, 20.0, 160.0, 180.0, 70.0, 110.0, 20.0, 180.0, 160.0, 170.0, 30.0, 40.0, 120.0, 60.0, 160.0, 117.0, 78.0, 120.0, 46.0, 120.0, 51.0, 160.0, 40.0, 110.0, 44.0, 130.0, 160.0, 120.0, 30.0, 70.0, 70.0, 120.0, 140.0, 140.0, 130.0, 100.0, 33.0, 110.0, 20.0, 12.0, 60.0, 80.0, 140.0, 40.0, 60.0, 160.0, 100.0, 110.0, 220.0, 140.0, 220.0, 80.0, 150.0, 109.0, 30.0, 90.0, 90.0, 80.0, 200.0, 100.0, 100.0, 50.0, 90.0, 110.0, 145.0, 150.0, 85.0, 100.0, 100.0, 90.0, 56.0, 150.0, 140.0, 180.0, 120.0, 87.0, 80.0, 130.0, 120.0, 60.0, 60.0, 10.0, 70.0, 138.0, 190.0, 150.0, 60.0, 100.0, 160.0, 90.0, 69.0, 110.0, 80.0, 140.0, 50.0, 60.0, 120.0, 70.0, 110.0, 160.0, 80.0, 130.0, 100.0, 110.0, 190.0, 140.0, 77.0, 150.0, 70.0, 140.0, 173.0, 60.0, 100.0, 50.0, 110.0, 66.0, 40.0, 100.0, 180.0, 43.0, 80.0, 110.0, 124.0, 70.0, 100.0, 90.0, 80.0, 100.0, 60.0, 108.0, 0.0, 140.0, 70.0, 50.0, 150.0, 157.0, 70.0, 60.0, 150.0, 36.0, 120.0, 40.0, 110.0, 190.0, 44.0, 20.0, 60.0, 110.0, 100.0, 76.0, 30.0, 100.0, 60.0, 90.0, 90.0, 50.0, 90.0, 160.0, 20.0, 12.0, 170.0, 64.0, 33.0, 120.0, 80.0, 50.0, 50.0, 110.0, 138.0, 84.0, 75.0, 78.0, 110.0, 90.0, 44.0, 70.0, 60.0, 150.0, 120.0, 160.0, 54.0, 70.0, 52.0, 41.0, 110.0, 50.0, 90.0, 70.0, 210.0, 160.0, 204.0, 63.0, 90.0, 50.0, 120.0, 90.0, 100.0, 140.0, 170.0, 70.0, 40.0, 70.0, 80.0, 150.0, 100.0, 20.0, 210.0, 100.0, 119.0, 48.0, 295.0, 70.0, 170.0, 100.0, 80.0, 80.0, 80.0, 220.0, 109.0, 57.0, 40.0, 40.0, 50.0, 50.0, 80.0, 150.0, 100.0, 100.0, 220.0, 110.0, 40.0, 140.0, 160.0, 100.0, 70.0, 180.0, 60.0, 80.0, 160.0, 130.0, 100.0, 110.0, 70.0, 90.0, 60.0, 56.0, 150.0, 221.0, 110.0, 110.0, 95.0, 110.0, 170.0, 80.0, 10.0, 90.0, 90.0, 130.0, 120.0, 110.0, -22.0, 120.0, 150.0, 130.0, 70.0, 80.0, 70.0, 70.0, 80.0, 80.0, 100.0, 140.0, 90.0, 60.0, 100.0, 160.0, 90.0, 130.0, 40.0, 50.0, 100.0, 20.0, 60.0, 90.0, 130.0, 60.0, 70.0, 130.0, 90.0, 44.0, 168.0, 70.0, 60.0, 80.0, 120.0, 68.0, 56.0, 70.0, 110.0, 120.0, 50.0, 150.0, 119.0, 27.0, 160.0, 140.0, 180.0, 140.0, 150.0, 432.0, 130.0, 90.0, 200.0, 160.0, 70.0, 130.0, 80.0, 110.0, 190.0, 59.0, 80.0, 128.0, 70.0, 110.0, 94.0, 130.0, 150.0, 150.0, 15.0, 80.0, 120.0, 80.0, 80.0, 50.0, 100.0, 110.0, 90.0, 130.0, 130.0, 220.0, 90.0, 180.0, 89.0, 98.0, 50.0, 210.0, 174.0, 95.0, 100.0, 110.0, 134.0, 19.0, 109.0, 130.0, 130.0, 147.0, 146.0, 79.0, 38.0, 28.0, 60.0, 60.0, 29.0, 134.0, 80.0, 230.0, 80.0, 80.0, 90.0, 50.0, 70.0, 130.0, 70.0, 80.0, 100.0, 60.0, 90.0, 90.0, 90.0, 50.0, 50.0, 80.0, 80.0, 150.0, 60.0, 60.0, 100.0, 70.0, 113.0, 40.0, 133.0, 67.0, 20.0, 15.0, 38.0, 180.0, 160.0, 80.0, 120.0, 90.0, 103.0, 35.0, 140.0, 160.0, 10.0, 125.0, 150.0, 90.0, 50.0, 190.0, 80.0, 50.0, 80.0, 60.0, 140.0, 28.0, 6.0, 90.0, -12.0, 130.0, 140.0, 190.0, 60.0, 120.0, 65.0, 116.0, 100.0, 110.0, 130.0, 40.0, 50.0, 60.0, 19.0, 35.0, 80.0, 70.0, 140.0, 46.0, 31.0, 141.0, 140.0, 149.0, 80.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8048264090222081, "mean_inference_ms": 1.8198361825610416, "mean_action_processing_ms": 0.5383555140278411, "mean_env_wait_ms": 1.2285905508735333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01583409309387207, "StateBufferConnector_ms": 0.009153366088867188, "ViewRequirementAgentConnector_ms": 0.37285375595092773}, "num_episodes": 18, "episode_return_max": 1782.0, "episode_return_min": 554.0, "episode_return_mean": 965.48}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.717002611027393, "num_env_steps_trained_throughput_per_sec": 20.717002611027393, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 193054.273, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193054.23, "sample_time_ms": 2217.804, "learn_time_ms": 190816.659, "learn_throughput": 20.963, "synch_weights_time_ms": 11.148}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 76, "trial_id": "1841f_00000", "date": "2024-08-08_03-48-07", "timestamp": 1723103287, "time_this_iter_s": 193.08867120742798, "time_total_s": 16071.334265947342, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b562eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16071.334265947342, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 18.171062271062272, "ram_util_percent": 75.67765567765568}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.584395326262973, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.35470809621679, "policy_loss": -0.013059171322902765, "vf_loss": 8.366353373227916, "vf_explained_var": 0.0005079666710001465, "kl": 0.00706948474937111, "entropy": 0.5680878328629576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 718335.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "env_runners": {"episode_reward_max": 1782.0, "episode_reward_min": 398.0, "episode_reward_mean": 946.42, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -25.0}, "policy_reward_max": {"policy_0": 432.0}, "policy_reward_mean": {"policy_0": 94.642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1110.0, 930.0, 554.0, 1160.0, 1171.0, 1063.0, 899.0, 1133.0, 681.0, 1035.0, 880.0, 838.0, 840.0, 1022.0, 933.0, 1027.0, 752.0, 1235.0, 645.0, 662.0, 621.0, 968.0, 968.0, 981.0, 656.0, 1200.0, 950.0, 960.0, 1087.0, 1167.0, 620.0, 847.0, 977.0, 960.0, 1002.0, 1024.0, 725.0, 1349.0, 940.0, 1196.0, 875.0, 1149.0, 990.0, 1150.0, 923.0, 798.0, 1083.0, 690.0, 809.0, 865.0, 821.0, 1097.0, 1030.0, 1232.0, 806.0, 1200.0, 1050.0, 1162.0, 928.0, 840.0, 840.0, 902.0, 890.0, 1782.0, 1027.0, 949.0, 1237.0, 1131.0, 851.0, 960.0, 840.0, 678.0, 1106.0, 885.0, 892.0, 725.0, 967.0, 837.0, 841.0, 924.0, 634.0, 785.0, 558.0, 1207.0, 1231.0, 902.0, 758.0, 1328.0, 989.0, 958.0, 956.0, 1109.0, 715.0, 1280.0, 398.0, 735.0, 779.0, 740.0, 837.0, 1213.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 100.0, 120.0, 80.0, 120.0, 90.0, 30.0, 190.0, 140.0, 160.0, 18.0, 90.0, 68.0, 107.0, 190.0, 168.0, 107.0, 70.0, 70.0, 42.0, 50.0, 70.0, 27.0, 90.0, 40.0, 17.0, 60.0, 70.0, 70.0, 60.0, 210.0, 180.0, 90.0, 90.0, 100.0, 60.0, 150.0, 90.0, 120.0, 70.0, 130.0, 114.0, 97.0, 190.0, 53.0, 220.0, 80.0, 150.0, 47.0, 90.0, 60.0, 44.0, 40.0, 140.0, 190.0, 80.0, 123.0, 96.0, 150.0, 140.0, 130.0, 140.0, 97.0, 40.0, 60.0, 160.0, 37.0, 115.0, 50.0, 70.0, 140.0, 180.0, 87.0, 79.0, 50.0, 140.0, 120.0, 130.0, 77.0, 130.0, 90.0, 70.0, 60.0, 80.0, 60.0, 50.0, 69.0, 44.0, 80.0, 78.0, 150.0, 120.0, 110.0, 70.0, 120.0, 35.0, 50.0, 190.0, 140.0, 50.0, 100.0, 40.0, 110.0, 40.0, 170.0, 90.0, 30.0, 90.0, 100.0, 110.0, 150.0, 80.0, 105.0, 70.0, 110.0, 84.0, 50.0, 34.0, 58.0, 97.0, 60.0, 70.0, 60.0, 110.0, 110.0, 150.0, 30.0, 50.0, 130.0, 70.0, 25.0, 70.0, 128.0, 140.0, 109.0, 110.0, 140.0, 130.0, 80.0, 90.0, 140.0, 140.0, 80.0, 20.0, 107.0, 80.0, 37.0, 180.0, 80.0, 69.0, 100.0, 110.0, 98.0, 130.0, 120.0, 90.0, 130.0, 70.0, 120.0, 59.0, 80.0, 80.0, 100.0, 50.0, 58.0, 112.0, 140.0, 44.0, 28.0, 60.0, 130.0, 80.0, 120.0, 80.0, 200.0, 120.0, 145.0, 50.0, 100.0, 210.0, 30.0, 60.0, 110.0, 110.0, 80.0, 20.0, 110.0, 60.0, 45.0, 20.0, -25.0, 110.0, 40.0, 80.0, 83.0, 100.0, -16.0, 100.0, 90.0, 100.0, 60.0, -7.0, 100.0, 28.0, 20.0, 50.0, 70.0, 30.0, 110.0, 160.0, 80.0, 100.0, 50.0, 190.0, 63.0, 100.0, 80.0, 70.0, 200.0, 35.0, 190.0, 100.0, 3.0, 30.0, 15.0, 180.0, 140.0, 110.0, 120.0, 80.0, 120.0, 150.0, 150.0, 90.0, 135.0, 50.0, 105.0, 50.0, 60.0, 71.0, 26.0, 120.0, 200.0, 60.0, 90.0, 50.0, 80.0, -10.0, 0.0, 40.0, 55.0, 55.0, 100.0, 112.0, 246.0, 205.0, 120.0, 150.0, 97.0, 60.0, 130.0, 40.0, 90.0, 150.0, 90.0, 120.0, 110.0, 70.0, 80.0, 70.0, 40.0, 200.0, 90.0, 110.0, 80.0, 80.0, 130.0, 80.0, 50.0, 100.0, 190.0, 80.0, 190.0, 80.0, 70.0, 120.0, 100.0, 85.0, 90.0, 82.0, 100.0, 110.0, 230.0, 90.0, 140.0, 150.0, 93.0, 90.0, 64.0, 100.0, 40.0, 80.0, 110.0, 30.0, 90.0, 100.0, 70.0, 20.0, 30.0, 50.0, 70.0, 70.0, 100.0, 25.0, 120.0, 90.0, 120.0, 42.0, 110.0, 100.0, 159.0, 58.0, 70.0, 50.0, 90.0, 60.0, 130.0, 20.0, 160.0, 180.0, 70.0, 110.0, 20.0, 180.0, 160.0, 170.0, 30.0, 40.0, 120.0, 60.0, 160.0, 117.0, 78.0, 120.0, 46.0, 120.0, 51.0, 160.0, 40.0, 110.0, 44.0, 130.0, 160.0, 120.0, 30.0, 70.0, 70.0, 120.0, 140.0, 140.0, 130.0, 100.0, 33.0, 110.0, 20.0, 12.0, 60.0, 80.0, 140.0, 40.0, 60.0, 160.0, 100.0, 110.0, 220.0, 140.0, 220.0, 80.0, 150.0, 109.0, 30.0, 90.0, 90.0, 80.0, 200.0, 100.0, 100.0, 50.0, 90.0, 110.0, 145.0, 150.0, 85.0, 100.0, 100.0, 90.0, 56.0, 150.0, 140.0, 180.0, 120.0, 87.0, 80.0, 130.0, 120.0, 60.0, 60.0, 10.0, 70.0, 138.0, 190.0, 150.0, 60.0, 100.0, 160.0, 90.0, 69.0, 110.0, 80.0, 140.0, 50.0, 60.0, 120.0, 70.0, 110.0, 160.0, 80.0, 130.0, 100.0, 110.0, 190.0, 140.0, 77.0, 150.0, 70.0, 140.0, 173.0, 60.0, 100.0, 50.0, 110.0, 66.0, 40.0, 100.0, 180.0, 43.0, 80.0, 110.0, 124.0, 70.0, 100.0, 90.0, 80.0, 100.0, 60.0, 108.0, 0.0, 140.0, 70.0, 50.0, 150.0, 157.0, 70.0, 60.0, 150.0, 36.0, 120.0, 40.0, 110.0, 190.0, 44.0, 20.0, 60.0, 110.0, 100.0, 76.0, 30.0, 100.0, 60.0, 90.0, 90.0, 50.0, 90.0, 160.0, 20.0, 12.0, 170.0, 64.0, 33.0, 120.0, 80.0, 50.0, 50.0, 110.0, 138.0, 84.0, 75.0, 78.0, 110.0, 90.0, 44.0, 70.0, 60.0, 150.0, 120.0, 160.0, 54.0, 70.0, 52.0, 41.0, 110.0, 50.0, 90.0, 70.0, 210.0, 160.0, 204.0, 63.0, 90.0, 50.0, 120.0, 90.0, 100.0, 140.0, 170.0, 70.0, 40.0, 70.0, 80.0, 150.0, 100.0, 20.0, 210.0, 100.0, 119.0, 48.0, 295.0, 70.0, 170.0, 100.0, 80.0, 80.0, 80.0, 220.0, 109.0, 57.0, 40.0, 40.0, 50.0, 50.0, 80.0, 150.0, 100.0, 100.0, 220.0, 110.0, 40.0, 140.0, 160.0, 100.0, 70.0, 180.0, 60.0, 80.0, 160.0, 130.0, 100.0, 110.0, 70.0, 90.0, 60.0, 56.0, 150.0, 221.0, 110.0, 110.0, 95.0, 110.0, 170.0, 80.0, 10.0, 90.0, 90.0, 130.0, 120.0, 110.0, -22.0, 120.0, 150.0, 130.0, 70.0, 80.0, 70.0, 70.0, 80.0, 80.0, 100.0, 140.0, 90.0, 60.0, 100.0, 160.0, 90.0, 130.0, 40.0, 50.0, 100.0, 20.0, 60.0, 90.0, 130.0, 60.0, 70.0, 130.0, 90.0, 44.0, 168.0, 70.0, 60.0, 80.0, 120.0, 68.0, 56.0, 70.0, 110.0, 120.0, 50.0, 150.0, 119.0, 27.0, 160.0, 140.0, 180.0, 140.0, 150.0, 432.0, 130.0, 90.0, 200.0, 160.0, 70.0, 130.0, 80.0, 110.0, 190.0, 59.0, 80.0, 128.0, 70.0, 110.0, 94.0, 130.0, 150.0, 150.0, 15.0, 80.0, 120.0, 80.0, 80.0, 50.0, 100.0, 110.0, 90.0, 130.0, 130.0, 220.0, 90.0, 180.0, 89.0, 98.0, 50.0, 210.0, 174.0, 95.0, 100.0, 110.0, 134.0, 19.0, 109.0, 130.0, 130.0, 147.0, 146.0, 79.0, 38.0, 28.0, 60.0, 60.0, 29.0, 134.0, 80.0, 230.0, 80.0, 80.0, 90.0, 50.0, 70.0, 130.0, 70.0, 80.0, 100.0, 60.0, 90.0, 90.0, 90.0, 50.0, 50.0, 80.0, 80.0, 150.0, 60.0, 60.0, 100.0, 70.0, 113.0, 40.0, 133.0, 67.0, 20.0, 15.0, 38.0, 180.0, 160.0, 80.0, 120.0, 90.0, 103.0, 35.0, 140.0, 160.0, 10.0, 125.0, 150.0, 90.0, 50.0, 190.0, 80.0, 50.0, 80.0, 60.0, 140.0, 28.0, 6.0, 90.0, -12.0, 130.0, 140.0, 190.0, 60.0, 120.0, 65.0, 116.0, 100.0, 110.0, 130.0, 40.0, 50.0, 60.0, 19.0, 35.0, 80.0, 70.0, 140.0, 46.0, 31.0, 141.0, 140.0, 149.0, 80.0, 90.0, 30.0, 120.0, 63.0, 110.0, 120.0, 109.0, 100.0, 49.0, 70.0, 66.0, 160.0, 30.0, 15.0, 110.0, 70.0, 160.0, 90.0, 56.0, 40.0, 110.0, 150.0, 70.0, 70.0, 70.0, 56.0, 0.0, 180.0, 90.0, 108.0, 130.0, 69.0, 40.0, 80.0, 15.0, 20.0, 60.0, 100.0, 120.0, 100.0, 30.0, 50.0, 70.0, 100.0, 70.0, 30.0, 50.0, 120.0, 145.0, 80.0, 70.0, 28.0, 40.0, 110.0, 40.0, 130.0, 30.0, 60.0, 30.0, 50.0, 40.0, 150.0, 160.0, 140.0, 200.0, 80.0, 68.0, 30.0, 130.0, 89.0, 160.0, 160.0, 130.0, 122.0, 120.0, 39.0, 150.0, 60.0, 130.0, 100.0, 220.0, 70.0, 90.0, 90.0, 60.0, 210.0, 21.0, 70.0, 110.0, 150.0, 31.0, 65.0, 90.0, 39.0, 70.0, 70.0, 130.0, 40.0, 80.0, 80.0, 94.0, 90.0, 73.0, 100.0, 140.0, 290.0, 116.0, 109.0, 110.0, 110.0, 190.0, 60.0, 90.0, 90.0, 99.0, 70.0, 180.0, 210.0, 60.0, 60.0, 70.0, 120.0, 140.0, 70.0, 160.0, 34.0, 50.0, 60.0, 164.0, 90.0, 70.0, 108.0, 60.0, 100.0, 80.0, 200.0, 150.0, 90.0, 90.0, 50.0, 28.0, 160.0, 70.0, 45.0, 98.0, 86.0, 110.0, 110.0, 210.0, 100.0, 120.0, 90.0, 66.0, 10.0, 60.0, 74.0, 30.0, 250.0, 50.0, 50.0, 35.0, 100.0, 80.0, 110.0, 240.0, 80.0, 140.0, 140.0, 190.0, 90.0, 110.0, 20.0, 30.0, 20.0, 40.0, 58.0, 50.0, 80.0, 30.0, 50.0, 20.0, 40.0, 50.0, 90.0, 70.0, 108.0, 107.0, 40.0, 80.0, 120.0, 30.0, 109.0, 117.0, 50.0, 16.0, 56.0, 90.0, 160.0, 14.0, 67.0, 100.0, 200.0, 60.0, 100.0, 50.0, 20.0, 40.0, 80.0, 90.0, 50.0, 50.0, 60.0, 120.0, 90.0, 60.0, 67.0, 100.0, 120.0, 100.0, 10.0, 110.0, 50.0, 115.0, 210.0, 180.0, 140.0, 70.0, 90.0, 70.0, 180.0, 108.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.798157366312855, "mean_inference_ms": 1.8133160695616144, "mean_action_processing_ms": 0.5375238620779644, "mean_env_wait_ms": 1.2243745951563445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011579036712646484, "StateBufferConnector_ms": 0.008965730667114258, "ViewRequirementAgentConnector_ms": 0.3618278503417969}, "num_episodes": 23, "episode_return_max": 1782.0, "episode_return_min": 398.0, "episode_return_mean": 946.42}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.54526107378958, "num_env_steps_trained_throughput_per_sec": 20.54526107378958, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 3080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3080000, "timers": {"training_iteration_time_ms": 193161.476, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193161.433, "sample_time_ms": 2236.389, "learn_time_ms": 190905.831, "learn_throughput": 20.953, "synch_weights_time_ms": 10.8}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "done": false, "training_iteration": 77, "trial_id": "1841f_00000", "date": "2024-08-08_03-51-22", "timestamp": 1723103482, "time_this_iter_s": 194.70562601089478, "time_total_s": 16266.039891958237, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b562e5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16266.039891958237, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 19.024275362318843, "ram_util_percent": 74.99166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.408751714299408, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.423745087287424, "policy_loss": -0.013189962345767563, "vf_loss": 8.435452171738028, "vf_explained_var": -0.004181333713003368, "kl": 0.0074143622773292965, "entropy": 0.5318018164878455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 727725.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 1782.0, "episode_reward_min": 398.0, "episode_reward_mean": 940.28, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -30.0}, "policy_reward_max": {"policy_0": 432.0}, "policy_reward_mean": {"policy_0": 94.028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [645.0, 662.0, 621.0, 968.0, 968.0, 981.0, 656.0, 1200.0, 950.0, 960.0, 1087.0, 1167.0, 620.0, 847.0, 977.0, 960.0, 1002.0, 1024.0, 725.0, 1349.0, 940.0, 1196.0, 875.0, 1149.0, 990.0, 1150.0, 923.0, 798.0, 1083.0, 690.0, 809.0, 865.0, 821.0, 1097.0, 1030.0, 1232.0, 806.0, 1200.0, 1050.0, 1162.0, 928.0, 840.0, 840.0, 902.0, 890.0, 1782.0, 1027.0, 949.0, 1237.0, 1131.0, 851.0, 960.0, 840.0, 678.0, 1106.0, 885.0, 892.0, 725.0, 967.0, 837.0, 841.0, 924.0, 634.0, 785.0, 558.0, 1207.0, 1231.0, 902.0, 758.0, 1328.0, 989.0, 958.0, 956.0, 1109.0, 715.0, 1280.0, 398.0, 735.0, 779.0, 740.0, 837.0, 1213.0, 857.0, 1019.0, 660.0, 1069.0, 495.0, 1178.0, 803.0, 1052.0, 1065.0, 1201.0, 1126.0, 848.0, 790.0, 810.0, 610.0, 1160.0, 903.0, 1003.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 60.0, 110.0, 110.0, 80.0, 20.0, 110.0, 60.0, 45.0, 20.0, -25.0, 110.0, 40.0, 80.0, 83.0, 100.0, -16.0, 100.0, 90.0, 100.0, 60.0, -7.0, 100.0, 28.0, 20.0, 50.0, 70.0, 30.0, 110.0, 160.0, 80.0, 100.0, 50.0, 190.0, 63.0, 100.0, 80.0, 70.0, 200.0, 35.0, 190.0, 100.0, 3.0, 30.0, 15.0, 180.0, 140.0, 110.0, 120.0, 80.0, 120.0, 150.0, 150.0, 90.0, 135.0, 50.0, 105.0, 50.0, 60.0, 71.0, 26.0, 120.0, 200.0, 60.0, 90.0, 50.0, 80.0, -10.0, 0.0, 40.0, 55.0, 55.0, 100.0, 112.0, 246.0, 205.0, 120.0, 150.0, 97.0, 60.0, 130.0, 40.0, 90.0, 150.0, 90.0, 120.0, 110.0, 70.0, 80.0, 70.0, 40.0, 200.0, 90.0, 110.0, 80.0, 80.0, 130.0, 80.0, 50.0, 100.0, 190.0, 80.0, 190.0, 80.0, 70.0, 120.0, 100.0, 85.0, 90.0, 82.0, 100.0, 110.0, 230.0, 90.0, 140.0, 150.0, 93.0, 90.0, 64.0, 100.0, 40.0, 80.0, 110.0, 30.0, 90.0, 100.0, 70.0, 20.0, 30.0, 50.0, 70.0, 70.0, 100.0, 25.0, 120.0, 90.0, 120.0, 42.0, 110.0, 100.0, 159.0, 58.0, 70.0, 50.0, 90.0, 60.0, 130.0, 20.0, 160.0, 180.0, 70.0, 110.0, 20.0, 180.0, 160.0, 170.0, 30.0, 40.0, 120.0, 60.0, 160.0, 117.0, 78.0, 120.0, 46.0, 120.0, 51.0, 160.0, 40.0, 110.0, 44.0, 130.0, 160.0, 120.0, 30.0, 70.0, 70.0, 120.0, 140.0, 140.0, 130.0, 100.0, 33.0, 110.0, 20.0, 12.0, 60.0, 80.0, 140.0, 40.0, 60.0, 160.0, 100.0, 110.0, 220.0, 140.0, 220.0, 80.0, 150.0, 109.0, 30.0, 90.0, 90.0, 80.0, 200.0, 100.0, 100.0, 50.0, 90.0, 110.0, 145.0, 150.0, 85.0, 100.0, 100.0, 90.0, 56.0, 150.0, 140.0, 180.0, 120.0, 87.0, 80.0, 130.0, 120.0, 60.0, 60.0, 10.0, 70.0, 138.0, 190.0, 150.0, 60.0, 100.0, 160.0, 90.0, 69.0, 110.0, 80.0, 140.0, 50.0, 60.0, 120.0, 70.0, 110.0, 160.0, 80.0, 130.0, 100.0, 110.0, 190.0, 140.0, 77.0, 150.0, 70.0, 140.0, 173.0, 60.0, 100.0, 50.0, 110.0, 66.0, 40.0, 100.0, 180.0, 43.0, 80.0, 110.0, 124.0, 70.0, 100.0, 90.0, 80.0, 100.0, 60.0, 108.0, 0.0, 140.0, 70.0, 50.0, 150.0, 157.0, 70.0, 60.0, 150.0, 36.0, 120.0, 40.0, 110.0, 190.0, 44.0, 20.0, 60.0, 110.0, 100.0, 76.0, 30.0, 100.0, 60.0, 90.0, 90.0, 50.0, 90.0, 160.0, 20.0, 12.0, 170.0, 64.0, 33.0, 120.0, 80.0, 50.0, 50.0, 110.0, 138.0, 84.0, 75.0, 78.0, 110.0, 90.0, 44.0, 70.0, 60.0, 150.0, 120.0, 160.0, 54.0, 70.0, 52.0, 41.0, 110.0, 50.0, 90.0, 70.0, 210.0, 160.0, 204.0, 63.0, 90.0, 50.0, 120.0, 90.0, 100.0, 140.0, 170.0, 70.0, 40.0, 70.0, 80.0, 150.0, 100.0, 20.0, 210.0, 100.0, 119.0, 48.0, 295.0, 70.0, 170.0, 100.0, 80.0, 80.0, 80.0, 220.0, 109.0, 57.0, 40.0, 40.0, 50.0, 50.0, 80.0, 150.0, 100.0, 100.0, 220.0, 110.0, 40.0, 140.0, 160.0, 100.0, 70.0, 180.0, 60.0, 80.0, 160.0, 130.0, 100.0, 110.0, 70.0, 90.0, 60.0, 56.0, 150.0, 221.0, 110.0, 110.0, 95.0, 110.0, 170.0, 80.0, 10.0, 90.0, 90.0, 130.0, 120.0, 110.0, -22.0, 120.0, 150.0, 130.0, 70.0, 80.0, 70.0, 70.0, 80.0, 80.0, 100.0, 140.0, 90.0, 60.0, 100.0, 160.0, 90.0, 130.0, 40.0, 50.0, 100.0, 20.0, 60.0, 90.0, 130.0, 60.0, 70.0, 130.0, 90.0, 44.0, 168.0, 70.0, 60.0, 80.0, 120.0, 68.0, 56.0, 70.0, 110.0, 120.0, 50.0, 150.0, 119.0, 27.0, 160.0, 140.0, 180.0, 140.0, 150.0, 432.0, 130.0, 90.0, 200.0, 160.0, 70.0, 130.0, 80.0, 110.0, 190.0, 59.0, 80.0, 128.0, 70.0, 110.0, 94.0, 130.0, 150.0, 150.0, 15.0, 80.0, 120.0, 80.0, 80.0, 50.0, 100.0, 110.0, 90.0, 130.0, 130.0, 220.0, 90.0, 180.0, 89.0, 98.0, 50.0, 210.0, 174.0, 95.0, 100.0, 110.0, 134.0, 19.0, 109.0, 130.0, 130.0, 147.0, 146.0, 79.0, 38.0, 28.0, 60.0, 60.0, 29.0, 134.0, 80.0, 230.0, 80.0, 80.0, 90.0, 50.0, 70.0, 130.0, 70.0, 80.0, 100.0, 60.0, 90.0, 90.0, 90.0, 50.0, 50.0, 80.0, 80.0, 150.0, 60.0, 60.0, 100.0, 70.0, 113.0, 40.0, 133.0, 67.0, 20.0, 15.0, 38.0, 180.0, 160.0, 80.0, 120.0, 90.0, 103.0, 35.0, 140.0, 160.0, 10.0, 125.0, 150.0, 90.0, 50.0, 190.0, 80.0, 50.0, 80.0, 60.0, 140.0, 28.0, 6.0, 90.0, -12.0, 130.0, 140.0, 190.0, 60.0, 120.0, 65.0, 116.0, 100.0, 110.0, 130.0, 40.0, 50.0, 60.0, 19.0, 35.0, 80.0, 70.0, 140.0, 46.0, 31.0, 141.0, 140.0, 149.0, 80.0, 90.0, 30.0, 120.0, 63.0, 110.0, 120.0, 109.0, 100.0, 49.0, 70.0, 66.0, 160.0, 30.0, 15.0, 110.0, 70.0, 160.0, 90.0, 56.0, 40.0, 110.0, 150.0, 70.0, 70.0, 70.0, 56.0, 0.0, 180.0, 90.0, 108.0, 130.0, 69.0, 40.0, 80.0, 15.0, 20.0, 60.0, 100.0, 120.0, 100.0, 30.0, 50.0, 70.0, 100.0, 70.0, 30.0, 50.0, 120.0, 145.0, 80.0, 70.0, 28.0, 40.0, 110.0, 40.0, 130.0, 30.0, 60.0, 30.0, 50.0, 40.0, 150.0, 160.0, 140.0, 200.0, 80.0, 68.0, 30.0, 130.0, 89.0, 160.0, 160.0, 130.0, 122.0, 120.0, 39.0, 150.0, 60.0, 130.0, 100.0, 220.0, 70.0, 90.0, 90.0, 60.0, 210.0, 21.0, 70.0, 110.0, 150.0, 31.0, 65.0, 90.0, 39.0, 70.0, 70.0, 130.0, 40.0, 80.0, 80.0, 94.0, 90.0, 73.0, 100.0, 140.0, 290.0, 116.0, 109.0, 110.0, 110.0, 190.0, 60.0, 90.0, 90.0, 99.0, 70.0, 180.0, 210.0, 60.0, 60.0, 70.0, 120.0, 140.0, 70.0, 160.0, 34.0, 50.0, 60.0, 164.0, 90.0, 70.0, 108.0, 60.0, 100.0, 80.0, 200.0, 150.0, 90.0, 90.0, 50.0, 28.0, 160.0, 70.0, 45.0, 98.0, 86.0, 110.0, 110.0, 210.0, 100.0, 120.0, 90.0, 66.0, 10.0, 60.0, 74.0, 30.0, 250.0, 50.0, 50.0, 35.0, 100.0, 80.0, 110.0, 240.0, 80.0, 140.0, 140.0, 190.0, 90.0, 110.0, 20.0, 30.0, 20.0, 40.0, 58.0, 50.0, 80.0, 30.0, 50.0, 20.0, 40.0, 50.0, 90.0, 70.0, 108.0, 107.0, 40.0, 80.0, 120.0, 30.0, 109.0, 117.0, 50.0, 16.0, 56.0, 90.0, 160.0, 14.0, 67.0, 100.0, 200.0, 60.0, 100.0, 50.0, 20.0, 40.0, 80.0, 90.0, 50.0, 50.0, 60.0, 120.0, 90.0, 60.0, 67.0, 100.0, 120.0, 100.0, 10.0, 110.0, 50.0, 115.0, 210.0, 180.0, 140.0, 70.0, 90.0, 70.0, 180.0, 108.0, 54.0, 140.0, 120.0, 50.0, 73.0, 220.0, 60.0, -30.0, 70.0, 100.0, 70.0, 69.0, 130.0, 110.0, 110.0, 60.0, 150.0, 110.0, 90.0, 120.0, 35.0, -15.0, 60.0, 130.0, 140.0, 160.0, 30.0, 50.0, 40.0, 30.0, 100.0, 90.0, 110.0, 129.0, 110.0, 110.0, 120.0, 140.0, 80.0, 80.0, 20.0, 40.0, 64.0, 68.0, 80.0, 0.0, 53.0, 30.0, 100.0, 40.0, 50.0, 130.0, 172.0, 114.0, 22.0, 90.0, 120.0, 120.0, 150.0, 210.0, 120.0, 47.0, 100.0, 140.0, 80.0, -19.0, 66.0, 140.0, 100.0, 29.0, 210.0, -1.0, 160.0, 90.0, 90.0, 81.0, 60.0, 100.0, 120.0, 142.0, 100.0, 60.0, 50.0, 110.0, 110.0, 90.0, 125.0, 180.0, 90.0, 150.0, 66.0, 100.0, 130.0, 202.0, 120.0, 122.0, 200.0, 80.0, 119.0, 62.0, 60.0, 60.0, 38.0, 200.0, 110.0, 260.0, 60.0, 80.0, 150.0, 108.0, 30.0, 40.0, 100.0, 68.0, 70.0, 70.0, 210.0, 90.0, 80.0, 90.0, 60.0, 100.0, 60.0, 80.0, 100.0, 100.0, 90.0, 70.0, 30.0, 100.0, 140.0, 50.0, 100.0, 70.0, 80.0, 80.0, 70.0, 80.0, 90.0, 50.0, 60.0, 20.0, 30.0, 90.0, 50.0, 60.0, 60.0, 50.0, 80.0, 110.0, 137.0, 150.0, 38.0, 220.0, 100.0, 97.0, 100.0, 80.0, 90.0, 148.0, 5.0, 80.0, 54.0, 50.0, 100.0, 34.0, 110.0, 160.0, 90.0, 220.0, 182.0, 130.0, 42.0, 100.0, 100.0, 100.0, 90.0, 89.0, 80.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7936290690332641, "mean_inference_ms": 1.8082418341468713, "mean_action_processing_ms": 0.537062933891573, "mean_env_wait_ms": 1.2211262237463605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01155543327331543, "StateBufferConnector_ms": 0.008866310119628906, "ViewRequirementAgentConnector_ms": 0.35186266899108887}, "num_episodes": 18, "episode_return_max": 1782.0, "episode_return_min": 398.0, "episode_return_mean": 940.28}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.621771988906147, "num_env_steps_trained_throughput_per_sec": 20.621771988906147, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 193229.531, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193229.488, "sample_time_ms": 2245.268, "learn_time_ms": 190965.222, "learn_throughput": 20.946, "synch_weights_time_ms": 10.917}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 78, "trial_id": "1841f_00000", "date": "2024-08-08_03-54-36", "timestamp": 1723103676, "time_this_iter_s": 193.9797592163086, "time_total_s": 16460.019651174545, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2450550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16460.019651174545, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 18.985401459854014, "ram_util_percent": 75.9978102189781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.381560695038055, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.540023418737295, "policy_loss": -0.013465349525520707, "vf_loss": 8.552014541930665, "vf_explained_var": -0.004870594303194072, "kl": 0.007371051289445369, "entropy": 0.5389136998226848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 737115.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "env_runners": {"episode_reward_max": 1782.0, "episode_reward_min": 398.0, "episode_reward_mean": 954.13, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -35.0}, "policy_reward_max": {"policy_0": 432.0}, "policy_reward_mean": {"policy_0": 95.413}, "custom_metrics": {}, "hist_stats": {"episode_reward": [725.0, 1349.0, 940.0, 1196.0, 875.0, 1149.0, 990.0, 1150.0, 923.0, 798.0, 1083.0, 690.0, 809.0, 865.0, 821.0, 1097.0, 1030.0, 1232.0, 806.0, 1200.0, 1050.0, 1162.0, 928.0, 840.0, 840.0, 902.0, 890.0, 1782.0, 1027.0, 949.0, 1237.0, 1131.0, 851.0, 960.0, 840.0, 678.0, 1106.0, 885.0, 892.0, 725.0, 967.0, 837.0, 841.0, 924.0, 634.0, 785.0, 558.0, 1207.0, 1231.0, 902.0, 758.0, 1328.0, 989.0, 958.0, 956.0, 1109.0, 715.0, 1280.0, 398.0, 735.0, 779.0, 740.0, 837.0, 1213.0, 857.0, 1019.0, 660.0, 1069.0, 495.0, 1178.0, 803.0, 1052.0, 1065.0, 1201.0, 1126.0, 848.0, 790.0, 810.0, 610.0, 1160.0, 903.0, 1003.0, 767.0, 1100.0, 1346.0, 990.0, 1139.0, 746.0, 664.0, 1170.0, 900.0, 954.0, 1390.0, 888.0, 903.0, 830.0, 1169.0, 899.0, 595.0, 1230.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 100.0, 33.0, 110.0, 20.0, 12.0, 60.0, 80.0, 140.0, 40.0, 60.0, 160.0, 100.0, 110.0, 220.0, 140.0, 220.0, 80.0, 150.0, 109.0, 30.0, 90.0, 90.0, 80.0, 200.0, 100.0, 100.0, 50.0, 90.0, 110.0, 145.0, 150.0, 85.0, 100.0, 100.0, 90.0, 56.0, 150.0, 140.0, 180.0, 120.0, 87.0, 80.0, 130.0, 120.0, 60.0, 60.0, 10.0, 70.0, 138.0, 190.0, 150.0, 60.0, 100.0, 160.0, 90.0, 69.0, 110.0, 80.0, 140.0, 50.0, 60.0, 120.0, 70.0, 110.0, 160.0, 80.0, 130.0, 100.0, 110.0, 190.0, 140.0, 77.0, 150.0, 70.0, 140.0, 173.0, 60.0, 100.0, 50.0, 110.0, 66.0, 40.0, 100.0, 180.0, 43.0, 80.0, 110.0, 124.0, 70.0, 100.0, 90.0, 80.0, 100.0, 60.0, 108.0, 0.0, 140.0, 70.0, 50.0, 150.0, 157.0, 70.0, 60.0, 150.0, 36.0, 120.0, 40.0, 110.0, 190.0, 44.0, 20.0, 60.0, 110.0, 100.0, 76.0, 30.0, 100.0, 60.0, 90.0, 90.0, 50.0, 90.0, 160.0, 20.0, 12.0, 170.0, 64.0, 33.0, 120.0, 80.0, 50.0, 50.0, 110.0, 138.0, 84.0, 75.0, 78.0, 110.0, 90.0, 44.0, 70.0, 60.0, 150.0, 120.0, 160.0, 54.0, 70.0, 52.0, 41.0, 110.0, 50.0, 90.0, 70.0, 210.0, 160.0, 204.0, 63.0, 90.0, 50.0, 120.0, 90.0, 100.0, 140.0, 170.0, 70.0, 40.0, 70.0, 80.0, 150.0, 100.0, 20.0, 210.0, 100.0, 119.0, 48.0, 295.0, 70.0, 170.0, 100.0, 80.0, 80.0, 80.0, 220.0, 109.0, 57.0, 40.0, 40.0, 50.0, 50.0, 80.0, 150.0, 100.0, 100.0, 220.0, 110.0, 40.0, 140.0, 160.0, 100.0, 70.0, 180.0, 60.0, 80.0, 160.0, 130.0, 100.0, 110.0, 70.0, 90.0, 60.0, 56.0, 150.0, 221.0, 110.0, 110.0, 95.0, 110.0, 170.0, 80.0, 10.0, 90.0, 90.0, 130.0, 120.0, 110.0, -22.0, 120.0, 150.0, 130.0, 70.0, 80.0, 70.0, 70.0, 80.0, 80.0, 100.0, 140.0, 90.0, 60.0, 100.0, 160.0, 90.0, 130.0, 40.0, 50.0, 100.0, 20.0, 60.0, 90.0, 130.0, 60.0, 70.0, 130.0, 90.0, 44.0, 168.0, 70.0, 60.0, 80.0, 120.0, 68.0, 56.0, 70.0, 110.0, 120.0, 50.0, 150.0, 119.0, 27.0, 160.0, 140.0, 180.0, 140.0, 150.0, 432.0, 130.0, 90.0, 200.0, 160.0, 70.0, 130.0, 80.0, 110.0, 190.0, 59.0, 80.0, 128.0, 70.0, 110.0, 94.0, 130.0, 150.0, 150.0, 15.0, 80.0, 120.0, 80.0, 80.0, 50.0, 100.0, 110.0, 90.0, 130.0, 130.0, 220.0, 90.0, 180.0, 89.0, 98.0, 50.0, 210.0, 174.0, 95.0, 100.0, 110.0, 134.0, 19.0, 109.0, 130.0, 130.0, 147.0, 146.0, 79.0, 38.0, 28.0, 60.0, 60.0, 29.0, 134.0, 80.0, 230.0, 80.0, 80.0, 90.0, 50.0, 70.0, 130.0, 70.0, 80.0, 100.0, 60.0, 90.0, 90.0, 90.0, 50.0, 50.0, 80.0, 80.0, 150.0, 60.0, 60.0, 100.0, 70.0, 113.0, 40.0, 133.0, 67.0, 20.0, 15.0, 38.0, 180.0, 160.0, 80.0, 120.0, 90.0, 103.0, 35.0, 140.0, 160.0, 10.0, 125.0, 150.0, 90.0, 50.0, 190.0, 80.0, 50.0, 80.0, 60.0, 140.0, 28.0, 6.0, 90.0, -12.0, 130.0, 140.0, 190.0, 60.0, 120.0, 65.0, 116.0, 100.0, 110.0, 130.0, 40.0, 50.0, 60.0, 19.0, 35.0, 80.0, 70.0, 140.0, 46.0, 31.0, 141.0, 140.0, 149.0, 80.0, 90.0, 30.0, 120.0, 63.0, 110.0, 120.0, 109.0, 100.0, 49.0, 70.0, 66.0, 160.0, 30.0, 15.0, 110.0, 70.0, 160.0, 90.0, 56.0, 40.0, 110.0, 150.0, 70.0, 70.0, 70.0, 56.0, 0.0, 180.0, 90.0, 108.0, 130.0, 69.0, 40.0, 80.0, 15.0, 20.0, 60.0, 100.0, 120.0, 100.0, 30.0, 50.0, 70.0, 100.0, 70.0, 30.0, 50.0, 120.0, 145.0, 80.0, 70.0, 28.0, 40.0, 110.0, 40.0, 130.0, 30.0, 60.0, 30.0, 50.0, 40.0, 150.0, 160.0, 140.0, 200.0, 80.0, 68.0, 30.0, 130.0, 89.0, 160.0, 160.0, 130.0, 122.0, 120.0, 39.0, 150.0, 60.0, 130.0, 100.0, 220.0, 70.0, 90.0, 90.0, 60.0, 210.0, 21.0, 70.0, 110.0, 150.0, 31.0, 65.0, 90.0, 39.0, 70.0, 70.0, 130.0, 40.0, 80.0, 80.0, 94.0, 90.0, 73.0, 100.0, 140.0, 290.0, 116.0, 109.0, 110.0, 110.0, 190.0, 60.0, 90.0, 90.0, 99.0, 70.0, 180.0, 210.0, 60.0, 60.0, 70.0, 120.0, 140.0, 70.0, 160.0, 34.0, 50.0, 60.0, 164.0, 90.0, 70.0, 108.0, 60.0, 100.0, 80.0, 200.0, 150.0, 90.0, 90.0, 50.0, 28.0, 160.0, 70.0, 45.0, 98.0, 86.0, 110.0, 110.0, 210.0, 100.0, 120.0, 90.0, 66.0, 10.0, 60.0, 74.0, 30.0, 250.0, 50.0, 50.0, 35.0, 100.0, 80.0, 110.0, 240.0, 80.0, 140.0, 140.0, 190.0, 90.0, 110.0, 20.0, 30.0, 20.0, 40.0, 58.0, 50.0, 80.0, 30.0, 50.0, 20.0, 40.0, 50.0, 90.0, 70.0, 108.0, 107.0, 40.0, 80.0, 120.0, 30.0, 109.0, 117.0, 50.0, 16.0, 56.0, 90.0, 160.0, 14.0, 67.0, 100.0, 200.0, 60.0, 100.0, 50.0, 20.0, 40.0, 80.0, 90.0, 50.0, 50.0, 60.0, 120.0, 90.0, 60.0, 67.0, 100.0, 120.0, 100.0, 10.0, 110.0, 50.0, 115.0, 210.0, 180.0, 140.0, 70.0, 90.0, 70.0, 180.0, 108.0, 54.0, 140.0, 120.0, 50.0, 73.0, 220.0, 60.0, -30.0, 70.0, 100.0, 70.0, 69.0, 130.0, 110.0, 110.0, 60.0, 150.0, 110.0, 90.0, 120.0, 35.0, -15.0, 60.0, 130.0, 140.0, 160.0, 30.0, 50.0, 40.0, 30.0, 100.0, 90.0, 110.0, 129.0, 110.0, 110.0, 120.0, 140.0, 80.0, 80.0, 20.0, 40.0, 64.0, 68.0, 80.0, 0.0, 53.0, 30.0, 100.0, 40.0, 50.0, 130.0, 172.0, 114.0, 22.0, 90.0, 120.0, 120.0, 150.0, 210.0, 120.0, 47.0, 100.0, 140.0, 80.0, -19.0, 66.0, 140.0, 100.0, 29.0, 210.0, -1.0, 160.0, 90.0, 90.0, 81.0, 60.0, 100.0, 120.0, 142.0, 100.0, 60.0, 50.0, 110.0, 110.0, 90.0, 125.0, 180.0, 90.0, 150.0, 66.0, 100.0, 130.0, 202.0, 120.0, 122.0, 200.0, 80.0, 119.0, 62.0, 60.0, 60.0, 38.0, 200.0, 110.0, 260.0, 60.0, 80.0, 150.0, 108.0, 30.0, 40.0, 100.0, 68.0, 70.0, 70.0, 210.0, 90.0, 80.0, 90.0, 60.0, 100.0, 60.0, 80.0, 100.0, 100.0, 90.0, 70.0, 30.0, 100.0, 140.0, 50.0, 100.0, 70.0, 80.0, 80.0, 70.0, 80.0, 90.0, 50.0, 60.0, 20.0, 30.0, 90.0, 50.0, 60.0, 60.0, 50.0, 80.0, 110.0, 137.0, 150.0, 38.0, 220.0, 100.0, 97.0, 100.0, 80.0, 90.0, 148.0, 5.0, 80.0, 54.0, 50.0, 100.0, 34.0, 110.0, 160.0, 90.0, 220.0, 182.0, 130.0, 42.0, 100.0, 100.0, 100.0, 90.0, 89.0, 80.0, 90.0, 2.0, 220.0, 42.0, 84.0, 70.0, 10.0, 140.0, 50.0, 99.0, 50.0, 100.0, 150.0, 150.0, 90.0, 100.0, 140.0, 130.0, 90.0, 70.0, 80.0, 130.0, 90.0, 130.0, 177.0, 40.0, 160.0, 180.0, 260.0, 39.0, 140.0, 13.0, 98.0, 180.0, 95.0, 116.0, 88.0, 50.0, 90.0, 120.0, 140.0, 140.0, 150.0, 100.0, 89.0, 220.0, 40.0, 100.0, 80.0, 90.0, 130.0, 15.0, 36.0, 110.0, 90.0, 90.0, 30.0, 70.0, 190.0, 70.0, 45.0, 30.0, 50.0, 140.0, 90.0, 160.0, 1.0, -12.0, 120.0, 120.0, -35.0, 140.0, 110.0, 240.0, 140.0, 50.0, 110.0, 100.0, 120.0, 70.0, 90.0, 90.0, 120.0, 200.0, 60.0, 90.0, 60.0, 15.0, 50.0, 75.0, 140.0, 110.0, 90.0, 50.0, 40.0, 267.0, 30.0, 50.0, 97.0, 80.0, 140.0, 210.0, 110.0, 110.0, 120.0, 140.0, 180.0, 200.0, 130.0, 140.0, 50.0, 120.0, 120.0, 30.0, 90.0, 106.0, 49.0, 40.0, 213.0, 50.0, 70.0, 70.0, 150.0, 50.0, 170.0, 26.0, 70.0, 157.0, 30.0, 70.0, 110.0, 50.0, 100.0, 60.0, 20.0, 50.0, 50.0, 80.0, 200.0, 110.0, 110.0, 60.0, 200.0, 200.0, 150.0, 134.0, 125.0, 90.0, 60.0, 40.0, 110.0, 70.0, 70.0, 110.0, 80.0, 35.0, 130.0, 90.0, 64.0, 70.0, 180.0, 100.0, 66.0, 0.0, 67.0, 60.0, 40.0, 70.0, 70.0, 56.0, 66.0, 120.0, 160.0, 170.0, 150.0, 130.0, 140.0, 90.0, 70.0, 110.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7893047162939724, "mean_inference_ms": 1.8032101320273954, "mean_action_processing_ms": 0.5366359216950226, "mean_env_wait_ms": 1.21794502499264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011658191680908203, "StateBufferConnector_ms": 0.008744478225708008, "ViewRequirementAgentConnector_ms": 0.3570394515991211}, "num_episodes": 18, "episode_return_max": 1782.0, "episode_return_min": 398.0, "episode_return_mean": 954.13}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.65914540615294, "num_env_steps_trained_throughput_per_sec": 20.65914540615294, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 3160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3160000, "timers": {"training_iteration_time_ms": 193337.188, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193337.144, "sample_time_ms": 2245.777, "learn_time_ms": 191072.487, "learn_throughput": 20.934, "synch_weights_time_ms": 10.888}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "done": false, "training_iteration": 79, "trial_id": "1841f_00000", "date": "2024-08-08_03-57-49", "timestamp": 1723103869, "time_this_iter_s": 193.62762904167175, "time_total_s": 16653.647280216217, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33723a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16653.647280216217, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 17.395620437956207, "ram_util_percent": 75.87408759124088}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.637427438949498, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.478635110083225, "policy_loss": -0.014150715876307191, "vf_loss": 8.491298723982545, "vf_explained_var": -0.004538377259359065, "kl": 0.007435496549603129, "entropy": 0.5319329651431661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 746505.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 1782.0, "episode_reward_min": 398.0, "episode_reward_mean": 957.04, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -35.0}, "policy_reward_max": {"policy_0": 432.0}, "policy_reward_mean": {"policy_0": 95.704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [928.0, 840.0, 840.0, 902.0, 890.0, 1782.0, 1027.0, 949.0, 1237.0, 1131.0, 851.0, 960.0, 840.0, 678.0, 1106.0, 885.0, 892.0, 725.0, 967.0, 837.0, 841.0, 924.0, 634.0, 785.0, 558.0, 1207.0, 1231.0, 902.0, 758.0, 1328.0, 989.0, 958.0, 956.0, 1109.0, 715.0, 1280.0, 398.0, 735.0, 779.0, 740.0, 837.0, 1213.0, 857.0, 1019.0, 660.0, 1069.0, 495.0, 1178.0, 803.0, 1052.0, 1065.0, 1201.0, 1126.0, 848.0, 790.0, 810.0, 610.0, 1160.0, 903.0, 1003.0, 767.0, 1100.0, 1346.0, 990.0, 1139.0, 746.0, 664.0, 1170.0, 900.0, 954.0, 1390.0, 888.0, 903.0, 830.0, 1169.0, 899.0, 595.0, 1230.0, 934.0, 961.0, 1160.0, 1059.0, 1035.0, 1060.0, 800.0, 1154.0, 1036.0, 1440.0, 1043.0, 1049.0, 1530.0, 826.0, 981.0, 1017.0, 952.0, 848.0, 1091.0, 825.0, 726.0, 704.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 90.0, 90.0, 130.0, 120.0, 110.0, -22.0, 120.0, 150.0, 130.0, 70.0, 80.0, 70.0, 70.0, 80.0, 80.0, 100.0, 140.0, 90.0, 60.0, 100.0, 160.0, 90.0, 130.0, 40.0, 50.0, 100.0, 20.0, 60.0, 90.0, 130.0, 60.0, 70.0, 130.0, 90.0, 44.0, 168.0, 70.0, 60.0, 80.0, 120.0, 68.0, 56.0, 70.0, 110.0, 120.0, 50.0, 150.0, 119.0, 27.0, 160.0, 140.0, 180.0, 140.0, 150.0, 432.0, 130.0, 90.0, 200.0, 160.0, 70.0, 130.0, 80.0, 110.0, 190.0, 59.0, 80.0, 128.0, 70.0, 110.0, 94.0, 130.0, 150.0, 150.0, 15.0, 80.0, 120.0, 80.0, 80.0, 50.0, 100.0, 110.0, 90.0, 130.0, 130.0, 220.0, 90.0, 180.0, 89.0, 98.0, 50.0, 210.0, 174.0, 95.0, 100.0, 110.0, 134.0, 19.0, 109.0, 130.0, 130.0, 147.0, 146.0, 79.0, 38.0, 28.0, 60.0, 60.0, 29.0, 134.0, 80.0, 230.0, 80.0, 80.0, 90.0, 50.0, 70.0, 130.0, 70.0, 80.0, 100.0, 60.0, 90.0, 90.0, 90.0, 50.0, 50.0, 80.0, 80.0, 150.0, 60.0, 60.0, 100.0, 70.0, 113.0, 40.0, 133.0, 67.0, 20.0, 15.0, 38.0, 180.0, 160.0, 80.0, 120.0, 90.0, 103.0, 35.0, 140.0, 160.0, 10.0, 125.0, 150.0, 90.0, 50.0, 190.0, 80.0, 50.0, 80.0, 60.0, 140.0, 28.0, 6.0, 90.0, -12.0, 130.0, 140.0, 190.0, 60.0, 120.0, 65.0, 116.0, 100.0, 110.0, 130.0, 40.0, 50.0, 60.0, 19.0, 35.0, 80.0, 70.0, 140.0, 46.0, 31.0, 141.0, 140.0, 149.0, 80.0, 90.0, 30.0, 120.0, 63.0, 110.0, 120.0, 109.0, 100.0, 49.0, 70.0, 66.0, 160.0, 30.0, 15.0, 110.0, 70.0, 160.0, 90.0, 56.0, 40.0, 110.0, 150.0, 70.0, 70.0, 70.0, 56.0, 0.0, 180.0, 90.0, 108.0, 130.0, 69.0, 40.0, 80.0, 15.0, 20.0, 60.0, 100.0, 120.0, 100.0, 30.0, 50.0, 70.0, 100.0, 70.0, 30.0, 50.0, 120.0, 145.0, 80.0, 70.0, 28.0, 40.0, 110.0, 40.0, 130.0, 30.0, 60.0, 30.0, 50.0, 40.0, 150.0, 160.0, 140.0, 200.0, 80.0, 68.0, 30.0, 130.0, 89.0, 160.0, 160.0, 130.0, 122.0, 120.0, 39.0, 150.0, 60.0, 130.0, 100.0, 220.0, 70.0, 90.0, 90.0, 60.0, 210.0, 21.0, 70.0, 110.0, 150.0, 31.0, 65.0, 90.0, 39.0, 70.0, 70.0, 130.0, 40.0, 80.0, 80.0, 94.0, 90.0, 73.0, 100.0, 140.0, 290.0, 116.0, 109.0, 110.0, 110.0, 190.0, 60.0, 90.0, 90.0, 99.0, 70.0, 180.0, 210.0, 60.0, 60.0, 70.0, 120.0, 140.0, 70.0, 160.0, 34.0, 50.0, 60.0, 164.0, 90.0, 70.0, 108.0, 60.0, 100.0, 80.0, 200.0, 150.0, 90.0, 90.0, 50.0, 28.0, 160.0, 70.0, 45.0, 98.0, 86.0, 110.0, 110.0, 210.0, 100.0, 120.0, 90.0, 66.0, 10.0, 60.0, 74.0, 30.0, 250.0, 50.0, 50.0, 35.0, 100.0, 80.0, 110.0, 240.0, 80.0, 140.0, 140.0, 190.0, 90.0, 110.0, 20.0, 30.0, 20.0, 40.0, 58.0, 50.0, 80.0, 30.0, 50.0, 20.0, 40.0, 50.0, 90.0, 70.0, 108.0, 107.0, 40.0, 80.0, 120.0, 30.0, 109.0, 117.0, 50.0, 16.0, 56.0, 90.0, 160.0, 14.0, 67.0, 100.0, 200.0, 60.0, 100.0, 50.0, 20.0, 40.0, 80.0, 90.0, 50.0, 50.0, 60.0, 120.0, 90.0, 60.0, 67.0, 100.0, 120.0, 100.0, 10.0, 110.0, 50.0, 115.0, 210.0, 180.0, 140.0, 70.0, 90.0, 70.0, 180.0, 108.0, 54.0, 140.0, 120.0, 50.0, 73.0, 220.0, 60.0, -30.0, 70.0, 100.0, 70.0, 69.0, 130.0, 110.0, 110.0, 60.0, 150.0, 110.0, 90.0, 120.0, 35.0, -15.0, 60.0, 130.0, 140.0, 160.0, 30.0, 50.0, 40.0, 30.0, 100.0, 90.0, 110.0, 129.0, 110.0, 110.0, 120.0, 140.0, 80.0, 80.0, 20.0, 40.0, 64.0, 68.0, 80.0, 0.0, 53.0, 30.0, 100.0, 40.0, 50.0, 130.0, 172.0, 114.0, 22.0, 90.0, 120.0, 120.0, 150.0, 210.0, 120.0, 47.0, 100.0, 140.0, 80.0, -19.0, 66.0, 140.0, 100.0, 29.0, 210.0, -1.0, 160.0, 90.0, 90.0, 81.0, 60.0, 100.0, 120.0, 142.0, 100.0, 60.0, 50.0, 110.0, 110.0, 90.0, 125.0, 180.0, 90.0, 150.0, 66.0, 100.0, 130.0, 202.0, 120.0, 122.0, 200.0, 80.0, 119.0, 62.0, 60.0, 60.0, 38.0, 200.0, 110.0, 260.0, 60.0, 80.0, 150.0, 108.0, 30.0, 40.0, 100.0, 68.0, 70.0, 70.0, 210.0, 90.0, 80.0, 90.0, 60.0, 100.0, 60.0, 80.0, 100.0, 100.0, 90.0, 70.0, 30.0, 100.0, 140.0, 50.0, 100.0, 70.0, 80.0, 80.0, 70.0, 80.0, 90.0, 50.0, 60.0, 20.0, 30.0, 90.0, 50.0, 60.0, 60.0, 50.0, 80.0, 110.0, 137.0, 150.0, 38.0, 220.0, 100.0, 97.0, 100.0, 80.0, 90.0, 148.0, 5.0, 80.0, 54.0, 50.0, 100.0, 34.0, 110.0, 160.0, 90.0, 220.0, 182.0, 130.0, 42.0, 100.0, 100.0, 100.0, 90.0, 89.0, 80.0, 90.0, 2.0, 220.0, 42.0, 84.0, 70.0, 10.0, 140.0, 50.0, 99.0, 50.0, 100.0, 150.0, 150.0, 90.0, 100.0, 140.0, 130.0, 90.0, 70.0, 80.0, 130.0, 90.0, 130.0, 177.0, 40.0, 160.0, 180.0, 260.0, 39.0, 140.0, 13.0, 98.0, 180.0, 95.0, 116.0, 88.0, 50.0, 90.0, 120.0, 140.0, 140.0, 150.0, 100.0, 89.0, 220.0, 40.0, 100.0, 80.0, 90.0, 130.0, 15.0, 36.0, 110.0, 90.0, 90.0, 30.0, 70.0, 190.0, 70.0, 45.0, 30.0, 50.0, 140.0, 90.0, 160.0, 1.0, -12.0, 120.0, 120.0, -35.0, 140.0, 110.0, 240.0, 140.0, 50.0, 110.0, 100.0, 120.0, 70.0, 90.0, 90.0, 120.0, 200.0, 60.0, 90.0, 60.0, 15.0, 50.0, 75.0, 140.0, 110.0, 90.0, 50.0, 40.0, 267.0, 30.0, 50.0, 97.0, 80.0, 140.0, 210.0, 110.0, 110.0, 120.0, 140.0, 180.0, 200.0, 130.0, 140.0, 50.0, 120.0, 120.0, 30.0, 90.0, 106.0, 49.0, 40.0, 213.0, 50.0, 70.0, 70.0, 150.0, 50.0, 170.0, 26.0, 70.0, 157.0, 30.0, 70.0, 110.0, 50.0, 100.0, 60.0, 20.0, 50.0, 50.0, 80.0, 200.0, 110.0, 110.0, 60.0, 200.0, 200.0, 150.0, 134.0, 125.0, 90.0, 60.0, 40.0, 110.0, 70.0, 70.0, 110.0, 80.0, 35.0, 130.0, 90.0, 64.0, 70.0, 180.0, 100.0, 66.0, 0.0, 67.0, 60.0, 40.0, 70.0, 70.0, 56.0, 66.0, 120.0, 160.0, 170.0, 150.0, 130.0, 140.0, 90.0, 70.0, 110.0, 90.0, 60.0, 90.0, 120.0, 110.0, 40.0, 70.0, 44.0, 170.0, 130.0, 100.0, 110.0, 26.0, 120.0, 210.0, 60.0, 190.0, 80.0, 50.0, 45.0, 70.0, 60.0, 90.0, 110.0, 110.0, 80.0, 130.0, 300.0, 80.0, 100.0, 100.0, 101.0, 110.0, 160.0, 60.0, 56.0, 57.0, 125.0, 200.0, 100.0, 90.0, 60.0, 180.0, 90.0, 170.0, 120.0, 81.0, 40.0, 40.0, 134.0, 120.0, 60.0, 230.0, 141.0, 110.0, 140.0, 50.0, 100.0, 80.0, 10.0, 139.0, 60.0, 100.0, 40.0, 70.0, 70.0, 180.0, 30.0, 50.0, 100.0, 100.0, 100.0, 130.0, 160.0, 230.0, 50.0, 30.0, 120.0, 138.0, 110.0, 86.0, 35.0, 160.0, 90.0, 120.0, 180.0, 69.0, 150.0, 70.0, 72.0, 90.0, 70.0, 90.0, 190.0, 140.0, 170.0, 210.0, 110.0, 130.0, 60.0, 270.0, 80.0, 170.0, 100.0, 51.0, 107.0, 100.0, 180.0, 85.0, 110.0, 60.0, 109.0, 90.0, 30.0, 160.0, 100.0, 90.0, 110.0, 160.0, 110.0, 90.0, 190.0, 170.0, 110.0, 140.0, 260.0, 110.0, 90.0, 180.0, 190.0, 90.0, 26.0, 130.0, 70.0, 50.0, 150.0, 150.0, 80.0, 50.0, 80.0, 40.0, 160.0, 45.0, 129.0, 99.0, 140.0, 70.0, 80.0, 74.0, 134.0, 50.0, 42.0, 55.0, 90.0, 200.0, 60.0, 130.0, 150.0, 110.0, 70.0, 110.0, 70.0, 160.0, 110.0, 130.0, 72.0, 100.0, 40.0, 150.0, 50.0, 70.0, 30.0, 90.0, 80.0, 70.0, 91.0, 130.0, 17.0, 140.0, 100.0, 100.0, 50.0, 180.0, 71.0, 80.0, 110.0, 120.0, 70.0, 140.0, 180.0, 90.0, 85.0, 70.0, 110.0, 70.0, 80.0, 180.0, 30.0, 60.0, 60.0, 80.0, 80.0, 90.0, 30.0, 55.0, 130.0, 89.0, 110.0, 55.0, 60.0, 27.0, 90.0, 52.0, 30.0, 82.0, 60.0, 50.0, 40.0, 160.0, 60.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7842418272123701, "mean_inference_ms": 1.797674992827786, "mean_action_processing_ms": 0.5364004327828471, "mean_env_wait_ms": 1.2142402595542838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011506319046020508, "StateBufferConnector_ms": 0.008705377578735352, "ViewRequirementAgentConnector_ms": 0.3547232151031494}, "num_episodes": 22, "episode_return_max": 1782.0, "episode_return_min": 398.0, "episode_return_mean": 957.04}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.67742019339559, "num_env_steps_trained_throughput_per_sec": 20.67742019339559, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 193392.028, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193391.983, "sample_time_ms": 2254.763, "learn_time_ms": 191118.32, "learn_throughput": 20.929, "synch_weights_time_ms": 10.93}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": false, "training_iteration": 80, "trial_id": "1841f_00000", "date": "2024-08-08_04-01-03", "timestamp": 1723104063, "time_this_iter_s": 193.45828104019165, "time_total_s": 16847.10556125641, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b24840d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16847.10556125641, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 19.37481751824818, "ram_util_percent": 76.9153284671533}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6751277484959815, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.443103408661132, "policy_loss": -0.01339139782442266, "vf_loss": 8.454921039859581, "vf_explained_var": -0.011405198160197916, "kl": 0.007868772258665557, "entropy": 0.5360857059685186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 755895.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 398.0, "episode_reward_mean": 962.01, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -35.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 96.201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [967.0, 837.0, 841.0, 924.0, 634.0, 785.0, 558.0, 1207.0, 1231.0, 902.0, 758.0, 1328.0, 989.0, 958.0, 956.0, 1109.0, 715.0, 1280.0, 398.0, 735.0, 779.0, 740.0, 837.0, 1213.0, 857.0, 1019.0, 660.0, 1069.0, 495.0, 1178.0, 803.0, 1052.0, 1065.0, 1201.0, 1126.0, 848.0, 790.0, 810.0, 610.0, 1160.0, 903.0, 1003.0, 767.0, 1100.0, 1346.0, 990.0, 1139.0, 746.0, 664.0, 1170.0, 900.0, 954.0, 1390.0, 888.0, 903.0, 830.0, 1169.0, 899.0, 595.0, 1230.0, 934.0, 961.0, 1160.0, 1059.0, 1035.0, 1060.0, 800.0, 1154.0, 1036.0, 1440.0, 1043.0, 1049.0, 1530.0, 826.0, 981.0, 1017.0, 952.0, 848.0, 1091.0, 825.0, 726.0, 704.0, 797.0, 969.0, 1348.0, 1140.0, 1070.0, 1150.0, 840.0, 860.0, 1145.0, 1022.0, 1030.0, 1159.0, 870.0, 1185.0, 730.0, 877.0, 828.0, 940.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 70.0, 140.0, 46.0, 31.0, 141.0, 140.0, 149.0, 80.0, 90.0, 30.0, 120.0, 63.0, 110.0, 120.0, 109.0, 100.0, 49.0, 70.0, 66.0, 160.0, 30.0, 15.0, 110.0, 70.0, 160.0, 90.0, 56.0, 40.0, 110.0, 150.0, 70.0, 70.0, 70.0, 56.0, 0.0, 180.0, 90.0, 108.0, 130.0, 69.0, 40.0, 80.0, 15.0, 20.0, 60.0, 100.0, 120.0, 100.0, 30.0, 50.0, 70.0, 100.0, 70.0, 30.0, 50.0, 120.0, 145.0, 80.0, 70.0, 28.0, 40.0, 110.0, 40.0, 130.0, 30.0, 60.0, 30.0, 50.0, 40.0, 150.0, 160.0, 140.0, 200.0, 80.0, 68.0, 30.0, 130.0, 89.0, 160.0, 160.0, 130.0, 122.0, 120.0, 39.0, 150.0, 60.0, 130.0, 100.0, 220.0, 70.0, 90.0, 90.0, 60.0, 210.0, 21.0, 70.0, 110.0, 150.0, 31.0, 65.0, 90.0, 39.0, 70.0, 70.0, 130.0, 40.0, 80.0, 80.0, 94.0, 90.0, 73.0, 100.0, 140.0, 290.0, 116.0, 109.0, 110.0, 110.0, 190.0, 60.0, 90.0, 90.0, 99.0, 70.0, 180.0, 210.0, 60.0, 60.0, 70.0, 120.0, 140.0, 70.0, 160.0, 34.0, 50.0, 60.0, 164.0, 90.0, 70.0, 108.0, 60.0, 100.0, 80.0, 200.0, 150.0, 90.0, 90.0, 50.0, 28.0, 160.0, 70.0, 45.0, 98.0, 86.0, 110.0, 110.0, 210.0, 100.0, 120.0, 90.0, 66.0, 10.0, 60.0, 74.0, 30.0, 250.0, 50.0, 50.0, 35.0, 100.0, 80.0, 110.0, 240.0, 80.0, 140.0, 140.0, 190.0, 90.0, 110.0, 20.0, 30.0, 20.0, 40.0, 58.0, 50.0, 80.0, 30.0, 50.0, 20.0, 40.0, 50.0, 90.0, 70.0, 108.0, 107.0, 40.0, 80.0, 120.0, 30.0, 109.0, 117.0, 50.0, 16.0, 56.0, 90.0, 160.0, 14.0, 67.0, 100.0, 200.0, 60.0, 100.0, 50.0, 20.0, 40.0, 80.0, 90.0, 50.0, 50.0, 60.0, 120.0, 90.0, 60.0, 67.0, 100.0, 120.0, 100.0, 10.0, 110.0, 50.0, 115.0, 210.0, 180.0, 140.0, 70.0, 90.0, 70.0, 180.0, 108.0, 54.0, 140.0, 120.0, 50.0, 73.0, 220.0, 60.0, -30.0, 70.0, 100.0, 70.0, 69.0, 130.0, 110.0, 110.0, 60.0, 150.0, 110.0, 90.0, 120.0, 35.0, -15.0, 60.0, 130.0, 140.0, 160.0, 30.0, 50.0, 40.0, 30.0, 100.0, 90.0, 110.0, 129.0, 110.0, 110.0, 120.0, 140.0, 80.0, 80.0, 20.0, 40.0, 64.0, 68.0, 80.0, 0.0, 53.0, 30.0, 100.0, 40.0, 50.0, 130.0, 172.0, 114.0, 22.0, 90.0, 120.0, 120.0, 150.0, 210.0, 120.0, 47.0, 100.0, 140.0, 80.0, -19.0, 66.0, 140.0, 100.0, 29.0, 210.0, -1.0, 160.0, 90.0, 90.0, 81.0, 60.0, 100.0, 120.0, 142.0, 100.0, 60.0, 50.0, 110.0, 110.0, 90.0, 125.0, 180.0, 90.0, 150.0, 66.0, 100.0, 130.0, 202.0, 120.0, 122.0, 200.0, 80.0, 119.0, 62.0, 60.0, 60.0, 38.0, 200.0, 110.0, 260.0, 60.0, 80.0, 150.0, 108.0, 30.0, 40.0, 100.0, 68.0, 70.0, 70.0, 210.0, 90.0, 80.0, 90.0, 60.0, 100.0, 60.0, 80.0, 100.0, 100.0, 90.0, 70.0, 30.0, 100.0, 140.0, 50.0, 100.0, 70.0, 80.0, 80.0, 70.0, 80.0, 90.0, 50.0, 60.0, 20.0, 30.0, 90.0, 50.0, 60.0, 60.0, 50.0, 80.0, 110.0, 137.0, 150.0, 38.0, 220.0, 100.0, 97.0, 100.0, 80.0, 90.0, 148.0, 5.0, 80.0, 54.0, 50.0, 100.0, 34.0, 110.0, 160.0, 90.0, 220.0, 182.0, 130.0, 42.0, 100.0, 100.0, 100.0, 90.0, 89.0, 80.0, 90.0, 2.0, 220.0, 42.0, 84.0, 70.0, 10.0, 140.0, 50.0, 99.0, 50.0, 100.0, 150.0, 150.0, 90.0, 100.0, 140.0, 130.0, 90.0, 70.0, 80.0, 130.0, 90.0, 130.0, 177.0, 40.0, 160.0, 180.0, 260.0, 39.0, 140.0, 13.0, 98.0, 180.0, 95.0, 116.0, 88.0, 50.0, 90.0, 120.0, 140.0, 140.0, 150.0, 100.0, 89.0, 220.0, 40.0, 100.0, 80.0, 90.0, 130.0, 15.0, 36.0, 110.0, 90.0, 90.0, 30.0, 70.0, 190.0, 70.0, 45.0, 30.0, 50.0, 140.0, 90.0, 160.0, 1.0, -12.0, 120.0, 120.0, -35.0, 140.0, 110.0, 240.0, 140.0, 50.0, 110.0, 100.0, 120.0, 70.0, 90.0, 90.0, 120.0, 200.0, 60.0, 90.0, 60.0, 15.0, 50.0, 75.0, 140.0, 110.0, 90.0, 50.0, 40.0, 267.0, 30.0, 50.0, 97.0, 80.0, 140.0, 210.0, 110.0, 110.0, 120.0, 140.0, 180.0, 200.0, 130.0, 140.0, 50.0, 120.0, 120.0, 30.0, 90.0, 106.0, 49.0, 40.0, 213.0, 50.0, 70.0, 70.0, 150.0, 50.0, 170.0, 26.0, 70.0, 157.0, 30.0, 70.0, 110.0, 50.0, 100.0, 60.0, 20.0, 50.0, 50.0, 80.0, 200.0, 110.0, 110.0, 60.0, 200.0, 200.0, 150.0, 134.0, 125.0, 90.0, 60.0, 40.0, 110.0, 70.0, 70.0, 110.0, 80.0, 35.0, 130.0, 90.0, 64.0, 70.0, 180.0, 100.0, 66.0, 0.0, 67.0, 60.0, 40.0, 70.0, 70.0, 56.0, 66.0, 120.0, 160.0, 170.0, 150.0, 130.0, 140.0, 90.0, 70.0, 110.0, 90.0, 60.0, 90.0, 120.0, 110.0, 40.0, 70.0, 44.0, 170.0, 130.0, 100.0, 110.0, 26.0, 120.0, 210.0, 60.0, 190.0, 80.0, 50.0, 45.0, 70.0, 60.0, 90.0, 110.0, 110.0, 80.0, 130.0, 300.0, 80.0, 100.0, 100.0, 101.0, 110.0, 160.0, 60.0, 56.0, 57.0, 125.0, 200.0, 100.0, 90.0, 60.0, 180.0, 90.0, 170.0, 120.0, 81.0, 40.0, 40.0, 134.0, 120.0, 60.0, 230.0, 141.0, 110.0, 140.0, 50.0, 100.0, 80.0, 10.0, 139.0, 60.0, 100.0, 40.0, 70.0, 70.0, 180.0, 30.0, 50.0, 100.0, 100.0, 100.0, 130.0, 160.0, 230.0, 50.0, 30.0, 120.0, 138.0, 110.0, 86.0, 35.0, 160.0, 90.0, 120.0, 180.0, 69.0, 150.0, 70.0, 72.0, 90.0, 70.0, 90.0, 190.0, 140.0, 170.0, 210.0, 110.0, 130.0, 60.0, 270.0, 80.0, 170.0, 100.0, 51.0, 107.0, 100.0, 180.0, 85.0, 110.0, 60.0, 109.0, 90.0, 30.0, 160.0, 100.0, 90.0, 110.0, 160.0, 110.0, 90.0, 190.0, 170.0, 110.0, 140.0, 260.0, 110.0, 90.0, 180.0, 190.0, 90.0, 26.0, 130.0, 70.0, 50.0, 150.0, 150.0, 80.0, 50.0, 80.0, 40.0, 160.0, 45.0, 129.0, 99.0, 140.0, 70.0, 80.0, 74.0, 134.0, 50.0, 42.0, 55.0, 90.0, 200.0, 60.0, 130.0, 150.0, 110.0, 70.0, 110.0, 70.0, 160.0, 110.0, 130.0, 72.0, 100.0, 40.0, 150.0, 50.0, 70.0, 30.0, 90.0, 80.0, 70.0, 91.0, 130.0, 17.0, 140.0, 100.0, 100.0, 50.0, 180.0, 71.0, 80.0, 110.0, 120.0, 70.0, 140.0, 180.0, 90.0, 85.0, 70.0, 110.0, 70.0, 80.0, 180.0, 30.0, 60.0, 60.0, 80.0, 80.0, 90.0, 30.0, 55.0, 130.0, 89.0, 110.0, 55.0, 60.0, 27.0, 90.0, 52.0, 30.0, 82.0, 60.0, 50.0, 40.0, 160.0, 60.0, 80.0, 150.0, 200.0, 30.0, 30.0, 20.0, 80.0, 77.0, 30.0, 60.0, 120.0, 90.0, 70.0, 110.0, 120.0, 110.0, 160.0, 50.0, 70.0, 99.0, 90.0, 150.0, 98.0, 110.0, 80.0, 120.0, 130.0, 110.0, 160.0, 110.0, 280.0, 180.0, 80.0, 80.0, 150.0, 140.0, 130.0, 120.0, 90.0, 60.0, 110.0, 160.0, 140.0, 160.0, 100.0, 60.0, 80.0, 90.0, 180.0, 60.0, 40.0, 90.0, 70.0, 90.0, 110.0, 60.0, 230.0, 150.0, 190.0, 100.0, 60.0, 65.0, 13.0, 180.0, 120.0, 33.0, 84.0, 90.0, 95.0, 110.0, 50.0, 110.0, 80.0, 100.0, 90.0, 80.0, 100.0, 60.0, 120.0, 50.0, 70.0, 140.0, 80.0, 85.0, 120.0, 170.0, 110.0, 50.0, 160.0, 70.0, 160.0, 80.0, 124.0, 110.0, 190.0, 90.0, 120.0, 33.0, 65.0, 100.0, 110.0, 60.0, 180.0, 40.0, 190.0, 110.0, 30.0, 100.0, 150.0, 120.0, 50.0, 80.0, 160.0, 70.0, 109.0, 160.0, 100.0, 50.0, 160.0, 100.0, 170.0, 80.0, 90.0, 140.0, 100.0, 10.0, 60.0, 120.0, 90.0, 50.0, 130.0, 130.0, 90.0, 125.0, 170.0, 110.0, 100.0, 140.0, 80.0, 120.0, 120.0, 40.0, 60.0, 80.0, 100.0, 100.0, 70.0, 60.0, 30.0, 80.0, 110.0, 65.0, 55.0, 120.0, 24.0, 67.0, 110.0, 166.0, 110.0, 100.0, 60.0, 120.0, 120.0, 150.0, 100.0, 6.0, 4.0, 140.0, 28.0, 50.0, 110.0, 70.0, 170.0, 40.0, 50.0, 40.0, 140.0, 130.0, 140.0, 70.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7802533600000559, "mean_inference_ms": 1.7930364789896907, "mean_action_processing_ms": 0.5359947476723133, "mean_env_wait_ms": 1.2112017914842519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011687517166137695, "StateBufferConnector_ms": 0.008719682693481445, "ViewRequirementAgentConnector_ms": 0.3637673854827881}, "num_episodes": 18, "episode_return_max": 1530.0, "episode_return_min": 398.0, "episode_return_mean": 962.01}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.76699824259018, "num_env_steps_trained_throughput_per_sec": 20.76699824259018, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 3240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3240000, "timers": {"training_iteration_time_ms": 193269.983, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193269.937, "sample_time_ms": 2259.111, "learn_time_ms": 190991.879, "learn_throughput": 20.943, "synch_weights_time_ms": 10.929}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "done": false, "training_iteration": 81, "trial_id": "1841f_00000", "date": "2024-08-08_04-04-15", "timestamp": 1723104255, "time_this_iter_s": 192.6251130104065, "time_total_s": 17039.730674266815, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3372670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17039.730674266815, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 17.29889705882353, "ram_util_percent": 76.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.895495177870487, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.454713562222969, "policy_loss": -0.013685209895717228, "vf_loss": 8.466909895461207, "vf_explained_var": -0.01696446244709027, "kl": 0.007444404793219332, "entropy": 0.5211611991079724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 765285.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 495.0, "episode_reward_mean": 988.07, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -35.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 98.807}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1213.0, 857.0, 1019.0, 660.0, 1069.0, 495.0, 1178.0, 803.0, 1052.0, 1065.0, 1201.0, 1126.0, 848.0, 790.0, 810.0, 610.0, 1160.0, 903.0, 1003.0, 767.0, 1100.0, 1346.0, 990.0, 1139.0, 746.0, 664.0, 1170.0, 900.0, 954.0, 1390.0, 888.0, 903.0, 830.0, 1169.0, 899.0, 595.0, 1230.0, 934.0, 961.0, 1160.0, 1059.0, 1035.0, 1060.0, 800.0, 1154.0, 1036.0, 1440.0, 1043.0, 1049.0, 1530.0, 826.0, 981.0, 1017.0, 952.0, 848.0, 1091.0, 825.0, 726.0, 704.0, 797.0, 969.0, 1348.0, 1140.0, 1070.0, 1150.0, 840.0, 860.0, 1145.0, 1022.0, 1030.0, 1159.0, 870.0, 1185.0, 730.0, 877.0, 828.0, 940.0, 869.0, 940.0, 1086.0, 820.0, 1080.0, 1025.0, 1295.0, 987.0, 861.0, 910.0, 1456.0, 1105.0, 845.0, 998.0, 1130.0, 909.0, 1050.0, 1066.0, 969.0, 830.0, 959.0, 1113.0, 771.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 115.0, 210.0, 180.0, 140.0, 70.0, 90.0, 70.0, 180.0, 108.0, 54.0, 140.0, 120.0, 50.0, 73.0, 220.0, 60.0, -30.0, 70.0, 100.0, 70.0, 69.0, 130.0, 110.0, 110.0, 60.0, 150.0, 110.0, 90.0, 120.0, 35.0, -15.0, 60.0, 130.0, 140.0, 160.0, 30.0, 50.0, 40.0, 30.0, 100.0, 90.0, 110.0, 129.0, 110.0, 110.0, 120.0, 140.0, 80.0, 80.0, 20.0, 40.0, 64.0, 68.0, 80.0, 0.0, 53.0, 30.0, 100.0, 40.0, 50.0, 130.0, 172.0, 114.0, 22.0, 90.0, 120.0, 120.0, 150.0, 210.0, 120.0, 47.0, 100.0, 140.0, 80.0, -19.0, 66.0, 140.0, 100.0, 29.0, 210.0, -1.0, 160.0, 90.0, 90.0, 81.0, 60.0, 100.0, 120.0, 142.0, 100.0, 60.0, 50.0, 110.0, 110.0, 90.0, 125.0, 180.0, 90.0, 150.0, 66.0, 100.0, 130.0, 202.0, 120.0, 122.0, 200.0, 80.0, 119.0, 62.0, 60.0, 60.0, 38.0, 200.0, 110.0, 260.0, 60.0, 80.0, 150.0, 108.0, 30.0, 40.0, 100.0, 68.0, 70.0, 70.0, 210.0, 90.0, 80.0, 90.0, 60.0, 100.0, 60.0, 80.0, 100.0, 100.0, 90.0, 70.0, 30.0, 100.0, 140.0, 50.0, 100.0, 70.0, 80.0, 80.0, 70.0, 80.0, 90.0, 50.0, 60.0, 20.0, 30.0, 90.0, 50.0, 60.0, 60.0, 50.0, 80.0, 110.0, 137.0, 150.0, 38.0, 220.0, 100.0, 97.0, 100.0, 80.0, 90.0, 148.0, 5.0, 80.0, 54.0, 50.0, 100.0, 34.0, 110.0, 160.0, 90.0, 220.0, 182.0, 130.0, 42.0, 100.0, 100.0, 100.0, 90.0, 89.0, 80.0, 90.0, 2.0, 220.0, 42.0, 84.0, 70.0, 10.0, 140.0, 50.0, 99.0, 50.0, 100.0, 150.0, 150.0, 90.0, 100.0, 140.0, 130.0, 90.0, 70.0, 80.0, 130.0, 90.0, 130.0, 177.0, 40.0, 160.0, 180.0, 260.0, 39.0, 140.0, 13.0, 98.0, 180.0, 95.0, 116.0, 88.0, 50.0, 90.0, 120.0, 140.0, 140.0, 150.0, 100.0, 89.0, 220.0, 40.0, 100.0, 80.0, 90.0, 130.0, 15.0, 36.0, 110.0, 90.0, 90.0, 30.0, 70.0, 190.0, 70.0, 45.0, 30.0, 50.0, 140.0, 90.0, 160.0, 1.0, -12.0, 120.0, 120.0, -35.0, 140.0, 110.0, 240.0, 140.0, 50.0, 110.0, 100.0, 120.0, 70.0, 90.0, 90.0, 120.0, 200.0, 60.0, 90.0, 60.0, 15.0, 50.0, 75.0, 140.0, 110.0, 90.0, 50.0, 40.0, 267.0, 30.0, 50.0, 97.0, 80.0, 140.0, 210.0, 110.0, 110.0, 120.0, 140.0, 180.0, 200.0, 130.0, 140.0, 50.0, 120.0, 120.0, 30.0, 90.0, 106.0, 49.0, 40.0, 213.0, 50.0, 70.0, 70.0, 150.0, 50.0, 170.0, 26.0, 70.0, 157.0, 30.0, 70.0, 110.0, 50.0, 100.0, 60.0, 20.0, 50.0, 50.0, 80.0, 200.0, 110.0, 110.0, 60.0, 200.0, 200.0, 150.0, 134.0, 125.0, 90.0, 60.0, 40.0, 110.0, 70.0, 70.0, 110.0, 80.0, 35.0, 130.0, 90.0, 64.0, 70.0, 180.0, 100.0, 66.0, 0.0, 67.0, 60.0, 40.0, 70.0, 70.0, 56.0, 66.0, 120.0, 160.0, 170.0, 150.0, 130.0, 140.0, 90.0, 70.0, 110.0, 90.0, 60.0, 90.0, 120.0, 110.0, 40.0, 70.0, 44.0, 170.0, 130.0, 100.0, 110.0, 26.0, 120.0, 210.0, 60.0, 190.0, 80.0, 50.0, 45.0, 70.0, 60.0, 90.0, 110.0, 110.0, 80.0, 130.0, 300.0, 80.0, 100.0, 100.0, 101.0, 110.0, 160.0, 60.0, 56.0, 57.0, 125.0, 200.0, 100.0, 90.0, 60.0, 180.0, 90.0, 170.0, 120.0, 81.0, 40.0, 40.0, 134.0, 120.0, 60.0, 230.0, 141.0, 110.0, 140.0, 50.0, 100.0, 80.0, 10.0, 139.0, 60.0, 100.0, 40.0, 70.0, 70.0, 180.0, 30.0, 50.0, 100.0, 100.0, 100.0, 130.0, 160.0, 230.0, 50.0, 30.0, 120.0, 138.0, 110.0, 86.0, 35.0, 160.0, 90.0, 120.0, 180.0, 69.0, 150.0, 70.0, 72.0, 90.0, 70.0, 90.0, 190.0, 140.0, 170.0, 210.0, 110.0, 130.0, 60.0, 270.0, 80.0, 170.0, 100.0, 51.0, 107.0, 100.0, 180.0, 85.0, 110.0, 60.0, 109.0, 90.0, 30.0, 160.0, 100.0, 90.0, 110.0, 160.0, 110.0, 90.0, 190.0, 170.0, 110.0, 140.0, 260.0, 110.0, 90.0, 180.0, 190.0, 90.0, 26.0, 130.0, 70.0, 50.0, 150.0, 150.0, 80.0, 50.0, 80.0, 40.0, 160.0, 45.0, 129.0, 99.0, 140.0, 70.0, 80.0, 74.0, 134.0, 50.0, 42.0, 55.0, 90.0, 200.0, 60.0, 130.0, 150.0, 110.0, 70.0, 110.0, 70.0, 160.0, 110.0, 130.0, 72.0, 100.0, 40.0, 150.0, 50.0, 70.0, 30.0, 90.0, 80.0, 70.0, 91.0, 130.0, 17.0, 140.0, 100.0, 100.0, 50.0, 180.0, 71.0, 80.0, 110.0, 120.0, 70.0, 140.0, 180.0, 90.0, 85.0, 70.0, 110.0, 70.0, 80.0, 180.0, 30.0, 60.0, 60.0, 80.0, 80.0, 90.0, 30.0, 55.0, 130.0, 89.0, 110.0, 55.0, 60.0, 27.0, 90.0, 52.0, 30.0, 82.0, 60.0, 50.0, 40.0, 160.0, 60.0, 80.0, 150.0, 200.0, 30.0, 30.0, 20.0, 80.0, 77.0, 30.0, 60.0, 120.0, 90.0, 70.0, 110.0, 120.0, 110.0, 160.0, 50.0, 70.0, 99.0, 90.0, 150.0, 98.0, 110.0, 80.0, 120.0, 130.0, 110.0, 160.0, 110.0, 280.0, 180.0, 80.0, 80.0, 150.0, 140.0, 130.0, 120.0, 90.0, 60.0, 110.0, 160.0, 140.0, 160.0, 100.0, 60.0, 80.0, 90.0, 180.0, 60.0, 40.0, 90.0, 70.0, 90.0, 110.0, 60.0, 230.0, 150.0, 190.0, 100.0, 60.0, 65.0, 13.0, 180.0, 120.0, 33.0, 84.0, 90.0, 95.0, 110.0, 50.0, 110.0, 80.0, 100.0, 90.0, 80.0, 100.0, 60.0, 120.0, 50.0, 70.0, 140.0, 80.0, 85.0, 120.0, 170.0, 110.0, 50.0, 160.0, 70.0, 160.0, 80.0, 124.0, 110.0, 190.0, 90.0, 120.0, 33.0, 65.0, 100.0, 110.0, 60.0, 180.0, 40.0, 190.0, 110.0, 30.0, 100.0, 150.0, 120.0, 50.0, 80.0, 160.0, 70.0, 109.0, 160.0, 100.0, 50.0, 160.0, 100.0, 170.0, 80.0, 90.0, 140.0, 100.0, 10.0, 60.0, 120.0, 90.0, 50.0, 130.0, 130.0, 90.0, 125.0, 170.0, 110.0, 100.0, 140.0, 80.0, 120.0, 120.0, 40.0, 60.0, 80.0, 100.0, 100.0, 70.0, 60.0, 30.0, 80.0, 110.0, 65.0, 55.0, 120.0, 24.0, 67.0, 110.0, 166.0, 110.0, 100.0, 60.0, 120.0, 120.0, 150.0, 100.0, 6.0, 4.0, 140.0, 28.0, 50.0, 110.0, 70.0, 170.0, 40.0, 50.0, 40.0, 140.0, 130.0, 140.0, 70.0, 90.0, 164.0, 18.0, 70.0, 40.0, 67.0, 90.0, 100.0, 90.0, 70.0, 160.0, 80.0, 50.0, 130.0, 60.0, 150.0, 70.0, 90.0, 120.0, 110.0, 80.0, 90.0, 150.0, -11.0, 140.0, 110.0, 70.0, 140.0, 200.0, 97.0, 100.0, 60.0, 80.0, 130.0, 80.0, 110.0, 50.0, 80.0, 70.0, 70.0, 90.0, 140.0, 70.0, 40.0, 150.0, 180.0, 110.0, 120.0, 120.0, 70.0, 80.0, 90.0, 160.0, 90.0, 227.0, 50.0, 120.0, 10.0, 140.0, 80.0, 58.0, 270.0, 120.0, 47.0, 70.0, 90.0, 96.0, 145.0, 130.0, 167.0, 160.0, 250.0, 110.0, 80.0, 2.0, 100.0, 90.0, 82.0, 73.0, 60.0, 140.0, 140.0, 100.0, 30.0, 40.0, 100.0, 90.0, 31.0, 110.0, 100.0, 120.0, 70.0, 46.0, 40.0, 120.0, 104.0, 170.0, 80.0, 80.0, 90.0, 110.0, 150.0, 80.0, 210.0, 160.0, 130.0, 160.0, 88.0, 130.0, 210.0, 138.0, 140.0, 64.0, 90.0, 115.0, 100.0, 190.0, 93.0, 100.0, 93.0, 120.0, 115.0, 163.0, 7.0, 60.0, 60.0, 50.0, 60.0, 200.0, 120.0, 10.0, 80.0, 80.0, 60.0, 80.0, 130.0, 150.0, 69.0, 121.0, 190.0, 38.0, 80.0, 80.0, 180.0, 100.0, 90.0, 70.0, 160.0, 100.0, 110.0, 160.0, 110.0, 100.0, 20.0, 120.0, 110.0, 69.0, 110.0, 140.0, 70.0, 60.0, 140.0, 110.0, 100.0, 170.0, 220.0, 50.0, 60.0, 140.0, 40.0, 20.0, 150.0, 60.0, 140.0, 86.0, 70.0, 90.0, 30.0, 240.0, 140.0, 60.0, 131.0, 28.0, 220.0, 70.0, 50.0, 70.0, 130.0, 50.0, 110.0, 110.0, 160.0, 110.0, 80.0, 120.0, -10.0, 77.0, 70.0, 84.0, 60.0, 79.0, 39.0, 110.0, 30.0, 180.0, 80.0, 130.0, 60.0, 30.0, 250.0, 50.0, 90.0, 230.0, 110.0, 150.0, 120.0, 20.0, 100.0, 64.0, 169.0, 60.0, 110.0, 90.0, 30.0, 40.0, 90.0, 90.0, 73.0, 50.0, 68.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7755518334405718, "mean_inference_ms": 1.787419757329588, "mean_action_processing_ms": 0.5343631347363225, "mean_env_wait_ms": 1.207405855454783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011882781982421875, "StateBufferConnector_ms": 0.008629083633422852, "ViewRequirementAgentConnector_ms": 0.36368393898010254}, "num_episodes": 23, "episode_return_max": 1530.0, "episode_return_min": 495.0, "episode_return_mean": 988.07}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.806225100733908, "num_env_steps_trained_throughput_per_sec": 20.806225100733908, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 3280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3280000, "timers": {"training_iteration_time_ms": 193189.804, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193189.758, "sample_time_ms": 2270.006, "learn_time_ms": 190900.822, "learn_throughput": 20.953, "synch_weights_time_ms": 10.807}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "done": false, "training_iteration": 82, "trial_id": "1841f_00000", "date": "2024-08-08_04-07-28", "timestamp": 1723104448, "time_this_iter_s": 192.26040482521057, "time_total_s": 17231.991079092026, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33721f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17231.991079092026, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 16.936764705882354, "ram_util_percent": 76.56654411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9780763294623176, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.495996609333352, "policy_loss": -0.014248810913408804, "vf_loss": 8.508694405347521, "vf_explained_var": -0.0037628067187227, "kl": 0.007755079350665275, "entropy": 0.5114154835954642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 774675.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 595.0, "episode_reward_mean": 1001.79, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -35.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 100.179}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1003.0, 767.0, 1100.0, 1346.0, 990.0, 1139.0, 746.0, 664.0, 1170.0, 900.0, 954.0, 1390.0, 888.0, 903.0, 830.0, 1169.0, 899.0, 595.0, 1230.0, 934.0, 961.0, 1160.0, 1059.0, 1035.0, 1060.0, 800.0, 1154.0, 1036.0, 1440.0, 1043.0, 1049.0, 1530.0, 826.0, 981.0, 1017.0, 952.0, 848.0, 1091.0, 825.0, 726.0, 704.0, 797.0, 969.0, 1348.0, 1140.0, 1070.0, 1150.0, 840.0, 860.0, 1145.0, 1022.0, 1030.0, 1159.0, 870.0, 1185.0, 730.0, 877.0, 828.0, 940.0, 869.0, 940.0, 1086.0, 820.0, 1080.0, 1025.0, 1295.0, 987.0, 861.0, 910.0, 1456.0, 1105.0, 845.0, 998.0, 1130.0, 909.0, 1050.0, 1066.0, 969.0, 830.0, 959.0, 1113.0, 771.0, 795.0, 1102.0, 894.0, 929.0, 1060.0, 964.0, 810.0, 841.0, 1333.0, 1200.0, 1309.0, 1013.0, 762.0, 1025.0, 1130.0, 1040.0, 1035.0, 989.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [182.0, 130.0, 42.0, 100.0, 100.0, 100.0, 90.0, 89.0, 80.0, 90.0, 2.0, 220.0, 42.0, 84.0, 70.0, 10.0, 140.0, 50.0, 99.0, 50.0, 100.0, 150.0, 150.0, 90.0, 100.0, 140.0, 130.0, 90.0, 70.0, 80.0, 130.0, 90.0, 130.0, 177.0, 40.0, 160.0, 180.0, 260.0, 39.0, 140.0, 13.0, 98.0, 180.0, 95.0, 116.0, 88.0, 50.0, 90.0, 120.0, 140.0, 140.0, 150.0, 100.0, 89.0, 220.0, 40.0, 100.0, 80.0, 90.0, 130.0, 15.0, 36.0, 110.0, 90.0, 90.0, 30.0, 70.0, 190.0, 70.0, 45.0, 30.0, 50.0, 140.0, 90.0, 160.0, 1.0, -12.0, 120.0, 120.0, -35.0, 140.0, 110.0, 240.0, 140.0, 50.0, 110.0, 100.0, 120.0, 70.0, 90.0, 90.0, 120.0, 200.0, 60.0, 90.0, 60.0, 15.0, 50.0, 75.0, 140.0, 110.0, 90.0, 50.0, 40.0, 267.0, 30.0, 50.0, 97.0, 80.0, 140.0, 210.0, 110.0, 110.0, 120.0, 140.0, 180.0, 200.0, 130.0, 140.0, 50.0, 120.0, 120.0, 30.0, 90.0, 106.0, 49.0, 40.0, 213.0, 50.0, 70.0, 70.0, 150.0, 50.0, 170.0, 26.0, 70.0, 157.0, 30.0, 70.0, 110.0, 50.0, 100.0, 60.0, 20.0, 50.0, 50.0, 80.0, 200.0, 110.0, 110.0, 60.0, 200.0, 200.0, 150.0, 134.0, 125.0, 90.0, 60.0, 40.0, 110.0, 70.0, 70.0, 110.0, 80.0, 35.0, 130.0, 90.0, 64.0, 70.0, 180.0, 100.0, 66.0, 0.0, 67.0, 60.0, 40.0, 70.0, 70.0, 56.0, 66.0, 120.0, 160.0, 170.0, 150.0, 130.0, 140.0, 90.0, 70.0, 110.0, 90.0, 60.0, 90.0, 120.0, 110.0, 40.0, 70.0, 44.0, 170.0, 130.0, 100.0, 110.0, 26.0, 120.0, 210.0, 60.0, 190.0, 80.0, 50.0, 45.0, 70.0, 60.0, 90.0, 110.0, 110.0, 80.0, 130.0, 300.0, 80.0, 100.0, 100.0, 101.0, 110.0, 160.0, 60.0, 56.0, 57.0, 125.0, 200.0, 100.0, 90.0, 60.0, 180.0, 90.0, 170.0, 120.0, 81.0, 40.0, 40.0, 134.0, 120.0, 60.0, 230.0, 141.0, 110.0, 140.0, 50.0, 100.0, 80.0, 10.0, 139.0, 60.0, 100.0, 40.0, 70.0, 70.0, 180.0, 30.0, 50.0, 100.0, 100.0, 100.0, 130.0, 160.0, 230.0, 50.0, 30.0, 120.0, 138.0, 110.0, 86.0, 35.0, 160.0, 90.0, 120.0, 180.0, 69.0, 150.0, 70.0, 72.0, 90.0, 70.0, 90.0, 190.0, 140.0, 170.0, 210.0, 110.0, 130.0, 60.0, 270.0, 80.0, 170.0, 100.0, 51.0, 107.0, 100.0, 180.0, 85.0, 110.0, 60.0, 109.0, 90.0, 30.0, 160.0, 100.0, 90.0, 110.0, 160.0, 110.0, 90.0, 190.0, 170.0, 110.0, 140.0, 260.0, 110.0, 90.0, 180.0, 190.0, 90.0, 26.0, 130.0, 70.0, 50.0, 150.0, 150.0, 80.0, 50.0, 80.0, 40.0, 160.0, 45.0, 129.0, 99.0, 140.0, 70.0, 80.0, 74.0, 134.0, 50.0, 42.0, 55.0, 90.0, 200.0, 60.0, 130.0, 150.0, 110.0, 70.0, 110.0, 70.0, 160.0, 110.0, 130.0, 72.0, 100.0, 40.0, 150.0, 50.0, 70.0, 30.0, 90.0, 80.0, 70.0, 91.0, 130.0, 17.0, 140.0, 100.0, 100.0, 50.0, 180.0, 71.0, 80.0, 110.0, 120.0, 70.0, 140.0, 180.0, 90.0, 85.0, 70.0, 110.0, 70.0, 80.0, 180.0, 30.0, 60.0, 60.0, 80.0, 80.0, 90.0, 30.0, 55.0, 130.0, 89.0, 110.0, 55.0, 60.0, 27.0, 90.0, 52.0, 30.0, 82.0, 60.0, 50.0, 40.0, 160.0, 60.0, 80.0, 150.0, 200.0, 30.0, 30.0, 20.0, 80.0, 77.0, 30.0, 60.0, 120.0, 90.0, 70.0, 110.0, 120.0, 110.0, 160.0, 50.0, 70.0, 99.0, 90.0, 150.0, 98.0, 110.0, 80.0, 120.0, 130.0, 110.0, 160.0, 110.0, 280.0, 180.0, 80.0, 80.0, 150.0, 140.0, 130.0, 120.0, 90.0, 60.0, 110.0, 160.0, 140.0, 160.0, 100.0, 60.0, 80.0, 90.0, 180.0, 60.0, 40.0, 90.0, 70.0, 90.0, 110.0, 60.0, 230.0, 150.0, 190.0, 100.0, 60.0, 65.0, 13.0, 180.0, 120.0, 33.0, 84.0, 90.0, 95.0, 110.0, 50.0, 110.0, 80.0, 100.0, 90.0, 80.0, 100.0, 60.0, 120.0, 50.0, 70.0, 140.0, 80.0, 85.0, 120.0, 170.0, 110.0, 50.0, 160.0, 70.0, 160.0, 80.0, 124.0, 110.0, 190.0, 90.0, 120.0, 33.0, 65.0, 100.0, 110.0, 60.0, 180.0, 40.0, 190.0, 110.0, 30.0, 100.0, 150.0, 120.0, 50.0, 80.0, 160.0, 70.0, 109.0, 160.0, 100.0, 50.0, 160.0, 100.0, 170.0, 80.0, 90.0, 140.0, 100.0, 10.0, 60.0, 120.0, 90.0, 50.0, 130.0, 130.0, 90.0, 125.0, 170.0, 110.0, 100.0, 140.0, 80.0, 120.0, 120.0, 40.0, 60.0, 80.0, 100.0, 100.0, 70.0, 60.0, 30.0, 80.0, 110.0, 65.0, 55.0, 120.0, 24.0, 67.0, 110.0, 166.0, 110.0, 100.0, 60.0, 120.0, 120.0, 150.0, 100.0, 6.0, 4.0, 140.0, 28.0, 50.0, 110.0, 70.0, 170.0, 40.0, 50.0, 40.0, 140.0, 130.0, 140.0, 70.0, 90.0, 164.0, 18.0, 70.0, 40.0, 67.0, 90.0, 100.0, 90.0, 70.0, 160.0, 80.0, 50.0, 130.0, 60.0, 150.0, 70.0, 90.0, 120.0, 110.0, 80.0, 90.0, 150.0, -11.0, 140.0, 110.0, 70.0, 140.0, 200.0, 97.0, 100.0, 60.0, 80.0, 130.0, 80.0, 110.0, 50.0, 80.0, 70.0, 70.0, 90.0, 140.0, 70.0, 40.0, 150.0, 180.0, 110.0, 120.0, 120.0, 70.0, 80.0, 90.0, 160.0, 90.0, 227.0, 50.0, 120.0, 10.0, 140.0, 80.0, 58.0, 270.0, 120.0, 47.0, 70.0, 90.0, 96.0, 145.0, 130.0, 167.0, 160.0, 250.0, 110.0, 80.0, 2.0, 100.0, 90.0, 82.0, 73.0, 60.0, 140.0, 140.0, 100.0, 30.0, 40.0, 100.0, 90.0, 31.0, 110.0, 100.0, 120.0, 70.0, 46.0, 40.0, 120.0, 104.0, 170.0, 80.0, 80.0, 90.0, 110.0, 150.0, 80.0, 210.0, 160.0, 130.0, 160.0, 88.0, 130.0, 210.0, 138.0, 140.0, 64.0, 90.0, 115.0, 100.0, 190.0, 93.0, 100.0, 93.0, 120.0, 115.0, 163.0, 7.0, 60.0, 60.0, 50.0, 60.0, 200.0, 120.0, 10.0, 80.0, 80.0, 60.0, 80.0, 130.0, 150.0, 69.0, 121.0, 190.0, 38.0, 80.0, 80.0, 180.0, 100.0, 90.0, 70.0, 160.0, 100.0, 110.0, 160.0, 110.0, 100.0, 20.0, 120.0, 110.0, 69.0, 110.0, 140.0, 70.0, 60.0, 140.0, 110.0, 100.0, 170.0, 220.0, 50.0, 60.0, 140.0, 40.0, 20.0, 150.0, 60.0, 140.0, 86.0, 70.0, 90.0, 30.0, 240.0, 140.0, 60.0, 131.0, 28.0, 220.0, 70.0, 50.0, 70.0, 130.0, 50.0, 110.0, 110.0, 160.0, 110.0, 80.0, 120.0, -10.0, 77.0, 70.0, 84.0, 60.0, 79.0, 39.0, 110.0, 30.0, 180.0, 80.0, 130.0, 60.0, 30.0, 250.0, 50.0, 90.0, 230.0, 110.0, 150.0, 120.0, 20.0, 100.0, 64.0, 169.0, 60.0, 110.0, 90.0, 30.0, 40.0, 90.0, 90.0, 73.0, 50.0, 68.0, 130.0, 48.0, 79.0, 40.0, 70.0, 58.0, 50.0, 80.0, 80.0, 130.0, 160.0, 220.0, 140.0, 63.0, 70.0, 50.0, 170.0, 100.0, 130.0, 89.0, 70.0, 105.0, 41.0, 110.0, 130.0, 80.0, 80.0, 78.0, 90.0, 90.0, 90.0, 12.0, 190.0, 70.0, 100.0, 50.0, 207.0, 120.0, 90.0, 50.0, 40.0, 110.0, 160.0, 160.0, 110.0, 120.0, 140.0, 80.0, 60.0, 30.0, 90.0, 60.0, 110.0, 123.0, 60.0, 110.0, 110.0, 140.0, 71.0, 70.0, 110.0, 110.0, 90.0, 20.0, 80.0, 130.0, 45.0, 130.0, 80.0, 45.0, 80.0, 130.0, 90.0, 100.0, 110.0, 90.0, 35.0, 6.0, 50.0, 100.0, 130.0, 100.0, 100.0, 170.0, 160.0, 110.0, 140.0, 142.0, 81.0, 180.0, 150.0, 234.0, 100.0, 79.0, 30.0, 170.0, 97.0, 140.0, 120.0, 110.0, 120.0, 140.0, 120.0, 80.0, 129.0, 110.0, 200.0, 130.0, 120.0, 130.0, 150.0, 80.0, 70.0, 100.0, 150.0, 112.0, 110.0, 137.0, 72.0, 102.0, 80.0, 106.0, 70.0, 40.0, 73.0, 75.0, 130.0, 110.0, -17.0, 45.0, 130.0, 110.0, 88.0, 200.0, 70.0, 100.0, 80.0, 87.0, 50.0, 190.0, 50.0, 90.0, 95.0, 150.0, 140.0, 75.0, 160.0, 160.0, 70.0, 90.0, 100.0, 50.0, 50.0, 40.0, 130.0, 160.0, 160.0, 140.0, 10.0, 190.0, 110.0, 170.0, 170.0, 120.0, 70.0, 45.0, 100.0, 50.0, 130.0, 100.0, 80.0, 60.0, 110.0, 60.0, 150.0, 79.0, 130.0, 120.0, 90.0, 90.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7718302711832745, "mean_inference_ms": 1.783360424122712, "mean_action_processing_ms": 0.533112305735036, "mean_env_wait_ms": 1.2045799059485385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012002944946289062, "StateBufferConnector_ms": 0.008744955062866211, "ViewRequirementAgentConnector_ms": 0.36723971366882324}, "num_episodes": 18, "episode_return_max": 1530.0, "episode_return_min": 595.0, "episode_return_mean": 1001.79}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.64517043607325, "num_env_steps_trained_throughput_per_sec": 20.64517043607325, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 3320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3320000, "timers": {"training_iteration_time_ms": 193299.103, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193299.057, "sample_time_ms": 2267.926, "learn_time_ms": 191011.85, "learn_throughput": 20.941, "synch_weights_time_ms": 11.078}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "done": false, "training_iteration": 83, "trial_id": "1841f_00000", "date": "2024-08-08_04-10-41", "timestamp": 1723104641, "time_this_iter_s": 193.7583990097046, "time_total_s": 17425.74947810173, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b3359160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17425.74947810173, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 18.04014598540146, "ram_util_percent": 76.54160583941606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8482644664847685, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.571492943494592, "policy_loss": -0.013041088875250234, "vf_loss": 8.583056343198457, "vf_explained_var": -0.006986556247400399, "kl": 0.007388417969296889, "entropy": 0.5240678719374826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 784065.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 597.0, "episode_reward_mean": 988.13, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 98.813}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1230.0, 934.0, 961.0, 1160.0, 1059.0, 1035.0, 1060.0, 800.0, 1154.0, 1036.0, 1440.0, 1043.0, 1049.0, 1530.0, 826.0, 981.0, 1017.0, 952.0, 848.0, 1091.0, 825.0, 726.0, 704.0, 797.0, 969.0, 1348.0, 1140.0, 1070.0, 1150.0, 840.0, 860.0, 1145.0, 1022.0, 1030.0, 1159.0, 870.0, 1185.0, 730.0, 877.0, 828.0, 940.0, 869.0, 940.0, 1086.0, 820.0, 1080.0, 1025.0, 1295.0, 987.0, 861.0, 910.0, 1456.0, 1105.0, 845.0, 998.0, 1130.0, 909.0, 1050.0, 1066.0, 969.0, 830.0, 959.0, 1113.0, 771.0, 795.0, 1102.0, 894.0, 929.0, 1060.0, 964.0, 810.0, 841.0, 1333.0, 1200.0, 1309.0, 1013.0, 762.0, 1025.0, 1130.0, 1040.0, 1035.0, 989.0, 605.0, 1002.0, 988.0, 783.0, 782.0, 870.0, 907.0, 743.0, 884.0, 1138.0, 920.0, 1053.0, 1252.0, 734.0, 597.0, 956.0, 822.0, 1051.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 160.0, 170.0, 150.0, 130.0, 140.0, 90.0, 70.0, 110.0, 90.0, 60.0, 90.0, 120.0, 110.0, 40.0, 70.0, 44.0, 170.0, 130.0, 100.0, 110.0, 26.0, 120.0, 210.0, 60.0, 190.0, 80.0, 50.0, 45.0, 70.0, 60.0, 90.0, 110.0, 110.0, 80.0, 130.0, 300.0, 80.0, 100.0, 100.0, 101.0, 110.0, 160.0, 60.0, 56.0, 57.0, 125.0, 200.0, 100.0, 90.0, 60.0, 180.0, 90.0, 170.0, 120.0, 81.0, 40.0, 40.0, 134.0, 120.0, 60.0, 230.0, 141.0, 110.0, 140.0, 50.0, 100.0, 80.0, 10.0, 139.0, 60.0, 100.0, 40.0, 70.0, 70.0, 180.0, 30.0, 50.0, 100.0, 100.0, 100.0, 130.0, 160.0, 230.0, 50.0, 30.0, 120.0, 138.0, 110.0, 86.0, 35.0, 160.0, 90.0, 120.0, 180.0, 69.0, 150.0, 70.0, 72.0, 90.0, 70.0, 90.0, 190.0, 140.0, 170.0, 210.0, 110.0, 130.0, 60.0, 270.0, 80.0, 170.0, 100.0, 51.0, 107.0, 100.0, 180.0, 85.0, 110.0, 60.0, 109.0, 90.0, 30.0, 160.0, 100.0, 90.0, 110.0, 160.0, 110.0, 90.0, 190.0, 170.0, 110.0, 140.0, 260.0, 110.0, 90.0, 180.0, 190.0, 90.0, 26.0, 130.0, 70.0, 50.0, 150.0, 150.0, 80.0, 50.0, 80.0, 40.0, 160.0, 45.0, 129.0, 99.0, 140.0, 70.0, 80.0, 74.0, 134.0, 50.0, 42.0, 55.0, 90.0, 200.0, 60.0, 130.0, 150.0, 110.0, 70.0, 110.0, 70.0, 160.0, 110.0, 130.0, 72.0, 100.0, 40.0, 150.0, 50.0, 70.0, 30.0, 90.0, 80.0, 70.0, 91.0, 130.0, 17.0, 140.0, 100.0, 100.0, 50.0, 180.0, 71.0, 80.0, 110.0, 120.0, 70.0, 140.0, 180.0, 90.0, 85.0, 70.0, 110.0, 70.0, 80.0, 180.0, 30.0, 60.0, 60.0, 80.0, 80.0, 90.0, 30.0, 55.0, 130.0, 89.0, 110.0, 55.0, 60.0, 27.0, 90.0, 52.0, 30.0, 82.0, 60.0, 50.0, 40.0, 160.0, 60.0, 80.0, 150.0, 200.0, 30.0, 30.0, 20.0, 80.0, 77.0, 30.0, 60.0, 120.0, 90.0, 70.0, 110.0, 120.0, 110.0, 160.0, 50.0, 70.0, 99.0, 90.0, 150.0, 98.0, 110.0, 80.0, 120.0, 130.0, 110.0, 160.0, 110.0, 280.0, 180.0, 80.0, 80.0, 150.0, 140.0, 130.0, 120.0, 90.0, 60.0, 110.0, 160.0, 140.0, 160.0, 100.0, 60.0, 80.0, 90.0, 180.0, 60.0, 40.0, 90.0, 70.0, 90.0, 110.0, 60.0, 230.0, 150.0, 190.0, 100.0, 60.0, 65.0, 13.0, 180.0, 120.0, 33.0, 84.0, 90.0, 95.0, 110.0, 50.0, 110.0, 80.0, 100.0, 90.0, 80.0, 100.0, 60.0, 120.0, 50.0, 70.0, 140.0, 80.0, 85.0, 120.0, 170.0, 110.0, 50.0, 160.0, 70.0, 160.0, 80.0, 124.0, 110.0, 190.0, 90.0, 120.0, 33.0, 65.0, 100.0, 110.0, 60.0, 180.0, 40.0, 190.0, 110.0, 30.0, 100.0, 150.0, 120.0, 50.0, 80.0, 160.0, 70.0, 109.0, 160.0, 100.0, 50.0, 160.0, 100.0, 170.0, 80.0, 90.0, 140.0, 100.0, 10.0, 60.0, 120.0, 90.0, 50.0, 130.0, 130.0, 90.0, 125.0, 170.0, 110.0, 100.0, 140.0, 80.0, 120.0, 120.0, 40.0, 60.0, 80.0, 100.0, 100.0, 70.0, 60.0, 30.0, 80.0, 110.0, 65.0, 55.0, 120.0, 24.0, 67.0, 110.0, 166.0, 110.0, 100.0, 60.0, 120.0, 120.0, 150.0, 100.0, 6.0, 4.0, 140.0, 28.0, 50.0, 110.0, 70.0, 170.0, 40.0, 50.0, 40.0, 140.0, 130.0, 140.0, 70.0, 90.0, 164.0, 18.0, 70.0, 40.0, 67.0, 90.0, 100.0, 90.0, 70.0, 160.0, 80.0, 50.0, 130.0, 60.0, 150.0, 70.0, 90.0, 120.0, 110.0, 80.0, 90.0, 150.0, -11.0, 140.0, 110.0, 70.0, 140.0, 200.0, 97.0, 100.0, 60.0, 80.0, 130.0, 80.0, 110.0, 50.0, 80.0, 70.0, 70.0, 90.0, 140.0, 70.0, 40.0, 150.0, 180.0, 110.0, 120.0, 120.0, 70.0, 80.0, 90.0, 160.0, 90.0, 227.0, 50.0, 120.0, 10.0, 140.0, 80.0, 58.0, 270.0, 120.0, 47.0, 70.0, 90.0, 96.0, 145.0, 130.0, 167.0, 160.0, 250.0, 110.0, 80.0, 2.0, 100.0, 90.0, 82.0, 73.0, 60.0, 140.0, 140.0, 100.0, 30.0, 40.0, 100.0, 90.0, 31.0, 110.0, 100.0, 120.0, 70.0, 46.0, 40.0, 120.0, 104.0, 170.0, 80.0, 80.0, 90.0, 110.0, 150.0, 80.0, 210.0, 160.0, 130.0, 160.0, 88.0, 130.0, 210.0, 138.0, 140.0, 64.0, 90.0, 115.0, 100.0, 190.0, 93.0, 100.0, 93.0, 120.0, 115.0, 163.0, 7.0, 60.0, 60.0, 50.0, 60.0, 200.0, 120.0, 10.0, 80.0, 80.0, 60.0, 80.0, 130.0, 150.0, 69.0, 121.0, 190.0, 38.0, 80.0, 80.0, 180.0, 100.0, 90.0, 70.0, 160.0, 100.0, 110.0, 160.0, 110.0, 100.0, 20.0, 120.0, 110.0, 69.0, 110.0, 140.0, 70.0, 60.0, 140.0, 110.0, 100.0, 170.0, 220.0, 50.0, 60.0, 140.0, 40.0, 20.0, 150.0, 60.0, 140.0, 86.0, 70.0, 90.0, 30.0, 240.0, 140.0, 60.0, 131.0, 28.0, 220.0, 70.0, 50.0, 70.0, 130.0, 50.0, 110.0, 110.0, 160.0, 110.0, 80.0, 120.0, -10.0, 77.0, 70.0, 84.0, 60.0, 79.0, 39.0, 110.0, 30.0, 180.0, 80.0, 130.0, 60.0, 30.0, 250.0, 50.0, 90.0, 230.0, 110.0, 150.0, 120.0, 20.0, 100.0, 64.0, 169.0, 60.0, 110.0, 90.0, 30.0, 40.0, 90.0, 90.0, 73.0, 50.0, 68.0, 130.0, 48.0, 79.0, 40.0, 70.0, 58.0, 50.0, 80.0, 80.0, 130.0, 160.0, 220.0, 140.0, 63.0, 70.0, 50.0, 170.0, 100.0, 130.0, 89.0, 70.0, 105.0, 41.0, 110.0, 130.0, 80.0, 80.0, 78.0, 90.0, 90.0, 90.0, 12.0, 190.0, 70.0, 100.0, 50.0, 207.0, 120.0, 90.0, 50.0, 40.0, 110.0, 160.0, 160.0, 110.0, 120.0, 140.0, 80.0, 60.0, 30.0, 90.0, 60.0, 110.0, 123.0, 60.0, 110.0, 110.0, 140.0, 71.0, 70.0, 110.0, 110.0, 90.0, 20.0, 80.0, 130.0, 45.0, 130.0, 80.0, 45.0, 80.0, 130.0, 90.0, 100.0, 110.0, 90.0, 35.0, 6.0, 50.0, 100.0, 130.0, 100.0, 100.0, 170.0, 160.0, 110.0, 140.0, 142.0, 81.0, 180.0, 150.0, 234.0, 100.0, 79.0, 30.0, 170.0, 97.0, 140.0, 120.0, 110.0, 120.0, 140.0, 120.0, 80.0, 129.0, 110.0, 200.0, 130.0, 120.0, 130.0, 150.0, 80.0, 70.0, 100.0, 150.0, 112.0, 110.0, 137.0, 72.0, 102.0, 80.0, 106.0, 70.0, 40.0, 73.0, 75.0, 130.0, 110.0, -17.0, 45.0, 130.0, 110.0, 88.0, 200.0, 70.0, 100.0, 80.0, 87.0, 50.0, 190.0, 50.0, 90.0, 95.0, 150.0, 140.0, 75.0, 160.0, 160.0, 70.0, 90.0, 100.0, 50.0, 50.0, 40.0, 130.0, 160.0, 160.0, 140.0, 10.0, 190.0, 110.0, 170.0, 170.0, 120.0, 70.0, 45.0, 100.0, 50.0, 130.0, 100.0, 80.0, 60.0, 110.0, 60.0, 150.0, 79.0, 130.0, 120.0, 90.0, 90.0, 100.0, 40.0, 80.0, 100.0, 20.0, 30.0, 130.0, 50.0, 40.0, 70.0, 45.0, 130.0, 250.0, 130.0, 39.0, -3.0, 90.0, 110.0, 110.0, 140.0, 6.0, 160.0, 80.0, 120.0, 90.0, 80.0, 50.0, 50.0, 80.0, 108.0, 170.0, 90.0, -8.0, 150.0, 141.0, 50.0, 120.0, 30.0, 80.0, 40.0, 90.0, 120.0, 2.0, 70.0, 140.0, 100.0, -31.0, 100.0, 60.0, 71.0, 150.0, 50.0, 50.0, 160.0, 10.0, 50.0, 170.0, 50.0, 80.0, 80.0, 170.0, 120.0, 160.0, 27.0, 100.0, 6.0, 81.0, 60.0, 90.0, 190.0, 73.0, 130.0, -33.0, 90.0, 190.0, -41.0, 120.0, 70.0, 27.0, 130.0, 60.0, 12.0, 60.0, 100.0, 150.0, 60.0, 80.0, 180.0, 82.0, 70.0, 90.0, 90.0, 170.0, 100.0, 210.0, 180.0, 120.0, 19.0, 39.0, 150.0, 60.0, 60.0, 80.0, 70.0, 130.0, 40.0, 140.0, 100.0, 60.0, 160.0, 80.0, 124.0, 80.0, 70.0, 109.0, 120.0, 60.0, 70.0, 140.0, 100.0, 180.0, 180.0, 120.0, 50.0, 130.0, 115.0, 200.0, 160.0, 100.0, 137.0, 60.0, 89.0, 120.0, 49.0, 50.0, 60.0, 90.0, 80.0, 70.0, 80.0, 46.0, 220.0, 40.0, 100.0, -2.0, 30.0, 15.0, 100.0, 65.0, 79.0, -50.0, 160.0, 80.0, 68.0, 100.0, 110.0, 60.0, 50.0, 90.0, 58.0, 180.0, 80.0, 130.0, 101.0, 60.0, 90.0, 80.0, 50.0, 90.0, 90.0, 51.0, 60.0, 146.0, 100.0, 70.0, 90.0, 80.0, 160.0, 130.0, 160.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7684691208274552, "mean_inference_ms": 1.7796657886412925, "mean_action_processing_ms": 0.5319308237502899, "mean_env_wait_ms": 1.2019295825776384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012309074401855469, "StateBufferConnector_ms": 0.008903980255126953, "ViewRequirementAgentConnector_ms": 0.36979198455810547}, "num_episodes": 18, "episode_return_max": 1530.0, "episode_return_min": 597.0, "episode_return_mean": 988.13}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.75776730631853, "num_env_steps_trained_throughput_per_sec": 20.75776730631853, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 3360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3360000, "timers": {"training_iteration_time_ms": 193290.291, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193290.245, "sample_time_ms": 2291.778, "learn_time_ms": 190979.233, "learn_throughput": 20.945, "synch_weights_time_ms": 10.843}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "done": false, "training_iteration": 84, "trial_id": "1841f_00000", "date": "2024-08-08_04-13-54", "timestamp": 1723104834, "time_this_iter_s": 192.70858311653137, "time_total_s": 17618.45806121826, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33b1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17618.45806121826, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 17.243014705882356, "ram_util_percent": 76.96433823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.519501024110122, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.594071006876465, "policy_loss": -0.012858204224173681, "vf_loss": 8.605491714050975, "vf_explained_var": -0.0039869005306841085, "kl": 0.007187489309594098, "entropy": 0.5023502373117735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 793455.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "env_runners": {"episode_reward_max": 1456.0, "episode_reward_min": 597.0, "episode_reward_mean": 995.96, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 400.0}, "policy_reward_mean": {"policy_0": 99.596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [704.0, 797.0, 969.0, 1348.0, 1140.0, 1070.0, 1150.0, 840.0, 860.0, 1145.0, 1022.0, 1030.0, 1159.0, 870.0, 1185.0, 730.0, 877.0, 828.0, 940.0, 869.0, 940.0, 1086.0, 820.0, 1080.0, 1025.0, 1295.0, 987.0, 861.0, 910.0, 1456.0, 1105.0, 845.0, 998.0, 1130.0, 909.0, 1050.0, 1066.0, 969.0, 830.0, 959.0, 1113.0, 771.0, 795.0, 1102.0, 894.0, 929.0, 1060.0, 964.0, 810.0, 841.0, 1333.0, 1200.0, 1309.0, 1013.0, 762.0, 1025.0, 1130.0, 1040.0, 1035.0, 989.0, 605.0, 1002.0, 988.0, 783.0, 782.0, 870.0, 907.0, 743.0, 884.0, 1138.0, 920.0, 1053.0, 1252.0, 734.0, 597.0, 956.0, 822.0, 1051.0, 998.0, 965.0, 1152.0, 737.0, 835.0, 1100.0, 1305.0, 1094.0, 927.0, 1103.0, 1238.0, 1222.0, 1200.0, 1010.0, 1222.0, 1112.0, 843.0, 1301.0, 829.0, 1216.0, 1050.0, 1081.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 52.0, 30.0, 82.0, 60.0, 50.0, 40.0, 160.0, 60.0, 80.0, 150.0, 200.0, 30.0, 30.0, 20.0, 80.0, 77.0, 30.0, 60.0, 120.0, 90.0, 70.0, 110.0, 120.0, 110.0, 160.0, 50.0, 70.0, 99.0, 90.0, 150.0, 98.0, 110.0, 80.0, 120.0, 130.0, 110.0, 160.0, 110.0, 280.0, 180.0, 80.0, 80.0, 150.0, 140.0, 130.0, 120.0, 90.0, 60.0, 110.0, 160.0, 140.0, 160.0, 100.0, 60.0, 80.0, 90.0, 180.0, 60.0, 40.0, 90.0, 70.0, 90.0, 110.0, 60.0, 230.0, 150.0, 190.0, 100.0, 60.0, 65.0, 13.0, 180.0, 120.0, 33.0, 84.0, 90.0, 95.0, 110.0, 50.0, 110.0, 80.0, 100.0, 90.0, 80.0, 100.0, 60.0, 120.0, 50.0, 70.0, 140.0, 80.0, 85.0, 120.0, 170.0, 110.0, 50.0, 160.0, 70.0, 160.0, 80.0, 124.0, 110.0, 190.0, 90.0, 120.0, 33.0, 65.0, 100.0, 110.0, 60.0, 180.0, 40.0, 190.0, 110.0, 30.0, 100.0, 150.0, 120.0, 50.0, 80.0, 160.0, 70.0, 109.0, 160.0, 100.0, 50.0, 160.0, 100.0, 170.0, 80.0, 90.0, 140.0, 100.0, 10.0, 60.0, 120.0, 90.0, 50.0, 130.0, 130.0, 90.0, 125.0, 170.0, 110.0, 100.0, 140.0, 80.0, 120.0, 120.0, 40.0, 60.0, 80.0, 100.0, 100.0, 70.0, 60.0, 30.0, 80.0, 110.0, 65.0, 55.0, 120.0, 24.0, 67.0, 110.0, 166.0, 110.0, 100.0, 60.0, 120.0, 120.0, 150.0, 100.0, 6.0, 4.0, 140.0, 28.0, 50.0, 110.0, 70.0, 170.0, 40.0, 50.0, 40.0, 140.0, 130.0, 140.0, 70.0, 90.0, 164.0, 18.0, 70.0, 40.0, 67.0, 90.0, 100.0, 90.0, 70.0, 160.0, 80.0, 50.0, 130.0, 60.0, 150.0, 70.0, 90.0, 120.0, 110.0, 80.0, 90.0, 150.0, -11.0, 140.0, 110.0, 70.0, 140.0, 200.0, 97.0, 100.0, 60.0, 80.0, 130.0, 80.0, 110.0, 50.0, 80.0, 70.0, 70.0, 90.0, 140.0, 70.0, 40.0, 150.0, 180.0, 110.0, 120.0, 120.0, 70.0, 80.0, 90.0, 160.0, 90.0, 227.0, 50.0, 120.0, 10.0, 140.0, 80.0, 58.0, 270.0, 120.0, 47.0, 70.0, 90.0, 96.0, 145.0, 130.0, 167.0, 160.0, 250.0, 110.0, 80.0, 2.0, 100.0, 90.0, 82.0, 73.0, 60.0, 140.0, 140.0, 100.0, 30.0, 40.0, 100.0, 90.0, 31.0, 110.0, 100.0, 120.0, 70.0, 46.0, 40.0, 120.0, 104.0, 170.0, 80.0, 80.0, 90.0, 110.0, 150.0, 80.0, 210.0, 160.0, 130.0, 160.0, 88.0, 130.0, 210.0, 138.0, 140.0, 64.0, 90.0, 115.0, 100.0, 190.0, 93.0, 100.0, 93.0, 120.0, 115.0, 163.0, 7.0, 60.0, 60.0, 50.0, 60.0, 200.0, 120.0, 10.0, 80.0, 80.0, 60.0, 80.0, 130.0, 150.0, 69.0, 121.0, 190.0, 38.0, 80.0, 80.0, 180.0, 100.0, 90.0, 70.0, 160.0, 100.0, 110.0, 160.0, 110.0, 100.0, 20.0, 120.0, 110.0, 69.0, 110.0, 140.0, 70.0, 60.0, 140.0, 110.0, 100.0, 170.0, 220.0, 50.0, 60.0, 140.0, 40.0, 20.0, 150.0, 60.0, 140.0, 86.0, 70.0, 90.0, 30.0, 240.0, 140.0, 60.0, 131.0, 28.0, 220.0, 70.0, 50.0, 70.0, 130.0, 50.0, 110.0, 110.0, 160.0, 110.0, 80.0, 120.0, -10.0, 77.0, 70.0, 84.0, 60.0, 79.0, 39.0, 110.0, 30.0, 180.0, 80.0, 130.0, 60.0, 30.0, 250.0, 50.0, 90.0, 230.0, 110.0, 150.0, 120.0, 20.0, 100.0, 64.0, 169.0, 60.0, 110.0, 90.0, 30.0, 40.0, 90.0, 90.0, 73.0, 50.0, 68.0, 130.0, 48.0, 79.0, 40.0, 70.0, 58.0, 50.0, 80.0, 80.0, 130.0, 160.0, 220.0, 140.0, 63.0, 70.0, 50.0, 170.0, 100.0, 130.0, 89.0, 70.0, 105.0, 41.0, 110.0, 130.0, 80.0, 80.0, 78.0, 90.0, 90.0, 90.0, 12.0, 190.0, 70.0, 100.0, 50.0, 207.0, 120.0, 90.0, 50.0, 40.0, 110.0, 160.0, 160.0, 110.0, 120.0, 140.0, 80.0, 60.0, 30.0, 90.0, 60.0, 110.0, 123.0, 60.0, 110.0, 110.0, 140.0, 71.0, 70.0, 110.0, 110.0, 90.0, 20.0, 80.0, 130.0, 45.0, 130.0, 80.0, 45.0, 80.0, 130.0, 90.0, 100.0, 110.0, 90.0, 35.0, 6.0, 50.0, 100.0, 130.0, 100.0, 100.0, 170.0, 160.0, 110.0, 140.0, 142.0, 81.0, 180.0, 150.0, 234.0, 100.0, 79.0, 30.0, 170.0, 97.0, 140.0, 120.0, 110.0, 120.0, 140.0, 120.0, 80.0, 129.0, 110.0, 200.0, 130.0, 120.0, 130.0, 150.0, 80.0, 70.0, 100.0, 150.0, 112.0, 110.0, 137.0, 72.0, 102.0, 80.0, 106.0, 70.0, 40.0, 73.0, 75.0, 130.0, 110.0, -17.0, 45.0, 130.0, 110.0, 88.0, 200.0, 70.0, 100.0, 80.0, 87.0, 50.0, 190.0, 50.0, 90.0, 95.0, 150.0, 140.0, 75.0, 160.0, 160.0, 70.0, 90.0, 100.0, 50.0, 50.0, 40.0, 130.0, 160.0, 160.0, 140.0, 10.0, 190.0, 110.0, 170.0, 170.0, 120.0, 70.0, 45.0, 100.0, 50.0, 130.0, 100.0, 80.0, 60.0, 110.0, 60.0, 150.0, 79.0, 130.0, 120.0, 90.0, 90.0, 100.0, 40.0, 80.0, 100.0, 20.0, 30.0, 130.0, 50.0, 40.0, 70.0, 45.0, 130.0, 250.0, 130.0, 39.0, -3.0, 90.0, 110.0, 110.0, 140.0, 6.0, 160.0, 80.0, 120.0, 90.0, 80.0, 50.0, 50.0, 80.0, 108.0, 170.0, 90.0, -8.0, 150.0, 141.0, 50.0, 120.0, 30.0, 80.0, 40.0, 90.0, 120.0, 2.0, 70.0, 140.0, 100.0, -31.0, 100.0, 60.0, 71.0, 150.0, 50.0, 50.0, 160.0, 10.0, 50.0, 170.0, 50.0, 80.0, 80.0, 170.0, 120.0, 160.0, 27.0, 100.0, 6.0, 81.0, 60.0, 90.0, 190.0, 73.0, 130.0, -33.0, 90.0, 190.0, -41.0, 120.0, 70.0, 27.0, 130.0, 60.0, 12.0, 60.0, 100.0, 150.0, 60.0, 80.0, 180.0, 82.0, 70.0, 90.0, 90.0, 170.0, 100.0, 210.0, 180.0, 120.0, 19.0, 39.0, 150.0, 60.0, 60.0, 80.0, 70.0, 130.0, 40.0, 140.0, 100.0, 60.0, 160.0, 80.0, 124.0, 80.0, 70.0, 109.0, 120.0, 60.0, 70.0, 140.0, 100.0, 180.0, 180.0, 120.0, 50.0, 130.0, 115.0, 200.0, 160.0, 100.0, 137.0, 60.0, 89.0, 120.0, 49.0, 50.0, 60.0, 90.0, 80.0, 70.0, 80.0, 46.0, 220.0, 40.0, 100.0, -2.0, 30.0, 15.0, 100.0, 65.0, 79.0, -50.0, 160.0, 80.0, 68.0, 100.0, 110.0, 60.0, 50.0, 90.0, 58.0, 180.0, 80.0, 130.0, 101.0, 60.0, 90.0, 80.0, 50.0, 90.0, 90.0, 51.0, 60.0, 146.0, 100.0, 70.0, 90.0, 80.0, 160.0, 130.0, 160.0, 55.0, 85.0, 72.0, 23.0, 190.0, 80.0, 200.0, 139.0, 119.0, 50.0, 40.0, 170.0, 110.0, 90.0, 110.0, 50.0, 55.0, 60.0, 130.0, 40.0, 150.0, 140.0, 60.0, 100.0, 170.0, 130.0, 128.0, 45.0, 190.0, 69.0, 120.0, 80.0, 39.0, 90.0, 10.0, 70.0, 110.0, 56.0, 100.0, 140.0, 42.0, 70.0, 2.0, 50.0, 140.0, 80.0, 120.0, 20.0, 160.0, 150.0, 43.0, 170.0, 90.0, 140.0, 130.0, 80.0, 80.0, 130.0, 60.0, 50.0, 170.0, 65.0, 40.0, 120.0, 100.0, 150.0, 400.0, 130.0, 110.0, 80.0, 110.0, 140.0, 150.0, 80.0, 70.0, 173.0, 100.0, 90.0, 52.0, 160.0, 79.0, 110.0, 80.0, 150.0, 50.0, 130.0, 130.0, 6.0, 71.0, 110.0, 90.0, 70.0, 150.0, 90.0, 140.0, 240.0, 100.0, 110.0, 66.0, 100.0, 37.0, 80.0, 90.0, 210.0, 143.0, 165.0, 130.0, 180.0, 110.0, 70.0, 60.0, 220.0, 55.0, 120.0, 110.0, 99.0, 120.0, 170.0, 150.0, 68.0, 110.0, 60.0, 110.0, 130.0, 100.0, 80.0, 120.0, 150.0, 160.0, 180.0, 110.0, 140.0, 70.0, 80.0, 70.0, 180.0, 140.0, 110.0, 30.0, 180.0, 10.0, 96.0, 70.0, 80.0, 99.0, 240.0, 220.0, 37.0, 100.0, 130.0, 150.0, 120.0, 200.0, 94.0, 80.0, 120.0, 103.0, 90.0, 95.0, 90.0, 120.0, 40.0, 130.0, 100.0, 47.0, 86.0, 70.0, 130.0, 70.0, 80.0, 90.0, 170.0, 135.0, 150.0, 80.0, 160.0, 211.0, 55.0, 130.0, 60.0, 150.0, 119.0, 45.0, 110.0, 80.0, 9.0, 110.0, 47.0, 100.0, 59.0, 150.0, 100.0, 138.0, 178.0, 70.0, 110.0, 40.0, 80.0, 180.0, 160.0, 160.0, 180.0, 60.0, 120.0, 110.0, 10.0, 140.0, 90.0, 160.0, 100.0, 80.0, 39.0, 150.0, 147.0, 130.0, 100.0, 130.0, 86.0, 39.0, 110.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7643891753960554, "mean_inference_ms": 1.774734509113833, "mean_action_processing_ms": 0.5305993771046551, "mean_env_wait_ms": 1.1987993154793404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013239860534667969, "StateBufferConnector_ms": 0.009301900863647461, "ViewRequirementAgentConnector_ms": 0.38298845291137695}, "num_episodes": 22, "episode_return_max": 1456.0, "episode_return_min": 597.0, "episode_return_mean": 995.96}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.81810260624622, "num_env_steps_trained_throughput_per_sec": 20.81810260624622, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 3400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3400000, "timers": {"training_iteration_time_ms": 193225.944, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193225.898, "sample_time_ms": 2288.345, "learn_time_ms": 190918.634, "learn_throughput": 20.951, "synch_weights_time_ms": 10.656}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "done": false, "training_iteration": 85, "trial_id": "1841f_00000", "date": "2024-08-08_04-17-06", "timestamp": 1723105026, "time_this_iter_s": 192.15060210227966, "time_total_s": 17810.60866332054, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33b1550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17810.60866332054, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 17.241911764705883, "ram_util_percent": 76.88823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.626390100350649, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.582890324546888, "policy_loss": -0.014042686351328985, "vf_loss": 8.595423653026739, "vf_explained_var": -0.004932303880604184, "kl": 0.007546741221190967, "entropy": 0.5160242572188758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 802845.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "env_runners": {"episode_reward_max": 1456.0, "episode_reward_min": 281.0, "episode_reward_mean": 986.34, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 400.0}, "policy_reward_mean": {"policy_0": 98.634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [940.0, 869.0, 940.0, 1086.0, 820.0, 1080.0, 1025.0, 1295.0, 987.0, 861.0, 910.0, 1456.0, 1105.0, 845.0, 998.0, 1130.0, 909.0, 1050.0, 1066.0, 969.0, 830.0, 959.0, 1113.0, 771.0, 795.0, 1102.0, 894.0, 929.0, 1060.0, 964.0, 810.0, 841.0, 1333.0, 1200.0, 1309.0, 1013.0, 762.0, 1025.0, 1130.0, 1040.0, 1035.0, 989.0, 605.0, 1002.0, 988.0, 783.0, 782.0, 870.0, 907.0, 743.0, 884.0, 1138.0, 920.0, 1053.0, 1252.0, 734.0, 597.0, 956.0, 822.0, 1051.0, 998.0, 965.0, 1152.0, 737.0, 835.0, 1100.0, 1305.0, 1094.0, 927.0, 1103.0, 1238.0, 1222.0, 1200.0, 1010.0, 1222.0, 1112.0, 843.0, 1301.0, 829.0, 1216.0, 1050.0, 1081.0, 1188.0, 980.0, 990.0, 1160.0, 896.0, 920.0, 1139.0, 1052.0, 655.0, 1214.0, 618.0, 775.0, 1155.0, 1270.0, 281.0, 895.0, 878.0, 696.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 170.0, 40.0, 50.0, 40.0, 140.0, 130.0, 140.0, 70.0, 90.0, 164.0, 18.0, 70.0, 40.0, 67.0, 90.0, 100.0, 90.0, 70.0, 160.0, 80.0, 50.0, 130.0, 60.0, 150.0, 70.0, 90.0, 120.0, 110.0, 80.0, 90.0, 150.0, -11.0, 140.0, 110.0, 70.0, 140.0, 200.0, 97.0, 100.0, 60.0, 80.0, 130.0, 80.0, 110.0, 50.0, 80.0, 70.0, 70.0, 90.0, 140.0, 70.0, 40.0, 150.0, 180.0, 110.0, 120.0, 120.0, 70.0, 80.0, 90.0, 160.0, 90.0, 227.0, 50.0, 120.0, 10.0, 140.0, 80.0, 58.0, 270.0, 120.0, 47.0, 70.0, 90.0, 96.0, 145.0, 130.0, 167.0, 160.0, 250.0, 110.0, 80.0, 2.0, 100.0, 90.0, 82.0, 73.0, 60.0, 140.0, 140.0, 100.0, 30.0, 40.0, 100.0, 90.0, 31.0, 110.0, 100.0, 120.0, 70.0, 46.0, 40.0, 120.0, 104.0, 170.0, 80.0, 80.0, 90.0, 110.0, 150.0, 80.0, 210.0, 160.0, 130.0, 160.0, 88.0, 130.0, 210.0, 138.0, 140.0, 64.0, 90.0, 115.0, 100.0, 190.0, 93.0, 100.0, 93.0, 120.0, 115.0, 163.0, 7.0, 60.0, 60.0, 50.0, 60.0, 200.0, 120.0, 10.0, 80.0, 80.0, 60.0, 80.0, 130.0, 150.0, 69.0, 121.0, 190.0, 38.0, 80.0, 80.0, 180.0, 100.0, 90.0, 70.0, 160.0, 100.0, 110.0, 160.0, 110.0, 100.0, 20.0, 120.0, 110.0, 69.0, 110.0, 140.0, 70.0, 60.0, 140.0, 110.0, 100.0, 170.0, 220.0, 50.0, 60.0, 140.0, 40.0, 20.0, 150.0, 60.0, 140.0, 86.0, 70.0, 90.0, 30.0, 240.0, 140.0, 60.0, 131.0, 28.0, 220.0, 70.0, 50.0, 70.0, 130.0, 50.0, 110.0, 110.0, 160.0, 110.0, 80.0, 120.0, -10.0, 77.0, 70.0, 84.0, 60.0, 79.0, 39.0, 110.0, 30.0, 180.0, 80.0, 130.0, 60.0, 30.0, 250.0, 50.0, 90.0, 230.0, 110.0, 150.0, 120.0, 20.0, 100.0, 64.0, 169.0, 60.0, 110.0, 90.0, 30.0, 40.0, 90.0, 90.0, 73.0, 50.0, 68.0, 130.0, 48.0, 79.0, 40.0, 70.0, 58.0, 50.0, 80.0, 80.0, 130.0, 160.0, 220.0, 140.0, 63.0, 70.0, 50.0, 170.0, 100.0, 130.0, 89.0, 70.0, 105.0, 41.0, 110.0, 130.0, 80.0, 80.0, 78.0, 90.0, 90.0, 90.0, 12.0, 190.0, 70.0, 100.0, 50.0, 207.0, 120.0, 90.0, 50.0, 40.0, 110.0, 160.0, 160.0, 110.0, 120.0, 140.0, 80.0, 60.0, 30.0, 90.0, 60.0, 110.0, 123.0, 60.0, 110.0, 110.0, 140.0, 71.0, 70.0, 110.0, 110.0, 90.0, 20.0, 80.0, 130.0, 45.0, 130.0, 80.0, 45.0, 80.0, 130.0, 90.0, 100.0, 110.0, 90.0, 35.0, 6.0, 50.0, 100.0, 130.0, 100.0, 100.0, 170.0, 160.0, 110.0, 140.0, 142.0, 81.0, 180.0, 150.0, 234.0, 100.0, 79.0, 30.0, 170.0, 97.0, 140.0, 120.0, 110.0, 120.0, 140.0, 120.0, 80.0, 129.0, 110.0, 200.0, 130.0, 120.0, 130.0, 150.0, 80.0, 70.0, 100.0, 150.0, 112.0, 110.0, 137.0, 72.0, 102.0, 80.0, 106.0, 70.0, 40.0, 73.0, 75.0, 130.0, 110.0, -17.0, 45.0, 130.0, 110.0, 88.0, 200.0, 70.0, 100.0, 80.0, 87.0, 50.0, 190.0, 50.0, 90.0, 95.0, 150.0, 140.0, 75.0, 160.0, 160.0, 70.0, 90.0, 100.0, 50.0, 50.0, 40.0, 130.0, 160.0, 160.0, 140.0, 10.0, 190.0, 110.0, 170.0, 170.0, 120.0, 70.0, 45.0, 100.0, 50.0, 130.0, 100.0, 80.0, 60.0, 110.0, 60.0, 150.0, 79.0, 130.0, 120.0, 90.0, 90.0, 100.0, 40.0, 80.0, 100.0, 20.0, 30.0, 130.0, 50.0, 40.0, 70.0, 45.0, 130.0, 250.0, 130.0, 39.0, -3.0, 90.0, 110.0, 110.0, 140.0, 6.0, 160.0, 80.0, 120.0, 90.0, 80.0, 50.0, 50.0, 80.0, 108.0, 170.0, 90.0, -8.0, 150.0, 141.0, 50.0, 120.0, 30.0, 80.0, 40.0, 90.0, 120.0, 2.0, 70.0, 140.0, 100.0, -31.0, 100.0, 60.0, 71.0, 150.0, 50.0, 50.0, 160.0, 10.0, 50.0, 170.0, 50.0, 80.0, 80.0, 170.0, 120.0, 160.0, 27.0, 100.0, 6.0, 81.0, 60.0, 90.0, 190.0, 73.0, 130.0, -33.0, 90.0, 190.0, -41.0, 120.0, 70.0, 27.0, 130.0, 60.0, 12.0, 60.0, 100.0, 150.0, 60.0, 80.0, 180.0, 82.0, 70.0, 90.0, 90.0, 170.0, 100.0, 210.0, 180.0, 120.0, 19.0, 39.0, 150.0, 60.0, 60.0, 80.0, 70.0, 130.0, 40.0, 140.0, 100.0, 60.0, 160.0, 80.0, 124.0, 80.0, 70.0, 109.0, 120.0, 60.0, 70.0, 140.0, 100.0, 180.0, 180.0, 120.0, 50.0, 130.0, 115.0, 200.0, 160.0, 100.0, 137.0, 60.0, 89.0, 120.0, 49.0, 50.0, 60.0, 90.0, 80.0, 70.0, 80.0, 46.0, 220.0, 40.0, 100.0, -2.0, 30.0, 15.0, 100.0, 65.0, 79.0, -50.0, 160.0, 80.0, 68.0, 100.0, 110.0, 60.0, 50.0, 90.0, 58.0, 180.0, 80.0, 130.0, 101.0, 60.0, 90.0, 80.0, 50.0, 90.0, 90.0, 51.0, 60.0, 146.0, 100.0, 70.0, 90.0, 80.0, 160.0, 130.0, 160.0, 55.0, 85.0, 72.0, 23.0, 190.0, 80.0, 200.0, 139.0, 119.0, 50.0, 40.0, 170.0, 110.0, 90.0, 110.0, 50.0, 55.0, 60.0, 130.0, 40.0, 150.0, 140.0, 60.0, 100.0, 170.0, 130.0, 128.0, 45.0, 190.0, 69.0, 120.0, 80.0, 39.0, 90.0, 10.0, 70.0, 110.0, 56.0, 100.0, 140.0, 42.0, 70.0, 2.0, 50.0, 140.0, 80.0, 120.0, 20.0, 160.0, 150.0, 43.0, 170.0, 90.0, 140.0, 130.0, 80.0, 80.0, 130.0, 60.0, 50.0, 170.0, 65.0, 40.0, 120.0, 100.0, 150.0, 400.0, 130.0, 110.0, 80.0, 110.0, 140.0, 150.0, 80.0, 70.0, 173.0, 100.0, 90.0, 52.0, 160.0, 79.0, 110.0, 80.0, 150.0, 50.0, 130.0, 130.0, 6.0, 71.0, 110.0, 90.0, 70.0, 150.0, 90.0, 140.0, 240.0, 100.0, 110.0, 66.0, 100.0, 37.0, 80.0, 90.0, 210.0, 143.0, 165.0, 130.0, 180.0, 110.0, 70.0, 60.0, 220.0, 55.0, 120.0, 110.0, 99.0, 120.0, 170.0, 150.0, 68.0, 110.0, 60.0, 110.0, 130.0, 100.0, 80.0, 120.0, 150.0, 160.0, 180.0, 110.0, 140.0, 70.0, 80.0, 70.0, 180.0, 140.0, 110.0, 30.0, 180.0, 10.0, 96.0, 70.0, 80.0, 99.0, 240.0, 220.0, 37.0, 100.0, 130.0, 150.0, 120.0, 200.0, 94.0, 80.0, 120.0, 103.0, 90.0, 95.0, 90.0, 120.0, 40.0, 130.0, 100.0, 47.0, 86.0, 70.0, 130.0, 70.0, 80.0, 90.0, 170.0, 135.0, 150.0, 80.0, 160.0, 211.0, 55.0, 130.0, 60.0, 150.0, 119.0, 45.0, 110.0, 80.0, 9.0, 110.0, 47.0, 100.0, 59.0, 150.0, 100.0, 138.0, 178.0, 70.0, 110.0, 40.0, 80.0, 180.0, 160.0, 160.0, 180.0, 60.0, 120.0, 110.0, 10.0, 140.0, 90.0, 160.0, 100.0, 80.0, 39.0, 150.0, 147.0, 130.0, 100.0, 130.0, 86.0, 39.0, 110.0, 150.0, 60.0, 110.0, 130.0, 110.0, 116.0, 60.0, 100.0, 230.0, 162.0, 110.0, 60.0, 110.0, 70.0, 220.0, 90.0, 60.0, 100.0, 120.0, 90.0, 60.0, 150.0, 100.0, 210.0, 140.0, 140.0, 80.0, 50.0, 30.0, 50.0, 40.0, 230.0, 160.0, 90.0, 150.0, 120.0, 45.0, 120.0, 55.0, 100.0, 90.0, 50.0, 70.0, 100.0, 80.0, 20.0, 80.0, 20.0, 60.0, 244.0, 172.0, 70.0, 110.0, 70.0, 70.0, 30.0, 140.0, 0.0, 180.0, 150.0, 100.0, 143.0, 90.0, 120.0, 79.0, 85.0, 220.0, 100.0, 110.0, 72.0, 120.0, 100.0, 150.0, 190.0, 90.0, 70.0, 40.0, 83.0, 50.0, 100.0, 179.0, 70.0, 29.0, 110.0, 40.0, 66.0, 40.0, 90.0, 50.0, 90.0, 70.0, 70.0, 26.0, 140.0, 200.0, 130.0, 150.0, 130.0, 148.0, 90.0, 130.0, 40.0, 160.0, 50.0, 18.0, 50.0, 90.0, 90.0, 40.0, 65.0, 15.0, 125.0, 60.0, 74.0, 80.0, 97.0, 49.0, 110.0, 90.0, 30.0, 60.0, 50.0, 100.0, 200.0, 150.0, 100.0, 60.0, 140.0, 100.0, 160.0, 95.0, 90.0, 150.0, 80.0, 40.0, 110.0, 240.0, 150.0, 120.0, 140.0, 150.0, 150.0, 35.0, 39.0, 50.0, 36.0, 19.0, 70.0, -103.0, -185.0, 170.0, 140.0, 80.0, 70.0, 121.0, 70.0, 80.0, 87.0, 130.0, 40.0, 77.0, 70.0, 69.0, 109.0, 90.0, 100.0, 140.0, 110.0, 80.0, 30.0, 80.0, 49.0, 1.0, 76.0, 80.0, 40.0, 80.0, 20.0, 100.0, 50.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7610818313370524, "mean_inference_ms": 1.7708007919546207, "mean_action_processing_ms": 0.5295645563348437, "mean_env_wait_ms": 1.1963073461915443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01317143440246582, "StateBufferConnector_ms": 0.009382963180541992, "ViewRequirementAgentConnector_ms": 0.37679314613342285}, "num_episodes": 18, "episode_return_max": 1456.0, "episode_return_min": 281.0, "episode_return_mean": 986.34}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.750056232027358, "num_env_steps_trained_throughput_per_sec": 20.750056232027358, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 3440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3440000, "timers": {"training_iteration_time_ms": 193195.188, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193195.141, "sample_time_ms": 2291.731, "learn_time_ms": 190884.557, "learn_throughput": 20.955, "synch_weights_time_ms": 10.566}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "done": false, "training_iteration": 86, "trial_id": "1841f_00000", "date": "2024-08-08_04-20-19", "timestamp": 1723105219, "time_this_iter_s": 192.78140497207642, "time_total_s": 18003.390068292618, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33b1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18003.390068292618, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.365201465201466, "ram_util_percent": 76.2923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7643698263853884, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.603119262516563, "policy_loss": -0.013822741901870972, "vf_loss": 8.615505507502693, "vf_explained_var": -0.0020986774033758715, "kl": 0.007182460529464154, "entropy": 0.5146335413344244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 812235.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 281.0, "episode_reward_mean": 983.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 400.0}, "policy_reward_mean": {"policy_0": 98.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [771.0, 795.0, 1102.0, 894.0, 929.0, 1060.0, 964.0, 810.0, 841.0, 1333.0, 1200.0, 1309.0, 1013.0, 762.0, 1025.0, 1130.0, 1040.0, 1035.0, 989.0, 605.0, 1002.0, 988.0, 783.0, 782.0, 870.0, 907.0, 743.0, 884.0, 1138.0, 920.0, 1053.0, 1252.0, 734.0, 597.0, 956.0, 822.0, 1051.0, 998.0, 965.0, 1152.0, 737.0, 835.0, 1100.0, 1305.0, 1094.0, 927.0, 1103.0, 1238.0, 1222.0, 1200.0, 1010.0, 1222.0, 1112.0, 843.0, 1301.0, 829.0, 1216.0, 1050.0, 1081.0, 1188.0, 980.0, 990.0, 1160.0, 896.0, 920.0, 1139.0, 1052.0, 655.0, 1214.0, 618.0, 775.0, 1155.0, 1270.0, 281.0, 895.0, 878.0, 696.0, 978.0, 939.0, 1095.0, 948.0, 1210.0, 998.0, 1100.0, 1039.0, 1000.0, 919.0, 840.0, 780.0, 1395.0, 1020.0, 917.0, 983.0, 1169.0, 813.0, 680.0, 931.0, 855.0, 1320.0, 980.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 90.0, 30.0, 40.0, 90.0, 90.0, 73.0, 50.0, 68.0, 130.0, 48.0, 79.0, 40.0, 70.0, 58.0, 50.0, 80.0, 80.0, 130.0, 160.0, 220.0, 140.0, 63.0, 70.0, 50.0, 170.0, 100.0, 130.0, 89.0, 70.0, 105.0, 41.0, 110.0, 130.0, 80.0, 80.0, 78.0, 90.0, 90.0, 90.0, 12.0, 190.0, 70.0, 100.0, 50.0, 207.0, 120.0, 90.0, 50.0, 40.0, 110.0, 160.0, 160.0, 110.0, 120.0, 140.0, 80.0, 60.0, 30.0, 90.0, 60.0, 110.0, 123.0, 60.0, 110.0, 110.0, 140.0, 71.0, 70.0, 110.0, 110.0, 90.0, 20.0, 80.0, 130.0, 45.0, 130.0, 80.0, 45.0, 80.0, 130.0, 90.0, 100.0, 110.0, 90.0, 35.0, 6.0, 50.0, 100.0, 130.0, 100.0, 100.0, 170.0, 160.0, 110.0, 140.0, 142.0, 81.0, 180.0, 150.0, 234.0, 100.0, 79.0, 30.0, 170.0, 97.0, 140.0, 120.0, 110.0, 120.0, 140.0, 120.0, 80.0, 129.0, 110.0, 200.0, 130.0, 120.0, 130.0, 150.0, 80.0, 70.0, 100.0, 150.0, 112.0, 110.0, 137.0, 72.0, 102.0, 80.0, 106.0, 70.0, 40.0, 73.0, 75.0, 130.0, 110.0, -17.0, 45.0, 130.0, 110.0, 88.0, 200.0, 70.0, 100.0, 80.0, 87.0, 50.0, 190.0, 50.0, 90.0, 95.0, 150.0, 140.0, 75.0, 160.0, 160.0, 70.0, 90.0, 100.0, 50.0, 50.0, 40.0, 130.0, 160.0, 160.0, 140.0, 10.0, 190.0, 110.0, 170.0, 170.0, 120.0, 70.0, 45.0, 100.0, 50.0, 130.0, 100.0, 80.0, 60.0, 110.0, 60.0, 150.0, 79.0, 130.0, 120.0, 90.0, 90.0, 100.0, 40.0, 80.0, 100.0, 20.0, 30.0, 130.0, 50.0, 40.0, 70.0, 45.0, 130.0, 250.0, 130.0, 39.0, -3.0, 90.0, 110.0, 110.0, 140.0, 6.0, 160.0, 80.0, 120.0, 90.0, 80.0, 50.0, 50.0, 80.0, 108.0, 170.0, 90.0, -8.0, 150.0, 141.0, 50.0, 120.0, 30.0, 80.0, 40.0, 90.0, 120.0, 2.0, 70.0, 140.0, 100.0, -31.0, 100.0, 60.0, 71.0, 150.0, 50.0, 50.0, 160.0, 10.0, 50.0, 170.0, 50.0, 80.0, 80.0, 170.0, 120.0, 160.0, 27.0, 100.0, 6.0, 81.0, 60.0, 90.0, 190.0, 73.0, 130.0, -33.0, 90.0, 190.0, -41.0, 120.0, 70.0, 27.0, 130.0, 60.0, 12.0, 60.0, 100.0, 150.0, 60.0, 80.0, 180.0, 82.0, 70.0, 90.0, 90.0, 170.0, 100.0, 210.0, 180.0, 120.0, 19.0, 39.0, 150.0, 60.0, 60.0, 80.0, 70.0, 130.0, 40.0, 140.0, 100.0, 60.0, 160.0, 80.0, 124.0, 80.0, 70.0, 109.0, 120.0, 60.0, 70.0, 140.0, 100.0, 180.0, 180.0, 120.0, 50.0, 130.0, 115.0, 200.0, 160.0, 100.0, 137.0, 60.0, 89.0, 120.0, 49.0, 50.0, 60.0, 90.0, 80.0, 70.0, 80.0, 46.0, 220.0, 40.0, 100.0, -2.0, 30.0, 15.0, 100.0, 65.0, 79.0, -50.0, 160.0, 80.0, 68.0, 100.0, 110.0, 60.0, 50.0, 90.0, 58.0, 180.0, 80.0, 130.0, 101.0, 60.0, 90.0, 80.0, 50.0, 90.0, 90.0, 51.0, 60.0, 146.0, 100.0, 70.0, 90.0, 80.0, 160.0, 130.0, 160.0, 55.0, 85.0, 72.0, 23.0, 190.0, 80.0, 200.0, 139.0, 119.0, 50.0, 40.0, 170.0, 110.0, 90.0, 110.0, 50.0, 55.0, 60.0, 130.0, 40.0, 150.0, 140.0, 60.0, 100.0, 170.0, 130.0, 128.0, 45.0, 190.0, 69.0, 120.0, 80.0, 39.0, 90.0, 10.0, 70.0, 110.0, 56.0, 100.0, 140.0, 42.0, 70.0, 2.0, 50.0, 140.0, 80.0, 120.0, 20.0, 160.0, 150.0, 43.0, 170.0, 90.0, 140.0, 130.0, 80.0, 80.0, 130.0, 60.0, 50.0, 170.0, 65.0, 40.0, 120.0, 100.0, 150.0, 400.0, 130.0, 110.0, 80.0, 110.0, 140.0, 150.0, 80.0, 70.0, 173.0, 100.0, 90.0, 52.0, 160.0, 79.0, 110.0, 80.0, 150.0, 50.0, 130.0, 130.0, 6.0, 71.0, 110.0, 90.0, 70.0, 150.0, 90.0, 140.0, 240.0, 100.0, 110.0, 66.0, 100.0, 37.0, 80.0, 90.0, 210.0, 143.0, 165.0, 130.0, 180.0, 110.0, 70.0, 60.0, 220.0, 55.0, 120.0, 110.0, 99.0, 120.0, 170.0, 150.0, 68.0, 110.0, 60.0, 110.0, 130.0, 100.0, 80.0, 120.0, 150.0, 160.0, 180.0, 110.0, 140.0, 70.0, 80.0, 70.0, 180.0, 140.0, 110.0, 30.0, 180.0, 10.0, 96.0, 70.0, 80.0, 99.0, 240.0, 220.0, 37.0, 100.0, 130.0, 150.0, 120.0, 200.0, 94.0, 80.0, 120.0, 103.0, 90.0, 95.0, 90.0, 120.0, 40.0, 130.0, 100.0, 47.0, 86.0, 70.0, 130.0, 70.0, 80.0, 90.0, 170.0, 135.0, 150.0, 80.0, 160.0, 211.0, 55.0, 130.0, 60.0, 150.0, 119.0, 45.0, 110.0, 80.0, 9.0, 110.0, 47.0, 100.0, 59.0, 150.0, 100.0, 138.0, 178.0, 70.0, 110.0, 40.0, 80.0, 180.0, 160.0, 160.0, 180.0, 60.0, 120.0, 110.0, 10.0, 140.0, 90.0, 160.0, 100.0, 80.0, 39.0, 150.0, 147.0, 130.0, 100.0, 130.0, 86.0, 39.0, 110.0, 150.0, 60.0, 110.0, 130.0, 110.0, 116.0, 60.0, 100.0, 230.0, 162.0, 110.0, 60.0, 110.0, 70.0, 220.0, 90.0, 60.0, 100.0, 120.0, 90.0, 60.0, 150.0, 100.0, 210.0, 140.0, 140.0, 80.0, 50.0, 30.0, 50.0, 40.0, 230.0, 160.0, 90.0, 150.0, 120.0, 45.0, 120.0, 55.0, 100.0, 90.0, 50.0, 70.0, 100.0, 80.0, 20.0, 80.0, 20.0, 60.0, 244.0, 172.0, 70.0, 110.0, 70.0, 70.0, 30.0, 140.0, 0.0, 180.0, 150.0, 100.0, 143.0, 90.0, 120.0, 79.0, 85.0, 220.0, 100.0, 110.0, 72.0, 120.0, 100.0, 150.0, 190.0, 90.0, 70.0, 40.0, 83.0, 50.0, 100.0, 179.0, 70.0, 29.0, 110.0, 40.0, 66.0, 40.0, 90.0, 50.0, 90.0, 70.0, 70.0, 26.0, 140.0, 200.0, 130.0, 150.0, 130.0, 148.0, 90.0, 130.0, 40.0, 160.0, 50.0, 18.0, 50.0, 90.0, 90.0, 40.0, 65.0, 15.0, 125.0, 60.0, 74.0, 80.0, 97.0, 49.0, 110.0, 90.0, 30.0, 60.0, 50.0, 100.0, 200.0, 150.0, 100.0, 60.0, 140.0, 100.0, 160.0, 95.0, 90.0, 150.0, 80.0, 40.0, 110.0, 240.0, 150.0, 120.0, 140.0, 150.0, 150.0, 35.0, 39.0, 50.0, 36.0, 19.0, 70.0, -103.0, -185.0, 170.0, 140.0, 80.0, 70.0, 121.0, 70.0, 80.0, 87.0, 130.0, 40.0, 77.0, 70.0, 69.0, 109.0, 90.0, 100.0, 140.0, 110.0, 80.0, 30.0, 80.0, 49.0, 1.0, 76.0, 80.0, 40.0, 80.0, 20.0, 100.0, 50.0, 200.0, 80.0, 150.0, 80.0, 160.0, 110.0, 90.0, 60.0, 38.0, 120.0, 90.0, 160.0, 40.0, 140.0, 110.0, 44.0, 60.0, 150.0, 140.0, 25.0, 70.0, 85.0, 20.0, 60.0, 190.0, 160.0, 110.0, 100.0, 100.0, 150.0, 120.0, 190.0, 90.0, 120.0, 80.0, 50.0, 38.0, 40.0, 60.0, 180.0, 100.0, 80.0, 160.0, 100.0, 100.0, 110.0, 230.0, 110.0, 120.0, 170.0, 30.0, 20.0, 132.0, 188.0, 100.0, 170.0, 100.0, 70.0, 31.0, 67.0, 120.0, 70.0, 160.0, 70.0, 150.0, 130.0, 80.0, 90.0, 100.0, 130.0, 120.0, 60.0, 110.0, 120.0, 160.0, 140.0, 120.0, 90.0, 159.0, 85.0, -5.0, 30.0, 21.0, 120.0, 150.0, 160.0, 150.0, 100.0, 140.0, 39.0, 90.0, 55.0, 200.0, 120.0, 70.0, 130.0, 60.0, 110.0, 75.0, 59.0, 40.0, 10.0, 80.0, 50.0, 110.0, 70.0, 60.0, 200.0, 140.0, 40.0, 80.0, 100.0, 160.0, 100.0, 80.0, 120.0, 50.0, 50.0, 50.0, 40.0, 30.0, 230.0, 100.0, 140.0, 90.0, 90.0, 160.0, 200.0, 145.0, 100.0, 140.0, 78.0, 80.0, 110.0, 130.0, 160.0, 82.0, 50.0, 160.0, 50.0, 120.0, 43.0, 200.0, 50.0, 160.0, 110.0, 120.0, 110.0, 34.0, 50.0, 40.0, 60.0, 100.0, 112.0, 130.0, 180.0, 60.0, 20.0, 90.0, 70.0, 161.0, 149.0, 90.0, 60.0, 190.0, 160.0, 70.0, 80.0, 90.0, 190.0, 90.0, 27.0, 100.0, 98.0, 67.0, 70.0, 131.0, 70.0, 80.0, 50.0, 120.0, 90.0, 70.0, 19.0, 160.0, 20.0, 35.0, 36.0, 170.0, 20.0, 60.0, 144.0, 80.0, 50.0, 80.0, 150.0, 60.0, 0.0, 150.0, 127.0, 90.0, 40.0, 90.0, 60.0, 170.0, 110.0, 65.0, 50.0, 50.0, 80.0, 140.0, 170.0, 170.0, 120.0, 80.0, 140.0, 120.0, 110.0, 30.0, 190.0, 190.0, 90.0, 80.0, 110.0, 120.0, 45.0, 80.0, 140.0, 180.0, 15.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7570018761804451, "mean_inference_ms": 1.7659549961889371, "mean_action_processing_ms": 0.5282571715165483, "mean_env_wait_ms": 1.1931996873708206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013312816619873047, "StateBufferConnector_ms": 0.009634733200073242, "ViewRequirementAgentConnector_ms": 0.37927889823913574}, "num_episodes": 23, "episode_return_max": 1395.0, "episode_return_min": 281.0, "episode_return_mean": 983.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.76601253145945, "num_env_steps_trained_throughput_per_sec": 20.76601253145945, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 3480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3480000, "timers": {"training_iteration_time_ms": 192988.222, "restore_workers_time_ms": 0.011, "training_step_time_ms": 192988.175, "sample_time_ms": 2272.41, "learn_time_ms": 190696.532, "learn_throughput": 20.976, "synch_weights_time_ms": 10.673}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "done": false, "training_iteration": 87, "trial_id": "1841f_00000", "date": "2024-08-08_04-23-32", "timestamp": 1723105412, "time_this_iter_s": 192.6319341659546, "time_total_s": 18196.022002458572, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33b1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18196.022002458572, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 17.677573529411767, "ram_util_percent": 76.60220588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7629816924548125, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.53203473847768, "policy_loss": -0.01467240903783427, "vf_loss": 8.545165461600144, "vf_explained_var": -0.02151724927214642, "kl": 0.0077084326637323255, "entropy": 0.5239913066989952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 821625.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 281.0, "episode_reward_mean": 991.52, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 400.0}, "policy_reward_mean": {"policy_0": 99.152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [989.0, 605.0, 1002.0, 988.0, 783.0, 782.0, 870.0, 907.0, 743.0, 884.0, 1138.0, 920.0, 1053.0, 1252.0, 734.0, 597.0, 956.0, 822.0, 1051.0, 998.0, 965.0, 1152.0, 737.0, 835.0, 1100.0, 1305.0, 1094.0, 927.0, 1103.0, 1238.0, 1222.0, 1200.0, 1010.0, 1222.0, 1112.0, 843.0, 1301.0, 829.0, 1216.0, 1050.0, 1081.0, 1188.0, 980.0, 990.0, 1160.0, 896.0, 920.0, 1139.0, 1052.0, 655.0, 1214.0, 618.0, 775.0, 1155.0, 1270.0, 281.0, 895.0, 878.0, 696.0, 978.0, 939.0, 1095.0, 948.0, 1210.0, 998.0, 1100.0, 1039.0, 1000.0, 919.0, 840.0, 780.0, 1395.0, 1020.0, 917.0, 983.0, 1169.0, 813.0, 680.0, 931.0, 855.0, 1320.0, 980.0, 1008.0, 866.0, 941.0, 1238.0, 1020.0, 1174.0, 630.0, 976.0, 1032.0, 992.0, 1285.0, 700.0, 1210.0, 1260.0, 1304.0, 1010.0, 1140.0, 1079.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 110.0, 60.0, 150.0, 79.0, 130.0, 120.0, 90.0, 90.0, 100.0, 40.0, 80.0, 100.0, 20.0, 30.0, 130.0, 50.0, 40.0, 70.0, 45.0, 130.0, 250.0, 130.0, 39.0, -3.0, 90.0, 110.0, 110.0, 140.0, 6.0, 160.0, 80.0, 120.0, 90.0, 80.0, 50.0, 50.0, 80.0, 108.0, 170.0, 90.0, -8.0, 150.0, 141.0, 50.0, 120.0, 30.0, 80.0, 40.0, 90.0, 120.0, 2.0, 70.0, 140.0, 100.0, -31.0, 100.0, 60.0, 71.0, 150.0, 50.0, 50.0, 160.0, 10.0, 50.0, 170.0, 50.0, 80.0, 80.0, 170.0, 120.0, 160.0, 27.0, 100.0, 6.0, 81.0, 60.0, 90.0, 190.0, 73.0, 130.0, -33.0, 90.0, 190.0, -41.0, 120.0, 70.0, 27.0, 130.0, 60.0, 12.0, 60.0, 100.0, 150.0, 60.0, 80.0, 180.0, 82.0, 70.0, 90.0, 90.0, 170.0, 100.0, 210.0, 180.0, 120.0, 19.0, 39.0, 150.0, 60.0, 60.0, 80.0, 70.0, 130.0, 40.0, 140.0, 100.0, 60.0, 160.0, 80.0, 124.0, 80.0, 70.0, 109.0, 120.0, 60.0, 70.0, 140.0, 100.0, 180.0, 180.0, 120.0, 50.0, 130.0, 115.0, 200.0, 160.0, 100.0, 137.0, 60.0, 89.0, 120.0, 49.0, 50.0, 60.0, 90.0, 80.0, 70.0, 80.0, 46.0, 220.0, 40.0, 100.0, -2.0, 30.0, 15.0, 100.0, 65.0, 79.0, -50.0, 160.0, 80.0, 68.0, 100.0, 110.0, 60.0, 50.0, 90.0, 58.0, 180.0, 80.0, 130.0, 101.0, 60.0, 90.0, 80.0, 50.0, 90.0, 90.0, 51.0, 60.0, 146.0, 100.0, 70.0, 90.0, 80.0, 160.0, 130.0, 160.0, 55.0, 85.0, 72.0, 23.0, 190.0, 80.0, 200.0, 139.0, 119.0, 50.0, 40.0, 170.0, 110.0, 90.0, 110.0, 50.0, 55.0, 60.0, 130.0, 40.0, 150.0, 140.0, 60.0, 100.0, 170.0, 130.0, 128.0, 45.0, 190.0, 69.0, 120.0, 80.0, 39.0, 90.0, 10.0, 70.0, 110.0, 56.0, 100.0, 140.0, 42.0, 70.0, 2.0, 50.0, 140.0, 80.0, 120.0, 20.0, 160.0, 150.0, 43.0, 170.0, 90.0, 140.0, 130.0, 80.0, 80.0, 130.0, 60.0, 50.0, 170.0, 65.0, 40.0, 120.0, 100.0, 150.0, 400.0, 130.0, 110.0, 80.0, 110.0, 140.0, 150.0, 80.0, 70.0, 173.0, 100.0, 90.0, 52.0, 160.0, 79.0, 110.0, 80.0, 150.0, 50.0, 130.0, 130.0, 6.0, 71.0, 110.0, 90.0, 70.0, 150.0, 90.0, 140.0, 240.0, 100.0, 110.0, 66.0, 100.0, 37.0, 80.0, 90.0, 210.0, 143.0, 165.0, 130.0, 180.0, 110.0, 70.0, 60.0, 220.0, 55.0, 120.0, 110.0, 99.0, 120.0, 170.0, 150.0, 68.0, 110.0, 60.0, 110.0, 130.0, 100.0, 80.0, 120.0, 150.0, 160.0, 180.0, 110.0, 140.0, 70.0, 80.0, 70.0, 180.0, 140.0, 110.0, 30.0, 180.0, 10.0, 96.0, 70.0, 80.0, 99.0, 240.0, 220.0, 37.0, 100.0, 130.0, 150.0, 120.0, 200.0, 94.0, 80.0, 120.0, 103.0, 90.0, 95.0, 90.0, 120.0, 40.0, 130.0, 100.0, 47.0, 86.0, 70.0, 130.0, 70.0, 80.0, 90.0, 170.0, 135.0, 150.0, 80.0, 160.0, 211.0, 55.0, 130.0, 60.0, 150.0, 119.0, 45.0, 110.0, 80.0, 9.0, 110.0, 47.0, 100.0, 59.0, 150.0, 100.0, 138.0, 178.0, 70.0, 110.0, 40.0, 80.0, 180.0, 160.0, 160.0, 180.0, 60.0, 120.0, 110.0, 10.0, 140.0, 90.0, 160.0, 100.0, 80.0, 39.0, 150.0, 147.0, 130.0, 100.0, 130.0, 86.0, 39.0, 110.0, 150.0, 60.0, 110.0, 130.0, 110.0, 116.0, 60.0, 100.0, 230.0, 162.0, 110.0, 60.0, 110.0, 70.0, 220.0, 90.0, 60.0, 100.0, 120.0, 90.0, 60.0, 150.0, 100.0, 210.0, 140.0, 140.0, 80.0, 50.0, 30.0, 50.0, 40.0, 230.0, 160.0, 90.0, 150.0, 120.0, 45.0, 120.0, 55.0, 100.0, 90.0, 50.0, 70.0, 100.0, 80.0, 20.0, 80.0, 20.0, 60.0, 244.0, 172.0, 70.0, 110.0, 70.0, 70.0, 30.0, 140.0, 0.0, 180.0, 150.0, 100.0, 143.0, 90.0, 120.0, 79.0, 85.0, 220.0, 100.0, 110.0, 72.0, 120.0, 100.0, 150.0, 190.0, 90.0, 70.0, 40.0, 83.0, 50.0, 100.0, 179.0, 70.0, 29.0, 110.0, 40.0, 66.0, 40.0, 90.0, 50.0, 90.0, 70.0, 70.0, 26.0, 140.0, 200.0, 130.0, 150.0, 130.0, 148.0, 90.0, 130.0, 40.0, 160.0, 50.0, 18.0, 50.0, 90.0, 90.0, 40.0, 65.0, 15.0, 125.0, 60.0, 74.0, 80.0, 97.0, 49.0, 110.0, 90.0, 30.0, 60.0, 50.0, 100.0, 200.0, 150.0, 100.0, 60.0, 140.0, 100.0, 160.0, 95.0, 90.0, 150.0, 80.0, 40.0, 110.0, 240.0, 150.0, 120.0, 140.0, 150.0, 150.0, 35.0, 39.0, 50.0, 36.0, 19.0, 70.0, -103.0, -185.0, 170.0, 140.0, 80.0, 70.0, 121.0, 70.0, 80.0, 87.0, 130.0, 40.0, 77.0, 70.0, 69.0, 109.0, 90.0, 100.0, 140.0, 110.0, 80.0, 30.0, 80.0, 49.0, 1.0, 76.0, 80.0, 40.0, 80.0, 20.0, 100.0, 50.0, 200.0, 80.0, 150.0, 80.0, 160.0, 110.0, 90.0, 60.0, 38.0, 120.0, 90.0, 160.0, 40.0, 140.0, 110.0, 44.0, 60.0, 150.0, 140.0, 25.0, 70.0, 85.0, 20.0, 60.0, 190.0, 160.0, 110.0, 100.0, 100.0, 150.0, 120.0, 190.0, 90.0, 120.0, 80.0, 50.0, 38.0, 40.0, 60.0, 180.0, 100.0, 80.0, 160.0, 100.0, 100.0, 110.0, 230.0, 110.0, 120.0, 170.0, 30.0, 20.0, 132.0, 188.0, 100.0, 170.0, 100.0, 70.0, 31.0, 67.0, 120.0, 70.0, 160.0, 70.0, 150.0, 130.0, 80.0, 90.0, 100.0, 130.0, 120.0, 60.0, 110.0, 120.0, 160.0, 140.0, 120.0, 90.0, 159.0, 85.0, -5.0, 30.0, 21.0, 120.0, 150.0, 160.0, 150.0, 100.0, 140.0, 39.0, 90.0, 55.0, 200.0, 120.0, 70.0, 130.0, 60.0, 110.0, 75.0, 59.0, 40.0, 10.0, 80.0, 50.0, 110.0, 70.0, 60.0, 200.0, 140.0, 40.0, 80.0, 100.0, 160.0, 100.0, 80.0, 120.0, 50.0, 50.0, 50.0, 40.0, 30.0, 230.0, 100.0, 140.0, 90.0, 90.0, 160.0, 200.0, 145.0, 100.0, 140.0, 78.0, 80.0, 110.0, 130.0, 160.0, 82.0, 50.0, 160.0, 50.0, 120.0, 43.0, 200.0, 50.0, 160.0, 110.0, 120.0, 110.0, 34.0, 50.0, 40.0, 60.0, 100.0, 112.0, 130.0, 180.0, 60.0, 20.0, 90.0, 70.0, 161.0, 149.0, 90.0, 60.0, 190.0, 160.0, 70.0, 80.0, 90.0, 190.0, 90.0, 27.0, 100.0, 98.0, 67.0, 70.0, 131.0, 70.0, 80.0, 50.0, 120.0, 90.0, 70.0, 19.0, 160.0, 20.0, 35.0, 36.0, 170.0, 20.0, 60.0, 144.0, 80.0, 50.0, 80.0, 150.0, 60.0, 0.0, 150.0, 127.0, 90.0, 40.0, 90.0, 60.0, 170.0, 110.0, 65.0, 50.0, 50.0, 80.0, 140.0, 170.0, 170.0, 120.0, 80.0, 140.0, 120.0, 110.0, 30.0, 190.0, 190.0, 90.0, 80.0, 110.0, 120.0, 45.0, 80.0, 140.0, 180.0, 15.0, 120.0, 70.0, 76.0, 59.0, 180.0, 140.0, 50.0, 100.0, 170.0, 53.0, 110.0, 90.0, 76.0, 55.0, 80.0, 15.0, 120.0, 80.0, 110.0, 100.0, 140.0, 70.0, 117.0, 190.0, 90.0, 160.0, -26.0, 60.0, 90.0, 110.0, 80.0, 170.0, 130.0, 120.0, 130.0, 160.0, 150.0, 129.0, 89.0, 60.0, 100.0, 130.0, 110.0, 120.0, 80.0, 100.0, 120.0, 90.0, 100.0, 50.0, 120.0, 170.0, 100.0, 70.0, 11.0, 150.0, 58.0, 205.0, 80.0, 110.0, 220.0, 120.0, 52.0, 89.0, 120.0, 53.0, 50.0, 66.0, 21.0, 40.0, 19.0, 74.0, 58.0, 38.0, 135.0, 11.0, 180.0, 210.0, 90.0, 70.0, 110.0, 149.0, 150.0, 60.0, 130.0, 80.0, 96.0, 90.0, 40.0, 40.0, 197.0, 140.0, 49.0, 95.0, 80.0, 120.0, 100.0, 120.0, 90.0, 108.0, 90.0, 110.0, 110.0, 170.0, 120.0, 140.0, 45.0, 160.0, 120.0, 90.0, 220.0, 120.0, 30.0, 40.0, 10.0, 100.0, 150.0, 60.0, 0.0, 140.0, 50.0, 90.0, 120.0, 150.0, 120.0, 20.0, 140.0, 120.0, 150.0, 180.0, 120.0, 50.0, 120.0, 110.0, 160.0, 100.0, 120.0, 110.0, 150.0, 200.0, 140.0, 70.0, 170.0, 180.0, 130.0, 100.0, 88.0, 130.0, 120.0, 146.0, 170.0, 60.0, 90.0, 80.0, 50.0, 170.0, 150.0, 140.0, 110.0, 120.0, 40.0, 200.0, 60.0, 130.0, 80.0, 220.0, 150.0, 120.0, 70.0, 40.0, 70.0, 116.0, 180.0, 160.0, 93.0, 110.0, 90.0, 30.0, 80.0, 120.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7538863182878788, "mean_inference_ms": 1.7619301965640515, "mean_action_processing_ms": 0.5272943846820286, "mean_env_wait_ms": 1.1907997874016956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01302337646484375, "StateBufferConnector_ms": 0.009630441665649414, "ViewRequirementAgentConnector_ms": 0.3768033981323242}, "num_episodes": 18, "episode_return_max": 1395.0, "episode_return_min": 281.0, "episode_return_mean": 991.52}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.66527811794683, "num_env_steps_trained_throughput_per_sec": 20.66527811794683, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 3520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3520000, "timers": {"training_iteration_time_ms": 192947.386, "restore_workers_time_ms": 0.011, "training_step_time_ms": 192947.339, "sample_time_ms": 2253.806, "learn_time_ms": 190674.134, "learn_throughput": 20.978, "synch_weights_time_ms": 10.86}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "done": false, "training_iteration": 88, "trial_id": "1841f_00000", "date": "2024-08-08_04-26-45", "timestamp": 1723105605, "time_this_iter_s": 193.5711269378662, "time_total_s": 18389.59312939644, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b56b24c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18389.59312939644, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.290510948905112, "ram_util_percent": 76.27080291970803}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9586447457409006, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.593389339111864, "policy_loss": -0.01627748074068036, "vf_loss": 8.608029712071687, "vf_explained_var": -0.020686587853172716, "kl": 0.00818546711555319, "entropy": 0.5304130897163964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 831015.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 281.0, "episode_reward_mean": 991.56, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 400.0}, "policy_reward_mean": {"policy_0": 99.156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [737.0, 835.0, 1100.0, 1305.0, 1094.0, 927.0, 1103.0, 1238.0, 1222.0, 1200.0, 1010.0, 1222.0, 1112.0, 843.0, 1301.0, 829.0, 1216.0, 1050.0, 1081.0, 1188.0, 980.0, 990.0, 1160.0, 896.0, 920.0, 1139.0, 1052.0, 655.0, 1214.0, 618.0, 775.0, 1155.0, 1270.0, 281.0, 895.0, 878.0, 696.0, 978.0, 939.0, 1095.0, 948.0, 1210.0, 998.0, 1100.0, 1039.0, 1000.0, 919.0, 840.0, 780.0, 1395.0, 1020.0, 917.0, 983.0, 1169.0, 813.0, 680.0, 931.0, 855.0, 1320.0, 980.0, 1008.0, 866.0, 941.0, 1238.0, 1020.0, 1174.0, 630.0, 976.0, 1032.0, 992.0, 1285.0, 700.0, 1210.0, 1260.0, 1304.0, 1010.0, 1140.0, 1079.0, 1270.0, 825.0, 928.0, 923.0, 690.0, 542.0, 1031.0, 999.0, 781.0, 696.0, 797.0, 1285.0, 985.0, 645.0, 1098.0, 1300.0, 615.0, 1080.0, 880.0, 1030.0, 855.0, 940.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 39.0, 90.0, 10.0, 70.0, 110.0, 56.0, 100.0, 140.0, 42.0, 70.0, 2.0, 50.0, 140.0, 80.0, 120.0, 20.0, 160.0, 150.0, 43.0, 170.0, 90.0, 140.0, 130.0, 80.0, 80.0, 130.0, 60.0, 50.0, 170.0, 65.0, 40.0, 120.0, 100.0, 150.0, 400.0, 130.0, 110.0, 80.0, 110.0, 140.0, 150.0, 80.0, 70.0, 173.0, 100.0, 90.0, 52.0, 160.0, 79.0, 110.0, 80.0, 150.0, 50.0, 130.0, 130.0, 6.0, 71.0, 110.0, 90.0, 70.0, 150.0, 90.0, 140.0, 240.0, 100.0, 110.0, 66.0, 100.0, 37.0, 80.0, 90.0, 210.0, 143.0, 165.0, 130.0, 180.0, 110.0, 70.0, 60.0, 220.0, 55.0, 120.0, 110.0, 99.0, 120.0, 170.0, 150.0, 68.0, 110.0, 60.0, 110.0, 130.0, 100.0, 80.0, 120.0, 150.0, 160.0, 180.0, 110.0, 140.0, 70.0, 80.0, 70.0, 180.0, 140.0, 110.0, 30.0, 180.0, 10.0, 96.0, 70.0, 80.0, 99.0, 240.0, 220.0, 37.0, 100.0, 130.0, 150.0, 120.0, 200.0, 94.0, 80.0, 120.0, 103.0, 90.0, 95.0, 90.0, 120.0, 40.0, 130.0, 100.0, 47.0, 86.0, 70.0, 130.0, 70.0, 80.0, 90.0, 170.0, 135.0, 150.0, 80.0, 160.0, 211.0, 55.0, 130.0, 60.0, 150.0, 119.0, 45.0, 110.0, 80.0, 9.0, 110.0, 47.0, 100.0, 59.0, 150.0, 100.0, 138.0, 178.0, 70.0, 110.0, 40.0, 80.0, 180.0, 160.0, 160.0, 180.0, 60.0, 120.0, 110.0, 10.0, 140.0, 90.0, 160.0, 100.0, 80.0, 39.0, 150.0, 147.0, 130.0, 100.0, 130.0, 86.0, 39.0, 110.0, 150.0, 60.0, 110.0, 130.0, 110.0, 116.0, 60.0, 100.0, 230.0, 162.0, 110.0, 60.0, 110.0, 70.0, 220.0, 90.0, 60.0, 100.0, 120.0, 90.0, 60.0, 150.0, 100.0, 210.0, 140.0, 140.0, 80.0, 50.0, 30.0, 50.0, 40.0, 230.0, 160.0, 90.0, 150.0, 120.0, 45.0, 120.0, 55.0, 100.0, 90.0, 50.0, 70.0, 100.0, 80.0, 20.0, 80.0, 20.0, 60.0, 244.0, 172.0, 70.0, 110.0, 70.0, 70.0, 30.0, 140.0, 0.0, 180.0, 150.0, 100.0, 143.0, 90.0, 120.0, 79.0, 85.0, 220.0, 100.0, 110.0, 72.0, 120.0, 100.0, 150.0, 190.0, 90.0, 70.0, 40.0, 83.0, 50.0, 100.0, 179.0, 70.0, 29.0, 110.0, 40.0, 66.0, 40.0, 90.0, 50.0, 90.0, 70.0, 70.0, 26.0, 140.0, 200.0, 130.0, 150.0, 130.0, 148.0, 90.0, 130.0, 40.0, 160.0, 50.0, 18.0, 50.0, 90.0, 90.0, 40.0, 65.0, 15.0, 125.0, 60.0, 74.0, 80.0, 97.0, 49.0, 110.0, 90.0, 30.0, 60.0, 50.0, 100.0, 200.0, 150.0, 100.0, 60.0, 140.0, 100.0, 160.0, 95.0, 90.0, 150.0, 80.0, 40.0, 110.0, 240.0, 150.0, 120.0, 140.0, 150.0, 150.0, 35.0, 39.0, 50.0, 36.0, 19.0, 70.0, -103.0, -185.0, 170.0, 140.0, 80.0, 70.0, 121.0, 70.0, 80.0, 87.0, 130.0, 40.0, 77.0, 70.0, 69.0, 109.0, 90.0, 100.0, 140.0, 110.0, 80.0, 30.0, 80.0, 49.0, 1.0, 76.0, 80.0, 40.0, 80.0, 20.0, 100.0, 50.0, 200.0, 80.0, 150.0, 80.0, 160.0, 110.0, 90.0, 60.0, 38.0, 120.0, 90.0, 160.0, 40.0, 140.0, 110.0, 44.0, 60.0, 150.0, 140.0, 25.0, 70.0, 85.0, 20.0, 60.0, 190.0, 160.0, 110.0, 100.0, 100.0, 150.0, 120.0, 190.0, 90.0, 120.0, 80.0, 50.0, 38.0, 40.0, 60.0, 180.0, 100.0, 80.0, 160.0, 100.0, 100.0, 110.0, 230.0, 110.0, 120.0, 170.0, 30.0, 20.0, 132.0, 188.0, 100.0, 170.0, 100.0, 70.0, 31.0, 67.0, 120.0, 70.0, 160.0, 70.0, 150.0, 130.0, 80.0, 90.0, 100.0, 130.0, 120.0, 60.0, 110.0, 120.0, 160.0, 140.0, 120.0, 90.0, 159.0, 85.0, -5.0, 30.0, 21.0, 120.0, 150.0, 160.0, 150.0, 100.0, 140.0, 39.0, 90.0, 55.0, 200.0, 120.0, 70.0, 130.0, 60.0, 110.0, 75.0, 59.0, 40.0, 10.0, 80.0, 50.0, 110.0, 70.0, 60.0, 200.0, 140.0, 40.0, 80.0, 100.0, 160.0, 100.0, 80.0, 120.0, 50.0, 50.0, 50.0, 40.0, 30.0, 230.0, 100.0, 140.0, 90.0, 90.0, 160.0, 200.0, 145.0, 100.0, 140.0, 78.0, 80.0, 110.0, 130.0, 160.0, 82.0, 50.0, 160.0, 50.0, 120.0, 43.0, 200.0, 50.0, 160.0, 110.0, 120.0, 110.0, 34.0, 50.0, 40.0, 60.0, 100.0, 112.0, 130.0, 180.0, 60.0, 20.0, 90.0, 70.0, 161.0, 149.0, 90.0, 60.0, 190.0, 160.0, 70.0, 80.0, 90.0, 190.0, 90.0, 27.0, 100.0, 98.0, 67.0, 70.0, 131.0, 70.0, 80.0, 50.0, 120.0, 90.0, 70.0, 19.0, 160.0, 20.0, 35.0, 36.0, 170.0, 20.0, 60.0, 144.0, 80.0, 50.0, 80.0, 150.0, 60.0, 0.0, 150.0, 127.0, 90.0, 40.0, 90.0, 60.0, 170.0, 110.0, 65.0, 50.0, 50.0, 80.0, 140.0, 170.0, 170.0, 120.0, 80.0, 140.0, 120.0, 110.0, 30.0, 190.0, 190.0, 90.0, 80.0, 110.0, 120.0, 45.0, 80.0, 140.0, 180.0, 15.0, 120.0, 70.0, 76.0, 59.0, 180.0, 140.0, 50.0, 100.0, 170.0, 53.0, 110.0, 90.0, 76.0, 55.0, 80.0, 15.0, 120.0, 80.0, 110.0, 100.0, 140.0, 70.0, 117.0, 190.0, 90.0, 160.0, -26.0, 60.0, 90.0, 110.0, 80.0, 170.0, 130.0, 120.0, 130.0, 160.0, 150.0, 129.0, 89.0, 60.0, 100.0, 130.0, 110.0, 120.0, 80.0, 100.0, 120.0, 90.0, 100.0, 50.0, 120.0, 170.0, 100.0, 70.0, 11.0, 150.0, 58.0, 205.0, 80.0, 110.0, 220.0, 120.0, 52.0, 89.0, 120.0, 53.0, 50.0, 66.0, 21.0, 40.0, 19.0, 74.0, 58.0, 38.0, 135.0, 11.0, 180.0, 210.0, 90.0, 70.0, 110.0, 149.0, 150.0, 60.0, 130.0, 80.0, 96.0, 90.0, 40.0, 40.0, 197.0, 140.0, 49.0, 95.0, 80.0, 120.0, 100.0, 120.0, 90.0, 108.0, 90.0, 110.0, 110.0, 170.0, 120.0, 140.0, 45.0, 160.0, 120.0, 90.0, 220.0, 120.0, 30.0, 40.0, 10.0, 100.0, 150.0, 60.0, 0.0, 140.0, 50.0, 90.0, 120.0, 150.0, 120.0, 20.0, 140.0, 120.0, 150.0, 180.0, 120.0, 50.0, 120.0, 110.0, 160.0, 100.0, 120.0, 110.0, 150.0, 200.0, 140.0, 70.0, 170.0, 180.0, 130.0, 100.0, 88.0, 130.0, 120.0, 146.0, 170.0, 60.0, 90.0, 80.0, 50.0, 170.0, 150.0, 140.0, 110.0, 120.0, 40.0, 200.0, 60.0, 130.0, 80.0, 220.0, 150.0, 120.0, 70.0, 40.0, 70.0, 116.0, 180.0, 160.0, 93.0, 110.0, 90.0, 30.0, 80.0, 120.0, 100.0, 40.0, 90.0, 150.0, 210.0, 160.0, 100.0, 220.0, 27.0, 143.0, 130.0, 121.0, 120.0, 80.0, 160.0, 22.0, 82.0, 109.0, 60.0, 120.0, -49.0, 28.0, 150.0, 140.0, 90.0, 90.0, 70.0, 80.0, 150.0, 80.0, 50.0, 60.0, 80.0, 145.0, 109.0, 90.0, 180.0, 39.0, 100.0, 60.0, 60.0, 110.0, 30.0, 90.0, 59.0, 135.0, 40.0, 200.0, 38.0, -120.0, 108.0, 35.0, 73.0, 80.0, 40.0, -115.0, 5.0, 134.0, 120.0, 100.0, 70.0, 50.0, 76.0, 110.0, 80.0, 170.0, 80.0, 180.0, 160.0, 55.0, 70.0, -15.0, 81.0, 120.0, 120.0, 90.0, 268.0, 45.0, 100.0, 80.0, 110.0, 210.0, 120.0, 70.0, 50.0, 69.0, 19.0, 135.0, -71.0, 40.0, 139.0, 52.0, 90.0, 77.0, 120.0, 35.0, 20.0, 30.0, 100.0, 120.0, 52.0, 130.0, 40.0, 80.0, 50.0, 48.0, 180.0, 50.0, 19.0, 100.0, 100.0, 120.0, 140.0, 130.0, 110.0, 160.0, 149.0, 150.0, 138.0, 120.0, 68.0, 178.0, 57.0, 140.0, 200.0, 60.0, 100.0, 70.0, 90.0, 50.0, 40.0, 90.0, 110.0, 28.0, 130.0, 17.0, 100.0, 14.0, 40.0, 110.0, 6.0, 120.0, 80.0, 220.0, 90.0, 100.0, 90.0, 58.0, 130.0, 70.0, 140.0, 120.0, 250.0, 90.0, 80.0, 140.0, 110.0, 100.0, 120.0, 160.0, 130.0, 60.0, 110.0, 120.0, 10.0, 170.0, -105.0, 60.0, 20.0, 20.0, 150.0, 110.0, 60.0, 85.0, 105.0, 60.0, 90.0, 120.0, 140.0, 170.0, 140.0, 110.0, 0.0, -25.0, 80.0, 195.0, 100.0, 150.0, 50.0, 110.0, 110.0, 10.0, 140.0, 100.0, 150.0, 180.0, 60.0, 40.0, 150.0, 160.0, 40.0, 180.0, 100.0, 50.0, 140.0, 60.0, 30.0, 60.0, 90.0, 35.0, 110.0, 140.0, 40.0, 120.0, 130.0, 80.0, 100.0, 100.0, 90.0, 50.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7510408040122893, "mean_inference_ms": 1.7584176271261318, "mean_action_processing_ms": 0.5261371472717985, "mean_env_wait_ms": 1.1875344139479147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012466907501220703, "StateBufferConnector_ms": 0.009474515914916992, "ViewRequirementAgentConnector_ms": 0.36859822273254395}, "num_episodes": 22, "episode_return_max": 1395.0, "episode_return_min": 281.0, "episode_return_mean": 991.56}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.683511462178107, "num_env_steps_trained_throughput_per_sec": 20.683511462178107, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 3560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3560000, "timers": {"training_iteration_time_ms": 192924.577, "restore_workers_time_ms": 0.011, "training_step_time_ms": 192924.531, "sample_time_ms": 2272.318, "learn_time_ms": 190632.879, "learn_throughput": 20.983, "synch_weights_time_ms": 10.841}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "done": false, "training_iteration": 89, "trial_id": "1841f_00000", "date": "2024-08-08_04-29-59", "timestamp": 1723105799, "time_this_iter_s": 193.40200924873352, "time_total_s": 18582.995138645172, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b56b2c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18582.995138645172, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.07992700729927, "ram_util_percent": 76.88941605839415}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1016323018124816, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.39789617358686, "policy_loss": -0.014784941892337979, "vf_loss": 8.411182329525202, "vf_explained_var": -0.0007633347544299401, "kl": 0.007493904490613617, "entropy": 0.5493278077933481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 840405.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 281.0, "episode_reward_mean": 961.11, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 96.111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1081.0, 1188.0, 980.0, 990.0, 1160.0, 896.0, 920.0, 1139.0, 1052.0, 655.0, 1214.0, 618.0, 775.0, 1155.0, 1270.0, 281.0, 895.0, 878.0, 696.0, 978.0, 939.0, 1095.0, 948.0, 1210.0, 998.0, 1100.0, 1039.0, 1000.0, 919.0, 840.0, 780.0, 1395.0, 1020.0, 917.0, 983.0, 1169.0, 813.0, 680.0, 931.0, 855.0, 1320.0, 980.0, 1008.0, 866.0, 941.0, 1238.0, 1020.0, 1174.0, 630.0, 976.0, 1032.0, 992.0, 1285.0, 700.0, 1210.0, 1260.0, 1304.0, 1010.0, 1140.0, 1079.0, 1270.0, 825.0, 928.0, 923.0, 690.0, 542.0, 1031.0, 999.0, 781.0, 696.0, 797.0, 1285.0, 985.0, 645.0, 1098.0, 1300.0, 615.0, 1080.0, 880.0, 1030.0, 855.0, 940.0, 866.0, 700.0, 1340.0, 930.0, 1000.0, 946.0, 773.0, 637.0, 1052.0, 1040.0, 1210.0, 1288.0, 558.0, 675.0, 934.0, 946.0, 832.0, 572.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [39.0, 150.0, 147.0, 130.0, 100.0, 130.0, 86.0, 39.0, 110.0, 150.0, 60.0, 110.0, 130.0, 110.0, 116.0, 60.0, 100.0, 230.0, 162.0, 110.0, 60.0, 110.0, 70.0, 220.0, 90.0, 60.0, 100.0, 120.0, 90.0, 60.0, 150.0, 100.0, 210.0, 140.0, 140.0, 80.0, 50.0, 30.0, 50.0, 40.0, 230.0, 160.0, 90.0, 150.0, 120.0, 45.0, 120.0, 55.0, 100.0, 90.0, 50.0, 70.0, 100.0, 80.0, 20.0, 80.0, 20.0, 60.0, 244.0, 172.0, 70.0, 110.0, 70.0, 70.0, 30.0, 140.0, 0.0, 180.0, 150.0, 100.0, 143.0, 90.0, 120.0, 79.0, 85.0, 220.0, 100.0, 110.0, 72.0, 120.0, 100.0, 150.0, 190.0, 90.0, 70.0, 40.0, 83.0, 50.0, 100.0, 179.0, 70.0, 29.0, 110.0, 40.0, 66.0, 40.0, 90.0, 50.0, 90.0, 70.0, 70.0, 26.0, 140.0, 200.0, 130.0, 150.0, 130.0, 148.0, 90.0, 130.0, 40.0, 160.0, 50.0, 18.0, 50.0, 90.0, 90.0, 40.0, 65.0, 15.0, 125.0, 60.0, 74.0, 80.0, 97.0, 49.0, 110.0, 90.0, 30.0, 60.0, 50.0, 100.0, 200.0, 150.0, 100.0, 60.0, 140.0, 100.0, 160.0, 95.0, 90.0, 150.0, 80.0, 40.0, 110.0, 240.0, 150.0, 120.0, 140.0, 150.0, 150.0, 35.0, 39.0, 50.0, 36.0, 19.0, 70.0, -103.0, -185.0, 170.0, 140.0, 80.0, 70.0, 121.0, 70.0, 80.0, 87.0, 130.0, 40.0, 77.0, 70.0, 69.0, 109.0, 90.0, 100.0, 140.0, 110.0, 80.0, 30.0, 80.0, 49.0, 1.0, 76.0, 80.0, 40.0, 80.0, 20.0, 100.0, 50.0, 200.0, 80.0, 150.0, 80.0, 160.0, 110.0, 90.0, 60.0, 38.0, 120.0, 90.0, 160.0, 40.0, 140.0, 110.0, 44.0, 60.0, 150.0, 140.0, 25.0, 70.0, 85.0, 20.0, 60.0, 190.0, 160.0, 110.0, 100.0, 100.0, 150.0, 120.0, 190.0, 90.0, 120.0, 80.0, 50.0, 38.0, 40.0, 60.0, 180.0, 100.0, 80.0, 160.0, 100.0, 100.0, 110.0, 230.0, 110.0, 120.0, 170.0, 30.0, 20.0, 132.0, 188.0, 100.0, 170.0, 100.0, 70.0, 31.0, 67.0, 120.0, 70.0, 160.0, 70.0, 150.0, 130.0, 80.0, 90.0, 100.0, 130.0, 120.0, 60.0, 110.0, 120.0, 160.0, 140.0, 120.0, 90.0, 159.0, 85.0, -5.0, 30.0, 21.0, 120.0, 150.0, 160.0, 150.0, 100.0, 140.0, 39.0, 90.0, 55.0, 200.0, 120.0, 70.0, 130.0, 60.0, 110.0, 75.0, 59.0, 40.0, 10.0, 80.0, 50.0, 110.0, 70.0, 60.0, 200.0, 140.0, 40.0, 80.0, 100.0, 160.0, 100.0, 80.0, 120.0, 50.0, 50.0, 50.0, 40.0, 30.0, 230.0, 100.0, 140.0, 90.0, 90.0, 160.0, 200.0, 145.0, 100.0, 140.0, 78.0, 80.0, 110.0, 130.0, 160.0, 82.0, 50.0, 160.0, 50.0, 120.0, 43.0, 200.0, 50.0, 160.0, 110.0, 120.0, 110.0, 34.0, 50.0, 40.0, 60.0, 100.0, 112.0, 130.0, 180.0, 60.0, 20.0, 90.0, 70.0, 161.0, 149.0, 90.0, 60.0, 190.0, 160.0, 70.0, 80.0, 90.0, 190.0, 90.0, 27.0, 100.0, 98.0, 67.0, 70.0, 131.0, 70.0, 80.0, 50.0, 120.0, 90.0, 70.0, 19.0, 160.0, 20.0, 35.0, 36.0, 170.0, 20.0, 60.0, 144.0, 80.0, 50.0, 80.0, 150.0, 60.0, 0.0, 150.0, 127.0, 90.0, 40.0, 90.0, 60.0, 170.0, 110.0, 65.0, 50.0, 50.0, 80.0, 140.0, 170.0, 170.0, 120.0, 80.0, 140.0, 120.0, 110.0, 30.0, 190.0, 190.0, 90.0, 80.0, 110.0, 120.0, 45.0, 80.0, 140.0, 180.0, 15.0, 120.0, 70.0, 76.0, 59.0, 180.0, 140.0, 50.0, 100.0, 170.0, 53.0, 110.0, 90.0, 76.0, 55.0, 80.0, 15.0, 120.0, 80.0, 110.0, 100.0, 140.0, 70.0, 117.0, 190.0, 90.0, 160.0, -26.0, 60.0, 90.0, 110.0, 80.0, 170.0, 130.0, 120.0, 130.0, 160.0, 150.0, 129.0, 89.0, 60.0, 100.0, 130.0, 110.0, 120.0, 80.0, 100.0, 120.0, 90.0, 100.0, 50.0, 120.0, 170.0, 100.0, 70.0, 11.0, 150.0, 58.0, 205.0, 80.0, 110.0, 220.0, 120.0, 52.0, 89.0, 120.0, 53.0, 50.0, 66.0, 21.0, 40.0, 19.0, 74.0, 58.0, 38.0, 135.0, 11.0, 180.0, 210.0, 90.0, 70.0, 110.0, 149.0, 150.0, 60.0, 130.0, 80.0, 96.0, 90.0, 40.0, 40.0, 197.0, 140.0, 49.0, 95.0, 80.0, 120.0, 100.0, 120.0, 90.0, 108.0, 90.0, 110.0, 110.0, 170.0, 120.0, 140.0, 45.0, 160.0, 120.0, 90.0, 220.0, 120.0, 30.0, 40.0, 10.0, 100.0, 150.0, 60.0, 0.0, 140.0, 50.0, 90.0, 120.0, 150.0, 120.0, 20.0, 140.0, 120.0, 150.0, 180.0, 120.0, 50.0, 120.0, 110.0, 160.0, 100.0, 120.0, 110.0, 150.0, 200.0, 140.0, 70.0, 170.0, 180.0, 130.0, 100.0, 88.0, 130.0, 120.0, 146.0, 170.0, 60.0, 90.0, 80.0, 50.0, 170.0, 150.0, 140.0, 110.0, 120.0, 40.0, 200.0, 60.0, 130.0, 80.0, 220.0, 150.0, 120.0, 70.0, 40.0, 70.0, 116.0, 180.0, 160.0, 93.0, 110.0, 90.0, 30.0, 80.0, 120.0, 100.0, 40.0, 90.0, 150.0, 210.0, 160.0, 100.0, 220.0, 27.0, 143.0, 130.0, 121.0, 120.0, 80.0, 160.0, 22.0, 82.0, 109.0, 60.0, 120.0, -49.0, 28.0, 150.0, 140.0, 90.0, 90.0, 70.0, 80.0, 150.0, 80.0, 50.0, 60.0, 80.0, 145.0, 109.0, 90.0, 180.0, 39.0, 100.0, 60.0, 60.0, 110.0, 30.0, 90.0, 59.0, 135.0, 40.0, 200.0, 38.0, -120.0, 108.0, 35.0, 73.0, 80.0, 40.0, -115.0, 5.0, 134.0, 120.0, 100.0, 70.0, 50.0, 76.0, 110.0, 80.0, 170.0, 80.0, 180.0, 160.0, 55.0, 70.0, -15.0, 81.0, 120.0, 120.0, 90.0, 268.0, 45.0, 100.0, 80.0, 110.0, 210.0, 120.0, 70.0, 50.0, 69.0, 19.0, 135.0, -71.0, 40.0, 139.0, 52.0, 90.0, 77.0, 120.0, 35.0, 20.0, 30.0, 100.0, 120.0, 52.0, 130.0, 40.0, 80.0, 50.0, 48.0, 180.0, 50.0, 19.0, 100.0, 100.0, 120.0, 140.0, 130.0, 110.0, 160.0, 149.0, 150.0, 138.0, 120.0, 68.0, 178.0, 57.0, 140.0, 200.0, 60.0, 100.0, 70.0, 90.0, 50.0, 40.0, 90.0, 110.0, 28.0, 130.0, 17.0, 100.0, 14.0, 40.0, 110.0, 6.0, 120.0, 80.0, 220.0, 90.0, 100.0, 90.0, 58.0, 130.0, 70.0, 140.0, 120.0, 250.0, 90.0, 80.0, 140.0, 110.0, 100.0, 120.0, 160.0, 130.0, 60.0, 110.0, 120.0, 10.0, 170.0, -105.0, 60.0, 20.0, 20.0, 150.0, 110.0, 60.0, 85.0, 105.0, 60.0, 90.0, 120.0, 140.0, 170.0, 140.0, 110.0, 0.0, -25.0, 80.0, 195.0, 100.0, 150.0, 50.0, 110.0, 110.0, 10.0, 140.0, 100.0, 150.0, 180.0, 60.0, 40.0, 150.0, 160.0, 40.0, 180.0, 100.0, 50.0, 140.0, 60.0, 30.0, 60.0, 90.0, 35.0, 110.0, 140.0, 40.0, 120.0, 130.0, 80.0, 100.0, 100.0, 90.0, 50.0, 90.0, 218.0, 68.0, 40.0, 101.0, 80.0, 170.0, 58.0, 93.0, 13.0, 25.0, 150.0, 20.0, 100.0, 60.0, 70.0, 120.0, 70.0, 50.0, 20.0, 40.0, 11.0, 110.0, 153.0, 138.0, 80.0, 170.0, 200.0, 280.0, 80.0, 118.0, 50.0, 110.0, 90.0, 100.0, 90.0, 90.0, 50.0, 110.0, 110.0, 130.0, 70.0, 140.0, 110.0, 150.0, 90.0, 110.0, 100.0, 110.0, 60.0, 60.0, -31.0, 107.0, 150.0, 1.0, 140.0, 130.0, 130.0, 79.0, 150.0, 90.0, 100.0, 26.0, 60.0, 140.0, 60.0, 40.0, 140.0, 110.0, 80.0, 17.0, 0.0, 70.0, 20.0, 44.0, 4.0, 120.0, 70.0, 20.0, 59.0, 230.0, 100.0, 73.0, 130.0, 109.0, 100.0, 110.0, 130.0, 50.0, 160.0, 90.0, 73.0, 68.0, 140.0, 90.0, 50.0, 140.0, 159.0, 130.0, 70.0, 120.0, 60.0, 150.0, 100.0, 90.0, 93.0, 110.0, 230.0, 130.0, 148.0, 99.0, 240.0, 100.0, 100.0, 50.0, 160.0, 80.0, 69.0, 129.0, 210.0, 150.0, 68.0, 80.0, 50.0, 50.0, 60.0, 50.0, 88.0, 34.0, 90.0, -12.0, 80.0, -7.0, 60.0, 140.0, 100.0, 105.0, 30.0, 80.0, 62.0, 25.0, 100.0, 100.0, 63.0, 20.0, 110.0, 190.0, 110.0, 100.0, 110.0, 31.0, 150.0, 100.0, 68.0, 140.0, 48.0, 80.0, 60.0, 110.0, 100.0, 90.0, 80.0, 150.0, 70.0, 90.0, 57.0, 70.0, 69.0, 6.0, 170.0, 70.0, 50.0, 92.0, 40.0, 76.0, 36.0, 78.0, 45.0, 10.0, 30.0, 115.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7474864525774467, "mean_inference_ms": 1.7531974245214734, "mean_action_processing_ms": 0.5251079646954819, "mean_env_wait_ms": 1.185622971618056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01196908950805664, "StateBufferConnector_ms": 0.009378433227539062, "ViewRequirementAgentConnector_ms": 0.3652777671813965}, "num_episodes": 18, "episode_return_max": 1395.0, "episode_return_min": 281.0, "episode_return_mean": 961.11}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.667381449677677, "num_env_steps_trained_throughput_per_sec": 20.667381449677677, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 3600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3600000, "timers": {"training_iteration_time_ms": 192933.973, "restore_workers_time_ms": 0.011, "training_step_time_ms": 192933.928, "sample_time_ms": 2275.527, "learn_time_ms": 190638.783, "learn_throughput": 20.982, "synch_weights_time_ms": 11.137}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "done": false, "training_iteration": 90, "trial_id": "1841f_00000", "date": "2024-08-08_04-33-12", "timestamp": 1723105992, "time_this_iter_s": 193.5499758720398, "time_total_s": 18776.545114517212, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b56b2ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18776.545114517212, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 17.56336996336996, "ram_util_percent": 76.68791208791208}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7568813860035553, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.27635198436733, "policy_loss": -0.015141269911345416, "vf_loss": 8.289919613065303, "vf_explained_var": -0.006307894581803879, "kl": 0.007868187880261439, "entropy": 0.5512745027629712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 849795.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "env_runners": {"episode_reward_max": 1395.0, "episode_reward_min": 537.0, "episode_reward_mean": 960.63, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 96.063}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1210.0, 998.0, 1100.0, 1039.0, 1000.0, 919.0, 840.0, 780.0, 1395.0, 1020.0, 917.0, 983.0, 1169.0, 813.0, 680.0, 931.0, 855.0, 1320.0, 980.0, 1008.0, 866.0, 941.0, 1238.0, 1020.0, 1174.0, 630.0, 976.0, 1032.0, 992.0, 1285.0, 700.0, 1210.0, 1260.0, 1304.0, 1010.0, 1140.0, 1079.0, 1270.0, 825.0, 928.0, 923.0, 690.0, 542.0, 1031.0, 999.0, 781.0, 696.0, 797.0, 1285.0, 985.0, 645.0, 1098.0, 1300.0, 615.0, 1080.0, 880.0, 1030.0, 855.0, 940.0, 866.0, 700.0, 1340.0, 930.0, 1000.0, 946.0, 773.0, 637.0, 1052.0, 1040.0, 1210.0, 1288.0, 558.0, 675.0, 934.0, 946.0, 832.0, 572.0, 890.0, 750.0, 758.0, 903.0, 537.0, 725.0, 967.0, 961.0, 866.0, 960.0, 1176.0, 969.0, 1080.0, 769.0, 965.0, 949.0, 1128.0, 940.0, 1282.0, 1377.0, 701.0, 907.0, 1195.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 160.0, 100.0, 100.0, 110.0, 230.0, 110.0, 120.0, 170.0, 30.0, 20.0, 132.0, 188.0, 100.0, 170.0, 100.0, 70.0, 31.0, 67.0, 120.0, 70.0, 160.0, 70.0, 150.0, 130.0, 80.0, 90.0, 100.0, 130.0, 120.0, 60.0, 110.0, 120.0, 160.0, 140.0, 120.0, 90.0, 159.0, 85.0, -5.0, 30.0, 21.0, 120.0, 150.0, 160.0, 150.0, 100.0, 140.0, 39.0, 90.0, 55.0, 200.0, 120.0, 70.0, 130.0, 60.0, 110.0, 75.0, 59.0, 40.0, 10.0, 80.0, 50.0, 110.0, 70.0, 60.0, 200.0, 140.0, 40.0, 80.0, 100.0, 160.0, 100.0, 80.0, 120.0, 50.0, 50.0, 50.0, 40.0, 30.0, 230.0, 100.0, 140.0, 90.0, 90.0, 160.0, 200.0, 145.0, 100.0, 140.0, 78.0, 80.0, 110.0, 130.0, 160.0, 82.0, 50.0, 160.0, 50.0, 120.0, 43.0, 200.0, 50.0, 160.0, 110.0, 120.0, 110.0, 34.0, 50.0, 40.0, 60.0, 100.0, 112.0, 130.0, 180.0, 60.0, 20.0, 90.0, 70.0, 161.0, 149.0, 90.0, 60.0, 190.0, 160.0, 70.0, 80.0, 90.0, 190.0, 90.0, 27.0, 100.0, 98.0, 67.0, 70.0, 131.0, 70.0, 80.0, 50.0, 120.0, 90.0, 70.0, 19.0, 160.0, 20.0, 35.0, 36.0, 170.0, 20.0, 60.0, 144.0, 80.0, 50.0, 80.0, 150.0, 60.0, 0.0, 150.0, 127.0, 90.0, 40.0, 90.0, 60.0, 170.0, 110.0, 65.0, 50.0, 50.0, 80.0, 140.0, 170.0, 170.0, 120.0, 80.0, 140.0, 120.0, 110.0, 30.0, 190.0, 190.0, 90.0, 80.0, 110.0, 120.0, 45.0, 80.0, 140.0, 180.0, 15.0, 120.0, 70.0, 76.0, 59.0, 180.0, 140.0, 50.0, 100.0, 170.0, 53.0, 110.0, 90.0, 76.0, 55.0, 80.0, 15.0, 120.0, 80.0, 110.0, 100.0, 140.0, 70.0, 117.0, 190.0, 90.0, 160.0, -26.0, 60.0, 90.0, 110.0, 80.0, 170.0, 130.0, 120.0, 130.0, 160.0, 150.0, 129.0, 89.0, 60.0, 100.0, 130.0, 110.0, 120.0, 80.0, 100.0, 120.0, 90.0, 100.0, 50.0, 120.0, 170.0, 100.0, 70.0, 11.0, 150.0, 58.0, 205.0, 80.0, 110.0, 220.0, 120.0, 52.0, 89.0, 120.0, 53.0, 50.0, 66.0, 21.0, 40.0, 19.0, 74.0, 58.0, 38.0, 135.0, 11.0, 180.0, 210.0, 90.0, 70.0, 110.0, 149.0, 150.0, 60.0, 130.0, 80.0, 96.0, 90.0, 40.0, 40.0, 197.0, 140.0, 49.0, 95.0, 80.0, 120.0, 100.0, 120.0, 90.0, 108.0, 90.0, 110.0, 110.0, 170.0, 120.0, 140.0, 45.0, 160.0, 120.0, 90.0, 220.0, 120.0, 30.0, 40.0, 10.0, 100.0, 150.0, 60.0, 0.0, 140.0, 50.0, 90.0, 120.0, 150.0, 120.0, 20.0, 140.0, 120.0, 150.0, 180.0, 120.0, 50.0, 120.0, 110.0, 160.0, 100.0, 120.0, 110.0, 150.0, 200.0, 140.0, 70.0, 170.0, 180.0, 130.0, 100.0, 88.0, 130.0, 120.0, 146.0, 170.0, 60.0, 90.0, 80.0, 50.0, 170.0, 150.0, 140.0, 110.0, 120.0, 40.0, 200.0, 60.0, 130.0, 80.0, 220.0, 150.0, 120.0, 70.0, 40.0, 70.0, 116.0, 180.0, 160.0, 93.0, 110.0, 90.0, 30.0, 80.0, 120.0, 100.0, 40.0, 90.0, 150.0, 210.0, 160.0, 100.0, 220.0, 27.0, 143.0, 130.0, 121.0, 120.0, 80.0, 160.0, 22.0, 82.0, 109.0, 60.0, 120.0, -49.0, 28.0, 150.0, 140.0, 90.0, 90.0, 70.0, 80.0, 150.0, 80.0, 50.0, 60.0, 80.0, 145.0, 109.0, 90.0, 180.0, 39.0, 100.0, 60.0, 60.0, 110.0, 30.0, 90.0, 59.0, 135.0, 40.0, 200.0, 38.0, -120.0, 108.0, 35.0, 73.0, 80.0, 40.0, -115.0, 5.0, 134.0, 120.0, 100.0, 70.0, 50.0, 76.0, 110.0, 80.0, 170.0, 80.0, 180.0, 160.0, 55.0, 70.0, -15.0, 81.0, 120.0, 120.0, 90.0, 268.0, 45.0, 100.0, 80.0, 110.0, 210.0, 120.0, 70.0, 50.0, 69.0, 19.0, 135.0, -71.0, 40.0, 139.0, 52.0, 90.0, 77.0, 120.0, 35.0, 20.0, 30.0, 100.0, 120.0, 52.0, 130.0, 40.0, 80.0, 50.0, 48.0, 180.0, 50.0, 19.0, 100.0, 100.0, 120.0, 140.0, 130.0, 110.0, 160.0, 149.0, 150.0, 138.0, 120.0, 68.0, 178.0, 57.0, 140.0, 200.0, 60.0, 100.0, 70.0, 90.0, 50.0, 40.0, 90.0, 110.0, 28.0, 130.0, 17.0, 100.0, 14.0, 40.0, 110.0, 6.0, 120.0, 80.0, 220.0, 90.0, 100.0, 90.0, 58.0, 130.0, 70.0, 140.0, 120.0, 250.0, 90.0, 80.0, 140.0, 110.0, 100.0, 120.0, 160.0, 130.0, 60.0, 110.0, 120.0, 10.0, 170.0, -105.0, 60.0, 20.0, 20.0, 150.0, 110.0, 60.0, 85.0, 105.0, 60.0, 90.0, 120.0, 140.0, 170.0, 140.0, 110.0, 0.0, -25.0, 80.0, 195.0, 100.0, 150.0, 50.0, 110.0, 110.0, 10.0, 140.0, 100.0, 150.0, 180.0, 60.0, 40.0, 150.0, 160.0, 40.0, 180.0, 100.0, 50.0, 140.0, 60.0, 30.0, 60.0, 90.0, 35.0, 110.0, 140.0, 40.0, 120.0, 130.0, 80.0, 100.0, 100.0, 90.0, 50.0, 90.0, 218.0, 68.0, 40.0, 101.0, 80.0, 170.0, 58.0, 93.0, 13.0, 25.0, 150.0, 20.0, 100.0, 60.0, 70.0, 120.0, 70.0, 50.0, 20.0, 40.0, 11.0, 110.0, 153.0, 138.0, 80.0, 170.0, 200.0, 280.0, 80.0, 118.0, 50.0, 110.0, 90.0, 100.0, 90.0, 90.0, 50.0, 110.0, 110.0, 130.0, 70.0, 140.0, 110.0, 150.0, 90.0, 110.0, 100.0, 110.0, 60.0, 60.0, -31.0, 107.0, 150.0, 1.0, 140.0, 130.0, 130.0, 79.0, 150.0, 90.0, 100.0, 26.0, 60.0, 140.0, 60.0, 40.0, 140.0, 110.0, 80.0, 17.0, 0.0, 70.0, 20.0, 44.0, 4.0, 120.0, 70.0, 20.0, 59.0, 230.0, 100.0, 73.0, 130.0, 109.0, 100.0, 110.0, 130.0, 50.0, 160.0, 90.0, 73.0, 68.0, 140.0, 90.0, 50.0, 140.0, 159.0, 130.0, 70.0, 120.0, 60.0, 150.0, 100.0, 90.0, 93.0, 110.0, 230.0, 130.0, 148.0, 99.0, 240.0, 100.0, 100.0, 50.0, 160.0, 80.0, 69.0, 129.0, 210.0, 150.0, 68.0, 80.0, 50.0, 50.0, 60.0, 50.0, 88.0, 34.0, 90.0, -12.0, 80.0, -7.0, 60.0, 140.0, 100.0, 105.0, 30.0, 80.0, 62.0, 25.0, 100.0, 100.0, 63.0, 20.0, 110.0, 190.0, 110.0, 100.0, 110.0, 31.0, 150.0, 100.0, 68.0, 140.0, 48.0, 80.0, 60.0, 110.0, 100.0, 90.0, 80.0, 150.0, 70.0, 90.0, 57.0, 70.0, 69.0, 6.0, 170.0, 70.0, 50.0, 92.0, 40.0, 76.0, 36.0, 78.0, 45.0, 10.0, 30.0, 115.0, 100.0, 130.0, 10.0, 60.0, 190.0, 110.0, 30.0, 70.0, 50.0, 140.0, 50.0, 130.0, 110.0, 60.0, 60.0, 50.0, 10.0, 90.0, 180.0, 10.0, 150.0, 104.0, 60.0, 64.0, 50.0, 130.0, 30.0, 90.0, 40.0, 40.0, 70.0, 80.0, 131.0, 120.0, 160.0, 110.0, 40.0, 90.0, 2.0, 100.0, 70.0, 30.0, 70.0, -5.0, 55.0, 9.0, 90.0, 90.0, 78.0, 50.0, 30.0, 90.0, 50.0, 140.0, 50.0, 170.0, 30.0, 15.0, 60.0, 90.0, 98.0, 80.0, 100.0, 220.0, 40.0, 70.0, 99.0, 140.0, 60.0, 60.0, 177.0, 50.0, 60.0, 13.0, 110.0, 80.0, 115.0, 210.0, 100.0, 46.0, 200.0, 130.0, 80.0, 75.0, 79.0, 75.0, 37.0, 102.0, 48.0, 40.0, 41.0, 90.0, 153.0, 140.0, 109.0, 130.0, 30.0, 80.0, 57.0, 130.0, 40.0, 230.0, 150.0, 113.0, 120.0, 140.0, 140.0, 23.0, 80.0, 140.0, 157.0, 37.0, 90.0, 130.0, 100.0, 210.0, 117.0, 40.0, 40.0, 48.0, 30.0, 180.0, 140.0, 50.0, 80.0, 80.0, 120.0, 190.0, 120.0, 90.0, 159.0, 80.0, 60.0, 30.0, 120.0, 110.0, 80.0, 40.0, 70.0, 20.0, 55.0, 140.0, 120.0, 20.0, 40.0, 80.0, 110.0, 220.0, 140.0, 40.0, 50.0, 169.0, 90.0, 40.0, 40.0, 50.0, 130.0, 70.0, 180.0, 130.0, 40.0, 150.0, 14.0, 104.0, 70.0, 250.0, 140.0, 80.0, 150.0, 130.0, 70.0, 50.0, 90.0, 240.0, 60.0, 90.0, 80.0, 80.0, 80.0, 100.0, 130.0, 130.0, 219.0, 190.0, 150.0, 69.0, 69.0, 130.0, 75.0, 120.0, 190.0, 160.0, 173.0, 40.0, 166.0, 100.0, 170.0, 100.0, 100.0, 178.0, 60.0, 130.0, 70.0, 20.0, 60.0, 70.0, 3.0, 50.0, 110.0, 128.0, 102.0, -9.0, 41.0, 65.0, 168.0, 130.0, 80.0, 50.0, 110.0, 170.0, 50.0, 120.0, 120.0, 190.0, 210.0, 130.0, 25.0, 90.0, 110.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.74306636030777, "mean_inference_ms": 1.747798936321538, "mean_action_processing_ms": 0.5231980664123789, "mean_env_wait_ms": 1.1833332799581862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012039422988891602, "StateBufferConnector_ms": 0.009363174438476562, "ViewRequirementAgentConnector_ms": 0.3783111572265625}, "num_episodes": 23, "episode_return_max": 1395.0, "episode_return_min": 537.0, "episode_return_mean": 960.63}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.633265898952537, "num_env_steps_trained_throughput_per_sec": 20.633265898952537, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 3640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3640000, "timers": {"training_iteration_time_ms": 193058.813, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193058.768, "sample_time_ms": 2280.382, "learn_time_ms": 190758.81, "learn_throughput": 20.969, "synch_weights_time_ms": 10.938}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "done": false, "training_iteration": 91, "trial_id": "1841f_00000", "date": "2024-08-08_04-36-26", "timestamp": 1723106186, "time_this_iter_s": 193.8713719844818, "time_total_s": 18970.416486501694, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b56a1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18970.416486501694, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 16.818545454545458, "ram_util_percent": 77.57927272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.650630405713448, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.55508407083944, "policy_loss": -0.01576679756446356, "vf_loss": 8.569198656589966, "vf_explained_var": -0.026633464877470866, "kl": 0.008261152449344823, "entropy": 0.5127309073337986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 859185.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "env_runners": {"episode_reward_max": 1377.0, "episode_reward_min": 537.0, "episode_reward_mean": 954.92, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 95.492}, "custom_metrics": {}, "hist_stats": {"episode_reward": [980.0, 1008.0, 866.0, 941.0, 1238.0, 1020.0, 1174.0, 630.0, 976.0, 1032.0, 992.0, 1285.0, 700.0, 1210.0, 1260.0, 1304.0, 1010.0, 1140.0, 1079.0, 1270.0, 825.0, 928.0, 923.0, 690.0, 542.0, 1031.0, 999.0, 781.0, 696.0, 797.0, 1285.0, 985.0, 645.0, 1098.0, 1300.0, 615.0, 1080.0, 880.0, 1030.0, 855.0, 940.0, 866.0, 700.0, 1340.0, 930.0, 1000.0, 946.0, 773.0, 637.0, 1052.0, 1040.0, 1210.0, 1288.0, 558.0, 675.0, 934.0, 946.0, 832.0, 572.0, 890.0, 750.0, 758.0, 903.0, 537.0, 725.0, 967.0, 961.0, 866.0, 960.0, 1176.0, 969.0, 1080.0, 769.0, 965.0, 949.0, 1128.0, 940.0, 1282.0, 1377.0, 701.0, 907.0, 1195.0, 1218.0, 1220.0, 955.0, 1163.0, 693.0, 1114.0, 987.0, 911.0, 705.0, 747.0, 1080.0, 895.0, 1342.0, 1152.0, 1052.0, 573.0, 844.0, 747.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 80.0, 110.0, 120.0, 45.0, 80.0, 140.0, 180.0, 15.0, 120.0, 70.0, 76.0, 59.0, 180.0, 140.0, 50.0, 100.0, 170.0, 53.0, 110.0, 90.0, 76.0, 55.0, 80.0, 15.0, 120.0, 80.0, 110.0, 100.0, 140.0, 70.0, 117.0, 190.0, 90.0, 160.0, -26.0, 60.0, 90.0, 110.0, 80.0, 170.0, 130.0, 120.0, 130.0, 160.0, 150.0, 129.0, 89.0, 60.0, 100.0, 130.0, 110.0, 120.0, 80.0, 100.0, 120.0, 90.0, 100.0, 50.0, 120.0, 170.0, 100.0, 70.0, 11.0, 150.0, 58.0, 205.0, 80.0, 110.0, 220.0, 120.0, 52.0, 89.0, 120.0, 53.0, 50.0, 66.0, 21.0, 40.0, 19.0, 74.0, 58.0, 38.0, 135.0, 11.0, 180.0, 210.0, 90.0, 70.0, 110.0, 149.0, 150.0, 60.0, 130.0, 80.0, 96.0, 90.0, 40.0, 40.0, 197.0, 140.0, 49.0, 95.0, 80.0, 120.0, 100.0, 120.0, 90.0, 108.0, 90.0, 110.0, 110.0, 170.0, 120.0, 140.0, 45.0, 160.0, 120.0, 90.0, 220.0, 120.0, 30.0, 40.0, 10.0, 100.0, 150.0, 60.0, 0.0, 140.0, 50.0, 90.0, 120.0, 150.0, 120.0, 20.0, 140.0, 120.0, 150.0, 180.0, 120.0, 50.0, 120.0, 110.0, 160.0, 100.0, 120.0, 110.0, 150.0, 200.0, 140.0, 70.0, 170.0, 180.0, 130.0, 100.0, 88.0, 130.0, 120.0, 146.0, 170.0, 60.0, 90.0, 80.0, 50.0, 170.0, 150.0, 140.0, 110.0, 120.0, 40.0, 200.0, 60.0, 130.0, 80.0, 220.0, 150.0, 120.0, 70.0, 40.0, 70.0, 116.0, 180.0, 160.0, 93.0, 110.0, 90.0, 30.0, 80.0, 120.0, 100.0, 40.0, 90.0, 150.0, 210.0, 160.0, 100.0, 220.0, 27.0, 143.0, 130.0, 121.0, 120.0, 80.0, 160.0, 22.0, 82.0, 109.0, 60.0, 120.0, -49.0, 28.0, 150.0, 140.0, 90.0, 90.0, 70.0, 80.0, 150.0, 80.0, 50.0, 60.0, 80.0, 145.0, 109.0, 90.0, 180.0, 39.0, 100.0, 60.0, 60.0, 110.0, 30.0, 90.0, 59.0, 135.0, 40.0, 200.0, 38.0, -120.0, 108.0, 35.0, 73.0, 80.0, 40.0, -115.0, 5.0, 134.0, 120.0, 100.0, 70.0, 50.0, 76.0, 110.0, 80.0, 170.0, 80.0, 180.0, 160.0, 55.0, 70.0, -15.0, 81.0, 120.0, 120.0, 90.0, 268.0, 45.0, 100.0, 80.0, 110.0, 210.0, 120.0, 70.0, 50.0, 69.0, 19.0, 135.0, -71.0, 40.0, 139.0, 52.0, 90.0, 77.0, 120.0, 35.0, 20.0, 30.0, 100.0, 120.0, 52.0, 130.0, 40.0, 80.0, 50.0, 48.0, 180.0, 50.0, 19.0, 100.0, 100.0, 120.0, 140.0, 130.0, 110.0, 160.0, 149.0, 150.0, 138.0, 120.0, 68.0, 178.0, 57.0, 140.0, 200.0, 60.0, 100.0, 70.0, 90.0, 50.0, 40.0, 90.0, 110.0, 28.0, 130.0, 17.0, 100.0, 14.0, 40.0, 110.0, 6.0, 120.0, 80.0, 220.0, 90.0, 100.0, 90.0, 58.0, 130.0, 70.0, 140.0, 120.0, 250.0, 90.0, 80.0, 140.0, 110.0, 100.0, 120.0, 160.0, 130.0, 60.0, 110.0, 120.0, 10.0, 170.0, -105.0, 60.0, 20.0, 20.0, 150.0, 110.0, 60.0, 85.0, 105.0, 60.0, 90.0, 120.0, 140.0, 170.0, 140.0, 110.0, 0.0, -25.0, 80.0, 195.0, 100.0, 150.0, 50.0, 110.0, 110.0, 10.0, 140.0, 100.0, 150.0, 180.0, 60.0, 40.0, 150.0, 160.0, 40.0, 180.0, 100.0, 50.0, 140.0, 60.0, 30.0, 60.0, 90.0, 35.0, 110.0, 140.0, 40.0, 120.0, 130.0, 80.0, 100.0, 100.0, 90.0, 50.0, 90.0, 218.0, 68.0, 40.0, 101.0, 80.0, 170.0, 58.0, 93.0, 13.0, 25.0, 150.0, 20.0, 100.0, 60.0, 70.0, 120.0, 70.0, 50.0, 20.0, 40.0, 11.0, 110.0, 153.0, 138.0, 80.0, 170.0, 200.0, 280.0, 80.0, 118.0, 50.0, 110.0, 90.0, 100.0, 90.0, 90.0, 50.0, 110.0, 110.0, 130.0, 70.0, 140.0, 110.0, 150.0, 90.0, 110.0, 100.0, 110.0, 60.0, 60.0, -31.0, 107.0, 150.0, 1.0, 140.0, 130.0, 130.0, 79.0, 150.0, 90.0, 100.0, 26.0, 60.0, 140.0, 60.0, 40.0, 140.0, 110.0, 80.0, 17.0, 0.0, 70.0, 20.0, 44.0, 4.0, 120.0, 70.0, 20.0, 59.0, 230.0, 100.0, 73.0, 130.0, 109.0, 100.0, 110.0, 130.0, 50.0, 160.0, 90.0, 73.0, 68.0, 140.0, 90.0, 50.0, 140.0, 159.0, 130.0, 70.0, 120.0, 60.0, 150.0, 100.0, 90.0, 93.0, 110.0, 230.0, 130.0, 148.0, 99.0, 240.0, 100.0, 100.0, 50.0, 160.0, 80.0, 69.0, 129.0, 210.0, 150.0, 68.0, 80.0, 50.0, 50.0, 60.0, 50.0, 88.0, 34.0, 90.0, -12.0, 80.0, -7.0, 60.0, 140.0, 100.0, 105.0, 30.0, 80.0, 62.0, 25.0, 100.0, 100.0, 63.0, 20.0, 110.0, 190.0, 110.0, 100.0, 110.0, 31.0, 150.0, 100.0, 68.0, 140.0, 48.0, 80.0, 60.0, 110.0, 100.0, 90.0, 80.0, 150.0, 70.0, 90.0, 57.0, 70.0, 69.0, 6.0, 170.0, 70.0, 50.0, 92.0, 40.0, 76.0, 36.0, 78.0, 45.0, 10.0, 30.0, 115.0, 100.0, 130.0, 10.0, 60.0, 190.0, 110.0, 30.0, 70.0, 50.0, 140.0, 50.0, 130.0, 110.0, 60.0, 60.0, 50.0, 10.0, 90.0, 180.0, 10.0, 150.0, 104.0, 60.0, 64.0, 50.0, 130.0, 30.0, 90.0, 40.0, 40.0, 70.0, 80.0, 131.0, 120.0, 160.0, 110.0, 40.0, 90.0, 2.0, 100.0, 70.0, 30.0, 70.0, -5.0, 55.0, 9.0, 90.0, 90.0, 78.0, 50.0, 30.0, 90.0, 50.0, 140.0, 50.0, 170.0, 30.0, 15.0, 60.0, 90.0, 98.0, 80.0, 100.0, 220.0, 40.0, 70.0, 99.0, 140.0, 60.0, 60.0, 177.0, 50.0, 60.0, 13.0, 110.0, 80.0, 115.0, 210.0, 100.0, 46.0, 200.0, 130.0, 80.0, 75.0, 79.0, 75.0, 37.0, 102.0, 48.0, 40.0, 41.0, 90.0, 153.0, 140.0, 109.0, 130.0, 30.0, 80.0, 57.0, 130.0, 40.0, 230.0, 150.0, 113.0, 120.0, 140.0, 140.0, 23.0, 80.0, 140.0, 157.0, 37.0, 90.0, 130.0, 100.0, 210.0, 117.0, 40.0, 40.0, 48.0, 30.0, 180.0, 140.0, 50.0, 80.0, 80.0, 120.0, 190.0, 120.0, 90.0, 159.0, 80.0, 60.0, 30.0, 120.0, 110.0, 80.0, 40.0, 70.0, 20.0, 55.0, 140.0, 120.0, 20.0, 40.0, 80.0, 110.0, 220.0, 140.0, 40.0, 50.0, 169.0, 90.0, 40.0, 40.0, 50.0, 130.0, 70.0, 180.0, 130.0, 40.0, 150.0, 14.0, 104.0, 70.0, 250.0, 140.0, 80.0, 150.0, 130.0, 70.0, 50.0, 90.0, 240.0, 60.0, 90.0, 80.0, 80.0, 80.0, 100.0, 130.0, 130.0, 219.0, 190.0, 150.0, 69.0, 69.0, 130.0, 75.0, 120.0, 190.0, 160.0, 173.0, 40.0, 166.0, 100.0, 170.0, 100.0, 100.0, 178.0, 60.0, 130.0, 70.0, 20.0, 60.0, 70.0, 3.0, 50.0, 110.0, 128.0, 102.0, -9.0, 41.0, 65.0, 168.0, 130.0, 80.0, 50.0, 110.0, 170.0, 50.0, 120.0, 120.0, 190.0, 210.0, 130.0, 25.0, 90.0, 110.0, 150.0, 160.0, 100.0, 60.0, 160.0, 230.0, 80.0, 130.0, 180.0, 38.0, 80.0, 120.0, 110.0, 90.0, 60.0, 170.0, 50.0, 140.0, 110.0, 200.0, 170.0, 70.0, 60.0, 136.0, 80.0, 120.0, 180.0, 50.0, 40.0, 210.0, 9.0, 160.0, 130.0, 110.0, 120.0, 180.0, 77.0, 150.0, 46.0, 70.0, 120.0, 8.0, 40.0, 150.0, 170.0, 35.0, 10.0, 90.0, 40.0, 90.0, 60.0, 120.0, 60.0, 110.0, 128.0, 110.0, 130.0, 150.0, 67.0, 120.0, 119.0, 130.0, 98.0, 90.0, 170.0, 80.0, 170.0, 45.0, 40.0, 80.0, 84.0, 140.0, 54.0, 126.0, 60.0, 100.0, 60.0, 15.0, 250.0, 46.0, 60.0, 110.0, 120.0, 70.0, 50.0, -10.0, 45.0, 110.0, 140.0, 60.0, 10.0, 150.0, 37.0, 35.0, 30.0, 140.0, 50.0, 40.0, 95.0, 90.0, 80.0, 30.0, 110.0, 100.0, 230.0, 130.0, 120.0, 100.0, 100.0, 50.0, 110.0, 50.0, 130.0, 100.0, 110.0, 50.0, 105.0, 130.0, 70.0, 100.0, 50.0, 158.0, 140.0, 90.0, 80.0, 140.0, 160.0, 44.0, 140.0, 160.0, 230.0, 50.0, 130.0, 130.0, 130.0, 60.0, 227.0, 46.0, 150.0, 90.0, 139.0, 15.0, 120.0, 130.0, 100.0, 140.0, 157.0, 130.0, 70.0, 120.0, 70.0, 110.0, 70.0, 5.0, 30.0, 88.0, 57.0, 69.0, 125.0, -21.0, 40.0, 80.0, 120.0, 40.0, 125.0, 30.0, 39.0, 88.0, 67.0, 118.0, 137.0, 50.0, 30.0, 40.0, 30.0, 190.0, 60.0, 110.0, 38.0, 49.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7418643919825731, "mean_inference_ms": 1.7449066410423115, "mean_action_processing_ms": 0.5230749371755791, "mean_env_wait_ms": 1.1808559390578217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012233972549438477, "StateBufferConnector_ms": 0.009125947952270508, "ViewRequirementAgentConnector_ms": 0.3881213665008545}, "num_episodes": 18, "episode_return_max": 1377.0, "episode_return_min": 537.0, "episode_return_mean": 954.92}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.619364147848945, "num_env_steps_trained_throughput_per_sec": 20.619364147848945, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 3680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3680000, "timers": {"training_iteration_time_ms": 193233.038, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193232.993, "sample_time_ms": 2297.882, "learn_time_ms": 190915.749, "learn_throughput": 20.952, "synch_weights_time_ms": 10.723}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "done": false, "training_iteration": 92, "trial_id": "1841f_00000", "date": "2024-08-08_04-39-40", "timestamp": 1723106380, "time_this_iter_s": 194.0008578300476, "time_total_s": 19164.41734433174, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b56a1820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19164.41734433174, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 16.643795620437956, "ram_util_percent": 77.43576642335766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.651011620765042, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.489497929106886, "policy_loss": -0.014081071051659858, "vf_loss": 8.50206495032143, "vf_explained_var": -0.00035241496321746207, "kl": 0.0075702308211641235, "entropy": 0.5138025642171328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 868575.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "env_runners": {"episode_reward_max": 1377.0, "episode_reward_min": 537.0, "episode_reward_mean": 934.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 93.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1079.0, 1270.0, 825.0, 928.0, 923.0, 690.0, 542.0, 1031.0, 999.0, 781.0, 696.0, 797.0, 1285.0, 985.0, 645.0, 1098.0, 1300.0, 615.0, 1080.0, 880.0, 1030.0, 855.0, 940.0, 866.0, 700.0, 1340.0, 930.0, 1000.0, 946.0, 773.0, 637.0, 1052.0, 1040.0, 1210.0, 1288.0, 558.0, 675.0, 934.0, 946.0, 832.0, 572.0, 890.0, 750.0, 758.0, 903.0, 537.0, 725.0, 967.0, 961.0, 866.0, 960.0, 1176.0, 969.0, 1080.0, 769.0, 965.0, 949.0, 1128.0, 940.0, 1282.0, 1377.0, 701.0, 907.0, 1195.0, 1218.0, 1220.0, 955.0, 1163.0, 693.0, 1114.0, 987.0, 911.0, 705.0, 747.0, 1080.0, 895.0, 1342.0, 1152.0, 1052.0, 573.0, 844.0, 747.0, 838.0, 945.0, 982.0, 931.0, 1032.0, 822.0, 943.0, 800.0, 1135.0, 990.0, 877.0, 880.0, 755.0, 1034.0, 1190.0, 1102.0, 594.0, 889.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [116.0, 180.0, 160.0, 93.0, 110.0, 90.0, 30.0, 80.0, 120.0, 100.0, 40.0, 90.0, 150.0, 210.0, 160.0, 100.0, 220.0, 27.0, 143.0, 130.0, 121.0, 120.0, 80.0, 160.0, 22.0, 82.0, 109.0, 60.0, 120.0, -49.0, 28.0, 150.0, 140.0, 90.0, 90.0, 70.0, 80.0, 150.0, 80.0, 50.0, 60.0, 80.0, 145.0, 109.0, 90.0, 180.0, 39.0, 100.0, 60.0, 60.0, 110.0, 30.0, 90.0, 59.0, 135.0, 40.0, 200.0, 38.0, -120.0, 108.0, 35.0, 73.0, 80.0, 40.0, -115.0, 5.0, 134.0, 120.0, 100.0, 70.0, 50.0, 76.0, 110.0, 80.0, 170.0, 80.0, 180.0, 160.0, 55.0, 70.0, -15.0, 81.0, 120.0, 120.0, 90.0, 268.0, 45.0, 100.0, 80.0, 110.0, 210.0, 120.0, 70.0, 50.0, 69.0, 19.0, 135.0, -71.0, 40.0, 139.0, 52.0, 90.0, 77.0, 120.0, 35.0, 20.0, 30.0, 100.0, 120.0, 52.0, 130.0, 40.0, 80.0, 50.0, 48.0, 180.0, 50.0, 19.0, 100.0, 100.0, 120.0, 140.0, 130.0, 110.0, 160.0, 149.0, 150.0, 138.0, 120.0, 68.0, 178.0, 57.0, 140.0, 200.0, 60.0, 100.0, 70.0, 90.0, 50.0, 40.0, 90.0, 110.0, 28.0, 130.0, 17.0, 100.0, 14.0, 40.0, 110.0, 6.0, 120.0, 80.0, 220.0, 90.0, 100.0, 90.0, 58.0, 130.0, 70.0, 140.0, 120.0, 250.0, 90.0, 80.0, 140.0, 110.0, 100.0, 120.0, 160.0, 130.0, 60.0, 110.0, 120.0, 10.0, 170.0, -105.0, 60.0, 20.0, 20.0, 150.0, 110.0, 60.0, 85.0, 105.0, 60.0, 90.0, 120.0, 140.0, 170.0, 140.0, 110.0, 0.0, -25.0, 80.0, 195.0, 100.0, 150.0, 50.0, 110.0, 110.0, 10.0, 140.0, 100.0, 150.0, 180.0, 60.0, 40.0, 150.0, 160.0, 40.0, 180.0, 100.0, 50.0, 140.0, 60.0, 30.0, 60.0, 90.0, 35.0, 110.0, 140.0, 40.0, 120.0, 130.0, 80.0, 100.0, 100.0, 90.0, 50.0, 90.0, 218.0, 68.0, 40.0, 101.0, 80.0, 170.0, 58.0, 93.0, 13.0, 25.0, 150.0, 20.0, 100.0, 60.0, 70.0, 120.0, 70.0, 50.0, 20.0, 40.0, 11.0, 110.0, 153.0, 138.0, 80.0, 170.0, 200.0, 280.0, 80.0, 118.0, 50.0, 110.0, 90.0, 100.0, 90.0, 90.0, 50.0, 110.0, 110.0, 130.0, 70.0, 140.0, 110.0, 150.0, 90.0, 110.0, 100.0, 110.0, 60.0, 60.0, -31.0, 107.0, 150.0, 1.0, 140.0, 130.0, 130.0, 79.0, 150.0, 90.0, 100.0, 26.0, 60.0, 140.0, 60.0, 40.0, 140.0, 110.0, 80.0, 17.0, 0.0, 70.0, 20.0, 44.0, 4.0, 120.0, 70.0, 20.0, 59.0, 230.0, 100.0, 73.0, 130.0, 109.0, 100.0, 110.0, 130.0, 50.0, 160.0, 90.0, 73.0, 68.0, 140.0, 90.0, 50.0, 140.0, 159.0, 130.0, 70.0, 120.0, 60.0, 150.0, 100.0, 90.0, 93.0, 110.0, 230.0, 130.0, 148.0, 99.0, 240.0, 100.0, 100.0, 50.0, 160.0, 80.0, 69.0, 129.0, 210.0, 150.0, 68.0, 80.0, 50.0, 50.0, 60.0, 50.0, 88.0, 34.0, 90.0, -12.0, 80.0, -7.0, 60.0, 140.0, 100.0, 105.0, 30.0, 80.0, 62.0, 25.0, 100.0, 100.0, 63.0, 20.0, 110.0, 190.0, 110.0, 100.0, 110.0, 31.0, 150.0, 100.0, 68.0, 140.0, 48.0, 80.0, 60.0, 110.0, 100.0, 90.0, 80.0, 150.0, 70.0, 90.0, 57.0, 70.0, 69.0, 6.0, 170.0, 70.0, 50.0, 92.0, 40.0, 76.0, 36.0, 78.0, 45.0, 10.0, 30.0, 115.0, 100.0, 130.0, 10.0, 60.0, 190.0, 110.0, 30.0, 70.0, 50.0, 140.0, 50.0, 130.0, 110.0, 60.0, 60.0, 50.0, 10.0, 90.0, 180.0, 10.0, 150.0, 104.0, 60.0, 64.0, 50.0, 130.0, 30.0, 90.0, 40.0, 40.0, 70.0, 80.0, 131.0, 120.0, 160.0, 110.0, 40.0, 90.0, 2.0, 100.0, 70.0, 30.0, 70.0, -5.0, 55.0, 9.0, 90.0, 90.0, 78.0, 50.0, 30.0, 90.0, 50.0, 140.0, 50.0, 170.0, 30.0, 15.0, 60.0, 90.0, 98.0, 80.0, 100.0, 220.0, 40.0, 70.0, 99.0, 140.0, 60.0, 60.0, 177.0, 50.0, 60.0, 13.0, 110.0, 80.0, 115.0, 210.0, 100.0, 46.0, 200.0, 130.0, 80.0, 75.0, 79.0, 75.0, 37.0, 102.0, 48.0, 40.0, 41.0, 90.0, 153.0, 140.0, 109.0, 130.0, 30.0, 80.0, 57.0, 130.0, 40.0, 230.0, 150.0, 113.0, 120.0, 140.0, 140.0, 23.0, 80.0, 140.0, 157.0, 37.0, 90.0, 130.0, 100.0, 210.0, 117.0, 40.0, 40.0, 48.0, 30.0, 180.0, 140.0, 50.0, 80.0, 80.0, 120.0, 190.0, 120.0, 90.0, 159.0, 80.0, 60.0, 30.0, 120.0, 110.0, 80.0, 40.0, 70.0, 20.0, 55.0, 140.0, 120.0, 20.0, 40.0, 80.0, 110.0, 220.0, 140.0, 40.0, 50.0, 169.0, 90.0, 40.0, 40.0, 50.0, 130.0, 70.0, 180.0, 130.0, 40.0, 150.0, 14.0, 104.0, 70.0, 250.0, 140.0, 80.0, 150.0, 130.0, 70.0, 50.0, 90.0, 240.0, 60.0, 90.0, 80.0, 80.0, 80.0, 100.0, 130.0, 130.0, 219.0, 190.0, 150.0, 69.0, 69.0, 130.0, 75.0, 120.0, 190.0, 160.0, 173.0, 40.0, 166.0, 100.0, 170.0, 100.0, 100.0, 178.0, 60.0, 130.0, 70.0, 20.0, 60.0, 70.0, 3.0, 50.0, 110.0, 128.0, 102.0, -9.0, 41.0, 65.0, 168.0, 130.0, 80.0, 50.0, 110.0, 170.0, 50.0, 120.0, 120.0, 190.0, 210.0, 130.0, 25.0, 90.0, 110.0, 150.0, 160.0, 100.0, 60.0, 160.0, 230.0, 80.0, 130.0, 180.0, 38.0, 80.0, 120.0, 110.0, 90.0, 60.0, 170.0, 50.0, 140.0, 110.0, 200.0, 170.0, 70.0, 60.0, 136.0, 80.0, 120.0, 180.0, 50.0, 40.0, 210.0, 9.0, 160.0, 130.0, 110.0, 120.0, 180.0, 77.0, 150.0, 46.0, 70.0, 120.0, 8.0, 40.0, 150.0, 170.0, 35.0, 10.0, 90.0, 40.0, 90.0, 60.0, 120.0, 60.0, 110.0, 128.0, 110.0, 130.0, 150.0, 67.0, 120.0, 119.0, 130.0, 98.0, 90.0, 170.0, 80.0, 170.0, 45.0, 40.0, 80.0, 84.0, 140.0, 54.0, 126.0, 60.0, 100.0, 60.0, 15.0, 250.0, 46.0, 60.0, 110.0, 120.0, 70.0, 50.0, -10.0, 45.0, 110.0, 140.0, 60.0, 10.0, 150.0, 37.0, 35.0, 30.0, 140.0, 50.0, 40.0, 95.0, 90.0, 80.0, 30.0, 110.0, 100.0, 230.0, 130.0, 120.0, 100.0, 100.0, 50.0, 110.0, 50.0, 130.0, 100.0, 110.0, 50.0, 105.0, 130.0, 70.0, 100.0, 50.0, 158.0, 140.0, 90.0, 80.0, 140.0, 160.0, 44.0, 140.0, 160.0, 230.0, 50.0, 130.0, 130.0, 130.0, 60.0, 227.0, 46.0, 150.0, 90.0, 139.0, 15.0, 120.0, 130.0, 100.0, 140.0, 157.0, 130.0, 70.0, 120.0, 70.0, 110.0, 70.0, 5.0, 30.0, 88.0, 57.0, 69.0, 125.0, -21.0, 40.0, 80.0, 120.0, 40.0, 125.0, 30.0, 39.0, 88.0, 67.0, 118.0, 137.0, 50.0, 30.0, 40.0, 30.0, 190.0, 60.0, 110.0, 38.0, 49.0, 150.0, 72.0, 90.0, 70.0, 70.0, 140.0, 115.0, 75.0, 70.0, 90.0, 46.0, 70.0, -135.0, 150.0, 100.0, 160.0, 110.0, 190.0, 70.0, 80.0, 150.0, 160.0, 56.0, 79.0, 137.0, 70.0, 180.0, 50.0, 130.0, 80.0, 40.0, 70.0, 85.0, 170.0, 50.0, 115.0, 90.0, 150.0, 45.0, 36.0, 120.0, 100.0, 80.0, 100.0, 229.0, 46.0, 280.0, 50.0, 30.0, -43.0, 160.0, 50.0, 120.0, 70.0, 89.0, 58.0, 40.0, 160.0, 38.0, 164.0, 33.0, 43.0, 80.0, 60.0, 30.0, 60.0, 140.0, 200.0, 73.0, 127.0, 130.0, 100.0, 60.0, 70.0, 100.0, 110.0, 80.0, 80.0, 30.0, 80.0, 90.0, 200.0, 50.0, 85.0, 170.0, 20.0, 160.0, 70.0, 50.0, 210.0, 120.0, 120.0, 115.0, 110.0, 140.0, 120.0, 90.0, 20.0, 80.0, 65.0, 130.0, 34.0, 70.0, 100.0, 120.0, 60.0, 130.0, 36.0, 98.0, 120.0, 109.0, 100.0, 30.0, 60.0, 170.0, 100.0, 130.0, 100.0, 50.0, 50.0, 90.0, 110.0, 70.0, 140.0, 45.0, 140.0, -10.0, 60.0, 120.0, 40.0, 40.0, 62.0, 230.0, 80.0, 70.0, 221.0, 120.0, 60.0, 90.0, 55.0, 46.0, 170.0, 100.0, 40.0, 80.0, 120.0, 130.0, 170.0, 160.0, 110.0, 110.0, 38.0, 120.0, 104.0, 150.0, 100.0, 170.0, 120.0, 140.0, 40.0, 120.0, 80.0, 47.0, 100.0, 0.0, 9.0, 30.0, 89.0, 90.0, 90.0, 59.0, 46.0, 100.0, 60.0, 110.0, 90.0, 220.0, 220.0, -3.0, 15.0, 31.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7391104028564195, "mean_inference_ms": 1.7412010046996875, "mean_action_processing_ms": 0.522152124469808, "mean_env_wait_ms": 1.1788985601854065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012257575988769531, "StateBufferConnector_ms": 0.008934974670410156, "ViewRequirementAgentConnector_ms": 0.3893444538116455}, "num_episodes": 18, "episode_return_max": 1377.0, "episode_return_min": 537.0, "episode_return_mean": 934.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.559085924785187, "num_env_steps_trained_throughput_per_sec": 20.559085924785187, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 3720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3720000, "timers": {"training_iteration_time_ms": 193314.164, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193314.119, "sample_time_ms": 2319.084, "learn_time_ms": 190975.627, "learn_throughput": 20.945, "synch_weights_time_ms": 10.848}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "done": false, "training_iteration": 93, "trial_id": "1841f_00000", "date": "2024-08-08_04-42-55", "timestamp": 1723106575, "time_this_iter_s": 194.57173609733582, "time_total_s": 19358.989080429077, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b56a1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19358.989080429077, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 16.914181818181817, "ram_util_percent": 77.23890909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.747618888170955, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.623473336775335, "policy_loss": -0.015338115367683343, "vf_loss": 8.637221118969657, "vf_explained_var": -0.02001470095687273, "kl": 0.007951701620948805, "entropy": 0.4949705361240842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 877965.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "env_runners": {"episode_reward_max": 1400.0, "episode_reward_min": 503.0, "episode_reward_mean": 939.97, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 93.997}, "custom_metrics": {}, "hist_stats": {"episode_reward": [940.0, 866.0, 700.0, 1340.0, 930.0, 1000.0, 946.0, 773.0, 637.0, 1052.0, 1040.0, 1210.0, 1288.0, 558.0, 675.0, 934.0, 946.0, 832.0, 572.0, 890.0, 750.0, 758.0, 903.0, 537.0, 725.0, 967.0, 961.0, 866.0, 960.0, 1176.0, 969.0, 1080.0, 769.0, 965.0, 949.0, 1128.0, 940.0, 1282.0, 1377.0, 701.0, 907.0, 1195.0, 1218.0, 1220.0, 955.0, 1163.0, 693.0, 1114.0, 987.0, 911.0, 705.0, 747.0, 1080.0, 895.0, 1342.0, 1152.0, 1052.0, 573.0, 844.0, 747.0, 838.0, 945.0, 982.0, 931.0, 1032.0, 822.0, 943.0, 800.0, 1135.0, 990.0, 877.0, 880.0, 755.0, 1034.0, 1190.0, 1102.0, 594.0, 889.0, 660.0, 1110.0, 820.0, 503.0, 765.0, 969.0, 825.0, 1032.0, 1235.0, 841.0, 1051.0, 1049.0, 1114.0, 752.0, 892.0, 1120.0, 957.0, 1024.0, 882.0, 942.0, 923.0, 1400.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 40.0, 120.0, 130.0, 80.0, 100.0, 100.0, 90.0, 50.0, 90.0, 218.0, 68.0, 40.0, 101.0, 80.0, 170.0, 58.0, 93.0, 13.0, 25.0, 150.0, 20.0, 100.0, 60.0, 70.0, 120.0, 70.0, 50.0, 20.0, 40.0, 11.0, 110.0, 153.0, 138.0, 80.0, 170.0, 200.0, 280.0, 80.0, 118.0, 50.0, 110.0, 90.0, 100.0, 90.0, 90.0, 50.0, 110.0, 110.0, 130.0, 70.0, 140.0, 110.0, 150.0, 90.0, 110.0, 100.0, 110.0, 60.0, 60.0, -31.0, 107.0, 150.0, 1.0, 140.0, 130.0, 130.0, 79.0, 150.0, 90.0, 100.0, 26.0, 60.0, 140.0, 60.0, 40.0, 140.0, 110.0, 80.0, 17.0, 0.0, 70.0, 20.0, 44.0, 4.0, 120.0, 70.0, 20.0, 59.0, 230.0, 100.0, 73.0, 130.0, 109.0, 100.0, 110.0, 130.0, 50.0, 160.0, 90.0, 73.0, 68.0, 140.0, 90.0, 50.0, 140.0, 159.0, 130.0, 70.0, 120.0, 60.0, 150.0, 100.0, 90.0, 93.0, 110.0, 230.0, 130.0, 148.0, 99.0, 240.0, 100.0, 100.0, 50.0, 160.0, 80.0, 69.0, 129.0, 210.0, 150.0, 68.0, 80.0, 50.0, 50.0, 60.0, 50.0, 88.0, 34.0, 90.0, -12.0, 80.0, -7.0, 60.0, 140.0, 100.0, 105.0, 30.0, 80.0, 62.0, 25.0, 100.0, 100.0, 63.0, 20.0, 110.0, 190.0, 110.0, 100.0, 110.0, 31.0, 150.0, 100.0, 68.0, 140.0, 48.0, 80.0, 60.0, 110.0, 100.0, 90.0, 80.0, 150.0, 70.0, 90.0, 57.0, 70.0, 69.0, 6.0, 170.0, 70.0, 50.0, 92.0, 40.0, 76.0, 36.0, 78.0, 45.0, 10.0, 30.0, 115.0, 100.0, 130.0, 10.0, 60.0, 190.0, 110.0, 30.0, 70.0, 50.0, 140.0, 50.0, 130.0, 110.0, 60.0, 60.0, 50.0, 10.0, 90.0, 180.0, 10.0, 150.0, 104.0, 60.0, 64.0, 50.0, 130.0, 30.0, 90.0, 40.0, 40.0, 70.0, 80.0, 131.0, 120.0, 160.0, 110.0, 40.0, 90.0, 2.0, 100.0, 70.0, 30.0, 70.0, -5.0, 55.0, 9.0, 90.0, 90.0, 78.0, 50.0, 30.0, 90.0, 50.0, 140.0, 50.0, 170.0, 30.0, 15.0, 60.0, 90.0, 98.0, 80.0, 100.0, 220.0, 40.0, 70.0, 99.0, 140.0, 60.0, 60.0, 177.0, 50.0, 60.0, 13.0, 110.0, 80.0, 115.0, 210.0, 100.0, 46.0, 200.0, 130.0, 80.0, 75.0, 79.0, 75.0, 37.0, 102.0, 48.0, 40.0, 41.0, 90.0, 153.0, 140.0, 109.0, 130.0, 30.0, 80.0, 57.0, 130.0, 40.0, 230.0, 150.0, 113.0, 120.0, 140.0, 140.0, 23.0, 80.0, 140.0, 157.0, 37.0, 90.0, 130.0, 100.0, 210.0, 117.0, 40.0, 40.0, 48.0, 30.0, 180.0, 140.0, 50.0, 80.0, 80.0, 120.0, 190.0, 120.0, 90.0, 159.0, 80.0, 60.0, 30.0, 120.0, 110.0, 80.0, 40.0, 70.0, 20.0, 55.0, 140.0, 120.0, 20.0, 40.0, 80.0, 110.0, 220.0, 140.0, 40.0, 50.0, 169.0, 90.0, 40.0, 40.0, 50.0, 130.0, 70.0, 180.0, 130.0, 40.0, 150.0, 14.0, 104.0, 70.0, 250.0, 140.0, 80.0, 150.0, 130.0, 70.0, 50.0, 90.0, 240.0, 60.0, 90.0, 80.0, 80.0, 80.0, 100.0, 130.0, 130.0, 219.0, 190.0, 150.0, 69.0, 69.0, 130.0, 75.0, 120.0, 190.0, 160.0, 173.0, 40.0, 166.0, 100.0, 170.0, 100.0, 100.0, 178.0, 60.0, 130.0, 70.0, 20.0, 60.0, 70.0, 3.0, 50.0, 110.0, 128.0, 102.0, -9.0, 41.0, 65.0, 168.0, 130.0, 80.0, 50.0, 110.0, 170.0, 50.0, 120.0, 120.0, 190.0, 210.0, 130.0, 25.0, 90.0, 110.0, 150.0, 160.0, 100.0, 60.0, 160.0, 230.0, 80.0, 130.0, 180.0, 38.0, 80.0, 120.0, 110.0, 90.0, 60.0, 170.0, 50.0, 140.0, 110.0, 200.0, 170.0, 70.0, 60.0, 136.0, 80.0, 120.0, 180.0, 50.0, 40.0, 210.0, 9.0, 160.0, 130.0, 110.0, 120.0, 180.0, 77.0, 150.0, 46.0, 70.0, 120.0, 8.0, 40.0, 150.0, 170.0, 35.0, 10.0, 90.0, 40.0, 90.0, 60.0, 120.0, 60.0, 110.0, 128.0, 110.0, 130.0, 150.0, 67.0, 120.0, 119.0, 130.0, 98.0, 90.0, 170.0, 80.0, 170.0, 45.0, 40.0, 80.0, 84.0, 140.0, 54.0, 126.0, 60.0, 100.0, 60.0, 15.0, 250.0, 46.0, 60.0, 110.0, 120.0, 70.0, 50.0, -10.0, 45.0, 110.0, 140.0, 60.0, 10.0, 150.0, 37.0, 35.0, 30.0, 140.0, 50.0, 40.0, 95.0, 90.0, 80.0, 30.0, 110.0, 100.0, 230.0, 130.0, 120.0, 100.0, 100.0, 50.0, 110.0, 50.0, 130.0, 100.0, 110.0, 50.0, 105.0, 130.0, 70.0, 100.0, 50.0, 158.0, 140.0, 90.0, 80.0, 140.0, 160.0, 44.0, 140.0, 160.0, 230.0, 50.0, 130.0, 130.0, 130.0, 60.0, 227.0, 46.0, 150.0, 90.0, 139.0, 15.0, 120.0, 130.0, 100.0, 140.0, 157.0, 130.0, 70.0, 120.0, 70.0, 110.0, 70.0, 5.0, 30.0, 88.0, 57.0, 69.0, 125.0, -21.0, 40.0, 80.0, 120.0, 40.0, 125.0, 30.0, 39.0, 88.0, 67.0, 118.0, 137.0, 50.0, 30.0, 40.0, 30.0, 190.0, 60.0, 110.0, 38.0, 49.0, 150.0, 72.0, 90.0, 70.0, 70.0, 140.0, 115.0, 75.0, 70.0, 90.0, 46.0, 70.0, -135.0, 150.0, 100.0, 160.0, 110.0, 190.0, 70.0, 80.0, 150.0, 160.0, 56.0, 79.0, 137.0, 70.0, 180.0, 50.0, 130.0, 80.0, 40.0, 70.0, 85.0, 170.0, 50.0, 115.0, 90.0, 150.0, 45.0, 36.0, 120.0, 100.0, 80.0, 100.0, 229.0, 46.0, 280.0, 50.0, 30.0, -43.0, 160.0, 50.0, 120.0, 70.0, 89.0, 58.0, 40.0, 160.0, 38.0, 164.0, 33.0, 43.0, 80.0, 60.0, 30.0, 60.0, 140.0, 200.0, 73.0, 127.0, 130.0, 100.0, 60.0, 70.0, 100.0, 110.0, 80.0, 80.0, 30.0, 80.0, 90.0, 200.0, 50.0, 85.0, 170.0, 20.0, 160.0, 70.0, 50.0, 210.0, 120.0, 120.0, 115.0, 110.0, 140.0, 120.0, 90.0, 20.0, 80.0, 65.0, 130.0, 34.0, 70.0, 100.0, 120.0, 60.0, 130.0, 36.0, 98.0, 120.0, 109.0, 100.0, 30.0, 60.0, 170.0, 100.0, 130.0, 100.0, 50.0, 50.0, 90.0, 110.0, 70.0, 140.0, 45.0, 140.0, -10.0, 60.0, 120.0, 40.0, 40.0, 62.0, 230.0, 80.0, 70.0, 221.0, 120.0, 60.0, 90.0, 55.0, 46.0, 170.0, 100.0, 40.0, 80.0, 120.0, 130.0, 170.0, 160.0, 110.0, 110.0, 38.0, 120.0, 104.0, 150.0, 100.0, 170.0, 120.0, 140.0, 40.0, 120.0, 80.0, 47.0, 100.0, 0.0, 9.0, 30.0, 89.0, 90.0, 90.0, 59.0, 46.0, 100.0, 60.0, 110.0, 90.0, 220.0, 220.0, -3.0, 15.0, 31.0, 110.0, 80.0, 80.0, 90.0, 60.0, 80.0, 60.0, 60.0, 10.0, 30.0, 70.0, 100.0, 160.0, 60.0, 90.0, 110.0, 180.0, 120.0, 80.0, 140.0, 80.0, 60.0, 120.0, 100.0, 40.0, 26.0, 90.0, 50.0, 124.0, 130.0, 30.0, 27.0, 30.0, -3.0, 30.0, 250.0, 30.0, 24.0, 35.0, 50.0, 130.0, 110.0, 50.0, 70.0, 60.0, 50.0, 90.0, 35.0, 90.0, 80.0, 70.0, 120.0, 119.0, 40.0, 24.0, 100.0, 61.0, 150.0, 90.0, 195.0, 35.0, 68.0, 3.0, 50.0, 160.0, 50.0, 150.0, 19.0, 170.0, 120.0, 100.0, 150.0, 130.0, 120.0, 90.0, 100.0, 150.0, 90.0, 54.0, 48.0, 100.0, 120.0, 150.0, 130.0, 109.0, 146.0, 70.0, 140.0, 160.0, 110.0, 130.0, 120.0, 3.0, 85.0, 140.0, 100.0, 43.0, 30.0, 50.0, 140.0, 50.0, 107.0, 50.0, 140.0, 75.0, 200.0, 129.0, 90.0, 90.0, 120.0, 90.0, 119.0, 70.0, 94.0, 190.0, 61.0, 95.0, 40.0, 120.0, 170.0, 90.0, 39.0, 35.0, 50.0, 180.0, 130.0, 130.0, 160.0, 140.0, 160.0, 64.0, 77.0, 80.0, 65.0, 66.0, 150.0, 0.0, 140.0, 127.0, -17.0, 205.0, 248.0, 110.0, 70.0, 80.0, -25.0, 20.0, 60.0, 54.0, 70.0, 50.0, 160.0, 190.0, 60.0, 90.0, 110.0, 90.0, 220.0, 70.0, 80.0, 90.0, 109.0, 78.0, 70.0, 60.0, 110.0, 40.0, 110.0, 180.0, 110.0, 40.0, 160.0, 110.0, 70.0, 110.0, 20.0, 90.0, 90.0, 184.0, 150.0, 112.0, 0.0, 189.0, 129.0, 130.0, 90.0, 48.0, 5.0, 119.0, 60.0, 40.0, 89.0, 88.0, 100.0, 110.0, 55.0, 170.0, 30.0, 150.0, 110.0, 70.0, 32.0, 90.0, 152.0, 60.0, 80.0, 140.0, 119.0, 60.0, 120.0, 120.0, 140.0, 160.0, 130.0, 120.0, 170.0, 70.0, 150.0, 130.0, 210.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7355021624570712, "mean_inference_ms": 1.736686891935544, "mean_action_processing_ms": 0.5210374029739505, "mean_env_wait_ms": 1.176597770503581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012219429016113281, "StateBufferConnector_ms": 0.008802413940429688, "ViewRequirementAgentConnector_ms": 0.3863058090209961}, "num_episodes": 22, "episode_return_max": 1400.0, "episode_return_min": 503.0, "episode_return_mean": 939.97}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.6480049167341, "num_env_steps_trained_throughput_per_sec": 20.6480049167341, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 3760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3760000, "timers": {"training_iteration_time_ms": 193416.601, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193416.556, "sample_time_ms": 2329.516, "learn_time_ms": 191067.548, "learn_throughput": 20.935, "synch_weights_time_ms": 11.091}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "done": false, "training_iteration": 94, "trial_id": "1841f_00000", "date": "2024-08-08_04-46-09", "timestamp": 1723106769, "time_this_iter_s": 193.7359960079193, "time_total_s": 19552.725076436996, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b5672430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19552.725076436996, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 17.328102189781024, "ram_util_percent": 77.77189781021897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7847530757339873, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.414083778210722, "policy_loss": -0.014673961801836277, "vf_loss": 8.427192815805014, "vf_explained_var": -0.00705451398484877, "kl": 0.007824611382764891, "entropy": 0.5207976872071671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 887355.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "env_runners": {"episode_reward_max": 1400.0, "episode_reward_min": 503.0, "episode_reward_mean": 935.82, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 93.582}, "custom_metrics": {}, "hist_stats": {"episode_reward": [572.0, 890.0, 750.0, 758.0, 903.0, 537.0, 725.0, 967.0, 961.0, 866.0, 960.0, 1176.0, 969.0, 1080.0, 769.0, 965.0, 949.0, 1128.0, 940.0, 1282.0, 1377.0, 701.0, 907.0, 1195.0, 1218.0, 1220.0, 955.0, 1163.0, 693.0, 1114.0, 987.0, 911.0, 705.0, 747.0, 1080.0, 895.0, 1342.0, 1152.0, 1052.0, 573.0, 844.0, 747.0, 838.0, 945.0, 982.0, 931.0, 1032.0, 822.0, 943.0, 800.0, 1135.0, 990.0, 877.0, 880.0, 755.0, 1034.0, 1190.0, 1102.0, 594.0, 889.0, 660.0, 1110.0, 820.0, 503.0, 765.0, 969.0, 825.0, 1032.0, 1235.0, 841.0, 1051.0, 1049.0, 1114.0, 752.0, 892.0, 1120.0, 957.0, 1024.0, 882.0, 942.0, 923.0, 1400.0, 877.0, 837.0, 1098.0, 780.0, 542.0, 1260.0, 1020.0, 637.0, 862.0, 1155.0, 1099.0, 955.0, 1025.0, 647.0, 780.0, 620.0, 1063.0, 995.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 92.0, 40.0, 76.0, 36.0, 78.0, 45.0, 10.0, 30.0, 115.0, 100.0, 130.0, 10.0, 60.0, 190.0, 110.0, 30.0, 70.0, 50.0, 140.0, 50.0, 130.0, 110.0, 60.0, 60.0, 50.0, 10.0, 90.0, 180.0, 10.0, 150.0, 104.0, 60.0, 64.0, 50.0, 130.0, 30.0, 90.0, 40.0, 40.0, 70.0, 80.0, 131.0, 120.0, 160.0, 110.0, 40.0, 90.0, 2.0, 100.0, 70.0, 30.0, 70.0, -5.0, 55.0, 9.0, 90.0, 90.0, 78.0, 50.0, 30.0, 90.0, 50.0, 140.0, 50.0, 170.0, 30.0, 15.0, 60.0, 90.0, 98.0, 80.0, 100.0, 220.0, 40.0, 70.0, 99.0, 140.0, 60.0, 60.0, 177.0, 50.0, 60.0, 13.0, 110.0, 80.0, 115.0, 210.0, 100.0, 46.0, 200.0, 130.0, 80.0, 75.0, 79.0, 75.0, 37.0, 102.0, 48.0, 40.0, 41.0, 90.0, 153.0, 140.0, 109.0, 130.0, 30.0, 80.0, 57.0, 130.0, 40.0, 230.0, 150.0, 113.0, 120.0, 140.0, 140.0, 23.0, 80.0, 140.0, 157.0, 37.0, 90.0, 130.0, 100.0, 210.0, 117.0, 40.0, 40.0, 48.0, 30.0, 180.0, 140.0, 50.0, 80.0, 80.0, 120.0, 190.0, 120.0, 90.0, 159.0, 80.0, 60.0, 30.0, 120.0, 110.0, 80.0, 40.0, 70.0, 20.0, 55.0, 140.0, 120.0, 20.0, 40.0, 80.0, 110.0, 220.0, 140.0, 40.0, 50.0, 169.0, 90.0, 40.0, 40.0, 50.0, 130.0, 70.0, 180.0, 130.0, 40.0, 150.0, 14.0, 104.0, 70.0, 250.0, 140.0, 80.0, 150.0, 130.0, 70.0, 50.0, 90.0, 240.0, 60.0, 90.0, 80.0, 80.0, 80.0, 100.0, 130.0, 130.0, 219.0, 190.0, 150.0, 69.0, 69.0, 130.0, 75.0, 120.0, 190.0, 160.0, 173.0, 40.0, 166.0, 100.0, 170.0, 100.0, 100.0, 178.0, 60.0, 130.0, 70.0, 20.0, 60.0, 70.0, 3.0, 50.0, 110.0, 128.0, 102.0, -9.0, 41.0, 65.0, 168.0, 130.0, 80.0, 50.0, 110.0, 170.0, 50.0, 120.0, 120.0, 190.0, 210.0, 130.0, 25.0, 90.0, 110.0, 150.0, 160.0, 100.0, 60.0, 160.0, 230.0, 80.0, 130.0, 180.0, 38.0, 80.0, 120.0, 110.0, 90.0, 60.0, 170.0, 50.0, 140.0, 110.0, 200.0, 170.0, 70.0, 60.0, 136.0, 80.0, 120.0, 180.0, 50.0, 40.0, 210.0, 9.0, 160.0, 130.0, 110.0, 120.0, 180.0, 77.0, 150.0, 46.0, 70.0, 120.0, 8.0, 40.0, 150.0, 170.0, 35.0, 10.0, 90.0, 40.0, 90.0, 60.0, 120.0, 60.0, 110.0, 128.0, 110.0, 130.0, 150.0, 67.0, 120.0, 119.0, 130.0, 98.0, 90.0, 170.0, 80.0, 170.0, 45.0, 40.0, 80.0, 84.0, 140.0, 54.0, 126.0, 60.0, 100.0, 60.0, 15.0, 250.0, 46.0, 60.0, 110.0, 120.0, 70.0, 50.0, -10.0, 45.0, 110.0, 140.0, 60.0, 10.0, 150.0, 37.0, 35.0, 30.0, 140.0, 50.0, 40.0, 95.0, 90.0, 80.0, 30.0, 110.0, 100.0, 230.0, 130.0, 120.0, 100.0, 100.0, 50.0, 110.0, 50.0, 130.0, 100.0, 110.0, 50.0, 105.0, 130.0, 70.0, 100.0, 50.0, 158.0, 140.0, 90.0, 80.0, 140.0, 160.0, 44.0, 140.0, 160.0, 230.0, 50.0, 130.0, 130.0, 130.0, 60.0, 227.0, 46.0, 150.0, 90.0, 139.0, 15.0, 120.0, 130.0, 100.0, 140.0, 157.0, 130.0, 70.0, 120.0, 70.0, 110.0, 70.0, 5.0, 30.0, 88.0, 57.0, 69.0, 125.0, -21.0, 40.0, 80.0, 120.0, 40.0, 125.0, 30.0, 39.0, 88.0, 67.0, 118.0, 137.0, 50.0, 30.0, 40.0, 30.0, 190.0, 60.0, 110.0, 38.0, 49.0, 150.0, 72.0, 90.0, 70.0, 70.0, 140.0, 115.0, 75.0, 70.0, 90.0, 46.0, 70.0, -135.0, 150.0, 100.0, 160.0, 110.0, 190.0, 70.0, 80.0, 150.0, 160.0, 56.0, 79.0, 137.0, 70.0, 180.0, 50.0, 130.0, 80.0, 40.0, 70.0, 85.0, 170.0, 50.0, 115.0, 90.0, 150.0, 45.0, 36.0, 120.0, 100.0, 80.0, 100.0, 229.0, 46.0, 280.0, 50.0, 30.0, -43.0, 160.0, 50.0, 120.0, 70.0, 89.0, 58.0, 40.0, 160.0, 38.0, 164.0, 33.0, 43.0, 80.0, 60.0, 30.0, 60.0, 140.0, 200.0, 73.0, 127.0, 130.0, 100.0, 60.0, 70.0, 100.0, 110.0, 80.0, 80.0, 30.0, 80.0, 90.0, 200.0, 50.0, 85.0, 170.0, 20.0, 160.0, 70.0, 50.0, 210.0, 120.0, 120.0, 115.0, 110.0, 140.0, 120.0, 90.0, 20.0, 80.0, 65.0, 130.0, 34.0, 70.0, 100.0, 120.0, 60.0, 130.0, 36.0, 98.0, 120.0, 109.0, 100.0, 30.0, 60.0, 170.0, 100.0, 130.0, 100.0, 50.0, 50.0, 90.0, 110.0, 70.0, 140.0, 45.0, 140.0, -10.0, 60.0, 120.0, 40.0, 40.0, 62.0, 230.0, 80.0, 70.0, 221.0, 120.0, 60.0, 90.0, 55.0, 46.0, 170.0, 100.0, 40.0, 80.0, 120.0, 130.0, 170.0, 160.0, 110.0, 110.0, 38.0, 120.0, 104.0, 150.0, 100.0, 170.0, 120.0, 140.0, 40.0, 120.0, 80.0, 47.0, 100.0, 0.0, 9.0, 30.0, 89.0, 90.0, 90.0, 59.0, 46.0, 100.0, 60.0, 110.0, 90.0, 220.0, 220.0, -3.0, 15.0, 31.0, 110.0, 80.0, 80.0, 90.0, 60.0, 80.0, 60.0, 60.0, 10.0, 30.0, 70.0, 100.0, 160.0, 60.0, 90.0, 110.0, 180.0, 120.0, 80.0, 140.0, 80.0, 60.0, 120.0, 100.0, 40.0, 26.0, 90.0, 50.0, 124.0, 130.0, 30.0, 27.0, 30.0, -3.0, 30.0, 250.0, 30.0, 24.0, 35.0, 50.0, 130.0, 110.0, 50.0, 70.0, 60.0, 50.0, 90.0, 35.0, 90.0, 80.0, 70.0, 120.0, 119.0, 40.0, 24.0, 100.0, 61.0, 150.0, 90.0, 195.0, 35.0, 68.0, 3.0, 50.0, 160.0, 50.0, 150.0, 19.0, 170.0, 120.0, 100.0, 150.0, 130.0, 120.0, 90.0, 100.0, 150.0, 90.0, 54.0, 48.0, 100.0, 120.0, 150.0, 130.0, 109.0, 146.0, 70.0, 140.0, 160.0, 110.0, 130.0, 120.0, 3.0, 85.0, 140.0, 100.0, 43.0, 30.0, 50.0, 140.0, 50.0, 107.0, 50.0, 140.0, 75.0, 200.0, 129.0, 90.0, 90.0, 120.0, 90.0, 119.0, 70.0, 94.0, 190.0, 61.0, 95.0, 40.0, 120.0, 170.0, 90.0, 39.0, 35.0, 50.0, 180.0, 130.0, 130.0, 160.0, 140.0, 160.0, 64.0, 77.0, 80.0, 65.0, 66.0, 150.0, 0.0, 140.0, 127.0, -17.0, 205.0, 248.0, 110.0, 70.0, 80.0, -25.0, 20.0, 60.0, 54.0, 70.0, 50.0, 160.0, 190.0, 60.0, 90.0, 110.0, 90.0, 220.0, 70.0, 80.0, 90.0, 109.0, 78.0, 70.0, 60.0, 110.0, 40.0, 110.0, 180.0, 110.0, 40.0, 160.0, 110.0, 70.0, 110.0, 20.0, 90.0, 90.0, 184.0, 150.0, 112.0, 0.0, 189.0, 129.0, 130.0, 90.0, 48.0, 5.0, 119.0, 60.0, 40.0, 89.0, 88.0, 100.0, 110.0, 55.0, 170.0, 30.0, 150.0, 110.0, 70.0, 32.0, 90.0, 152.0, 60.0, 80.0, 140.0, 119.0, 60.0, 120.0, 120.0, 140.0, 160.0, 130.0, 120.0, 170.0, 70.0, 150.0, 130.0, 210.0, 70.0, 95.0, 72.0, 105.0, 40.0, 105.0, 180.0, 90.0, 60.0, 60.0, 47.0, 90.0, 140.0, 80.0, 70.0, 120.0, 91.0, 45.0, 54.0, 100.0, 150.0, 4.0, 50.0, 60.0, 140.0, 160.0, 79.0, 80.0, 230.0, 145.0, 50.0, 80.0, 80.0, 110.0, 40.0, 40.0, 60.0, 140.0, 80.0, 100.0, 44.0, 20.0, 50.0, 90.0, 50.0, 56.0, 50.0, 60.0, 52.0, 70.0, 200.0, 120.0, 150.0, 110.0, 100.0, 110.0, 190.0, 70.0, 140.0, 70.0, 110.0, 30.0, 180.0, 80.0, 60.0, 140.0, 100.0, 100.0, 180.0, 40.0, 70.0, 50.0, 80.0, 25.0, 160.0, 80.0, 30.0, 130.0, -50.0, 62.0, 105.0, 70.0, 77.0, 70.0, 100.0, 100.0, 120.0, 70.0, 50.0, 100.0, 90.0, 130.0, 80.0, 230.0, 100.0, 118.0, 90.0, 120.0, 60.0, 137.0, 20.0, 170.0, 150.0, 40.0, 120.0, 130.0, 173.0, 130.0, 60.0, 106.0, 111.0, 110.0, 41.0, 100.0, 92.0, 190.0, 76.0, 160.0, 50.0, 25.0, 105.0, 110.0, 81.0, 45.0, 140.0, 160.0, 160.0, 100.0, 34.0, 90.0, 40.0, 60.0, 5.0, 50.0, 150.0, 50.0, 170.0, 52.0, 20.0, 50.0, 80.0, 90.0, 110.0, 90.0, 50.0, 100.0, 50.0, 80.0, 70.0, 60.0, 28.0, 20.0, 60.0, 100.0, 80.0, 110.0, 56.0, 60.0, 79.0, 27.0, 90.0, 170.0, 75.0, 70.0, 130.0, 100.0, 268.0, 50.0, 70.0, 40.0, 175.0, 140.0, 90.0, 80.0, 60.0, 110.0, 110.0, 120.0, 60.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7324276250376511, "mean_inference_ms": 1.7330316657000577, "mean_action_processing_ms": 0.5202029164748827, "mean_env_wait_ms": 1.174823658266115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012098550796508789, "StateBufferConnector_ms": 0.00868678092956543, "ViewRequirementAgentConnector_ms": 0.38855957984924316}, "num_episodes": 18, "episode_return_max": 1400.0, "episode_return_min": 503.0, "episode_return_mean": 935.82}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.558274400096426, "num_env_steps_trained_throughput_per_sec": 20.558274400096426, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 3800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3800000, "timers": {"training_iteration_time_ms": 193659.44, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193659.395, "sample_time_ms": 2356.876, "learn_time_ms": 191282.766, "learn_throughput": 20.911, "synch_weights_time_ms": 11.382}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "done": false, "training_iteration": 95, "trial_id": "1841f_00000", "date": "2024-08-08_04-49-23", "timestamp": 1723106963, "time_this_iter_s": 194.57797598838806, "time_total_s": 19747.303052425385, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b5672700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19747.303052425385, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 17.123272727272727, "ram_util_percent": 77.73672727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.981694040816432, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.452341491599688, "policy_loss": -0.015089032129921154, "vf_loss": 8.465965445176227, "vf_explained_var": -0.00826207975102182, "kl": 0.0073253728986981325, "entropy": 0.5071742188022794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 896745.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "env_runners": {"episode_reward_max": 1430.0, "episode_reward_min": 290.0, "episode_reward_mean": 953.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 95.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1195.0, 1218.0, 1220.0, 955.0, 1163.0, 693.0, 1114.0, 987.0, 911.0, 705.0, 747.0, 1080.0, 895.0, 1342.0, 1152.0, 1052.0, 573.0, 844.0, 747.0, 838.0, 945.0, 982.0, 931.0, 1032.0, 822.0, 943.0, 800.0, 1135.0, 990.0, 877.0, 880.0, 755.0, 1034.0, 1190.0, 1102.0, 594.0, 889.0, 660.0, 1110.0, 820.0, 503.0, 765.0, 969.0, 825.0, 1032.0, 1235.0, 841.0, 1051.0, 1049.0, 1114.0, 752.0, 892.0, 1120.0, 957.0, 1024.0, 882.0, 942.0, 923.0, 1400.0, 877.0, 837.0, 1098.0, 780.0, 542.0, 1260.0, 1020.0, 637.0, 862.0, 1155.0, 1099.0, 955.0, 1025.0, 647.0, 780.0, 620.0, 1063.0, 995.0, 1003.0, 1216.0, 849.0, 1154.0, 1430.0, 1075.0, 629.0, 838.0, 1160.0, 935.0, 954.0, 1139.0, 788.0, 613.0, 970.0, 1223.0, 1230.0, 838.0, 946.0, 930.0, 1350.0, 1290.0, 290.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 120.0, 120.0, 190.0, 210.0, 130.0, 25.0, 90.0, 110.0, 150.0, 160.0, 100.0, 60.0, 160.0, 230.0, 80.0, 130.0, 180.0, 38.0, 80.0, 120.0, 110.0, 90.0, 60.0, 170.0, 50.0, 140.0, 110.0, 200.0, 170.0, 70.0, 60.0, 136.0, 80.0, 120.0, 180.0, 50.0, 40.0, 210.0, 9.0, 160.0, 130.0, 110.0, 120.0, 180.0, 77.0, 150.0, 46.0, 70.0, 120.0, 8.0, 40.0, 150.0, 170.0, 35.0, 10.0, 90.0, 40.0, 90.0, 60.0, 120.0, 60.0, 110.0, 128.0, 110.0, 130.0, 150.0, 67.0, 120.0, 119.0, 130.0, 98.0, 90.0, 170.0, 80.0, 170.0, 45.0, 40.0, 80.0, 84.0, 140.0, 54.0, 126.0, 60.0, 100.0, 60.0, 15.0, 250.0, 46.0, 60.0, 110.0, 120.0, 70.0, 50.0, -10.0, 45.0, 110.0, 140.0, 60.0, 10.0, 150.0, 37.0, 35.0, 30.0, 140.0, 50.0, 40.0, 95.0, 90.0, 80.0, 30.0, 110.0, 100.0, 230.0, 130.0, 120.0, 100.0, 100.0, 50.0, 110.0, 50.0, 130.0, 100.0, 110.0, 50.0, 105.0, 130.0, 70.0, 100.0, 50.0, 158.0, 140.0, 90.0, 80.0, 140.0, 160.0, 44.0, 140.0, 160.0, 230.0, 50.0, 130.0, 130.0, 130.0, 60.0, 227.0, 46.0, 150.0, 90.0, 139.0, 15.0, 120.0, 130.0, 100.0, 140.0, 157.0, 130.0, 70.0, 120.0, 70.0, 110.0, 70.0, 5.0, 30.0, 88.0, 57.0, 69.0, 125.0, -21.0, 40.0, 80.0, 120.0, 40.0, 125.0, 30.0, 39.0, 88.0, 67.0, 118.0, 137.0, 50.0, 30.0, 40.0, 30.0, 190.0, 60.0, 110.0, 38.0, 49.0, 150.0, 72.0, 90.0, 70.0, 70.0, 140.0, 115.0, 75.0, 70.0, 90.0, 46.0, 70.0, -135.0, 150.0, 100.0, 160.0, 110.0, 190.0, 70.0, 80.0, 150.0, 160.0, 56.0, 79.0, 137.0, 70.0, 180.0, 50.0, 130.0, 80.0, 40.0, 70.0, 85.0, 170.0, 50.0, 115.0, 90.0, 150.0, 45.0, 36.0, 120.0, 100.0, 80.0, 100.0, 229.0, 46.0, 280.0, 50.0, 30.0, -43.0, 160.0, 50.0, 120.0, 70.0, 89.0, 58.0, 40.0, 160.0, 38.0, 164.0, 33.0, 43.0, 80.0, 60.0, 30.0, 60.0, 140.0, 200.0, 73.0, 127.0, 130.0, 100.0, 60.0, 70.0, 100.0, 110.0, 80.0, 80.0, 30.0, 80.0, 90.0, 200.0, 50.0, 85.0, 170.0, 20.0, 160.0, 70.0, 50.0, 210.0, 120.0, 120.0, 115.0, 110.0, 140.0, 120.0, 90.0, 20.0, 80.0, 65.0, 130.0, 34.0, 70.0, 100.0, 120.0, 60.0, 130.0, 36.0, 98.0, 120.0, 109.0, 100.0, 30.0, 60.0, 170.0, 100.0, 130.0, 100.0, 50.0, 50.0, 90.0, 110.0, 70.0, 140.0, 45.0, 140.0, -10.0, 60.0, 120.0, 40.0, 40.0, 62.0, 230.0, 80.0, 70.0, 221.0, 120.0, 60.0, 90.0, 55.0, 46.0, 170.0, 100.0, 40.0, 80.0, 120.0, 130.0, 170.0, 160.0, 110.0, 110.0, 38.0, 120.0, 104.0, 150.0, 100.0, 170.0, 120.0, 140.0, 40.0, 120.0, 80.0, 47.0, 100.0, 0.0, 9.0, 30.0, 89.0, 90.0, 90.0, 59.0, 46.0, 100.0, 60.0, 110.0, 90.0, 220.0, 220.0, -3.0, 15.0, 31.0, 110.0, 80.0, 80.0, 90.0, 60.0, 80.0, 60.0, 60.0, 10.0, 30.0, 70.0, 100.0, 160.0, 60.0, 90.0, 110.0, 180.0, 120.0, 80.0, 140.0, 80.0, 60.0, 120.0, 100.0, 40.0, 26.0, 90.0, 50.0, 124.0, 130.0, 30.0, 27.0, 30.0, -3.0, 30.0, 250.0, 30.0, 24.0, 35.0, 50.0, 130.0, 110.0, 50.0, 70.0, 60.0, 50.0, 90.0, 35.0, 90.0, 80.0, 70.0, 120.0, 119.0, 40.0, 24.0, 100.0, 61.0, 150.0, 90.0, 195.0, 35.0, 68.0, 3.0, 50.0, 160.0, 50.0, 150.0, 19.0, 170.0, 120.0, 100.0, 150.0, 130.0, 120.0, 90.0, 100.0, 150.0, 90.0, 54.0, 48.0, 100.0, 120.0, 150.0, 130.0, 109.0, 146.0, 70.0, 140.0, 160.0, 110.0, 130.0, 120.0, 3.0, 85.0, 140.0, 100.0, 43.0, 30.0, 50.0, 140.0, 50.0, 107.0, 50.0, 140.0, 75.0, 200.0, 129.0, 90.0, 90.0, 120.0, 90.0, 119.0, 70.0, 94.0, 190.0, 61.0, 95.0, 40.0, 120.0, 170.0, 90.0, 39.0, 35.0, 50.0, 180.0, 130.0, 130.0, 160.0, 140.0, 160.0, 64.0, 77.0, 80.0, 65.0, 66.0, 150.0, 0.0, 140.0, 127.0, -17.0, 205.0, 248.0, 110.0, 70.0, 80.0, -25.0, 20.0, 60.0, 54.0, 70.0, 50.0, 160.0, 190.0, 60.0, 90.0, 110.0, 90.0, 220.0, 70.0, 80.0, 90.0, 109.0, 78.0, 70.0, 60.0, 110.0, 40.0, 110.0, 180.0, 110.0, 40.0, 160.0, 110.0, 70.0, 110.0, 20.0, 90.0, 90.0, 184.0, 150.0, 112.0, 0.0, 189.0, 129.0, 130.0, 90.0, 48.0, 5.0, 119.0, 60.0, 40.0, 89.0, 88.0, 100.0, 110.0, 55.0, 170.0, 30.0, 150.0, 110.0, 70.0, 32.0, 90.0, 152.0, 60.0, 80.0, 140.0, 119.0, 60.0, 120.0, 120.0, 140.0, 160.0, 130.0, 120.0, 170.0, 70.0, 150.0, 130.0, 210.0, 70.0, 95.0, 72.0, 105.0, 40.0, 105.0, 180.0, 90.0, 60.0, 60.0, 47.0, 90.0, 140.0, 80.0, 70.0, 120.0, 91.0, 45.0, 54.0, 100.0, 150.0, 4.0, 50.0, 60.0, 140.0, 160.0, 79.0, 80.0, 230.0, 145.0, 50.0, 80.0, 80.0, 110.0, 40.0, 40.0, 60.0, 140.0, 80.0, 100.0, 44.0, 20.0, 50.0, 90.0, 50.0, 56.0, 50.0, 60.0, 52.0, 70.0, 200.0, 120.0, 150.0, 110.0, 100.0, 110.0, 190.0, 70.0, 140.0, 70.0, 110.0, 30.0, 180.0, 80.0, 60.0, 140.0, 100.0, 100.0, 180.0, 40.0, 70.0, 50.0, 80.0, 25.0, 160.0, 80.0, 30.0, 130.0, -50.0, 62.0, 105.0, 70.0, 77.0, 70.0, 100.0, 100.0, 120.0, 70.0, 50.0, 100.0, 90.0, 130.0, 80.0, 230.0, 100.0, 118.0, 90.0, 120.0, 60.0, 137.0, 20.0, 170.0, 150.0, 40.0, 120.0, 130.0, 173.0, 130.0, 60.0, 106.0, 111.0, 110.0, 41.0, 100.0, 92.0, 190.0, 76.0, 160.0, 50.0, 25.0, 105.0, 110.0, 81.0, 45.0, 140.0, 160.0, 160.0, 100.0, 34.0, 90.0, 40.0, 60.0, 5.0, 50.0, 150.0, 50.0, 170.0, 52.0, 20.0, 50.0, 80.0, 90.0, 110.0, 90.0, 50.0, 100.0, 50.0, 80.0, 70.0, 60.0, 28.0, 20.0, 60.0, 100.0, 80.0, 110.0, 56.0, 60.0, 79.0, 27.0, 90.0, 170.0, 75.0, 70.0, 130.0, 100.0, 268.0, 50.0, 70.0, 40.0, 175.0, 140.0, 90.0, 80.0, 60.0, 110.0, 110.0, 120.0, 60.0, 50.0, 50.0, 45.0, 100.0, 50.0, 78.0, 130.0, 80.0, 130.0, 200.0, 140.0, 130.0, 220.0, 140.0, 160.0, 110.0, 18.0, 90.0, 210.0, 68.0, 70.0, 100.0, 90.0, 50.0, 150.0, 40.0, 39.0, 150.0, 50.0, 150.0, 30.0, 100.0, 180.0, 65.0, 120.0, 130.0, 60.0, 80.0, 99.0, 220.0, 100.0, 110.0, 110.0, 150.0, 130.0, 119.0, 106.0, 115.0, 180.0, 160.0, 250.0, 140.0, 100.0, 60.0, 110.0, 180.0, 120.0, 85.0, 100.0, 110.0, 70.0, 80.0, 50.0, 60.0, 50.0, 40.0, 50.0, 59.0, 110.0, 30.0, 100.0, 100.0, 85.0, -65.0, 90.0, 39.0, 70.0, 70.0, 119.0, 140.0, 190.0, 90.0, 120.0, 70.0, 70.0, 70.0, 185.0, 210.0, 70.0, 150.0, 125.0, 40.0, 70.0, 110.0, 40.0, 200.0, 55.0, 70.0, 100.0, 140.0, 110.0, 100.0, 90.0, 160.0, 22.0, 160.0, 170.0, 100.0, 42.0, 70.0, 40.0, 160.0, 80.0, 80.0, 42.0, 120.0, 80.0, 140.0, 27.0, 260.0, 150.0, 70.0, 69.0, 180.0, 25.0, 19.0, 90.0, 37.0, 140.0, 58.0, 100.0, 10.0, 40.0, 27.0, 57.0, 80.0, 29.0, 160.0, 90.0, 70.0, 50.0, 150.0, 70.0, 90.0, 80.0, 10.0, 110.0, 90.0, 130.0, 110.0, 130.0, 130.0, 190.0, 70.0, 220.0, 100.0, 130.0, 57.0, 110.0, 46.0, 170.0, 80.0, 130.0, 130.0, 90.0, 160.0, 300.0, 120.0, 70.0, 70.0, 80.0, 75.0, 70.0, 200.0, 80.0, 46.0, 100.0, 50.0, 60.0, 90.0, 67.0, 100.0, 120.0, 60.0, 37.0, 80.0, 70.0, 49.0, 140.0, 140.0, 150.0, 100.0, 40.0, 80.0, -70.0, 70.0, 220.0, 110.0, 140.0, 90.0, 150.0, 120.0, 130.0, 30.0, 130.0, 200.0, 260.0, 70.0, 170.0, 160.0, 80.0, 160.0, 120.0, 140.0, 170.0, 100.0, 110.0, 160.0, 140.0, 120.0, 70.0, 5.0, 15.0, 20.0, 30.0, 30.0, 90.0, 70.0, 0.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7279739314233464, "mean_inference_ms": 1.7282808173915898, "mean_action_processing_ms": 0.5192256253087255, "mean_env_wait_ms": 1.1726693921408446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012037277221679688, "StateBufferConnector_ms": 0.00864720344543457, "ViewRequirementAgentConnector_ms": 0.385556697845459}, "num_episodes": 23, "episode_return_max": 1430.0, "episode_return_min": 290.0, "episode_return_mean": 953.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.449716172088596, "num_env_steps_trained_throughput_per_sec": 20.449716172088596, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 3840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3840000, "timers": {"training_iteration_time_ms": 193942.557, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193942.513, "sample_time_ms": 2373.611, "learn_time_ms": 191548.971, "learn_throughput": 20.882, "synch_weights_time_ms": 11.573}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "done": false, "training_iteration": 96, "trial_id": "1841f_00000", "date": "2024-08-08_04-52-39", "timestamp": 1723107159, "time_this_iter_s": 195.61127400398254, "time_total_s": 19942.914326429367, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b5672ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19942.914326429367, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 19.940072202166064, "ram_util_percent": 77.24404332129963}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0879739921567793, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.812081474186387, "policy_loss": -0.015083273297128158, "vf_loss": 8.825560394364297, "vf_explained_var": -0.03930172924670421, "kl": 0.008021826866572879, "entropy": 0.5117686040612202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 906135.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "env_runners": {"episode_reward_max": 1430.0, "episode_reward_min": 290.0, "episode_reward_mean": 948.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 94.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [747.0, 838.0, 945.0, 982.0, 931.0, 1032.0, 822.0, 943.0, 800.0, 1135.0, 990.0, 877.0, 880.0, 755.0, 1034.0, 1190.0, 1102.0, 594.0, 889.0, 660.0, 1110.0, 820.0, 503.0, 765.0, 969.0, 825.0, 1032.0, 1235.0, 841.0, 1051.0, 1049.0, 1114.0, 752.0, 892.0, 1120.0, 957.0, 1024.0, 882.0, 942.0, 923.0, 1400.0, 877.0, 837.0, 1098.0, 780.0, 542.0, 1260.0, 1020.0, 637.0, 862.0, 1155.0, 1099.0, 955.0, 1025.0, 647.0, 780.0, 620.0, 1063.0, 995.0, 1003.0, 1216.0, 849.0, 1154.0, 1430.0, 1075.0, 629.0, 838.0, 1160.0, 935.0, 954.0, 1139.0, 788.0, 613.0, 970.0, 1223.0, 1230.0, 838.0, 946.0, 930.0, 1350.0, 1290.0, 290.0, 759.0, 628.0, 847.0, 1134.0, 887.0, 889.0, 1090.0, 1021.0, 1046.0, 583.0, 1157.0, 887.0, 1078.0, 1055.0, 996.0, 1340.0, 971.0, 1043.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 30.0, 40.0, 30.0, 190.0, 60.0, 110.0, 38.0, 49.0, 150.0, 72.0, 90.0, 70.0, 70.0, 140.0, 115.0, 75.0, 70.0, 90.0, 46.0, 70.0, -135.0, 150.0, 100.0, 160.0, 110.0, 190.0, 70.0, 80.0, 150.0, 160.0, 56.0, 79.0, 137.0, 70.0, 180.0, 50.0, 130.0, 80.0, 40.0, 70.0, 85.0, 170.0, 50.0, 115.0, 90.0, 150.0, 45.0, 36.0, 120.0, 100.0, 80.0, 100.0, 229.0, 46.0, 280.0, 50.0, 30.0, -43.0, 160.0, 50.0, 120.0, 70.0, 89.0, 58.0, 40.0, 160.0, 38.0, 164.0, 33.0, 43.0, 80.0, 60.0, 30.0, 60.0, 140.0, 200.0, 73.0, 127.0, 130.0, 100.0, 60.0, 70.0, 100.0, 110.0, 80.0, 80.0, 30.0, 80.0, 90.0, 200.0, 50.0, 85.0, 170.0, 20.0, 160.0, 70.0, 50.0, 210.0, 120.0, 120.0, 115.0, 110.0, 140.0, 120.0, 90.0, 20.0, 80.0, 65.0, 130.0, 34.0, 70.0, 100.0, 120.0, 60.0, 130.0, 36.0, 98.0, 120.0, 109.0, 100.0, 30.0, 60.0, 170.0, 100.0, 130.0, 100.0, 50.0, 50.0, 90.0, 110.0, 70.0, 140.0, 45.0, 140.0, -10.0, 60.0, 120.0, 40.0, 40.0, 62.0, 230.0, 80.0, 70.0, 221.0, 120.0, 60.0, 90.0, 55.0, 46.0, 170.0, 100.0, 40.0, 80.0, 120.0, 130.0, 170.0, 160.0, 110.0, 110.0, 38.0, 120.0, 104.0, 150.0, 100.0, 170.0, 120.0, 140.0, 40.0, 120.0, 80.0, 47.0, 100.0, 0.0, 9.0, 30.0, 89.0, 90.0, 90.0, 59.0, 46.0, 100.0, 60.0, 110.0, 90.0, 220.0, 220.0, -3.0, 15.0, 31.0, 110.0, 80.0, 80.0, 90.0, 60.0, 80.0, 60.0, 60.0, 10.0, 30.0, 70.0, 100.0, 160.0, 60.0, 90.0, 110.0, 180.0, 120.0, 80.0, 140.0, 80.0, 60.0, 120.0, 100.0, 40.0, 26.0, 90.0, 50.0, 124.0, 130.0, 30.0, 27.0, 30.0, -3.0, 30.0, 250.0, 30.0, 24.0, 35.0, 50.0, 130.0, 110.0, 50.0, 70.0, 60.0, 50.0, 90.0, 35.0, 90.0, 80.0, 70.0, 120.0, 119.0, 40.0, 24.0, 100.0, 61.0, 150.0, 90.0, 195.0, 35.0, 68.0, 3.0, 50.0, 160.0, 50.0, 150.0, 19.0, 170.0, 120.0, 100.0, 150.0, 130.0, 120.0, 90.0, 100.0, 150.0, 90.0, 54.0, 48.0, 100.0, 120.0, 150.0, 130.0, 109.0, 146.0, 70.0, 140.0, 160.0, 110.0, 130.0, 120.0, 3.0, 85.0, 140.0, 100.0, 43.0, 30.0, 50.0, 140.0, 50.0, 107.0, 50.0, 140.0, 75.0, 200.0, 129.0, 90.0, 90.0, 120.0, 90.0, 119.0, 70.0, 94.0, 190.0, 61.0, 95.0, 40.0, 120.0, 170.0, 90.0, 39.0, 35.0, 50.0, 180.0, 130.0, 130.0, 160.0, 140.0, 160.0, 64.0, 77.0, 80.0, 65.0, 66.0, 150.0, 0.0, 140.0, 127.0, -17.0, 205.0, 248.0, 110.0, 70.0, 80.0, -25.0, 20.0, 60.0, 54.0, 70.0, 50.0, 160.0, 190.0, 60.0, 90.0, 110.0, 90.0, 220.0, 70.0, 80.0, 90.0, 109.0, 78.0, 70.0, 60.0, 110.0, 40.0, 110.0, 180.0, 110.0, 40.0, 160.0, 110.0, 70.0, 110.0, 20.0, 90.0, 90.0, 184.0, 150.0, 112.0, 0.0, 189.0, 129.0, 130.0, 90.0, 48.0, 5.0, 119.0, 60.0, 40.0, 89.0, 88.0, 100.0, 110.0, 55.0, 170.0, 30.0, 150.0, 110.0, 70.0, 32.0, 90.0, 152.0, 60.0, 80.0, 140.0, 119.0, 60.0, 120.0, 120.0, 140.0, 160.0, 130.0, 120.0, 170.0, 70.0, 150.0, 130.0, 210.0, 70.0, 95.0, 72.0, 105.0, 40.0, 105.0, 180.0, 90.0, 60.0, 60.0, 47.0, 90.0, 140.0, 80.0, 70.0, 120.0, 91.0, 45.0, 54.0, 100.0, 150.0, 4.0, 50.0, 60.0, 140.0, 160.0, 79.0, 80.0, 230.0, 145.0, 50.0, 80.0, 80.0, 110.0, 40.0, 40.0, 60.0, 140.0, 80.0, 100.0, 44.0, 20.0, 50.0, 90.0, 50.0, 56.0, 50.0, 60.0, 52.0, 70.0, 200.0, 120.0, 150.0, 110.0, 100.0, 110.0, 190.0, 70.0, 140.0, 70.0, 110.0, 30.0, 180.0, 80.0, 60.0, 140.0, 100.0, 100.0, 180.0, 40.0, 70.0, 50.0, 80.0, 25.0, 160.0, 80.0, 30.0, 130.0, -50.0, 62.0, 105.0, 70.0, 77.0, 70.0, 100.0, 100.0, 120.0, 70.0, 50.0, 100.0, 90.0, 130.0, 80.0, 230.0, 100.0, 118.0, 90.0, 120.0, 60.0, 137.0, 20.0, 170.0, 150.0, 40.0, 120.0, 130.0, 173.0, 130.0, 60.0, 106.0, 111.0, 110.0, 41.0, 100.0, 92.0, 190.0, 76.0, 160.0, 50.0, 25.0, 105.0, 110.0, 81.0, 45.0, 140.0, 160.0, 160.0, 100.0, 34.0, 90.0, 40.0, 60.0, 5.0, 50.0, 150.0, 50.0, 170.0, 52.0, 20.0, 50.0, 80.0, 90.0, 110.0, 90.0, 50.0, 100.0, 50.0, 80.0, 70.0, 60.0, 28.0, 20.0, 60.0, 100.0, 80.0, 110.0, 56.0, 60.0, 79.0, 27.0, 90.0, 170.0, 75.0, 70.0, 130.0, 100.0, 268.0, 50.0, 70.0, 40.0, 175.0, 140.0, 90.0, 80.0, 60.0, 110.0, 110.0, 120.0, 60.0, 50.0, 50.0, 45.0, 100.0, 50.0, 78.0, 130.0, 80.0, 130.0, 200.0, 140.0, 130.0, 220.0, 140.0, 160.0, 110.0, 18.0, 90.0, 210.0, 68.0, 70.0, 100.0, 90.0, 50.0, 150.0, 40.0, 39.0, 150.0, 50.0, 150.0, 30.0, 100.0, 180.0, 65.0, 120.0, 130.0, 60.0, 80.0, 99.0, 220.0, 100.0, 110.0, 110.0, 150.0, 130.0, 119.0, 106.0, 115.0, 180.0, 160.0, 250.0, 140.0, 100.0, 60.0, 110.0, 180.0, 120.0, 85.0, 100.0, 110.0, 70.0, 80.0, 50.0, 60.0, 50.0, 40.0, 50.0, 59.0, 110.0, 30.0, 100.0, 100.0, 85.0, -65.0, 90.0, 39.0, 70.0, 70.0, 119.0, 140.0, 190.0, 90.0, 120.0, 70.0, 70.0, 70.0, 185.0, 210.0, 70.0, 150.0, 125.0, 40.0, 70.0, 110.0, 40.0, 200.0, 55.0, 70.0, 100.0, 140.0, 110.0, 100.0, 90.0, 160.0, 22.0, 160.0, 170.0, 100.0, 42.0, 70.0, 40.0, 160.0, 80.0, 80.0, 42.0, 120.0, 80.0, 140.0, 27.0, 260.0, 150.0, 70.0, 69.0, 180.0, 25.0, 19.0, 90.0, 37.0, 140.0, 58.0, 100.0, 10.0, 40.0, 27.0, 57.0, 80.0, 29.0, 160.0, 90.0, 70.0, 50.0, 150.0, 70.0, 90.0, 80.0, 10.0, 110.0, 90.0, 130.0, 110.0, 130.0, 130.0, 190.0, 70.0, 220.0, 100.0, 130.0, 57.0, 110.0, 46.0, 170.0, 80.0, 130.0, 130.0, 90.0, 160.0, 300.0, 120.0, 70.0, 70.0, 80.0, 75.0, 70.0, 200.0, 80.0, 46.0, 100.0, 50.0, 60.0, 90.0, 67.0, 100.0, 120.0, 60.0, 37.0, 80.0, 70.0, 49.0, 140.0, 140.0, 150.0, 100.0, 40.0, 80.0, -70.0, 70.0, 220.0, 110.0, 140.0, 90.0, 150.0, 120.0, 130.0, 30.0, 130.0, 200.0, 260.0, 70.0, 170.0, 160.0, 80.0, 160.0, 120.0, 140.0, 170.0, 100.0, 110.0, 160.0, 140.0, 120.0, 70.0, 5.0, 15.0, 20.0, 30.0, 30.0, 90.0, 70.0, 0.0, 20.0, 10.0, 60.0, 60.0, 100.0, 0.0, 75.0, 120.0, 130.0, 130.0, 14.0, 70.0, 30.0, 56.0, 2.0, 30.0, 110.0, 70.0, 90.0, 110.0, 70.0, 60.0, 80.0, 114.0, 73.0, 90.0, 130.0, 80.0, 30.0, 120.0, 60.0, 70.0, 100.0, 29.0, 64.0, 70.0, 240.0, 190.0, 51.0, 100.0, 130.0, 160.0, 100.0, 69.0, 140.0, 79.0, 70.0, 50.0, 130.0, 94.0, 25.0, 130.0, 30.0, 100.0, 120.0, 120.0, 70.0, 90.0, 60.0, 50.0, 39.0, 210.0, 50.0, 120.0, 180.0, 10.0, 110.0, 120.0, 100.0, 160.0, 110.0, 130.0, 110.0, 90.0, 78.0, 90.0, 110.0, 100.0, 120.0, 103.0, 110.0, 110.0, 120.0, 90.0, 80.0, 90.0, 120.0, 80.0, 118.0, 130.0, 100.0, 118.0, 7.0, 77.0, 103.0, 60.0, 50.0, 52.0, 136.0, 50.0, -23.0, 71.0, 180.0, 17.0, 70.0, 126.0, 180.0, 180.0, 90.0, 115.0, 109.0, 90.0, 130.0, 80.0, 110.0, 110.0, 49.0, 59.0, 110.0, 99.0, 80.0, 60.0, 130.0, 100.0, 160.0, 70.0, 120.0, 170.0, 120.0, 130.0, 28.0, 50.0, 20.0, 70.0, 80.0, 160.0, 120.0, 180.0, 280.0, 40.0, 90.0, 15.0, 100.0, 65.0, 70.0, 130.0, 160.0, 88.0, 117.0, 80.0, 99.0, 87.0, 170.0, 70.0, 140.0, 110.0, 140.0, 200.0, 70.0, 200.0, 110.0, 130.0, 167.0, 120.0, 90.0, 150.0, 90.0, 70.0, 64.0, 50.0, 20.0, 150.0, 140.0, 140.0, 36.0, 210.0, 90.0, 17.0, 130.0, 60.0, 130.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7245092374614897, "mean_inference_ms": 1.7245814355487719, "mean_action_processing_ms": 0.5184361643332682, "mean_env_wait_ms": 1.170914647567504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011497259140014648, "StateBufferConnector_ms": 0.008678913116455078, "ViewRequirementAgentConnector_ms": 0.37297511100769043}, "num_episodes": 18, "episode_return_max": 1430.0, "episode_return_min": 290.0, "episode_return_mean": 948.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.626826697634893, "num_env_steps_trained_throughput_per_sec": 20.626826697634893, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 3880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3880000, "timers": {"training_iteration_time_ms": 194072.536, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194072.49, "sample_time_ms": 2398.946, "learn_time_ms": 191653.781, "learn_throughput": 20.871, "synch_weights_time_ms": 11.545}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "done": false, "training_iteration": 97, "trial_id": "1841f_00000", "date": "2024-08-08_04-55-53", "timestamp": 1723107353, "time_this_iter_s": 193.93334889411926, "time_total_s": 20136.847675323486, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b56a1940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20136.847675323486, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 17.386861313868614, "ram_util_percent": 76.77408759124087}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3440171947240573, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.487752896198195, "policy_loss": -0.01547530572692823, "vf_loss": 8.501544275324438, "vf_explained_var": -0.04438825624819381, "kl": 0.00841964294125496, "entropy": 0.5416704119108736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 915525.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "env_runners": {"episode_reward_max": 1430.0, "episode_reward_min": 290.0, "episode_reward_mean": 955.04, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -70.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 95.504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [889.0, 660.0, 1110.0, 820.0, 503.0, 765.0, 969.0, 825.0, 1032.0, 1235.0, 841.0, 1051.0, 1049.0, 1114.0, 752.0, 892.0, 1120.0, 957.0, 1024.0, 882.0, 942.0, 923.0, 1400.0, 877.0, 837.0, 1098.0, 780.0, 542.0, 1260.0, 1020.0, 637.0, 862.0, 1155.0, 1099.0, 955.0, 1025.0, 647.0, 780.0, 620.0, 1063.0, 995.0, 1003.0, 1216.0, 849.0, 1154.0, 1430.0, 1075.0, 629.0, 838.0, 1160.0, 935.0, 954.0, 1139.0, 788.0, 613.0, 970.0, 1223.0, 1230.0, 838.0, 946.0, 930.0, 1350.0, 1290.0, 290.0, 759.0, 628.0, 847.0, 1134.0, 887.0, 889.0, 1090.0, 1021.0, 1046.0, 583.0, 1157.0, 887.0, 1078.0, 1055.0, 996.0, 1340.0, 971.0, 1043.0, 1120.0, 1182.0, 1060.0, 875.0, 890.0, 710.0, 870.0, 1247.0, 992.0, 1045.0, 796.0, 1365.0, 792.0, 639.0, 758.0, 975.0, 850.0, 1070.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [46.0, 100.0, 60.0, 110.0, 90.0, 220.0, 220.0, -3.0, 15.0, 31.0, 110.0, 80.0, 80.0, 90.0, 60.0, 80.0, 60.0, 60.0, 10.0, 30.0, 70.0, 100.0, 160.0, 60.0, 90.0, 110.0, 180.0, 120.0, 80.0, 140.0, 80.0, 60.0, 120.0, 100.0, 40.0, 26.0, 90.0, 50.0, 124.0, 130.0, 30.0, 27.0, 30.0, -3.0, 30.0, 250.0, 30.0, 24.0, 35.0, 50.0, 130.0, 110.0, 50.0, 70.0, 60.0, 50.0, 90.0, 35.0, 90.0, 80.0, 70.0, 120.0, 119.0, 40.0, 24.0, 100.0, 61.0, 150.0, 90.0, 195.0, 35.0, 68.0, 3.0, 50.0, 160.0, 50.0, 150.0, 19.0, 170.0, 120.0, 100.0, 150.0, 130.0, 120.0, 90.0, 100.0, 150.0, 90.0, 54.0, 48.0, 100.0, 120.0, 150.0, 130.0, 109.0, 146.0, 70.0, 140.0, 160.0, 110.0, 130.0, 120.0, 3.0, 85.0, 140.0, 100.0, 43.0, 30.0, 50.0, 140.0, 50.0, 107.0, 50.0, 140.0, 75.0, 200.0, 129.0, 90.0, 90.0, 120.0, 90.0, 119.0, 70.0, 94.0, 190.0, 61.0, 95.0, 40.0, 120.0, 170.0, 90.0, 39.0, 35.0, 50.0, 180.0, 130.0, 130.0, 160.0, 140.0, 160.0, 64.0, 77.0, 80.0, 65.0, 66.0, 150.0, 0.0, 140.0, 127.0, -17.0, 205.0, 248.0, 110.0, 70.0, 80.0, -25.0, 20.0, 60.0, 54.0, 70.0, 50.0, 160.0, 190.0, 60.0, 90.0, 110.0, 90.0, 220.0, 70.0, 80.0, 90.0, 109.0, 78.0, 70.0, 60.0, 110.0, 40.0, 110.0, 180.0, 110.0, 40.0, 160.0, 110.0, 70.0, 110.0, 20.0, 90.0, 90.0, 184.0, 150.0, 112.0, 0.0, 189.0, 129.0, 130.0, 90.0, 48.0, 5.0, 119.0, 60.0, 40.0, 89.0, 88.0, 100.0, 110.0, 55.0, 170.0, 30.0, 150.0, 110.0, 70.0, 32.0, 90.0, 152.0, 60.0, 80.0, 140.0, 119.0, 60.0, 120.0, 120.0, 140.0, 160.0, 130.0, 120.0, 170.0, 70.0, 150.0, 130.0, 210.0, 70.0, 95.0, 72.0, 105.0, 40.0, 105.0, 180.0, 90.0, 60.0, 60.0, 47.0, 90.0, 140.0, 80.0, 70.0, 120.0, 91.0, 45.0, 54.0, 100.0, 150.0, 4.0, 50.0, 60.0, 140.0, 160.0, 79.0, 80.0, 230.0, 145.0, 50.0, 80.0, 80.0, 110.0, 40.0, 40.0, 60.0, 140.0, 80.0, 100.0, 44.0, 20.0, 50.0, 90.0, 50.0, 56.0, 50.0, 60.0, 52.0, 70.0, 200.0, 120.0, 150.0, 110.0, 100.0, 110.0, 190.0, 70.0, 140.0, 70.0, 110.0, 30.0, 180.0, 80.0, 60.0, 140.0, 100.0, 100.0, 180.0, 40.0, 70.0, 50.0, 80.0, 25.0, 160.0, 80.0, 30.0, 130.0, -50.0, 62.0, 105.0, 70.0, 77.0, 70.0, 100.0, 100.0, 120.0, 70.0, 50.0, 100.0, 90.0, 130.0, 80.0, 230.0, 100.0, 118.0, 90.0, 120.0, 60.0, 137.0, 20.0, 170.0, 150.0, 40.0, 120.0, 130.0, 173.0, 130.0, 60.0, 106.0, 111.0, 110.0, 41.0, 100.0, 92.0, 190.0, 76.0, 160.0, 50.0, 25.0, 105.0, 110.0, 81.0, 45.0, 140.0, 160.0, 160.0, 100.0, 34.0, 90.0, 40.0, 60.0, 5.0, 50.0, 150.0, 50.0, 170.0, 52.0, 20.0, 50.0, 80.0, 90.0, 110.0, 90.0, 50.0, 100.0, 50.0, 80.0, 70.0, 60.0, 28.0, 20.0, 60.0, 100.0, 80.0, 110.0, 56.0, 60.0, 79.0, 27.0, 90.0, 170.0, 75.0, 70.0, 130.0, 100.0, 268.0, 50.0, 70.0, 40.0, 175.0, 140.0, 90.0, 80.0, 60.0, 110.0, 110.0, 120.0, 60.0, 50.0, 50.0, 45.0, 100.0, 50.0, 78.0, 130.0, 80.0, 130.0, 200.0, 140.0, 130.0, 220.0, 140.0, 160.0, 110.0, 18.0, 90.0, 210.0, 68.0, 70.0, 100.0, 90.0, 50.0, 150.0, 40.0, 39.0, 150.0, 50.0, 150.0, 30.0, 100.0, 180.0, 65.0, 120.0, 130.0, 60.0, 80.0, 99.0, 220.0, 100.0, 110.0, 110.0, 150.0, 130.0, 119.0, 106.0, 115.0, 180.0, 160.0, 250.0, 140.0, 100.0, 60.0, 110.0, 180.0, 120.0, 85.0, 100.0, 110.0, 70.0, 80.0, 50.0, 60.0, 50.0, 40.0, 50.0, 59.0, 110.0, 30.0, 100.0, 100.0, 85.0, -65.0, 90.0, 39.0, 70.0, 70.0, 119.0, 140.0, 190.0, 90.0, 120.0, 70.0, 70.0, 70.0, 185.0, 210.0, 70.0, 150.0, 125.0, 40.0, 70.0, 110.0, 40.0, 200.0, 55.0, 70.0, 100.0, 140.0, 110.0, 100.0, 90.0, 160.0, 22.0, 160.0, 170.0, 100.0, 42.0, 70.0, 40.0, 160.0, 80.0, 80.0, 42.0, 120.0, 80.0, 140.0, 27.0, 260.0, 150.0, 70.0, 69.0, 180.0, 25.0, 19.0, 90.0, 37.0, 140.0, 58.0, 100.0, 10.0, 40.0, 27.0, 57.0, 80.0, 29.0, 160.0, 90.0, 70.0, 50.0, 150.0, 70.0, 90.0, 80.0, 10.0, 110.0, 90.0, 130.0, 110.0, 130.0, 130.0, 190.0, 70.0, 220.0, 100.0, 130.0, 57.0, 110.0, 46.0, 170.0, 80.0, 130.0, 130.0, 90.0, 160.0, 300.0, 120.0, 70.0, 70.0, 80.0, 75.0, 70.0, 200.0, 80.0, 46.0, 100.0, 50.0, 60.0, 90.0, 67.0, 100.0, 120.0, 60.0, 37.0, 80.0, 70.0, 49.0, 140.0, 140.0, 150.0, 100.0, 40.0, 80.0, -70.0, 70.0, 220.0, 110.0, 140.0, 90.0, 150.0, 120.0, 130.0, 30.0, 130.0, 200.0, 260.0, 70.0, 170.0, 160.0, 80.0, 160.0, 120.0, 140.0, 170.0, 100.0, 110.0, 160.0, 140.0, 120.0, 70.0, 5.0, 15.0, 20.0, 30.0, 30.0, 90.0, 70.0, 0.0, 20.0, 10.0, 60.0, 60.0, 100.0, 0.0, 75.0, 120.0, 130.0, 130.0, 14.0, 70.0, 30.0, 56.0, 2.0, 30.0, 110.0, 70.0, 90.0, 110.0, 70.0, 60.0, 80.0, 114.0, 73.0, 90.0, 130.0, 80.0, 30.0, 120.0, 60.0, 70.0, 100.0, 29.0, 64.0, 70.0, 240.0, 190.0, 51.0, 100.0, 130.0, 160.0, 100.0, 69.0, 140.0, 79.0, 70.0, 50.0, 130.0, 94.0, 25.0, 130.0, 30.0, 100.0, 120.0, 120.0, 70.0, 90.0, 60.0, 50.0, 39.0, 210.0, 50.0, 120.0, 180.0, 10.0, 110.0, 120.0, 100.0, 160.0, 110.0, 130.0, 110.0, 90.0, 78.0, 90.0, 110.0, 100.0, 120.0, 103.0, 110.0, 110.0, 120.0, 90.0, 80.0, 90.0, 120.0, 80.0, 118.0, 130.0, 100.0, 118.0, 7.0, 77.0, 103.0, 60.0, 50.0, 52.0, 136.0, 50.0, -23.0, 71.0, 180.0, 17.0, 70.0, 126.0, 180.0, 180.0, 90.0, 115.0, 109.0, 90.0, 130.0, 80.0, 110.0, 110.0, 49.0, 59.0, 110.0, 99.0, 80.0, 60.0, 130.0, 100.0, 160.0, 70.0, 120.0, 170.0, 120.0, 130.0, 28.0, 50.0, 20.0, 70.0, 80.0, 160.0, 120.0, 180.0, 280.0, 40.0, 90.0, 15.0, 100.0, 65.0, 70.0, 130.0, 160.0, 88.0, 117.0, 80.0, 99.0, 87.0, 170.0, 70.0, 140.0, 110.0, 140.0, 200.0, 70.0, 200.0, 110.0, 130.0, 167.0, 120.0, 90.0, 150.0, 90.0, 70.0, 64.0, 50.0, 20.0, 150.0, 140.0, 140.0, 36.0, 210.0, 90.0, 17.0, 130.0, 60.0, 130.0, 90.0, 150.0, 100.0, 50.0, 130.0, 190.0, 130.0, 50.0, 80.0, 140.0, 100.0, 150.0, 190.0, 60.0, 70.0, 180.0, 110.0, 30.0, 162.0, 150.0, 80.0, 90.0, 70.0, 60.0, 120.0, 110.0, 70.0, 110.0, 100.0, 140.0, 190.0, 35.0, 90.0, 100.0, 140.0, 120.0, 100.0, 90.0, 70.0, 80.0, 50.0, 120.0, 130.0, 80.0, 60.0, 130.0, 20.0, 50.0, 110.0, 90.0, 100.0, 100.0, 100.0, 130.0, 50.0, 150.0, -45.0, 75.0, 40.0, 60.0, 50.0, 100.0, 40.0, 190.0, 50.0, 90.0, 100.0, 60.0, 50.0, 70.0, 120.0, 110.0, 100.0, 100.0, 210.0, 160.0, 250.0, 120.0, 90.0, 47.0, 60.0, 86.0, 170.0, 130.0, 16.0, 60.0, 140.0, 86.0, 94.0, 100.0, 110.0, 220.0, 60.0, 50.0, 40.0, 90.0, 180.0, 170.0, 60.0, 90.0, 85.0, 100.0, 100.0, 90.0, 20.0, 40.0, 160.0, 90.0, 110.0, 29.0, 57.0, 170.0, 180.0, 65.0, 210.0, 160.0, 170.0, 130.0, 100.0, 41.0, 139.0, 55.0, 70.0, 60.0, 80.0, 39.0, 30.0, 90.0, 28.0, 150.0, 190.0, 143.0, -35.0, 82.0, 40.0, 110.0, 80.0, 59.0, 0.0, 40.0, 120.0, 90.0, 260.0, 50.0, 10.0, 60.0, 30.0, 44.0, 109.0, 50.0, 55.0, 170.0, 60.0, 110.0, 70.0, 110.0, 110.0, 100.0, 60.0, 50.0, 135.0, 70.0, 140.0, 20.0, 110.0, 90.0, 70.0, 110.0, 30.0, 30.0, 180.0, 180.0, 80.0, 110.0, 120.0, 270.0, 76.0, 34.0, 30.0, 120.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7209541877496426, "mean_inference_ms": 1.7209370279989125, "mean_action_processing_ms": 0.5176781935611736, "mean_env_wait_ms": 1.1691898234411675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011511087417602539, "StateBufferConnector_ms": 0.008724689483642578, "ViewRequirementAgentConnector_ms": 0.37021398544311523}, "num_episodes": 18, "episode_return_max": 1430.0, "episode_return_min": 290.0, "episode_return_mean": 955.04}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.48304845369565, "num_env_steps_trained_throughput_per_sec": 20.48304845369565, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 3920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3920000, "timers": {"training_iteration_time_ms": 194244.739, "restore_workers_time_ms": 0.012, "training_step_time_ms": 194244.694, "sample_time_ms": 2430.264, "learn_time_ms": 191794.481, "learn_throughput": 20.856, "synch_weights_time_ms": 11.734}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "done": false, "training_iteration": 98, "trial_id": "1841f_00000", "date": "2024-08-08_04-59-08", "timestamp": 1723107548, "time_this_iter_s": 195.29218196868896, "time_total_s": 20332.139857292175, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29d5670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20332.139857292175, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 19.557761732851986, "ram_util_percent": 77.30505415162455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1898680986306918, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.71794481907155, "policy_loss": -0.014867918319301928, "vf_loss": 8.731349239156396, "vf_explained_var": -0.04211972214924261, "kl": 0.007317502499694973, "entropy": 0.49484280875315684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 924915.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "env_runners": {"episode_reward_max": 1430.0, "episode_reward_min": 290.0, "episode_reward_mean": 965.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 96.545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1400.0, 877.0, 837.0, 1098.0, 780.0, 542.0, 1260.0, 1020.0, 637.0, 862.0, 1155.0, 1099.0, 955.0, 1025.0, 647.0, 780.0, 620.0, 1063.0, 995.0, 1003.0, 1216.0, 849.0, 1154.0, 1430.0, 1075.0, 629.0, 838.0, 1160.0, 935.0, 954.0, 1139.0, 788.0, 613.0, 970.0, 1223.0, 1230.0, 838.0, 946.0, 930.0, 1350.0, 1290.0, 290.0, 759.0, 628.0, 847.0, 1134.0, 887.0, 889.0, 1090.0, 1021.0, 1046.0, 583.0, 1157.0, 887.0, 1078.0, 1055.0, 996.0, 1340.0, 971.0, 1043.0, 1120.0, 1182.0, 1060.0, 875.0, 890.0, 710.0, 870.0, 1247.0, 992.0, 1045.0, 796.0, 1365.0, 792.0, 639.0, 758.0, 975.0, 850.0, 1070.0, 1020.0, 1002.0, 829.0, 1007.0, 807.0, 465.0, 1253.0, 1385.0, 1195.0, 954.0, 1094.0, 950.0, 1255.0, 1165.0, 832.0, 1068.0, 835.0, 752.0, 1002.0, 705.0, 968.0, 853.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 140.0, 160.0, 130.0, 120.0, 170.0, 70.0, 150.0, 130.0, 210.0, 70.0, 95.0, 72.0, 105.0, 40.0, 105.0, 180.0, 90.0, 60.0, 60.0, 47.0, 90.0, 140.0, 80.0, 70.0, 120.0, 91.0, 45.0, 54.0, 100.0, 150.0, 4.0, 50.0, 60.0, 140.0, 160.0, 79.0, 80.0, 230.0, 145.0, 50.0, 80.0, 80.0, 110.0, 40.0, 40.0, 60.0, 140.0, 80.0, 100.0, 44.0, 20.0, 50.0, 90.0, 50.0, 56.0, 50.0, 60.0, 52.0, 70.0, 200.0, 120.0, 150.0, 110.0, 100.0, 110.0, 190.0, 70.0, 140.0, 70.0, 110.0, 30.0, 180.0, 80.0, 60.0, 140.0, 100.0, 100.0, 180.0, 40.0, 70.0, 50.0, 80.0, 25.0, 160.0, 80.0, 30.0, 130.0, -50.0, 62.0, 105.0, 70.0, 77.0, 70.0, 100.0, 100.0, 120.0, 70.0, 50.0, 100.0, 90.0, 130.0, 80.0, 230.0, 100.0, 118.0, 90.0, 120.0, 60.0, 137.0, 20.0, 170.0, 150.0, 40.0, 120.0, 130.0, 173.0, 130.0, 60.0, 106.0, 111.0, 110.0, 41.0, 100.0, 92.0, 190.0, 76.0, 160.0, 50.0, 25.0, 105.0, 110.0, 81.0, 45.0, 140.0, 160.0, 160.0, 100.0, 34.0, 90.0, 40.0, 60.0, 5.0, 50.0, 150.0, 50.0, 170.0, 52.0, 20.0, 50.0, 80.0, 90.0, 110.0, 90.0, 50.0, 100.0, 50.0, 80.0, 70.0, 60.0, 28.0, 20.0, 60.0, 100.0, 80.0, 110.0, 56.0, 60.0, 79.0, 27.0, 90.0, 170.0, 75.0, 70.0, 130.0, 100.0, 268.0, 50.0, 70.0, 40.0, 175.0, 140.0, 90.0, 80.0, 60.0, 110.0, 110.0, 120.0, 60.0, 50.0, 50.0, 45.0, 100.0, 50.0, 78.0, 130.0, 80.0, 130.0, 200.0, 140.0, 130.0, 220.0, 140.0, 160.0, 110.0, 18.0, 90.0, 210.0, 68.0, 70.0, 100.0, 90.0, 50.0, 150.0, 40.0, 39.0, 150.0, 50.0, 150.0, 30.0, 100.0, 180.0, 65.0, 120.0, 130.0, 60.0, 80.0, 99.0, 220.0, 100.0, 110.0, 110.0, 150.0, 130.0, 119.0, 106.0, 115.0, 180.0, 160.0, 250.0, 140.0, 100.0, 60.0, 110.0, 180.0, 120.0, 85.0, 100.0, 110.0, 70.0, 80.0, 50.0, 60.0, 50.0, 40.0, 50.0, 59.0, 110.0, 30.0, 100.0, 100.0, 85.0, -65.0, 90.0, 39.0, 70.0, 70.0, 119.0, 140.0, 190.0, 90.0, 120.0, 70.0, 70.0, 70.0, 185.0, 210.0, 70.0, 150.0, 125.0, 40.0, 70.0, 110.0, 40.0, 200.0, 55.0, 70.0, 100.0, 140.0, 110.0, 100.0, 90.0, 160.0, 22.0, 160.0, 170.0, 100.0, 42.0, 70.0, 40.0, 160.0, 80.0, 80.0, 42.0, 120.0, 80.0, 140.0, 27.0, 260.0, 150.0, 70.0, 69.0, 180.0, 25.0, 19.0, 90.0, 37.0, 140.0, 58.0, 100.0, 10.0, 40.0, 27.0, 57.0, 80.0, 29.0, 160.0, 90.0, 70.0, 50.0, 150.0, 70.0, 90.0, 80.0, 10.0, 110.0, 90.0, 130.0, 110.0, 130.0, 130.0, 190.0, 70.0, 220.0, 100.0, 130.0, 57.0, 110.0, 46.0, 170.0, 80.0, 130.0, 130.0, 90.0, 160.0, 300.0, 120.0, 70.0, 70.0, 80.0, 75.0, 70.0, 200.0, 80.0, 46.0, 100.0, 50.0, 60.0, 90.0, 67.0, 100.0, 120.0, 60.0, 37.0, 80.0, 70.0, 49.0, 140.0, 140.0, 150.0, 100.0, 40.0, 80.0, -70.0, 70.0, 220.0, 110.0, 140.0, 90.0, 150.0, 120.0, 130.0, 30.0, 130.0, 200.0, 260.0, 70.0, 170.0, 160.0, 80.0, 160.0, 120.0, 140.0, 170.0, 100.0, 110.0, 160.0, 140.0, 120.0, 70.0, 5.0, 15.0, 20.0, 30.0, 30.0, 90.0, 70.0, 0.0, 20.0, 10.0, 60.0, 60.0, 100.0, 0.0, 75.0, 120.0, 130.0, 130.0, 14.0, 70.0, 30.0, 56.0, 2.0, 30.0, 110.0, 70.0, 90.0, 110.0, 70.0, 60.0, 80.0, 114.0, 73.0, 90.0, 130.0, 80.0, 30.0, 120.0, 60.0, 70.0, 100.0, 29.0, 64.0, 70.0, 240.0, 190.0, 51.0, 100.0, 130.0, 160.0, 100.0, 69.0, 140.0, 79.0, 70.0, 50.0, 130.0, 94.0, 25.0, 130.0, 30.0, 100.0, 120.0, 120.0, 70.0, 90.0, 60.0, 50.0, 39.0, 210.0, 50.0, 120.0, 180.0, 10.0, 110.0, 120.0, 100.0, 160.0, 110.0, 130.0, 110.0, 90.0, 78.0, 90.0, 110.0, 100.0, 120.0, 103.0, 110.0, 110.0, 120.0, 90.0, 80.0, 90.0, 120.0, 80.0, 118.0, 130.0, 100.0, 118.0, 7.0, 77.0, 103.0, 60.0, 50.0, 52.0, 136.0, 50.0, -23.0, 71.0, 180.0, 17.0, 70.0, 126.0, 180.0, 180.0, 90.0, 115.0, 109.0, 90.0, 130.0, 80.0, 110.0, 110.0, 49.0, 59.0, 110.0, 99.0, 80.0, 60.0, 130.0, 100.0, 160.0, 70.0, 120.0, 170.0, 120.0, 130.0, 28.0, 50.0, 20.0, 70.0, 80.0, 160.0, 120.0, 180.0, 280.0, 40.0, 90.0, 15.0, 100.0, 65.0, 70.0, 130.0, 160.0, 88.0, 117.0, 80.0, 99.0, 87.0, 170.0, 70.0, 140.0, 110.0, 140.0, 200.0, 70.0, 200.0, 110.0, 130.0, 167.0, 120.0, 90.0, 150.0, 90.0, 70.0, 64.0, 50.0, 20.0, 150.0, 140.0, 140.0, 36.0, 210.0, 90.0, 17.0, 130.0, 60.0, 130.0, 90.0, 150.0, 100.0, 50.0, 130.0, 190.0, 130.0, 50.0, 80.0, 140.0, 100.0, 150.0, 190.0, 60.0, 70.0, 180.0, 110.0, 30.0, 162.0, 150.0, 80.0, 90.0, 70.0, 60.0, 120.0, 110.0, 70.0, 110.0, 100.0, 140.0, 190.0, 35.0, 90.0, 100.0, 140.0, 120.0, 100.0, 90.0, 70.0, 80.0, 50.0, 120.0, 130.0, 80.0, 60.0, 130.0, 20.0, 50.0, 110.0, 90.0, 100.0, 100.0, 100.0, 130.0, 50.0, 150.0, -45.0, 75.0, 40.0, 60.0, 50.0, 100.0, 40.0, 190.0, 50.0, 90.0, 100.0, 60.0, 50.0, 70.0, 120.0, 110.0, 100.0, 100.0, 210.0, 160.0, 250.0, 120.0, 90.0, 47.0, 60.0, 86.0, 170.0, 130.0, 16.0, 60.0, 140.0, 86.0, 94.0, 100.0, 110.0, 220.0, 60.0, 50.0, 40.0, 90.0, 180.0, 170.0, 60.0, 90.0, 85.0, 100.0, 100.0, 90.0, 20.0, 40.0, 160.0, 90.0, 110.0, 29.0, 57.0, 170.0, 180.0, 65.0, 210.0, 160.0, 170.0, 130.0, 100.0, 41.0, 139.0, 55.0, 70.0, 60.0, 80.0, 39.0, 30.0, 90.0, 28.0, 150.0, 190.0, 143.0, -35.0, 82.0, 40.0, 110.0, 80.0, 59.0, 0.0, 40.0, 120.0, 90.0, 260.0, 50.0, 10.0, 60.0, 30.0, 44.0, 109.0, 50.0, 55.0, 170.0, 60.0, 110.0, 70.0, 110.0, 110.0, 100.0, 60.0, 50.0, 135.0, 70.0, 140.0, 20.0, 110.0, 90.0, 70.0, 110.0, 30.0, 30.0, 180.0, 180.0, 80.0, 110.0, 120.0, 270.0, 76.0, 34.0, 30.0, 120.0, 50.0, 80.0, 150.0, 140.0, 40.0, 150.0, 100.0, 110.0, 90.0, 60.0, 100.0, 80.0, 56.0, 140.0, 70.0, 140.0, 54.0, 150.0, 35.0, 70.0, 207.0, 100.0, 110.0, 55.0, 70.0, 20.0, 130.0, 110.0, 52.0, 90.0, 92.0, 150.0, 130.0, 69.0, 76.0, 48.0, 70.0, 84.0, 80.0, 140.0, 160.0, 60.0, 50.0, 35.0, 130.0, 38.0, 110.0, 56.0, 162.0, 50.0, 116.0, 60.0, 5.0, 90.0, 80.0, 140.0, 30.0, 70.0, -90.0, 40.0, 40.0, 170.0, 210.0, 130.0, 270.0, 100.0, 70.0, 110.0, 49.0, 34.0, 110.0, 70.0, 180.0, 70.0, 230.0, 160.0, 200.0, 140.0, 150.0, 110.0, 75.0, 80.0, 110.0, 110.0, 107.0, 212.0, 76.0, 80.0, 160.0, 160.0, 100.0, 200.0, -3.0, 22.0, 70.0, 150.0, 70.0, 45.0, 160.0, 120.0, 120.0, 120.0, 78.0, 90.0, 120.0, 80.0, 99.0, 140.0, 130.0, 90.0, 147.0, 90.0, 70.0, 70.0, 40.0, 60.0, 80.0, 150.0, 100.0, 120.0, 170.0, 270.0, 70.0, 120.0, 150.0, 110.0, 18.0, 107.0, 170.0, 80.0, 160.0, 150.0, 70.0, 110.0, 210.0, 170.0, 60.0, 60.0, 150.0, 180.0, 5.0, 65.0, 70.0, 180.0, 70.0, 70.0, 130.0, 40.0, 120.0, 37.0, 50.0, 68.0, 170.0, 140.0, 90.0, 69.0, 100.0, 108.0, 95.0, 108.0, 120.0, 120.0, 40.0, 100.0, 70.0, 60.0, 180.0, 60.0, -35.0, 60.0, 180.0, 78.0, 91.0, 128.0, 69.0, 70.0, 60.0, 70.0, 120.0, 11.0, 55.0, 100.0, 90.0, 14.0, 190.0, 120.0, 170.0, 140.0, -12.0, 150.0, 40.0, 70.0, 80.0, 50.0, 70.0, 110.0, 100.0, 36.0, 90.0, 85.0, 14.0, 170.0, 110.0, 130.0, 40.0, 110.0, 100.0, 80.0, 88.0, 50.0, 90.0, 60.0, 100.0, 160.0, 90.0, 80.0, 90.0, 110.0, 40.0, 15.0, 108.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7165348375688751, "mean_inference_ms": 1.7165442801979307, "mean_action_processing_ms": 0.5167217811526517, "mean_env_wait_ms": 1.167111004311127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012127399444580078, "StateBufferConnector_ms": 0.008981704711914062, "ViewRequirementAgentConnector_ms": 0.37401700019836426}, "num_episodes": 22, "episode_return_max": 1430.0, "episode_return_min": 290.0, "episode_return_mean": 965.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.60274738133236, "num_env_steps_trained_throughput_per_sec": 20.60274738133236, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 3960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3960000, "timers": {"training_iteration_time_ms": 194320.55, "restore_workers_time_ms": 0.012, "training_step_time_ms": 194320.504, "sample_time_ms": 2450.375, "learn_time_ms": 191850.414, "learn_throughput": 20.85, "synch_weights_time_ms": 11.48}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "done": false, "training_iteration": 99, "trial_id": "1841f_00000", "date": "2024-08-08_05-02-22", "timestamp": 1723107742, "time_this_iter_s": 194.1600639820099, "time_total_s": 20526.299921274185, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29d5e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20526.299921274185, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 17.194525547445256, "ram_util_percent": 77.47591240875911}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.026044312782816, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.524034261500365, "policy_loss": -0.015668321217542178, "vf_loss": 8.538166169744457, "vf_explained_var": -0.01904679310842317, "kl": 0.007681950297554136, "entropy": 0.48788057219423553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 934305.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "env_runners": {"episode_reward_max": 1430.0, "episode_reward_min": 290.0, "episode_reward_mean": 989.88, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 98.988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [995.0, 1003.0, 1216.0, 849.0, 1154.0, 1430.0, 1075.0, 629.0, 838.0, 1160.0, 935.0, 954.0, 1139.0, 788.0, 613.0, 970.0, 1223.0, 1230.0, 838.0, 946.0, 930.0, 1350.0, 1290.0, 290.0, 759.0, 628.0, 847.0, 1134.0, 887.0, 889.0, 1090.0, 1021.0, 1046.0, 583.0, 1157.0, 887.0, 1078.0, 1055.0, 996.0, 1340.0, 971.0, 1043.0, 1120.0, 1182.0, 1060.0, 875.0, 890.0, 710.0, 870.0, 1247.0, 992.0, 1045.0, 796.0, 1365.0, 792.0, 639.0, 758.0, 975.0, 850.0, 1070.0, 1020.0, 1002.0, 829.0, 1007.0, 807.0, 465.0, 1253.0, 1385.0, 1195.0, 954.0, 1094.0, 950.0, 1255.0, 1165.0, 832.0, 1068.0, 835.0, 752.0, 1002.0, 705.0, 968.0, 853.0, 1068.0, 901.0, 912.0, 1064.0, 1034.0, 1087.0, 1389.0, 903.0, 1090.0, 792.0, 1130.0, 1048.0, 1215.0, 972.0, 1146.0, 990.0, 1199.0, 1160.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [175.0, 140.0, 90.0, 80.0, 60.0, 110.0, 110.0, 120.0, 60.0, 50.0, 50.0, 45.0, 100.0, 50.0, 78.0, 130.0, 80.0, 130.0, 200.0, 140.0, 130.0, 220.0, 140.0, 160.0, 110.0, 18.0, 90.0, 210.0, 68.0, 70.0, 100.0, 90.0, 50.0, 150.0, 40.0, 39.0, 150.0, 50.0, 150.0, 30.0, 100.0, 180.0, 65.0, 120.0, 130.0, 60.0, 80.0, 99.0, 220.0, 100.0, 110.0, 110.0, 150.0, 130.0, 119.0, 106.0, 115.0, 180.0, 160.0, 250.0, 140.0, 100.0, 60.0, 110.0, 180.0, 120.0, 85.0, 100.0, 110.0, 70.0, 80.0, 50.0, 60.0, 50.0, 40.0, 50.0, 59.0, 110.0, 30.0, 100.0, 100.0, 85.0, -65.0, 90.0, 39.0, 70.0, 70.0, 119.0, 140.0, 190.0, 90.0, 120.0, 70.0, 70.0, 70.0, 185.0, 210.0, 70.0, 150.0, 125.0, 40.0, 70.0, 110.0, 40.0, 200.0, 55.0, 70.0, 100.0, 140.0, 110.0, 100.0, 90.0, 160.0, 22.0, 160.0, 170.0, 100.0, 42.0, 70.0, 40.0, 160.0, 80.0, 80.0, 42.0, 120.0, 80.0, 140.0, 27.0, 260.0, 150.0, 70.0, 69.0, 180.0, 25.0, 19.0, 90.0, 37.0, 140.0, 58.0, 100.0, 10.0, 40.0, 27.0, 57.0, 80.0, 29.0, 160.0, 90.0, 70.0, 50.0, 150.0, 70.0, 90.0, 80.0, 10.0, 110.0, 90.0, 130.0, 110.0, 130.0, 130.0, 190.0, 70.0, 220.0, 100.0, 130.0, 57.0, 110.0, 46.0, 170.0, 80.0, 130.0, 130.0, 90.0, 160.0, 300.0, 120.0, 70.0, 70.0, 80.0, 75.0, 70.0, 200.0, 80.0, 46.0, 100.0, 50.0, 60.0, 90.0, 67.0, 100.0, 120.0, 60.0, 37.0, 80.0, 70.0, 49.0, 140.0, 140.0, 150.0, 100.0, 40.0, 80.0, -70.0, 70.0, 220.0, 110.0, 140.0, 90.0, 150.0, 120.0, 130.0, 30.0, 130.0, 200.0, 260.0, 70.0, 170.0, 160.0, 80.0, 160.0, 120.0, 140.0, 170.0, 100.0, 110.0, 160.0, 140.0, 120.0, 70.0, 5.0, 15.0, 20.0, 30.0, 30.0, 90.0, 70.0, 0.0, 20.0, 10.0, 60.0, 60.0, 100.0, 0.0, 75.0, 120.0, 130.0, 130.0, 14.0, 70.0, 30.0, 56.0, 2.0, 30.0, 110.0, 70.0, 90.0, 110.0, 70.0, 60.0, 80.0, 114.0, 73.0, 90.0, 130.0, 80.0, 30.0, 120.0, 60.0, 70.0, 100.0, 29.0, 64.0, 70.0, 240.0, 190.0, 51.0, 100.0, 130.0, 160.0, 100.0, 69.0, 140.0, 79.0, 70.0, 50.0, 130.0, 94.0, 25.0, 130.0, 30.0, 100.0, 120.0, 120.0, 70.0, 90.0, 60.0, 50.0, 39.0, 210.0, 50.0, 120.0, 180.0, 10.0, 110.0, 120.0, 100.0, 160.0, 110.0, 130.0, 110.0, 90.0, 78.0, 90.0, 110.0, 100.0, 120.0, 103.0, 110.0, 110.0, 120.0, 90.0, 80.0, 90.0, 120.0, 80.0, 118.0, 130.0, 100.0, 118.0, 7.0, 77.0, 103.0, 60.0, 50.0, 52.0, 136.0, 50.0, -23.0, 71.0, 180.0, 17.0, 70.0, 126.0, 180.0, 180.0, 90.0, 115.0, 109.0, 90.0, 130.0, 80.0, 110.0, 110.0, 49.0, 59.0, 110.0, 99.0, 80.0, 60.0, 130.0, 100.0, 160.0, 70.0, 120.0, 170.0, 120.0, 130.0, 28.0, 50.0, 20.0, 70.0, 80.0, 160.0, 120.0, 180.0, 280.0, 40.0, 90.0, 15.0, 100.0, 65.0, 70.0, 130.0, 160.0, 88.0, 117.0, 80.0, 99.0, 87.0, 170.0, 70.0, 140.0, 110.0, 140.0, 200.0, 70.0, 200.0, 110.0, 130.0, 167.0, 120.0, 90.0, 150.0, 90.0, 70.0, 64.0, 50.0, 20.0, 150.0, 140.0, 140.0, 36.0, 210.0, 90.0, 17.0, 130.0, 60.0, 130.0, 90.0, 150.0, 100.0, 50.0, 130.0, 190.0, 130.0, 50.0, 80.0, 140.0, 100.0, 150.0, 190.0, 60.0, 70.0, 180.0, 110.0, 30.0, 162.0, 150.0, 80.0, 90.0, 70.0, 60.0, 120.0, 110.0, 70.0, 110.0, 100.0, 140.0, 190.0, 35.0, 90.0, 100.0, 140.0, 120.0, 100.0, 90.0, 70.0, 80.0, 50.0, 120.0, 130.0, 80.0, 60.0, 130.0, 20.0, 50.0, 110.0, 90.0, 100.0, 100.0, 100.0, 130.0, 50.0, 150.0, -45.0, 75.0, 40.0, 60.0, 50.0, 100.0, 40.0, 190.0, 50.0, 90.0, 100.0, 60.0, 50.0, 70.0, 120.0, 110.0, 100.0, 100.0, 210.0, 160.0, 250.0, 120.0, 90.0, 47.0, 60.0, 86.0, 170.0, 130.0, 16.0, 60.0, 140.0, 86.0, 94.0, 100.0, 110.0, 220.0, 60.0, 50.0, 40.0, 90.0, 180.0, 170.0, 60.0, 90.0, 85.0, 100.0, 100.0, 90.0, 20.0, 40.0, 160.0, 90.0, 110.0, 29.0, 57.0, 170.0, 180.0, 65.0, 210.0, 160.0, 170.0, 130.0, 100.0, 41.0, 139.0, 55.0, 70.0, 60.0, 80.0, 39.0, 30.0, 90.0, 28.0, 150.0, 190.0, 143.0, -35.0, 82.0, 40.0, 110.0, 80.0, 59.0, 0.0, 40.0, 120.0, 90.0, 260.0, 50.0, 10.0, 60.0, 30.0, 44.0, 109.0, 50.0, 55.0, 170.0, 60.0, 110.0, 70.0, 110.0, 110.0, 100.0, 60.0, 50.0, 135.0, 70.0, 140.0, 20.0, 110.0, 90.0, 70.0, 110.0, 30.0, 30.0, 180.0, 180.0, 80.0, 110.0, 120.0, 270.0, 76.0, 34.0, 30.0, 120.0, 50.0, 80.0, 150.0, 140.0, 40.0, 150.0, 100.0, 110.0, 90.0, 60.0, 100.0, 80.0, 56.0, 140.0, 70.0, 140.0, 54.0, 150.0, 35.0, 70.0, 207.0, 100.0, 110.0, 55.0, 70.0, 20.0, 130.0, 110.0, 52.0, 90.0, 92.0, 150.0, 130.0, 69.0, 76.0, 48.0, 70.0, 84.0, 80.0, 140.0, 160.0, 60.0, 50.0, 35.0, 130.0, 38.0, 110.0, 56.0, 162.0, 50.0, 116.0, 60.0, 5.0, 90.0, 80.0, 140.0, 30.0, 70.0, -90.0, 40.0, 40.0, 170.0, 210.0, 130.0, 270.0, 100.0, 70.0, 110.0, 49.0, 34.0, 110.0, 70.0, 180.0, 70.0, 230.0, 160.0, 200.0, 140.0, 150.0, 110.0, 75.0, 80.0, 110.0, 110.0, 107.0, 212.0, 76.0, 80.0, 160.0, 160.0, 100.0, 200.0, -3.0, 22.0, 70.0, 150.0, 70.0, 45.0, 160.0, 120.0, 120.0, 120.0, 78.0, 90.0, 120.0, 80.0, 99.0, 140.0, 130.0, 90.0, 147.0, 90.0, 70.0, 70.0, 40.0, 60.0, 80.0, 150.0, 100.0, 120.0, 170.0, 270.0, 70.0, 120.0, 150.0, 110.0, 18.0, 107.0, 170.0, 80.0, 160.0, 150.0, 70.0, 110.0, 210.0, 170.0, 60.0, 60.0, 150.0, 180.0, 5.0, 65.0, 70.0, 180.0, 70.0, 70.0, 130.0, 40.0, 120.0, 37.0, 50.0, 68.0, 170.0, 140.0, 90.0, 69.0, 100.0, 108.0, 95.0, 108.0, 120.0, 120.0, 40.0, 100.0, 70.0, 60.0, 180.0, 60.0, -35.0, 60.0, 180.0, 78.0, 91.0, 128.0, 69.0, 70.0, 60.0, 70.0, 120.0, 11.0, 55.0, 100.0, 90.0, 14.0, 190.0, 120.0, 170.0, 140.0, -12.0, 150.0, 40.0, 70.0, 80.0, 50.0, 70.0, 110.0, 100.0, 36.0, 90.0, 85.0, 14.0, 170.0, 110.0, 130.0, 40.0, 110.0, 100.0, 80.0, 88.0, 50.0, 90.0, 60.0, 100.0, 160.0, 90.0, 80.0, 90.0, 110.0, 40.0, 15.0, 108.0, 267.0, 110.0, 90.0, 110.0, 40.0, 70.0, 90.0, 61.0, 100.0, 130.0, 152.0, 80.0, 70.0, 80.0, 70.0, 65.0, 120.0, 84.0, 100.0, 80.0, 110.0, 60.0, 73.0, 95.0, 30.0, 130.0, 110.0, 140.0, 74.0, 90.0, 95.0, 47.0, 27.0, 130.0, 190.0, 45.0, 180.0, 160.0, 120.0, 70.0, 94.0, 150.0, 70.0, 55.0, 46.0, 166.0, 150.0, 53.0, 80.0, 170.0, 39.0, 120.0, 200.0, 50.0, 120.0, 19.0, 89.0, 190.0, 110.0, 150.0, 90.0, 119.0, 110.0, 130.0, 140.0, 125.0, 110.0, 165.0, 180.0, 220.0, 60.0, 31.0, 60.0, 100.0, 77.0, 160.0, 5.0, 210.0, 100.0, 100.0, 140.0, 156.0, 109.0, 109.0, 67.0, 196.0, 95.0, 60.0, 65.0, 93.0, 103.0, 10.0, 130.0, 46.0, 120.0, 33.0, 60.0, 150.0, 40.0, 100.0, 130.0, 160.0, 40.0, 180.0, 100.0, 180.0, 180.0, 60.0, 70.0, 30.0, 100.0, 130.0, 105.0, 110.0, 120.0, 120.0, 53.0, 110.0, 100.0, 100.0, 80.0, 65.0, 90.0, 70.0, 190.0, 210.0, 210.0, 100.0, 70.0, 130.0, 45.0, 130.0, 120.0, 64.0, 43.0, 100.0, 140.0, 120.0, 80.0, 130.0, 180.0, 50.0, 130.0, 170.0, 80.0, 100.0, 43.0, 143.0, 160.0, 90.0, 120.0, 50.0, 90.0, 170.0, 100.0, 120.0, 70.0, 100.0, 60.0, 110.0, 120.0, 130.0, 70.0, 120.0, 80.0, 110.0, 180.0, 89.0, 110.0, 190.0, 110.0, 110.0, 100.0, 160.0, 90.0, 60.0, 170.0, 80.0, 140.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7129890599131545, "mean_inference_ms": 1.7130564421726626, "mean_action_processing_ms": 0.5159954549009313, "mean_env_wait_ms": 1.165456462181165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019224166870117188, "StateBufferConnector_ms": 0.008936405181884766, "ViewRequirementAgentConnector_ms": 0.37096190452575684}, "num_episodes": 18, "episode_return_max": 1430.0, "episode_return_min": 290.0, "episode_return_mean": 989.88}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.65154414889525, "num_env_steps_trained_throughput_per_sec": 20.65154414889525, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 4000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000000, "timers": {"training_iteration_time_ms": 194335.393, "restore_workers_time_ms": 0.012, "training_step_time_ms": 194335.346, "sample_time_ms": 2464.679, "learn_time_ms": 191851.0, "learn_throughput": 20.85, "synch_weights_time_ms": 11.311}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "done": false, "training_iteration": 100, "trial_id": "1841f_00000", "date": "2024-08-08_05-05-36", "timestamp": 1723107936, "time_this_iter_s": 193.70022177696228, "time_total_s": 20720.000143051147, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b5672ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20720.000143051147, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 16.99124087591241, "ram_util_percent": 78.05255474452555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4118184853920415, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.403231965441801, "policy_loss": -0.015140647770855794, "vf_loss": 8.416885721239165, "vf_explained_var": -0.024164373964801256, "kl": 0.007434486040982685, "entropy": 0.502298861037428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 943695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "env_runners": {"episode_reward_max": 1389.0, "episode_reward_min": 290.0, "episode_reward_mean": 978.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 97.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.0, 759.0, 628.0, 847.0, 1134.0, 887.0, 889.0, 1090.0, 1021.0, 1046.0, 583.0, 1157.0, 887.0, 1078.0, 1055.0, 996.0, 1340.0, 971.0, 1043.0, 1120.0, 1182.0, 1060.0, 875.0, 890.0, 710.0, 870.0, 1247.0, 992.0, 1045.0, 796.0, 1365.0, 792.0, 639.0, 758.0, 975.0, 850.0, 1070.0, 1020.0, 1002.0, 829.0, 1007.0, 807.0, 465.0, 1253.0, 1385.0, 1195.0, 954.0, 1094.0, 950.0, 1255.0, 1165.0, 832.0, 1068.0, 835.0, 752.0, 1002.0, 705.0, 968.0, 853.0, 1068.0, 901.0, 912.0, 1064.0, 1034.0, 1087.0, 1389.0, 903.0, 1090.0, 792.0, 1130.0, 1048.0, 1215.0, 972.0, 1146.0, 990.0, 1199.0, 1160.0, 990.0, 776.0, 920.0, 1111.0, 983.0, 952.0, 864.0, 1181.0, 1057.0, 975.0, 1143.0, 1013.0, 1058.0, 938.0, 1070.0, 1150.0, 964.0, 1021.0, 932.0, 464.0, 1000.0, 741.0, 1074.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [5.0, 15.0, 20.0, 30.0, 30.0, 90.0, 70.0, 0.0, 20.0, 10.0, 60.0, 60.0, 100.0, 0.0, 75.0, 120.0, 130.0, 130.0, 14.0, 70.0, 30.0, 56.0, 2.0, 30.0, 110.0, 70.0, 90.0, 110.0, 70.0, 60.0, 80.0, 114.0, 73.0, 90.0, 130.0, 80.0, 30.0, 120.0, 60.0, 70.0, 100.0, 29.0, 64.0, 70.0, 240.0, 190.0, 51.0, 100.0, 130.0, 160.0, 100.0, 69.0, 140.0, 79.0, 70.0, 50.0, 130.0, 94.0, 25.0, 130.0, 30.0, 100.0, 120.0, 120.0, 70.0, 90.0, 60.0, 50.0, 39.0, 210.0, 50.0, 120.0, 180.0, 10.0, 110.0, 120.0, 100.0, 160.0, 110.0, 130.0, 110.0, 90.0, 78.0, 90.0, 110.0, 100.0, 120.0, 103.0, 110.0, 110.0, 120.0, 90.0, 80.0, 90.0, 120.0, 80.0, 118.0, 130.0, 100.0, 118.0, 7.0, 77.0, 103.0, 60.0, 50.0, 52.0, 136.0, 50.0, -23.0, 71.0, 180.0, 17.0, 70.0, 126.0, 180.0, 180.0, 90.0, 115.0, 109.0, 90.0, 130.0, 80.0, 110.0, 110.0, 49.0, 59.0, 110.0, 99.0, 80.0, 60.0, 130.0, 100.0, 160.0, 70.0, 120.0, 170.0, 120.0, 130.0, 28.0, 50.0, 20.0, 70.0, 80.0, 160.0, 120.0, 180.0, 280.0, 40.0, 90.0, 15.0, 100.0, 65.0, 70.0, 130.0, 160.0, 88.0, 117.0, 80.0, 99.0, 87.0, 170.0, 70.0, 140.0, 110.0, 140.0, 200.0, 70.0, 200.0, 110.0, 130.0, 167.0, 120.0, 90.0, 150.0, 90.0, 70.0, 64.0, 50.0, 20.0, 150.0, 140.0, 140.0, 36.0, 210.0, 90.0, 17.0, 130.0, 60.0, 130.0, 90.0, 150.0, 100.0, 50.0, 130.0, 190.0, 130.0, 50.0, 80.0, 140.0, 100.0, 150.0, 190.0, 60.0, 70.0, 180.0, 110.0, 30.0, 162.0, 150.0, 80.0, 90.0, 70.0, 60.0, 120.0, 110.0, 70.0, 110.0, 100.0, 140.0, 190.0, 35.0, 90.0, 100.0, 140.0, 120.0, 100.0, 90.0, 70.0, 80.0, 50.0, 120.0, 130.0, 80.0, 60.0, 130.0, 20.0, 50.0, 110.0, 90.0, 100.0, 100.0, 100.0, 130.0, 50.0, 150.0, -45.0, 75.0, 40.0, 60.0, 50.0, 100.0, 40.0, 190.0, 50.0, 90.0, 100.0, 60.0, 50.0, 70.0, 120.0, 110.0, 100.0, 100.0, 210.0, 160.0, 250.0, 120.0, 90.0, 47.0, 60.0, 86.0, 170.0, 130.0, 16.0, 60.0, 140.0, 86.0, 94.0, 100.0, 110.0, 220.0, 60.0, 50.0, 40.0, 90.0, 180.0, 170.0, 60.0, 90.0, 85.0, 100.0, 100.0, 90.0, 20.0, 40.0, 160.0, 90.0, 110.0, 29.0, 57.0, 170.0, 180.0, 65.0, 210.0, 160.0, 170.0, 130.0, 100.0, 41.0, 139.0, 55.0, 70.0, 60.0, 80.0, 39.0, 30.0, 90.0, 28.0, 150.0, 190.0, 143.0, -35.0, 82.0, 40.0, 110.0, 80.0, 59.0, 0.0, 40.0, 120.0, 90.0, 260.0, 50.0, 10.0, 60.0, 30.0, 44.0, 109.0, 50.0, 55.0, 170.0, 60.0, 110.0, 70.0, 110.0, 110.0, 100.0, 60.0, 50.0, 135.0, 70.0, 140.0, 20.0, 110.0, 90.0, 70.0, 110.0, 30.0, 30.0, 180.0, 180.0, 80.0, 110.0, 120.0, 270.0, 76.0, 34.0, 30.0, 120.0, 50.0, 80.0, 150.0, 140.0, 40.0, 150.0, 100.0, 110.0, 90.0, 60.0, 100.0, 80.0, 56.0, 140.0, 70.0, 140.0, 54.0, 150.0, 35.0, 70.0, 207.0, 100.0, 110.0, 55.0, 70.0, 20.0, 130.0, 110.0, 52.0, 90.0, 92.0, 150.0, 130.0, 69.0, 76.0, 48.0, 70.0, 84.0, 80.0, 140.0, 160.0, 60.0, 50.0, 35.0, 130.0, 38.0, 110.0, 56.0, 162.0, 50.0, 116.0, 60.0, 5.0, 90.0, 80.0, 140.0, 30.0, 70.0, -90.0, 40.0, 40.0, 170.0, 210.0, 130.0, 270.0, 100.0, 70.0, 110.0, 49.0, 34.0, 110.0, 70.0, 180.0, 70.0, 230.0, 160.0, 200.0, 140.0, 150.0, 110.0, 75.0, 80.0, 110.0, 110.0, 107.0, 212.0, 76.0, 80.0, 160.0, 160.0, 100.0, 200.0, -3.0, 22.0, 70.0, 150.0, 70.0, 45.0, 160.0, 120.0, 120.0, 120.0, 78.0, 90.0, 120.0, 80.0, 99.0, 140.0, 130.0, 90.0, 147.0, 90.0, 70.0, 70.0, 40.0, 60.0, 80.0, 150.0, 100.0, 120.0, 170.0, 270.0, 70.0, 120.0, 150.0, 110.0, 18.0, 107.0, 170.0, 80.0, 160.0, 150.0, 70.0, 110.0, 210.0, 170.0, 60.0, 60.0, 150.0, 180.0, 5.0, 65.0, 70.0, 180.0, 70.0, 70.0, 130.0, 40.0, 120.0, 37.0, 50.0, 68.0, 170.0, 140.0, 90.0, 69.0, 100.0, 108.0, 95.0, 108.0, 120.0, 120.0, 40.0, 100.0, 70.0, 60.0, 180.0, 60.0, -35.0, 60.0, 180.0, 78.0, 91.0, 128.0, 69.0, 70.0, 60.0, 70.0, 120.0, 11.0, 55.0, 100.0, 90.0, 14.0, 190.0, 120.0, 170.0, 140.0, -12.0, 150.0, 40.0, 70.0, 80.0, 50.0, 70.0, 110.0, 100.0, 36.0, 90.0, 85.0, 14.0, 170.0, 110.0, 130.0, 40.0, 110.0, 100.0, 80.0, 88.0, 50.0, 90.0, 60.0, 100.0, 160.0, 90.0, 80.0, 90.0, 110.0, 40.0, 15.0, 108.0, 267.0, 110.0, 90.0, 110.0, 40.0, 70.0, 90.0, 61.0, 100.0, 130.0, 152.0, 80.0, 70.0, 80.0, 70.0, 65.0, 120.0, 84.0, 100.0, 80.0, 110.0, 60.0, 73.0, 95.0, 30.0, 130.0, 110.0, 140.0, 74.0, 90.0, 95.0, 47.0, 27.0, 130.0, 190.0, 45.0, 180.0, 160.0, 120.0, 70.0, 94.0, 150.0, 70.0, 55.0, 46.0, 166.0, 150.0, 53.0, 80.0, 170.0, 39.0, 120.0, 200.0, 50.0, 120.0, 19.0, 89.0, 190.0, 110.0, 150.0, 90.0, 119.0, 110.0, 130.0, 140.0, 125.0, 110.0, 165.0, 180.0, 220.0, 60.0, 31.0, 60.0, 100.0, 77.0, 160.0, 5.0, 210.0, 100.0, 100.0, 140.0, 156.0, 109.0, 109.0, 67.0, 196.0, 95.0, 60.0, 65.0, 93.0, 103.0, 10.0, 130.0, 46.0, 120.0, 33.0, 60.0, 150.0, 40.0, 100.0, 130.0, 160.0, 40.0, 180.0, 100.0, 180.0, 180.0, 60.0, 70.0, 30.0, 100.0, 130.0, 105.0, 110.0, 120.0, 120.0, 53.0, 110.0, 100.0, 100.0, 80.0, 65.0, 90.0, 70.0, 190.0, 210.0, 210.0, 100.0, 70.0, 130.0, 45.0, 130.0, 120.0, 64.0, 43.0, 100.0, 140.0, 120.0, 80.0, 130.0, 180.0, 50.0, 130.0, 170.0, 80.0, 100.0, 43.0, 143.0, 160.0, 90.0, 120.0, 50.0, 90.0, 170.0, 100.0, 120.0, 70.0, 100.0, 60.0, 110.0, 120.0, 130.0, 70.0, 120.0, 80.0, 110.0, 180.0, 89.0, 110.0, 190.0, 110.0, 110.0, 100.0, 160.0, 90.0, 60.0, 170.0, 80.0, 140.0, 140.0, 50.0, 70.0, 120.0, 120.0, 100.0, 20.0, 170.0, 110.0, 160.0, 70.0, 190.0, 30.0, 100.0, 150.0, 180.0, 20.0, 3.0, 71.0, 9.0, 23.0, 190.0, 50.0, 110.0, 190.0, 110.0, 60.0, 30.0, 40.0, 80.0, 60.0, 75.0, 170.0, 130.0, 112.0, 190.0, 130.0, 90.0, 200.0, 100.0, -86.0, 30.0, 33.0, 180.0, 44.0, 160.0, 21.0, 200.0, 48.0, 180.0, 87.0, 100.0, 70.0, 208.0, 70.0, 4.0, 70.0, 120.0, 110.0, 70.0, 130.0, 100.0, 70.0, 80.0, 100.0, 90.0, 53.0, 140.0, 90.0, 130.0, 11.0, 150.0, 179.0, 50.0, 101.0, 230.0, 30.0, 120.0, 96.0, 110.0, 115.0, 90.0, 60.0, 140.0, 100.0, -10.0, 80.0, 150.0, 190.0, 170.0, 87.0, 90.0, 140.0, 120.0, 80.0, 50.0, 90.0, 80.0, 60.0, 35.0, 230.0, 130.0, 116.0, 140.0, 130.0, 87.0, 90.0, 100.0, 180.0, 60.0, 110.0, 130.0, 110.0, 90.0, 100.0, 80.0, 180.0, 112.0, 52.0, 59.0, 100.0, 140.0, 79.0, 140.0, 140.0, 100.0, 80.0, 139.0, 90.0, 50.0, 100.0, 90.0, 80.0, 60.0, 60.0, 58.0, 80.0, 180.0, 90.0, 100.0, 140.0, 120.0, 160.0, 65.0, 56.0, 130.0, 160.0, 39.0, 60.0, 180.0, 100.0, 140.0, 140.0, 110.0, 110.0, 150.0, 70.0, 70.0, 110.0, 130.0, 120.0, 57.0, 100.0, 80.0, 107.0, 100.0, 90.0, 120.0, 130.0, 50.0, 130.0, 102.0, 77.0, 170.0, 86.0, 80.0, 110.0, 76.0, 120.0, 130.0, 70.0, 70.0, 60.0, 170.0, 120.0, 90.0, 60.0, 57.0, 140.0, 45.0, 120.0, 10.0, 20.0, 100.0, 100.0, 40.0, 29.0, 30.0, 56.0, 29.0, 50.0, 130.0, 60.0, 60.0, 70.0, 30.0, 60.0, 180.0, 170.0, 150.0, 90.0, 70.0, 120.0, 170.0, -105.0, 60.0, 66.0, 100.0, 92.0, 110.0, 58.0, 130.0, 190.0, 80.0, 84.0, 74.0, 66.0, 110.0, 60.0, 120.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.708599777666793, "mean_inference_ms": 1.7089012504012788, "mean_action_processing_ms": 0.515137612004153, "mean_env_wait_ms": 1.1634357682012044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01949453353881836, "StateBufferConnector_ms": 0.008976221084594727, "ViewRequirementAgentConnector_ms": 0.3670339584350586}, "num_episodes": 23, "episode_return_max": 1389.0, "episode_return_min": 290.0, "episode_return_mean": 978.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.51555328856264, "num_env_steps_trained_throughput_per_sec": 20.51555328856264, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 4040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4040000, "timers": {"training_iteration_time_ms": 194446.625, "restore_workers_time_ms": 0.012, "training_step_time_ms": 194446.578, "sample_time_ms": 2470.559, "learn_time_ms": 191955.167, "learn_throughput": 20.838, "synch_weights_time_ms": 11.447}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "done": false, "training_iteration": 101, "trial_id": "1841f_00000", "date": "2024-08-08_05-08-51", "timestamp": 1723108131, "time_this_iter_s": 194.99998211860657, "time_total_s": 20915.000125169754, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29df790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20915.000125169754, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 17.719927536231886, "ram_util_percent": 77.74420289855072}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.11241894345314, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.43164693179349, "policy_loss": -0.015452867581189687, "vf_loss": 8.445489699645037, "vf_explained_var": -0.034440585561453727, "kl": 0.00805047091942824, "entropy": 0.5120775594593237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 953085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "env_runners": {"episode_reward_max": 1389.0, "episode_reward_min": 460.0, "episode_reward_mean": 982.33, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 270.0}, "policy_reward_mean": {"policy_0": 98.233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1043.0, 1120.0, 1182.0, 1060.0, 875.0, 890.0, 710.0, 870.0, 1247.0, 992.0, 1045.0, 796.0, 1365.0, 792.0, 639.0, 758.0, 975.0, 850.0, 1070.0, 1020.0, 1002.0, 829.0, 1007.0, 807.0, 465.0, 1253.0, 1385.0, 1195.0, 954.0, 1094.0, 950.0, 1255.0, 1165.0, 832.0, 1068.0, 835.0, 752.0, 1002.0, 705.0, 968.0, 853.0, 1068.0, 901.0, 912.0, 1064.0, 1034.0, 1087.0, 1389.0, 903.0, 1090.0, 792.0, 1130.0, 1048.0, 1215.0, 972.0, 1146.0, 990.0, 1199.0, 1160.0, 990.0, 776.0, 920.0, 1111.0, 983.0, 952.0, 864.0, 1181.0, 1057.0, 975.0, 1143.0, 1013.0, 1058.0, 938.0, 1070.0, 1150.0, 964.0, 1021.0, 932.0, 464.0, 1000.0, 741.0, 1074.0, 1025.0, 950.0, 1225.0, 1095.0, 1170.0, 915.0, 1129.0, 882.0, 766.0, 845.0, 995.0, 1192.0, 997.0, 836.0, 833.0, 460.0, 975.0, 791.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 140.0, 36.0, 210.0, 90.0, 17.0, 130.0, 60.0, 130.0, 90.0, 150.0, 100.0, 50.0, 130.0, 190.0, 130.0, 50.0, 80.0, 140.0, 100.0, 150.0, 190.0, 60.0, 70.0, 180.0, 110.0, 30.0, 162.0, 150.0, 80.0, 90.0, 70.0, 60.0, 120.0, 110.0, 70.0, 110.0, 100.0, 140.0, 190.0, 35.0, 90.0, 100.0, 140.0, 120.0, 100.0, 90.0, 70.0, 80.0, 50.0, 120.0, 130.0, 80.0, 60.0, 130.0, 20.0, 50.0, 110.0, 90.0, 100.0, 100.0, 100.0, 130.0, 50.0, 150.0, -45.0, 75.0, 40.0, 60.0, 50.0, 100.0, 40.0, 190.0, 50.0, 90.0, 100.0, 60.0, 50.0, 70.0, 120.0, 110.0, 100.0, 100.0, 210.0, 160.0, 250.0, 120.0, 90.0, 47.0, 60.0, 86.0, 170.0, 130.0, 16.0, 60.0, 140.0, 86.0, 94.0, 100.0, 110.0, 220.0, 60.0, 50.0, 40.0, 90.0, 180.0, 170.0, 60.0, 90.0, 85.0, 100.0, 100.0, 90.0, 20.0, 40.0, 160.0, 90.0, 110.0, 29.0, 57.0, 170.0, 180.0, 65.0, 210.0, 160.0, 170.0, 130.0, 100.0, 41.0, 139.0, 55.0, 70.0, 60.0, 80.0, 39.0, 30.0, 90.0, 28.0, 150.0, 190.0, 143.0, -35.0, 82.0, 40.0, 110.0, 80.0, 59.0, 0.0, 40.0, 120.0, 90.0, 260.0, 50.0, 10.0, 60.0, 30.0, 44.0, 109.0, 50.0, 55.0, 170.0, 60.0, 110.0, 70.0, 110.0, 110.0, 100.0, 60.0, 50.0, 135.0, 70.0, 140.0, 20.0, 110.0, 90.0, 70.0, 110.0, 30.0, 30.0, 180.0, 180.0, 80.0, 110.0, 120.0, 270.0, 76.0, 34.0, 30.0, 120.0, 50.0, 80.0, 150.0, 140.0, 40.0, 150.0, 100.0, 110.0, 90.0, 60.0, 100.0, 80.0, 56.0, 140.0, 70.0, 140.0, 54.0, 150.0, 35.0, 70.0, 207.0, 100.0, 110.0, 55.0, 70.0, 20.0, 130.0, 110.0, 52.0, 90.0, 92.0, 150.0, 130.0, 69.0, 76.0, 48.0, 70.0, 84.0, 80.0, 140.0, 160.0, 60.0, 50.0, 35.0, 130.0, 38.0, 110.0, 56.0, 162.0, 50.0, 116.0, 60.0, 5.0, 90.0, 80.0, 140.0, 30.0, 70.0, -90.0, 40.0, 40.0, 170.0, 210.0, 130.0, 270.0, 100.0, 70.0, 110.0, 49.0, 34.0, 110.0, 70.0, 180.0, 70.0, 230.0, 160.0, 200.0, 140.0, 150.0, 110.0, 75.0, 80.0, 110.0, 110.0, 107.0, 212.0, 76.0, 80.0, 160.0, 160.0, 100.0, 200.0, -3.0, 22.0, 70.0, 150.0, 70.0, 45.0, 160.0, 120.0, 120.0, 120.0, 78.0, 90.0, 120.0, 80.0, 99.0, 140.0, 130.0, 90.0, 147.0, 90.0, 70.0, 70.0, 40.0, 60.0, 80.0, 150.0, 100.0, 120.0, 170.0, 270.0, 70.0, 120.0, 150.0, 110.0, 18.0, 107.0, 170.0, 80.0, 160.0, 150.0, 70.0, 110.0, 210.0, 170.0, 60.0, 60.0, 150.0, 180.0, 5.0, 65.0, 70.0, 180.0, 70.0, 70.0, 130.0, 40.0, 120.0, 37.0, 50.0, 68.0, 170.0, 140.0, 90.0, 69.0, 100.0, 108.0, 95.0, 108.0, 120.0, 120.0, 40.0, 100.0, 70.0, 60.0, 180.0, 60.0, -35.0, 60.0, 180.0, 78.0, 91.0, 128.0, 69.0, 70.0, 60.0, 70.0, 120.0, 11.0, 55.0, 100.0, 90.0, 14.0, 190.0, 120.0, 170.0, 140.0, -12.0, 150.0, 40.0, 70.0, 80.0, 50.0, 70.0, 110.0, 100.0, 36.0, 90.0, 85.0, 14.0, 170.0, 110.0, 130.0, 40.0, 110.0, 100.0, 80.0, 88.0, 50.0, 90.0, 60.0, 100.0, 160.0, 90.0, 80.0, 90.0, 110.0, 40.0, 15.0, 108.0, 267.0, 110.0, 90.0, 110.0, 40.0, 70.0, 90.0, 61.0, 100.0, 130.0, 152.0, 80.0, 70.0, 80.0, 70.0, 65.0, 120.0, 84.0, 100.0, 80.0, 110.0, 60.0, 73.0, 95.0, 30.0, 130.0, 110.0, 140.0, 74.0, 90.0, 95.0, 47.0, 27.0, 130.0, 190.0, 45.0, 180.0, 160.0, 120.0, 70.0, 94.0, 150.0, 70.0, 55.0, 46.0, 166.0, 150.0, 53.0, 80.0, 170.0, 39.0, 120.0, 200.0, 50.0, 120.0, 19.0, 89.0, 190.0, 110.0, 150.0, 90.0, 119.0, 110.0, 130.0, 140.0, 125.0, 110.0, 165.0, 180.0, 220.0, 60.0, 31.0, 60.0, 100.0, 77.0, 160.0, 5.0, 210.0, 100.0, 100.0, 140.0, 156.0, 109.0, 109.0, 67.0, 196.0, 95.0, 60.0, 65.0, 93.0, 103.0, 10.0, 130.0, 46.0, 120.0, 33.0, 60.0, 150.0, 40.0, 100.0, 130.0, 160.0, 40.0, 180.0, 100.0, 180.0, 180.0, 60.0, 70.0, 30.0, 100.0, 130.0, 105.0, 110.0, 120.0, 120.0, 53.0, 110.0, 100.0, 100.0, 80.0, 65.0, 90.0, 70.0, 190.0, 210.0, 210.0, 100.0, 70.0, 130.0, 45.0, 130.0, 120.0, 64.0, 43.0, 100.0, 140.0, 120.0, 80.0, 130.0, 180.0, 50.0, 130.0, 170.0, 80.0, 100.0, 43.0, 143.0, 160.0, 90.0, 120.0, 50.0, 90.0, 170.0, 100.0, 120.0, 70.0, 100.0, 60.0, 110.0, 120.0, 130.0, 70.0, 120.0, 80.0, 110.0, 180.0, 89.0, 110.0, 190.0, 110.0, 110.0, 100.0, 160.0, 90.0, 60.0, 170.0, 80.0, 140.0, 140.0, 50.0, 70.0, 120.0, 120.0, 100.0, 20.0, 170.0, 110.0, 160.0, 70.0, 190.0, 30.0, 100.0, 150.0, 180.0, 20.0, 3.0, 71.0, 9.0, 23.0, 190.0, 50.0, 110.0, 190.0, 110.0, 60.0, 30.0, 40.0, 80.0, 60.0, 75.0, 170.0, 130.0, 112.0, 190.0, 130.0, 90.0, 200.0, 100.0, -86.0, 30.0, 33.0, 180.0, 44.0, 160.0, 21.0, 200.0, 48.0, 180.0, 87.0, 100.0, 70.0, 208.0, 70.0, 4.0, 70.0, 120.0, 110.0, 70.0, 130.0, 100.0, 70.0, 80.0, 100.0, 90.0, 53.0, 140.0, 90.0, 130.0, 11.0, 150.0, 179.0, 50.0, 101.0, 230.0, 30.0, 120.0, 96.0, 110.0, 115.0, 90.0, 60.0, 140.0, 100.0, -10.0, 80.0, 150.0, 190.0, 170.0, 87.0, 90.0, 140.0, 120.0, 80.0, 50.0, 90.0, 80.0, 60.0, 35.0, 230.0, 130.0, 116.0, 140.0, 130.0, 87.0, 90.0, 100.0, 180.0, 60.0, 110.0, 130.0, 110.0, 90.0, 100.0, 80.0, 180.0, 112.0, 52.0, 59.0, 100.0, 140.0, 79.0, 140.0, 140.0, 100.0, 80.0, 139.0, 90.0, 50.0, 100.0, 90.0, 80.0, 60.0, 60.0, 58.0, 80.0, 180.0, 90.0, 100.0, 140.0, 120.0, 160.0, 65.0, 56.0, 130.0, 160.0, 39.0, 60.0, 180.0, 100.0, 140.0, 140.0, 110.0, 110.0, 150.0, 70.0, 70.0, 110.0, 130.0, 120.0, 57.0, 100.0, 80.0, 107.0, 100.0, 90.0, 120.0, 130.0, 50.0, 130.0, 102.0, 77.0, 170.0, 86.0, 80.0, 110.0, 76.0, 120.0, 130.0, 70.0, 70.0, 60.0, 170.0, 120.0, 90.0, 60.0, 57.0, 140.0, 45.0, 120.0, 10.0, 20.0, 100.0, 100.0, 40.0, 29.0, 30.0, 56.0, 29.0, 50.0, 130.0, 60.0, 60.0, 70.0, 30.0, 60.0, 180.0, 170.0, 150.0, 90.0, 70.0, 120.0, 170.0, -105.0, 60.0, 66.0, 100.0, 92.0, 110.0, 58.0, 130.0, 190.0, 80.0, 84.0, 74.0, 66.0, 110.0, 60.0, 120.0, 160.0, 90.0, 180.0, 120.0, 30.0, 80.0, 130.0, 140.0, 65.0, 120.0, 70.0, 120.0, 175.0, 150.0, 70.0, 90.0, 70.0, 110.0, 110.0, 29.0, 26.0, 20.0, 190.0, 180.0, 120.0, 170.0, 87.0, 140.0, 150.0, 68.0, 100.0, 180.0, 80.0, 70.0, 150.0, 35.0, 130.0, 130.0, 90.0, 130.0, 100.0, 120.0, 140.0, 30.0, 80.0, 180.0, 130.0, 150.0, 180.0, 60.0, 100.0, 50.0, 60.0, -15.0, 130.0, 190.0, 90.0, 60.0, 130.0, 60.0, 160.0, 120.0, 140.0, 129.0, 110.0, 50.0, 200.0, 50.0, 140.0, 70.0, 120.0, 90.0, 38.0, 60.0, 90.0, 150.0, 59.0, 90.0, 95.0, 130.0, 80.0, 0.0, 90.0, 95.0, 35.0, 36.0, 80.0, 180.0, 100.0, 100.0, 50.0, 130.0, 170.0, 70.0, 60.0, 100.0, 120.0, 130.0, 50.0, -5.0, 20.0, 100.0, 150.0, 50.0, 110.0, 210.0, 30.0, 105.0, 110.0, 140.0, -10.0, 90.0, 199.0, 180.0, 90.0, 50.0, 33.0, 90.0, 90.0, 210.0, 160.0, 90.0, 180.0, 100.0, 160.0, 60.0, 50.0, 108.0, 69.0, 110.0, 70.0, 33.0, 70.0, 131.0, 110.0, 90.0, 28.0, 95.0, 100.0, 140.0, 39.0, 230.0, 70.0, 100.0, 30.0, 90.0, 70.0, 63.0, 70.0, 60.0, 50.0, 60.0, 60.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 130.0, 80.0, 110.0, 10.0, 40.0, 90.0, 40.0, 105.0, 210.0, 180.0, 120.0, 70.0, 20.0, 120.0, 80.0, 22.0, 120.0, 39.0, 150.0, 80.0, 100.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7053905520931958, "mean_inference_ms": 1.705848954144845, "mean_action_processing_ms": 0.5144285862865524, "mean_env_wait_ms": 1.1619090985488982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0195009708404541, "StateBufferConnector_ms": 0.008975744247436523, "ViewRequirementAgentConnector_ms": 0.36864185333251953}, "num_episodes": 18, "episode_return_max": 1389.0, "episode_return_min": 460.0, "episode_return_mean": 982.33}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.627185975450796, "num_env_steps_trained_throughput_per_sec": 20.627185975450796, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 4080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4080000, "timers": {"training_iteration_time_ms": 194439.269, "restore_workers_time_ms": 0.012, "training_step_time_ms": 194439.221, "sample_time_ms": 2482.791, "learn_time_ms": 191935.544, "learn_throughput": 20.84, "synch_weights_time_ms": 11.621}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "done": false, "training_iteration": 102, "trial_id": "1841f_00000", "date": "2024-08-08_05-12-05", "timestamp": 1723108325, "time_this_iter_s": 193.93066692352295, "time_total_s": 21108.930792093277, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29dfe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21108.930792093277, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 17.232846715328467, "ram_util_percent": 78.52883211678832}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9402102639880807, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.682346098212262, "policy_loss": -0.015696359584747722, "vf_loss": 8.696501363047396, "vf_explained_var": -0.031146788939881247, "kl": 0.007705415297510263, "entropy": 0.4992226611342801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 962475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "env_runners": {"episode_reward_max": 1389.0, "episode_reward_min": 460.0, "episode_reward_mean": 991.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 270.0}, "policy_reward_mean": {"policy_0": 99.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1007.0, 807.0, 465.0, 1253.0, 1385.0, 1195.0, 954.0, 1094.0, 950.0, 1255.0, 1165.0, 832.0, 1068.0, 835.0, 752.0, 1002.0, 705.0, 968.0, 853.0, 1068.0, 901.0, 912.0, 1064.0, 1034.0, 1087.0, 1389.0, 903.0, 1090.0, 792.0, 1130.0, 1048.0, 1215.0, 972.0, 1146.0, 990.0, 1199.0, 1160.0, 990.0, 776.0, 920.0, 1111.0, 983.0, 952.0, 864.0, 1181.0, 1057.0, 975.0, 1143.0, 1013.0, 1058.0, 938.0, 1070.0, 1150.0, 964.0, 1021.0, 932.0, 464.0, 1000.0, 741.0, 1074.0, 1025.0, 950.0, 1225.0, 1095.0, 1170.0, 915.0, 1129.0, 882.0, 766.0, 845.0, 995.0, 1192.0, 997.0, 836.0, 833.0, 460.0, 975.0, 791.0, 1199.0, 1189.0, 774.0, 840.0, 671.0, 1144.0, 978.0, 904.0, 955.0, 1048.0, 1138.0, 1298.0, 639.0, 822.0, 1012.0, 849.0, 1007.0, 791.0, 1281.0, 1070.0, 1282.0, 1131.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 130.0, 69.0, 76.0, 48.0, 70.0, 84.0, 80.0, 140.0, 160.0, 60.0, 50.0, 35.0, 130.0, 38.0, 110.0, 56.0, 162.0, 50.0, 116.0, 60.0, 5.0, 90.0, 80.0, 140.0, 30.0, 70.0, -90.0, 40.0, 40.0, 170.0, 210.0, 130.0, 270.0, 100.0, 70.0, 110.0, 49.0, 34.0, 110.0, 70.0, 180.0, 70.0, 230.0, 160.0, 200.0, 140.0, 150.0, 110.0, 75.0, 80.0, 110.0, 110.0, 107.0, 212.0, 76.0, 80.0, 160.0, 160.0, 100.0, 200.0, -3.0, 22.0, 70.0, 150.0, 70.0, 45.0, 160.0, 120.0, 120.0, 120.0, 78.0, 90.0, 120.0, 80.0, 99.0, 140.0, 130.0, 90.0, 147.0, 90.0, 70.0, 70.0, 40.0, 60.0, 80.0, 150.0, 100.0, 120.0, 170.0, 270.0, 70.0, 120.0, 150.0, 110.0, 18.0, 107.0, 170.0, 80.0, 160.0, 150.0, 70.0, 110.0, 210.0, 170.0, 60.0, 60.0, 150.0, 180.0, 5.0, 65.0, 70.0, 180.0, 70.0, 70.0, 130.0, 40.0, 120.0, 37.0, 50.0, 68.0, 170.0, 140.0, 90.0, 69.0, 100.0, 108.0, 95.0, 108.0, 120.0, 120.0, 40.0, 100.0, 70.0, 60.0, 180.0, 60.0, -35.0, 60.0, 180.0, 78.0, 91.0, 128.0, 69.0, 70.0, 60.0, 70.0, 120.0, 11.0, 55.0, 100.0, 90.0, 14.0, 190.0, 120.0, 170.0, 140.0, -12.0, 150.0, 40.0, 70.0, 80.0, 50.0, 70.0, 110.0, 100.0, 36.0, 90.0, 85.0, 14.0, 170.0, 110.0, 130.0, 40.0, 110.0, 100.0, 80.0, 88.0, 50.0, 90.0, 60.0, 100.0, 160.0, 90.0, 80.0, 90.0, 110.0, 40.0, 15.0, 108.0, 267.0, 110.0, 90.0, 110.0, 40.0, 70.0, 90.0, 61.0, 100.0, 130.0, 152.0, 80.0, 70.0, 80.0, 70.0, 65.0, 120.0, 84.0, 100.0, 80.0, 110.0, 60.0, 73.0, 95.0, 30.0, 130.0, 110.0, 140.0, 74.0, 90.0, 95.0, 47.0, 27.0, 130.0, 190.0, 45.0, 180.0, 160.0, 120.0, 70.0, 94.0, 150.0, 70.0, 55.0, 46.0, 166.0, 150.0, 53.0, 80.0, 170.0, 39.0, 120.0, 200.0, 50.0, 120.0, 19.0, 89.0, 190.0, 110.0, 150.0, 90.0, 119.0, 110.0, 130.0, 140.0, 125.0, 110.0, 165.0, 180.0, 220.0, 60.0, 31.0, 60.0, 100.0, 77.0, 160.0, 5.0, 210.0, 100.0, 100.0, 140.0, 156.0, 109.0, 109.0, 67.0, 196.0, 95.0, 60.0, 65.0, 93.0, 103.0, 10.0, 130.0, 46.0, 120.0, 33.0, 60.0, 150.0, 40.0, 100.0, 130.0, 160.0, 40.0, 180.0, 100.0, 180.0, 180.0, 60.0, 70.0, 30.0, 100.0, 130.0, 105.0, 110.0, 120.0, 120.0, 53.0, 110.0, 100.0, 100.0, 80.0, 65.0, 90.0, 70.0, 190.0, 210.0, 210.0, 100.0, 70.0, 130.0, 45.0, 130.0, 120.0, 64.0, 43.0, 100.0, 140.0, 120.0, 80.0, 130.0, 180.0, 50.0, 130.0, 170.0, 80.0, 100.0, 43.0, 143.0, 160.0, 90.0, 120.0, 50.0, 90.0, 170.0, 100.0, 120.0, 70.0, 100.0, 60.0, 110.0, 120.0, 130.0, 70.0, 120.0, 80.0, 110.0, 180.0, 89.0, 110.0, 190.0, 110.0, 110.0, 100.0, 160.0, 90.0, 60.0, 170.0, 80.0, 140.0, 140.0, 50.0, 70.0, 120.0, 120.0, 100.0, 20.0, 170.0, 110.0, 160.0, 70.0, 190.0, 30.0, 100.0, 150.0, 180.0, 20.0, 3.0, 71.0, 9.0, 23.0, 190.0, 50.0, 110.0, 190.0, 110.0, 60.0, 30.0, 40.0, 80.0, 60.0, 75.0, 170.0, 130.0, 112.0, 190.0, 130.0, 90.0, 200.0, 100.0, -86.0, 30.0, 33.0, 180.0, 44.0, 160.0, 21.0, 200.0, 48.0, 180.0, 87.0, 100.0, 70.0, 208.0, 70.0, 4.0, 70.0, 120.0, 110.0, 70.0, 130.0, 100.0, 70.0, 80.0, 100.0, 90.0, 53.0, 140.0, 90.0, 130.0, 11.0, 150.0, 179.0, 50.0, 101.0, 230.0, 30.0, 120.0, 96.0, 110.0, 115.0, 90.0, 60.0, 140.0, 100.0, -10.0, 80.0, 150.0, 190.0, 170.0, 87.0, 90.0, 140.0, 120.0, 80.0, 50.0, 90.0, 80.0, 60.0, 35.0, 230.0, 130.0, 116.0, 140.0, 130.0, 87.0, 90.0, 100.0, 180.0, 60.0, 110.0, 130.0, 110.0, 90.0, 100.0, 80.0, 180.0, 112.0, 52.0, 59.0, 100.0, 140.0, 79.0, 140.0, 140.0, 100.0, 80.0, 139.0, 90.0, 50.0, 100.0, 90.0, 80.0, 60.0, 60.0, 58.0, 80.0, 180.0, 90.0, 100.0, 140.0, 120.0, 160.0, 65.0, 56.0, 130.0, 160.0, 39.0, 60.0, 180.0, 100.0, 140.0, 140.0, 110.0, 110.0, 150.0, 70.0, 70.0, 110.0, 130.0, 120.0, 57.0, 100.0, 80.0, 107.0, 100.0, 90.0, 120.0, 130.0, 50.0, 130.0, 102.0, 77.0, 170.0, 86.0, 80.0, 110.0, 76.0, 120.0, 130.0, 70.0, 70.0, 60.0, 170.0, 120.0, 90.0, 60.0, 57.0, 140.0, 45.0, 120.0, 10.0, 20.0, 100.0, 100.0, 40.0, 29.0, 30.0, 56.0, 29.0, 50.0, 130.0, 60.0, 60.0, 70.0, 30.0, 60.0, 180.0, 170.0, 150.0, 90.0, 70.0, 120.0, 170.0, -105.0, 60.0, 66.0, 100.0, 92.0, 110.0, 58.0, 130.0, 190.0, 80.0, 84.0, 74.0, 66.0, 110.0, 60.0, 120.0, 160.0, 90.0, 180.0, 120.0, 30.0, 80.0, 130.0, 140.0, 65.0, 120.0, 70.0, 120.0, 175.0, 150.0, 70.0, 90.0, 70.0, 110.0, 110.0, 29.0, 26.0, 20.0, 190.0, 180.0, 120.0, 170.0, 87.0, 140.0, 150.0, 68.0, 100.0, 180.0, 80.0, 70.0, 150.0, 35.0, 130.0, 130.0, 90.0, 130.0, 100.0, 120.0, 140.0, 30.0, 80.0, 180.0, 130.0, 150.0, 180.0, 60.0, 100.0, 50.0, 60.0, -15.0, 130.0, 190.0, 90.0, 60.0, 130.0, 60.0, 160.0, 120.0, 140.0, 129.0, 110.0, 50.0, 200.0, 50.0, 140.0, 70.0, 120.0, 90.0, 38.0, 60.0, 90.0, 150.0, 59.0, 90.0, 95.0, 130.0, 80.0, 0.0, 90.0, 95.0, 35.0, 36.0, 80.0, 180.0, 100.0, 100.0, 50.0, 130.0, 170.0, 70.0, 60.0, 100.0, 120.0, 130.0, 50.0, -5.0, 20.0, 100.0, 150.0, 50.0, 110.0, 210.0, 30.0, 105.0, 110.0, 140.0, -10.0, 90.0, 199.0, 180.0, 90.0, 50.0, 33.0, 90.0, 90.0, 210.0, 160.0, 90.0, 180.0, 100.0, 160.0, 60.0, 50.0, 108.0, 69.0, 110.0, 70.0, 33.0, 70.0, 131.0, 110.0, 90.0, 28.0, 95.0, 100.0, 140.0, 39.0, 230.0, 70.0, 100.0, 30.0, 90.0, 70.0, 63.0, 70.0, 60.0, 50.0, 60.0, 60.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 130.0, 80.0, 110.0, 10.0, 40.0, 90.0, 40.0, 105.0, 210.0, 180.0, 120.0, 70.0, 20.0, 120.0, 80.0, 22.0, 120.0, 39.0, 150.0, 80.0, 100.0, 60.0, 111.0, 155.0, 250.0, 80.0, 93.0, 45.0, 23.0, 252.0, 120.0, 70.0, 110.0, 90.0, 119.0, 110.0, 160.0, 170.0, 120.0, 70.0, 60.0, 180.0, 120.0, 42.0, 60.0, 30.0, 84.0, 110.0, 130.0, 119.0, 48.0, 31.0, 40.0, 80.0, 110.0, 82.0, 90.0, 97.0, 30.0, 150.0, 81.0, 80.0, 100.0, 80.0, 20.0, 31.0, 120.0, 70.0, 80.0, 70.0, 100.0, 0.0, 66.0, 110.0, 138.0, 160.0, 140.0, 200.0, 70.0, 100.0, 80.0, 80.0, 98.0, 90.0, 14.0, -65.0, 120.0, 110.0, 180.0, 233.0, 98.0, 100.0, 80.0, 137.0, 50.0, 80.0, 137.0, 80.0, 118.0, 90.0, 52.0, 80.0, 60.0, 110.0, 110.0, 70.0, 190.0, 70.0, 140.0, 15.0, 80.0, 110.0, 130.0, 60.0, 110.0, 190.0, 103.0, 110.0, 50.0, 80.0, 140.0, 75.0, 92.0, 170.0, 44.0, 127.0, 170.0, 183.0, 140.0, 44.0, 100.0, 68.0, 110.0, 160.0, 186.0, 60.0, 160.0, 160.0, 90.0, 140.0, 130.0, 102.0, 49.0, 140.0, 127.0, 0.0, 80.0, 70.0, -11.0, 70.0, 65.0, 49.0, 100.0, 40.0, 170.0, 130.0, 60.0, 110.0, 60.0, 43.0, 29.0, 80.0, 115.0, 120.0, 58.0, 90.0, 50.0, 200.0, 140.0, 109.0, -5.0, 135.0, 43.0, 120.0, 120.0, 90.0, 56.0, 80.0, 90.0, 80.0, 90.0, 80.0, 110.0, 140.0, 100.0, 120.0, 80.0, 60.0, 48.0, 60.0, 130.0, 159.0, 50.0, 140.0, 90.0, 240.0, 36.0, 35.0, 70.0, 20.0, 80.0, 30.0, 210.0, 170.0, 95.0, 46.0, 90.0, 140.0, 170.0, 50.0, 180.0, 130.0, 130.0, 90.0, 60.0, 40.0, 160.0, 210.0, 60.0, 20.0, 180.0, 120.0, 60.0, 110.0, 190.0, 50.0, 160.0, 135.0, 117.0, 120.0, 150.0, 190.0, 80.0, 110.0, 160.0, 150.0, 70.0, 130.0, 110.0, 90.0, 157.0, 74.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7031023632531126, "mean_inference_ms": 1.7035318037391847, "mean_action_processing_ms": 0.5136455607677248, "mean_env_wait_ms": 1.1598271662744577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01936030387878418, "StateBufferConnector_ms": 0.00889277458190918, "ViewRequirementAgentConnector_ms": 0.3647196292877197}, "num_episodes": 22, "episode_return_max": 1389.0, "episode_return_min": 460.0, "episode_return_mean": 991.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.651228328650806, "num_env_steps_trained_throughput_per_sec": 20.651228328650806, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 4120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4120000, "timers": {"training_iteration_time_ms": 194352.459, "restore_workers_time_ms": 0.012, "training_step_time_ms": 194352.411, "sample_time_ms": 2490.795, "learn_time_ms": 191840.668, "learn_throughput": 20.851, "synch_weights_time_ms": 11.584}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "done": false, "training_iteration": 103, "trial_id": "1841f_00000", "date": "2024-08-08_05-15-19", "timestamp": 1723108519, "time_this_iter_s": 193.70080423355103, "time_total_s": 21302.631596326828, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29d5e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21302.631596326828, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 17.03029197080292, "ram_util_percent": 78.6007299270073}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1115078261231206, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.625235436137872, "policy_loss": -0.015453379031437368, "vf_loss": 8.639104035817269, "vf_explained_var": -0.02637114408678902, "kl": 0.007923894639163492, "entropy": 0.4902294797638354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 971865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "env_runners": {"episode_reward_max": 1398.0, "episode_reward_min": 460.0, "episode_reward_mean": 1005.43, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 318.0}, "policy_reward_mean": {"policy_0": 100.543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [853.0, 1068.0, 901.0, 912.0, 1064.0, 1034.0, 1087.0, 1389.0, 903.0, 1090.0, 792.0, 1130.0, 1048.0, 1215.0, 972.0, 1146.0, 990.0, 1199.0, 1160.0, 990.0, 776.0, 920.0, 1111.0, 983.0, 952.0, 864.0, 1181.0, 1057.0, 975.0, 1143.0, 1013.0, 1058.0, 938.0, 1070.0, 1150.0, 964.0, 1021.0, 932.0, 464.0, 1000.0, 741.0, 1074.0, 1025.0, 950.0, 1225.0, 1095.0, 1170.0, 915.0, 1129.0, 882.0, 766.0, 845.0, 995.0, 1192.0, 997.0, 836.0, 833.0, 460.0, 975.0, 791.0, 1199.0, 1189.0, 774.0, 840.0, 671.0, 1144.0, 978.0, 904.0, 955.0, 1048.0, 1138.0, 1298.0, 639.0, 822.0, 1012.0, 849.0, 1007.0, 791.0, 1281.0, 1070.0, 1282.0, 1131.0, 1274.0, 1074.0, 755.0, 1224.0, 830.0, 1010.0, 1398.0, 1071.0, 799.0, 975.0, 962.0, 1380.0, 1100.0, 1007.0, 1010.0, 1255.0, 976.0, 1010.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 100.0, 160.0, 90.0, 80.0, 90.0, 110.0, 40.0, 15.0, 108.0, 267.0, 110.0, 90.0, 110.0, 40.0, 70.0, 90.0, 61.0, 100.0, 130.0, 152.0, 80.0, 70.0, 80.0, 70.0, 65.0, 120.0, 84.0, 100.0, 80.0, 110.0, 60.0, 73.0, 95.0, 30.0, 130.0, 110.0, 140.0, 74.0, 90.0, 95.0, 47.0, 27.0, 130.0, 190.0, 45.0, 180.0, 160.0, 120.0, 70.0, 94.0, 150.0, 70.0, 55.0, 46.0, 166.0, 150.0, 53.0, 80.0, 170.0, 39.0, 120.0, 200.0, 50.0, 120.0, 19.0, 89.0, 190.0, 110.0, 150.0, 90.0, 119.0, 110.0, 130.0, 140.0, 125.0, 110.0, 165.0, 180.0, 220.0, 60.0, 31.0, 60.0, 100.0, 77.0, 160.0, 5.0, 210.0, 100.0, 100.0, 140.0, 156.0, 109.0, 109.0, 67.0, 196.0, 95.0, 60.0, 65.0, 93.0, 103.0, 10.0, 130.0, 46.0, 120.0, 33.0, 60.0, 150.0, 40.0, 100.0, 130.0, 160.0, 40.0, 180.0, 100.0, 180.0, 180.0, 60.0, 70.0, 30.0, 100.0, 130.0, 105.0, 110.0, 120.0, 120.0, 53.0, 110.0, 100.0, 100.0, 80.0, 65.0, 90.0, 70.0, 190.0, 210.0, 210.0, 100.0, 70.0, 130.0, 45.0, 130.0, 120.0, 64.0, 43.0, 100.0, 140.0, 120.0, 80.0, 130.0, 180.0, 50.0, 130.0, 170.0, 80.0, 100.0, 43.0, 143.0, 160.0, 90.0, 120.0, 50.0, 90.0, 170.0, 100.0, 120.0, 70.0, 100.0, 60.0, 110.0, 120.0, 130.0, 70.0, 120.0, 80.0, 110.0, 180.0, 89.0, 110.0, 190.0, 110.0, 110.0, 100.0, 160.0, 90.0, 60.0, 170.0, 80.0, 140.0, 140.0, 50.0, 70.0, 120.0, 120.0, 100.0, 20.0, 170.0, 110.0, 160.0, 70.0, 190.0, 30.0, 100.0, 150.0, 180.0, 20.0, 3.0, 71.0, 9.0, 23.0, 190.0, 50.0, 110.0, 190.0, 110.0, 60.0, 30.0, 40.0, 80.0, 60.0, 75.0, 170.0, 130.0, 112.0, 190.0, 130.0, 90.0, 200.0, 100.0, -86.0, 30.0, 33.0, 180.0, 44.0, 160.0, 21.0, 200.0, 48.0, 180.0, 87.0, 100.0, 70.0, 208.0, 70.0, 4.0, 70.0, 120.0, 110.0, 70.0, 130.0, 100.0, 70.0, 80.0, 100.0, 90.0, 53.0, 140.0, 90.0, 130.0, 11.0, 150.0, 179.0, 50.0, 101.0, 230.0, 30.0, 120.0, 96.0, 110.0, 115.0, 90.0, 60.0, 140.0, 100.0, -10.0, 80.0, 150.0, 190.0, 170.0, 87.0, 90.0, 140.0, 120.0, 80.0, 50.0, 90.0, 80.0, 60.0, 35.0, 230.0, 130.0, 116.0, 140.0, 130.0, 87.0, 90.0, 100.0, 180.0, 60.0, 110.0, 130.0, 110.0, 90.0, 100.0, 80.0, 180.0, 112.0, 52.0, 59.0, 100.0, 140.0, 79.0, 140.0, 140.0, 100.0, 80.0, 139.0, 90.0, 50.0, 100.0, 90.0, 80.0, 60.0, 60.0, 58.0, 80.0, 180.0, 90.0, 100.0, 140.0, 120.0, 160.0, 65.0, 56.0, 130.0, 160.0, 39.0, 60.0, 180.0, 100.0, 140.0, 140.0, 110.0, 110.0, 150.0, 70.0, 70.0, 110.0, 130.0, 120.0, 57.0, 100.0, 80.0, 107.0, 100.0, 90.0, 120.0, 130.0, 50.0, 130.0, 102.0, 77.0, 170.0, 86.0, 80.0, 110.0, 76.0, 120.0, 130.0, 70.0, 70.0, 60.0, 170.0, 120.0, 90.0, 60.0, 57.0, 140.0, 45.0, 120.0, 10.0, 20.0, 100.0, 100.0, 40.0, 29.0, 30.0, 56.0, 29.0, 50.0, 130.0, 60.0, 60.0, 70.0, 30.0, 60.0, 180.0, 170.0, 150.0, 90.0, 70.0, 120.0, 170.0, -105.0, 60.0, 66.0, 100.0, 92.0, 110.0, 58.0, 130.0, 190.0, 80.0, 84.0, 74.0, 66.0, 110.0, 60.0, 120.0, 160.0, 90.0, 180.0, 120.0, 30.0, 80.0, 130.0, 140.0, 65.0, 120.0, 70.0, 120.0, 175.0, 150.0, 70.0, 90.0, 70.0, 110.0, 110.0, 29.0, 26.0, 20.0, 190.0, 180.0, 120.0, 170.0, 87.0, 140.0, 150.0, 68.0, 100.0, 180.0, 80.0, 70.0, 150.0, 35.0, 130.0, 130.0, 90.0, 130.0, 100.0, 120.0, 140.0, 30.0, 80.0, 180.0, 130.0, 150.0, 180.0, 60.0, 100.0, 50.0, 60.0, -15.0, 130.0, 190.0, 90.0, 60.0, 130.0, 60.0, 160.0, 120.0, 140.0, 129.0, 110.0, 50.0, 200.0, 50.0, 140.0, 70.0, 120.0, 90.0, 38.0, 60.0, 90.0, 150.0, 59.0, 90.0, 95.0, 130.0, 80.0, 0.0, 90.0, 95.0, 35.0, 36.0, 80.0, 180.0, 100.0, 100.0, 50.0, 130.0, 170.0, 70.0, 60.0, 100.0, 120.0, 130.0, 50.0, -5.0, 20.0, 100.0, 150.0, 50.0, 110.0, 210.0, 30.0, 105.0, 110.0, 140.0, -10.0, 90.0, 199.0, 180.0, 90.0, 50.0, 33.0, 90.0, 90.0, 210.0, 160.0, 90.0, 180.0, 100.0, 160.0, 60.0, 50.0, 108.0, 69.0, 110.0, 70.0, 33.0, 70.0, 131.0, 110.0, 90.0, 28.0, 95.0, 100.0, 140.0, 39.0, 230.0, 70.0, 100.0, 30.0, 90.0, 70.0, 63.0, 70.0, 60.0, 50.0, 60.0, 60.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 130.0, 80.0, 110.0, 10.0, 40.0, 90.0, 40.0, 105.0, 210.0, 180.0, 120.0, 70.0, 20.0, 120.0, 80.0, 22.0, 120.0, 39.0, 150.0, 80.0, 100.0, 60.0, 111.0, 155.0, 250.0, 80.0, 93.0, 45.0, 23.0, 252.0, 120.0, 70.0, 110.0, 90.0, 119.0, 110.0, 160.0, 170.0, 120.0, 70.0, 60.0, 180.0, 120.0, 42.0, 60.0, 30.0, 84.0, 110.0, 130.0, 119.0, 48.0, 31.0, 40.0, 80.0, 110.0, 82.0, 90.0, 97.0, 30.0, 150.0, 81.0, 80.0, 100.0, 80.0, 20.0, 31.0, 120.0, 70.0, 80.0, 70.0, 100.0, 0.0, 66.0, 110.0, 138.0, 160.0, 140.0, 200.0, 70.0, 100.0, 80.0, 80.0, 98.0, 90.0, 14.0, -65.0, 120.0, 110.0, 180.0, 233.0, 98.0, 100.0, 80.0, 137.0, 50.0, 80.0, 137.0, 80.0, 118.0, 90.0, 52.0, 80.0, 60.0, 110.0, 110.0, 70.0, 190.0, 70.0, 140.0, 15.0, 80.0, 110.0, 130.0, 60.0, 110.0, 190.0, 103.0, 110.0, 50.0, 80.0, 140.0, 75.0, 92.0, 170.0, 44.0, 127.0, 170.0, 183.0, 140.0, 44.0, 100.0, 68.0, 110.0, 160.0, 186.0, 60.0, 160.0, 160.0, 90.0, 140.0, 130.0, 102.0, 49.0, 140.0, 127.0, 0.0, 80.0, 70.0, -11.0, 70.0, 65.0, 49.0, 100.0, 40.0, 170.0, 130.0, 60.0, 110.0, 60.0, 43.0, 29.0, 80.0, 115.0, 120.0, 58.0, 90.0, 50.0, 200.0, 140.0, 109.0, -5.0, 135.0, 43.0, 120.0, 120.0, 90.0, 56.0, 80.0, 90.0, 80.0, 90.0, 80.0, 110.0, 140.0, 100.0, 120.0, 80.0, 60.0, 48.0, 60.0, 130.0, 159.0, 50.0, 140.0, 90.0, 240.0, 36.0, 35.0, 70.0, 20.0, 80.0, 30.0, 210.0, 170.0, 95.0, 46.0, 90.0, 140.0, 170.0, 50.0, 180.0, 130.0, 130.0, 90.0, 60.0, 40.0, 160.0, 210.0, 60.0, 20.0, 180.0, 120.0, 60.0, 110.0, 190.0, 50.0, 160.0, 135.0, 117.0, 120.0, 150.0, 190.0, 80.0, 110.0, 160.0, 150.0, 70.0, 130.0, 110.0, 90.0, 157.0, 74.0, 250.0, 134.0, 220.0, 40.0, 80.0, 140.0, 110.0, 45.0, 130.0, 125.0, 62.0, 80.0, 211.0, 160.0, 90.0, 80.0, 51.0, 90.0, 130.0, 120.0, 90.0, 65.0, 60.0, 90.0, 130.0, 140.0, 90.0, 30.0, 30.0, 30.0, 180.0, 11.0, 180.0, 100.0, 73.0, 40.0, 110.0, 230.0, 200.0, 100.0, 90.0, 40.0, 80.0, 150.0, 30.0, 130.0, 40.0, 60.0, 70.0, 140.0, 90.0, 67.0, 70.0, 260.0, 65.0, 130.0, 100.0, 40.0, 78.0, 110.0, 170.0, 160.0, 70.0, 160.0, 120.0, 140.0, 128.0, 130.0, 130.0, 190.0, 105.0, 318.0, 117.0, 60.0, 70.0, 48.0, 120.0, 100.0, 30.0, 103.0, 110.0, 130.0, 70.0, 30.0, 90.0, 170.0, 45.0, 15.0, 69.0, 70.0, 70.0, 60.0, 160.0, 120.0, 110.0, 70.0, 80.0, 130.0, 65.0, 110.0, 100.0, 130.0, 80.0, 60.0, 190.0, 85.0, 90.0, 60.0, 60.0, 107.0, 140.0, 210.0, 160.0, 130.0, 90.0, 90.0, 210.0, 110.0, 110.0, 130.0, 180.0, 70.0, 150.0, 80.0, 150.0, 90.0, 170.0, 100.0, 40.0, 70.0, 82.0, 60.0, 70.0, 110.0, 75.0, 90.0, 120.0, 90.0, 160.0, 150.0, 80.0, 140.0, 80.0, 30.0, 110.0, 110.0, 50.0, 120.0, 200.0, 90.0, 50.0, 180.0, 110.0, 130.0, 160.0, 145.0, 95.0, 100.0, 155.0, 130.0, 9.0, 98.0, 120.0, 100.0, -1.0, 110.0, 140.0, 80.0, 190.0, 130.0, 68.0, 58.0, 80.0, 90.0, 46.0, 180.0, 110.0, 58.0, 130.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.699239532035114, "mean_inference_ms": 1.6991145502660772, "mean_action_processing_ms": 0.5128989345463897, "mean_env_wait_ms": 1.158586463609894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018982410430908203, "StateBufferConnector_ms": 0.008727788925170898, "ViewRequirementAgentConnector_ms": 0.3794078826904297}, "num_episodes": 18, "episode_return_max": 1398.0, "episode_return_min": 460.0, "episode_return_mean": 1005.43}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.636987950467944, "num_env_steps_trained_throughput_per_sec": 20.636987950467944, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 4160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4160000, "timers": {"training_iteration_time_ms": 194362.812, "restore_workers_time_ms": 0.012, "training_step_time_ms": 194362.753, "sample_time_ms": 2488.071, "learn_time_ms": 191853.119, "learn_throughput": 20.849, "synch_weights_time_ms": 12.138}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "done": false, "training_iteration": 104, "trial_id": "1841f_00000", "date": "2024-08-08_05-18-33", "timestamp": 1723108713, "time_this_iter_s": 193.83750987052917, "time_total_s": 21496.469106197357, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b56c7670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21496.469106197357, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 17.5543795620438, "ram_util_percent": 78.31788321167883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1415989392164287, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.461074606526774, "policy_loss": -0.014556218995660626, "vf_loss": 8.47406253438915, "vf_explained_var": -0.025974103284720034, "kl": 0.007841429748395889, "entropy": 0.503826874894456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 981255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "env_runners": {"episode_reward_max": 1479.0, "episode_reward_min": 460.0, "episode_reward_mean": 994.36, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 318.0}, "policy_reward_mean": {"policy_0": 99.436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1160.0, 990.0, 776.0, 920.0, 1111.0, 983.0, 952.0, 864.0, 1181.0, 1057.0, 975.0, 1143.0, 1013.0, 1058.0, 938.0, 1070.0, 1150.0, 964.0, 1021.0, 932.0, 464.0, 1000.0, 741.0, 1074.0, 1025.0, 950.0, 1225.0, 1095.0, 1170.0, 915.0, 1129.0, 882.0, 766.0, 845.0, 995.0, 1192.0, 997.0, 836.0, 833.0, 460.0, 975.0, 791.0, 1199.0, 1189.0, 774.0, 840.0, 671.0, 1144.0, 978.0, 904.0, 955.0, 1048.0, 1138.0, 1298.0, 639.0, 822.0, 1012.0, 849.0, 1007.0, 791.0, 1281.0, 1070.0, 1282.0, 1131.0, 1274.0, 1074.0, 755.0, 1224.0, 830.0, 1010.0, 1398.0, 1071.0, 799.0, 975.0, 962.0, 1380.0, 1100.0, 1007.0, 1010.0, 1255.0, 976.0, 1010.0, 885.0, 1082.0, 647.0, 670.0, 861.0, 932.0, 870.0, 1080.0, 1225.0, 945.0, 1049.0, 1479.0, 683.0, 1057.0, 1140.0, 853.0, 1100.0, 1128.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 110.0, 100.0, 160.0, 90.0, 60.0, 170.0, 80.0, 140.0, 140.0, 50.0, 70.0, 120.0, 120.0, 100.0, 20.0, 170.0, 110.0, 160.0, 70.0, 190.0, 30.0, 100.0, 150.0, 180.0, 20.0, 3.0, 71.0, 9.0, 23.0, 190.0, 50.0, 110.0, 190.0, 110.0, 60.0, 30.0, 40.0, 80.0, 60.0, 75.0, 170.0, 130.0, 112.0, 190.0, 130.0, 90.0, 200.0, 100.0, -86.0, 30.0, 33.0, 180.0, 44.0, 160.0, 21.0, 200.0, 48.0, 180.0, 87.0, 100.0, 70.0, 208.0, 70.0, 4.0, 70.0, 120.0, 110.0, 70.0, 130.0, 100.0, 70.0, 80.0, 100.0, 90.0, 53.0, 140.0, 90.0, 130.0, 11.0, 150.0, 179.0, 50.0, 101.0, 230.0, 30.0, 120.0, 96.0, 110.0, 115.0, 90.0, 60.0, 140.0, 100.0, -10.0, 80.0, 150.0, 190.0, 170.0, 87.0, 90.0, 140.0, 120.0, 80.0, 50.0, 90.0, 80.0, 60.0, 35.0, 230.0, 130.0, 116.0, 140.0, 130.0, 87.0, 90.0, 100.0, 180.0, 60.0, 110.0, 130.0, 110.0, 90.0, 100.0, 80.0, 180.0, 112.0, 52.0, 59.0, 100.0, 140.0, 79.0, 140.0, 140.0, 100.0, 80.0, 139.0, 90.0, 50.0, 100.0, 90.0, 80.0, 60.0, 60.0, 58.0, 80.0, 180.0, 90.0, 100.0, 140.0, 120.0, 160.0, 65.0, 56.0, 130.0, 160.0, 39.0, 60.0, 180.0, 100.0, 140.0, 140.0, 110.0, 110.0, 150.0, 70.0, 70.0, 110.0, 130.0, 120.0, 57.0, 100.0, 80.0, 107.0, 100.0, 90.0, 120.0, 130.0, 50.0, 130.0, 102.0, 77.0, 170.0, 86.0, 80.0, 110.0, 76.0, 120.0, 130.0, 70.0, 70.0, 60.0, 170.0, 120.0, 90.0, 60.0, 57.0, 140.0, 45.0, 120.0, 10.0, 20.0, 100.0, 100.0, 40.0, 29.0, 30.0, 56.0, 29.0, 50.0, 130.0, 60.0, 60.0, 70.0, 30.0, 60.0, 180.0, 170.0, 150.0, 90.0, 70.0, 120.0, 170.0, -105.0, 60.0, 66.0, 100.0, 92.0, 110.0, 58.0, 130.0, 190.0, 80.0, 84.0, 74.0, 66.0, 110.0, 60.0, 120.0, 160.0, 90.0, 180.0, 120.0, 30.0, 80.0, 130.0, 140.0, 65.0, 120.0, 70.0, 120.0, 175.0, 150.0, 70.0, 90.0, 70.0, 110.0, 110.0, 29.0, 26.0, 20.0, 190.0, 180.0, 120.0, 170.0, 87.0, 140.0, 150.0, 68.0, 100.0, 180.0, 80.0, 70.0, 150.0, 35.0, 130.0, 130.0, 90.0, 130.0, 100.0, 120.0, 140.0, 30.0, 80.0, 180.0, 130.0, 150.0, 180.0, 60.0, 100.0, 50.0, 60.0, -15.0, 130.0, 190.0, 90.0, 60.0, 130.0, 60.0, 160.0, 120.0, 140.0, 129.0, 110.0, 50.0, 200.0, 50.0, 140.0, 70.0, 120.0, 90.0, 38.0, 60.0, 90.0, 150.0, 59.0, 90.0, 95.0, 130.0, 80.0, 0.0, 90.0, 95.0, 35.0, 36.0, 80.0, 180.0, 100.0, 100.0, 50.0, 130.0, 170.0, 70.0, 60.0, 100.0, 120.0, 130.0, 50.0, -5.0, 20.0, 100.0, 150.0, 50.0, 110.0, 210.0, 30.0, 105.0, 110.0, 140.0, -10.0, 90.0, 199.0, 180.0, 90.0, 50.0, 33.0, 90.0, 90.0, 210.0, 160.0, 90.0, 180.0, 100.0, 160.0, 60.0, 50.0, 108.0, 69.0, 110.0, 70.0, 33.0, 70.0, 131.0, 110.0, 90.0, 28.0, 95.0, 100.0, 140.0, 39.0, 230.0, 70.0, 100.0, 30.0, 90.0, 70.0, 63.0, 70.0, 60.0, 50.0, 60.0, 60.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 130.0, 80.0, 110.0, 10.0, 40.0, 90.0, 40.0, 105.0, 210.0, 180.0, 120.0, 70.0, 20.0, 120.0, 80.0, 22.0, 120.0, 39.0, 150.0, 80.0, 100.0, 60.0, 111.0, 155.0, 250.0, 80.0, 93.0, 45.0, 23.0, 252.0, 120.0, 70.0, 110.0, 90.0, 119.0, 110.0, 160.0, 170.0, 120.0, 70.0, 60.0, 180.0, 120.0, 42.0, 60.0, 30.0, 84.0, 110.0, 130.0, 119.0, 48.0, 31.0, 40.0, 80.0, 110.0, 82.0, 90.0, 97.0, 30.0, 150.0, 81.0, 80.0, 100.0, 80.0, 20.0, 31.0, 120.0, 70.0, 80.0, 70.0, 100.0, 0.0, 66.0, 110.0, 138.0, 160.0, 140.0, 200.0, 70.0, 100.0, 80.0, 80.0, 98.0, 90.0, 14.0, -65.0, 120.0, 110.0, 180.0, 233.0, 98.0, 100.0, 80.0, 137.0, 50.0, 80.0, 137.0, 80.0, 118.0, 90.0, 52.0, 80.0, 60.0, 110.0, 110.0, 70.0, 190.0, 70.0, 140.0, 15.0, 80.0, 110.0, 130.0, 60.0, 110.0, 190.0, 103.0, 110.0, 50.0, 80.0, 140.0, 75.0, 92.0, 170.0, 44.0, 127.0, 170.0, 183.0, 140.0, 44.0, 100.0, 68.0, 110.0, 160.0, 186.0, 60.0, 160.0, 160.0, 90.0, 140.0, 130.0, 102.0, 49.0, 140.0, 127.0, 0.0, 80.0, 70.0, -11.0, 70.0, 65.0, 49.0, 100.0, 40.0, 170.0, 130.0, 60.0, 110.0, 60.0, 43.0, 29.0, 80.0, 115.0, 120.0, 58.0, 90.0, 50.0, 200.0, 140.0, 109.0, -5.0, 135.0, 43.0, 120.0, 120.0, 90.0, 56.0, 80.0, 90.0, 80.0, 90.0, 80.0, 110.0, 140.0, 100.0, 120.0, 80.0, 60.0, 48.0, 60.0, 130.0, 159.0, 50.0, 140.0, 90.0, 240.0, 36.0, 35.0, 70.0, 20.0, 80.0, 30.0, 210.0, 170.0, 95.0, 46.0, 90.0, 140.0, 170.0, 50.0, 180.0, 130.0, 130.0, 90.0, 60.0, 40.0, 160.0, 210.0, 60.0, 20.0, 180.0, 120.0, 60.0, 110.0, 190.0, 50.0, 160.0, 135.0, 117.0, 120.0, 150.0, 190.0, 80.0, 110.0, 160.0, 150.0, 70.0, 130.0, 110.0, 90.0, 157.0, 74.0, 250.0, 134.0, 220.0, 40.0, 80.0, 140.0, 110.0, 45.0, 130.0, 125.0, 62.0, 80.0, 211.0, 160.0, 90.0, 80.0, 51.0, 90.0, 130.0, 120.0, 90.0, 65.0, 60.0, 90.0, 130.0, 140.0, 90.0, 30.0, 30.0, 30.0, 180.0, 11.0, 180.0, 100.0, 73.0, 40.0, 110.0, 230.0, 200.0, 100.0, 90.0, 40.0, 80.0, 150.0, 30.0, 130.0, 40.0, 60.0, 70.0, 140.0, 90.0, 67.0, 70.0, 260.0, 65.0, 130.0, 100.0, 40.0, 78.0, 110.0, 170.0, 160.0, 70.0, 160.0, 120.0, 140.0, 128.0, 130.0, 130.0, 190.0, 105.0, 318.0, 117.0, 60.0, 70.0, 48.0, 120.0, 100.0, 30.0, 103.0, 110.0, 130.0, 70.0, 30.0, 90.0, 170.0, 45.0, 15.0, 69.0, 70.0, 70.0, 60.0, 160.0, 120.0, 110.0, 70.0, 80.0, 130.0, 65.0, 110.0, 100.0, 130.0, 80.0, 60.0, 190.0, 85.0, 90.0, 60.0, 60.0, 107.0, 140.0, 210.0, 160.0, 130.0, 90.0, 90.0, 210.0, 110.0, 110.0, 130.0, 180.0, 70.0, 150.0, 80.0, 150.0, 90.0, 170.0, 100.0, 40.0, 70.0, 82.0, 60.0, 70.0, 110.0, 75.0, 90.0, 120.0, 90.0, 160.0, 150.0, 80.0, 140.0, 80.0, 30.0, 110.0, 110.0, 50.0, 120.0, 200.0, 90.0, 50.0, 180.0, 110.0, 130.0, 160.0, 145.0, 95.0, 100.0, 155.0, 130.0, 9.0, 98.0, 120.0, 100.0, -1.0, 110.0, 140.0, 80.0, 190.0, 130.0, 68.0, 58.0, 80.0, 90.0, 46.0, 180.0, 110.0, 58.0, 130.0, 190.0, 150.0, 100.0, 100.0, 110.0, 90.0, 30.0, 70.0, 120.0, 35.0, 80.0, 166.0, 100.0, 90.0, 148.0, 100.0, 70.0, 120.0, 18.0, 160.0, 110.0, 68.0, 150.0, 85.0, 60.0, 60.0, 60.0, 20.0, -31.0, 9.0, 166.0, 90.0, 80.0, 60.0, 60.0, 40.0, 100.0, 80.0, 110.0, 10.0, 40.0, 150.0, -14.0, 110.0, 57.0, 30.0, 110.0, 30.0, 100.0, 97.0, 191.0, 70.0, 186.0, 80.0, 100.0, 31.0, 20.0, 130.0, 150.0, 45.0, 120.0, 70.0, 70.0, 60.0, 50.0, 40.0, 50.0, 60.0, 140.0, 200.0, 130.0, 70.0, 80.0, 120.0, 160.0, 25.0, 90.0, 240.0, 75.0, 60.0, 160.0, 60.0, 140.0, 60.0, 60.0, 200.0, 230.0, 180.0, 90.0, 150.0, 55.0, 100.0, 40.0, 79.0, 120.0, 120.0, 86.0, 100.0, 90.0, 90.0, 120.0, 25.0, 120.0, 210.0, 94.0, 110.0, 130.0, 80.0, 150.0, 70.0, 60.0, 90.0, 140.0, 125.0, 100.0, 140.0, 210.0, 200.0, 274.0, 141.0, 59.0, 150.0, 20.0, -20.0, 120.0, 80.0, 90.0, 70.0, 69.0, 34.0, 70.0, 140.0, 110.0, 70.0, 130.0, 55.0, 160.0, 101.0, 71.0, 130.0, 90.0, 190.0, 100.0, 140.0, 120.0, 70.0, 170.0, 80.0, 140.0, 80.0, 50.0, 44.0, 69.0, 115.0, 100.0, 90.0, 141.0, 6.0, 110.0, 90.0, 88.0, 20.0, 70.0, 140.0, 140.0, 200.0, 100.0, 110.0, 160.0, 100.0, 60.0, 78.0, 90.0, 40.0, 100.0, 170.0, 150.0, 60.0, 210.0, 180.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6963414275586643, "mean_inference_ms": 1.6961410214220007, "mean_action_processing_ms": 0.512721493403408, "mean_env_wait_ms": 1.157134271749576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011802196502685547, "StateBufferConnector_ms": 0.008715391159057617, "ViewRequirementAgentConnector_ms": 0.38117074966430664}, "num_episodes": 18, "episode_return_max": 1479.0, "episode_return_min": 460.0, "episode_return_mean": 994.36}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.606902269756393, "num_env_steps_trained_throughput_per_sec": 20.606902269756393, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 4200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4200000, "timers": {"training_iteration_time_ms": 194316.898, "restore_workers_time_ms": 0.012, "training_step_time_ms": 194316.839, "sample_time_ms": 2489.627, "learn_time_ms": 191805.781, "learn_throughput": 20.854, "synch_weights_time_ms": 12.225}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "done": false, "training_iteration": 105, "trial_id": "1841f_00000", "date": "2024-08-08_05-21-47", "timestamp": 1723108907, "time_this_iter_s": 194.11906790733337, "time_total_s": 21690.58817410469, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29d5040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21690.58817410469, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 17.38109090909091, "ram_util_percent": 77.0589090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.998114482974346, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.373214355393593, "policy_loss": -0.01576164185346716, "vf_loss": 8.387396307367359, "vf_explained_var": -0.028063709508623687, "kl": 0.00789844919689584, "entropy": 0.5095146498741052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 990645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "env_runners": {"episode_reward_max": 1479.0, "episode_reward_min": 460.0, "episode_reward_mean": 988.82, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 318.0}, "policy_reward_mean": {"policy_0": 98.882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1074.0, 1025.0, 950.0, 1225.0, 1095.0, 1170.0, 915.0, 1129.0, 882.0, 766.0, 845.0, 995.0, 1192.0, 997.0, 836.0, 833.0, 460.0, 975.0, 791.0, 1199.0, 1189.0, 774.0, 840.0, 671.0, 1144.0, 978.0, 904.0, 955.0, 1048.0, 1138.0, 1298.0, 639.0, 822.0, 1012.0, 849.0, 1007.0, 791.0, 1281.0, 1070.0, 1282.0, 1131.0, 1274.0, 1074.0, 755.0, 1224.0, 830.0, 1010.0, 1398.0, 1071.0, 799.0, 975.0, 962.0, 1380.0, 1100.0, 1007.0, 1010.0, 1255.0, 976.0, 1010.0, 885.0, 1082.0, 647.0, 670.0, 861.0, 932.0, 870.0, 1080.0, 1225.0, 945.0, 1049.0, 1479.0, 683.0, 1057.0, 1140.0, 853.0, 1100.0, 1128.0, 799.0, 1100.0, 1120.0, 980.0, 857.0, 842.0, 1206.0, 875.0, 968.0, 547.0, 1259.0, 1198.0, 1030.0, 1115.0, 1010.0, 835.0, 1014.0, 1048.0, 643.0, 694.0, 1405.0, 583.0, 781.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 190.0, 80.0, 84.0, 74.0, 66.0, 110.0, 60.0, 120.0, 160.0, 90.0, 180.0, 120.0, 30.0, 80.0, 130.0, 140.0, 65.0, 120.0, 70.0, 120.0, 175.0, 150.0, 70.0, 90.0, 70.0, 110.0, 110.0, 29.0, 26.0, 20.0, 190.0, 180.0, 120.0, 170.0, 87.0, 140.0, 150.0, 68.0, 100.0, 180.0, 80.0, 70.0, 150.0, 35.0, 130.0, 130.0, 90.0, 130.0, 100.0, 120.0, 140.0, 30.0, 80.0, 180.0, 130.0, 150.0, 180.0, 60.0, 100.0, 50.0, 60.0, -15.0, 130.0, 190.0, 90.0, 60.0, 130.0, 60.0, 160.0, 120.0, 140.0, 129.0, 110.0, 50.0, 200.0, 50.0, 140.0, 70.0, 120.0, 90.0, 38.0, 60.0, 90.0, 150.0, 59.0, 90.0, 95.0, 130.0, 80.0, 0.0, 90.0, 95.0, 35.0, 36.0, 80.0, 180.0, 100.0, 100.0, 50.0, 130.0, 170.0, 70.0, 60.0, 100.0, 120.0, 130.0, 50.0, -5.0, 20.0, 100.0, 150.0, 50.0, 110.0, 210.0, 30.0, 105.0, 110.0, 140.0, -10.0, 90.0, 199.0, 180.0, 90.0, 50.0, 33.0, 90.0, 90.0, 210.0, 160.0, 90.0, 180.0, 100.0, 160.0, 60.0, 50.0, 108.0, 69.0, 110.0, 70.0, 33.0, 70.0, 131.0, 110.0, 90.0, 28.0, 95.0, 100.0, 140.0, 39.0, 230.0, 70.0, 100.0, 30.0, 90.0, 70.0, 63.0, 70.0, 60.0, 50.0, 60.0, 60.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 130.0, 80.0, 110.0, 10.0, 40.0, 90.0, 40.0, 105.0, 210.0, 180.0, 120.0, 70.0, 20.0, 120.0, 80.0, 22.0, 120.0, 39.0, 150.0, 80.0, 100.0, 60.0, 111.0, 155.0, 250.0, 80.0, 93.0, 45.0, 23.0, 252.0, 120.0, 70.0, 110.0, 90.0, 119.0, 110.0, 160.0, 170.0, 120.0, 70.0, 60.0, 180.0, 120.0, 42.0, 60.0, 30.0, 84.0, 110.0, 130.0, 119.0, 48.0, 31.0, 40.0, 80.0, 110.0, 82.0, 90.0, 97.0, 30.0, 150.0, 81.0, 80.0, 100.0, 80.0, 20.0, 31.0, 120.0, 70.0, 80.0, 70.0, 100.0, 0.0, 66.0, 110.0, 138.0, 160.0, 140.0, 200.0, 70.0, 100.0, 80.0, 80.0, 98.0, 90.0, 14.0, -65.0, 120.0, 110.0, 180.0, 233.0, 98.0, 100.0, 80.0, 137.0, 50.0, 80.0, 137.0, 80.0, 118.0, 90.0, 52.0, 80.0, 60.0, 110.0, 110.0, 70.0, 190.0, 70.0, 140.0, 15.0, 80.0, 110.0, 130.0, 60.0, 110.0, 190.0, 103.0, 110.0, 50.0, 80.0, 140.0, 75.0, 92.0, 170.0, 44.0, 127.0, 170.0, 183.0, 140.0, 44.0, 100.0, 68.0, 110.0, 160.0, 186.0, 60.0, 160.0, 160.0, 90.0, 140.0, 130.0, 102.0, 49.0, 140.0, 127.0, 0.0, 80.0, 70.0, -11.0, 70.0, 65.0, 49.0, 100.0, 40.0, 170.0, 130.0, 60.0, 110.0, 60.0, 43.0, 29.0, 80.0, 115.0, 120.0, 58.0, 90.0, 50.0, 200.0, 140.0, 109.0, -5.0, 135.0, 43.0, 120.0, 120.0, 90.0, 56.0, 80.0, 90.0, 80.0, 90.0, 80.0, 110.0, 140.0, 100.0, 120.0, 80.0, 60.0, 48.0, 60.0, 130.0, 159.0, 50.0, 140.0, 90.0, 240.0, 36.0, 35.0, 70.0, 20.0, 80.0, 30.0, 210.0, 170.0, 95.0, 46.0, 90.0, 140.0, 170.0, 50.0, 180.0, 130.0, 130.0, 90.0, 60.0, 40.0, 160.0, 210.0, 60.0, 20.0, 180.0, 120.0, 60.0, 110.0, 190.0, 50.0, 160.0, 135.0, 117.0, 120.0, 150.0, 190.0, 80.0, 110.0, 160.0, 150.0, 70.0, 130.0, 110.0, 90.0, 157.0, 74.0, 250.0, 134.0, 220.0, 40.0, 80.0, 140.0, 110.0, 45.0, 130.0, 125.0, 62.0, 80.0, 211.0, 160.0, 90.0, 80.0, 51.0, 90.0, 130.0, 120.0, 90.0, 65.0, 60.0, 90.0, 130.0, 140.0, 90.0, 30.0, 30.0, 30.0, 180.0, 11.0, 180.0, 100.0, 73.0, 40.0, 110.0, 230.0, 200.0, 100.0, 90.0, 40.0, 80.0, 150.0, 30.0, 130.0, 40.0, 60.0, 70.0, 140.0, 90.0, 67.0, 70.0, 260.0, 65.0, 130.0, 100.0, 40.0, 78.0, 110.0, 170.0, 160.0, 70.0, 160.0, 120.0, 140.0, 128.0, 130.0, 130.0, 190.0, 105.0, 318.0, 117.0, 60.0, 70.0, 48.0, 120.0, 100.0, 30.0, 103.0, 110.0, 130.0, 70.0, 30.0, 90.0, 170.0, 45.0, 15.0, 69.0, 70.0, 70.0, 60.0, 160.0, 120.0, 110.0, 70.0, 80.0, 130.0, 65.0, 110.0, 100.0, 130.0, 80.0, 60.0, 190.0, 85.0, 90.0, 60.0, 60.0, 107.0, 140.0, 210.0, 160.0, 130.0, 90.0, 90.0, 210.0, 110.0, 110.0, 130.0, 180.0, 70.0, 150.0, 80.0, 150.0, 90.0, 170.0, 100.0, 40.0, 70.0, 82.0, 60.0, 70.0, 110.0, 75.0, 90.0, 120.0, 90.0, 160.0, 150.0, 80.0, 140.0, 80.0, 30.0, 110.0, 110.0, 50.0, 120.0, 200.0, 90.0, 50.0, 180.0, 110.0, 130.0, 160.0, 145.0, 95.0, 100.0, 155.0, 130.0, 9.0, 98.0, 120.0, 100.0, -1.0, 110.0, 140.0, 80.0, 190.0, 130.0, 68.0, 58.0, 80.0, 90.0, 46.0, 180.0, 110.0, 58.0, 130.0, 190.0, 150.0, 100.0, 100.0, 110.0, 90.0, 30.0, 70.0, 120.0, 35.0, 80.0, 166.0, 100.0, 90.0, 148.0, 100.0, 70.0, 120.0, 18.0, 160.0, 110.0, 68.0, 150.0, 85.0, 60.0, 60.0, 60.0, 20.0, -31.0, 9.0, 166.0, 90.0, 80.0, 60.0, 60.0, 40.0, 100.0, 80.0, 110.0, 10.0, 40.0, 150.0, -14.0, 110.0, 57.0, 30.0, 110.0, 30.0, 100.0, 97.0, 191.0, 70.0, 186.0, 80.0, 100.0, 31.0, 20.0, 130.0, 150.0, 45.0, 120.0, 70.0, 70.0, 60.0, 50.0, 40.0, 50.0, 60.0, 140.0, 200.0, 130.0, 70.0, 80.0, 120.0, 160.0, 25.0, 90.0, 240.0, 75.0, 60.0, 160.0, 60.0, 140.0, 60.0, 60.0, 200.0, 230.0, 180.0, 90.0, 150.0, 55.0, 100.0, 40.0, 79.0, 120.0, 120.0, 86.0, 100.0, 90.0, 90.0, 120.0, 25.0, 120.0, 210.0, 94.0, 110.0, 130.0, 80.0, 150.0, 70.0, 60.0, 90.0, 140.0, 125.0, 100.0, 140.0, 210.0, 200.0, 274.0, 141.0, 59.0, 150.0, 20.0, -20.0, 120.0, 80.0, 90.0, 70.0, 69.0, 34.0, 70.0, 140.0, 110.0, 70.0, 130.0, 55.0, 160.0, 101.0, 71.0, 130.0, 90.0, 190.0, 100.0, 140.0, 120.0, 70.0, 170.0, 80.0, 140.0, 80.0, 50.0, 44.0, 69.0, 115.0, 100.0, 90.0, 141.0, 6.0, 110.0, 90.0, 88.0, 20.0, 70.0, 140.0, 140.0, 200.0, 100.0, 110.0, 160.0, 100.0, 60.0, 78.0, 90.0, 40.0, 100.0, 170.0, 150.0, 60.0, 210.0, 180.0, 50.0, 70.0, 69.0, 60.0, 105.0, 75.0, 90.0, 60.0, 100.0, 90.0, 80.0, 150.0, 70.0, 110.0, 40.0, 100.0, 220.0, 160.0, 80.0, 70.0, 100.0, 80.0, 160.0, 140.0, 120.0, 90.0, 60.0, 90.0, 150.0, 110.0, 120.0, 130.0, 33.0, 105.0, 120.0, 140.0, 37.0, 60.0, 110.0, 175.0, 70.0, 120.0, 50.0, 90.0, 120.0, 80.0, 48.0, 50.0, 90.0, 130.0, 79.0, 0.0, 110.0, 130.0, 78.0, 160.0, -35.0, 80.0, 99.0, 110.0, 110.0, 170.0, 70.0, 80.0, 64.0, 22.0, 200.0, 200.0, 100.0, 150.0, 150.0, 60.0, 190.0, 90.0, 110.0, 20.0, -15.0, 110.0, 80.0, 150.0, 80.0, 110.0, 70.0, 160.0, 40.0, 40.0, 100.0, 80.0, 180.0, 100.0, 88.0, 90.0, 15.0, -4.0, 120.0, 30.0, 40.0, 60.0, 140.0, 17.0, 39.0, 230.0, 100.0, 140.0, 90.0, 140.0, 160.0, 110.0, 150.0, 50.0, 89.0, 60.0, 79.0, 120.0, 40.0, 160.0, 120.0, 119.0, 140.0, 180.0, 180.0, 80.0, 130.0, 170.0, 40.0, 170.0, 110.0, 90.0, 60.0, 80.0, 100.0, 80.0, 150.0, 90.0, 65.0, 130.0, 110.0, 90.0, 70.0, 210.0, 120.0, 200.0, 120.0, 60.0, 240.0, -10.0, 70.0, 50.0, 80.0, 30.0, 170.0, 95.0, 90.0, 35.0, -5.0, 80.0, 70.0, 50.0, 160.0, 160.0, 100.0, 110.0, 39.0, 50.0, 180.0, 170.0, 90.0, 170.0, 160.0, 45.0, 0.0, 180.0, 110.0, 50.0, 230.0, 130.0, 89.0, 90.0, 29.0, 70.0, 70.0, 120.0, 54.0, 43.0, 150.0, 60.0, 60.0, 23.0, 23.0, 20.0, 90.0, 70.0, 80.0, 180.0, 38.0, 88.0, 36.0, 57.0, 80.0, 25.0, 40.0, 135.0, 90.0, 70.0, 130.0, 160.0, 240.0, 140.0, 130.0, 120.0, 190.0, 100.0, 40.0, 31.0, 126.0, -43.0, 43.0, 60.0, 71.0, 110.0, 45.0, 170.0, 230.0, 140.0, 3.0, 29.0, 50.0, 30.0, 100.0, -31.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6929691170948076, "mean_inference_ms": 1.6927775154479974, "mean_action_processing_ms": 0.5124366996661959, "mean_env_wait_ms": 1.1554518729928613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011904478073120117, "StateBufferConnector_ms": 0.008618354797363281, "ViewRequirementAgentConnector_ms": 0.39749789237976074}, "num_episodes": 23, "episode_return_max": 1479.0, "episode_return_min": 460.0, "episode_return_mean": 988.82}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.71486446062839, "num_env_steps_trained_throughput_per_sec": 20.71486446062839, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 4240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4240000, "timers": {"training_iteration_time_ms": 194066.53, "restore_workers_time_ms": 0.012, "training_step_time_ms": 194066.469, "sample_time_ms": 2500.941, "learn_time_ms": 191544.178, "learn_throughput": 20.883, "synch_weights_time_ms": 12.026}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "done": false, "training_iteration": 106, "trial_id": "1841f_00000", "date": "2024-08-08_05-25-00", "timestamp": 1723109100, "time_this_iter_s": 193.10841417312622, "time_total_s": 21883.696588277817, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2450550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21883.696588277817, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 17.76813186813187, "ram_util_percent": 77.49304029304028}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.583254824926297, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.583629808232933, "policy_loss": -0.015678069120867097, "vf_loss": 8.597678585783742, "vf_explained_var": -0.020353675745546626, "kl": 0.008146547761171016, "entropy": 0.5026179640723494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1000035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "env_runners": {"episode_reward_max": 1479.0, "episode_reward_min": 547.0, "episode_reward_mean": 993.08, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 318.0}, "policy_reward_mean": {"policy_0": 99.308}, "custom_metrics": {}, "hist_stats": {"episode_reward": [791.0, 1199.0, 1189.0, 774.0, 840.0, 671.0, 1144.0, 978.0, 904.0, 955.0, 1048.0, 1138.0, 1298.0, 639.0, 822.0, 1012.0, 849.0, 1007.0, 791.0, 1281.0, 1070.0, 1282.0, 1131.0, 1274.0, 1074.0, 755.0, 1224.0, 830.0, 1010.0, 1398.0, 1071.0, 799.0, 975.0, 962.0, 1380.0, 1100.0, 1007.0, 1010.0, 1255.0, 976.0, 1010.0, 885.0, 1082.0, 647.0, 670.0, 861.0, 932.0, 870.0, 1080.0, 1225.0, 945.0, 1049.0, 1479.0, 683.0, 1057.0, 1140.0, 853.0, 1100.0, 1128.0, 799.0, 1100.0, 1120.0, 980.0, 857.0, 842.0, 1206.0, 875.0, 968.0, 547.0, 1259.0, 1198.0, 1030.0, 1115.0, 1010.0, 835.0, 1014.0, 1048.0, 643.0, 694.0, 1405.0, 583.0, 781.0, 1094.0, 1116.0, 885.0, 1200.0, 1437.0, 1013.0, 962.0, 580.0, 1073.0, 826.0, 942.0, 935.0, 786.0, 1020.0, 830.0, 1362.0, 844.0, 885.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 120.0, 80.0, 22.0, 120.0, 39.0, 150.0, 80.0, 100.0, 60.0, 111.0, 155.0, 250.0, 80.0, 93.0, 45.0, 23.0, 252.0, 120.0, 70.0, 110.0, 90.0, 119.0, 110.0, 160.0, 170.0, 120.0, 70.0, 60.0, 180.0, 120.0, 42.0, 60.0, 30.0, 84.0, 110.0, 130.0, 119.0, 48.0, 31.0, 40.0, 80.0, 110.0, 82.0, 90.0, 97.0, 30.0, 150.0, 81.0, 80.0, 100.0, 80.0, 20.0, 31.0, 120.0, 70.0, 80.0, 70.0, 100.0, 0.0, 66.0, 110.0, 138.0, 160.0, 140.0, 200.0, 70.0, 100.0, 80.0, 80.0, 98.0, 90.0, 14.0, -65.0, 120.0, 110.0, 180.0, 233.0, 98.0, 100.0, 80.0, 137.0, 50.0, 80.0, 137.0, 80.0, 118.0, 90.0, 52.0, 80.0, 60.0, 110.0, 110.0, 70.0, 190.0, 70.0, 140.0, 15.0, 80.0, 110.0, 130.0, 60.0, 110.0, 190.0, 103.0, 110.0, 50.0, 80.0, 140.0, 75.0, 92.0, 170.0, 44.0, 127.0, 170.0, 183.0, 140.0, 44.0, 100.0, 68.0, 110.0, 160.0, 186.0, 60.0, 160.0, 160.0, 90.0, 140.0, 130.0, 102.0, 49.0, 140.0, 127.0, 0.0, 80.0, 70.0, -11.0, 70.0, 65.0, 49.0, 100.0, 40.0, 170.0, 130.0, 60.0, 110.0, 60.0, 43.0, 29.0, 80.0, 115.0, 120.0, 58.0, 90.0, 50.0, 200.0, 140.0, 109.0, -5.0, 135.0, 43.0, 120.0, 120.0, 90.0, 56.0, 80.0, 90.0, 80.0, 90.0, 80.0, 110.0, 140.0, 100.0, 120.0, 80.0, 60.0, 48.0, 60.0, 130.0, 159.0, 50.0, 140.0, 90.0, 240.0, 36.0, 35.0, 70.0, 20.0, 80.0, 30.0, 210.0, 170.0, 95.0, 46.0, 90.0, 140.0, 170.0, 50.0, 180.0, 130.0, 130.0, 90.0, 60.0, 40.0, 160.0, 210.0, 60.0, 20.0, 180.0, 120.0, 60.0, 110.0, 190.0, 50.0, 160.0, 135.0, 117.0, 120.0, 150.0, 190.0, 80.0, 110.0, 160.0, 150.0, 70.0, 130.0, 110.0, 90.0, 157.0, 74.0, 250.0, 134.0, 220.0, 40.0, 80.0, 140.0, 110.0, 45.0, 130.0, 125.0, 62.0, 80.0, 211.0, 160.0, 90.0, 80.0, 51.0, 90.0, 130.0, 120.0, 90.0, 65.0, 60.0, 90.0, 130.0, 140.0, 90.0, 30.0, 30.0, 30.0, 180.0, 11.0, 180.0, 100.0, 73.0, 40.0, 110.0, 230.0, 200.0, 100.0, 90.0, 40.0, 80.0, 150.0, 30.0, 130.0, 40.0, 60.0, 70.0, 140.0, 90.0, 67.0, 70.0, 260.0, 65.0, 130.0, 100.0, 40.0, 78.0, 110.0, 170.0, 160.0, 70.0, 160.0, 120.0, 140.0, 128.0, 130.0, 130.0, 190.0, 105.0, 318.0, 117.0, 60.0, 70.0, 48.0, 120.0, 100.0, 30.0, 103.0, 110.0, 130.0, 70.0, 30.0, 90.0, 170.0, 45.0, 15.0, 69.0, 70.0, 70.0, 60.0, 160.0, 120.0, 110.0, 70.0, 80.0, 130.0, 65.0, 110.0, 100.0, 130.0, 80.0, 60.0, 190.0, 85.0, 90.0, 60.0, 60.0, 107.0, 140.0, 210.0, 160.0, 130.0, 90.0, 90.0, 210.0, 110.0, 110.0, 130.0, 180.0, 70.0, 150.0, 80.0, 150.0, 90.0, 170.0, 100.0, 40.0, 70.0, 82.0, 60.0, 70.0, 110.0, 75.0, 90.0, 120.0, 90.0, 160.0, 150.0, 80.0, 140.0, 80.0, 30.0, 110.0, 110.0, 50.0, 120.0, 200.0, 90.0, 50.0, 180.0, 110.0, 130.0, 160.0, 145.0, 95.0, 100.0, 155.0, 130.0, 9.0, 98.0, 120.0, 100.0, -1.0, 110.0, 140.0, 80.0, 190.0, 130.0, 68.0, 58.0, 80.0, 90.0, 46.0, 180.0, 110.0, 58.0, 130.0, 190.0, 150.0, 100.0, 100.0, 110.0, 90.0, 30.0, 70.0, 120.0, 35.0, 80.0, 166.0, 100.0, 90.0, 148.0, 100.0, 70.0, 120.0, 18.0, 160.0, 110.0, 68.0, 150.0, 85.0, 60.0, 60.0, 60.0, 20.0, -31.0, 9.0, 166.0, 90.0, 80.0, 60.0, 60.0, 40.0, 100.0, 80.0, 110.0, 10.0, 40.0, 150.0, -14.0, 110.0, 57.0, 30.0, 110.0, 30.0, 100.0, 97.0, 191.0, 70.0, 186.0, 80.0, 100.0, 31.0, 20.0, 130.0, 150.0, 45.0, 120.0, 70.0, 70.0, 60.0, 50.0, 40.0, 50.0, 60.0, 140.0, 200.0, 130.0, 70.0, 80.0, 120.0, 160.0, 25.0, 90.0, 240.0, 75.0, 60.0, 160.0, 60.0, 140.0, 60.0, 60.0, 200.0, 230.0, 180.0, 90.0, 150.0, 55.0, 100.0, 40.0, 79.0, 120.0, 120.0, 86.0, 100.0, 90.0, 90.0, 120.0, 25.0, 120.0, 210.0, 94.0, 110.0, 130.0, 80.0, 150.0, 70.0, 60.0, 90.0, 140.0, 125.0, 100.0, 140.0, 210.0, 200.0, 274.0, 141.0, 59.0, 150.0, 20.0, -20.0, 120.0, 80.0, 90.0, 70.0, 69.0, 34.0, 70.0, 140.0, 110.0, 70.0, 130.0, 55.0, 160.0, 101.0, 71.0, 130.0, 90.0, 190.0, 100.0, 140.0, 120.0, 70.0, 170.0, 80.0, 140.0, 80.0, 50.0, 44.0, 69.0, 115.0, 100.0, 90.0, 141.0, 6.0, 110.0, 90.0, 88.0, 20.0, 70.0, 140.0, 140.0, 200.0, 100.0, 110.0, 160.0, 100.0, 60.0, 78.0, 90.0, 40.0, 100.0, 170.0, 150.0, 60.0, 210.0, 180.0, 50.0, 70.0, 69.0, 60.0, 105.0, 75.0, 90.0, 60.0, 100.0, 90.0, 80.0, 150.0, 70.0, 110.0, 40.0, 100.0, 220.0, 160.0, 80.0, 70.0, 100.0, 80.0, 160.0, 140.0, 120.0, 90.0, 60.0, 90.0, 150.0, 110.0, 120.0, 130.0, 33.0, 105.0, 120.0, 140.0, 37.0, 60.0, 110.0, 175.0, 70.0, 120.0, 50.0, 90.0, 120.0, 80.0, 48.0, 50.0, 90.0, 130.0, 79.0, 0.0, 110.0, 130.0, 78.0, 160.0, -35.0, 80.0, 99.0, 110.0, 110.0, 170.0, 70.0, 80.0, 64.0, 22.0, 200.0, 200.0, 100.0, 150.0, 150.0, 60.0, 190.0, 90.0, 110.0, 20.0, -15.0, 110.0, 80.0, 150.0, 80.0, 110.0, 70.0, 160.0, 40.0, 40.0, 100.0, 80.0, 180.0, 100.0, 88.0, 90.0, 15.0, -4.0, 120.0, 30.0, 40.0, 60.0, 140.0, 17.0, 39.0, 230.0, 100.0, 140.0, 90.0, 140.0, 160.0, 110.0, 150.0, 50.0, 89.0, 60.0, 79.0, 120.0, 40.0, 160.0, 120.0, 119.0, 140.0, 180.0, 180.0, 80.0, 130.0, 170.0, 40.0, 170.0, 110.0, 90.0, 60.0, 80.0, 100.0, 80.0, 150.0, 90.0, 65.0, 130.0, 110.0, 90.0, 70.0, 210.0, 120.0, 200.0, 120.0, 60.0, 240.0, -10.0, 70.0, 50.0, 80.0, 30.0, 170.0, 95.0, 90.0, 35.0, -5.0, 80.0, 70.0, 50.0, 160.0, 160.0, 100.0, 110.0, 39.0, 50.0, 180.0, 170.0, 90.0, 170.0, 160.0, 45.0, 0.0, 180.0, 110.0, 50.0, 230.0, 130.0, 89.0, 90.0, 29.0, 70.0, 70.0, 120.0, 54.0, 43.0, 150.0, 60.0, 60.0, 23.0, 23.0, 20.0, 90.0, 70.0, 80.0, 180.0, 38.0, 88.0, 36.0, 57.0, 80.0, 25.0, 40.0, 135.0, 90.0, 70.0, 130.0, 160.0, 240.0, 140.0, 130.0, 120.0, 190.0, 100.0, 40.0, 31.0, 126.0, -43.0, 43.0, 60.0, 71.0, 110.0, 45.0, 170.0, 230.0, 140.0, 3.0, 29.0, 50.0, 30.0, 100.0, -31.0, 60.0, 90.0, 80.0, 170.0, 120.0, 40.0, 240.0, 127.0, 57.0, 60.0, 110.0, 120.0, 115.0, 129.0, 49.0, 70.0, 120.0, 163.0, 80.0, 180.0, 90.0, 80.0, 220.0, 130.0, 70.0, 60.0, 50.0, 110.0, 50.0, 90.0, 25.0, 90.0, 100.0, 110.0, 110.0, 180.0, 120.0, 110.0, 110.0, 170.0, 100.0, 80.0, 100.0, 100.0, 127.0, 130.0, 120.0, 150.0, 300.0, 180.0, 150.0, 73.0, 120.0, 70.0, 110.0, 170.0, 110.0, 110.0, 160.0, 60.0, 30.0, 159.0, 60.0, 70.0, 90.0, 30.0, 130.0, 120.0, 70.0, 180.0, 53.0, 30.0, 80.0, 40.0, 10.0, 20.0, 200.0, 70.0, 80.0, 40.0, 10.0, 31.0, 60.0, 160.0, 140.0, 200.0, 140.0, 72.0, 100.0, 0.0, 170.0, 70.0, 150.0, 80.0, 60.0, 56.0, 30.0, 98.0, 83.0, 120.0, 79.0, 159.0, 68.0, 75.0, 50.0, 5.0, 110.0, 190.0, 65.0, 90.0, 130.0, 160.0, 110.0, 50.0, 58.0, 27.0, 190.0, 120.0, 40.0, 80.0, 100.0, 120.0, 100.0, 110.0, 70.0, 69.0, 50.0, 7.0, 70.0, 80.0, 110.0, 110.0, 90.0, 70.0, 80.0, 90.0, 100.0, 160.0, 100.0, 130.0, 90.0, 50.0, 130.0, 140.0, 170.0, 30.0, 120.0, 20.0, 60.0, 30.0, 80.0, 80.0, 260.0, 31.0, 180.0, 110.0, 140.0, 60.0, 231.0, 160.0, 110.0, 140.0, 75.0, 110.0, 40.0, 118.0, 80.0, 80.0, 60.0, 46.0, 95.0, 70.0, 110.0, 80.0, 30.0, 90.0, 49.0, 240.0, 70.0, 36.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6902062604122279, "mean_inference_ms": 1.6899249290606602, "mean_action_processing_ms": 0.5122764176971182, "mean_env_wait_ms": 1.1540489935616218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011796236038208008, "StateBufferConnector_ms": 0.00852060317993164, "ViewRequirementAgentConnector_ms": 0.3995208740234375}, "num_episodes": 18, "episode_return_max": 1479.0, "episode_return_min": 547.0, "episode_return_mean": 993.08}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.69020194501821, "num_env_steps_trained_throughput_per_sec": 20.69020194501821, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 4280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4280000, "timers": {"training_iteration_time_ms": 194007.13, "restore_workers_time_ms": 0.012, "training_step_time_ms": 194007.07, "sample_time_ms": 2496.406, "learn_time_ms": 191489.257, "learn_throughput": 20.889, "synch_weights_time_ms": 12.169}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "done": false, "training_iteration": 107, "trial_id": "1841f_00000", "date": "2024-08-08_05-28-13", "timestamp": 1723109293, "time_this_iter_s": 193.337632894516, "time_total_s": 22077.034221172333, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b336a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22077.034221172333, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 17.39890510948905, "ram_util_percent": 76.33394160583941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7634611411851306, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.395452552659316, "policy_loss": -0.014483545731859237, "vf_loss": 8.408438055304547, "vf_explained_var": -0.010076826785446103, "kl": 0.007490260626159185, "entropy": 0.5285018278894841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1009425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "env_runners": {"episode_reward_max": 1479.0, "episode_reward_min": 547.0, "episode_reward_mean": 996.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -43.0}, "policy_reward_max": {"policy_0": 318.0}, "policy_reward_mean": {"policy_0": 99.635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1131.0, 1274.0, 1074.0, 755.0, 1224.0, 830.0, 1010.0, 1398.0, 1071.0, 799.0, 975.0, 962.0, 1380.0, 1100.0, 1007.0, 1010.0, 1255.0, 976.0, 1010.0, 885.0, 1082.0, 647.0, 670.0, 861.0, 932.0, 870.0, 1080.0, 1225.0, 945.0, 1049.0, 1479.0, 683.0, 1057.0, 1140.0, 853.0, 1100.0, 1128.0, 799.0, 1100.0, 1120.0, 980.0, 857.0, 842.0, 1206.0, 875.0, 968.0, 547.0, 1259.0, 1198.0, 1030.0, 1115.0, 1010.0, 835.0, 1014.0, 1048.0, 643.0, 694.0, 1405.0, 583.0, 781.0, 1094.0, 1116.0, 885.0, 1200.0, 1437.0, 1013.0, 962.0, 580.0, 1073.0, 826.0, 942.0, 935.0, 786.0, 1020.0, 830.0, 1362.0, 844.0, 885.0, 1090.0, 902.0, 860.0, 1090.0, 1014.0, 964.0, 1320.0, 945.0, 994.0, 1141.0, 660.0, 1011.0, 1051.0, 1070.0, 1340.0, 1125.0, 1054.0, 595.0, 1160.0, 969.0, 1083.0, 571.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 110.0, 160.0, 150.0, 70.0, 130.0, 110.0, 90.0, 157.0, 74.0, 250.0, 134.0, 220.0, 40.0, 80.0, 140.0, 110.0, 45.0, 130.0, 125.0, 62.0, 80.0, 211.0, 160.0, 90.0, 80.0, 51.0, 90.0, 130.0, 120.0, 90.0, 65.0, 60.0, 90.0, 130.0, 140.0, 90.0, 30.0, 30.0, 30.0, 180.0, 11.0, 180.0, 100.0, 73.0, 40.0, 110.0, 230.0, 200.0, 100.0, 90.0, 40.0, 80.0, 150.0, 30.0, 130.0, 40.0, 60.0, 70.0, 140.0, 90.0, 67.0, 70.0, 260.0, 65.0, 130.0, 100.0, 40.0, 78.0, 110.0, 170.0, 160.0, 70.0, 160.0, 120.0, 140.0, 128.0, 130.0, 130.0, 190.0, 105.0, 318.0, 117.0, 60.0, 70.0, 48.0, 120.0, 100.0, 30.0, 103.0, 110.0, 130.0, 70.0, 30.0, 90.0, 170.0, 45.0, 15.0, 69.0, 70.0, 70.0, 60.0, 160.0, 120.0, 110.0, 70.0, 80.0, 130.0, 65.0, 110.0, 100.0, 130.0, 80.0, 60.0, 190.0, 85.0, 90.0, 60.0, 60.0, 107.0, 140.0, 210.0, 160.0, 130.0, 90.0, 90.0, 210.0, 110.0, 110.0, 130.0, 180.0, 70.0, 150.0, 80.0, 150.0, 90.0, 170.0, 100.0, 40.0, 70.0, 82.0, 60.0, 70.0, 110.0, 75.0, 90.0, 120.0, 90.0, 160.0, 150.0, 80.0, 140.0, 80.0, 30.0, 110.0, 110.0, 50.0, 120.0, 200.0, 90.0, 50.0, 180.0, 110.0, 130.0, 160.0, 145.0, 95.0, 100.0, 155.0, 130.0, 9.0, 98.0, 120.0, 100.0, -1.0, 110.0, 140.0, 80.0, 190.0, 130.0, 68.0, 58.0, 80.0, 90.0, 46.0, 180.0, 110.0, 58.0, 130.0, 190.0, 150.0, 100.0, 100.0, 110.0, 90.0, 30.0, 70.0, 120.0, 35.0, 80.0, 166.0, 100.0, 90.0, 148.0, 100.0, 70.0, 120.0, 18.0, 160.0, 110.0, 68.0, 150.0, 85.0, 60.0, 60.0, 60.0, 20.0, -31.0, 9.0, 166.0, 90.0, 80.0, 60.0, 60.0, 40.0, 100.0, 80.0, 110.0, 10.0, 40.0, 150.0, -14.0, 110.0, 57.0, 30.0, 110.0, 30.0, 100.0, 97.0, 191.0, 70.0, 186.0, 80.0, 100.0, 31.0, 20.0, 130.0, 150.0, 45.0, 120.0, 70.0, 70.0, 60.0, 50.0, 40.0, 50.0, 60.0, 140.0, 200.0, 130.0, 70.0, 80.0, 120.0, 160.0, 25.0, 90.0, 240.0, 75.0, 60.0, 160.0, 60.0, 140.0, 60.0, 60.0, 200.0, 230.0, 180.0, 90.0, 150.0, 55.0, 100.0, 40.0, 79.0, 120.0, 120.0, 86.0, 100.0, 90.0, 90.0, 120.0, 25.0, 120.0, 210.0, 94.0, 110.0, 130.0, 80.0, 150.0, 70.0, 60.0, 90.0, 140.0, 125.0, 100.0, 140.0, 210.0, 200.0, 274.0, 141.0, 59.0, 150.0, 20.0, -20.0, 120.0, 80.0, 90.0, 70.0, 69.0, 34.0, 70.0, 140.0, 110.0, 70.0, 130.0, 55.0, 160.0, 101.0, 71.0, 130.0, 90.0, 190.0, 100.0, 140.0, 120.0, 70.0, 170.0, 80.0, 140.0, 80.0, 50.0, 44.0, 69.0, 115.0, 100.0, 90.0, 141.0, 6.0, 110.0, 90.0, 88.0, 20.0, 70.0, 140.0, 140.0, 200.0, 100.0, 110.0, 160.0, 100.0, 60.0, 78.0, 90.0, 40.0, 100.0, 170.0, 150.0, 60.0, 210.0, 180.0, 50.0, 70.0, 69.0, 60.0, 105.0, 75.0, 90.0, 60.0, 100.0, 90.0, 80.0, 150.0, 70.0, 110.0, 40.0, 100.0, 220.0, 160.0, 80.0, 70.0, 100.0, 80.0, 160.0, 140.0, 120.0, 90.0, 60.0, 90.0, 150.0, 110.0, 120.0, 130.0, 33.0, 105.0, 120.0, 140.0, 37.0, 60.0, 110.0, 175.0, 70.0, 120.0, 50.0, 90.0, 120.0, 80.0, 48.0, 50.0, 90.0, 130.0, 79.0, 0.0, 110.0, 130.0, 78.0, 160.0, -35.0, 80.0, 99.0, 110.0, 110.0, 170.0, 70.0, 80.0, 64.0, 22.0, 200.0, 200.0, 100.0, 150.0, 150.0, 60.0, 190.0, 90.0, 110.0, 20.0, -15.0, 110.0, 80.0, 150.0, 80.0, 110.0, 70.0, 160.0, 40.0, 40.0, 100.0, 80.0, 180.0, 100.0, 88.0, 90.0, 15.0, -4.0, 120.0, 30.0, 40.0, 60.0, 140.0, 17.0, 39.0, 230.0, 100.0, 140.0, 90.0, 140.0, 160.0, 110.0, 150.0, 50.0, 89.0, 60.0, 79.0, 120.0, 40.0, 160.0, 120.0, 119.0, 140.0, 180.0, 180.0, 80.0, 130.0, 170.0, 40.0, 170.0, 110.0, 90.0, 60.0, 80.0, 100.0, 80.0, 150.0, 90.0, 65.0, 130.0, 110.0, 90.0, 70.0, 210.0, 120.0, 200.0, 120.0, 60.0, 240.0, -10.0, 70.0, 50.0, 80.0, 30.0, 170.0, 95.0, 90.0, 35.0, -5.0, 80.0, 70.0, 50.0, 160.0, 160.0, 100.0, 110.0, 39.0, 50.0, 180.0, 170.0, 90.0, 170.0, 160.0, 45.0, 0.0, 180.0, 110.0, 50.0, 230.0, 130.0, 89.0, 90.0, 29.0, 70.0, 70.0, 120.0, 54.0, 43.0, 150.0, 60.0, 60.0, 23.0, 23.0, 20.0, 90.0, 70.0, 80.0, 180.0, 38.0, 88.0, 36.0, 57.0, 80.0, 25.0, 40.0, 135.0, 90.0, 70.0, 130.0, 160.0, 240.0, 140.0, 130.0, 120.0, 190.0, 100.0, 40.0, 31.0, 126.0, -43.0, 43.0, 60.0, 71.0, 110.0, 45.0, 170.0, 230.0, 140.0, 3.0, 29.0, 50.0, 30.0, 100.0, -31.0, 60.0, 90.0, 80.0, 170.0, 120.0, 40.0, 240.0, 127.0, 57.0, 60.0, 110.0, 120.0, 115.0, 129.0, 49.0, 70.0, 120.0, 163.0, 80.0, 180.0, 90.0, 80.0, 220.0, 130.0, 70.0, 60.0, 50.0, 110.0, 50.0, 90.0, 25.0, 90.0, 100.0, 110.0, 110.0, 180.0, 120.0, 110.0, 110.0, 170.0, 100.0, 80.0, 100.0, 100.0, 127.0, 130.0, 120.0, 150.0, 300.0, 180.0, 150.0, 73.0, 120.0, 70.0, 110.0, 170.0, 110.0, 110.0, 160.0, 60.0, 30.0, 159.0, 60.0, 70.0, 90.0, 30.0, 130.0, 120.0, 70.0, 180.0, 53.0, 30.0, 80.0, 40.0, 10.0, 20.0, 200.0, 70.0, 80.0, 40.0, 10.0, 31.0, 60.0, 160.0, 140.0, 200.0, 140.0, 72.0, 100.0, 0.0, 170.0, 70.0, 150.0, 80.0, 60.0, 56.0, 30.0, 98.0, 83.0, 120.0, 79.0, 159.0, 68.0, 75.0, 50.0, 5.0, 110.0, 190.0, 65.0, 90.0, 130.0, 160.0, 110.0, 50.0, 58.0, 27.0, 190.0, 120.0, 40.0, 80.0, 100.0, 120.0, 100.0, 110.0, 70.0, 69.0, 50.0, 7.0, 70.0, 80.0, 110.0, 110.0, 90.0, 70.0, 80.0, 90.0, 100.0, 160.0, 100.0, 130.0, 90.0, 50.0, 130.0, 140.0, 170.0, 30.0, 120.0, 20.0, 60.0, 30.0, 80.0, 80.0, 260.0, 31.0, 180.0, 110.0, 140.0, 60.0, 231.0, 160.0, 110.0, 140.0, 75.0, 110.0, 40.0, 118.0, 80.0, 80.0, 60.0, 46.0, 95.0, 70.0, 110.0, 80.0, 30.0, 90.0, 49.0, 240.0, 70.0, 36.0, 110.0, 40.0, 110.0, 90.0, 30.0, 50.0, 220.0, 120.0, 200.0, 150.0, 80.0, 110.0, 70.0, 190.0, 95.0, 70.0, 60.0, 60.0, 27.0, 110.0, 110.0, 60.0, 20.0, 80.0, 170.0, 60.0, 40.0, 200.0, 80.0, 90.0, 60.0, 50.0, 80.0, 130.0, 100.0, 70.0, 100.0, 190.0, 190.0, 110.0, 70.0, 90.0, 220.0, 120.0, 120.0, 90.0, 50.0, 30.0, 114.0, 50.0, 130.0, 160.0, 179.0, 70.0, 23.0, 110.0, 90.0, 110.0, 133.0, 9.0, 80.0, -20.0, 120.0, 100.0, 190.0, 60.0, 200.0, 160.0, 170.0, 110.0, 230.0, 60.0, 90.0, 50.0, 80.0, 75.0, 230.0, 80.0, 80.0, 140.0, 60.0, 130.0, 110.0, 130.0, 106.0, 110.0, 80.0, 70.0, 140.0, 58.0, 60.0, 120.0, 120.0, 130.0, 120.0, 150.0, 263.0, 20.0, 90.0, 18.0, 110.0, 110.0, 50.0, 70.0, 20.0, -25.0, 40.0, 120.0, 40.0, 135.0, 100.0, 121.0, 90.0, 150.0, 120.0, 90.0, 110.0, 110.0, 80.0, 30.0, 110.0, 50.0, 90.0, 180.0, 49.0, 80.0, 50.0, 90.0, 82.0, 230.0, 150.0, 190.0, 89.0, 66.0, 190.0, 48.0, 85.0, 87.0, 90.0, 95.0, 130.0, 90.0, 110.0, 130.0, 230.0, 210.0, 100.0, 110.0, 180.0, 70.0, 110.0, 120.0, 70.0, 170.0, 110.0, 30.0, 55.0, 130.0, 190.0, 180.0, 70.0, 65.0, 160.0, 120.0, 89.0, 200.0, 100.0, 75.0, 15.0, 100.0, 130.0, 90.0, 70.0, 50.0, 10.0, 90.0, 75.0, 0.0, 50.0, 30.0, 130.0, 180.0, 70.0, 70.0, 130.0, 230.0, 30.0, 120.0, 80.0, 90.0, 160.0, 170.0, 124.0, 80.0, 85.0, 60.0, 91.0, 80.0, 60.0, 119.0, 100.0, 170.0, 70.0, 90.0, 170.0, 130.0, 45.0, 50.0, 180.0, 59.0, 119.0, 80.0, 65.0, 60.0, 80.0, 13.0, 10.0, 90.0, 80.0, 43.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.686373072375889, "mean_inference_ms": 1.6865090642816714, "mean_action_processing_ms": 0.5121574296361523, "mean_env_wait_ms": 1.152302362761616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011693716049194336, "StateBufferConnector_ms": 0.0085296630859375, "ViewRequirementAgentConnector_ms": 0.40729737281799316}, "num_episodes": 22, "episode_return_max": 1479.0, "episode_return_min": 547.0, "episode_return_mean": 996.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.729042952865786, "num_env_steps_trained_throughput_per_sec": 20.729042952865786, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 4320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4320000, "timers": {"training_iteration_time_ms": 193775.384, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193775.325, "sample_time_ms": 2495.468, "learn_time_ms": 191258.788, "learn_throughput": 20.914, "synch_weights_time_ms": 11.754}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "done": false, "training_iteration": 108, "trial_id": "1841f_00000", "date": "2024-08-08_05-31-26", "timestamp": 1723109486, "time_this_iter_s": 192.97676992416382, "time_total_s": 22270.010991096497, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b562ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22270.010991096497, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 17.195604395604395, "ram_util_percent": 76.52893772893773}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.628344929516633, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.394857711355272, "policy_loss": -0.015107255398729248, "vf_loss": 8.40834792805429, "vf_explained_var": -0.001788038097885343, "kl": 0.008085218832532062, "entropy": 0.5261301798561511, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1018815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "env_runners": {"episode_reward_max": 1479.0, "episode_reward_min": 547.0, "episode_reward_mean": 978.36, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -43.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 97.836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1010.0, 885.0, 1082.0, 647.0, 670.0, 861.0, 932.0, 870.0, 1080.0, 1225.0, 945.0, 1049.0, 1479.0, 683.0, 1057.0, 1140.0, 853.0, 1100.0, 1128.0, 799.0, 1100.0, 1120.0, 980.0, 857.0, 842.0, 1206.0, 875.0, 968.0, 547.0, 1259.0, 1198.0, 1030.0, 1115.0, 1010.0, 835.0, 1014.0, 1048.0, 643.0, 694.0, 1405.0, 583.0, 781.0, 1094.0, 1116.0, 885.0, 1200.0, 1437.0, 1013.0, 962.0, 580.0, 1073.0, 826.0, 942.0, 935.0, 786.0, 1020.0, 830.0, 1362.0, 844.0, 885.0, 1090.0, 902.0, 860.0, 1090.0, 1014.0, 964.0, 1320.0, 945.0, 994.0, 1141.0, 660.0, 1011.0, 1051.0, 1070.0, 1340.0, 1125.0, 1054.0, 595.0, 1160.0, 969.0, 1083.0, 571.0, 680.0, 1070.0, 840.0, 1150.0, 960.0, 1089.0, 1220.0, 770.0, 1002.0, 1049.0, 1235.0, 1060.0, 705.0, 1060.0, 900.0, 1119.0, 921.0, 602.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [68.0, 58.0, 80.0, 90.0, 46.0, 180.0, 110.0, 58.0, 130.0, 190.0, 150.0, 100.0, 100.0, 110.0, 90.0, 30.0, 70.0, 120.0, 35.0, 80.0, 166.0, 100.0, 90.0, 148.0, 100.0, 70.0, 120.0, 18.0, 160.0, 110.0, 68.0, 150.0, 85.0, 60.0, 60.0, 60.0, 20.0, -31.0, 9.0, 166.0, 90.0, 80.0, 60.0, 60.0, 40.0, 100.0, 80.0, 110.0, 10.0, 40.0, 150.0, -14.0, 110.0, 57.0, 30.0, 110.0, 30.0, 100.0, 97.0, 191.0, 70.0, 186.0, 80.0, 100.0, 31.0, 20.0, 130.0, 150.0, 45.0, 120.0, 70.0, 70.0, 60.0, 50.0, 40.0, 50.0, 60.0, 140.0, 200.0, 130.0, 70.0, 80.0, 120.0, 160.0, 25.0, 90.0, 240.0, 75.0, 60.0, 160.0, 60.0, 140.0, 60.0, 60.0, 200.0, 230.0, 180.0, 90.0, 150.0, 55.0, 100.0, 40.0, 79.0, 120.0, 120.0, 86.0, 100.0, 90.0, 90.0, 120.0, 25.0, 120.0, 210.0, 94.0, 110.0, 130.0, 80.0, 150.0, 70.0, 60.0, 90.0, 140.0, 125.0, 100.0, 140.0, 210.0, 200.0, 274.0, 141.0, 59.0, 150.0, 20.0, -20.0, 120.0, 80.0, 90.0, 70.0, 69.0, 34.0, 70.0, 140.0, 110.0, 70.0, 130.0, 55.0, 160.0, 101.0, 71.0, 130.0, 90.0, 190.0, 100.0, 140.0, 120.0, 70.0, 170.0, 80.0, 140.0, 80.0, 50.0, 44.0, 69.0, 115.0, 100.0, 90.0, 141.0, 6.0, 110.0, 90.0, 88.0, 20.0, 70.0, 140.0, 140.0, 200.0, 100.0, 110.0, 160.0, 100.0, 60.0, 78.0, 90.0, 40.0, 100.0, 170.0, 150.0, 60.0, 210.0, 180.0, 50.0, 70.0, 69.0, 60.0, 105.0, 75.0, 90.0, 60.0, 100.0, 90.0, 80.0, 150.0, 70.0, 110.0, 40.0, 100.0, 220.0, 160.0, 80.0, 70.0, 100.0, 80.0, 160.0, 140.0, 120.0, 90.0, 60.0, 90.0, 150.0, 110.0, 120.0, 130.0, 33.0, 105.0, 120.0, 140.0, 37.0, 60.0, 110.0, 175.0, 70.0, 120.0, 50.0, 90.0, 120.0, 80.0, 48.0, 50.0, 90.0, 130.0, 79.0, 0.0, 110.0, 130.0, 78.0, 160.0, -35.0, 80.0, 99.0, 110.0, 110.0, 170.0, 70.0, 80.0, 64.0, 22.0, 200.0, 200.0, 100.0, 150.0, 150.0, 60.0, 190.0, 90.0, 110.0, 20.0, -15.0, 110.0, 80.0, 150.0, 80.0, 110.0, 70.0, 160.0, 40.0, 40.0, 100.0, 80.0, 180.0, 100.0, 88.0, 90.0, 15.0, -4.0, 120.0, 30.0, 40.0, 60.0, 140.0, 17.0, 39.0, 230.0, 100.0, 140.0, 90.0, 140.0, 160.0, 110.0, 150.0, 50.0, 89.0, 60.0, 79.0, 120.0, 40.0, 160.0, 120.0, 119.0, 140.0, 180.0, 180.0, 80.0, 130.0, 170.0, 40.0, 170.0, 110.0, 90.0, 60.0, 80.0, 100.0, 80.0, 150.0, 90.0, 65.0, 130.0, 110.0, 90.0, 70.0, 210.0, 120.0, 200.0, 120.0, 60.0, 240.0, -10.0, 70.0, 50.0, 80.0, 30.0, 170.0, 95.0, 90.0, 35.0, -5.0, 80.0, 70.0, 50.0, 160.0, 160.0, 100.0, 110.0, 39.0, 50.0, 180.0, 170.0, 90.0, 170.0, 160.0, 45.0, 0.0, 180.0, 110.0, 50.0, 230.0, 130.0, 89.0, 90.0, 29.0, 70.0, 70.0, 120.0, 54.0, 43.0, 150.0, 60.0, 60.0, 23.0, 23.0, 20.0, 90.0, 70.0, 80.0, 180.0, 38.0, 88.0, 36.0, 57.0, 80.0, 25.0, 40.0, 135.0, 90.0, 70.0, 130.0, 160.0, 240.0, 140.0, 130.0, 120.0, 190.0, 100.0, 40.0, 31.0, 126.0, -43.0, 43.0, 60.0, 71.0, 110.0, 45.0, 170.0, 230.0, 140.0, 3.0, 29.0, 50.0, 30.0, 100.0, -31.0, 60.0, 90.0, 80.0, 170.0, 120.0, 40.0, 240.0, 127.0, 57.0, 60.0, 110.0, 120.0, 115.0, 129.0, 49.0, 70.0, 120.0, 163.0, 80.0, 180.0, 90.0, 80.0, 220.0, 130.0, 70.0, 60.0, 50.0, 110.0, 50.0, 90.0, 25.0, 90.0, 100.0, 110.0, 110.0, 180.0, 120.0, 110.0, 110.0, 170.0, 100.0, 80.0, 100.0, 100.0, 127.0, 130.0, 120.0, 150.0, 300.0, 180.0, 150.0, 73.0, 120.0, 70.0, 110.0, 170.0, 110.0, 110.0, 160.0, 60.0, 30.0, 159.0, 60.0, 70.0, 90.0, 30.0, 130.0, 120.0, 70.0, 180.0, 53.0, 30.0, 80.0, 40.0, 10.0, 20.0, 200.0, 70.0, 80.0, 40.0, 10.0, 31.0, 60.0, 160.0, 140.0, 200.0, 140.0, 72.0, 100.0, 0.0, 170.0, 70.0, 150.0, 80.0, 60.0, 56.0, 30.0, 98.0, 83.0, 120.0, 79.0, 159.0, 68.0, 75.0, 50.0, 5.0, 110.0, 190.0, 65.0, 90.0, 130.0, 160.0, 110.0, 50.0, 58.0, 27.0, 190.0, 120.0, 40.0, 80.0, 100.0, 120.0, 100.0, 110.0, 70.0, 69.0, 50.0, 7.0, 70.0, 80.0, 110.0, 110.0, 90.0, 70.0, 80.0, 90.0, 100.0, 160.0, 100.0, 130.0, 90.0, 50.0, 130.0, 140.0, 170.0, 30.0, 120.0, 20.0, 60.0, 30.0, 80.0, 80.0, 260.0, 31.0, 180.0, 110.0, 140.0, 60.0, 231.0, 160.0, 110.0, 140.0, 75.0, 110.0, 40.0, 118.0, 80.0, 80.0, 60.0, 46.0, 95.0, 70.0, 110.0, 80.0, 30.0, 90.0, 49.0, 240.0, 70.0, 36.0, 110.0, 40.0, 110.0, 90.0, 30.0, 50.0, 220.0, 120.0, 200.0, 150.0, 80.0, 110.0, 70.0, 190.0, 95.0, 70.0, 60.0, 60.0, 27.0, 110.0, 110.0, 60.0, 20.0, 80.0, 170.0, 60.0, 40.0, 200.0, 80.0, 90.0, 60.0, 50.0, 80.0, 130.0, 100.0, 70.0, 100.0, 190.0, 190.0, 110.0, 70.0, 90.0, 220.0, 120.0, 120.0, 90.0, 50.0, 30.0, 114.0, 50.0, 130.0, 160.0, 179.0, 70.0, 23.0, 110.0, 90.0, 110.0, 133.0, 9.0, 80.0, -20.0, 120.0, 100.0, 190.0, 60.0, 200.0, 160.0, 170.0, 110.0, 230.0, 60.0, 90.0, 50.0, 80.0, 75.0, 230.0, 80.0, 80.0, 140.0, 60.0, 130.0, 110.0, 130.0, 106.0, 110.0, 80.0, 70.0, 140.0, 58.0, 60.0, 120.0, 120.0, 130.0, 120.0, 150.0, 263.0, 20.0, 90.0, 18.0, 110.0, 110.0, 50.0, 70.0, 20.0, -25.0, 40.0, 120.0, 40.0, 135.0, 100.0, 121.0, 90.0, 150.0, 120.0, 90.0, 110.0, 110.0, 80.0, 30.0, 110.0, 50.0, 90.0, 180.0, 49.0, 80.0, 50.0, 90.0, 82.0, 230.0, 150.0, 190.0, 89.0, 66.0, 190.0, 48.0, 85.0, 87.0, 90.0, 95.0, 130.0, 90.0, 110.0, 130.0, 230.0, 210.0, 100.0, 110.0, 180.0, 70.0, 110.0, 120.0, 70.0, 170.0, 110.0, 30.0, 55.0, 130.0, 190.0, 180.0, 70.0, 65.0, 160.0, 120.0, 89.0, 200.0, 100.0, 75.0, 15.0, 100.0, 130.0, 90.0, 70.0, 50.0, 10.0, 90.0, 75.0, 0.0, 50.0, 30.0, 130.0, 180.0, 70.0, 70.0, 130.0, 230.0, 30.0, 120.0, 80.0, 90.0, 160.0, 170.0, 124.0, 80.0, 85.0, 60.0, 91.0, 80.0, 60.0, 119.0, 100.0, 170.0, 70.0, 90.0, 170.0, 130.0, 45.0, 50.0, 180.0, 59.0, 119.0, 80.0, 65.0, 60.0, 80.0, 13.0, 10.0, 90.0, 80.0, 43.0, 50.0, 75.0, 10.0, 50.0, 20.0, 70.0, 200.0, 70.0, 100.0, 50.0, 35.0, 80.0, 190.0, 40.0, 90.0, 100.0, 60.0, 120.0, 130.0, 180.0, 80.0, 140.0, 100.0, 80.0, 100.0, 100.0, 80.0, 60.0, 40.0, 80.0, 60.0, 100.0, 60.0, 120.0, 50.0, 150.0, 180.0, 90.0, 150.0, 120.0, 130.0, 50.0, 150.0, 100.0, 50.0, 80.0, 70.0, 120.0, 190.0, 60.0, 90.0, 168.0, 37.0, 60.0, 150.0, 70.0, 158.0, 80.0, 70.0, 150.0, 146.0, 120.0, 180.0, 130.0, 90.0, 150.0, 100.0, 90.0, 120.0, 130.0, 110.0, 50.0, 40.0, 30.0, 40.0, 80.0, 230.0, 110.0, 40.0, 110.0, 40.0, 130.0, 120.0, 90.0, 120.0, 110.0, 100.0, 130.0, 21.0, 51.0, 130.0, 100.0, 70.0, 90.0, 140.0, 55.0, 44.0, 140.0, 120.0, 170.0, 120.0, 90.0, 90.0, 175.0, 60.0, 150.0, 180.0, 110.0, 240.0, 50.0, 90.0, 50.0, 80.0, 90.0, 50.0, 90.0, 50.0, 60.0, 260.0, 200.0, 130.0, 50.0, 210.0, 99.0, 110.0, 40.0, 100.0, 50.0, -11.0, 20.0, 37.0, 100.0, 80.0, 120.0, 180.0, 60.0, 70.0, 180.0, 70.0, 110.0, 90.0, 120.0, 20.0, 100.0, 70.0, 140.0, 120.0, 150.0, 70.0, 60.0, 50.0, 120.0, 130.0, 50.0, 110.0, 100.0, 100.0, 130.0, 160.0, 30.0, 189.0, 30.0, 20.0, 200.0, 55.0, 40.0, 70.0, 80.0, 50.0, 76.0, 300.0, 20.0, 60.0, 50.0, 50.0, 17.0, 80.0, 126.0, 48.0, 60.0, 91.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.683376254806978, "mean_inference_ms": 1.6838367950631505, "mean_action_processing_ms": 0.5119919084803661, "mean_env_wait_ms": 1.150910577222331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020402193069458008, "StateBufferConnector_ms": 0.008499383926391602, "ViewRequirementAgentConnector_ms": 0.39287519454956055}, "num_episodes": 18, "episode_return_max": 1479.0, "episode_return_min": 547.0, "episode_return_mean": 978.36}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.752685268520544, "num_env_steps_trained_throughput_per_sec": 20.752685268520544, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 4360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4360000, "timers": {"training_iteration_time_ms": 193635.111, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193635.054, "sample_time_ms": 2499.043, "learn_time_ms": 191114.89, "learn_throughput": 20.93, "synch_weights_time_ms": 11.805}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "done": false, "training_iteration": 109, "trial_id": "1841f_00000", "date": "2024-08-08_05-34-39", "timestamp": 1723109679, "time_this_iter_s": 192.75809168815613, "time_total_s": 22462.769082784653, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33aba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22462.769082784653, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 17.223161764705882, "ram_util_percent": 76.46801470588234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.763797295918734, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.617976947638173, "policy_loss": -0.01493299212993576, "vf_loss": 8.631351573982686, "vf_explained_var": -0.007299037184070347, "kl": 0.0077918380843663695, "entropy": 0.5306764607072765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1028205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "env_runners": {"episode_reward_max": 1437.0, "episode_reward_min": 470.0, "episode_reward_mean": 970.84, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 97.084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1128.0, 799.0, 1100.0, 1120.0, 980.0, 857.0, 842.0, 1206.0, 875.0, 968.0, 547.0, 1259.0, 1198.0, 1030.0, 1115.0, 1010.0, 835.0, 1014.0, 1048.0, 643.0, 694.0, 1405.0, 583.0, 781.0, 1094.0, 1116.0, 885.0, 1200.0, 1437.0, 1013.0, 962.0, 580.0, 1073.0, 826.0, 942.0, 935.0, 786.0, 1020.0, 830.0, 1362.0, 844.0, 885.0, 1090.0, 902.0, 860.0, 1090.0, 1014.0, 964.0, 1320.0, 945.0, 994.0, 1141.0, 660.0, 1011.0, 1051.0, 1070.0, 1340.0, 1125.0, 1054.0, 595.0, 1160.0, 969.0, 1083.0, 571.0, 680.0, 1070.0, 840.0, 1150.0, 960.0, 1089.0, 1220.0, 770.0, 1002.0, 1049.0, 1235.0, 1060.0, 705.0, 1060.0, 900.0, 1119.0, 921.0, 602.0, 1095.0, 1045.0, 523.0, 1359.0, 1045.0, 925.0, 470.0, 1146.0, 1170.0, 940.0, 884.0, 1015.0, 636.0, 853.0, 1030.0, 689.0, 1145.0, 846.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [78.0, 90.0, 40.0, 100.0, 170.0, 150.0, 60.0, 210.0, 180.0, 50.0, 70.0, 69.0, 60.0, 105.0, 75.0, 90.0, 60.0, 100.0, 90.0, 80.0, 150.0, 70.0, 110.0, 40.0, 100.0, 220.0, 160.0, 80.0, 70.0, 100.0, 80.0, 160.0, 140.0, 120.0, 90.0, 60.0, 90.0, 150.0, 110.0, 120.0, 130.0, 33.0, 105.0, 120.0, 140.0, 37.0, 60.0, 110.0, 175.0, 70.0, 120.0, 50.0, 90.0, 120.0, 80.0, 48.0, 50.0, 90.0, 130.0, 79.0, 0.0, 110.0, 130.0, 78.0, 160.0, -35.0, 80.0, 99.0, 110.0, 110.0, 170.0, 70.0, 80.0, 64.0, 22.0, 200.0, 200.0, 100.0, 150.0, 150.0, 60.0, 190.0, 90.0, 110.0, 20.0, -15.0, 110.0, 80.0, 150.0, 80.0, 110.0, 70.0, 160.0, 40.0, 40.0, 100.0, 80.0, 180.0, 100.0, 88.0, 90.0, 15.0, -4.0, 120.0, 30.0, 40.0, 60.0, 140.0, 17.0, 39.0, 230.0, 100.0, 140.0, 90.0, 140.0, 160.0, 110.0, 150.0, 50.0, 89.0, 60.0, 79.0, 120.0, 40.0, 160.0, 120.0, 119.0, 140.0, 180.0, 180.0, 80.0, 130.0, 170.0, 40.0, 170.0, 110.0, 90.0, 60.0, 80.0, 100.0, 80.0, 150.0, 90.0, 65.0, 130.0, 110.0, 90.0, 70.0, 210.0, 120.0, 200.0, 120.0, 60.0, 240.0, -10.0, 70.0, 50.0, 80.0, 30.0, 170.0, 95.0, 90.0, 35.0, -5.0, 80.0, 70.0, 50.0, 160.0, 160.0, 100.0, 110.0, 39.0, 50.0, 180.0, 170.0, 90.0, 170.0, 160.0, 45.0, 0.0, 180.0, 110.0, 50.0, 230.0, 130.0, 89.0, 90.0, 29.0, 70.0, 70.0, 120.0, 54.0, 43.0, 150.0, 60.0, 60.0, 23.0, 23.0, 20.0, 90.0, 70.0, 80.0, 180.0, 38.0, 88.0, 36.0, 57.0, 80.0, 25.0, 40.0, 135.0, 90.0, 70.0, 130.0, 160.0, 240.0, 140.0, 130.0, 120.0, 190.0, 100.0, 40.0, 31.0, 126.0, -43.0, 43.0, 60.0, 71.0, 110.0, 45.0, 170.0, 230.0, 140.0, 3.0, 29.0, 50.0, 30.0, 100.0, -31.0, 60.0, 90.0, 80.0, 170.0, 120.0, 40.0, 240.0, 127.0, 57.0, 60.0, 110.0, 120.0, 115.0, 129.0, 49.0, 70.0, 120.0, 163.0, 80.0, 180.0, 90.0, 80.0, 220.0, 130.0, 70.0, 60.0, 50.0, 110.0, 50.0, 90.0, 25.0, 90.0, 100.0, 110.0, 110.0, 180.0, 120.0, 110.0, 110.0, 170.0, 100.0, 80.0, 100.0, 100.0, 127.0, 130.0, 120.0, 150.0, 300.0, 180.0, 150.0, 73.0, 120.0, 70.0, 110.0, 170.0, 110.0, 110.0, 160.0, 60.0, 30.0, 159.0, 60.0, 70.0, 90.0, 30.0, 130.0, 120.0, 70.0, 180.0, 53.0, 30.0, 80.0, 40.0, 10.0, 20.0, 200.0, 70.0, 80.0, 40.0, 10.0, 31.0, 60.0, 160.0, 140.0, 200.0, 140.0, 72.0, 100.0, 0.0, 170.0, 70.0, 150.0, 80.0, 60.0, 56.0, 30.0, 98.0, 83.0, 120.0, 79.0, 159.0, 68.0, 75.0, 50.0, 5.0, 110.0, 190.0, 65.0, 90.0, 130.0, 160.0, 110.0, 50.0, 58.0, 27.0, 190.0, 120.0, 40.0, 80.0, 100.0, 120.0, 100.0, 110.0, 70.0, 69.0, 50.0, 7.0, 70.0, 80.0, 110.0, 110.0, 90.0, 70.0, 80.0, 90.0, 100.0, 160.0, 100.0, 130.0, 90.0, 50.0, 130.0, 140.0, 170.0, 30.0, 120.0, 20.0, 60.0, 30.0, 80.0, 80.0, 260.0, 31.0, 180.0, 110.0, 140.0, 60.0, 231.0, 160.0, 110.0, 140.0, 75.0, 110.0, 40.0, 118.0, 80.0, 80.0, 60.0, 46.0, 95.0, 70.0, 110.0, 80.0, 30.0, 90.0, 49.0, 240.0, 70.0, 36.0, 110.0, 40.0, 110.0, 90.0, 30.0, 50.0, 220.0, 120.0, 200.0, 150.0, 80.0, 110.0, 70.0, 190.0, 95.0, 70.0, 60.0, 60.0, 27.0, 110.0, 110.0, 60.0, 20.0, 80.0, 170.0, 60.0, 40.0, 200.0, 80.0, 90.0, 60.0, 50.0, 80.0, 130.0, 100.0, 70.0, 100.0, 190.0, 190.0, 110.0, 70.0, 90.0, 220.0, 120.0, 120.0, 90.0, 50.0, 30.0, 114.0, 50.0, 130.0, 160.0, 179.0, 70.0, 23.0, 110.0, 90.0, 110.0, 133.0, 9.0, 80.0, -20.0, 120.0, 100.0, 190.0, 60.0, 200.0, 160.0, 170.0, 110.0, 230.0, 60.0, 90.0, 50.0, 80.0, 75.0, 230.0, 80.0, 80.0, 140.0, 60.0, 130.0, 110.0, 130.0, 106.0, 110.0, 80.0, 70.0, 140.0, 58.0, 60.0, 120.0, 120.0, 130.0, 120.0, 150.0, 263.0, 20.0, 90.0, 18.0, 110.0, 110.0, 50.0, 70.0, 20.0, -25.0, 40.0, 120.0, 40.0, 135.0, 100.0, 121.0, 90.0, 150.0, 120.0, 90.0, 110.0, 110.0, 80.0, 30.0, 110.0, 50.0, 90.0, 180.0, 49.0, 80.0, 50.0, 90.0, 82.0, 230.0, 150.0, 190.0, 89.0, 66.0, 190.0, 48.0, 85.0, 87.0, 90.0, 95.0, 130.0, 90.0, 110.0, 130.0, 230.0, 210.0, 100.0, 110.0, 180.0, 70.0, 110.0, 120.0, 70.0, 170.0, 110.0, 30.0, 55.0, 130.0, 190.0, 180.0, 70.0, 65.0, 160.0, 120.0, 89.0, 200.0, 100.0, 75.0, 15.0, 100.0, 130.0, 90.0, 70.0, 50.0, 10.0, 90.0, 75.0, 0.0, 50.0, 30.0, 130.0, 180.0, 70.0, 70.0, 130.0, 230.0, 30.0, 120.0, 80.0, 90.0, 160.0, 170.0, 124.0, 80.0, 85.0, 60.0, 91.0, 80.0, 60.0, 119.0, 100.0, 170.0, 70.0, 90.0, 170.0, 130.0, 45.0, 50.0, 180.0, 59.0, 119.0, 80.0, 65.0, 60.0, 80.0, 13.0, 10.0, 90.0, 80.0, 43.0, 50.0, 75.0, 10.0, 50.0, 20.0, 70.0, 200.0, 70.0, 100.0, 50.0, 35.0, 80.0, 190.0, 40.0, 90.0, 100.0, 60.0, 120.0, 130.0, 180.0, 80.0, 140.0, 100.0, 80.0, 100.0, 100.0, 80.0, 60.0, 40.0, 80.0, 60.0, 100.0, 60.0, 120.0, 50.0, 150.0, 180.0, 90.0, 150.0, 120.0, 130.0, 50.0, 150.0, 100.0, 50.0, 80.0, 70.0, 120.0, 190.0, 60.0, 90.0, 168.0, 37.0, 60.0, 150.0, 70.0, 158.0, 80.0, 70.0, 150.0, 146.0, 120.0, 180.0, 130.0, 90.0, 150.0, 100.0, 90.0, 120.0, 130.0, 110.0, 50.0, 40.0, 30.0, 40.0, 80.0, 230.0, 110.0, 40.0, 110.0, 40.0, 130.0, 120.0, 90.0, 120.0, 110.0, 100.0, 130.0, 21.0, 51.0, 130.0, 100.0, 70.0, 90.0, 140.0, 55.0, 44.0, 140.0, 120.0, 170.0, 120.0, 90.0, 90.0, 175.0, 60.0, 150.0, 180.0, 110.0, 240.0, 50.0, 90.0, 50.0, 80.0, 90.0, 50.0, 90.0, 50.0, 60.0, 260.0, 200.0, 130.0, 50.0, 210.0, 99.0, 110.0, 40.0, 100.0, 50.0, -11.0, 20.0, 37.0, 100.0, 80.0, 120.0, 180.0, 60.0, 70.0, 180.0, 70.0, 110.0, 90.0, 120.0, 20.0, 100.0, 70.0, 140.0, 120.0, 150.0, 70.0, 60.0, 50.0, 120.0, 130.0, 50.0, 110.0, 100.0, 100.0, 130.0, 160.0, 30.0, 189.0, 30.0, 20.0, 200.0, 55.0, 40.0, 70.0, 80.0, 50.0, 76.0, 300.0, 20.0, 60.0, 50.0, 50.0, 17.0, 80.0, 126.0, 48.0, 60.0, 91.0, 200.0, 50.0, 55.0, 120.0, 170.0, 50.0, 110.0, 110.0, 80.0, 150.0, 45.0, 70.0, 110.0, 140.0, 140.0, 100.0, 100.0, 90.0, 220.0, 30.0, 62.0, 40.0, 90.0, 85.0, 60.0, -11.0, 60.0, 60.0, 18.0, 59.0, 150.0, 130.0, 170.0, 170.0, 130.0, 130.0, 150.0, 170.0, 59.0, 100.0, 90.0, 120.0, 127.0, 130.0, -12.0, 40.0, 90.0, 200.0, 100.0, 160.0, 120.0, 120.0, 100.0, 50.0, 5.0, 130.0, 100.0, 100.0, 90.0, 110.0, 84.0, 20.0, 30.0, 95.0, 30.0, 80.0, 20.0, 73.0, 34.0, 4.0, 80.0, 220.0, 28.0, 70.0, 100.0, 80.0, 130.0, 150.0, 150.0, 138.0, 130.0, 110.0, 80.0, 110.0, 110.0, 120.0, 170.0, 70.0, 150.0, 120.0, 130.0, 90.0, 200.0, 190.0, 50.0, 80.0, 70.0, 30.0, 50.0, 50.0, 40.0, 60.0, 25.0, 149.0, 260.0, 80.0, 80.0, 110.0, 50.0, 30.0, 150.0, 95.0, 20.0, 50.0, 70.0, 130.0, 190.0, 100.0, 130.0, 80.0, 43.0, -85.0, 90.0, 31.0, 160.0, 73.0, 110.0, 107.0, 37.0, 70.0, 100.0, 85.0, 18.0, 130.0, 80.0, 60.0, 100.0, 130.0, 110.0, 40.0, 70.0, 100.0, 50.0, 100.0, 160.0, 90.0, 120.0, 120.0, 100.0, 120.0, 50.0, 160.0, 130.0, 14.0, 30.0, 70.0, 120.0, 50.0, 25.0, 40.0, 45.0, 150.0, 160.0, 50.0, 220.0, 170.0, 60.0, 100.0, 110.0, 80.0, 77.0, 65.0, 200.0, 40.0, 140.0, 30.0, 120.0, 25.0, 99.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.680486913496843, "mean_inference_ms": 1.6811898702992516, "mean_action_processing_ms": 0.5113266946623558, "mean_env_wait_ms": 1.1495035859066118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02041029930114746, "StateBufferConnector_ms": 0.00848698616027832, "ViewRequirementAgentConnector_ms": 0.3939352035522461}, "num_episodes": 18, "episode_return_max": 1437.0, "episode_return_min": 470.0, "episode_return_mean": 970.84}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.7080724714897, "num_env_steps_trained_throughput_per_sec": 20.7080724714897, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 4400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4400000, "timers": {"training_iteration_time_ms": 193582.238, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193582.182, "sample_time_ms": 2489.386, "learn_time_ms": 191071.732, "learn_throughput": 20.935, "synch_weights_time_ms": 11.834}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "done": false, "training_iteration": 110, "trial_id": "1841f_00000", "date": "2024-08-08_05-37-52", "timestamp": 1723109872, "time_this_iter_s": 193.17071413993835, "time_total_s": 22655.93979692459, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2450040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22655.93979692459, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 17.256410256410255, "ram_util_percent": 75.86556776556777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6005475093381474, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.626062522680996, "policy_loss": -0.014284119710744744, "vf_loss": 8.638867556883758, "vf_explained_var": -0.003264495130545034, "kl": 0.00739543825951977, "entropy": 0.5109934516163807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1037595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "env_runners": {"episode_reward_max": 1437.0, "episode_reward_min": 437.0, "episode_reward_mean": 971.74, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 97.174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [781.0, 1094.0, 1116.0, 885.0, 1200.0, 1437.0, 1013.0, 962.0, 580.0, 1073.0, 826.0, 942.0, 935.0, 786.0, 1020.0, 830.0, 1362.0, 844.0, 885.0, 1090.0, 902.0, 860.0, 1090.0, 1014.0, 964.0, 1320.0, 945.0, 994.0, 1141.0, 660.0, 1011.0, 1051.0, 1070.0, 1340.0, 1125.0, 1054.0, 595.0, 1160.0, 969.0, 1083.0, 571.0, 680.0, 1070.0, 840.0, 1150.0, 960.0, 1089.0, 1220.0, 770.0, 1002.0, 1049.0, 1235.0, 1060.0, 705.0, 1060.0, 900.0, 1119.0, 921.0, 602.0, 1095.0, 1045.0, 523.0, 1359.0, 1045.0, 925.0, 470.0, 1146.0, 1170.0, 940.0, 884.0, 1015.0, 636.0, 853.0, 1030.0, 689.0, 1145.0, 846.0, 829.0, 968.0, 1192.0, 1332.0, 1260.0, 903.0, 1208.0, 919.0, 1065.0, 782.0, 941.0, 1182.0, 1140.0, 952.0, 830.0, 437.0, 601.0, 905.0, 968.0, 1143.0, 1075.0, 859.0, 855.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 230.0, 140.0, 3.0, 29.0, 50.0, 30.0, 100.0, -31.0, 60.0, 90.0, 80.0, 170.0, 120.0, 40.0, 240.0, 127.0, 57.0, 60.0, 110.0, 120.0, 115.0, 129.0, 49.0, 70.0, 120.0, 163.0, 80.0, 180.0, 90.0, 80.0, 220.0, 130.0, 70.0, 60.0, 50.0, 110.0, 50.0, 90.0, 25.0, 90.0, 100.0, 110.0, 110.0, 180.0, 120.0, 110.0, 110.0, 170.0, 100.0, 80.0, 100.0, 100.0, 127.0, 130.0, 120.0, 150.0, 300.0, 180.0, 150.0, 73.0, 120.0, 70.0, 110.0, 170.0, 110.0, 110.0, 160.0, 60.0, 30.0, 159.0, 60.0, 70.0, 90.0, 30.0, 130.0, 120.0, 70.0, 180.0, 53.0, 30.0, 80.0, 40.0, 10.0, 20.0, 200.0, 70.0, 80.0, 40.0, 10.0, 31.0, 60.0, 160.0, 140.0, 200.0, 140.0, 72.0, 100.0, 0.0, 170.0, 70.0, 150.0, 80.0, 60.0, 56.0, 30.0, 98.0, 83.0, 120.0, 79.0, 159.0, 68.0, 75.0, 50.0, 5.0, 110.0, 190.0, 65.0, 90.0, 130.0, 160.0, 110.0, 50.0, 58.0, 27.0, 190.0, 120.0, 40.0, 80.0, 100.0, 120.0, 100.0, 110.0, 70.0, 69.0, 50.0, 7.0, 70.0, 80.0, 110.0, 110.0, 90.0, 70.0, 80.0, 90.0, 100.0, 160.0, 100.0, 130.0, 90.0, 50.0, 130.0, 140.0, 170.0, 30.0, 120.0, 20.0, 60.0, 30.0, 80.0, 80.0, 260.0, 31.0, 180.0, 110.0, 140.0, 60.0, 231.0, 160.0, 110.0, 140.0, 75.0, 110.0, 40.0, 118.0, 80.0, 80.0, 60.0, 46.0, 95.0, 70.0, 110.0, 80.0, 30.0, 90.0, 49.0, 240.0, 70.0, 36.0, 110.0, 40.0, 110.0, 90.0, 30.0, 50.0, 220.0, 120.0, 200.0, 150.0, 80.0, 110.0, 70.0, 190.0, 95.0, 70.0, 60.0, 60.0, 27.0, 110.0, 110.0, 60.0, 20.0, 80.0, 170.0, 60.0, 40.0, 200.0, 80.0, 90.0, 60.0, 50.0, 80.0, 130.0, 100.0, 70.0, 100.0, 190.0, 190.0, 110.0, 70.0, 90.0, 220.0, 120.0, 120.0, 90.0, 50.0, 30.0, 114.0, 50.0, 130.0, 160.0, 179.0, 70.0, 23.0, 110.0, 90.0, 110.0, 133.0, 9.0, 80.0, -20.0, 120.0, 100.0, 190.0, 60.0, 200.0, 160.0, 170.0, 110.0, 230.0, 60.0, 90.0, 50.0, 80.0, 75.0, 230.0, 80.0, 80.0, 140.0, 60.0, 130.0, 110.0, 130.0, 106.0, 110.0, 80.0, 70.0, 140.0, 58.0, 60.0, 120.0, 120.0, 130.0, 120.0, 150.0, 263.0, 20.0, 90.0, 18.0, 110.0, 110.0, 50.0, 70.0, 20.0, -25.0, 40.0, 120.0, 40.0, 135.0, 100.0, 121.0, 90.0, 150.0, 120.0, 90.0, 110.0, 110.0, 80.0, 30.0, 110.0, 50.0, 90.0, 180.0, 49.0, 80.0, 50.0, 90.0, 82.0, 230.0, 150.0, 190.0, 89.0, 66.0, 190.0, 48.0, 85.0, 87.0, 90.0, 95.0, 130.0, 90.0, 110.0, 130.0, 230.0, 210.0, 100.0, 110.0, 180.0, 70.0, 110.0, 120.0, 70.0, 170.0, 110.0, 30.0, 55.0, 130.0, 190.0, 180.0, 70.0, 65.0, 160.0, 120.0, 89.0, 200.0, 100.0, 75.0, 15.0, 100.0, 130.0, 90.0, 70.0, 50.0, 10.0, 90.0, 75.0, 0.0, 50.0, 30.0, 130.0, 180.0, 70.0, 70.0, 130.0, 230.0, 30.0, 120.0, 80.0, 90.0, 160.0, 170.0, 124.0, 80.0, 85.0, 60.0, 91.0, 80.0, 60.0, 119.0, 100.0, 170.0, 70.0, 90.0, 170.0, 130.0, 45.0, 50.0, 180.0, 59.0, 119.0, 80.0, 65.0, 60.0, 80.0, 13.0, 10.0, 90.0, 80.0, 43.0, 50.0, 75.0, 10.0, 50.0, 20.0, 70.0, 200.0, 70.0, 100.0, 50.0, 35.0, 80.0, 190.0, 40.0, 90.0, 100.0, 60.0, 120.0, 130.0, 180.0, 80.0, 140.0, 100.0, 80.0, 100.0, 100.0, 80.0, 60.0, 40.0, 80.0, 60.0, 100.0, 60.0, 120.0, 50.0, 150.0, 180.0, 90.0, 150.0, 120.0, 130.0, 50.0, 150.0, 100.0, 50.0, 80.0, 70.0, 120.0, 190.0, 60.0, 90.0, 168.0, 37.0, 60.0, 150.0, 70.0, 158.0, 80.0, 70.0, 150.0, 146.0, 120.0, 180.0, 130.0, 90.0, 150.0, 100.0, 90.0, 120.0, 130.0, 110.0, 50.0, 40.0, 30.0, 40.0, 80.0, 230.0, 110.0, 40.0, 110.0, 40.0, 130.0, 120.0, 90.0, 120.0, 110.0, 100.0, 130.0, 21.0, 51.0, 130.0, 100.0, 70.0, 90.0, 140.0, 55.0, 44.0, 140.0, 120.0, 170.0, 120.0, 90.0, 90.0, 175.0, 60.0, 150.0, 180.0, 110.0, 240.0, 50.0, 90.0, 50.0, 80.0, 90.0, 50.0, 90.0, 50.0, 60.0, 260.0, 200.0, 130.0, 50.0, 210.0, 99.0, 110.0, 40.0, 100.0, 50.0, -11.0, 20.0, 37.0, 100.0, 80.0, 120.0, 180.0, 60.0, 70.0, 180.0, 70.0, 110.0, 90.0, 120.0, 20.0, 100.0, 70.0, 140.0, 120.0, 150.0, 70.0, 60.0, 50.0, 120.0, 130.0, 50.0, 110.0, 100.0, 100.0, 130.0, 160.0, 30.0, 189.0, 30.0, 20.0, 200.0, 55.0, 40.0, 70.0, 80.0, 50.0, 76.0, 300.0, 20.0, 60.0, 50.0, 50.0, 17.0, 80.0, 126.0, 48.0, 60.0, 91.0, 200.0, 50.0, 55.0, 120.0, 170.0, 50.0, 110.0, 110.0, 80.0, 150.0, 45.0, 70.0, 110.0, 140.0, 140.0, 100.0, 100.0, 90.0, 220.0, 30.0, 62.0, 40.0, 90.0, 85.0, 60.0, -11.0, 60.0, 60.0, 18.0, 59.0, 150.0, 130.0, 170.0, 170.0, 130.0, 130.0, 150.0, 170.0, 59.0, 100.0, 90.0, 120.0, 127.0, 130.0, -12.0, 40.0, 90.0, 200.0, 100.0, 160.0, 120.0, 120.0, 100.0, 50.0, 5.0, 130.0, 100.0, 100.0, 90.0, 110.0, 84.0, 20.0, 30.0, 95.0, 30.0, 80.0, 20.0, 73.0, 34.0, 4.0, 80.0, 220.0, 28.0, 70.0, 100.0, 80.0, 130.0, 150.0, 150.0, 138.0, 130.0, 110.0, 80.0, 110.0, 110.0, 120.0, 170.0, 70.0, 150.0, 120.0, 130.0, 90.0, 200.0, 190.0, 50.0, 80.0, 70.0, 30.0, 50.0, 50.0, 40.0, 60.0, 25.0, 149.0, 260.0, 80.0, 80.0, 110.0, 50.0, 30.0, 150.0, 95.0, 20.0, 50.0, 70.0, 130.0, 190.0, 100.0, 130.0, 80.0, 43.0, -85.0, 90.0, 31.0, 160.0, 73.0, 110.0, 107.0, 37.0, 70.0, 100.0, 85.0, 18.0, 130.0, 80.0, 60.0, 100.0, 130.0, 110.0, 40.0, 70.0, 100.0, 50.0, 100.0, 160.0, 90.0, 120.0, 120.0, 100.0, 120.0, 50.0, 160.0, 130.0, 14.0, 30.0, 70.0, 120.0, 50.0, 25.0, 40.0, 45.0, 150.0, 160.0, 50.0, 220.0, 170.0, 60.0, 100.0, 110.0, 80.0, 77.0, 65.0, 200.0, 40.0, 140.0, 30.0, 120.0, 25.0, 99.0, 50.0, 85.0, 90.0, 110.0, 70.0, 110.0, 120.0, 40.0, 50.0, 24.0, 130.0, 88.0, 90.0, 50.0, 100.0, 50.0, 70.0, 90.0, 140.0, 60.0, 230.0, 100.0, 100.0, 100.0, 80.0, 88.0, 146.0, 139.0, 210.0, 149.0, 80.0, 100.0, 34.0, 250.0, 140.0, 120.0, 190.0, 88.0, 160.0, 170.0, 80.0, 100.0, 80.0, 150.0, 80.0, 120.0, 110.0, 110.0, 300.0, 110.0, 100.0, 56.0, 47.0, 80.0, 90.0, 90.0, 130.0, 90.0, 110.0, 100.0, 110.0, 78.0, 120.0, 140.0, 80.0, 130.0, 170.0, 160.0, 70.0, 140.0, 120.0, 49.0, 180.0, 90.0, 100.0, 150.0, 80.0, 80.0, 40.0, 60.0, 90.0, 250.0, -40.0, 100.0, 55.0, 150.0, 170.0, 130.0, 60.0, 90.0, 100.0, 202.0, 50.0, 140.0, 29.0, 90.0, 18.0, 40.0, 50.0, 80.0, 83.0, 100.0, 121.0, 200.0, 87.0, 90.0, 23.0, 70.0, 90.0, 80.0, 80.0, 80.0, 67.0, 100.0, 200.0, 85.0, 140.0, 120.0, 110.0, 200.0, 80.0, 80.0, 70.0, 120.0, 70.0, 90.0, 150.0, 140.0, 40.0, 260.0, 120.0, 120.0, 100.0, 113.0, 109.0, 40.0, 80.0, -10.0, 250.0, 60.0, 90.0, 45.0, 50.0, 150.0, 59.0, 160.0, 70.0, 100.0, 6.0, 110.0, 80.0, 29.0, 20.0, -30.0, 58.0, 50.0, 140.0, 10.0, 60.0, 60.0, 40.0, 46.0, 48.0, 30.0, 75.0, 60.0, 60.0, 50.0, 141.0, 49.0, 42.0, 30.0, 120.0, -35.0, 130.0, 110.0, 70.0, 120.0, 180.0, 120.0, 60.0, 23.0, 110.0, 80.0, 50.0, 230.0, 50.0, 100.0, 160.0, 99.0, 66.0, 120.0, 170.0, 100.0, 130.0, 12.0, 180.0, 101.0, 70.0, 80.0, 180.0, 50.0, 90.0, 190.0, 110.0, 140.0, 190.0, 65.0, 130.0, 20.0, 90.0, 210.0, 50.0, 92.0, 70.0, 30.0, 90.0, 95.0, 120.0, 42.0, 60.0, 130.0, 165.0, 30.0, 20.0, 100.0, 50.0, 69.0, 11.0, 210.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6768214793949576, "mean_inference_ms": 1.677943267959239, "mean_action_processing_ms": 0.5105379056852467, "mean_env_wait_ms": 1.1477027865008478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020423173904418945, "StateBufferConnector_ms": 0.010357379913330078, "ViewRequirementAgentConnector_ms": 0.3851468563079834}, "num_episodes": 23, "episode_return_max": 1437.0, "episode_return_min": 437.0, "episode_return_mean": 971.74}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.68870901994323, "num_env_steps_trained_throughput_per_sec": 20.68870901994323, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 4440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4440000, "timers": {"training_iteration_time_ms": 193419.053, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193418.997, "sample_time_ms": 2497.925, "learn_time_ms": 190901.138, "learn_throughput": 20.953, "synch_weights_time_ms": 11.836}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "done": false, "training_iteration": 111, "trial_id": "1841f_00000", "date": "2024-08-08_05-41-05", "timestamp": 1723110065, "time_this_iter_s": 193.35246801376343, "time_total_s": 22849.292264938354, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33b18b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22849.292264938354, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 17.416788321167882, "ram_util_percent": 76.35766423357664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6966501511006564, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.370115248057536, "policy_loss": -0.014836906398898456, "vf_loss": 8.383423051488792, "vf_explained_var": -0.00772175297569543, "kl": 0.0076455221827850745, "entropy": 0.5405055474581175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1046985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "env_runners": {"episode_reward_max": 1370.0, "episode_reward_min": 437.0, "episode_reward_mean": 968.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 96.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [885.0, 1090.0, 902.0, 860.0, 1090.0, 1014.0, 964.0, 1320.0, 945.0, 994.0, 1141.0, 660.0, 1011.0, 1051.0, 1070.0, 1340.0, 1125.0, 1054.0, 595.0, 1160.0, 969.0, 1083.0, 571.0, 680.0, 1070.0, 840.0, 1150.0, 960.0, 1089.0, 1220.0, 770.0, 1002.0, 1049.0, 1235.0, 1060.0, 705.0, 1060.0, 900.0, 1119.0, 921.0, 602.0, 1095.0, 1045.0, 523.0, 1359.0, 1045.0, 925.0, 470.0, 1146.0, 1170.0, 940.0, 884.0, 1015.0, 636.0, 853.0, 1030.0, 689.0, 1145.0, 846.0, 829.0, 968.0, 1192.0, 1332.0, 1260.0, 903.0, 1208.0, 919.0, 1065.0, 782.0, 941.0, 1182.0, 1140.0, 952.0, 830.0, 437.0, 601.0, 905.0, 968.0, 1143.0, 1075.0, 859.0, 855.0, 1178.0, 1087.0, 1011.0, 919.0, 1158.0, 1043.0, 907.0, 780.0, 1370.0, 856.0, 939.0, 984.0, 781.0, 832.0, 535.0, 1070.0, 930.0, 957.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 110.0, 80.0, 30.0, 90.0, 49.0, 240.0, 70.0, 36.0, 110.0, 40.0, 110.0, 90.0, 30.0, 50.0, 220.0, 120.0, 200.0, 150.0, 80.0, 110.0, 70.0, 190.0, 95.0, 70.0, 60.0, 60.0, 27.0, 110.0, 110.0, 60.0, 20.0, 80.0, 170.0, 60.0, 40.0, 200.0, 80.0, 90.0, 60.0, 50.0, 80.0, 130.0, 100.0, 70.0, 100.0, 190.0, 190.0, 110.0, 70.0, 90.0, 220.0, 120.0, 120.0, 90.0, 50.0, 30.0, 114.0, 50.0, 130.0, 160.0, 179.0, 70.0, 23.0, 110.0, 90.0, 110.0, 133.0, 9.0, 80.0, -20.0, 120.0, 100.0, 190.0, 60.0, 200.0, 160.0, 170.0, 110.0, 230.0, 60.0, 90.0, 50.0, 80.0, 75.0, 230.0, 80.0, 80.0, 140.0, 60.0, 130.0, 110.0, 130.0, 106.0, 110.0, 80.0, 70.0, 140.0, 58.0, 60.0, 120.0, 120.0, 130.0, 120.0, 150.0, 263.0, 20.0, 90.0, 18.0, 110.0, 110.0, 50.0, 70.0, 20.0, -25.0, 40.0, 120.0, 40.0, 135.0, 100.0, 121.0, 90.0, 150.0, 120.0, 90.0, 110.0, 110.0, 80.0, 30.0, 110.0, 50.0, 90.0, 180.0, 49.0, 80.0, 50.0, 90.0, 82.0, 230.0, 150.0, 190.0, 89.0, 66.0, 190.0, 48.0, 85.0, 87.0, 90.0, 95.0, 130.0, 90.0, 110.0, 130.0, 230.0, 210.0, 100.0, 110.0, 180.0, 70.0, 110.0, 120.0, 70.0, 170.0, 110.0, 30.0, 55.0, 130.0, 190.0, 180.0, 70.0, 65.0, 160.0, 120.0, 89.0, 200.0, 100.0, 75.0, 15.0, 100.0, 130.0, 90.0, 70.0, 50.0, 10.0, 90.0, 75.0, 0.0, 50.0, 30.0, 130.0, 180.0, 70.0, 70.0, 130.0, 230.0, 30.0, 120.0, 80.0, 90.0, 160.0, 170.0, 124.0, 80.0, 85.0, 60.0, 91.0, 80.0, 60.0, 119.0, 100.0, 170.0, 70.0, 90.0, 170.0, 130.0, 45.0, 50.0, 180.0, 59.0, 119.0, 80.0, 65.0, 60.0, 80.0, 13.0, 10.0, 90.0, 80.0, 43.0, 50.0, 75.0, 10.0, 50.0, 20.0, 70.0, 200.0, 70.0, 100.0, 50.0, 35.0, 80.0, 190.0, 40.0, 90.0, 100.0, 60.0, 120.0, 130.0, 180.0, 80.0, 140.0, 100.0, 80.0, 100.0, 100.0, 80.0, 60.0, 40.0, 80.0, 60.0, 100.0, 60.0, 120.0, 50.0, 150.0, 180.0, 90.0, 150.0, 120.0, 130.0, 50.0, 150.0, 100.0, 50.0, 80.0, 70.0, 120.0, 190.0, 60.0, 90.0, 168.0, 37.0, 60.0, 150.0, 70.0, 158.0, 80.0, 70.0, 150.0, 146.0, 120.0, 180.0, 130.0, 90.0, 150.0, 100.0, 90.0, 120.0, 130.0, 110.0, 50.0, 40.0, 30.0, 40.0, 80.0, 230.0, 110.0, 40.0, 110.0, 40.0, 130.0, 120.0, 90.0, 120.0, 110.0, 100.0, 130.0, 21.0, 51.0, 130.0, 100.0, 70.0, 90.0, 140.0, 55.0, 44.0, 140.0, 120.0, 170.0, 120.0, 90.0, 90.0, 175.0, 60.0, 150.0, 180.0, 110.0, 240.0, 50.0, 90.0, 50.0, 80.0, 90.0, 50.0, 90.0, 50.0, 60.0, 260.0, 200.0, 130.0, 50.0, 210.0, 99.0, 110.0, 40.0, 100.0, 50.0, -11.0, 20.0, 37.0, 100.0, 80.0, 120.0, 180.0, 60.0, 70.0, 180.0, 70.0, 110.0, 90.0, 120.0, 20.0, 100.0, 70.0, 140.0, 120.0, 150.0, 70.0, 60.0, 50.0, 120.0, 130.0, 50.0, 110.0, 100.0, 100.0, 130.0, 160.0, 30.0, 189.0, 30.0, 20.0, 200.0, 55.0, 40.0, 70.0, 80.0, 50.0, 76.0, 300.0, 20.0, 60.0, 50.0, 50.0, 17.0, 80.0, 126.0, 48.0, 60.0, 91.0, 200.0, 50.0, 55.0, 120.0, 170.0, 50.0, 110.0, 110.0, 80.0, 150.0, 45.0, 70.0, 110.0, 140.0, 140.0, 100.0, 100.0, 90.0, 220.0, 30.0, 62.0, 40.0, 90.0, 85.0, 60.0, -11.0, 60.0, 60.0, 18.0, 59.0, 150.0, 130.0, 170.0, 170.0, 130.0, 130.0, 150.0, 170.0, 59.0, 100.0, 90.0, 120.0, 127.0, 130.0, -12.0, 40.0, 90.0, 200.0, 100.0, 160.0, 120.0, 120.0, 100.0, 50.0, 5.0, 130.0, 100.0, 100.0, 90.0, 110.0, 84.0, 20.0, 30.0, 95.0, 30.0, 80.0, 20.0, 73.0, 34.0, 4.0, 80.0, 220.0, 28.0, 70.0, 100.0, 80.0, 130.0, 150.0, 150.0, 138.0, 130.0, 110.0, 80.0, 110.0, 110.0, 120.0, 170.0, 70.0, 150.0, 120.0, 130.0, 90.0, 200.0, 190.0, 50.0, 80.0, 70.0, 30.0, 50.0, 50.0, 40.0, 60.0, 25.0, 149.0, 260.0, 80.0, 80.0, 110.0, 50.0, 30.0, 150.0, 95.0, 20.0, 50.0, 70.0, 130.0, 190.0, 100.0, 130.0, 80.0, 43.0, -85.0, 90.0, 31.0, 160.0, 73.0, 110.0, 107.0, 37.0, 70.0, 100.0, 85.0, 18.0, 130.0, 80.0, 60.0, 100.0, 130.0, 110.0, 40.0, 70.0, 100.0, 50.0, 100.0, 160.0, 90.0, 120.0, 120.0, 100.0, 120.0, 50.0, 160.0, 130.0, 14.0, 30.0, 70.0, 120.0, 50.0, 25.0, 40.0, 45.0, 150.0, 160.0, 50.0, 220.0, 170.0, 60.0, 100.0, 110.0, 80.0, 77.0, 65.0, 200.0, 40.0, 140.0, 30.0, 120.0, 25.0, 99.0, 50.0, 85.0, 90.0, 110.0, 70.0, 110.0, 120.0, 40.0, 50.0, 24.0, 130.0, 88.0, 90.0, 50.0, 100.0, 50.0, 70.0, 90.0, 140.0, 60.0, 230.0, 100.0, 100.0, 100.0, 80.0, 88.0, 146.0, 139.0, 210.0, 149.0, 80.0, 100.0, 34.0, 250.0, 140.0, 120.0, 190.0, 88.0, 160.0, 170.0, 80.0, 100.0, 80.0, 150.0, 80.0, 120.0, 110.0, 110.0, 300.0, 110.0, 100.0, 56.0, 47.0, 80.0, 90.0, 90.0, 130.0, 90.0, 110.0, 100.0, 110.0, 78.0, 120.0, 140.0, 80.0, 130.0, 170.0, 160.0, 70.0, 140.0, 120.0, 49.0, 180.0, 90.0, 100.0, 150.0, 80.0, 80.0, 40.0, 60.0, 90.0, 250.0, -40.0, 100.0, 55.0, 150.0, 170.0, 130.0, 60.0, 90.0, 100.0, 202.0, 50.0, 140.0, 29.0, 90.0, 18.0, 40.0, 50.0, 80.0, 83.0, 100.0, 121.0, 200.0, 87.0, 90.0, 23.0, 70.0, 90.0, 80.0, 80.0, 80.0, 67.0, 100.0, 200.0, 85.0, 140.0, 120.0, 110.0, 200.0, 80.0, 80.0, 70.0, 120.0, 70.0, 90.0, 150.0, 140.0, 40.0, 260.0, 120.0, 120.0, 100.0, 113.0, 109.0, 40.0, 80.0, -10.0, 250.0, 60.0, 90.0, 45.0, 50.0, 150.0, 59.0, 160.0, 70.0, 100.0, 6.0, 110.0, 80.0, 29.0, 20.0, -30.0, 58.0, 50.0, 140.0, 10.0, 60.0, 60.0, 40.0, 46.0, 48.0, 30.0, 75.0, 60.0, 60.0, 50.0, 141.0, 49.0, 42.0, 30.0, 120.0, -35.0, 130.0, 110.0, 70.0, 120.0, 180.0, 120.0, 60.0, 23.0, 110.0, 80.0, 50.0, 230.0, 50.0, 100.0, 160.0, 99.0, 66.0, 120.0, 170.0, 100.0, 130.0, 12.0, 180.0, 101.0, 70.0, 80.0, 180.0, 50.0, 90.0, 190.0, 110.0, 140.0, 190.0, 65.0, 130.0, 20.0, 90.0, 210.0, 50.0, 92.0, 70.0, 30.0, 90.0, 95.0, 120.0, 42.0, 60.0, 130.0, 165.0, 30.0, 20.0, 100.0, 50.0, 69.0, 11.0, 210.0, 70.0, 100.0, 120.0, 68.0, 160.0, 52.0, 160.0, 150.0, 110.0, 98.0, 160.0, 49.0, 79.0, 110.0, 210.0, 54.0, 180.0, 88.0, 158.0, 100.0, 59.0, 160.0, 140.0, 130.0, 47.0, 90.0, 49.0, 140.0, 96.0, 79.0, 80.0, 60.0, 195.0, 50.0, 130.0, 110.0, 70.0, 44.0, 40.0, 130.0, 90.0, 170.0, 60.0, 110.0, 60.0, 180.0, 60.0, 170.0, 180.0, 99.0, 69.0, 70.0, 110.0, 105.0, 110.0, 180.0, 120.0, 50.0, 100.0, 120.0, 78.0, 12.0, 140.0, 80.0, 200.0, 35.0, 90.0, 80.0, 120.0, 80.0, 70.0, 60.0, 50.0, 60.0, 170.0, 40.0, 110.0, 140.0, 50.0, 60.0, 40.0, 160.0, 70.0, 240.0, 180.0, 80.0, 90.0, 110.0, 140.0, 170.0, 130.0, 110.0, 40.0, 60.0, 160.0, 70.0, 90.0, 129.0, 44.0, 6.0, 147.0, 140.0, 100.0, 2.0, 85.0, 60.0, 60.0, 250.0, 101.0, 71.0, 70.0, 90.0, 100.0, 126.0, 100.0, 80.0, 120.0, 8.0, 170.0, 140.0, 50.0, 90.0, 90.0, 100.0, 2.0, 22.0, 80.0, 50.0, -12.0, 270.0, 89.0, 70.0, 20.0, 90.0, 80.0, 76.0, 50.0, 80.0, 130.0, 246.0, -10.0, 90.0, 10.0, 28.0, 0.0, 60.0, 247.0, 35.0, 4.0, -19.0, 80.0, 100.0, 70.0, 90.0, 100.0, 110.0, 80.0, 150.0, 140.0, 80.0, 150.0, 110.0, 110.0, 60.0, 230.0, 90.0, 70.0, 40.0, 20.0, 160.0, 40.0, 30.0, 129.0, 60.0, 80.0, 90.0, 150.0, 70.0, 68.0, 160.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.674081085887228, "mean_inference_ms": 1.6753134534934082, "mean_action_processing_ms": 0.5099037490827308, "mean_env_wait_ms": 1.1462948452619828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020559072494506836, "StateBufferConnector_ms": 0.010527372360229492, "ViewRequirementAgentConnector_ms": 0.38640713691711426}, "num_episodes": 18, "episode_return_max": 1370.0, "episode_return_min": 437.0, "episode_return_mean": 968.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.706840326719938, "num_env_steps_trained_throughput_per_sec": 20.706840326719938, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 4480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4480000, "timers": {"training_iteration_time_ms": 193344.457, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193344.401, "sample_time_ms": 2491.689, "learn_time_ms": 190832.753, "learn_throughput": 20.961, "synch_weights_time_ms": 11.613}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "done": false, "training_iteration": 112, "trial_id": "1841f_00000", "date": "2024-08-08_05-44-19", "timestamp": 1723110259, "time_this_iter_s": 193.18380093574524, "time_total_s": 23042.4760658741, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b291cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23042.4760658741, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 17.31135531135531, "ram_util_percent": 76.87289377289378}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.603864308604544, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.420212349520959, "policy_loss": -0.014448000518461299, "vf_loss": 8.433196161907956, "vf_explained_var": -0.0048591110399101994, "kl": 0.0073209497052099835, "entropy": 0.4965880443049442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1056375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "env_runners": {"episode_reward_max": 1370.0, "episode_reward_min": 437.0, "episode_reward_mean": 955.92, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 95.592}, "custom_metrics": {}, "hist_stats": {"episode_reward": [571.0, 680.0, 1070.0, 840.0, 1150.0, 960.0, 1089.0, 1220.0, 770.0, 1002.0, 1049.0, 1235.0, 1060.0, 705.0, 1060.0, 900.0, 1119.0, 921.0, 602.0, 1095.0, 1045.0, 523.0, 1359.0, 1045.0, 925.0, 470.0, 1146.0, 1170.0, 940.0, 884.0, 1015.0, 636.0, 853.0, 1030.0, 689.0, 1145.0, 846.0, 829.0, 968.0, 1192.0, 1332.0, 1260.0, 903.0, 1208.0, 919.0, 1065.0, 782.0, 941.0, 1182.0, 1140.0, 952.0, 830.0, 437.0, 601.0, 905.0, 968.0, 1143.0, 1075.0, 859.0, 855.0, 1178.0, 1087.0, 1011.0, 919.0, 1158.0, 1043.0, 907.0, 780.0, 1370.0, 856.0, 939.0, 984.0, 781.0, 832.0, 535.0, 1070.0, 930.0, 957.0, 928.0, 1040.0, 940.0, 1160.0, 762.0, 730.0, 1185.0, 1015.0, 952.0, 1093.0, 1359.0, 1089.0, 798.0, 980.0, 883.0, 1074.0, 1052.0, 847.0, 698.0, 745.0, 865.0, 895.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 65.0, 60.0, 80.0, 13.0, 10.0, 90.0, 80.0, 43.0, 50.0, 75.0, 10.0, 50.0, 20.0, 70.0, 200.0, 70.0, 100.0, 50.0, 35.0, 80.0, 190.0, 40.0, 90.0, 100.0, 60.0, 120.0, 130.0, 180.0, 80.0, 140.0, 100.0, 80.0, 100.0, 100.0, 80.0, 60.0, 40.0, 80.0, 60.0, 100.0, 60.0, 120.0, 50.0, 150.0, 180.0, 90.0, 150.0, 120.0, 130.0, 50.0, 150.0, 100.0, 50.0, 80.0, 70.0, 120.0, 190.0, 60.0, 90.0, 168.0, 37.0, 60.0, 150.0, 70.0, 158.0, 80.0, 70.0, 150.0, 146.0, 120.0, 180.0, 130.0, 90.0, 150.0, 100.0, 90.0, 120.0, 130.0, 110.0, 50.0, 40.0, 30.0, 40.0, 80.0, 230.0, 110.0, 40.0, 110.0, 40.0, 130.0, 120.0, 90.0, 120.0, 110.0, 100.0, 130.0, 21.0, 51.0, 130.0, 100.0, 70.0, 90.0, 140.0, 55.0, 44.0, 140.0, 120.0, 170.0, 120.0, 90.0, 90.0, 175.0, 60.0, 150.0, 180.0, 110.0, 240.0, 50.0, 90.0, 50.0, 80.0, 90.0, 50.0, 90.0, 50.0, 60.0, 260.0, 200.0, 130.0, 50.0, 210.0, 99.0, 110.0, 40.0, 100.0, 50.0, -11.0, 20.0, 37.0, 100.0, 80.0, 120.0, 180.0, 60.0, 70.0, 180.0, 70.0, 110.0, 90.0, 120.0, 20.0, 100.0, 70.0, 140.0, 120.0, 150.0, 70.0, 60.0, 50.0, 120.0, 130.0, 50.0, 110.0, 100.0, 100.0, 130.0, 160.0, 30.0, 189.0, 30.0, 20.0, 200.0, 55.0, 40.0, 70.0, 80.0, 50.0, 76.0, 300.0, 20.0, 60.0, 50.0, 50.0, 17.0, 80.0, 126.0, 48.0, 60.0, 91.0, 200.0, 50.0, 55.0, 120.0, 170.0, 50.0, 110.0, 110.0, 80.0, 150.0, 45.0, 70.0, 110.0, 140.0, 140.0, 100.0, 100.0, 90.0, 220.0, 30.0, 62.0, 40.0, 90.0, 85.0, 60.0, -11.0, 60.0, 60.0, 18.0, 59.0, 150.0, 130.0, 170.0, 170.0, 130.0, 130.0, 150.0, 170.0, 59.0, 100.0, 90.0, 120.0, 127.0, 130.0, -12.0, 40.0, 90.0, 200.0, 100.0, 160.0, 120.0, 120.0, 100.0, 50.0, 5.0, 130.0, 100.0, 100.0, 90.0, 110.0, 84.0, 20.0, 30.0, 95.0, 30.0, 80.0, 20.0, 73.0, 34.0, 4.0, 80.0, 220.0, 28.0, 70.0, 100.0, 80.0, 130.0, 150.0, 150.0, 138.0, 130.0, 110.0, 80.0, 110.0, 110.0, 120.0, 170.0, 70.0, 150.0, 120.0, 130.0, 90.0, 200.0, 190.0, 50.0, 80.0, 70.0, 30.0, 50.0, 50.0, 40.0, 60.0, 25.0, 149.0, 260.0, 80.0, 80.0, 110.0, 50.0, 30.0, 150.0, 95.0, 20.0, 50.0, 70.0, 130.0, 190.0, 100.0, 130.0, 80.0, 43.0, -85.0, 90.0, 31.0, 160.0, 73.0, 110.0, 107.0, 37.0, 70.0, 100.0, 85.0, 18.0, 130.0, 80.0, 60.0, 100.0, 130.0, 110.0, 40.0, 70.0, 100.0, 50.0, 100.0, 160.0, 90.0, 120.0, 120.0, 100.0, 120.0, 50.0, 160.0, 130.0, 14.0, 30.0, 70.0, 120.0, 50.0, 25.0, 40.0, 45.0, 150.0, 160.0, 50.0, 220.0, 170.0, 60.0, 100.0, 110.0, 80.0, 77.0, 65.0, 200.0, 40.0, 140.0, 30.0, 120.0, 25.0, 99.0, 50.0, 85.0, 90.0, 110.0, 70.0, 110.0, 120.0, 40.0, 50.0, 24.0, 130.0, 88.0, 90.0, 50.0, 100.0, 50.0, 70.0, 90.0, 140.0, 60.0, 230.0, 100.0, 100.0, 100.0, 80.0, 88.0, 146.0, 139.0, 210.0, 149.0, 80.0, 100.0, 34.0, 250.0, 140.0, 120.0, 190.0, 88.0, 160.0, 170.0, 80.0, 100.0, 80.0, 150.0, 80.0, 120.0, 110.0, 110.0, 300.0, 110.0, 100.0, 56.0, 47.0, 80.0, 90.0, 90.0, 130.0, 90.0, 110.0, 100.0, 110.0, 78.0, 120.0, 140.0, 80.0, 130.0, 170.0, 160.0, 70.0, 140.0, 120.0, 49.0, 180.0, 90.0, 100.0, 150.0, 80.0, 80.0, 40.0, 60.0, 90.0, 250.0, -40.0, 100.0, 55.0, 150.0, 170.0, 130.0, 60.0, 90.0, 100.0, 202.0, 50.0, 140.0, 29.0, 90.0, 18.0, 40.0, 50.0, 80.0, 83.0, 100.0, 121.0, 200.0, 87.0, 90.0, 23.0, 70.0, 90.0, 80.0, 80.0, 80.0, 67.0, 100.0, 200.0, 85.0, 140.0, 120.0, 110.0, 200.0, 80.0, 80.0, 70.0, 120.0, 70.0, 90.0, 150.0, 140.0, 40.0, 260.0, 120.0, 120.0, 100.0, 113.0, 109.0, 40.0, 80.0, -10.0, 250.0, 60.0, 90.0, 45.0, 50.0, 150.0, 59.0, 160.0, 70.0, 100.0, 6.0, 110.0, 80.0, 29.0, 20.0, -30.0, 58.0, 50.0, 140.0, 10.0, 60.0, 60.0, 40.0, 46.0, 48.0, 30.0, 75.0, 60.0, 60.0, 50.0, 141.0, 49.0, 42.0, 30.0, 120.0, -35.0, 130.0, 110.0, 70.0, 120.0, 180.0, 120.0, 60.0, 23.0, 110.0, 80.0, 50.0, 230.0, 50.0, 100.0, 160.0, 99.0, 66.0, 120.0, 170.0, 100.0, 130.0, 12.0, 180.0, 101.0, 70.0, 80.0, 180.0, 50.0, 90.0, 190.0, 110.0, 140.0, 190.0, 65.0, 130.0, 20.0, 90.0, 210.0, 50.0, 92.0, 70.0, 30.0, 90.0, 95.0, 120.0, 42.0, 60.0, 130.0, 165.0, 30.0, 20.0, 100.0, 50.0, 69.0, 11.0, 210.0, 70.0, 100.0, 120.0, 68.0, 160.0, 52.0, 160.0, 150.0, 110.0, 98.0, 160.0, 49.0, 79.0, 110.0, 210.0, 54.0, 180.0, 88.0, 158.0, 100.0, 59.0, 160.0, 140.0, 130.0, 47.0, 90.0, 49.0, 140.0, 96.0, 79.0, 80.0, 60.0, 195.0, 50.0, 130.0, 110.0, 70.0, 44.0, 40.0, 130.0, 90.0, 170.0, 60.0, 110.0, 60.0, 180.0, 60.0, 170.0, 180.0, 99.0, 69.0, 70.0, 110.0, 105.0, 110.0, 180.0, 120.0, 50.0, 100.0, 120.0, 78.0, 12.0, 140.0, 80.0, 200.0, 35.0, 90.0, 80.0, 120.0, 80.0, 70.0, 60.0, 50.0, 60.0, 170.0, 40.0, 110.0, 140.0, 50.0, 60.0, 40.0, 160.0, 70.0, 240.0, 180.0, 80.0, 90.0, 110.0, 140.0, 170.0, 130.0, 110.0, 40.0, 60.0, 160.0, 70.0, 90.0, 129.0, 44.0, 6.0, 147.0, 140.0, 100.0, 2.0, 85.0, 60.0, 60.0, 250.0, 101.0, 71.0, 70.0, 90.0, 100.0, 126.0, 100.0, 80.0, 120.0, 8.0, 170.0, 140.0, 50.0, 90.0, 90.0, 100.0, 2.0, 22.0, 80.0, 50.0, -12.0, 270.0, 89.0, 70.0, 20.0, 90.0, 80.0, 76.0, 50.0, 80.0, 130.0, 246.0, -10.0, 90.0, 10.0, 28.0, 0.0, 60.0, 247.0, 35.0, 4.0, -19.0, 80.0, 100.0, 70.0, 90.0, 100.0, 110.0, 80.0, 150.0, 140.0, 80.0, 150.0, 110.0, 110.0, 60.0, 230.0, 90.0, 70.0, 40.0, 20.0, 160.0, 40.0, 30.0, 129.0, 60.0, 80.0, 90.0, 150.0, 70.0, 68.0, 160.0, 120.0, 70.0, 120.0, 90.0, 120.0, 130.0, 110.0, 59.0, 40.0, 79.0, 110.0, 190.0, 100.0, 110.0, 98.0, 107.0, 40.0, 75.0, 130.0, 110.0, 80.0, 70.0, 135.0, 80.0, 130.0, 40.0, 54.0, 71.0, 100.0, 120.0, 140.0, 180.0, 100.0, 50.0, 100.0, 80.0, 120.0, 100.0, 150.0, 140.0, 140.0, 70.0, 62.0, 34.0, 155.0, 80.0, 98.0, 39.0, 0.0, 104.0, 120.0, 50.0, 60.0, 120.0, 10.0, 60.0, 210.0, 55.0, 0.0, 100.0, 65.0, 130.0, 110.0, 190.0, 110.0, -15.0, 130.0, 140.0, 130.0, 210.0, 50.0, 90.0, 75.0, 170.0, 110.0, 100.0, 100.0, 60.0, 120.0, 90.0, 100.0, 50.0, 77.0, 110.0, 160.0, 60.0, 215.0, 50.0, 50.0, 130.0, 50.0, 64.0, 127.0, 130.0, 79.0, 99.0, 130.0, 60.0, 120.0, 94.0, 190.0, 59.0, 140.0, 180.0, 110.0, 190.0, 140.0, 90.0, 140.0, 210.0, 100.0, 230.0, 110.0, 99.0, 216.0, 137.0, 58.0, 40.0, 9.0, 140.0, 50.0, 50.0, 120.0, 15.0, 150.0, 60.0, 100.0, 110.0, 60.0, 140.0, -7.0, 160.0, 120.0, 110.0, 120.0, 50.0, 140.0, 80.0, 0.0, 150.0, 50.0, 50.0, 100.0, 127.0, 46.0, 60.0, 100.0, 30.0, 180.0, 90.0, 100.0, 160.0, 140.0, 110.0, 70.0, 131.0, 43.0, 100.0, 100.0, 80.0, 140.0, 100.0, 90.0, 150.0, 130.0, 57.0, 110.0, 130.0, 155.0, 20.0, 110.0, 129.0, 60.0, 130.0, 70.0, 90.0, 24.0, 30.0, 160.0, 89.0, 65.0, 100.0, 0.0, 50.0, 80.0, 150.0, 9.0, 100.0, 130.0, 20.0, 59.0, 120.0, 120.0, 50.0, 60.0, 35.0, 50.0, 130.0, 100.0, 60.0, 20.0, 100.0, 80.0, 75.0, 100.0, 60.0, 50.0, 30.0, 60.0, 140.0, 170.0, 130.0, 90.0, 50.0, 75.0, 110.0, 70.0, 140.0, 40.0, 80.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6709907766763137, "mean_inference_ms": 1.6720698286560032, "mean_action_processing_ms": 0.5091108061054804, "mean_env_wait_ms": 1.144584434597988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021285533905029297, "StateBufferConnector_ms": 0.010687112808227539, "ViewRequirementAgentConnector_ms": 0.3871297836303711}, "num_episodes": 22, "episode_return_max": 1370.0, "episode_return_min": 437.0, "episode_return_mean": 955.92}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.697478860185306, "num_env_steps_trained_throughput_per_sec": 20.697478860185306, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 4520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4520000, "timers": {"training_iteration_time_ms": 193301.175, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193301.119, "sample_time_ms": 2493.509, "learn_time_ms": 190788.049, "learn_throughput": 20.966, "synch_weights_time_ms": 11.249}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "done": false, "training_iteration": 113, "trial_id": "1841f_00000", "date": "2024-08-08_05-47-32", "timestamp": 1723110452, "time_this_iter_s": 193.27195692062378, "time_total_s": 23235.748022794724, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b56a10d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23235.748022794724, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 17.186496350364965, "ram_util_percent": 76.69598540145985}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.773032000975106, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.757180974582514, "policy_loss": -0.015237342189234723, "vf_loss": 8.770908998960632, "vf_explained_var": -0.00034007878857044875, "kl": 0.007546570015130841, "entropy": 0.4904581866483973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1065765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "env_runners": {"episode_reward_max": 1445.0, "episode_reward_min": 437.0, "episode_reward_mean": 972.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 97.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [602.0, 1095.0, 1045.0, 523.0, 1359.0, 1045.0, 925.0, 470.0, 1146.0, 1170.0, 940.0, 884.0, 1015.0, 636.0, 853.0, 1030.0, 689.0, 1145.0, 846.0, 829.0, 968.0, 1192.0, 1332.0, 1260.0, 903.0, 1208.0, 919.0, 1065.0, 782.0, 941.0, 1182.0, 1140.0, 952.0, 830.0, 437.0, 601.0, 905.0, 968.0, 1143.0, 1075.0, 859.0, 855.0, 1178.0, 1087.0, 1011.0, 919.0, 1158.0, 1043.0, 907.0, 780.0, 1370.0, 856.0, 939.0, 984.0, 781.0, 832.0, 535.0, 1070.0, 930.0, 957.0, 928.0, 1040.0, 940.0, 1160.0, 762.0, 730.0, 1185.0, 1015.0, 952.0, 1093.0, 1359.0, 1089.0, 798.0, 980.0, 883.0, 1074.0, 1052.0, 847.0, 698.0, 745.0, 865.0, 895.0, 950.0, 948.0, 1002.0, 1073.0, 1050.0, 1194.0, 1310.0, 1010.0, 1070.0, 1140.0, 913.0, 1250.0, 1090.0, 1445.0, 910.0, 1000.0, 829.0, 915.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 60.0, 50.0, 50.0, 17.0, 80.0, 126.0, 48.0, 60.0, 91.0, 200.0, 50.0, 55.0, 120.0, 170.0, 50.0, 110.0, 110.0, 80.0, 150.0, 45.0, 70.0, 110.0, 140.0, 140.0, 100.0, 100.0, 90.0, 220.0, 30.0, 62.0, 40.0, 90.0, 85.0, 60.0, -11.0, 60.0, 60.0, 18.0, 59.0, 150.0, 130.0, 170.0, 170.0, 130.0, 130.0, 150.0, 170.0, 59.0, 100.0, 90.0, 120.0, 127.0, 130.0, -12.0, 40.0, 90.0, 200.0, 100.0, 160.0, 120.0, 120.0, 100.0, 50.0, 5.0, 130.0, 100.0, 100.0, 90.0, 110.0, 84.0, 20.0, 30.0, 95.0, 30.0, 80.0, 20.0, 73.0, 34.0, 4.0, 80.0, 220.0, 28.0, 70.0, 100.0, 80.0, 130.0, 150.0, 150.0, 138.0, 130.0, 110.0, 80.0, 110.0, 110.0, 120.0, 170.0, 70.0, 150.0, 120.0, 130.0, 90.0, 200.0, 190.0, 50.0, 80.0, 70.0, 30.0, 50.0, 50.0, 40.0, 60.0, 25.0, 149.0, 260.0, 80.0, 80.0, 110.0, 50.0, 30.0, 150.0, 95.0, 20.0, 50.0, 70.0, 130.0, 190.0, 100.0, 130.0, 80.0, 43.0, -85.0, 90.0, 31.0, 160.0, 73.0, 110.0, 107.0, 37.0, 70.0, 100.0, 85.0, 18.0, 130.0, 80.0, 60.0, 100.0, 130.0, 110.0, 40.0, 70.0, 100.0, 50.0, 100.0, 160.0, 90.0, 120.0, 120.0, 100.0, 120.0, 50.0, 160.0, 130.0, 14.0, 30.0, 70.0, 120.0, 50.0, 25.0, 40.0, 45.0, 150.0, 160.0, 50.0, 220.0, 170.0, 60.0, 100.0, 110.0, 80.0, 77.0, 65.0, 200.0, 40.0, 140.0, 30.0, 120.0, 25.0, 99.0, 50.0, 85.0, 90.0, 110.0, 70.0, 110.0, 120.0, 40.0, 50.0, 24.0, 130.0, 88.0, 90.0, 50.0, 100.0, 50.0, 70.0, 90.0, 140.0, 60.0, 230.0, 100.0, 100.0, 100.0, 80.0, 88.0, 146.0, 139.0, 210.0, 149.0, 80.0, 100.0, 34.0, 250.0, 140.0, 120.0, 190.0, 88.0, 160.0, 170.0, 80.0, 100.0, 80.0, 150.0, 80.0, 120.0, 110.0, 110.0, 300.0, 110.0, 100.0, 56.0, 47.0, 80.0, 90.0, 90.0, 130.0, 90.0, 110.0, 100.0, 110.0, 78.0, 120.0, 140.0, 80.0, 130.0, 170.0, 160.0, 70.0, 140.0, 120.0, 49.0, 180.0, 90.0, 100.0, 150.0, 80.0, 80.0, 40.0, 60.0, 90.0, 250.0, -40.0, 100.0, 55.0, 150.0, 170.0, 130.0, 60.0, 90.0, 100.0, 202.0, 50.0, 140.0, 29.0, 90.0, 18.0, 40.0, 50.0, 80.0, 83.0, 100.0, 121.0, 200.0, 87.0, 90.0, 23.0, 70.0, 90.0, 80.0, 80.0, 80.0, 67.0, 100.0, 200.0, 85.0, 140.0, 120.0, 110.0, 200.0, 80.0, 80.0, 70.0, 120.0, 70.0, 90.0, 150.0, 140.0, 40.0, 260.0, 120.0, 120.0, 100.0, 113.0, 109.0, 40.0, 80.0, -10.0, 250.0, 60.0, 90.0, 45.0, 50.0, 150.0, 59.0, 160.0, 70.0, 100.0, 6.0, 110.0, 80.0, 29.0, 20.0, -30.0, 58.0, 50.0, 140.0, 10.0, 60.0, 60.0, 40.0, 46.0, 48.0, 30.0, 75.0, 60.0, 60.0, 50.0, 141.0, 49.0, 42.0, 30.0, 120.0, -35.0, 130.0, 110.0, 70.0, 120.0, 180.0, 120.0, 60.0, 23.0, 110.0, 80.0, 50.0, 230.0, 50.0, 100.0, 160.0, 99.0, 66.0, 120.0, 170.0, 100.0, 130.0, 12.0, 180.0, 101.0, 70.0, 80.0, 180.0, 50.0, 90.0, 190.0, 110.0, 140.0, 190.0, 65.0, 130.0, 20.0, 90.0, 210.0, 50.0, 92.0, 70.0, 30.0, 90.0, 95.0, 120.0, 42.0, 60.0, 130.0, 165.0, 30.0, 20.0, 100.0, 50.0, 69.0, 11.0, 210.0, 70.0, 100.0, 120.0, 68.0, 160.0, 52.0, 160.0, 150.0, 110.0, 98.0, 160.0, 49.0, 79.0, 110.0, 210.0, 54.0, 180.0, 88.0, 158.0, 100.0, 59.0, 160.0, 140.0, 130.0, 47.0, 90.0, 49.0, 140.0, 96.0, 79.0, 80.0, 60.0, 195.0, 50.0, 130.0, 110.0, 70.0, 44.0, 40.0, 130.0, 90.0, 170.0, 60.0, 110.0, 60.0, 180.0, 60.0, 170.0, 180.0, 99.0, 69.0, 70.0, 110.0, 105.0, 110.0, 180.0, 120.0, 50.0, 100.0, 120.0, 78.0, 12.0, 140.0, 80.0, 200.0, 35.0, 90.0, 80.0, 120.0, 80.0, 70.0, 60.0, 50.0, 60.0, 170.0, 40.0, 110.0, 140.0, 50.0, 60.0, 40.0, 160.0, 70.0, 240.0, 180.0, 80.0, 90.0, 110.0, 140.0, 170.0, 130.0, 110.0, 40.0, 60.0, 160.0, 70.0, 90.0, 129.0, 44.0, 6.0, 147.0, 140.0, 100.0, 2.0, 85.0, 60.0, 60.0, 250.0, 101.0, 71.0, 70.0, 90.0, 100.0, 126.0, 100.0, 80.0, 120.0, 8.0, 170.0, 140.0, 50.0, 90.0, 90.0, 100.0, 2.0, 22.0, 80.0, 50.0, -12.0, 270.0, 89.0, 70.0, 20.0, 90.0, 80.0, 76.0, 50.0, 80.0, 130.0, 246.0, -10.0, 90.0, 10.0, 28.0, 0.0, 60.0, 247.0, 35.0, 4.0, -19.0, 80.0, 100.0, 70.0, 90.0, 100.0, 110.0, 80.0, 150.0, 140.0, 80.0, 150.0, 110.0, 110.0, 60.0, 230.0, 90.0, 70.0, 40.0, 20.0, 160.0, 40.0, 30.0, 129.0, 60.0, 80.0, 90.0, 150.0, 70.0, 68.0, 160.0, 120.0, 70.0, 120.0, 90.0, 120.0, 130.0, 110.0, 59.0, 40.0, 79.0, 110.0, 190.0, 100.0, 110.0, 98.0, 107.0, 40.0, 75.0, 130.0, 110.0, 80.0, 70.0, 135.0, 80.0, 130.0, 40.0, 54.0, 71.0, 100.0, 120.0, 140.0, 180.0, 100.0, 50.0, 100.0, 80.0, 120.0, 100.0, 150.0, 140.0, 140.0, 70.0, 62.0, 34.0, 155.0, 80.0, 98.0, 39.0, 0.0, 104.0, 120.0, 50.0, 60.0, 120.0, 10.0, 60.0, 210.0, 55.0, 0.0, 100.0, 65.0, 130.0, 110.0, 190.0, 110.0, -15.0, 130.0, 140.0, 130.0, 210.0, 50.0, 90.0, 75.0, 170.0, 110.0, 100.0, 100.0, 60.0, 120.0, 90.0, 100.0, 50.0, 77.0, 110.0, 160.0, 60.0, 215.0, 50.0, 50.0, 130.0, 50.0, 64.0, 127.0, 130.0, 79.0, 99.0, 130.0, 60.0, 120.0, 94.0, 190.0, 59.0, 140.0, 180.0, 110.0, 190.0, 140.0, 90.0, 140.0, 210.0, 100.0, 230.0, 110.0, 99.0, 216.0, 137.0, 58.0, 40.0, 9.0, 140.0, 50.0, 50.0, 120.0, 15.0, 150.0, 60.0, 100.0, 110.0, 60.0, 140.0, -7.0, 160.0, 120.0, 110.0, 120.0, 50.0, 140.0, 80.0, 0.0, 150.0, 50.0, 50.0, 100.0, 127.0, 46.0, 60.0, 100.0, 30.0, 180.0, 90.0, 100.0, 160.0, 140.0, 110.0, 70.0, 131.0, 43.0, 100.0, 100.0, 80.0, 140.0, 100.0, 90.0, 150.0, 130.0, 57.0, 110.0, 130.0, 155.0, 20.0, 110.0, 129.0, 60.0, 130.0, 70.0, 90.0, 24.0, 30.0, 160.0, 89.0, 65.0, 100.0, 0.0, 50.0, 80.0, 150.0, 9.0, 100.0, 130.0, 20.0, 59.0, 120.0, 120.0, 50.0, 60.0, 35.0, 50.0, 130.0, 100.0, 60.0, 20.0, 100.0, 80.0, 75.0, 100.0, 60.0, 50.0, 30.0, 60.0, 140.0, 170.0, 130.0, 90.0, 50.0, 75.0, 110.0, 70.0, 140.0, 40.0, 80.0, 110.0, 154.0, 160.0, 60.0, 90.0, 49.0, 40.0, 70.0, 180.0, 57.0, 90.0, 70.0, 110.0, 126.0, 60.0, 130.0, 130.0, 42.0, 60.0, 120.0, 100.0, 138.0, 156.0, 100.0, -13.0, 54.0, 90.0, 67.0, 40.0, 260.0, 110.0, 77.0, 16.0, 100.0, 190.0, 200.0, 140.0, 90.0, 80.0, 110.0, 70.0, 100.0, 60.0, 135.0, 120.0, 80.0, 150.0, 100.0, 115.0, 90.0, 100.0, 280.0, 120.0, 67.0, 70.0, 120.0, 150.0, 120.0, 210.0, -13.0, 70.0, 130.0, 140.0, 50.0, 120.0, 110.0, 200.0, 140.0, 90.0, 190.0, 140.0, 50.0, 120.0, 88.0, 69.0, 100.0, 140.0, 70.0, 200.0, 110.0, 63.0, 150.0, 90.0, 130.0, 90.0, 70.0, 70.0, 70.0, 70.0, 100.0, 230.0, 140.0, 100.0, 140.0, 140.0, 80.0, 130.0, 100.0, 130.0, 110.0, 70.0, 91.0, 130.0, 60.0, 60.0, 130.0, 150.0, 52.0, 90.0, 80.0, 70.0, 90.0, 80.0, 210.0, 70.0, 110.0, 170.0, 270.0, 80.0, 30.0, 140.0, 140.0, 100.0, 120.0, 90.0, 190.0, 130.0, 50.0, 110.0, 80.0, 80.0, 190.0, 240.0, 125.0, 180.0, 140.0, 50.0, 140.0, 120.0, 100.0, 160.0, 110.0, 136.0, 150.0, 56.0, 23.0, 200.0, 30.0, 15.0, 150.0, 40.0, 80.0, 100.0, 70.0, 150.0, 60.0, 200.0, 20.0, 180.0, 100.0, 40.0, 79.0, 70.0, 70.0, 50.0, 140.0, 90.0, 80.0, 80.0, 40.0, 130.0, 70.0, 56.0, 220.0, 100.0, 110.0, 185.0, 23.0, 130.0, 10.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6685840432027919, "mean_inference_ms": 1.669672963661213, "mean_action_processing_ms": 0.5084940952144545, "mean_env_wait_ms": 1.1433290502645317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012520313262939453, "StateBufferConnector_ms": 0.010659933090209961, "ViewRequirementAgentConnector_ms": 0.3814206123352051}, "num_episodes": 18, "episode_return_max": 1445.0, "episode_return_min": 437.0, "episode_return_mean": 972.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.737973966151884, "num_env_steps_trained_throughput_per_sec": 20.737973966151884, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 4560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4560000, "timers": {"training_iteration_time_ms": 193206.777, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193206.732, "sample_time_ms": 2501.34, "learn_time_ms": 190686.588, "learn_throughput": 20.977, "synch_weights_time_ms": 10.426}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "done": false, "training_iteration": 114, "trial_id": "1841f_00000", "date": "2024-08-08_05-50-45", "timestamp": 1723110645, "time_this_iter_s": 192.89255619049072, "time_total_s": 23428.640578985214, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b610e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23428.640578985214, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 17.156617647058823, "ram_util_percent": 76.19816176470587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4685984020415965, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.381299774436016, "policy_loss": -0.015291094924972905, "vf_loss": 8.395109822879585, "vf_explained_var": -0.006188271735042048, "kl": 0.00740525354243313, "entropy": 0.5026474444058756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1075155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "env_runners": {"episode_reward_max": 1445.0, "episode_reward_min": 437.0, "episode_reward_mean": 976.56, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -40.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 97.656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1260.0, 903.0, 1208.0, 919.0, 1065.0, 782.0, 941.0, 1182.0, 1140.0, 952.0, 830.0, 437.0, 601.0, 905.0, 968.0, 1143.0, 1075.0, 859.0, 855.0, 1178.0, 1087.0, 1011.0, 919.0, 1158.0, 1043.0, 907.0, 780.0, 1370.0, 856.0, 939.0, 984.0, 781.0, 832.0, 535.0, 1070.0, 930.0, 957.0, 928.0, 1040.0, 940.0, 1160.0, 762.0, 730.0, 1185.0, 1015.0, 952.0, 1093.0, 1359.0, 1089.0, 798.0, 980.0, 883.0, 1074.0, 1052.0, 847.0, 698.0, 745.0, 865.0, 895.0, 950.0, 948.0, 1002.0, 1073.0, 1050.0, 1194.0, 1310.0, 1010.0, 1070.0, 1140.0, 913.0, 1250.0, 1090.0, 1445.0, 910.0, 1000.0, 829.0, 915.0, 898.0, 1015.0, 996.0, 874.0, 667.0, 1065.0, 1175.0, 1025.0, 945.0, 1150.0, 1093.0, 952.0, 1020.0, 890.0, 1299.0, 479.0, 986.0, 938.0, 1015.0, 769.0, 1026.0, 1070.0, 758.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 80.0, 150.0, 80.0, 120.0, 110.0, 110.0, 300.0, 110.0, 100.0, 56.0, 47.0, 80.0, 90.0, 90.0, 130.0, 90.0, 110.0, 100.0, 110.0, 78.0, 120.0, 140.0, 80.0, 130.0, 170.0, 160.0, 70.0, 140.0, 120.0, 49.0, 180.0, 90.0, 100.0, 150.0, 80.0, 80.0, 40.0, 60.0, 90.0, 250.0, -40.0, 100.0, 55.0, 150.0, 170.0, 130.0, 60.0, 90.0, 100.0, 202.0, 50.0, 140.0, 29.0, 90.0, 18.0, 40.0, 50.0, 80.0, 83.0, 100.0, 121.0, 200.0, 87.0, 90.0, 23.0, 70.0, 90.0, 80.0, 80.0, 80.0, 67.0, 100.0, 200.0, 85.0, 140.0, 120.0, 110.0, 200.0, 80.0, 80.0, 70.0, 120.0, 70.0, 90.0, 150.0, 140.0, 40.0, 260.0, 120.0, 120.0, 100.0, 113.0, 109.0, 40.0, 80.0, -10.0, 250.0, 60.0, 90.0, 45.0, 50.0, 150.0, 59.0, 160.0, 70.0, 100.0, 6.0, 110.0, 80.0, 29.0, 20.0, -30.0, 58.0, 50.0, 140.0, 10.0, 60.0, 60.0, 40.0, 46.0, 48.0, 30.0, 75.0, 60.0, 60.0, 50.0, 141.0, 49.0, 42.0, 30.0, 120.0, -35.0, 130.0, 110.0, 70.0, 120.0, 180.0, 120.0, 60.0, 23.0, 110.0, 80.0, 50.0, 230.0, 50.0, 100.0, 160.0, 99.0, 66.0, 120.0, 170.0, 100.0, 130.0, 12.0, 180.0, 101.0, 70.0, 80.0, 180.0, 50.0, 90.0, 190.0, 110.0, 140.0, 190.0, 65.0, 130.0, 20.0, 90.0, 210.0, 50.0, 92.0, 70.0, 30.0, 90.0, 95.0, 120.0, 42.0, 60.0, 130.0, 165.0, 30.0, 20.0, 100.0, 50.0, 69.0, 11.0, 210.0, 70.0, 100.0, 120.0, 68.0, 160.0, 52.0, 160.0, 150.0, 110.0, 98.0, 160.0, 49.0, 79.0, 110.0, 210.0, 54.0, 180.0, 88.0, 158.0, 100.0, 59.0, 160.0, 140.0, 130.0, 47.0, 90.0, 49.0, 140.0, 96.0, 79.0, 80.0, 60.0, 195.0, 50.0, 130.0, 110.0, 70.0, 44.0, 40.0, 130.0, 90.0, 170.0, 60.0, 110.0, 60.0, 180.0, 60.0, 170.0, 180.0, 99.0, 69.0, 70.0, 110.0, 105.0, 110.0, 180.0, 120.0, 50.0, 100.0, 120.0, 78.0, 12.0, 140.0, 80.0, 200.0, 35.0, 90.0, 80.0, 120.0, 80.0, 70.0, 60.0, 50.0, 60.0, 170.0, 40.0, 110.0, 140.0, 50.0, 60.0, 40.0, 160.0, 70.0, 240.0, 180.0, 80.0, 90.0, 110.0, 140.0, 170.0, 130.0, 110.0, 40.0, 60.0, 160.0, 70.0, 90.0, 129.0, 44.0, 6.0, 147.0, 140.0, 100.0, 2.0, 85.0, 60.0, 60.0, 250.0, 101.0, 71.0, 70.0, 90.0, 100.0, 126.0, 100.0, 80.0, 120.0, 8.0, 170.0, 140.0, 50.0, 90.0, 90.0, 100.0, 2.0, 22.0, 80.0, 50.0, -12.0, 270.0, 89.0, 70.0, 20.0, 90.0, 80.0, 76.0, 50.0, 80.0, 130.0, 246.0, -10.0, 90.0, 10.0, 28.0, 0.0, 60.0, 247.0, 35.0, 4.0, -19.0, 80.0, 100.0, 70.0, 90.0, 100.0, 110.0, 80.0, 150.0, 140.0, 80.0, 150.0, 110.0, 110.0, 60.0, 230.0, 90.0, 70.0, 40.0, 20.0, 160.0, 40.0, 30.0, 129.0, 60.0, 80.0, 90.0, 150.0, 70.0, 68.0, 160.0, 120.0, 70.0, 120.0, 90.0, 120.0, 130.0, 110.0, 59.0, 40.0, 79.0, 110.0, 190.0, 100.0, 110.0, 98.0, 107.0, 40.0, 75.0, 130.0, 110.0, 80.0, 70.0, 135.0, 80.0, 130.0, 40.0, 54.0, 71.0, 100.0, 120.0, 140.0, 180.0, 100.0, 50.0, 100.0, 80.0, 120.0, 100.0, 150.0, 140.0, 140.0, 70.0, 62.0, 34.0, 155.0, 80.0, 98.0, 39.0, 0.0, 104.0, 120.0, 50.0, 60.0, 120.0, 10.0, 60.0, 210.0, 55.0, 0.0, 100.0, 65.0, 130.0, 110.0, 190.0, 110.0, -15.0, 130.0, 140.0, 130.0, 210.0, 50.0, 90.0, 75.0, 170.0, 110.0, 100.0, 100.0, 60.0, 120.0, 90.0, 100.0, 50.0, 77.0, 110.0, 160.0, 60.0, 215.0, 50.0, 50.0, 130.0, 50.0, 64.0, 127.0, 130.0, 79.0, 99.0, 130.0, 60.0, 120.0, 94.0, 190.0, 59.0, 140.0, 180.0, 110.0, 190.0, 140.0, 90.0, 140.0, 210.0, 100.0, 230.0, 110.0, 99.0, 216.0, 137.0, 58.0, 40.0, 9.0, 140.0, 50.0, 50.0, 120.0, 15.0, 150.0, 60.0, 100.0, 110.0, 60.0, 140.0, -7.0, 160.0, 120.0, 110.0, 120.0, 50.0, 140.0, 80.0, 0.0, 150.0, 50.0, 50.0, 100.0, 127.0, 46.0, 60.0, 100.0, 30.0, 180.0, 90.0, 100.0, 160.0, 140.0, 110.0, 70.0, 131.0, 43.0, 100.0, 100.0, 80.0, 140.0, 100.0, 90.0, 150.0, 130.0, 57.0, 110.0, 130.0, 155.0, 20.0, 110.0, 129.0, 60.0, 130.0, 70.0, 90.0, 24.0, 30.0, 160.0, 89.0, 65.0, 100.0, 0.0, 50.0, 80.0, 150.0, 9.0, 100.0, 130.0, 20.0, 59.0, 120.0, 120.0, 50.0, 60.0, 35.0, 50.0, 130.0, 100.0, 60.0, 20.0, 100.0, 80.0, 75.0, 100.0, 60.0, 50.0, 30.0, 60.0, 140.0, 170.0, 130.0, 90.0, 50.0, 75.0, 110.0, 70.0, 140.0, 40.0, 80.0, 110.0, 154.0, 160.0, 60.0, 90.0, 49.0, 40.0, 70.0, 180.0, 57.0, 90.0, 70.0, 110.0, 126.0, 60.0, 130.0, 130.0, 42.0, 60.0, 120.0, 100.0, 138.0, 156.0, 100.0, -13.0, 54.0, 90.0, 67.0, 40.0, 260.0, 110.0, 77.0, 16.0, 100.0, 190.0, 200.0, 140.0, 90.0, 80.0, 110.0, 70.0, 100.0, 60.0, 135.0, 120.0, 80.0, 150.0, 100.0, 115.0, 90.0, 100.0, 280.0, 120.0, 67.0, 70.0, 120.0, 150.0, 120.0, 210.0, -13.0, 70.0, 130.0, 140.0, 50.0, 120.0, 110.0, 200.0, 140.0, 90.0, 190.0, 140.0, 50.0, 120.0, 88.0, 69.0, 100.0, 140.0, 70.0, 200.0, 110.0, 63.0, 150.0, 90.0, 130.0, 90.0, 70.0, 70.0, 70.0, 70.0, 100.0, 230.0, 140.0, 100.0, 140.0, 140.0, 80.0, 130.0, 100.0, 130.0, 110.0, 70.0, 91.0, 130.0, 60.0, 60.0, 130.0, 150.0, 52.0, 90.0, 80.0, 70.0, 90.0, 80.0, 210.0, 70.0, 110.0, 170.0, 270.0, 80.0, 30.0, 140.0, 140.0, 100.0, 120.0, 90.0, 190.0, 130.0, 50.0, 110.0, 80.0, 80.0, 190.0, 240.0, 125.0, 180.0, 140.0, 50.0, 140.0, 120.0, 100.0, 160.0, 110.0, 136.0, 150.0, 56.0, 23.0, 200.0, 30.0, 15.0, 150.0, 40.0, 80.0, 100.0, 70.0, 150.0, 60.0, 200.0, 20.0, 180.0, 100.0, 40.0, 79.0, 70.0, 70.0, 50.0, 140.0, 90.0, 80.0, 80.0, 40.0, 130.0, 70.0, 56.0, 220.0, 100.0, 110.0, 185.0, 23.0, 130.0, 10.0, 11.0, 150.0, 95.0, 30.0, 90.0, 108.0, 130.0, 80.0, 130.0, 35.0, 50.0, 85.0, 70.0, 100.0, 140.0, 110.0, 100.0, 90.0, 110.0, 110.0, 100.0, 120.0, 105.0, 70.0, 100.0, 156.0, 160.0, 110.0, 75.0, 20.0, 80.0, 100.0, 100.0, 62.0, 28.0, 130.0, 59.0, 75.0, 90.0, 150.0, 80.0, 29.0, 30.0, 9.0, 120.0, 50.0, 219.0, 30.0, 110.0, 40.0, 30.0, 90.0, 130.0, 110.0, 100.0, 150.0, 100.0, 130.0, 210.0, -35.0, 80.0, 170.0, 140.0, 155.0, 60.0, 100.0, 90.0, 160.0, 140.0, 60.0, 100.0, 200.0, 180.0, 110.0, 140.0, 20.0, 40.0, 70.0, 60.0, 90.0, 115.0, 90.0, 150.0, 60.0, 80.0, 60.0, 50.0, 80.0, 80.0, 205.0, 90.0, 150.0, 150.0, 100.0, 40.0, 70.0, 130.0, 160.0, 120.0, 140.0, 90.0, 112.0, 70.0, 128.0, 190.0, 90.0, 130.0, 23.0, 190.0, 40.0, 120.0, 62.0, 67.0, 70.0, 230.0, 48.0, 55.0, 60.0, 210.0, 80.0, 70.0, 110.0, 60.0, 130.0, 120.0, 100.0, 100.0, 70.0, 130.0, 80.0, 120.0, 80.0, 50.0, 70.0, 120.0, 100.0, 170.0, 90.0, 90.0, 60.0, 60.0, 220.0, 80.0, 100.0, 209.0, 90.0, 30.0, 110.0, 170.0, 180.0, 110.0, 50.0, 19.0, 0.0, 20.0, 40.0, 30.0, 130.0, 20.0, 160.0, 10.0, 220.0, 210.0, 55.0, 10.0, 110.0, 40.0, 66.0, 20.0, 120.0, 135.0, 70.0, 100.0, 170.0, 80.0, 100.0, 90.0, 100.0, 58.0, 110.0, 60.0, 110.0, 60.0, 58.0, 149.0, 190.0, 120.0, 96.0, 88.0, 54.0, 90.0, 59.0, 36.0, 120.0, 136.0, 70.0, 43.0, 5.0, 90.0, 100.0, 110.0, 63.0, 140.0, 140.0, 90.0, 140.0, 100.0, 70.0, 63.0, 100.0, 120.0, 120.0, 90.0, 90.0, 110.0, 90.0, 190.0, 130.0, 90.0, 60.0, 100.0, 47.0, 110.0, 50.0, 40.0, 200.0, 50.0, 32.0, 80.0, 49.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6649763541890028, "mean_inference_ms": 1.6672694353516606, "mean_action_processing_ms": 0.5073207166077096, "mean_env_wait_ms": 1.1429599845266791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012569427490234375, "StateBufferConnector_ms": 0.010720014572143555, "ViewRequirementAgentConnector_ms": 0.37708234786987305}, "num_episodes": 23, "episode_return_max": 1445.0, "episode_return_min": 437.0, "episode_return_mean": 976.56}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.624614601147144, "num_env_steps_trained_throughput_per_sec": 20.624614601147144, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 4600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4600000, "timers": {"training_iteration_time_ms": 193190.107, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193190.062, "sample_time_ms": 2510.756, "learn_time_ms": 190660.548, "learn_throughput": 20.98, "synch_weights_time_ms": 10.283}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "done": false, "training_iteration": 115, "trial_id": "1841f_00000", "date": "2024-08-08_05-53-59", "timestamp": 1723110839, "time_this_iter_s": 193.95234990119934, "time_total_s": 23622.592928886414, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b610eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23622.592928886414, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 18.649090909090905, "ram_util_percent": 76.65890909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.303504403413167, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.740237847532327, "policy_loss": -0.015583862985620181, "vf_loss": 8.754260593075086, "vf_explained_var": -0.006043697133485755, "kl": 0.007805569778995085, "entropy": 0.5008765217944329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1084545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "env_runners": {"episode_reward_max": 1700.0, "episode_reward_min": 404.0, "episode_reward_mean": 985.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -39.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 98.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [855.0, 1178.0, 1087.0, 1011.0, 919.0, 1158.0, 1043.0, 907.0, 780.0, 1370.0, 856.0, 939.0, 984.0, 781.0, 832.0, 535.0, 1070.0, 930.0, 957.0, 928.0, 1040.0, 940.0, 1160.0, 762.0, 730.0, 1185.0, 1015.0, 952.0, 1093.0, 1359.0, 1089.0, 798.0, 980.0, 883.0, 1074.0, 1052.0, 847.0, 698.0, 745.0, 865.0, 895.0, 950.0, 948.0, 1002.0, 1073.0, 1050.0, 1194.0, 1310.0, 1010.0, 1070.0, 1140.0, 913.0, 1250.0, 1090.0, 1445.0, 910.0, 1000.0, 829.0, 915.0, 898.0, 1015.0, 996.0, 874.0, 667.0, 1065.0, 1175.0, 1025.0, 945.0, 1150.0, 1093.0, 952.0, 1020.0, 890.0, 1299.0, 479.0, 986.0, 938.0, 1015.0, 769.0, 1026.0, 1070.0, 758.0, 983.0, 1220.0, 1298.0, 1100.0, 990.0, 870.0, 1091.0, 1150.0, 1220.0, 1700.0, 1005.0, 956.0, 816.0, 1104.0, 783.0, 712.0, 404.0, 672.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 165.0, 30.0, 20.0, 100.0, 50.0, 69.0, 11.0, 210.0, 70.0, 100.0, 120.0, 68.0, 160.0, 52.0, 160.0, 150.0, 110.0, 98.0, 160.0, 49.0, 79.0, 110.0, 210.0, 54.0, 180.0, 88.0, 158.0, 100.0, 59.0, 160.0, 140.0, 130.0, 47.0, 90.0, 49.0, 140.0, 96.0, 79.0, 80.0, 60.0, 195.0, 50.0, 130.0, 110.0, 70.0, 44.0, 40.0, 130.0, 90.0, 170.0, 60.0, 110.0, 60.0, 180.0, 60.0, 170.0, 180.0, 99.0, 69.0, 70.0, 110.0, 105.0, 110.0, 180.0, 120.0, 50.0, 100.0, 120.0, 78.0, 12.0, 140.0, 80.0, 200.0, 35.0, 90.0, 80.0, 120.0, 80.0, 70.0, 60.0, 50.0, 60.0, 170.0, 40.0, 110.0, 140.0, 50.0, 60.0, 40.0, 160.0, 70.0, 240.0, 180.0, 80.0, 90.0, 110.0, 140.0, 170.0, 130.0, 110.0, 40.0, 60.0, 160.0, 70.0, 90.0, 129.0, 44.0, 6.0, 147.0, 140.0, 100.0, 2.0, 85.0, 60.0, 60.0, 250.0, 101.0, 71.0, 70.0, 90.0, 100.0, 126.0, 100.0, 80.0, 120.0, 8.0, 170.0, 140.0, 50.0, 90.0, 90.0, 100.0, 2.0, 22.0, 80.0, 50.0, -12.0, 270.0, 89.0, 70.0, 20.0, 90.0, 80.0, 76.0, 50.0, 80.0, 130.0, 246.0, -10.0, 90.0, 10.0, 28.0, 0.0, 60.0, 247.0, 35.0, 4.0, -19.0, 80.0, 100.0, 70.0, 90.0, 100.0, 110.0, 80.0, 150.0, 140.0, 80.0, 150.0, 110.0, 110.0, 60.0, 230.0, 90.0, 70.0, 40.0, 20.0, 160.0, 40.0, 30.0, 129.0, 60.0, 80.0, 90.0, 150.0, 70.0, 68.0, 160.0, 120.0, 70.0, 120.0, 90.0, 120.0, 130.0, 110.0, 59.0, 40.0, 79.0, 110.0, 190.0, 100.0, 110.0, 98.0, 107.0, 40.0, 75.0, 130.0, 110.0, 80.0, 70.0, 135.0, 80.0, 130.0, 40.0, 54.0, 71.0, 100.0, 120.0, 140.0, 180.0, 100.0, 50.0, 100.0, 80.0, 120.0, 100.0, 150.0, 140.0, 140.0, 70.0, 62.0, 34.0, 155.0, 80.0, 98.0, 39.0, 0.0, 104.0, 120.0, 50.0, 60.0, 120.0, 10.0, 60.0, 210.0, 55.0, 0.0, 100.0, 65.0, 130.0, 110.0, 190.0, 110.0, -15.0, 130.0, 140.0, 130.0, 210.0, 50.0, 90.0, 75.0, 170.0, 110.0, 100.0, 100.0, 60.0, 120.0, 90.0, 100.0, 50.0, 77.0, 110.0, 160.0, 60.0, 215.0, 50.0, 50.0, 130.0, 50.0, 64.0, 127.0, 130.0, 79.0, 99.0, 130.0, 60.0, 120.0, 94.0, 190.0, 59.0, 140.0, 180.0, 110.0, 190.0, 140.0, 90.0, 140.0, 210.0, 100.0, 230.0, 110.0, 99.0, 216.0, 137.0, 58.0, 40.0, 9.0, 140.0, 50.0, 50.0, 120.0, 15.0, 150.0, 60.0, 100.0, 110.0, 60.0, 140.0, -7.0, 160.0, 120.0, 110.0, 120.0, 50.0, 140.0, 80.0, 0.0, 150.0, 50.0, 50.0, 100.0, 127.0, 46.0, 60.0, 100.0, 30.0, 180.0, 90.0, 100.0, 160.0, 140.0, 110.0, 70.0, 131.0, 43.0, 100.0, 100.0, 80.0, 140.0, 100.0, 90.0, 150.0, 130.0, 57.0, 110.0, 130.0, 155.0, 20.0, 110.0, 129.0, 60.0, 130.0, 70.0, 90.0, 24.0, 30.0, 160.0, 89.0, 65.0, 100.0, 0.0, 50.0, 80.0, 150.0, 9.0, 100.0, 130.0, 20.0, 59.0, 120.0, 120.0, 50.0, 60.0, 35.0, 50.0, 130.0, 100.0, 60.0, 20.0, 100.0, 80.0, 75.0, 100.0, 60.0, 50.0, 30.0, 60.0, 140.0, 170.0, 130.0, 90.0, 50.0, 75.0, 110.0, 70.0, 140.0, 40.0, 80.0, 110.0, 154.0, 160.0, 60.0, 90.0, 49.0, 40.0, 70.0, 180.0, 57.0, 90.0, 70.0, 110.0, 126.0, 60.0, 130.0, 130.0, 42.0, 60.0, 120.0, 100.0, 138.0, 156.0, 100.0, -13.0, 54.0, 90.0, 67.0, 40.0, 260.0, 110.0, 77.0, 16.0, 100.0, 190.0, 200.0, 140.0, 90.0, 80.0, 110.0, 70.0, 100.0, 60.0, 135.0, 120.0, 80.0, 150.0, 100.0, 115.0, 90.0, 100.0, 280.0, 120.0, 67.0, 70.0, 120.0, 150.0, 120.0, 210.0, -13.0, 70.0, 130.0, 140.0, 50.0, 120.0, 110.0, 200.0, 140.0, 90.0, 190.0, 140.0, 50.0, 120.0, 88.0, 69.0, 100.0, 140.0, 70.0, 200.0, 110.0, 63.0, 150.0, 90.0, 130.0, 90.0, 70.0, 70.0, 70.0, 70.0, 100.0, 230.0, 140.0, 100.0, 140.0, 140.0, 80.0, 130.0, 100.0, 130.0, 110.0, 70.0, 91.0, 130.0, 60.0, 60.0, 130.0, 150.0, 52.0, 90.0, 80.0, 70.0, 90.0, 80.0, 210.0, 70.0, 110.0, 170.0, 270.0, 80.0, 30.0, 140.0, 140.0, 100.0, 120.0, 90.0, 190.0, 130.0, 50.0, 110.0, 80.0, 80.0, 190.0, 240.0, 125.0, 180.0, 140.0, 50.0, 140.0, 120.0, 100.0, 160.0, 110.0, 136.0, 150.0, 56.0, 23.0, 200.0, 30.0, 15.0, 150.0, 40.0, 80.0, 100.0, 70.0, 150.0, 60.0, 200.0, 20.0, 180.0, 100.0, 40.0, 79.0, 70.0, 70.0, 50.0, 140.0, 90.0, 80.0, 80.0, 40.0, 130.0, 70.0, 56.0, 220.0, 100.0, 110.0, 185.0, 23.0, 130.0, 10.0, 11.0, 150.0, 95.0, 30.0, 90.0, 108.0, 130.0, 80.0, 130.0, 35.0, 50.0, 85.0, 70.0, 100.0, 140.0, 110.0, 100.0, 90.0, 110.0, 110.0, 100.0, 120.0, 105.0, 70.0, 100.0, 156.0, 160.0, 110.0, 75.0, 20.0, 80.0, 100.0, 100.0, 62.0, 28.0, 130.0, 59.0, 75.0, 90.0, 150.0, 80.0, 29.0, 30.0, 9.0, 120.0, 50.0, 219.0, 30.0, 110.0, 40.0, 30.0, 90.0, 130.0, 110.0, 100.0, 150.0, 100.0, 130.0, 210.0, -35.0, 80.0, 170.0, 140.0, 155.0, 60.0, 100.0, 90.0, 160.0, 140.0, 60.0, 100.0, 200.0, 180.0, 110.0, 140.0, 20.0, 40.0, 70.0, 60.0, 90.0, 115.0, 90.0, 150.0, 60.0, 80.0, 60.0, 50.0, 80.0, 80.0, 205.0, 90.0, 150.0, 150.0, 100.0, 40.0, 70.0, 130.0, 160.0, 120.0, 140.0, 90.0, 112.0, 70.0, 128.0, 190.0, 90.0, 130.0, 23.0, 190.0, 40.0, 120.0, 62.0, 67.0, 70.0, 230.0, 48.0, 55.0, 60.0, 210.0, 80.0, 70.0, 110.0, 60.0, 130.0, 120.0, 100.0, 100.0, 70.0, 130.0, 80.0, 120.0, 80.0, 50.0, 70.0, 120.0, 100.0, 170.0, 90.0, 90.0, 60.0, 60.0, 220.0, 80.0, 100.0, 209.0, 90.0, 30.0, 110.0, 170.0, 180.0, 110.0, 50.0, 19.0, 0.0, 20.0, 40.0, 30.0, 130.0, 20.0, 160.0, 10.0, 220.0, 210.0, 55.0, 10.0, 110.0, 40.0, 66.0, 20.0, 120.0, 135.0, 70.0, 100.0, 170.0, 80.0, 100.0, 90.0, 100.0, 58.0, 110.0, 60.0, 110.0, 60.0, 58.0, 149.0, 190.0, 120.0, 96.0, 88.0, 54.0, 90.0, 59.0, 36.0, 120.0, 136.0, 70.0, 43.0, 5.0, 90.0, 100.0, 110.0, 63.0, 140.0, 140.0, 90.0, 140.0, 100.0, 70.0, 63.0, 100.0, 120.0, 120.0, 90.0, 90.0, 110.0, 90.0, 190.0, 130.0, 90.0, 60.0, 100.0, 47.0, 110.0, 50.0, 40.0, 200.0, 50.0, 32.0, 80.0, 49.0, 100.0, 49.0, 97.0, 200.0, 90.0, 120.0, 43.0, 130.0, 160.0, 38.0, 56.0, 140.0, 110.0, 110.0, 150.0, 130.0, 90.0, 120.0, 190.0, 70.0, 110.0, 230.0, 200.0, 89.0, 79.0, 200.0, 90.0, 80.0, 140.0, 70.0, 120.0, 100.0, 190.0, 120.0, 40.0, 150.0, 60.0, 150.0, 130.0, 130.0, 30.0, 110.0, 160.0, 90.0, 150.0, 110.0, 60.0, 80.0, 70.0, 100.0, 60.0, 80.0, 60.0, 80.0, 60.0, 110.0, 160.0, 110.0, 180.0, 25.0, 5.0, 150.0, 157.0, 81.0, 210.0, 90.0, 63.0, 80.0, 66.0, 34.0, 160.0, 80.0, 120.0, 210.0, 85.0, 100.0, 160.0, 70.0, 80.0, 130.0, 115.0, 90.0, 90.0, 180.0, 70.0, 150.0, 130.0, 140.0, 160.0, 100.0, 110.0, 120.0, 140.0, 220.0, 272.0, 190.0, 133.0, 70.0, 85.0, 200.0, 270.0, 70.0, 90.0, 79.0, 90.0, 79.0, 100.0, 90.0, 119.0, 240.0, 48.0, 100.0, 55.0, 50.0, 210.0, 104.0, 50.0, 40.0, 59.0, 200.0, 88.0, 70.0, 8.0, 25.0, 40.0, 80.0, 200.0, 70.0, 23.0, 50.0, 250.0, 120.0, 70.0, 90.0, 150.0, 98.0, 180.0, 59.0, 117.0, 160.0, 60.0, 40.0, 70.0, 30.0, 47.0, 50.0, 130.0, 70.0, 160.0, 106.0, 80.0, 80.0, 80.0, 80.0, 82.0, 90.0, 50.0, 10.0, 70.0, 80.0, 90.0, 80.0, 55.0, 75.0, 6.0, 0.0, 40.0, 30.0, -39.0, 97.0, 60.0, 19.0, 110.0, 50.0, 130.0, 43.0, 80.0, 50.0, 110.0, 39.0, 41.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6635611525413732, "mean_inference_ms": 1.664692463036109, "mean_action_processing_ms": 0.507309545724428, "mean_env_wait_ms": 1.140842591710893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012046575546264648, "StateBufferConnector_ms": 0.008758544921875, "ViewRequirementAgentConnector_ms": 0.3671529293060303}, "num_episodes": 18, "episode_return_max": 1700.0, "episode_return_min": 404.0, "episode_return_mean": 985.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.668900580941024, "num_env_steps_trained_throughput_per_sec": 20.668900580941024, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 4640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4640000, "timers": {"training_iteration_time_ms": 193233.048, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193233.005, "sample_time_ms": 2484.085, "learn_time_ms": 190730.243, "learn_throughput": 20.972, "synch_weights_time_ms": 10.308}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "done": false, "training_iteration": 116, "trial_id": "1841f_00000", "date": "2024-08-08_05-57-12", "timestamp": 1723111032, "time_this_iter_s": 193.53901386260986, "time_total_s": 23816.131942749023, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b33b1160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23816.131942749023, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 17.29157509157509, "ram_util_percent": 76.72783882783882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3817272841295622, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.595740563267716, "policy_loss": -0.015869940484921557, "vf_loss": 8.610057036335856, "vf_explained_var": 0.0003525671105796156, "kl": 0.007767295324537234, "entropy": 0.500035836965766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1093935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "env_runners": {"episode_reward_max": 1700.0, "episode_reward_min": 404.0, "episode_reward_mean": 1001.44, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -39.0}, "policy_reward_max": {"policy_0": 320.0}, "policy_reward_mean": {"policy_0": 100.144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1160.0, 762.0, 730.0, 1185.0, 1015.0, 952.0, 1093.0, 1359.0, 1089.0, 798.0, 980.0, 883.0, 1074.0, 1052.0, 847.0, 698.0, 745.0, 865.0, 895.0, 950.0, 948.0, 1002.0, 1073.0, 1050.0, 1194.0, 1310.0, 1010.0, 1070.0, 1140.0, 913.0, 1250.0, 1090.0, 1445.0, 910.0, 1000.0, 829.0, 915.0, 898.0, 1015.0, 996.0, 874.0, 667.0, 1065.0, 1175.0, 1025.0, 945.0, 1150.0, 1093.0, 952.0, 1020.0, 890.0, 1299.0, 479.0, 986.0, 938.0, 1015.0, 769.0, 1026.0, 1070.0, 758.0, 983.0, 1220.0, 1298.0, 1100.0, 990.0, 870.0, 1091.0, 1150.0, 1220.0, 1700.0, 1005.0, 956.0, 816.0, 1104.0, 783.0, 712.0, 404.0, 672.0, 940.0, 850.0, 968.0, 1305.0, 844.0, 820.0, 1229.0, 900.0, 720.0, 1007.0, 1630.0, 1180.0, 1223.0, 820.0, 1020.0, 859.0, 975.0, 1246.0, 1168.0, 750.0, 1000.0, 1230.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 100.0, 50.0, 100.0, 80.0, 120.0, 100.0, 150.0, 140.0, 140.0, 70.0, 62.0, 34.0, 155.0, 80.0, 98.0, 39.0, 0.0, 104.0, 120.0, 50.0, 60.0, 120.0, 10.0, 60.0, 210.0, 55.0, 0.0, 100.0, 65.0, 130.0, 110.0, 190.0, 110.0, -15.0, 130.0, 140.0, 130.0, 210.0, 50.0, 90.0, 75.0, 170.0, 110.0, 100.0, 100.0, 60.0, 120.0, 90.0, 100.0, 50.0, 77.0, 110.0, 160.0, 60.0, 215.0, 50.0, 50.0, 130.0, 50.0, 64.0, 127.0, 130.0, 79.0, 99.0, 130.0, 60.0, 120.0, 94.0, 190.0, 59.0, 140.0, 180.0, 110.0, 190.0, 140.0, 90.0, 140.0, 210.0, 100.0, 230.0, 110.0, 99.0, 216.0, 137.0, 58.0, 40.0, 9.0, 140.0, 50.0, 50.0, 120.0, 15.0, 150.0, 60.0, 100.0, 110.0, 60.0, 140.0, -7.0, 160.0, 120.0, 110.0, 120.0, 50.0, 140.0, 80.0, 0.0, 150.0, 50.0, 50.0, 100.0, 127.0, 46.0, 60.0, 100.0, 30.0, 180.0, 90.0, 100.0, 160.0, 140.0, 110.0, 70.0, 131.0, 43.0, 100.0, 100.0, 80.0, 140.0, 100.0, 90.0, 150.0, 130.0, 57.0, 110.0, 130.0, 155.0, 20.0, 110.0, 129.0, 60.0, 130.0, 70.0, 90.0, 24.0, 30.0, 160.0, 89.0, 65.0, 100.0, 0.0, 50.0, 80.0, 150.0, 9.0, 100.0, 130.0, 20.0, 59.0, 120.0, 120.0, 50.0, 60.0, 35.0, 50.0, 130.0, 100.0, 60.0, 20.0, 100.0, 80.0, 75.0, 100.0, 60.0, 50.0, 30.0, 60.0, 140.0, 170.0, 130.0, 90.0, 50.0, 75.0, 110.0, 70.0, 140.0, 40.0, 80.0, 110.0, 154.0, 160.0, 60.0, 90.0, 49.0, 40.0, 70.0, 180.0, 57.0, 90.0, 70.0, 110.0, 126.0, 60.0, 130.0, 130.0, 42.0, 60.0, 120.0, 100.0, 138.0, 156.0, 100.0, -13.0, 54.0, 90.0, 67.0, 40.0, 260.0, 110.0, 77.0, 16.0, 100.0, 190.0, 200.0, 140.0, 90.0, 80.0, 110.0, 70.0, 100.0, 60.0, 135.0, 120.0, 80.0, 150.0, 100.0, 115.0, 90.0, 100.0, 280.0, 120.0, 67.0, 70.0, 120.0, 150.0, 120.0, 210.0, -13.0, 70.0, 130.0, 140.0, 50.0, 120.0, 110.0, 200.0, 140.0, 90.0, 190.0, 140.0, 50.0, 120.0, 88.0, 69.0, 100.0, 140.0, 70.0, 200.0, 110.0, 63.0, 150.0, 90.0, 130.0, 90.0, 70.0, 70.0, 70.0, 70.0, 100.0, 230.0, 140.0, 100.0, 140.0, 140.0, 80.0, 130.0, 100.0, 130.0, 110.0, 70.0, 91.0, 130.0, 60.0, 60.0, 130.0, 150.0, 52.0, 90.0, 80.0, 70.0, 90.0, 80.0, 210.0, 70.0, 110.0, 170.0, 270.0, 80.0, 30.0, 140.0, 140.0, 100.0, 120.0, 90.0, 190.0, 130.0, 50.0, 110.0, 80.0, 80.0, 190.0, 240.0, 125.0, 180.0, 140.0, 50.0, 140.0, 120.0, 100.0, 160.0, 110.0, 136.0, 150.0, 56.0, 23.0, 200.0, 30.0, 15.0, 150.0, 40.0, 80.0, 100.0, 70.0, 150.0, 60.0, 200.0, 20.0, 180.0, 100.0, 40.0, 79.0, 70.0, 70.0, 50.0, 140.0, 90.0, 80.0, 80.0, 40.0, 130.0, 70.0, 56.0, 220.0, 100.0, 110.0, 185.0, 23.0, 130.0, 10.0, 11.0, 150.0, 95.0, 30.0, 90.0, 108.0, 130.0, 80.0, 130.0, 35.0, 50.0, 85.0, 70.0, 100.0, 140.0, 110.0, 100.0, 90.0, 110.0, 110.0, 100.0, 120.0, 105.0, 70.0, 100.0, 156.0, 160.0, 110.0, 75.0, 20.0, 80.0, 100.0, 100.0, 62.0, 28.0, 130.0, 59.0, 75.0, 90.0, 150.0, 80.0, 29.0, 30.0, 9.0, 120.0, 50.0, 219.0, 30.0, 110.0, 40.0, 30.0, 90.0, 130.0, 110.0, 100.0, 150.0, 100.0, 130.0, 210.0, -35.0, 80.0, 170.0, 140.0, 155.0, 60.0, 100.0, 90.0, 160.0, 140.0, 60.0, 100.0, 200.0, 180.0, 110.0, 140.0, 20.0, 40.0, 70.0, 60.0, 90.0, 115.0, 90.0, 150.0, 60.0, 80.0, 60.0, 50.0, 80.0, 80.0, 205.0, 90.0, 150.0, 150.0, 100.0, 40.0, 70.0, 130.0, 160.0, 120.0, 140.0, 90.0, 112.0, 70.0, 128.0, 190.0, 90.0, 130.0, 23.0, 190.0, 40.0, 120.0, 62.0, 67.0, 70.0, 230.0, 48.0, 55.0, 60.0, 210.0, 80.0, 70.0, 110.0, 60.0, 130.0, 120.0, 100.0, 100.0, 70.0, 130.0, 80.0, 120.0, 80.0, 50.0, 70.0, 120.0, 100.0, 170.0, 90.0, 90.0, 60.0, 60.0, 220.0, 80.0, 100.0, 209.0, 90.0, 30.0, 110.0, 170.0, 180.0, 110.0, 50.0, 19.0, 0.0, 20.0, 40.0, 30.0, 130.0, 20.0, 160.0, 10.0, 220.0, 210.0, 55.0, 10.0, 110.0, 40.0, 66.0, 20.0, 120.0, 135.0, 70.0, 100.0, 170.0, 80.0, 100.0, 90.0, 100.0, 58.0, 110.0, 60.0, 110.0, 60.0, 58.0, 149.0, 190.0, 120.0, 96.0, 88.0, 54.0, 90.0, 59.0, 36.0, 120.0, 136.0, 70.0, 43.0, 5.0, 90.0, 100.0, 110.0, 63.0, 140.0, 140.0, 90.0, 140.0, 100.0, 70.0, 63.0, 100.0, 120.0, 120.0, 90.0, 90.0, 110.0, 90.0, 190.0, 130.0, 90.0, 60.0, 100.0, 47.0, 110.0, 50.0, 40.0, 200.0, 50.0, 32.0, 80.0, 49.0, 100.0, 49.0, 97.0, 200.0, 90.0, 120.0, 43.0, 130.0, 160.0, 38.0, 56.0, 140.0, 110.0, 110.0, 150.0, 130.0, 90.0, 120.0, 190.0, 70.0, 110.0, 230.0, 200.0, 89.0, 79.0, 200.0, 90.0, 80.0, 140.0, 70.0, 120.0, 100.0, 190.0, 120.0, 40.0, 150.0, 60.0, 150.0, 130.0, 130.0, 30.0, 110.0, 160.0, 90.0, 150.0, 110.0, 60.0, 80.0, 70.0, 100.0, 60.0, 80.0, 60.0, 80.0, 60.0, 110.0, 160.0, 110.0, 180.0, 25.0, 5.0, 150.0, 157.0, 81.0, 210.0, 90.0, 63.0, 80.0, 66.0, 34.0, 160.0, 80.0, 120.0, 210.0, 85.0, 100.0, 160.0, 70.0, 80.0, 130.0, 115.0, 90.0, 90.0, 180.0, 70.0, 150.0, 130.0, 140.0, 160.0, 100.0, 110.0, 120.0, 140.0, 220.0, 272.0, 190.0, 133.0, 70.0, 85.0, 200.0, 270.0, 70.0, 90.0, 79.0, 90.0, 79.0, 100.0, 90.0, 119.0, 240.0, 48.0, 100.0, 55.0, 50.0, 210.0, 104.0, 50.0, 40.0, 59.0, 200.0, 88.0, 70.0, 8.0, 25.0, 40.0, 80.0, 200.0, 70.0, 23.0, 50.0, 250.0, 120.0, 70.0, 90.0, 150.0, 98.0, 180.0, 59.0, 117.0, 160.0, 60.0, 40.0, 70.0, 30.0, 47.0, 50.0, 130.0, 70.0, 160.0, 106.0, 80.0, 80.0, 80.0, 80.0, 82.0, 90.0, 50.0, 10.0, 70.0, 80.0, 90.0, 80.0, 55.0, 75.0, 6.0, 0.0, 40.0, 30.0, -39.0, 97.0, 60.0, 19.0, 110.0, 50.0, 130.0, 43.0, 80.0, 50.0, 110.0, 39.0, 41.0, 50.0, 130.0, 70.0, 80.0, 50.0, 140.0, 90.0, 80.0, 150.0, 100.0, 150.0, 100.0, 80.0, 100.0, 120.0, 110.0, 40.0, 20.0, 40.0, 90.0, 100.0, 70.0, 120.0, 72.0, 180.0, 73.0, 43.0, 90.0, 140.0, 80.0, 100.0, 210.0, 100.0, 90.0, 25.0, 150.0, 290.0, 120.0, 100.0, 120.0, 50.0, 80.0, 110.0, 82.0, 80.0, 80.0, 130.0, 110.0, 40.0, 82.0, 40.0, 60.0, 140.0, 120.0, 190.0, 100.0, 70.0, 40.0, 30.0, 30.0, 107.0, 122.0, 70.0, 130.0, 110.0, 140.0, 100.0, 100.0, 220.0, 130.0, 104.0, 50.0, 110.0, 50.0, 100.0, 160.0, 120.0, 52.0, 44.0, 110.0, 80.0, 20.0, 120.0, 50.0, 110.0, 80.0, 50.0, 50.0, 60.0, 100.0, 60.0, 180.0, 140.0, 150.0, 120.0, 70.0, 70.0, 47.0, 150.0, 20.0, 120.0, 190.0, 130.0, 100.0, 230.0, 70.0, 190.0, 190.0, 190.0, 220.0, 170.0, 150.0, 120.0, 40.0, 120.0, 80.0, 120.0, 130.0, 110.0, 140.0, 129.0, 170.0, 155.0, 140.0, 59.0, 120.0, 80.0, 110.0, 130.0, 130.0, 50.0, 60.0, 100.0, 50.0, 50.0, 120.0, 130.0, 50.0, 120.0, 90.0, 80.0, 140.0, 120.0, 110.0, 130.0, 90.0, 140.0, 90.0, 60.0, 60.0, 100.0, 100.0, 120.0, 40.0, 60.0, 60.0, 89.0, 140.0, 80.0, 70.0, 80.0, 70.0, 70.0, 100.0, 200.0, 70.0, 85.0, 40.0, 140.0, 120.0, 170.0, 320.0, 191.0, 55.0, 90.0, 100.0, 140.0, 30.0, 100.0, 50.0, 119.0, 100.0, 100.0, 180.0, 200.0, 89.0, 60.0, 100.0, 110.0, 110.0, 130.0, 90.0, 30.0, 110.0, 60.0, 0.0, 60.0, 50.0, 160.0, 60.0, 90.0, 80.0, 50.0, 150.0, 70.0, 150.0, 140.0, 70.0, 140.0, 60.0, 190.0, 50.0, 110.0, 90.0, 130.0, 130.0, 170.0, 120.0, 150.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6615643780224862, "mean_inference_ms": 1.6629676013913877, "mean_action_processing_ms": 0.5067675298387457, "mean_env_wait_ms": 1.1392888281294744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011981964111328125, "StateBufferConnector_ms": 0.008896350860595703, "ViewRequirementAgentConnector_ms": 0.3645133972167969}, "num_episodes": 22, "episode_return_max": 1700.0, "episode_return_min": 404.0, "episode_return_mean": 1001.44}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.50316918185428, "num_env_steps_trained_throughput_per_sec": 20.50316918185428, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 4680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4680000, "timers": {"training_iteration_time_ms": 193409.405, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193409.361, "sample_time_ms": 2484.987, "learn_time_ms": 190906.022, "learn_throughput": 20.953, "synch_weights_time_ms": 10.008}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "done": false, "training_iteration": 117, "trial_id": "1841f_00000", "date": "2024-08-08_06-00-28", "timestamp": 1723111228, "time_this_iter_s": 195.10446286201477, "time_total_s": 24011.23640561104, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b296b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24011.23640561104, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 19.967753623188408, "ram_util_percent": 77.22608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.443598947300317, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.350176490076814, "policy_loss": -0.016151808355057154, "vf_loss": 8.364752883322069, "vf_explained_var": 0.0012276653474131332, "kl": 0.007877087734755804, "entropy": 0.5320814164016193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1103325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "env_runners": {"episode_reward_max": 1700.0, "episode_reward_min": 404.0, "episode_reward_mean": 1003.81, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -75.0}, "policy_reward_max": {"policy_0": 320.0}, "policy_reward_mean": {"policy_0": 100.381}, "custom_metrics": {}, "hist_stats": {"episode_reward": [895.0, 950.0, 948.0, 1002.0, 1073.0, 1050.0, 1194.0, 1310.0, 1010.0, 1070.0, 1140.0, 913.0, 1250.0, 1090.0, 1445.0, 910.0, 1000.0, 829.0, 915.0, 898.0, 1015.0, 996.0, 874.0, 667.0, 1065.0, 1175.0, 1025.0, 945.0, 1150.0, 1093.0, 952.0, 1020.0, 890.0, 1299.0, 479.0, 986.0, 938.0, 1015.0, 769.0, 1026.0, 1070.0, 758.0, 983.0, 1220.0, 1298.0, 1100.0, 990.0, 870.0, 1091.0, 1150.0, 1220.0, 1700.0, 1005.0, 956.0, 816.0, 1104.0, 783.0, 712.0, 404.0, 672.0, 940.0, 850.0, 968.0, 1305.0, 844.0, 820.0, 1229.0, 900.0, 720.0, 1007.0, 1630.0, 1180.0, 1223.0, 820.0, 1020.0, 859.0, 975.0, 1246.0, 1168.0, 750.0, 1000.0, 1230.0, 1102.0, 867.0, 1133.0, 611.0, 764.0, 1140.0, 1161.0, 1000.0, 1140.0, 565.0, 977.0, 1105.0, 874.0, 1290.0, 830.0, 900.0, 1060.0, 1005.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 90.0, 50.0, 75.0, 110.0, 70.0, 140.0, 40.0, 80.0, 110.0, 154.0, 160.0, 60.0, 90.0, 49.0, 40.0, 70.0, 180.0, 57.0, 90.0, 70.0, 110.0, 126.0, 60.0, 130.0, 130.0, 42.0, 60.0, 120.0, 100.0, 138.0, 156.0, 100.0, -13.0, 54.0, 90.0, 67.0, 40.0, 260.0, 110.0, 77.0, 16.0, 100.0, 190.0, 200.0, 140.0, 90.0, 80.0, 110.0, 70.0, 100.0, 60.0, 135.0, 120.0, 80.0, 150.0, 100.0, 115.0, 90.0, 100.0, 280.0, 120.0, 67.0, 70.0, 120.0, 150.0, 120.0, 210.0, -13.0, 70.0, 130.0, 140.0, 50.0, 120.0, 110.0, 200.0, 140.0, 90.0, 190.0, 140.0, 50.0, 120.0, 88.0, 69.0, 100.0, 140.0, 70.0, 200.0, 110.0, 63.0, 150.0, 90.0, 130.0, 90.0, 70.0, 70.0, 70.0, 70.0, 100.0, 230.0, 140.0, 100.0, 140.0, 140.0, 80.0, 130.0, 100.0, 130.0, 110.0, 70.0, 91.0, 130.0, 60.0, 60.0, 130.0, 150.0, 52.0, 90.0, 80.0, 70.0, 90.0, 80.0, 210.0, 70.0, 110.0, 170.0, 270.0, 80.0, 30.0, 140.0, 140.0, 100.0, 120.0, 90.0, 190.0, 130.0, 50.0, 110.0, 80.0, 80.0, 190.0, 240.0, 125.0, 180.0, 140.0, 50.0, 140.0, 120.0, 100.0, 160.0, 110.0, 136.0, 150.0, 56.0, 23.0, 200.0, 30.0, 15.0, 150.0, 40.0, 80.0, 100.0, 70.0, 150.0, 60.0, 200.0, 20.0, 180.0, 100.0, 40.0, 79.0, 70.0, 70.0, 50.0, 140.0, 90.0, 80.0, 80.0, 40.0, 130.0, 70.0, 56.0, 220.0, 100.0, 110.0, 185.0, 23.0, 130.0, 10.0, 11.0, 150.0, 95.0, 30.0, 90.0, 108.0, 130.0, 80.0, 130.0, 35.0, 50.0, 85.0, 70.0, 100.0, 140.0, 110.0, 100.0, 90.0, 110.0, 110.0, 100.0, 120.0, 105.0, 70.0, 100.0, 156.0, 160.0, 110.0, 75.0, 20.0, 80.0, 100.0, 100.0, 62.0, 28.0, 130.0, 59.0, 75.0, 90.0, 150.0, 80.0, 29.0, 30.0, 9.0, 120.0, 50.0, 219.0, 30.0, 110.0, 40.0, 30.0, 90.0, 130.0, 110.0, 100.0, 150.0, 100.0, 130.0, 210.0, -35.0, 80.0, 170.0, 140.0, 155.0, 60.0, 100.0, 90.0, 160.0, 140.0, 60.0, 100.0, 200.0, 180.0, 110.0, 140.0, 20.0, 40.0, 70.0, 60.0, 90.0, 115.0, 90.0, 150.0, 60.0, 80.0, 60.0, 50.0, 80.0, 80.0, 205.0, 90.0, 150.0, 150.0, 100.0, 40.0, 70.0, 130.0, 160.0, 120.0, 140.0, 90.0, 112.0, 70.0, 128.0, 190.0, 90.0, 130.0, 23.0, 190.0, 40.0, 120.0, 62.0, 67.0, 70.0, 230.0, 48.0, 55.0, 60.0, 210.0, 80.0, 70.0, 110.0, 60.0, 130.0, 120.0, 100.0, 100.0, 70.0, 130.0, 80.0, 120.0, 80.0, 50.0, 70.0, 120.0, 100.0, 170.0, 90.0, 90.0, 60.0, 60.0, 220.0, 80.0, 100.0, 209.0, 90.0, 30.0, 110.0, 170.0, 180.0, 110.0, 50.0, 19.0, 0.0, 20.0, 40.0, 30.0, 130.0, 20.0, 160.0, 10.0, 220.0, 210.0, 55.0, 10.0, 110.0, 40.0, 66.0, 20.0, 120.0, 135.0, 70.0, 100.0, 170.0, 80.0, 100.0, 90.0, 100.0, 58.0, 110.0, 60.0, 110.0, 60.0, 58.0, 149.0, 190.0, 120.0, 96.0, 88.0, 54.0, 90.0, 59.0, 36.0, 120.0, 136.0, 70.0, 43.0, 5.0, 90.0, 100.0, 110.0, 63.0, 140.0, 140.0, 90.0, 140.0, 100.0, 70.0, 63.0, 100.0, 120.0, 120.0, 90.0, 90.0, 110.0, 90.0, 190.0, 130.0, 90.0, 60.0, 100.0, 47.0, 110.0, 50.0, 40.0, 200.0, 50.0, 32.0, 80.0, 49.0, 100.0, 49.0, 97.0, 200.0, 90.0, 120.0, 43.0, 130.0, 160.0, 38.0, 56.0, 140.0, 110.0, 110.0, 150.0, 130.0, 90.0, 120.0, 190.0, 70.0, 110.0, 230.0, 200.0, 89.0, 79.0, 200.0, 90.0, 80.0, 140.0, 70.0, 120.0, 100.0, 190.0, 120.0, 40.0, 150.0, 60.0, 150.0, 130.0, 130.0, 30.0, 110.0, 160.0, 90.0, 150.0, 110.0, 60.0, 80.0, 70.0, 100.0, 60.0, 80.0, 60.0, 80.0, 60.0, 110.0, 160.0, 110.0, 180.0, 25.0, 5.0, 150.0, 157.0, 81.0, 210.0, 90.0, 63.0, 80.0, 66.0, 34.0, 160.0, 80.0, 120.0, 210.0, 85.0, 100.0, 160.0, 70.0, 80.0, 130.0, 115.0, 90.0, 90.0, 180.0, 70.0, 150.0, 130.0, 140.0, 160.0, 100.0, 110.0, 120.0, 140.0, 220.0, 272.0, 190.0, 133.0, 70.0, 85.0, 200.0, 270.0, 70.0, 90.0, 79.0, 90.0, 79.0, 100.0, 90.0, 119.0, 240.0, 48.0, 100.0, 55.0, 50.0, 210.0, 104.0, 50.0, 40.0, 59.0, 200.0, 88.0, 70.0, 8.0, 25.0, 40.0, 80.0, 200.0, 70.0, 23.0, 50.0, 250.0, 120.0, 70.0, 90.0, 150.0, 98.0, 180.0, 59.0, 117.0, 160.0, 60.0, 40.0, 70.0, 30.0, 47.0, 50.0, 130.0, 70.0, 160.0, 106.0, 80.0, 80.0, 80.0, 80.0, 82.0, 90.0, 50.0, 10.0, 70.0, 80.0, 90.0, 80.0, 55.0, 75.0, 6.0, 0.0, 40.0, 30.0, -39.0, 97.0, 60.0, 19.0, 110.0, 50.0, 130.0, 43.0, 80.0, 50.0, 110.0, 39.0, 41.0, 50.0, 130.0, 70.0, 80.0, 50.0, 140.0, 90.0, 80.0, 150.0, 100.0, 150.0, 100.0, 80.0, 100.0, 120.0, 110.0, 40.0, 20.0, 40.0, 90.0, 100.0, 70.0, 120.0, 72.0, 180.0, 73.0, 43.0, 90.0, 140.0, 80.0, 100.0, 210.0, 100.0, 90.0, 25.0, 150.0, 290.0, 120.0, 100.0, 120.0, 50.0, 80.0, 110.0, 82.0, 80.0, 80.0, 130.0, 110.0, 40.0, 82.0, 40.0, 60.0, 140.0, 120.0, 190.0, 100.0, 70.0, 40.0, 30.0, 30.0, 107.0, 122.0, 70.0, 130.0, 110.0, 140.0, 100.0, 100.0, 220.0, 130.0, 104.0, 50.0, 110.0, 50.0, 100.0, 160.0, 120.0, 52.0, 44.0, 110.0, 80.0, 20.0, 120.0, 50.0, 110.0, 80.0, 50.0, 50.0, 60.0, 100.0, 60.0, 180.0, 140.0, 150.0, 120.0, 70.0, 70.0, 47.0, 150.0, 20.0, 120.0, 190.0, 130.0, 100.0, 230.0, 70.0, 190.0, 190.0, 190.0, 220.0, 170.0, 150.0, 120.0, 40.0, 120.0, 80.0, 120.0, 130.0, 110.0, 140.0, 129.0, 170.0, 155.0, 140.0, 59.0, 120.0, 80.0, 110.0, 130.0, 130.0, 50.0, 60.0, 100.0, 50.0, 50.0, 120.0, 130.0, 50.0, 120.0, 90.0, 80.0, 140.0, 120.0, 110.0, 130.0, 90.0, 140.0, 90.0, 60.0, 60.0, 100.0, 100.0, 120.0, 40.0, 60.0, 60.0, 89.0, 140.0, 80.0, 70.0, 80.0, 70.0, 70.0, 100.0, 200.0, 70.0, 85.0, 40.0, 140.0, 120.0, 170.0, 320.0, 191.0, 55.0, 90.0, 100.0, 140.0, 30.0, 100.0, 50.0, 119.0, 100.0, 100.0, 180.0, 200.0, 89.0, 60.0, 100.0, 110.0, 110.0, 130.0, 90.0, 30.0, 110.0, 60.0, 0.0, 60.0, 50.0, 160.0, 60.0, 90.0, 80.0, 50.0, 150.0, 70.0, 150.0, 140.0, 70.0, 140.0, 60.0, 190.0, 50.0, 110.0, 90.0, 130.0, 130.0, 170.0, 120.0, 150.0, 90.0, 60.0, 130.0, 88.0, 110.0, 230.0, 100.0, 170.0, 120.0, 20.0, 74.0, 80.0, 140.0, 150.0, 60.0, 79.0, 60.0, 30.0, 48.0, 140.0, 80.0, 100.0, 100.0, 137.0, 130.0, 230.0, 110.0, 140.0, 41.0, 35.0, 110.0, 32.0, 53.0, 40.0, 163.0, 60.0, 30.0, 100.0, 13.0, 10.0, 110.0, 79.0, 78.0, 70.0, 80.0, 80.0, 80.0, 28.0, 90.0, 89.0, 90.0, 90.0, 90.0, 140.0, 160.0, 130.0, 140.0, 70.0, 140.0, 50.0, 130.0, 124.0, 190.0, 70.0, 110.0, 130.0, 100.0, 160.0, 37.0, 90.0, 150.0, 90.0, 160.0, 100.0, 100.0, 80.0, 100.0, 110.0, 80.0, 90.0, 90.0, 140.0, 50.0, 120.0, 180.0, 60.0, 130.0, 120.0, 170.0, 50.0, 120.0, -11.0, 60.0, 70.0, 39.0, 37.0, 130.0, 40.0, 20.0, 30.0, 150.0, 100.0, 110.0, 60.0, 167.0, 140.0, 98.0, 110.0, 72.0, 70.0, 50.0, 70.0, 134.0, 211.0, 120.0, 100.0, 70.0, 30.0, 200.0, 60.0, 110.0, 130.0, 80.0, -75.0, 200.0, 190.0, 80.0, 120.0, 130.0, 70.0, -51.0, 100.0, 150.0, 120.0, 130.0, 110.0, 150.0, 90.0, 150.0, 140.0, 150.0, 90.0, 120.0, 80.0, 80.0, 90.0, 80.0, 73.0, 67.0, 110.0, 40.0, 200.0, 80.0, 60.0, 120.0, 210.0, 70.0, 20.0, 80.0, 20.0, 40.0, 80.0, 120.0, 100.0, 150.0, 90.0, 70.0, 100.0, 130.0, 120.0, 100.0, 210.0, 70.0, 95.0, 120.0, 40.0, 100.0, 100.0, 60.0, 140.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6583652356024254, "mean_inference_ms": 1.6591480082401222, "mean_action_processing_ms": 0.506146901621158, "mean_env_wait_ms": 1.1384240968543018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011492490768432617, "StateBufferConnector_ms": 0.008777379989624023, "ViewRequirementAgentConnector_ms": 0.3639230728149414}, "num_episodes": 18, "episode_return_max": 1700.0, "episode_return_min": 404.0, "episode_return_mean": 1003.81}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.66385770816022, "num_env_steps_trained_throughput_per_sec": 20.66385770816022, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 4720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4720000, "timers": {"training_iteration_time_ms": 193470.277, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193470.233, "sample_time_ms": 2502.326, "learn_time_ms": 190949.341, "learn_throughput": 20.948, "synch_weights_time_ms": 10.223}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "done": false, "training_iteration": 118, "trial_id": "1841f_00000", "date": "2024-08-08_06-03-41", "timestamp": 1723111421, "time_this_iter_s": 193.58487915992737, "time_total_s": 24204.821284770966, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b296bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24204.821284770966, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 17.05839416058394, "ram_util_percent": 77.33759124087591}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5553426453163324, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.016753843542871773, "vf_loss": 8.630091508026448, "vf_explained_var": 0.0025276208837954, "kl": Infinity, "entropy": 0.5016635665084861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1112715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "env_runners": {"episode_reward_max": 1700.0, "episode_reward_min": 404.0, "episode_reward_mean": 988.66, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -75.0}, "policy_reward_max": {"policy_0": 320.0}, "policy_reward_mean": {"policy_0": 98.866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [915.0, 898.0, 1015.0, 996.0, 874.0, 667.0, 1065.0, 1175.0, 1025.0, 945.0, 1150.0, 1093.0, 952.0, 1020.0, 890.0, 1299.0, 479.0, 986.0, 938.0, 1015.0, 769.0, 1026.0, 1070.0, 758.0, 983.0, 1220.0, 1298.0, 1100.0, 990.0, 870.0, 1091.0, 1150.0, 1220.0, 1700.0, 1005.0, 956.0, 816.0, 1104.0, 783.0, 712.0, 404.0, 672.0, 940.0, 850.0, 968.0, 1305.0, 844.0, 820.0, 1229.0, 900.0, 720.0, 1007.0, 1630.0, 1180.0, 1223.0, 820.0, 1020.0, 859.0, 975.0, 1246.0, 1168.0, 750.0, 1000.0, 1230.0, 1102.0, 867.0, 1133.0, 611.0, 764.0, 1140.0, 1161.0, 1000.0, 1140.0, 565.0, 977.0, 1105.0, 874.0, 1290.0, 830.0, 900.0, 1060.0, 1005.0, 580.0, 1031.0, 1254.0, 1110.0, 1055.0, 1230.0, 974.0, 1000.0, 756.0, 892.0, 894.0, 909.0, 835.0, 1180.0, 639.0, 876.0, 1175.0, 1174.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 56.0, 220.0, 100.0, 110.0, 185.0, 23.0, 130.0, 10.0, 11.0, 150.0, 95.0, 30.0, 90.0, 108.0, 130.0, 80.0, 130.0, 35.0, 50.0, 85.0, 70.0, 100.0, 140.0, 110.0, 100.0, 90.0, 110.0, 110.0, 100.0, 120.0, 105.0, 70.0, 100.0, 156.0, 160.0, 110.0, 75.0, 20.0, 80.0, 100.0, 100.0, 62.0, 28.0, 130.0, 59.0, 75.0, 90.0, 150.0, 80.0, 29.0, 30.0, 9.0, 120.0, 50.0, 219.0, 30.0, 110.0, 40.0, 30.0, 90.0, 130.0, 110.0, 100.0, 150.0, 100.0, 130.0, 210.0, -35.0, 80.0, 170.0, 140.0, 155.0, 60.0, 100.0, 90.0, 160.0, 140.0, 60.0, 100.0, 200.0, 180.0, 110.0, 140.0, 20.0, 40.0, 70.0, 60.0, 90.0, 115.0, 90.0, 150.0, 60.0, 80.0, 60.0, 50.0, 80.0, 80.0, 205.0, 90.0, 150.0, 150.0, 100.0, 40.0, 70.0, 130.0, 160.0, 120.0, 140.0, 90.0, 112.0, 70.0, 128.0, 190.0, 90.0, 130.0, 23.0, 190.0, 40.0, 120.0, 62.0, 67.0, 70.0, 230.0, 48.0, 55.0, 60.0, 210.0, 80.0, 70.0, 110.0, 60.0, 130.0, 120.0, 100.0, 100.0, 70.0, 130.0, 80.0, 120.0, 80.0, 50.0, 70.0, 120.0, 100.0, 170.0, 90.0, 90.0, 60.0, 60.0, 220.0, 80.0, 100.0, 209.0, 90.0, 30.0, 110.0, 170.0, 180.0, 110.0, 50.0, 19.0, 0.0, 20.0, 40.0, 30.0, 130.0, 20.0, 160.0, 10.0, 220.0, 210.0, 55.0, 10.0, 110.0, 40.0, 66.0, 20.0, 120.0, 135.0, 70.0, 100.0, 170.0, 80.0, 100.0, 90.0, 100.0, 58.0, 110.0, 60.0, 110.0, 60.0, 58.0, 149.0, 190.0, 120.0, 96.0, 88.0, 54.0, 90.0, 59.0, 36.0, 120.0, 136.0, 70.0, 43.0, 5.0, 90.0, 100.0, 110.0, 63.0, 140.0, 140.0, 90.0, 140.0, 100.0, 70.0, 63.0, 100.0, 120.0, 120.0, 90.0, 90.0, 110.0, 90.0, 190.0, 130.0, 90.0, 60.0, 100.0, 47.0, 110.0, 50.0, 40.0, 200.0, 50.0, 32.0, 80.0, 49.0, 100.0, 49.0, 97.0, 200.0, 90.0, 120.0, 43.0, 130.0, 160.0, 38.0, 56.0, 140.0, 110.0, 110.0, 150.0, 130.0, 90.0, 120.0, 190.0, 70.0, 110.0, 230.0, 200.0, 89.0, 79.0, 200.0, 90.0, 80.0, 140.0, 70.0, 120.0, 100.0, 190.0, 120.0, 40.0, 150.0, 60.0, 150.0, 130.0, 130.0, 30.0, 110.0, 160.0, 90.0, 150.0, 110.0, 60.0, 80.0, 70.0, 100.0, 60.0, 80.0, 60.0, 80.0, 60.0, 110.0, 160.0, 110.0, 180.0, 25.0, 5.0, 150.0, 157.0, 81.0, 210.0, 90.0, 63.0, 80.0, 66.0, 34.0, 160.0, 80.0, 120.0, 210.0, 85.0, 100.0, 160.0, 70.0, 80.0, 130.0, 115.0, 90.0, 90.0, 180.0, 70.0, 150.0, 130.0, 140.0, 160.0, 100.0, 110.0, 120.0, 140.0, 220.0, 272.0, 190.0, 133.0, 70.0, 85.0, 200.0, 270.0, 70.0, 90.0, 79.0, 90.0, 79.0, 100.0, 90.0, 119.0, 240.0, 48.0, 100.0, 55.0, 50.0, 210.0, 104.0, 50.0, 40.0, 59.0, 200.0, 88.0, 70.0, 8.0, 25.0, 40.0, 80.0, 200.0, 70.0, 23.0, 50.0, 250.0, 120.0, 70.0, 90.0, 150.0, 98.0, 180.0, 59.0, 117.0, 160.0, 60.0, 40.0, 70.0, 30.0, 47.0, 50.0, 130.0, 70.0, 160.0, 106.0, 80.0, 80.0, 80.0, 80.0, 82.0, 90.0, 50.0, 10.0, 70.0, 80.0, 90.0, 80.0, 55.0, 75.0, 6.0, 0.0, 40.0, 30.0, -39.0, 97.0, 60.0, 19.0, 110.0, 50.0, 130.0, 43.0, 80.0, 50.0, 110.0, 39.0, 41.0, 50.0, 130.0, 70.0, 80.0, 50.0, 140.0, 90.0, 80.0, 150.0, 100.0, 150.0, 100.0, 80.0, 100.0, 120.0, 110.0, 40.0, 20.0, 40.0, 90.0, 100.0, 70.0, 120.0, 72.0, 180.0, 73.0, 43.0, 90.0, 140.0, 80.0, 100.0, 210.0, 100.0, 90.0, 25.0, 150.0, 290.0, 120.0, 100.0, 120.0, 50.0, 80.0, 110.0, 82.0, 80.0, 80.0, 130.0, 110.0, 40.0, 82.0, 40.0, 60.0, 140.0, 120.0, 190.0, 100.0, 70.0, 40.0, 30.0, 30.0, 107.0, 122.0, 70.0, 130.0, 110.0, 140.0, 100.0, 100.0, 220.0, 130.0, 104.0, 50.0, 110.0, 50.0, 100.0, 160.0, 120.0, 52.0, 44.0, 110.0, 80.0, 20.0, 120.0, 50.0, 110.0, 80.0, 50.0, 50.0, 60.0, 100.0, 60.0, 180.0, 140.0, 150.0, 120.0, 70.0, 70.0, 47.0, 150.0, 20.0, 120.0, 190.0, 130.0, 100.0, 230.0, 70.0, 190.0, 190.0, 190.0, 220.0, 170.0, 150.0, 120.0, 40.0, 120.0, 80.0, 120.0, 130.0, 110.0, 140.0, 129.0, 170.0, 155.0, 140.0, 59.0, 120.0, 80.0, 110.0, 130.0, 130.0, 50.0, 60.0, 100.0, 50.0, 50.0, 120.0, 130.0, 50.0, 120.0, 90.0, 80.0, 140.0, 120.0, 110.0, 130.0, 90.0, 140.0, 90.0, 60.0, 60.0, 100.0, 100.0, 120.0, 40.0, 60.0, 60.0, 89.0, 140.0, 80.0, 70.0, 80.0, 70.0, 70.0, 100.0, 200.0, 70.0, 85.0, 40.0, 140.0, 120.0, 170.0, 320.0, 191.0, 55.0, 90.0, 100.0, 140.0, 30.0, 100.0, 50.0, 119.0, 100.0, 100.0, 180.0, 200.0, 89.0, 60.0, 100.0, 110.0, 110.0, 130.0, 90.0, 30.0, 110.0, 60.0, 0.0, 60.0, 50.0, 160.0, 60.0, 90.0, 80.0, 50.0, 150.0, 70.0, 150.0, 140.0, 70.0, 140.0, 60.0, 190.0, 50.0, 110.0, 90.0, 130.0, 130.0, 170.0, 120.0, 150.0, 90.0, 60.0, 130.0, 88.0, 110.0, 230.0, 100.0, 170.0, 120.0, 20.0, 74.0, 80.0, 140.0, 150.0, 60.0, 79.0, 60.0, 30.0, 48.0, 140.0, 80.0, 100.0, 100.0, 137.0, 130.0, 230.0, 110.0, 140.0, 41.0, 35.0, 110.0, 32.0, 53.0, 40.0, 163.0, 60.0, 30.0, 100.0, 13.0, 10.0, 110.0, 79.0, 78.0, 70.0, 80.0, 80.0, 80.0, 28.0, 90.0, 89.0, 90.0, 90.0, 90.0, 140.0, 160.0, 130.0, 140.0, 70.0, 140.0, 50.0, 130.0, 124.0, 190.0, 70.0, 110.0, 130.0, 100.0, 160.0, 37.0, 90.0, 150.0, 90.0, 160.0, 100.0, 100.0, 80.0, 100.0, 110.0, 80.0, 90.0, 90.0, 140.0, 50.0, 120.0, 180.0, 60.0, 130.0, 120.0, 170.0, 50.0, 120.0, -11.0, 60.0, 70.0, 39.0, 37.0, 130.0, 40.0, 20.0, 30.0, 150.0, 100.0, 110.0, 60.0, 167.0, 140.0, 98.0, 110.0, 72.0, 70.0, 50.0, 70.0, 134.0, 211.0, 120.0, 100.0, 70.0, 30.0, 200.0, 60.0, 110.0, 130.0, 80.0, -75.0, 200.0, 190.0, 80.0, 120.0, 130.0, 70.0, -51.0, 100.0, 150.0, 120.0, 130.0, 110.0, 150.0, 90.0, 150.0, 140.0, 150.0, 90.0, 120.0, 80.0, 80.0, 90.0, 80.0, 73.0, 67.0, 110.0, 40.0, 200.0, 80.0, 60.0, 120.0, 210.0, 70.0, 20.0, 80.0, 20.0, 40.0, 80.0, 120.0, 100.0, 150.0, 90.0, 70.0, 100.0, 130.0, 120.0, 100.0, 210.0, 70.0, 95.0, 120.0, 40.0, 100.0, 100.0, 60.0, 140.0, 70.0, 80.0, 10.0, 60.0, 30.0, 50.0, 90.0, 0.0, 70.0, 90.0, 100.0, 117.0, 100.0, 210.0, 15.0, 110.0, 100.0, 120.0, 39.0, 90.0, 130.0, 90.0, 130.0, 50.0, 220.0, 170.0, 83.0, 140.0, 101.0, 150.0, 120.0, 140.0, 110.0, 150.0, 130.0, 30.0, 120.0, 80.0, 100.0, 160.0, 90.0, 30.0, 70.0, 80.0, 140.0, 120.0, 128.0, 117.0, 150.0, 140.0, 80.0, 190.0, 90.0, 70.0, 140.0, 60.0, 170.0, 160.0, 180.0, 90.0, 80.0, 47.0, 88.0, 50.0, 110.0, 150.0, 115.0, 90.0, 54.0, 170.0, 100.0, 60.0, 150.0, 150.0, 130.0, 100.0, 60.0, 80.0, 120.0, 80.0, 70.0, 30.0, 20.0, 256.0, 30.0, 110.0, 40.0, 120.0, 30.0, 70.0, 50.0, 126.0, 90.0, 50.0, 120.0, 109.0, 50.0, 60.0, 140.0, 80.0, 67.0, 110.0, 90.0, 40.0, 100.0, 120.0, 60.0, 110.0, 14.0, 130.0, 120.0, 132.0, 120.0, 160.0, 90.0, 110.0, 30.0, 0.0, 17.0, 180.0, 70.0, 60.0, 90.0, 50.0, 180.0, 75.0, 100.0, 130.0, 80.0, 50.0, 20.0, 170.0, 120.0, 140.0, 200.0, 140.0, 90.0, 70.0, 90.0, 100.0, 60.0, 100.0, 30.0, 60.0, 80.0, 40.0, 110.0, 119.0, 30.0, 50.0, 20.0, 210.0, 80.0, 90.0, 90.0, 150.0, 80.0, 45.0, 80.0, 50.0, 1.0, 47.0, 80.0, 78.0, 40.0, 160.0, 70.0, 180.0, 140.0, 280.0, 100.0, 100.0, 160.0, 70.0, 110.0, 128.0, 60.0, 180.0, 120.0, 90.0, 156.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6562455903485647, "mean_inference_ms": 1.6566226328886549, "mean_action_processing_ms": 0.505688646365509, "mean_env_wait_ms": 1.1373950575537832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011505365371704102, "StateBufferConnector_ms": 0.008844375610351562, "ViewRequirementAgentConnector_ms": 0.3666870594024658}, "num_episodes": 18, "episode_return_max": 1700.0, "episode_return_min": 404.0, "episode_return_mean": 988.66}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.562560512816034, "num_env_steps_trained_throughput_per_sec": 20.562560512816034, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 4760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4760000, "timers": {"training_iteration_time_ms": 193648.494, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193648.449, "sample_time_ms": 2517.394, "learn_time_ms": 191112.259, "learn_throughput": 20.93, "synch_weights_time_ms": 10.336}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "done": false, "training_iteration": 119, "trial_id": "1841f_00000", "date": "2024-08-08_06-06-56", "timestamp": 1723111616, "time_this_iter_s": 194.53710198402405, "time_total_s": 24399.35838675499, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b295c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24399.35838675499, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 17.287636363636366, "ram_util_percent": 77.984}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3338874555370426, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.481646543772964, "policy_loss": -0.015589898711698243, "vf_loss": 8.49509663830677, "vf_explained_var": -0.002560039723135285, "kl": 0.007132617194382842, "entropy": 0.511756352028146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1122105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "env_runners": {"episode_reward_max": 1700.0, "episode_reward_min": 404.0, "episode_reward_mean": 991.38, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -75.0}, "policy_reward_max": {"policy_0": 320.0}, "policy_reward_mean": {"policy_0": 99.138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [758.0, 983.0, 1220.0, 1298.0, 1100.0, 990.0, 870.0, 1091.0, 1150.0, 1220.0, 1700.0, 1005.0, 956.0, 816.0, 1104.0, 783.0, 712.0, 404.0, 672.0, 940.0, 850.0, 968.0, 1305.0, 844.0, 820.0, 1229.0, 900.0, 720.0, 1007.0, 1630.0, 1180.0, 1223.0, 820.0, 1020.0, 859.0, 975.0, 1246.0, 1168.0, 750.0, 1000.0, 1230.0, 1102.0, 867.0, 1133.0, 611.0, 764.0, 1140.0, 1161.0, 1000.0, 1140.0, 565.0, 977.0, 1105.0, 874.0, 1290.0, 830.0, 900.0, 1060.0, 1005.0, 580.0, 1031.0, 1254.0, 1110.0, 1055.0, 1230.0, 974.0, 1000.0, 756.0, 892.0, 894.0, 909.0, 835.0, 1180.0, 639.0, 876.0, 1175.0, 1174.0, 1070.0, 1150.0, 965.0, 713.0, 1107.0, 820.0, 1040.0, 1047.0, 1050.0, 746.0, 1150.0, 870.0, 964.0, 840.0, 1250.0, 738.0, 1100.0, 1020.0, 990.0, 760.0, 1050.0, 1169.0, 925.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [47.0, 110.0, 50.0, 40.0, 200.0, 50.0, 32.0, 80.0, 49.0, 100.0, 49.0, 97.0, 200.0, 90.0, 120.0, 43.0, 130.0, 160.0, 38.0, 56.0, 140.0, 110.0, 110.0, 150.0, 130.0, 90.0, 120.0, 190.0, 70.0, 110.0, 230.0, 200.0, 89.0, 79.0, 200.0, 90.0, 80.0, 140.0, 70.0, 120.0, 100.0, 190.0, 120.0, 40.0, 150.0, 60.0, 150.0, 130.0, 130.0, 30.0, 110.0, 160.0, 90.0, 150.0, 110.0, 60.0, 80.0, 70.0, 100.0, 60.0, 80.0, 60.0, 80.0, 60.0, 110.0, 160.0, 110.0, 180.0, 25.0, 5.0, 150.0, 157.0, 81.0, 210.0, 90.0, 63.0, 80.0, 66.0, 34.0, 160.0, 80.0, 120.0, 210.0, 85.0, 100.0, 160.0, 70.0, 80.0, 130.0, 115.0, 90.0, 90.0, 180.0, 70.0, 150.0, 130.0, 140.0, 160.0, 100.0, 110.0, 120.0, 140.0, 220.0, 272.0, 190.0, 133.0, 70.0, 85.0, 200.0, 270.0, 70.0, 90.0, 79.0, 90.0, 79.0, 100.0, 90.0, 119.0, 240.0, 48.0, 100.0, 55.0, 50.0, 210.0, 104.0, 50.0, 40.0, 59.0, 200.0, 88.0, 70.0, 8.0, 25.0, 40.0, 80.0, 200.0, 70.0, 23.0, 50.0, 250.0, 120.0, 70.0, 90.0, 150.0, 98.0, 180.0, 59.0, 117.0, 160.0, 60.0, 40.0, 70.0, 30.0, 47.0, 50.0, 130.0, 70.0, 160.0, 106.0, 80.0, 80.0, 80.0, 80.0, 82.0, 90.0, 50.0, 10.0, 70.0, 80.0, 90.0, 80.0, 55.0, 75.0, 6.0, 0.0, 40.0, 30.0, -39.0, 97.0, 60.0, 19.0, 110.0, 50.0, 130.0, 43.0, 80.0, 50.0, 110.0, 39.0, 41.0, 50.0, 130.0, 70.0, 80.0, 50.0, 140.0, 90.0, 80.0, 150.0, 100.0, 150.0, 100.0, 80.0, 100.0, 120.0, 110.0, 40.0, 20.0, 40.0, 90.0, 100.0, 70.0, 120.0, 72.0, 180.0, 73.0, 43.0, 90.0, 140.0, 80.0, 100.0, 210.0, 100.0, 90.0, 25.0, 150.0, 290.0, 120.0, 100.0, 120.0, 50.0, 80.0, 110.0, 82.0, 80.0, 80.0, 130.0, 110.0, 40.0, 82.0, 40.0, 60.0, 140.0, 120.0, 190.0, 100.0, 70.0, 40.0, 30.0, 30.0, 107.0, 122.0, 70.0, 130.0, 110.0, 140.0, 100.0, 100.0, 220.0, 130.0, 104.0, 50.0, 110.0, 50.0, 100.0, 160.0, 120.0, 52.0, 44.0, 110.0, 80.0, 20.0, 120.0, 50.0, 110.0, 80.0, 50.0, 50.0, 60.0, 100.0, 60.0, 180.0, 140.0, 150.0, 120.0, 70.0, 70.0, 47.0, 150.0, 20.0, 120.0, 190.0, 130.0, 100.0, 230.0, 70.0, 190.0, 190.0, 190.0, 220.0, 170.0, 150.0, 120.0, 40.0, 120.0, 80.0, 120.0, 130.0, 110.0, 140.0, 129.0, 170.0, 155.0, 140.0, 59.0, 120.0, 80.0, 110.0, 130.0, 130.0, 50.0, 60.0, 100.0, 50.0, 50.0, 120.0, 130.0, 50.0, 120.0, 90.0, 80.0, 140.0, 120.0, 110.0, 130.0, 90.0, 140.0, 90.0, 60.0, 60.0, 100.0, 100.0, 120.0, 40.0, 60.0, 60.0, 89.0, 140.0, 80.0, 70.0, 80.0, 70.0, 70.0, 100.0, 200.0, 70.0, 85.0, 40.0, 140.0, 120.0, 170.0, 320.0, 191.0, 55.0, 90.0, 100.0, 140.0, 30.0, 100.0, 50.0, 119.0, 100.0, 100.0, 180.0, 200.0, 89.0, 60.0, 100.0, 110.0, 110.0, 130.0, 90.0, 30.0, 110.0, 60.0, 0.0, 60.0, 50.0, 160.0, 60.0, 90.0, 80.0, 50.0, 150.0, 70.0, 150.0, 140.0, 70.0, 140.0, 60.0, 190.0, 50.0, 110.0, 90.0, 130.0, 130.0, 170.0, 120.0, 150.0, 90.0, 60.0, 130.0, 88.0, 110.0, 230.0, 100.0, 170.0, 120.0, 20.0, 74.0, 80.0, 140.0, 150.0, 60.0, 79.0, 60.0, 30.0, 48.0, 140.0, 80.0, 100.0, 100.0, 137.0, 130.0, 230.0, 110.0, 140.0, 41.0, 35.0, 110.0, 32.0, 53.0, 40.0, 163.0, 60.0, 30.0, 100.0, 13.0, 10.0, 110.0, 79.0, 78.0, 70.0, 80.0, 80.0, 80.0, 28.0, 90.0, 89.0, 90.0, 90.0, 90.0, 140.0, 160.0, 130.0, 140.0, 70.0, 140.0, 50.0, 130.0, 124.0, 190.0, 70.0, 110.0, 130.0, 100.0, 160.0, 37.0, 90.0, 150.0, 90.0, 160.0, 100.0, 100.0, 80.0, 100.0, 110.0, 80.0, 90.0, 90.0, 140.0, 50.0, 120.0, 180.0, 60.0, 130.0, 120.0, 170.0, 50.0, 120.0, -11.0, 60.0, 70.0, 39.0, 37.0, 130.0, 40.0, 20.0, 30.0, 150.0, 100.0, 110.0, 60.0, 167.0, 140.0, 98.0, 110.0, 72.0, 70.0, 50.0, 70.0, 134.0, 211.0, 120.0, 100.0, 70.0, 30.0, 200.0, 60.0, 110.0, 130.0, 80.0, -75.0, 200.0, 190.0, 80.0, 120.0, 130.0, 70.0, -51.0, 100.0, 150.0, 120.0, 130.0, 110.0, 150.0, 90.0, 150.0, 140.0, 150.0, 90.0, 120.0, 80.0, 80.0, 90.0, 80.0, 73.0, 67.0, 110.0, 40.0, 200.0, 80.0, 60.0, 120.0, 210.0, 70.0, 20.0, 80.0, 20.0, 40.0, 80.0, 120.0, 100.0, 150.0, 90.0, 70.0, 100.0, 130.0, 120.0, 100.0, 210.0, 70.0, 95.0, 120.0, 40.0, 100.0, 100.0, 60.0, 140.0, 70.0, 80.0, 10.0, 60.0, 30.0, 50.0, 90.0, 0.0, 70.0, 90.0, 100.0, 117.0, 100.0, 210.0, 15.0, 110.0, 100.0, 120.0, 39.0, 90.0, 130.0, 90.0, 130.0, 50.0, 220.0, 170.0, 83.0, 140.0, 101.0, 150.0, 120.0, 140.0, 110.0, 150.0, 130.0, 30.0, 120.0, 80.0, 100.0, 160.0, 90.0, 30.0, 70.0, 80.0, 140.0, 120.0, 128.0, 117.0, 150.0, 140.0, 80.0, 190.0, 90.0, 70.0, 140.0, 60.0, 170.0, 160.0, 180.0, 90.0, 80.0, 47.0, 88.0, 50.0, 110.0, 150.0, 115.0, 90.0, 54.0, 170.0, 100.0, 60.0, 150.0, 150.0, 130.0, 100.0, 60.0, 80.0, 120.0, 80.0, 70.0, 30.0, 20.0, 256.0, 30.0, 110.0, 40.0, 120.0, 30.0, 70.0, 50.0, 126.0, 90.0, 50.0, 120.0, 109.0, 50.0, 60.0, 140.0, 80.0, 67.0, 110.0, 90.0, 40.0, 100.0, 120.0, 60.0, 110.0, 14.0, 130.0, 120.0, 132.0, 120.0, 160.0, 90.0, 110.0, 30.0, 0.0, 17.0, 180.0, 70.0, 60.0, 90.0, 50.0, 180.0, 75.0, 100.0, 130.0, 80.0, 50.0, 20.0, 170.0, 120.0, 140.0, 200.0, 140.0, 90.0, 70.0, 90.0, 100.0, 60.0, 100.0, 30.0, 60.0, 80.0, 40.0, 110.0, 119.0, 30.0, 50.0, 20.0, 210.0, 80.0, 90.0, 90.0, 150.0, 80.0, 45.0, 80.0, 50.0, 1.0, 47.0, 80.0, 78.0, 40.0, 160.0, 70.0, 180.0, 140.0, 280.0, 100.0, 100.0, 160.0, 70.0, 110.0, 128.0, 60.0, 180.0, 120.0, 90.0, 156.0, 100.0, 80.0, 120.0, 120.0, 170.0, 40.0, 90.0, 110.0, 80.0, 160.0, 70.0, 110.0, 160.0, 280.0, 100.0, 110.0, 100.0, 60.0, 60.0, 100.0, 100.0, 90.0, 110.0, 30.0, 110.0, 37.0, 100.0, 168.0, 110.0, 110.0, 110.0, 74.0, 70.0, 80.0, 100.0, 50.0, 60.0, 59.0, 40.0, 70.0, 130.0, 125.0, 120.0, 90.0, 160.0, 70.0, 100.0, 62.0, 110.0, 140.0, 115.0, 80.0, 90.0, 70.0, 80.0, 70.0, 50.0, 90.0, 35.0, 140.0, 150.0, 25.0, 130.0, 190.0, 130.0, 100.0, 90.0, 90.0, 130.0, 5.0, 120.0, 150.0, 80.0, 80.0, 123.0, 120.0, 44.0, 90.0, 190.0, 50.0, 100.0, 110.0, 150.0, 130.0, 10.0, 90.0, 90.0, 190.0, 130.0, 50.0, 90.0, 100.0, 120.0, 150.0, 40.0, 60.0, 77.0, 40.0, 39.0, 30.0, 100.0, 90.0, 110.0, 170.0, 90.0, 80.0, 80.0, 140.0, 160.0, 130.0, 130.0, 170.0, 5.0, 118.0, 20.0, 130.0, 160.0, 40.0, 30.0, 67.0, 123.0, 110.0, 220.0, 100.0, 71.0, 160.0, 45.0, 100.0, 50.0, -15.0, 90.0, 100.0, 30.0, 70.0, 120.0, 80.0, 100.0, 40.0, 40.0, 170.0, 180.0, 80.0, 130.0, 90.0, 70.0, 150.0, 160.0, 90.0, 130.0, 170.0, 90.0, 60.0, 18.0, 30.0, 50.0, 130.0, 100.0, 130.0, 110.0, 20.0, 90.0, 60.0, 140.0, 60.0, 100.0, 80.0, 240.0, 200.0, 80.0, 50.0, 90.0, 80.0, 100.0, 60.0, 140.0, 100.0, 130.0, 110.0, 100.0, 110.0, 90.0, 140.0, 150.0, 100.0, 70.0, 150.0, 50.0, 110.0, 30.0, 100.0, 50.0, 190.0, 60.0, 40.0, 50.0, 40.0, 40.0, 40.0, 130.0, 120.0, 130.0, 100.0, 60.0, 180.0, 90.0, 70.0, 130.0, 40.0, 120.0, 130.0, 40.0, 110.0, 180.0, 120.0, 120.0, 70.0, 114.0, 120.0, 170.0, 125.0, 80.0, 75.0, 100.0, 180.0, 100.0, 68.0, 128.0, 130.0, 60.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6536184919907648, "mean_inference_ms": 1.6533094234829793, "mean_action_processing_ms": 0.5051205080754878, "mean_env_wait_ms": 1.1360681423567847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01157689094543457, "StateBufferConnector_ms": 0.008977174758911133, "ViewRequirementAgentConnector_ms": 0.3851664066314697}, "num_episodes": 23, "episode_return_max": 1700.0, "episode_return_min": 404.0, "episode_return_mean": 991.38}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.556200973810068, "num_env_steps_trained_throughput_per_sec": 20.556200973810068, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 4800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4800000, "timers": {"training_iteration_time_ms": 193791.204, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193791.158, "sample_time_ms": 2525.36, "learn_time_ms": 191246.974, "learn_throughput": 20.915, "synch_weights_time_ms": 10.187}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "done": false, "training_iteration": 120, "trial_id": "1841f_00000", "date": "2024-08-08_06-10-10", "timestamp": 1723111810, "time_this_iter_s": 194.59930396080017, "time_total_s": 24593.95769071579, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b295c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24593.95769071579, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 17.62872727272727, "ram_util_percent": 78.06836363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.421095483231976, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.59104942660997, "policy_loss": -0.016006808547740475, "vf_loss": 8.604967468259687, "vf_explained_var": -0.005065187072347655, "kl": 0.006962548764323007, "entropy": 0.49971193097079525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1131495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "env_runners": {"episode_reward_max": 1630.0, "episode_reward_min": 565.0, "episode_reward_mean": 992.49, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -75.0}, "policy_reward_max": {"policy_0": 320.0}, "policy_reward_mean": {"policy_0": 99.249}, "custom_metrics": {}, "hist_stats": {"episode_reward": [672.0, 940.0, 850.0, 968.0, 1305.0, 844.0, 820.0, 1229.0, 900.0, 720.0, 1007.0, 1630.0, 1180.0, 1223.0, 820.0, 1020.0, 859.0, 975.0, 1246.0, 1168.0, 750.0, 1000.0, 1230.0, 1102.0, 867.0, 1133.0, 611.0, 764.0, 1140.0, 1161.0, 1000.0, 1140.0, 565.0, 977.0, 1105.0, 874.0, 1290.0, 830.0, 900.0, 1060.0, 1005.0, 580.0, 1031.0, 1254.0, 1110.0, 1055.0, 1230.0, 974.0, 1000.0, 756.0, 892.0, 894.0, 909.0, 835.0, 1180.0, 639.0, 876.0, 1175.0, 1174.0, 1070.0, 1150.0, 965.0, 713.0, 1107.0, 820.0, 1040.0, 1047.0, 1050.0, 746.0, 1150.0, 870.0, 964.0, 840.0, 1250.0, 738.0, 1100.0, 1020.0, 990.0, 760.0, 1050.0, 1169.0, 925.0, 1460.0, 1032.0, 1130.0, 909.0, 1113.0, 880.0, 1316.0, 789.0, 1005.0, 1071.0, 1121.0, 798.0, 1245.0, 580.0, 889.0, 1090.0, 883.0, 960.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [19.0, 110.0, 50.0, 130.0, 43.0, 80.0, 50.0, 110.0, 39.0, 41.0, 50.0, 130.0, 70.0, 80.0, 50.0, 140.0, 90.0, 80.0, 150.0, 100.0, 150.0, 100.0, 80.0, 100.0, 120.0, 110.0, 40.0, 20.0, 40.0, 90.0, 100.0, 70.0, 120.0, 72.0, 180.0, 73.0, 43.0, 90.0, 140.0, 80.0, 100.0, 210.0, 100.0, 90.0, 25.0, 150.0, 290.0, 120.0, 100.0, 120.0, 50.0, 80.0, 110.0, 82.0, 80.0, 80.0, 130.0, 110.0, 40.0, 82.0, 40.0, 60.0, 140.0, 120.0, 190.0, 100.0, 70.0, 40.0, 30.0, 30.0, 107.0, 122.0, 70.0, 130.0, 110.0, 140.0, 100.0, 100.0, 220.0, 130.0, 104.0, 50.0, 110.0, 50.0, 100.0, 160.0, 120.0, 52.0, 44.0, 110.0, 80.0, 20.0, 120.0, 50.0, 110.0, 80.0, 50.0, 50.0, 60.0, 100.0, 60.0, 180.0, 140.0, 150.0, 120.0, 70.0, 70.0, 47.0, 150.0, 20.0, 120.0, 190.0, 130.0, 100.0, 230.0, 70.0, 190.0, 190.0, 190.0, 220.0, 170.0, 150.0, 120.0, 40.0, 120.0, 80.0, 120.0, 130.0, 110.0, 140.0, 129.0, 170.0, 155.0, 140.0, 59.0, 120.0, 80.0, 110.0, 130.0, 130.0, 50.0, 60.0, 100.0, 50.0, 50.0, 120.0, 130.0, 50.0, 120.0, 90.0, 80.0, 140.0, 120.0, 110.0, 130.0, 90.0, 140.0, 90.0, 60.0, 60.0, 100.0, 100.0, 120.0, 40.0, 60.0, 60.0, 89.0, 140.0, 80.0, 70.0, 80.0, 70.0, 70.0, 100.0, 200.0, 70.0, 85.0, 40.0, 140.0, 120.0, 170.0, 320.0, 191.0, 55.0, 90.0, 100.0, 140.0, 30.0, 100.0, 50.0, 119.0, 100.0, 100.0, 180.0, 200.0, 89.0, 60.0, 100.0, 110.0, 110.0, 130.0, 90.0, 30.0, 110.0, 60.0, 0.0, 60.0, 50.0, 160.0, 60.0, 90.0, 80.0, 50.0, 150.0, 70.0, 150.0, 140.0, 70.0, 140.0, 60.0, 190.0, 50.0, 110.0, 90.0, 130.0, 130.0, 170.0, 120.0, 150.0, 90.0, 60.0, 130.0, 88.0, 110.0, 230.0, 100.0, 170.0, 120.0, 20.0, 74.0, 80.0, 140.0, 150.0, 60.0, 79.0, 60.0, 30.0, 48.0, 140.0, 80.0, 100.0, 100.0, 137.0, 130.0, 230.0, 110.0, 140.0, 41.0, 35.0, 110.0, 32.0, 53.0, 40.0, 163.0, 60.0, 30.0, 100.0, 13.0, 10.0, 110.0, 79.0, 78.0, 70.0, 80.0, 80.0, 80.0, 28.0, 90.0, 89.0, 90.0, 90.0, 90.0, 140.0, 160.0, 130.0, 140.0, 70.0, 140.0, 50.0, 130.0, 124.0, 190.0, 70.0, 110.0, 130.0, 100.0, 160.0, 37.0, 90.0, 150.0, 90.0, 160.0, 100.0, 100.0, 80.0, 100.0, 110.0, 80.0, 90.0, 90.0, 140.0, 50.0, 120.0, 180.0, 60.0, 130.0, 120.0, 170.0, 50.0, 120.0, -11.0, 60.0, 70.0, 39.0, 37.0, 130.0, 40.0, 20.0, 30.0, 150.0, 100.0, 110.0, 60.0, 167.0, 140.0, 98.0, 110.0, 72.0, 70.0, 50.0, 70.0, 134.0, 211.0, 120.0, 100.0, 70.0, 30.0, 200.0, 60.0, 110.0, 130.0, 80.0, -75.0, 200.0, 190.0, 80.0, 120.0, 130.0, 70.0, -51.0, 100.0, 150.0, 120.0, 130.0, 110.0, 150.0, 90.0, 150.0, 140.0, 150.0, 90.0, 120.0, 80.0, 80.0, 90.0, 80.0, 73.0, 67.0, 110.0, 40.0, 200.0, 80.0, 60.0, 120.0, 210.0, 70.0, 20.0, 80.0, 20.0, 40.0, 80.0, 120.0, 100.0, 150.0, 90.0, 70.0, 100.0, 130.0, 120.0, 100.0, 210.0, 70.0, 95.0, 120.0, 40.0, 100.0, 100.0, 60.0, 140.0, 70.0, 80.0, 10.0, 60.0, 30.0, 50.0, 90.0, 0.0, 70.0, 90.0, 100.0, 117.0, 100.0, 210.0, 15.0, 110.0, 100.0, 120.0, 39.0, 90.0, 130.0, 90.0, 130.0, 50.0, 220.0, 170.0, 83.0, 140.0, 101.0, 150.0, 120.0, 140.0, 110.0, 150.0, 130.0, 30.0, 120.0, 80.0, 100.0, 160.0, 90.0, 30.0, 70.0, 80.0, 140.0, 120.0, 128.0, 117.0, 150.0, 140.0, 80.0, 190.0, 90.0, 70.0, 140.0, 60.0, 170.0, 160.0, 180.0, 90.0, 80.0, 47.0, 88.0, 50.0, 110.0, 150.0, 115.0, 90.0, 54.0, 170.0, 100.0, 60.0, 150.0, 150.0, 130.0, 100.0, 60.0, 80.0, 120.0, 80.0, 70.0, 30.0, 20.0, 256.0, 30.0, 110.0, 40.0, 120.0, 30.0, 70.0, 50.0, 126.0, 90.0, 50.0, 120.0, 109.0, 50.0, 60.0, 140.0, 80.0, 67.0, 110.0, 90.0, 40.0, 100.0, 120.0, 60.0, 110.0, 14.0, 130.0, 120.0, 132.0, 120.0, 160.0, 90.0, 110.0, 30.0, 0.0, 17.0, 180.0, 70.0, 60.0, 90.0, 50.0, 180.0, 75.0, 100.0, 130.0, 80.0, 50.0, 20.0, 170.0, 120.0, 140.0, 200.0, 140.0, 90.0, 70.0, 90.0, 100.0, 60.0, 100.0, 30.0, 60.0, 80.0, 40.0, 110.0, 119.0, 30.0, 50.0, 20.0, 210.0, 80.0, 90.0, 90.0, 150.0, 80.0, 45.0, 80.0, 50.0, 1.0, 47.0, 80.0, 78.0, 40.0, 160.0, 70.0, 180.0, 140.0, 280.0, 100.0, 100.0, 160.0, 70.0, 110.0, 128.0, 60.0, 180.0, 120.0, 90.0, 156.0, 100.0, 80.0, 120.0, 120.0, 170.0, 40.0, 90.0, 110.0, 80.0, 160.0, 70.0, 110.0, 160.0, 280.0, 100.0, 110.0, 100.0, 60.0, 60.0, 100.0, 100.0, 90.0, 110.0, 30.0, 110.0, 37.0, 100.0, 168.0, 110.0, 110.0, 110.0, 74.0, 70.0, 80.0, 100.0, 50.0, 60.0, 59.0, 40.0, 70.0, 130.0, 125.0, 120.0, 90.0, 160.0, 70.0, 100.0, 62.0, 110.0, 140.0, 115.0, 80.0, 90.0, 70.0, 80.0, 70.0, 50.0, 90.0, 35.0, 140.0, 150.0, 25.0, 130.0, 190.0, 130.0, 100.0, 90.0, 90.0, 130.0, 5.0, 120.0, 150.0, 80.0, 80.0, 123.0, 120.0, 44.0, 90.0, 190.0, 50.0, 100.0, 110.0, 150.0, 130.0, 10.0, 90.0, 90.0, 190.0, 130.0, 50.0, 90.0, 100.0, 120.0, 150.0, 40.0, 60.0, 77.0, 40.0, 39.0, 30.0, 100.0, 90.0, 110.0, 170.0, 90.0, 80.0, 80.0, 140.0, 160.0, 130.0, 130.0, 170.0, 5.0, 118.0, 20.0, 130.0, 160.0, 40.0, 30.0, 67.0, 123.0, 110.0, 220.0, 100.0, 71.0, 160.0, 45.0, 100.0, 50.0, -15.0, 90.0, 100.0, 30.0, 70.0, 120.0, 80.0, 100.0, 40.0, 40.0, 170.0, 180.0, 80.0, 130.0, 90.0, 70.0, 150.0, 160.0, 90.0, 130.0, 170.0, 90.0, 60.0, 18.0, 30.0, 50.0, 130.0, 100.0, 130.0, 110.0, 20.0, 90.0, 60.0, 140.0, 60.0, 100.0, 80.0, 240.0, 200.0, 80.0, 50.0, 90.0, 80.0, 100.0, 60.0, 140.0, 100.0, 130.0, 110.0, 100.0, 110.0, 90.0, 140.0, 150.0, 100.0, 70.0, 150.0, 50.0, 110.0, 30.0, 100.0, 50.0, 190.0, 60.0, 40.0, 50.0, 40.0, 40.0, 40.0, 130.0, 120.0, 130.0, 100.0, 60.0, 180.0, 90.0, 70.0, 130.0, 40.0, 120.0, 130.0, 40.0, 110.0, 180.0, 120.0, 120.0, 70.0, 114.0, 120.0, 170.0, 125.0, 80.0, 75.0, 100.0, 180.0, 100.0, 68.0, 128.0, 130.0, 60.0, 4.0, 240.0, 10.0, 230.0, 90.0, 100.0, 70.0, 280.0, 110.0, 190.0, 140.0, 100.0, 48.0, 130.0, 110.0, 150.0, 119.0, 70.0, 100.0, 80.0, 125.0, 160.0, 100.0, 120.0, 130.0, 80.0, 100.0, 160.0, 110.0, 120.0, 50.0, 130.0, 20.0, 110.0, 120.0, 89.0, 110.0, 90.0, 90.0, 30.0, 120.0, 90.0, 110.0, 150.0, 70.0, 140.0, 110.0, 126.0, 137.0, 50.0, 130.0, 240.0, 90.0, 30.0, 100.0, 20.0, 19.0, 140.0, 10.0, 170.0, 61.0, 260.0, 70.0, 90.0, 190.0, 60.0, 200.0, 110.0, 110.0, 140.0, 86.0, 140.0, 90.0, 110.0, 110.0, 110.0, 60.0, 96.0, -15.0, 50.0, 38.0, 120.0, 80.0, 100.0, 140.0, 60.0, 120.0, 55.0, 140.0, 130.0, 60.0, 140.0, 84.0, 96.0, 180.0, 20.0, 32.0, 110.0, 160.0, 105.0, 144.0, 110.0, 84.0, 130.0, 140.0, 117.0, 190.0, 90.0, 60.0, 40.0, 160.0, 100.0, 60.0, 120.0, 47.0, 150.0, 78.0, 80.0, 65.0, 48.0, 50.0, 100.0, 210.0, 160.0, 70.0, 80.0, 190.0, 80.0, 190.0, 100.0, 65.0, 30.0, 50.0, 90.0, 60.0, 80.0, 100.0, 70.0, 30.0, 40.0, 30.0, 60.0, 70.0, 70.0, 11.0, 170.0, 190.0, 7.0, 81.0, 40.0, 190.0, 180.0, 180.0, 60.0, 60.0, 100.0, 30.0, 220.0, 100.0, 120.0, 40.0, 60.0, 100.0, 97.0, 70.0, 79.0, 39.0, 90.0, 120.0, -32.0, 260.0, 80.0, 70.0, 70.0, 90.0, 50.0, 200.0, 50.0, 70.0, 140.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6515877121269733, "mean_inference_ms": 1.6508396298513075, "mean_action_processing_ms": 0.5046371072005009, "mean_env_wait_ms": 1.1349694252786766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011550426483154297, "StateBufferConnector_ms": 0.008969783782958984, "ViewRequirementAgentConnector_ms": 0.3900876045227051}, "num_episodes": 18, "episode_return_max": 1630.0, "episode_return_min": 565.0, "episode_return_mean": 992.49}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.694718797590372, "num_env_steps_trained_throughput_per_sec": 20.694718797590372, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 4840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4840000, "timers": {"training_iteration_time_ms": 193785.59, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193785.544, "sample_time_ms": 2523.818, "learn_time_ms": 191242.926, "learn_throughput": 20.916, "synch_weights_time_ms": 10.214}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "done": false, "training_iteration": 121, "trial_id": "1841f_00000", "date": "2024-08-08_06-13-24", "timestamp": 1723112004, "time_this_iter_s": 193.29645705223083, "time_total_s": 24787.25414776802, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b295c5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24787.25414776802, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 17.323357664233576, "ram_util_percent": 77.84671532846716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3435293077914734, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.513387088958448, "policy_loss": -0.015295019293257509, "vf_loss": 8.526557213658341, "vf_explained_var": -0.011116078048468397, "kl": 0.007082976599107341, "entropy": 0.49931661076248646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1140885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "env_runners": {"episode_reward_max": 1460.0, "episode_reward_min": 565.0, "episode_reward_mean": 996.32, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -75.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 99.632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1230.0, 1102.0, 867.0, 1133.0, 611.0, 764.0, 1140.0, 1161.0, 1000.0, 1140.0, 565.0, 977.0, 1105.0, 874.0, 1290.0, 830.0, 900.0, 1060.0, 1005.0, 580.0, 1031.0, 1254.0, 1110.0, 1055.0, 1230.0, 974.0, 1000.0, 756.0, 892.0, 894.0, 909.0, 835.0, 1180.0, 639.0, 876.0, 1175.0, 1174.0, 1070.0, 1150.0, 965.0, 713.0, 1107.0, 820.0, 1040.0, 1047.0, 1050.0, 746.0, 1150.0, 870.0, 964.0, 840.0, 1250.0, 738.0, 1100.0, 1020.0, 990.0, 760.0, 1050.0, 1169.0, 925.0, 1460.0, 1032.0, 1130.0, 909.0, 1113.0, 880.0, 1316.0, 789.0, 1005.0, 1071.0, 1121.0, 798.0, 1245.0, 580.0, 889.0, 1090.0, 883.0, 960.0, 1161.0, 998.0, 1020.0, 810.0, 1060.0, 983.0, 1380.0, 960.0, 789.0, 1214.0, 983.0, 1132.0, 702.0, 900.0, 1110.0, 1180.0, 675.0, 1109.0, 753.0, 960.0, 1387.0, 1243.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [190.0, 50.0, 110.0, 90.0, 130.0, 130.0, 170.0, 120.0, 150.0, 90.0, 60.0, 130.0, 88.0, 110.0, 230.0, 100.0, 170.0, 120.0, 20.0, 74.0, 80.0, 140.0, 150.0, 60.0, 79.0, 60.0, 30.0, 48.0, 140.0, 80.0, 100.0, 100.0, 137.0, 130.0, 230.0, 110.0, 140.0, 41.0, 35.0, 110.0, 32.0, 53.0, 40.0, 163.0, 60.0, 30.0, 100.0, 13.0, 10.0, 110.0, 79.0, 78.0, 70.0, 80.0, 80.0, 80.0, 28.0, 90.0, 89.0, 90.0, 90.0, 90.0, 140.0, 160.0, 130.0, 140.0, 70.0, 140.0, 50.0, 130.0, 124.0, 190.0, 70.0, 110.0, 130.0, 100.0, 160.0, 37.0, 90.0, 150.0, 90.0, 160.0, 100.0, 100.0, 80.0, 100.0, 110.0, 80.0, 90.0, 90.0, 140.0, 50.0, 120.0, 180.0, 60.0, 130.0, 120.0, 170.0, 50.0, 120.0, -11.0, 60.0, 70.0, 39.0, 37.0, 130.0, 40.0, 20.0, 30.0, 150.0, 100.0, 110.0, 60.0, 167.0, 140.0, 98.0, 110.0, 72.0, 70.0, 50.0, 70.0, 134.0, 211.0, 120.0, 100.0, 70.0, 30.0, 200.0, 60.0, 110.0, 130.0, 80.0, -75.0, 200.0, 190.0, 80.0, 120.0, 130.0, 70.0, -51.0, 100.0, 150.0, 120.0, 130.0, 110.0, 150.0, 90.0, 150.0, 140.0, 150.0, 90.0, 120.0, 80.0, 80.0, 90.0, 80.0, 73.0, 67.0, 110.0, 40.0, 200.0, 80.0, 60.0, 120.0, 210.0, 70.0, 20.0, 80.0, 20.0, 40.0, 80.0, 120.0, 100.0, 150.0, 90.0, 70.0, 100.0, 130.0, 120.0, 100.0, 210.0, 70.0, 95.0, 120.0, 40.0, 100.0, 100.0, 60.0, 140.0, 70.0, 80.0, 10.0, 60.0, 30.0, 50.0, 90.0, 0.0, 70.0, 90.0, 100.0, 117.0, 100.0, 210.0, 15.0, 110.0, 100.0, 120.0, 39.0, 90.0, 130.0, 90.0, 130.0, 50.0, 220.0, 170.0, 83.0, 140.0, 101.0, 150.0, 120.0, 140.0, 110.0, 150.0, 130.0, 30.0, 120.0, 80.0, 100.0, 160.0, 90.0, 30.0, 70.0, 80.0, 140.0, 120.0, 128.0, 117.0, 150.0, 140.0, 80.0, 190.0, 90.0, 70.0, 140.0, 60.0, 170.0, 160.0, 180.0, 90.0, 80.0, 47.0, 88.0, 50.0, 110.0, 150.0, 115.0, 90.0, 54.0, 170.0, 100.0, 60.0, 150.0, 150.0, 130.0, 100.0, 60.0, 80.0, 120.0, 80.0, 70.0, 30.0, 20.0, 256.0, 30.0, 110.0, 40.0, 120.0, 30.0, 70.0, 50.0, 126.0, 90.0, 50.0, 120.0, 109.0, 50.0, 60.0, 140.0, 80.0, 67.0, 110.0, 90.0, 40.0, 100.0, 120.0, 60.0, 110.0, 14.0, 130.0, 120.0, 132.0, 120.0, 160.0, 90.0, 110.0, 30.0, 0.0, 17.0, 180.0, 70.0, 60.0, 90.0, 50.0, 180.0, 75.0, 100.0, 130.0, 80.0, 50.0, 20.0, 170.0, 120.0, 140.0, 200.0, 140.0, 90.0, 70.0, 90.0, 100.0, 60.0, 100.0, 30.0, 60.0, 80.0, 40.0, 110.0, 119.0, 30.0, 50.0, 20.0, 210.0, 80.0, 90.0, 90.0, 150.0, 80.0, 45.0, 80.0, 50.0, 1.0, 47.0, 80.0, 78.0, 40.0, 160.0, 70.0, 180.0, 140.0, 280.0, 100.0, 100.0, 160.0, 70.0, 110.0, 128.0, 60.0, 180.0, 120.0, 90.0, 156.0, 100.0, 80.0, 120.0, 120.0, 170.0, 40.0, 90.0, 110.0, 80.0, 160.0, 70.0, 110.0, 160.0, 280.0, 100.0, 110.0, 100.0, 60.0, 60.0, 100.0, 100.0, 90.0, 110.0, 30.0, 110.0, 37.0, 100.0, 168.0, 110.0, 110.0, 110.0, 74.0, 70.0, 80.0, 100.0, 50.0, 60.0, 59.0, 40.0, 70.0, 130.0, 125.0, 120.0, 90.0, 160.0, 70.0, 100.0, 62.0, 110.0, 140.0, 115.0, 80.0, 90.0, 70.0, 80.0, 70.0, 50.0, 90.0, 35.0, 140.0, 150.0, 25.0, 130.0, 190.0, 130.0, 100.0, 90.0, 90.0, 130.0, 5.0, 120.0, 150.0, 80.0, 80.0, 123.0, 120.0, 44.0, 90.0, 190.0, 50.0, 100.0, 110.0, 150.0, 130.0, 10.0, 90.0, 90.0, 190.0, 130.0, 50.0, 90.0, 100.0, 120.0, 150.0, 40.0, 60.0, 77.0, 40.0, 39.0, 30.0, 100.0, 90.0, 110.0, 170.0, 90.0, 80.0, 80.0, 140.0, 160.0, 130.0, 130.0, 170.0, 5.0, 118.0, 20.0, 130.0, 160.0, 40.0, 30.0, 67.0, 123.0, 110.0, 220.0, 100.0, 71.0, 160.0, 45.0, 100.0, 50.0, -15.0, 90.0, 100.0, 30.0, 70.0, 120.0, 80.0, 100.0, 40.0, 40.0, 170.0, 180.0, 80.0, 130.0, 90.0, 70.0, 150.0, 160.0, 90.0, 130.0, 170.0, 90.0, 60.0, 18.0, 30.0, 50.0, 130.0, 100.0, 130.0, 110.0, 20.0, 90.0, 60.0, 140.0, 60.0, 100.0, 80.0, 240.0, 200.0, 80.0, 50.0, 90.0, 80.0, 100.0, 60.0, 140.0, 100.0, 130.0, 110.0, 100.0, 110.0, 90.0, 140.0, 150.0, 100.0, 70.0, 150.0, 50.0, 110.0, 30.0, 100.0, 50.0, 190.0, 60.0, 40.0, 50.0, 40.0, 40.0, 40.0, 130.0, 120.0, 130.0, 100.0, 60.0, 180.0, 90.0, 70.0, 130.0, 40.0, 120.0, 130.0, 40.0, 110.0, 180.0, 120.0, 120.0, 70.0, 114.0, 120.0, 170.0, 125.0, 80.0, 75.0, 100.0, 180.0, 100.0, 68.0, 128.0, 130.0, 60.0, 4.0, 240.0, 10.0, 230.0, 90.0, 100.0, 70.0, 280.0, 110.0, 190.0, 140.0, 100.0, 48.0, 130.0, 110.0, 150.0, 119.0, 70.0, 100.0, 80.0, 125.0, 160.0, 100.0, 120.0, 130.0, 80.0, 100.0, 160.0, 110.0, 120.0, 50.0, 130.0, 20.0, 110.0, 120.0, 89.0, 110.0, 90.0, 90.0, 30.0, 120.0, 90.0, 110.0, 150.0, 70.0, 140.0, 110.0, 126.0, 137.0, 50.0, 130.0, 240.0, 90.0, 30.0, 100.0, 20.0, 19.0, 140.0, 10.0, 170.0, 61.0, 260.0, 70.0, 90.0, 190.0, 60.0, 200.0, 110.0, 110.0, 140.0, 86.0, 140.0, 90.0, 110.0, 110.0, 110.0, 60.0, 96.0, -15.0, 50.0, 38.0, 120.0, 80.0, 100.0, 140.0, 60.0, 120.0, 55.0, 140.0, 130.0, 60.0, 140.0, 84.0, 96.0, 180.0, 20.0, 32.0, 110.0, 160.0, 105.0, 144.0, 110.0, 84.0, 130.0, 140.0, 117.0, 190.0, 90.0, 60.0, 40.0, 160.0, 100.0, 60.0, 120.0, 47.0, 150.0, 78.0, 80.0, 65.0, 48.0, 50.0, 100.0, 210.0, 160.0, 70.0, 80.0, 190.0, 80.0, 190.0, 100.0, 65.0, 30.0, 50.0, 90.0, 60.0, 80.0, 100.0, 70.0, 30.0, 40.0, 30.0, 60.0, 70.0, 70.0, 11.0, 170.0, 190.0, 7.0, 81.0, 40.0, 190.0, 180.0, 180.0, 60.0, 60.0, 100.0, 30.0, 220.0, 100.0, 120.0, 40.0, 60.0, 100.0, 97.0, 70.0, 79.0, 39.0, 90.0, 120.0, -32.0, 260.0, 80.0, 70.0, 70.0, 90.0, 50.0, 200.0, 50.0, 70.0, 140.0, 140.0, 130.0, 110.0, 68.0, 170.0, 190.0, 35.0, 120.0, 58.0, 130.0, 150.0, 22.0, 170.0, 80.0, 70.0, 89.0, 90.0, 190.0, 60.0, 161.0, 66.0, 130.0, 150.0, 50.0, 100.0, 160.0, 110.0, 80.0, 50.0, 120.0, 70.0, 110.0, 50.0, 70.0, 40.0, 120.0, 40.0, 110.0, 70.0, 140.0, 60.0, 110.0, 110.0, 70.0, 150.0, 100.0, 80.0, 80.0, 170.0, 120.0, 70.0, 70.0, 120.0, 170.0, 130.0, -35.0, 170.0, 110.0, 88.0, 60.0, 100.0, 140.0, 180.0, 120.0, 180.0, 110.0, 120.0, 190.0, 110.0, 110.0, 120.0, 120.0, 100.0, 100.0, 80.0, 130.0, 100.0, 50.0, 40.0, 90.0, 150.0, 170.0, 70.0, 30.0, 140.0, 50.0, 100.0, 50.0, 40.0, 69.0, 70.0, 90.0, 160.0, 80.0, 180.0, 150.0, 70.0, 100.0, 148.0, 86.0, 150.0, 130.0, 110.0, 170.0, 138.0, 90.0, 30.0, 57.0, 100.0, 90.0, 68.0, 11.0, 70.0, 140.0, 60.0, 200.0, 244.0, 100.0, 60.0, 67.0, 180.0, 70.0, 35.0, 50.0, 30.0, 77.0, 120.0, 25.0, 130.0, 15.0, 150.0, 60.0, 150.0, 70.0, 150.0, 120.0, 50.0, 40.0, 190.0, 90.0, -20.0, 170.0, 90.0, 60.0, 120.0, 110.0, 110.0, 150.0, 190.0, 60.0, 50.0, 80.0, 100.0, 80.0, 180.0, 90.0, 40.0, 120.0, 200.0, 180.0, 110.0, 70.0, 50.0, 80.0, 40.0, 76.0, 40.0, 90.0, 80.0, 130.0, 19.0, 100.0, 100.0, 135.0, 140.0, 160.0, 150.0, 140.0, 80.0, -3.0, 107.0, 70.0, 90.0, 50.0, 90.0, 10.0, 4.0, 70.0, 149.0, 120.0, 100.0, 80.0, 89.0, 70.0, 130.0, 50.0, 146.0, 75.0, 110.0, 90.0, 120.0, 270.0, 59.0, 119.0, 129.0, 110.0, 100.0, 130.0, 160.0, 170.0, 140.0, 90.0, 180.0, 110.0, 110.0, 80.0, 100.0, 169.0, 134.0, 190.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6493233974731987, "mean_inference_ms": 1.647873211831411, "mean_action_processing_ms": 0.5040232259584019, "mean_env_wait_ms": 1.133572878485175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011551618576049805, "StateBufferConnector_ms": 0.008940935134887695, "ViewRequirementAgentConnector_ms": 0.3890225887298584}, "num_episodes": 22, "episode_return_max": 1460.0, "episode_return_min": 565.0, "episode_return_mean": 996.32}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.682808877704215, "num_env_steps_trained_throughput_per_sec": 20.682808877704215, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 4880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4880000, "timers": {"training_iteration_time_ms": 193808.034, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193807.989, "sample_time_ms": 2521.439, "learn_time_ms": 191267.764, "learn_throughput": 20.913, "synch_weights_time_ms": 10.456}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "done": false, "training_iteration": 122, "trial_id": "1841f_00000", "date": "2024-08-08_06-16-37", "timestamp": 1723112197, "time_this_iter_s": 193.40888905525208, "time_total_s": 24980.663036823273, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29455e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24980.663036823273, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 16.915750915750916, "ram_util_percent": 77.99157509157509}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4019718550264644, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.404224753811464, "policy_loss": -0.014652325565846393, "vf_loss": 8.416846872823307, "vf_explained_var": -0.005719115171696558, "kl": 0.006767343682039643, "entropy": 0.525105922741377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1150275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "env_runners": {"episode_reward_max": 1460.0, "episode_reward_min": 580.0, "episode_reward_mean": 990.69, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -131.0}, "policy_reward_max": {"policy_0": 330.0}, "policy_reward_mean": {"policy_0": 99.069}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1005.0, 580.0, 1031.0, 1254.0, 1110.0, 1055.0, 1230.0, 974.0, 1000.0, 756.0, 892.0, 894.0, 909.0, 835.0, 1180.0, 639.0, 876.0, 1175.0, 1174.0, 1070.0, 1150.0, 965.0, 713.0, 1107.0, 820.0, 1040.0, 1047.0, 1050.0, 746.0, 1150.0, 870.0, 964.0, 840.0, 1250.0, 738.0, 1100.0, 1020.0, 990.0, 760.0, 1050.0, 1169.0, 925.0, 1460.0, 1032.0, 1130.0, 909.0, 1113.0, 880.0, 1316.0, 789.0, 1005.0, 1071.0, 1121.0, 798.0, 1245.0, 580.0, 889.0, 1090.0, 883.0, 960.0, 1161.0, 998.0, 1020.0, 810.0, 1060.0, 983.0, 1380.0, 960.0, 789.0, 1214.0, 983.0, 1132.0, 702.0, 900.0, 1110.0, 1180.0, 675.0, 1109.0, 753.0, 960.0, 1387.0, 1243.0, 897.0, 914.0, 1085.0, 929.0, 1075.0, 936.0, 927.0, 887.0, 960.0, 770.0, 1085.0, 937.0, 1069.0, 735.0, 961.0, 885.0, 904.0, 1230.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [210.0, 70.0, 95.0, 120.0, 40.0, 100.0, 100.0, 60.0, 140.0, 70.0, 80.0, 10.0, 60.0, 30.0, 50.0, 90.0, 0.0, 70.0, 90.0, 100.0, 117.0, 100.0, 210.0, 15.0, 110.0, 100.0, 120.0, 39.0, 90.0, 130.0, 90.0, 130.0, 50.0, 220.0, 170.0, 83.0, 140.0, 101.0, 150.0, 120.0, 140.0, 110.0, 150.0, 130.0, 30.0, 120.0, 80.0, 100.0, 160.0, 90.0, 30.0, 70.0, 80.0, 140.0, 120.0, 128.0, 117.0, 150.0, 140.0, 80.0, 190.0, 90.0, 70.0, 140.0, 60.0, 170.0, 160.0, 180.0, 90.0, 80.0, 47.0, 88.0, 50.0, 110.0, 150.0, 115.0, 90.0, 54.0, 170.0, 100.0, 60.0, 150.0, 150.0, 130.0, 100.0, 60.0, 80.0, 120.0, 80.0, 70.0, 30.0, 20.0, 256.0, 30.0, 110.0, 40.0, 120.0, 30.0, 70.0, 50.0, 126.0, 90.0, 50.0, 120.0, 109.0, 50.0, 60.0, 140.0, 80.0, 67.0, 110.0, 90.0, 40.0, 100.0, 120.0, 60.0, 110.0, 14.0, 130.0, 120.0, 132.0, 120.0, 160.0, 90.0, 110.0, 30.0, 0.0, 17.0, 180.0, 70.0, 60.0, 90.0, 50.0, 180.0, 75.0, 100.0, 130.0, 80.0, 50.0, 20.0, 170.0, 120.0, 140.0, 200.0, 140.0, 90.0, 70.0, 90.0, 100.0, 60.0, 100.0, 30.0, 60.0, 80.0, 40.0, 110.0, 119.0, 30.0, 50.0, 20.0, 210.0, 80.0, 90.0, 90.0, 150.0, 80.0, 45.0, 80.0, 50.0, 1.0, 47.0, 80.0, 78.0, 40.0, 160.0, 70.0, 180.0, 140.0, 280.0, 100.0, 100.0, 160.0, 70.0, 110.0, 128.0, 60.0, 180.0, 120.0, 90.0, 156.0, 100.0, 80.0, 120.0, 120.0, 170.0, 40.0, 90.0, 110.0, 80.0, 160.0, 70.0, 110.0, 160.0, 280.0, 100.0, 110.0, 100.0, 60.0, 60.0, 100.0, 100.0, 90.0, 110.0, 30.0, 110.0, 37.0, 100.0, 168.0, 110.0, 110.0, 110.0, 74.0, 70.0, 80.0, 100.0, 50.0, 60.0, 59.0, 40.0, 70.0, 130.0, 125.0, 120.0, 90.0, 160.0, 70.0, 100.0, 62.0, 110.0, 140.0, 115.0, 80.0, 90.0, 70.0, 80.0, 70.0, 50.0, 90.0, 35.0, 140.0, 150.0, 25.0, 130.0, 190.0, 130.0, 100.0, 90.0, 90.0, 130.0, 5.0, 120.0, 150.0, 80.0, 80.0, 123.0, 120.0, 44.0, 90.0, 190.0, 50.0, 100.0, 110.0, 150.0, 130.0, 10.0, 90.0, 90.0, 190.0, 130.0, 50.0, 90.0, 100.0, 120.0, 150.0, 40.0, 60.0, 77.0, 40.0, 39.0, 30.0, 100.0, 90.0, 110.0, 170.0, 90.0, 80.0, 80.0, 140.0, 160.0, 130.0, 130.0, 170.0, 5.0, 118.0, 20.0, 130.0, 160.0, 40.0, 30.0, 67.0, 123.0, 110.0, 220.0, 100.0, 71.0, 160.0, 45.0, 100.0, 50.0, -15.0, 90.0, 100.0, 30.0, 70.0, 120.0, 80.0, 100.0, 40.0, 40.0, 170.0, 180.0, 80.0, 130.0, 90.0, 70.0, 150.0, 160.0, 90.0, 130.0, 170.0, 90.0, 60.0, 18.0, 30.0, 50.0, 130.0, 100.0, 130.0, 110.0, 20.0, 90.0, 60.0, 140.0, 60.0, 100.0, 80.0, 240.0, 200.0, 80.0, 50.0, 90.0, 80.0, 100.0, 60.0, 140.0, 100.0, 130.0, 110.0, 100.0, 110.0, 90.0, 140.0, 150.0, 100.0, 70.0, 150.0, 50.0, 110.0, 30.0, 100.0, 50.0, 190.0, 60.0, 40.0, 50.0, 40.0, 40.0, 40.0, 130.0, 120.0, 130.0, 100.0, 60.0, 180.0, 90.0, 70.0, 130.0, 40.0, 120.0, 130.0, 40.0, 110.0, 180.0, 120.0, 120.0, 70.0, 114.0, 120.0, 170.0, 125.0, 80.0, 75.0, 100.0, 180.0, 100.0, 68.0, 128.0, 130.0, 60.0, 4.0, 240.0, 10.0, 230.0, 90.0, 100.0, 70.0, 280.0, 110.0, 190.0, 140.0, 100.0, 48.0, 130.0, 110.0, 150.0, 119.0, 70.0, 100.0, 80.0, 125.0, 160.0, 100.0, 120.0, 130.0, 80.0, 100.0, 160.0, 110.0, 120.0, 50.0, 130.0, 20.0, 110.0, 120.0, 89.0, 110.0, 90.0, 90.0, 30.0, 120.0, 90.0, 110.0, 150.0, 70.0, 140.0, 110.0, 126.0, 137.0, 50.0, 130.0, 240.0, 90.0, 30.0, 100.0, 20.0, 19.0, 140.0, 10.0, 170.0, 61.0, 260.0, 70.0, 90.0, 190.0, 60.0, 200.0, 110.0, 110.0, 140.0, 86.0, 140.0, 90.0, 110.0, 110.0, 110.0, 60.0, 96.0, -15.0, 50.0, 38.0, 120.0, 80.0, 100.0, 140.0, 60.0, 120.0, 55.0, 140.0, 130.0, 60.0, 140.0, 84.0, 96.0, 180.0, 20.0, 32.0, 110.0, 160.0, 105.0, 144.0, 110.0, 84.0, 130.0, 140.0, 117.0, 190.0, 90.0, 60.0, 40.0, 160.0, 100.0, 60.0, 120.0, 47.0, 150.0, 78.0, 80.0, 65.0, 48.0, 50.0, 100.0, 210.0, 160.0, 70.0, 80.0, 190.0, 80.0, 190.0, 100.0, 65.0, 30.0, 50.0, 90.0, 60.0, 80.0, 100.0, 70.0, 30.0, 40.0, 30.0, 60.0, 70.0, 70.0, 11.0, 170.0, 190.0, 7.0, 81.0, 40.0, 190.0, 180.0, 180.0, 60.0, 60.0, 100.0, 30.0, 220.0, 100.0, 120.0, 40.0, 60.0, 100.0, 97.0, 70.0, 79.0, 39.0, 90.0, 120.0, -32.0, 260.0, 80.0, 70.0, 70.0, 90.0, 50.0, 200.0, 50.0, 70.0, 140.0, 140.0, 130.0, 110.0, 68.0, 170.0, 190.0, 35.0, 120.0, 58.0, 130.0, 150.0, 22.0, 170.0, 80.0, 70.0, 89.0, 90.0, 190.0, 60.0, 161.0, 66.0, 130.0, 150.0, 50.0, 100.0, 160.0, 110.0, 80.0, 50.0, 120.0, 70.0, 110.0, 50.0, 70.0, 40.0, 120.0, 40.0, 110.0, 70.0, 140.0, 60.0, 110.0, 110.0, 70.0, 150.0, 100.0, 80.0, 80.0, 170.0, 120.0, 70.0, 70.0, 120.0, 170.0, 130.0, -35.0, 170.0, 110.0, 88.0, 60.0, 100.0, 140.0, 180.0, 120.0, 180.0, 110.0, 120.0, 190.0, 110.0, 110.0, 120.0, 120.0, 100.0, 100.0, 80.0, 130.0, 100.0, 50.0, 40.0, 90.0, 150.0, 170.0, 70.0, 30.0, 140.0, 50.0, 100.0, 50.0, 40.0, 69.0, 70.0, 90.0, 160.0, 80.0, 180.0, 150.0, 70.0, 100.0, 148.0, 86.0, 150.0, 130.0, 110.0, 170.0, 138.0, 90.0, 30.0, 57.0, 100.0, 90.0, 68.0, 11.0, 70.0, 140.0, 60.0, 200.0, 244.0, 100.0, 60.0, 67.0, 180.0, 70.0, 35.0, 50.0, 30.0, 77.0, 120.0, 25.0, 130.0, 15.0, 150.0, 60.0, 150.0, 70.0, 150.0, 120.0, 50.0, 40.0, 190.0, 90.0, -20.0, 170.0, 90.0, 60.0, 120.0, 110.0, 110.0, 150.0, 190.0, 60.0, 50.0, 80.0, 100.0, 80.0, 180.0, 90.0, 40.0, 120.0, 200.0, 180.0, 110.0, 70.0, 50.0, 80.0, 40.0, 76.0, 40.0, 90.0, 80.0, 130.0, 19.0, 100.0, 100.0, 135.0, 140.0, 160.0, 150.0, 140.0, 80.0, -3.0, 107.0, 70.0, 90.0, 50.0, 90.0, 10.0, 4.0, 70.0, 149.0, 120.0, 100.0, 80.0, 89.0, 70.0, 130.0, 50.0, 146.0, 75.0, 110.0, 90.0, 120.0, 270.0, 59.0, 119.0, 129.0, 110.0, 100.0, 130.0, 160.0, 170.0, 140.0, 90.0, 180.0, 110.0, 110.0, 80.0, 100.0, 169.0, 134.0, 190.0, 80.0, 100.0, 190.0, 90.0, 5.0, 85.0, 27.0, 100.0, 180.0, 70.0, 50.0, 47.0, 87.0, 70.0, 100.0, 140.0, 90.0, 100.0, 150.0, 80.0, 50.0, 50.0, 178.0, 30.0, 59.0, 100.0, 160.0, 200.0, 169.0, 89.0, 50.0, 100.0, 80.0, 100.0, 90.0, 75.0, 110.0, 120.0, 104.0, 50.0, 100.0, 70.0, 140.0, 150.0, 50.0, 60.0, 147.0, 80.0, 58.0, 100.0, 220.0, 125.0, 130.0, 90.0, 120.0, 51.0, 150.0, 60.0, 60.0, 90.0, 60.0, 60.0, 164.0, 70.0, 63.0, 40.0, 80.0, 140.0, 70.0, 40.0, 200.0, 41.0, 75.0, 80.0, 18.0, 200.0, 32.0, 70.0, 230.0, 70.0, 71.0, 30.0, 130.0, 110.0, 147.0, 80.0, 69.0, 115.0, 80.0, 139.0, 60.0, 130.0, 60.0, 60.0, 60.0, 170.0, 70.0, 40.0, 80.0, 60.0, 40.0, 290.0, 130.0, 78.0, 100.0, 110.0, 186.0, 100.0, 112.0, -131.0, 110.0, 79.0, 170.0, 150.0, 160.0, 40.0, 100.0, 100.0, 70.0, 28.0, 40.0, 120.0, 32.0, 110.0, 150.0, 100.0, 100.0, 140.0, 177.0, 70.0, 70.0, 80.0, 120.0, 70.0, 130.0, 30.0, 60.0, 70.0, 60.0, 50.0, 65.0, 130.0, 70.0, 90.0, 50.0, 169.0, 100.0, 80.0, 20.0, 92.0, 160.0, 60.0, 200.0, 45.0, 10.0, 90.0, 90.0, 110.0, 100.0, 110.0, 70.0, 60.0, 40.0, 100.0, 100.0, 65.0, -8.0, 70.0, 87.0, 330.0, 60.0, 180.0, 50.0, 171.0, 80.0, 21.0, 110.0, 160.0, 110.0, 289.0, 59.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.64742466844818, "mean_inference_ms": 1.6455361210688018, "mean_action_processing_ms": 0.5035696920979191, "mean_env_wait_ms": 1.1325433311253275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011399984359741211, "StateBufferConnector_ms": 0.008868217468261719, "ViewRequirementAgentConnector_ms": 0.39322519302368164}, "num_episodes": 18, "episode_return_max": 1460.0, "episode_return_min": 580.0, "episode_return_mean": 990.69}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.578900861115763, "num_env_steps_trained_throughput_per_sec": 20.578900861115763, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 4920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4920000, "timers": {"training_iteration_time_ms": 193919.393, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193919.348, "sample_time_ms": 2521.974, "learn_time_ms": 191378.29, "learn_throughput": 20.901, "synch_weights_time_ms": 10.698}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "done": false, "training_iteration": 123, "trial_id": "1841f_00000", "date": "2024-08-08_06-19-51", "timestamp": 1723112391, "time_this_iter_s": 194.38403296470642, "time_total_s": 25175.04706978798, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2945c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25175.04706978798, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 17.465454545454545, "ram_util_percent": 77.90072727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.681772400973577, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.015201020902888086, "vf_loss": 8.379067132978268, "vf_explained_var": -0.003293007694748136, "kl": Infinity, "entropy": 0.5287864085235281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1159665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "env_runners": {"episode_reward_max": 1460.0, "episode_reward_min": 580.0, "episode_reward_mean": 989.64, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -131.0}, "policy_reward_max": {"policy_0": 330.0}, "policy_reward_mean": {"policy_0": 98.964}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1174.0, 1070.0, 1150.0, 965.0, 713.0, 1107.0, 820.0, 1040.0, 1047.0, 1050.0, 746.0, 1150.0, 870.0, 964.0, 840.0, 1250.0, 738.0, 1100.0, 1020.0, 990.0, 760.0, 1050.0, 1169.0, 925.0, 1460.0, 1032.0, 1130.0, 909.0, 1113.0, 880.0, 1316.0, 789.0, 1005.0, 1071.0, 1121.0, 798.0, 1245.0, 580.0, 889.0, 1090.0, 883.0, 960.0, 1161.0, 998.0, 1020.0, 810.0, 1060.0, 983.0, 1380.0, 960.0, 789.0, 1214.0, 983.0, 1132.0, 702.0, 900.0, 1110.0, 1180.0, 675.0, 1109.0, 753.0, 960.0, 1387.0, 1243.0, 897.0, 914.0, 1085.0, 929.0, 1075.0, 936.0, 927.0, 887.0, 960.0, 770.0, 1085.0, 937.0, 1069.0, 735.0, 961.0, 885.0, 904.0, 1230.0, 936.0, 806.0, 1060.0, 950.0, 959.0, 890.0, 1162.0, 777.0, 982.0, 731.0, 1090.0, 788.0, 622.0, 903.0, 970.0, 1109.0, 1235.0, 1320.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 160.0, 70.0, 110.0, 128.0, 60.0, 180.0, 120.0, 90.0, 156.0, 100.0, 80.0, 120.0, 120.0, 170.0, 40.0, 90.0, 110.0, 80.0, 160.0, 70.0, 110.0, 160.0, 280.0, 100.0, 110.0, 100.0, 60.0, 60.0, 100.0, 100.0, 90.0, 110.0, 30.0, 110.0, 37.0, 100.0, 168.0, 110.0, 110.0, 110.0, 74.0, 70.0, 80.0, 100.0, 50.0, 60.0, 59.0, 40.0, 70.0, 130.0, 125.0, 120.0, 90.0, 160.0, 70.0, 100.0, 62.0, 110.0, 140.0, 115.0, 80.0, 90.0, 70.0, 80.0, 70.0, 50.0, 90.0, 35.0, 140.0, 150.0, 25.0, 130.0, 190.0, 130.0, 100.0, 90.0, 90.0, 130.0, 5.0, 120.0, 150.0, 80.0, 80.0, 123.0, 120.0, 44.0, 90.0, 190.0, 50.0, 100.0, 110.0, 150.0, 130.0, 10.0, 90.0, 90.0, 190.0, 130.0, 50.0, 90.0, 100.0, 120.0, 150.0, 40.0, 60.0, 77.0, 40.0, 39.0, 30.0, 100.0, 90.0, 110.0, 170.0, 90.0, 80.0, 80.0, 140.0, 160.0, 130.0, 130.0, 170.0, 5.0, 118.0, 20.0, 130.0, 160.0, 40.0, 30.0, 67.0, 123.0, 110.0, 220.0, 100.0, 71.0, 160.0, 45.0, 100.0, 50.0, -15.0, 90.0, 100.0, 30.0, 70.0, 120.0, 80.0, 100.0, 40.0, 40.0, 170.0, 180.0, 80.0, 130.0, 90.0, 70.0, 150.0, 160.0, 90.0, 130.0, 170.0, 90.0, 60.0, 18.0, 30.0, 50.0, 130.0, 100.0, 130.0, 110.0, 20.0, 90.0, 60.0, 140.0, 60.0, 100.0, 80.0, 240.0, 200.0, 80.0, 50.0, 90.0, 80.0, 100.0, 60.0, 140.0, 100.0, 130.0, 110.0, 100.0, 110.0, 90.0, 140.0, 150.0, 100.0, 70.0, 150.0, 50.0, 110.0, 30.0, 100.0, 50.0, 190.0, 60.0, 40.0, 50.0, 40.0, 40.0, 40.0, 130.0, 120.0, 130.0, 100.0, 60.0, 180.0, 90.0, 70.0, 130.0, 40.0, 120.0, 130.0, 40.0, 110.0, 180.0, 120.0, 120.0, 70.0, 114.0, 120.0, 170.0, 125.0, 80.0, 75.0, 100.0, 180.0, 100.0, 68.0, 128.0, 130.0, 60.0, 4.0, 240.0, 10.0, 230.0, 90.0, 100.0, 70.0, 280.0, 110.0, 190.0, 140.0, 100.0, 48.0, 130.0, 110.0, 150.0, 119.0, 70.0, 100.0, 80.0, 125.0, 160.0, 100.0, 120.0, 130.0, 80.0, 100.0, 160.0, 110.0, 120.0, 50.0, 130.0, 20.0, 110.0, 120.0, 89.0, 110.0, 90.0, 90.0, 30.0, 120.0, 90.0, 110.0, 150.0, 70.0, 140.0, 110.0, 126.0, 137.0, 50.0, 130.0, 240.0, 90.0, 30.0, 100.0, 20.0, 19.0, 140.0, 10.0, 170.0, 61.0, 260.0, 70.0, 90.0, 190.0, 60.0, 200.0, 110.0, 110.0, 140.0, 86.0, 140.0, 90.0, 110.0, 110.0, 110.0, 60.0, 96.0, -15.0, 50.0, 38.0, 120.0, 80.0, 100.0, 140.0, 60.0, 120.0, 55.0, 140.0, 130.0, 60.0, 140.0, 84.0, 96.0, 180.0, 20.0, 32.0, 110.0, 160.0, 105.0, 144.0, 110.0, 84.0, 130.0, 140.0, 117.0, 190.0, 90.0, 60.0, 40.0, 160.0, 100.0, 60.0, 120.0, 47.0, 150.0, 78.0, 80.0, 65.0, 48.0, 50.0, 100.0, 210.0, 160.0, 70.0, 80.0, 190.0, 80.0, 190.0, 100.0, 65.0, 30.0, 50.0, 90.0, 60.0, 80.0, 100.0, 70.0, 30.0, 40.0, 30.0, 60.0, 70.0, 70.0, 11.0, 170.0, 190.0, 7.0, 81.0, 40.0, 190.0, 180.0, 180.0, 60.0, 60.0, 100.0, 30.0, 220.0, 100.0, 120.0, 40.0, 60.0, 100.0, 97.0, 70.0, 79.0, 39.0, 90.0, 120.0, -32.0, 260.0, 80.0, 70.0, 70.0, 90.0, 50.0, 200.0, 50.0, 70.0, 140.0, 140.0, 130.0, 110.0, 68.0, 170.0, 190.0, 35.0, 120.0, 58.0, 130.0, 150.0, 22.0, 170.0, 80.0, 70.0, 89.0, 90.0, 190.0, 60.0, 161.0, 66.0, 130.0, 150.0, 50.0, 100.0, 160.0, 110.0, 80.0, 50.0, 120.0, 70.0, 110.0, 50.0, 70.0, 40.0, 120.0, 40.0, 110.0, 70.0, 140.0, 60.0, 110.0, 110.0, 70.0, 150.0, 100.0, 80.0, 80.0, 170.0, 120.0, 70.0, 70.0, 120.0, 170.0, 130.0, -35.0, 170.0, 110.0, 88.0, 60.0, 100.0, 140.0, 180.0, 120.0, 180.0, 110.0, 120.0, 190.0, 110.0, 110.0, 120.0, 120.0, 100.0, 100.0, 80.0, 130.0, 100.0, 50.0, 40.0, 90.0, 150.0, 170.0, 70.0, 30.0, 140.0, 50.0, 100.0, 50.0, 40.0, 69.0, 70.0, 90.0, 160.0, 80.0, 180.0, 150.0, 70.0, 100.0, 148.0, 86.0, 150.0, 130.0, 110.0, 170.0, 138.0, 90.0, 30.0, 57.0, 100.0, 90.0, 68.0, 11.0, 70.0, 140.0, 60.0, 200.0, 244.0, 100.0, 60.0, 67.0, 180.0, 70.0, 35.0, 50.0, 30.0, 77.0, 120.0, 25.0, 130.0, 15.0, 150.0, 60.0, 150.0, 70.0, 150.0, 120.0, 50.0, 40.0, 190.0, 90.0, -20.0, 170.0, 90.0, 60.0, 120.0, 110.0, 110.0, 150.0, 190.0, 60.0, 50.0, 80.0, 100.0, 80.0, 180.0, 90.0, 40.0, 120.0, 200.0, 180.0, 110.0, 70.0, 50.0, 80.0, 40.0, 76.0, 40.0, 90.0, 80.0, 130.0, 19.0, 100.0, 100.0, 135.0, 140.0, 160.0, 150.0, 140.0, 80.0, -3.0, 107.0, 70.0, 90.0, 50.0, 90.0, 10.0, 4.0, 70.0, 149.0, 120.0, 100.0, 80.0, 89.0, 70.0, 130.0, 50.0, 146.0, 75.0, 110.0, 90.0, 120.0, 270.0, 59.0, 119.0, 129.0, 110.0, 100.0, 130.0, 160.0, 170.0, 140.0, 90.0, 180.0, 110.0, 110.0, 80.0, 100.0, 169.0, 134.0, 190.0, 80.0, 100.0, 190.0, 90.0, 5.0, 85.0, 27.0, 100.0, 180.0, 70.0, 50.0, 47.0, 87.0, 70.0, 100.0, 140.0, 90.0, 100.0, 150.0, 80.0, 50.0, 50.0, 178.0, 30.0, 59.0, 100.0, 160.0, 200.0, 169.0, 89.0, 50.0, 100.0, 80.0, 100.0, 90.0, 75.0, 110.0, 120.0, 104.0, 50.0, 100.0, 70.0, 140.0, 150.0, 50.0, 60.0, 147.0, 80.0, 58.0, 100.0, 220.0, 125.0, 130.0, 90.0, 120.0, 51.0, 150.0, 60.0, 60.0, 90.0, 60.0, 60.0, 164.0, 70.0, 63.0, 40.0, 80.0, 140.0, 70.0, 40.0, 200.0, 41.0, 75.0, 80.0, 18.0, 200.0, 32.0, 70.0, 230.0, 70.0, 71.0, 30.0, 130.0, 110.0, 147.0, 80.0, 69.0, 115.0, 80.0, 139.0, 60.0, 130.0, 60.0, 60.0, 60.0, 170.0, 70.0, 40.0, 80.0, 60.0, 40.0, 290.0, 130.0, 78.0, 100.0, 110.0, 186.0, 100.0, 112.0, -131.0, 110.0, 79.0, 170.0, 150.0, 160.0, 40.0, 100.0, 100.0, 70.0, 28.0, 40.0, 120.0, 32.0, 110.0, 150.0, 100.0, 100.0, 140.0, 177.0, 70.0, 70.0, 80.0, 120.0, 70.0, 130.0, 30.0, 60.0, 70.0, 60.0, 50.0, 65.0, 130.0, 70.0, 90.0, 50.0, 169.0, 100.0, 80.0, 20.0, 92.0, 160.0, 60.0, 200.0, 45.0, 10.0, 90.0, 90.0, 110.0, 100.0, 110.0, 70.0, 60.0, 40.0, 100.0, 100.0, 65.0, -8.0, 70.0, 87.0, 330.0, 60.0, 180.0, 50.0, 171.0, 80.0, 21.0, 110.0, 160.0, 110.0, 289.0, 59.0, 70.0, 100.0, 29.0, 140.0, 60.0, 140.0, 67.0, 110.0, 80.0, 140.0, 60.0, 70.0, 175.0, 59.0, 120.0, -25.0, 80.0, 140.0, 40.0, 87.0, 130.0, 60.0, 120.0, 130.0, 180.0, 80.0, 80.0, 100.0, 80.0, 100.0, 140.0, 90.0, 90.0, 60.0, 80.0, 30.0, 140.0, 110.0, 170.0, 40.0, 50.0, 210.0, 40.0, 160.0, 90.0, 19.0, 100.0, 160.0, 50.0, 80.0, 120.0, 230.0, 50.0, 20.0, 20.0, 50.0, 80.0, 130.0, 80.0, 110.0, 97.0, 120.0, 70.0, 86.0, 125.0, 220.0, 100.0, 114.0, 100.0, 130.0, 78.0, 16.0, 126.0, 40.0, 70.0, 140.0, 50.0, 50.0, 97.0, 110.0, 110.0, 67.0, 210.0, 100.0, 130.0, 93.0, 90.0, 87.0, 70.0, 25.0, 130.0, 30.0, 130.0, 61.0, 99.0, 60.0, 100.0, 20.0, 80.0, 21.0, 120.0, 110.0, 150.0, 80.0, 140.0, 90.0, 100.0, 70.0, 80.0, 150.0, 80.0, 70.0, 47.0, 110.0, 10.0, 120.0, 100.0, 50.0, 115.0, 86.0, 50.0, 50.0, 112.0, 129.0, 100.0, 20.0, 90.0, 2.0, 39.0, 30.0, 70.0, 60.0, 30.0, 200.0, 50.0, 80.0, 110.0, 98.0, 90.0, 115.0, 110.0, 190.0, 60.0, 150.0, 90.0, 40.0, 60.0, 130.0, 100.0, 40.0, 180.0, 220.0, 19.0, 180.0, 50.0, 95.0, 100.0, 66.0, 59.0, 140.0, 140.0, 120.0, 140.0, 65.0, 110.0, 120.0, 140.0, 130.0, 110.0, 160.0, 48.0, 100.0, 268.0, 130.0, 210.0, 100.0, 160.0, 197.0, 60.0, 47.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6454328817479182, "mean_inference_ms": 1.6430840139106302, "mean_action_processing_ms": 0.5031085204876442, "mean_env_wait_ms": 1.1314473339306845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011407136917114258, "StateBufferConnector_ms": 0.008848428726196289, "ViewRequirementAgentConnector_ms": 0.39218950271606445}, "num_episodes": 18, "episode_return_max": 1460.0, "episode_return_min": 580.0, "episode_return_mean": 989.64}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.60999502776912, "num_env_steps_trained_throughput_per_sec": 20.60999502776912, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 4960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4960000, "timers": {"training_iteration_time_ms": 194039.165, "restore_workers_time_ms": 0.011, "training_step_time_ms": 194039.118, "sample_time_ms": 2504.846, "learn_time_ms": 191515.102, "learn_throughput": 20.886, "synch_weights_time_ms": 10.773}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "done": false, "training_iteration": 124, "trial_id": "1841f_00000", "date": "2024-08-08_06-23-06", "timestamp": 1723112586, "time_this_iter_s": 194.09273409843445, "time_total_s": 25369.139803886414, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2945e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25369.139803886414, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 17.46690909090909, "ram_util_percent": 77.06763636363635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7848380423011108, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.482991150621409, "policy_loss": -0.014933599403407723, "vf_loss": 8.495398958295551, "vf_explained_var": 1.497801246480566e-05, "kl": 0.005612881519671803, "entropy": 0.5310772100195718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1169055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "env_runners": {"episode_reward_max": 1460.0, "episode_reward_min": 350.0, "episode_reward_mean": 980.43, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -131.0}, "policy_reward_max": {"policy_0": 330.0}, "policy_reward_mean": {"policy_0": 98.043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [925.0, 1460.0, 1032.0, 1130.0, 909.0, 1113.0, 880.0, 1316.0, 789.0, 1005.0, 1071.0, 1121.0, 798.0, 1245.0, 580.0, 889.0, 1090.0, 883.0, 960.0, 1161.0, 998.0, 1020.0, 810.0, 1060.0, 983.0, 1380.0, 960.0, 789.0, 1214.0, 983.0, 1132.0, 702.0, 900.0, 1110.0, 1180.0, 675.0, 1109.0, 753.0, 960.0, 1387.0, 1243.0, 897.0, 914.0, 1085.0, 929.0, 1075.0, 936.0, 927.0, 887.0, 960.0, 770.0, 1085.0, 937.0, 1069.0, 735.0, 961.0, 885.0, 904.0, 1230.0, 936.0, 806.0, 1060.0, 950.0, 959.0, 890.0, 1162.0, 777.0, 982.0, 731.0, 1090.0, 788.0, 622.0, 903.0, 970.0, 1109.0, 1235.0, 1320.0, 930.0, 1030.0, 984.0, 1060.0, 808.0, 1154.0, 1097.0, 1041.0, 745.0, 929.0, 791.0, 983.0, 1021.0, 1040.0, 979.0, 1067.0, 843.0, 350.0, 890.0, 792.0, 1234.0, 759.0, 1335.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 75.0, 100.0, 180.0, 100.0, 68.0, 128.0, 130.0, 60.0, 4.0, 240.0, 10.0, 230.0, 90.0, 100.0, 70.0, 280.0, 110.0, 190.0, 140.0, 100.0, 48.0, 130.0, 110.0, 150.0, 119.0, 70.0, 100.0, 80.0, 125.0, 160.0, 100.0, 120.0, 130.0, 80.0, 100.0, 160.0, 110.0, 120.0, 50.0, 130.0, 20.0, 110.0, 120.0, 89.0, 110.0, 90.0, 90.0, 30.0, 120.0, 90.0, 110.0, 150.0, 70.0, 140.0, 110.0, 126.0, 137.0, 50.0, 130.0, 240.0, 90.0, 30.0, 100.0, 20.0, 19.0, 140.0, 10.0, 170.0, 61.0, 260.0, 70.0, 90.0, 190.0, 60.0, 200.0, 110.0, 110.0, 140.0, 86.0, 140.0, 90.0, 110.0, 110.0, 110.0, 60.0, 96.0, -15.0, 50.0, 38.0, 120.0, 80.0, 100.0, 140.0, 60.0, 120.0, 55.0, 140.0, 130.0, 60.0, 140.0, 84.0, 96.0, 180.0, 20.0, 32.0, 110.0, 160.0, 105.0, 144.0, 110.0, 84.0, 130.0, 140.0, 117.0, 190.0, 90.0, 60.0, 40.0, 160.0, 100.0, 60.0, 120.0, 47.0, 150.0, 78.0, 80.0, 65.0, 48.0, 50.0, 100.0, 210.0, 160.0, 70.0, 80.0, 190.0, 80.0, 190.0, 100.0, 65.0, 30.0, 50.0, 90.0, 60.0, 80.0, 100.0, 70.0, 30.0, 40.0, 30.0, 60.0, 70.0, 70.0, 11.0, 170.0, 190.0, 7.0, 81.0, 40.0, 190.0, 180.0, 180.0, 60.0, 60.0, 100.0, 30.0, 220.0, 100.0, 120.0, 40.0, 60.0, 100.0, 97.0, 70.0, 79.0, 39.0, 90.0, 120.0, -32.0, 260.0, 80.0, 70.0, 70.0, 90.0, 50.0, 200.0, 50.0, 70.0, 140.0, 140.0, 130.0, 110.0, 68.0, 170.0, 190.0, 35.0, 120.0, 58.0, 130.0, 150.0, 22.0, 170.0, 80.0, 70.0, 89.0, 90.0, 190.0, 60.0, 161.0, 66.0, 130.0, 150.0, 50.0, 100.0, 160.0, 110.0, 80.0, 50.0, 120.0, 70.0, 110.0, 50.0, 70.0, 40.0, 120.0, 40.0, 110.0, 70.0, 140.0, 60.0, 110.0, 110.0, 70.0, 150.0, 100.0, 80.0, 80.0, 170.0, 120.0, 70.0, 70.0, 120.0, 170.0, 130.0, -35.0, 170.0, 110.0, 88.0, 60.0, 100.0, 140.0, 180.0, 120.0, 180.0, 110.0, 120.0, 190.0, 110.0, 110.0, 120.0, 120.0, 100.0, 100.0, 80.0, 130.0, 100.0, 50.0, 40.0, 90.0, 150.0, 170.0, 70.0, 30.0, 140.0, 50.0, 100.0, 50.0, 40.0, 69.0, 70.0, 90.0, 160.0, 80.0, 180.0, 150.0, 70.0, 100.0, 148.0, 86.0, 150.0, 130.0, 110.0, 170.0, 138.0, 90.0, 30.0, 57.0, 100.0, 90.0, 68.0, 11.0, 70.0, 140.0, 60.0, 200.0, 244.0, 100.0, 60.0, 67.0, 180.0, 70.0, 35.0, 50.0, 30.0, 77.0, 120.0, 25.0, 130.0, 15.0, 150.0, 60.0, 150.0, 70.0, 150.0, 120.0, 50.0, 40.0, 190.0, 90.0, -20.0, 170.0, 90.0, 60.0, 120.0, 110.0, 110.0, 150.0, 190.0, 60.0, 50.0, 80.0, 100.0, 80.0, 180.0, 90.0, 40.0, 120.0, 200.0, 180.0, 110.0, 70.0, 50.0, 80.0, 40.0, 76.0, 40.0, 90.0, 80.0, 130.0, 19.0, 100.0, 100.0, 135.0, 140.0, 160.0, 150.0, 140.0, 80.0, -3.0, 107.0, 70.0, 90.0, 50.0, 90.0, 10.0, 4.0, 70.0, 149.0, 120.0, 100.0, 80.0, 89.0, 70.0, 130.0, 50.0, 146.0, 75.0, 110.0, 90.0, 120.0, 270.0, 59.0, 119.0, 129.0, 110.0, 100.0, 130.0, 160.0, 170.0, 140.0, 90.0, 180.0, 110.0, 110.0, 80.0, 100.0, 169.0, 134.0, 190.0, 80.0, 100.0, 190.0, 90.0, 5.0, 85.0, 27.0, 100.0, 180.0, 70.0, 50.0, 47.0, 87.0, 70.0, 100.0, 140.0, 90.0, 100.0, 150.0, 80.0, 50.0, 50.0, 178.0, 30.0, 59.0, 100.0, 160.0, 200.0, 169.0, 89.0, 50.0, 100.0, 80.0, 100.0, 90.0, 75.0, 110.0, 120.0, 104.0, 50.0, 100.0, 70.0, 140.0, 150.0, 50.0, 60.0, 147.0, 80.0, 58.0, 100.0, 220.0, 125.0, 130.0, 90.0, 120.0, 51.0, 150.0, 60.0, 60.0, 90.0, 60.0, 60.0, 164.0, 70.0, 63.0, 40.0, 80.0, 140.0, 70.0, 40.0, 200.0, 41.0, 75.0, 80.0, 18.0, 200.0, 32.0, 70.0, 230.0, 70.0, 71.0, 30.0, 130.0, 110.0, 147.0, 80.0, 69.0, 115.0, 80.0, 139.0, 60.0, 130.0, 60.0, 60.0, 60.0, 170.0, 70.0, 40.0, 80.0, 60.0, 40.0, 290.0, 130.0, 78.0, 100.0, 110.0, 186.0, 100.0, 112.0, -131.0, 110.0, 79.0, 170.0, 150.0, 160.0, 40.0, 100.0, 100.0, 70.0, 28.0, 40.0, 120.0, 32.0, 110.0, 150.0, 100.0, 100.0, 140.0, 177.0, 70.0, 70.0, 80.0, 120.0, 70.0, 130.0, 30.0, 60.0, 70.0, 60.0, 50.0, 65.0, 130.0, 70.0, 90.0, 50.0, 169.0, 100.0, 80.0, 20.0, 92.0, 160.0, 60.0, 200.0, 45.0, 10.0, 90.0, 90.0, 110.0, 100.0, 110.0, 70.0, 60.0, 40.0, 100.0, 100.0, 65.0, -8.0, 70.0, 87.0, 330.0, 60.0, 180.0, 50.0, 171.0, 80.0, 21.0, 110.0, 160.0, 110.0, 289.0, 59.0, 70.0, 100.0, 29.0, 140.0, 60.0, 140.0, 67.0, 110.0, 80.0, 140.0, 60.0, 70.0, 175.0, 59.0, 120.0, -25.0, 80.0, 140.0, 40.0, 87.0, 130.0, 60.0, 120.0, 130.0, 180.0, 80.0, 80.0, 100.0, 80.0, 100.0, 140.0, 90.0, 90.0, 60.0, 80.0, 30.0, 140.0, 110.0, 170.0, 40.0, 50.0, 210.0, 40.0, 160.0, 90.0, 19.0, 100.0, 160.0, 50.0, 80.0, 120.0, 230.0, 50.0, 20.0, 20.0, 50.0, 80.0, 130.0, 80.0, 110.0, 97.0, 120.0, 70.0, 86.0, 125.0, 220.0, 100.0, 114.0, 100.0, 130.0, 78.0, 16.0, 126.0, 40.0, 70.0, 140.0, 50.0, 50.0, 97.0, 110.0, 110.0, 67.0, 210.0, 100.0, 130.0, 93.0, 90.0, 87.0, 70.0, 25.0, 130.0, 30.0, 130.0, 61.0, 99.0, 60.0, 100.0, 20.0, 80.0, 21.0, 120.0, 110.0, 150.0, 80.0, 140.0, 90.0, 100.0, 70.0, 80.0, 150.0, 80.0, 70.0, 47.0, 110.0, 10.0, 120.0, 100.0, 50.0, 115.0, 86.0, 50.0, 50.0, 112.0, 129.0, 100.0, 20.0, 90.0, 2.0, 39.0, 30.0, 70.0, 60.0, 30.0, 200.0, 50.0, 80.0, 110.0, 98.0, 90.0, 115.0, 110.0, 190.0, 60.0, 150.0, 90.0, 40.0, 60.0, 130.0, 100.0, 40.0, 180.0, 220.0, 19.0, 180.0, 50.0, 95.0, 100.0, 66.0, 59.0, 140.0, 140.0, 120.0, 140.0, 65.0, 110.0, 120.0, 140.0, 130.0, 110.0, 160.0, 48.0, 100.0, 268.0, 130.0, 210.0, 100.0, 160.0, 197.0, 60.0, 47.0, 120.0, 90.0, 90.0, 90.0, 160.0, 70.0, 60.0, 140.0, 20.0, 90.0, 70.0, 130.0, 90.0, 140.0, 140.0, 40.0, 150.0, 50.0, 140.0, 80.0, 110.0, 40.0, 120.0, 150.0, 120.0, 60.0, 130.0, -6.0, 140.0, 120.0, 130.0, 110.0, 60.0, 90.0, 280.0, 130.0, 40.0, 90.0, 100.0, 30.0, 60.0, 90.0, 140.0, 50.0, 130.0, 100.0, 60.0, 50.0, 70.0, 58.0, 170.0, 130.0, 15.0, 160.0, 100.0, 67.0, 160.0, 190.0, 82.0, 80.0, 80.0, 10.0, 130.0, 100.0, 160.0, 128.0, 50.0, 99.0, 140.0, 200.0, 100.0, 50.0, 40.0, 90.0, 60.0, 170.0, 120.0, 170.0, 81.0, 160.0, -1.0, 90.0, 94.0, 90.0, 80.0, 19.0, 170.0, 4.0, 49.0, 150.0, 220.0, 5.0, 30.0, 140.0, 44.0, 100.0, 100.0, 160.0, 20.0, 110.0, 60.0, 100.0, 60.0, 130.0, 70.0, 80.0, 40.0, 50.0, 120.0, 81.0, 140.0, 50.0, 150.0, 90.0, 66.0, 57.0, 70.0, 20.0, 250.0, 90.0, 70.0, 100.0, 90.0, 140.0, 61.0, 110.0, 140.0, 40.0, 150.0, 120.0, 120.0, 100.0, 80.0, 70.0, 80.0, 60.0, 90.0, 170.0, 130.0, 140.0, 80.0, 70.0, 50.0, 79.0, 180.0, 160.0, 100.0, 20.0, 130.0, 110.0, 200.0, 110.0, 80.0, 120.0, 29.0, 60.0, 80.0, 120.0, 178.0, 90.0, 50.0, 110.0, 90.0, 60.0, 40.0, 53.0, 40.0, 120.0, 140.0, 140.0, 20.0, 57.0, 37.0, 3.0, 15.0, 10.0, 28.0, 100.0, 20.0, 60.0, 130.0, 80.0, 90.0, 70.0, 130.0, 70.0, 90.0, 130.0, 40.0, 60.0, 40.0, 150.0, 7.0, 120.0, 200.0, 70.0, 24.0, 32.0, 50.0, 99.0, 140.0, 120.0, 150.0, 200.0, 110.0, 167.0, 70.0, 30.0, 150.0, 97.0, 40.0, 70.0, 130.0, 60.0, 40.0, 200.0, 30.0, 80.0, 39.0, 70.0, 80.0, 220.0, 120.0, 90.0, 120.0, 200.0, 140.0, 110.0, 117.0, 138.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6430186778623865, "mean_inference_ms": 1.6402255575548497, "mean_action_processing_ms": 0.5025658592442267, "mean_env_wait_ms": 1.1301307489227908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011373043060302734, "StateBufferConnector_ms": 0.011814355850219727, "ViewRequirementAgentConnector_ms": 0.39232683181762695}, "num_episodes": 23, "episode_return_max": 1460.0, "episode_return_min": 350.0, "episode_return_mean": 980.43}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.752925569741524, "num_env_steps_trained_throughput_per_sec": 20.752925569741524, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 5000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5000000, "timers": {"training_iteration_time_ms": 193919.255, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193919.207, "sample_time_ms": 2498.562, "learn_time_ms": 191401.421, "learn_throughput": 20.898, "synch_weights_time_ms": 10.82}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "done": false, "training_iteration": 125, "trial_id": "1841f_00000", "date": "2024-08-08_06-26-18", "timestamp": 1723112778, "time_this_iter_s": 192.7551691532135, "time_total_s": 25561.894973039627, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b294d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25561.894973039627, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 16.852941176470587, "ram_util_percent": 76.73786764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8287268667048413, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.01583002083379422, "vf_loss": 8.685582563950739, "vf_explained_var": -0.0108800971025603, "kl": Infinity, "entropy": 0.543078838734708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1178445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 350.0, "episode_reward_mean": 974.87, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -131.0}, "policy_reward_max": {"policy_0": 330.0}, "policy_reward_mean": {"policy_0": 97.487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [960.0, 1161.0, 998.0, 1020.0, 810.0, 1060.0, 983.0, 1380.0, 960.0, 789.0, 1214.0, 983.0, 1132.0, 702.0, 900.0, 1110.0, 1180.0, 675.0, 1109.0, 753.0, 960.0, 1387.0, 1243.0, 897.0, 914.0, 1085.0, 929.0, 1075.0, 936.0, 927.0, 887.0, 960.0, 770.0, 1085.0, 937.0, 1069.0, 735.0, 961.0, 885.0, 904.0, 1230.0, 936.0, 806.0, 1060.0, 950.0, 959.0, 890.0, 1162.0, 777.0, 982.0, 731.0, 1090.0, 788.0, 622.0, 903.0, 970.0, 1109.0, 1235.0, 1320.0, 930.0, 1030.0, 984.0, 1060.0, 808.0, 1154.0, 1097.0, 1041.0, 745.0, 929.0, 791.0, 983.0, 1021.0, 1040.0, 979.0, 1067.0, 843.0, 350.0, 890.0, 792.0, 1234.0, 759.0, 1335.0, 1096.0, 935.0, 1055.0, 1180.0, 1170.0, 1187.0, 589.0, 901.0, 705.0, 851.0, 1410.0, 911.0, 1020.0, 864.0, 853.0, 1320.0, 648.0, 985.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 70.0, 70.0, 90.0, 50.0, 200.0, 50.0, 70.0, 140.0, 140.0, 130.0, 110.0, 68.0, 170.0, 190.0, 35.0, 120.0, 58.0, 130.0, 150.0, 22.0, 170.0, 80.0, 70.0, 89.0, 90.0, 190.0, 60.0, 161.0, 66.0, 130.0, 150.0, 50.0, 100.0, 160.0, 110.0, 80.0, 50.0, 120.0, 70.0, 110.0, 50.0, 70.0, 40.0, 120.0, 40.0, 110.0, 70.0, 140.0, 60.0, 110.0, 110.0, 70.0, 150.0, 100.0, 80.0, 80.0, 170.0, 120.0, 70.0, 70.0, 120.0, 170.0, 130.0, -35.0, 170.0, 110.0, 88.0, 60.0, 100.0, 140.0, 180.0, 120.0, 180.0, 110.0, 120.0, 190.0, 110.0, 110.0, 120.0, 120.0, 100.0, 100.0, 80.0, 130.0, 100.0, 50.0, 40.0, 90.0, 150.0, 170.0, 70.0, 30.0, 140.0, 50.0, 100.0, 50.0, 40.0, 69.0, 70.0, 90.0, 160.0, 80.0, 180.0, 150.0, 70.0, 100.0, 148.0, 86.0, 150.0, 130.0, 110.0, 170.0, 138.0, 90.0, 30.0, 57.0, 100.0, 90.0, 68.0, 11.0, 70.0, 140.0, 60.0, 200.0, 244.0, 100.0, 60.0, 67.0, 180.0, 70.0, 35.0, 50.0, 30.0, 77.0, 120.0, 25.0, 130.0, 15.0, 150.0, 60.0, 150.0, 70.0, 150.0, 120.0, 50.0, 40.0, 190.0, 90.0, -20.0, 170.0, 90.0, 60.0, 120.0, 110.0, 110.0, 150.0, 190.0, 60.0, 50.0, 80.0, 100.0, 80.0, 180.0, 90.0, 40.0, 120.0, 200.0, 180.0, 110.0, 70.0, 50.0, 80.0, 40.0, 76.0, 40.0, 90.0, 80.0, 130.0, 19.0, 100.0, 100.0, 135.0, 140.0, 160.0, 150.0, 140.0, 80.0, -3.0, 107.0, 70.0, 90.0, 50.0, 90.0, 10.0, 4.0, 70.0, 149.0, 120.0, 100.0, 80.0, 89.0, 70.0, 130.0, 50.0, 146.0, 75.0, 110.0, 90.0, 120.0, 270.0, 59.0, 119.0, 129.0, 110.0, 100.0, 130.0, 160.0, 170.0, 140.0, 90.0, 180.0, 110.0, 110.0, 80.0, 100.0, 169.0, 134.0, 190.0, 80.0, 100.0, 190.0, 90.0, 5.0, 85.0, 27.0, 100.0, 180.0, 70.0, 50.0, 47.0, 87.0, 70.0, 100.0, 140.0, 90.0, 100.0, 150.0, 80.0, 50.0, 50.0, 178.0, 30.0, 59.0, 100.0, 160.0, 200.0, 169.0, 89.0, 50.0, 100.0, 80.0, 100.0, 90.0, 75.0, 110.0, 120.0, 104.0, 50.0, 100.0, 70.0, 140.0, 150.0, 50.0, 60.0, 147.0, 80.0, 58.0, 100.0, 220.0, 125.0, 130.0, 90.0, 120.0, 51.0, 150.0, 60.0, 60.0, 90.0, 60.0, 60.0, 164.0, 70.0, 63.0, 40.0, 80.0, 140.0, 70.0, 40.0, 200.0, 41.0, 75.0, 80.0, 18.0, 200.0, 32.0, 70.0, 230.0, 70.0, 71.0, 30.0, 130.0, 110.0, 147.0, 80.0, 69.0, 115.0, 80.0, 139.0, 60.0, 130.0, 60.0, 60.0, 60.0, 170.0, 70.0, 40.0, 80.0, 60.0, 40.0, 290.0, 130.0, 78.0, 100.0, 110.0, 186.0, 100.0, 112.0, -131.0, 110.0, 79.0, 170.0, 150.0, 160.0, 40.0, 100.0, 100.0, 70.0, 28.0, 40.0, 120.0, 32.0, 110.0, 150.0, 100.0, 100.0, 140.0, 177.0, 70.0, 70.0, 80.0, 120.0, 70.0, 130.0, 30.0, 60.0, 70.0, 60.0, 50.0, 65.0, 130.0, 70.0, 90.0, 50.0, 169.0, 100.0, 80.0, 20.0, 92.0, 160.0, 60.0, 200.0, 45.0, 10.0, 90.0, 90.0, 110.0, 100.0, 110.0, 70.0, 60.0, 40.0, 100.0, 100.0, 65.0, -8.0, 70.0, 87.0, 330.0, 60.0, 180.0, 50.0, 171.0, 80.0, 21.0, 110.0, 160.0, 110.0, 289.0, 59.0, 70.0, 100.0, 29.0, 140.0, 60.0, 140.0, 67.0, 110.0, 80.0, 140.0, 60.0, 70.0, 175.0, 59.0, 120.0, -25.0, 80.0, 140.0, 40.0, 87.0, 130.0, 60.0, 120.0, 130.0, 180.0, 80.0, 80.0, 100.0, 80.0, 100.0, 140.0, 90.0, 90.0, 60.0, 80.0, 30.0, 140.0, 110.0, 170.0, 40.0, 50.0, 210.0, 40.0, 160.0, 90.0, 19.0, 100.0, 160.0, 50.0, 80.0, 120.0, 230.0, 50.0, 20.0, 20.0, 50.0, 80.0, 130.0, 80.0, 110.0, 97.0, 120.0, 70.0, 86.0, 125.0, 220.0, 100.0, 114.0, 100.0, 130.0, 78.0, 16.0, 126.0, 40.0, 70.0, 140.0, 50.0, 50.0, 97.0, 110.0, 110.0, 67.0, 210.0, 100.0, 130.0, 93.0, 90.0, 87.0, 70.0, 25.0, 130.0, 30.0, 130.0, 61.0, 99.0, 60.0, 100.0, 20.0, 80.0, 21.0, 120.0, 110.0, 150.0, 80.0, 140.0, 90.0, 100.0, 70.0, 80.0, 150.0, 80.0, 70.0, 47.0, 110.0, 10.0, 120.0, 100.0, 50.0, 115.0, 86.0, 50.0, 50.0, 112.0, 129.0, 100.0, 20.0, 90.0, 2.0, 39.0, 30.0, 70.0, 60.0, 30.0, 200.0, 50.0, 80.0, 110.0, 98.0, 90.0, 115.0, 110.0, 190.0, 60.0, 150.0, 90.0, 40.0, 60.0, 130.0, 100.0, 40.0, 180.0, 220.0, 19.0, 180.0, 50.0, 95.0, 100.0, 66.0, 59.0, 140.0, 140.0, 120.0, 140.0, 65.0, 110.0, 120.0, 140.0, 130.0, 110.0, 160.0, 48.0, 100.0, 268.0, 130.0, 210.0, 100.0, 160.0, 197.0, 60.0, 47.0, 120.0, 90.0, 90.0, 90.0, 160.0, 70.0, 60.0, 140.0, 20.0, 90.0, 70.0, 130.0, 90.0, 140.0, 140.0, 40.0, 150.0, 50.0, 140.0, 80.0, 110.0, 40.0, 120.0, 150.0, 120.0, 60.0, 130.0, -6.0, 140.0, 120.0, 130.0, 110.0, 60.0, 90.0, 280.0, 130.0, 40.0, 90.0, 100.0, 30.0, 60.0, 90.0, 140.0, 50.0, 130.0, 100.0, 60.0, 50.0, 70.0, 58.0, 170.0, 130.0, 15.0, 160.0, 100.0, 67.0, 160.0, 190.0, 82.0, 80.0, 80.0, 10.0, 130.0, 100.0, 160.0, 128.0, 50.0, 99.0, 140.0, 200.0, 100.0, 50.0, 40.0, 90.0, 60.0, 170.0, 120.0, 170.0, 81.0, 160.0, -1.0, 90.0, 94.0, 90.0, 80.0, 19.0, 170.0, 4.0, 49.0, 150.0, 220.0, 5.0, 30.0, 140.0, 44.0, 100.0, 100.0, 160.0, 20.0, 110.0, 60.0, 100.0, 60.0, 130.0, 70.0, 80.0, 40.0, 50.0, 120.0, 81.0, 140.0, 50.0, 150.0, 90.0, 66.0, 57.0, 70.0, 20.0, 250.0, 90.0, 70.0, 100.0, 90.0, 140.0, 61.0, 110.0, 140.0, 40.0, 150.0, 120.0, 120.0, 100.0, 80.0, 70.0, 80.0, 60.0, 90.0, 170.0, 130.0, 140.0, 80.0, 70.0, 50.0, 79.0, 180.0, 160.0, 100.0, 20.0, 130.0, 110.0, 200.0, 110.0, 80.0, 120.0, 29.0, 60.0, 80.0, 120.0, 178.0, 90.0, 50.0, 110.0, 90.0, 60.0, 40.0, 53.0, 40.0, 120.0, 140.0, 140.0, 20.0, 57.0, 37.0, 3.0, 15.0, 10.0, 28.0, 100.0, 20.0, 60.0, 130.0, 80.0, 90.0, 70.0, 130.0, 70.0, 90.0, 130.0, 40.0, 60.0, 40.0, 150.0, 7.0, 120.0, 200.0, 70.0, 24.0, 32.0, 50.0, 99.0, 140.0, 120.0, 150.0, 200.0, 110.0, 167.0, 70.0, 30.0, 150.0, 97.0, 40.0, 70.0, 130.0, 60.0, 40.0, 200.0, 30.0, 80.0, 39.0, 70.0, 80.0, 220.0, 120.0, 90.0, 120.0, 200.0, 140.0, 110.0, 117.0, 138.0, 70.0, 140.0, 180.0, 130.0, 110.0, 80.0, 110.0, 150.0, 90.0, 36.0, 70.0, 140.0, 40.0, 40.0, 160.0, 45.0, 130.0, 100.0, 60.0, 150.0, 80.0, 110.0, 100.0, 120.0, 65.0, 150.0, 110.0, 130.0, 100.0, 90.0, 150.0, 90.0, 110.0, 190.0, 110.0, 160.0, 110.0, 90.0, 80.0, 90.0, 170.0, 50.0, 90.0, 190.0, 70.0, 80.0, 105.0, 150.0, 130.0, 135.0, 190.0, 190.0, 60.0, 43.0, 120.0, 80.0, 154.0, 60.0, 200.0, 90.0, 20.0, 30.0, 20.0, 70.0, 28.0, 140.0, 22.0, 70.0, 139.0, 50.0, 90.0, 70.0, 80.0, 80.0, 69.0, 140.0, 135.0, 110.0, 80.0, 47.0, 140.0, 40.0, 70.0, 180.0, 7.0, 10.0, 90.0, 70.0, 30.0, 68.0, 100.0, 80.0, 110.0, 60.0, 80.0, 6.0, 170.0, 135.0, 50.0, 60.0, 80.0, 90.0, 150.0, 190.0, 160.0, 200.0, 150.0, 170.0, 140.0, 80.0, 168.0, 108.0, 80.0, 30.0, 60.0, 45.0, 50.0, 130.0, 90.0, 150.0, 70.0, 80.0, 90.0, 210.0, 90.0, 110.0, 150.0, 70.0, 110.0, 40.0, 50.0, 94.0, 100.0, 120.0, 10.0, 60.0, 140.0, 90.0, 120.0, 80.0, 130.0, 60.0, 200.0, 60.0, 17.0, 170.0, 40.0, 50.0, 50.0, 76.0, 100.0, 190.0, 80.0, 160.0, 90.0, 130.0, 70.0, 280.0, 120.0, 100.0, 48.0, 160.0, 100.0, 0.0, 40.0, 80.0, 90.0, 50.0, 20.0, 60.0, 90.0, 150.0, 120.0, 150.0, 40.0, 50.0, 120.0, 35.0, 100.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.641048770263352, "mean_inference_ms": 1.6380051139714757, "mean_action_processing_ms": 0.5021208325821839, "mean_env_wait_ms": 1.1291151332213725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011418581008911133, "StateBufferConnector_ms": 0.011811971664428711, "ViewRequirementAgentConnector_ms": 0.37825584411621094}, "num_episodes": 18, "episode_return_max": 1410.0, "episode_return_min": 350.0, "episode_return_mean": 974.87}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.742979196529777, "num_env_steps_trained_throughput_per_sec": 20.742979196529777, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 5040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5040000, "timers": {"training_iteration_time_ms": 193850.141, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193850.094, "sample_time_ms": 2524.613, "learn_time_ms": 191306.02, "learn_throughput": 20.909, "synch_weights_time_ms": 10.996}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "done": false, "training_iteration": 126, "trial_id": "1841f_00000", "date": "2024-08-08_06-29-31", "timestamp": 1723112971, "time_this_iter_s": 192.8448748588562, "time_total_s": 25754.739847898483, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b294dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25754.739847898483, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 16.927472527472528, "ram_util_percent": 77.17069597069597}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8698674571653777, "cur_kl_coeff": 0.675, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.013698282751752633, "vf_loss": 8.335358593537531, "vf_explained_var": -0.010233105536593923, "kl": Infinity, "entropy": 0.5478006888407106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1187835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 350.0, "episode_reward_mean": 949.06, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -131.0}, "policy_reward_max": {"policy_0": 330.0}, "policy_reward_mean": {"policy_0": 94.906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1243.0, 897.0, 914.0, 1085.0, 929.0, 1075.0, 936.0, 927.0, 887.0, 960.0, 770.0, 1085.0, 937.0, 1069.0, 735.0, 961.0, 885.0, 904.0, 1230.0, 936.0, 806.0, 1060.0, 950.0, 959.0, 890.0, 1162.0, 777.0, 982.0, 731.0, 1090.0, 788.0, 622.0, 903.0, 970.0, 1109.0, 1235.0, 1320.0, 930.0, 1030.0, 984.0, 1060.0, 808.0, 1154.0, 1097.0, 1041.0, 745.0, 929.0, 791.0, 983.0, 1021.0, 1040.0, 979.0, 1067.0, 843.0, 350.0, 890.0, 792.0, 1234.0, 759.0, 1335.0, 1096.0, 935.0, 1055.0, 1180.0, 1170.0, 1187.0, 589.0, 901.0, 705.0, 851.0, 1410.0, 911.0, 1020.0, 864.0, 853.0, 1320.0, 648.0, 985.0, 732.0, 1125.0, 930.0, 1060.0, 898.0, 836.0, 909.0, 552.0, 1120.0, 833.0, 705.0, 870.0, 935.0, 536.0, 988.0, 879.0, 957.0, 850.0, 760.0, 1000.0, 1220.0, 950.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 180.0, 110.0, 110.0, 80.0, 100.0, 169.0, 134.0, 190.0, 80.0, 100.0, 190.0, 90.0, 5.0, 85.0, 27.0, 100.0, 180.0, 70.0, 50.0, 47.0, 87.0, 70.0, 100.0, 140.0, 90.0, 100.0, 150.0, 80.0, 50.0, 50.0, 178.0, 30.0, 59.0, 100.0, 160.0, 200.0, 169.0, 89.0, 50.0, 100.0, 80.0, 100.0, 90.0, 75.0, 110.0, 120.0, 104.0, 50.0, 100.0, 70.0, 140.0, 150.0, 50.0, 60.0, 147.0, 80.0, 58.0, 100.0, 220.0, 125.0, 130.0, 90.0, 120.0, 51.0, 150.0, 60.0, 60.0, 90.0, 60.0, 60.0, 164.0, 70.0, 63.0, 40.0, 80.0, 140.0, 70.0, 40.0, 200.0, 41.0, 75.0, 80.0, 18.0, 200.0, 32.0, 70.0, 230.0, 70.0, 71.0, 30.0, 130.0, 110.0, 147.0, 80.0, 69.0, 115.0, 80.0, 139.0, 60.0, 130.0, 60.0, 60.0, 60.0, 170.0, 70.0, 40.0, 80.0, 60.0, 40.0, 290.0, 130.0, 78.0, 100.0, 110.0, 186.0, 100.0, 112.0, -131.0, 110.0, 79.0, 170.0, 150.0, 160.0, 40.0, 100.0, 100.0, 70.0, 28.0, 40.0, 120.0, 32.0, 110.0, 150.0, 100.0, 100.0, 140.0, 177.0, 70.0, 70.0, 80.0, 120.0, 70.0, 130.0, 30.0, 60.0, 70.0, 60.0, 50.0, 65.0, 130.0, 70.0, 90.0, 50.0, 169.0, 100.0, 80.0, 20.0, 92.0, 160.0, 60.0, 200.0, 45.0, 10.0, 90.0, 90.0, 110.0, 100.0, 110.0, 70.0, 60.0, 40.0, 100.0, 100.0, 65.0, -8.0, 70.0, 87.0, 330.0, 60.0, 180.0, 50.0, 171.0, 80.0, 21.0, 110.0, 160.0, 110.0, 289.0, 59.0, 70.0, 100.0, 29.0, 140.0, 60.0, 140.0, 67.0, 110.0, 80.0, 140.0, 60.0, 70.0, 175.0, 59.0, 120.0, -25.0, 80.0, 140.0, 40.0, 87.0, 130.0, 60.0, 120.0, 130.0, 180.0, 80.0, 80.0, 100.0, 80.0, 100.0, 140.0, 90.0, 90.0, 60.0, 80.0, 30.0, 140.0, 110.0, 170.0, 40.0, 50.0, 210.0, 40.0, 160.0, 90.0, 19.0, 100.0, 160.0, 50.0, 80.0, 120.0, 230.0, 50.0, 20.0, 20.0, 50.0, 80.0, 130.0, 80.0, 110.0, 97.0, 120.0, 70.0, 86.0, 125.0, 220.0, 100.0, 114.0, 100.0, 130.0, 78.0, 16.0, 126.0, 40.0, 70.0, 140.0, 50.0, 50.0, 97.0, 110.0, 110.0, 67.0, 210.0, 100.0, 130.0, 93.0, 90.0, 87.0, 70.0, 25.0, 130.0, 30.0, 130.0, 61.0, 99.0, 60.0, 100.0, 20.0, 80.0, 21.0, 120.0, 110.0, 150.0, 80.0, 140.0, 90.0, 100.0, 70.0, 80.0, 150.0, 80.0, 70.0, 47.0, 110.0, 10.0, 120.0, 100.0, 50.0, 115.0, 86.0, 50.0, 50.0, 112.0, 129.0, 100.0, 20.0, 90.0, 2.0, 39.0, 30.0, 70.0, 60.0, 30.0, 200.0, 50.0, 80.0, 110.0, 98.0, 90.0, 115.0, 110.0, 190.0, 60.0, 150.0, 90.0, 40.0, 60.0, 130.0, 100.0, 40.0, 180.0, 220.0, 19.0, 180.0, 50.0, 95.0, 100.0, 66.0, 59.0, 140.0, 140.0, 120.0, 140.0, 65.0, 110.0, 120.0, 140.0, 130.0, 110.0, 160.0, 48.0, 100.0, 268.0, 130.0, 210.0, 100.0, 160.0, 197.0, 60.0, 47.0, 120.0, 90.0, 90.0, 90.0, 160.0, 70.0, 60.0, 140.0, 20.0, 90.0, 70.0, 130.0, 90.0, 140.0, 140.0, 40.0, 150.0, 50.0, 140.0, 80.0, 110.0, 40.0, 120.0, 150.0, 120.0, 60.0, 130.0, -6.0, 140.0, 120.0, 130.0, 110.0, 60.0, 90.0, 280.0, 130.0, 40.0, 90.0, 100.0, 30.0, 60.0, 90.0, 140.0, 50.0, 130.0, 100.0, 60.0, 50.0, 70.0, 58.0, 170.0, 130.0, 15.0, 160.0, 100.0, 67.0, 160.0, 190.0, 82.0, 80.0, 80.0, 10.0, 130.0, 100.0, 160.0, 128.0, 50.0, 99.0, 140.0, 200.0, 100.0, 50.0, 40.0, 90.0, 60.0, 170.0, 120.0, 170.0, 81.0, 160.0, -1.0, 90.0, 94.0, 90.0, 80.0, 19.0, 170.0, 4.0, 49.0, 150.0, 220.0, 5.0, 30.0, 140.0, 44.0, 100.0, 100.0, 160.0, 20.0, 110.0, 60.0, 100.0, 60.0, 130.0, 70.0, 80.0, 40.0, 50.0, 120.0, 81.0, 140.0, 50.0, 150.0, 90.0, 66.0, 57.0, 70.0, 20.0, 250.0, 90.0, 70.0, 100.0, 90.0, 140.0, 61.0, 110.0, 140.0, 40.0, 150.0, 120.0, 120.0, 100.0, 80.0, 70.0, 80.0, 60.0, 90.0, 170.0, 130.0, 140.0, 80.0, 70.0, 50.0, 79.0, 180.0, 160.0, 100.0, 20.0, 130.0, 110.0, 200.0, 110.0, 80.0, 120.0, 29.0, 60.0, 80.0, 120.0, 178.0, 90.0, 50.0, 110.0, 90.0, 60.0, 40.0, 53.0, 40.0, 120.0, 140.0, 140.0, 20.0, 57.0, 37.0, 3.0, 15.0, 10.0, 28.0, 100.0, 20.0, 60.0, 130.0, 80.0, 90.0, 70.0, 130.0, 70.0, 90.0, 130.0, 40.0, 60.0, 40.0, 150.0, 7.0, 120.0, 200.0, 70.0, 24.0, 32.0, 50.0, 99.0, 140.0, 120.0, 150.0, 200.0, 110.0, 167.0, 70.0, 30.0, 150.0, 97.0, 40.0, 70.0, 130.0, 60.0, 40.0, 200.0, 30.0, 80.0, 39.0, 70.0, 80.0, 220.0, 120.0, 90.0, 120.0, 200.0, 140.0, 110.0, 117.0, 138.0, 70.0, 140.0, 180.0, 130.0, 110.0, 80.0, 110.0, 150.0, 90.0, 36.0, 70.0, 140.0, 40.0, 40.0, 160.0, 45.0, 130.0, 100.0, 60.0, 150.0, 80.0, 110.0, 100.0, 120.0, 65.0, 150.0, 110.0, 130.0, 100.0, 90.0, 150.0, 90.0, 110.0, 190.0, 110.0, 160.0, 110.0, 90.0, 80.0, 90.0, 170.0, 50.0, 90.0, 190.0, 70.0, 80.0, 105.0, 150.0, 130.0, 135.0, 190.0, 190.0, 60.0, 43.0, 120.0, 80.0, 154.0, 60.0, 200.0, 90.0, 20.0, 30.0, 20.0, 70.0, 28.0, 140.0, 22.0, 70.0, 139.0, 50.0, 90.0, 70.0, 80.0, 80.0, 69.0, 140.0, 135.0, 110.0, 80.0, 47.0, 140.0, 40.0, 70.0, 180.0, 7.0, 10.0, 90.0, 70.0, 30.0, 68.0, 100.0, 80.0, 110.0, 60.0, 80.0, 6.0, 170.0, 135.0, 50.0, 60.0, 80.0, 90.0, 150.0, 190.0, 160.0, 200.0, 150.0, 170.0, 140.0, 80.0, 168.0, 108.0, 80.0, 30.0, 60.0, 45.0, 50.0, 130.0, 90.0, 150.0, 70.0, 80.0, 90.0, 210.0, 90.0, 110.0, 150.0, 70.0, 110.0, 40.0, 50.0, 94.0, 100.0, 120.0, 10.0, 60.0, 140.0, 90.0, 120.0, 80.0, 130.0, 60.0, 200.0, 60.0, 17.0, 170.0, 40.0, 50.0, 50.0, 76.0, 100.0, 190.0, 80.0, 160.0, 90.0, 130.0, 70.0, 280.0, 120.0, 100.0, 48.0, 160.0, 100.0, 0.0, 40.0, 80.0, 90.0, 50.0, 20.0, 60.0, 90.0, 150.0, 120.0, 150.0, 40.0, 50.0, 120.0, 35.0, 100.0, 130.0, 99.0, 36.0, 65.0, 30.0, 210.0, 40.0, 100.0, 45.0, 47.0, 60.0, 100.0, 110.0, 120.0, 80.0, 130.0, 125.0, 20.0, 200.0, 140.0, 100.0, 80.0, 140.0, 60.0, 130.0, 80.0, 130.0, 100.0, 80.0, 60.0, 70.0, 70.0, 100.0, 80.0, 130.0, 90.0, 100.0, 160.0, 50.0, 170.0, 110.0, 134.0, 54.0, 110.0, 90.0, 70.0, 70.0, 80.0, 100.0, 70.0, 120.0, 102.0, 110.0, 20.0, 30.0, 98.0, 100.0, 180.0, 74.0, 62.0, 60.0, 51.0, 30.0, 70.0, 142.0, 120.0, 76.0, 30.0, 80.0, 190.0, 120.0, 80.0, 38.0, 30.0, 130.0, 40.0, 8.0, 70.0, 60.0, 70.0, 26.0, 78.0, 23.0, 120.0, 97.0, 87.0, 120.0, 130.0, 205.0, 110.0, 150.0, 107.0, 5.0, 100.0, 51.0, 90.0, 130.0, 120.0, 120.0, 60.0, 50.0, 90.0, 60.0, 60.0, 90.0, 100.0, 60.0, 40.0, 80.0, 75.0, 50.0, 70.0, 90.0, 160.0, 90.0, 50.0, 40.0, 150.0, 90.0, 90.0, 40.0, 51.0, 100.0, 50.0, 103.0, 41.0, 160.0, 80.0, 150.0, 100.0, 100.0, 47.0, 110.0, 10.0, 90.0, 30.0, 20.0, 49.0, 150.0, 30.0, 0.0, 50.0, 160.0, 100.0, 58.0, 140.0, 20.0, 140.0, 70.0, 110.0, 140.0, 130.0, 48.0, 60.0, 60.0, 60.0, 60.0, 200.0, 90.0, 54.0, 117.0, 98.0, 96.0, 100.0, 40.0, 33.0, 100.0, 50.0, 190.0, 140.0, 110.0, 100.0, 70.0, 30.0, 50.0, 130.0, 50.0, 150.0, 160.0, 40.0, 70.0, 50.0, 100.0, 70.0, 80.0, 110.0, 40.0, 60.0, 50.0, 60.0, 140.0, 90.0, 160.0, 20.0, 100.0, 150.0, 20.0, 130.0, 90.0, 140.0, 100.0, 90.0, 90.0, 90.0, 90.0, 110.0, 110.0, 240.0, 220.0, 110.0, 70.0, 70.0, 160.0, 98.0, 64.0, 90.0, 84.0, 39.0, 120.0, 130.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6384727078303063, "mean_inference_ms": 1.635222945667219, "mean_action_processing_ms": 0.5015467422640474, "mean_env_wait_ms": 1.1278493353005896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012006521224975586, "StateBufferConnector_ms": 0.011867761611938477, "ViewRequirementAgentConnector_ms": 0.3818066120147705}, "num_episodes": 22, "episode_return_max": 1410.0, "episode_return_min": 350.0, "episode_return_mean": 949.06}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.70982907249012, "num_env_steps_trained_throughput_per_sec": 20.70982907249012, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 5080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5080000, "timers": {"training_iteration_time_ms": 193655.462, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193655.416, "sample_time_ms": 2528.378, "learn_time_ms": 191107.31, "learn_throughput": 20.931, "synch_weights_time_ms": 11.072}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "done": false, "training_iteration": 127, "trial_id": "1841f_00000", "date": "2024-08-08_06-32-44", "timestamp": 1723113164, "time_this_iter_s": 193.15527391433716, "time_total_s": 25947.89512181282, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2947310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25947.89512181282, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 17.596715328467152, "ram_util_percent": 76.89817518248175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9026763117097563, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.013649921139024785, "vf_loss": 8.55229505395737, "vf_explained_var": -0.013922903186089188, "kl": Infinity, "entropy": 0.5153149374789451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1197225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 350.0, "episode_reward_mean": 951.49, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -27.0}, "policy_reward_max": {"policy_0": 289.0}, "policy_reward_mean": {"policy_0": 95.149}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1230.0, 936.0, 806.0, 1060.0, 950.0, 959.0, 890.0, 1162.0, 777.0, 982.0, 731.0, 1090.0, 788.0, 622.0, 903.0, 970.0, 1109.0, 1235.0, 1320.0, 930.0, 1030.0, 984.0, 1060.0, 808.0, 1154.0, 1097.0, 1041.0, 745.0, 929.0, 791.0, 983.0, 1021.0, 1040.0, 979.0, 1067.0, 843.0, 350.0, 890.0, 792.0, 1234.0, 759.0, 1335.0, 1096.0, 935.0, 1055.0, 1180.0, 1170.0, 1187.0, 589.0, 901.0, 705.0, 851.0, 1410.0, 911.0, 1020.0, 864.0, 853.0, 1320.0, 648.0, 985.0, 732.0, 1125.0, 930.0, 1060.0, 898.0, 836.0, 909.0, 552.0, 1120.0, 833.0, 705.0, 870.0, 935.0, 536.0, 988.0, 879.0, 957.0, 850.0, 760.0, 1000.0, 1220.0, 950.0, 678.0, 875.0, 990.0, 1006.0, 725.0, 969.0, 767.0, 814.0, 739.0, 1034.0, 1201.0, 985.0, 1190.0, 1240.0, 1040.0, 907.0, 927.0, 1355.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 50.0, 171.0, 80.0, 21.0, 110.0, 160.0, 110.0, 289.0, 59.0, 70.0, 100.0, 29.0, 140.0, 60.0, 140.0, 67.0, 110.0, 80.0, 140.0, 60.0, 70.0, 175.0, 59.0, 120.0, -25.0, 80.0, 140.0, 40.0, 87.0, 130.0, 60.0, 120.0, 130.0, 180.0, 80.0, 80.0, 100.0, 80.0, 100.0, 140.0, 90.0, 90.0, 60.0, 80.0, 30.0, 140.0, 110.0, 170.0, 40.0, 50.0, 210.0, 40.0, 160.0, 90.0, 19.0, 100.0, 160.0, 50.0, 80.0, 120.0, 230.0, 50.0, 20.0, 20.0, 50.0, 80.0, 130.0, 80.0, 110.0, 97.0, 120.0, 70.0, 86.0, 125.0, 220.0, 100.0, 114.0, 100.0, 130.0, 78.0, 16.0, 126.0, 40.0, 70.0, 140.0, 50.0, 50.0, 97.0, 110.0, 110.0, 67.0, 210.0, 100.0, 130.0, 93.0, 90.0, 87.0, 70.0, 25.0, 130.0, 30.0, 130.0, 61.0, 99.0, 60.0, 100.0, 20.0, 80.0, 21.0, 120.0, 110.0, 150.0, 80.0, 140.0, 90.0, 100.0, 70.0, 80.0, 150.0, 80.0, 70.0, 47.0, 110.0, 10.0, 120.0, 100.0, 50.0, 115.0, 86.0, 50.0, 50.0, 112.0, 129.0, 100.0, 20.0, 90.0, 2.0, 39.0, 30.0, 70.0, 60.0, 30.0, 200.0, 50.0, 80.0, 110.0, 98.0, 90.0, 115.0, 110.0, 190.0, 60.0, 150.0, 90.0, 40.0, 60.0, 130.0, 100.0, 40.0, 180.0, 220.0, 19.0, 180.0, 50.0, 95.0, 100.0, 66.0, 59.0, 140.0, 140.0, 120.0, 140.0, 65.0, 110.0, 120.0, 140.0, 130.0, 110.0, 160.0, 48.0, 100.0, 268.0, 130.0, 210.0, 100.0, 160.0, 197.0, 60.0, 47.0, 120.0, 90.0, 90.0, 90.0, 160.0, 70.0, 60.0, 140.0, 20.0, 90.0, 70.0, 130.0, 90.0, 140.0, 140.0, 40.0, 150.0, 50.0, 140.0, 80.0, 110.0, 40.0, 120.0, 150.0, 120.0, 60.0, 130.0, -6.0, 140.0, 120.0, 130.0, 110.0, 60.0, 90.0, 280.0, 130.0, 40.0, 90.0, 100.0, 30.0, 60.0, 90.0, 140.0, 50.0, 130.0, 100.0, 60.0, 50.0, 70.0, 58.0, 170.0, 130.0, 15.0, 160.0, 100.0, 67.0, 160.0, 190.0, 82.0, 80.0, 80.0, 10.0, 130.0, 100.0, 160.0, 128.0, 50.0, 99.0, 140.0, 200.0, 100.0, 50.0, 40.0, 90.0, 60.0, 170.0, 120.0, 170.0, 81.0, 160.0, -1.0, 90.0, 94.0, 90.0, 80.0, 19.0, 170.0, 4.0, 49.0, 150.0, 220.0, 5.0, 30.0, 140.0, 44.0, 100.0, 100.0, 160.0, 20.0, 110.0, 60.0, 100.0, 60.0, 130.0, 70.0, 80.0, 40.0, 50.0, 120.0, 81.0, 140.0, 50.0, 150.0, 90.0, 66.0, 57.0, 70.0, 20.0, 250.0, 90.0, 70.0, 100.0, 90.0, 140.0, 61.0, 110.0, 140.0, 40.0, 150.0, 120.0, 120.0, 100.0, 80.0, 70.0, 80.0, 60.0, 90.0, 170.0, 130.0, 140.0, 80.0, 70.0, 50.0, 79.0, 180.0, 160.0, 100.0, 20.0, 130.0, 110.0, 200.0, 110.0, 80.0, 120.0, 29.0, 60.0, 80.0, 120.0, 178.0, 90.0, 50.0, 110.0, 90.0, 60.0, 40.0, 53.0, 40.0, 120.0, 140.0, 140.0, 20.0, 57.0, 37.0, 3.0, 15.0, 10.0, 28.0, 100.0, 20.0, 60.0, 130.0, 80.0, 90.0, 70.0, 130.0, 70.0, 90.0, 130.0, 40.0, 60.0, 40.0, 150.0, 7.0, 120.0, 200.0, 70.0, 24.0, 32.0, 50.0, 99.0, 140.0, 120.0, 150.0, 200.0, 110.0, 167.0, 70.0, 30.0, 150.0, 97.0, 40.0, 70.0, 130.0, 60.0, 40.0, 200.0, 30.0, 80.0, 39.0, 70.0, 80.0, 220.0, 120.0, 90.0, 120.0, 200.0, 140.0, 110.0, 117.0, 138.0, 70.0, 140.0, 180.0, 130.0, 110.0, 80.0, 110.0, 150.0, 90.0, 36.0, 70.0, 140.0, 40.0, 40.0, 160.0, 45.0, 130.0, 100.0, 60.0, 150.0, 80.0, 110.0, 100.0, 120.0, 65.0, 150.0, 110.0, 130.0, 100.0, 90.0, 150.0, 90.0, 110.0, 190.0, 110.0, 160.0, 110.0, 90.0, 80.0, 90.0, 170.0, 50.0, 90.0, 190.0, 70.0, 80.0, 105.0, 150.0, 130.0, 135.0, 190.0, 190.0, 60.0, 43.0, 120.0, 80.0, 154.0, 60.0, 200.0, 90.0, 20.0, 30.0, 20.0, 70.0, 28.0, 140.0, 22.0, 70.0, 139.0, 50.0, 90.0, 70.0, 80.0, 80.0, 69.0, 140.0, 135.0, 110.0, 80.0, 47.0, 140.0, 40.0, 70.0, 180.0, 7.0, 10.0, 90.0, 70.0, 30.0, 68.0, 100.0, 80.0, 110.0, 60.0, 80.0, 6.0, 170.0, 135.0, 50.0, 60.0, 80.0, 90.0, 150.0, 190.0, 160.0, 200.0, 150.0, 170.0, 140.0, 80.0, 168.0, 108.0, 80.0, 30.0, 60.0, 45.0, 50.0, 130.0, 90.0, 150.0, 70.0, 80.0, 90.0, 210.0, 90.0, 110.0, 150.0, 70.0, 110.0, 40.0, 50.0, 94.0, 100.0, 120.0, 10.0, 60.0, 140.0, 90.0, 120.0, 80.0, 130.0, 60.0, 200.0, 60.0, 17.0, 170.0, 40.0, 50.0, 50.0, 76.0, 100.0, 190.0, 80.0, 160.0, 90.0, 130.0, 70.0, 280.0, 120.0, 100.0, 48.0, 160.0, 100.0, 0.0, 40.0, 80.0, 90.0, 50.0, 20.0, 60.0, 90.0, 150.0, 120.0, 150.0, 40.0, 50.0, 120.0, 35.0, 100.0, 130.0, 99.0, 36.0, 65.0, 30.0, 210.0, 40.0, 100.0, 45.0, 47.0, 60.0, 100.0, 110.0, 120.0, 80.0, 130.0, 125.0, 20.0, 200.0, 140.0, 100.0, 80.0, 140.0, 60.0, 130.0, 80.0, 130.0, 100.0, 80.0, 60.0, 70.0, 70.0, 100.0, 80.0, 130.0, 90.0, 100.0, 160.0, 50.0, 170.0, 110.0, 134.0, 54.0, 110.0, 90.0, 70.0, 70.0, 80.0, 100.0, 70.0, 120.0, 102.0, 110.0, 20.0, 30.0, 98.0, 100.0, 180.0, 74.0, 62.0, 60.0, 51.0, 30.0, 70.0, 142.0, 120.0, 76.0, 30.0, 80.0, 190.0, 120.0, 80.0, 38.0, 30.0, 130.0, 40.0, 8.0, 70.0, 60.0, 70.0, 26.0, 78.0, 23.0, 120.0, 97.0, 87.0, 120.0, 130.0, 205.0, 110.0, 150.0, 107.0, 5.0, 100.0, 51.0, 90.0, 130.0, 120.0, 120.0, 60.0, 50.0, 90.0, 60.0, 60.0, 90.0, 100.0, 60.0, 40.0, 80.0, 75.0, 50.0, 70.0, 90.0, 160.0, 90.0, 50.0, 40.0, 150.0, 90.0, 90.0, 40.0, 51.0, 100.0, 50.0, 103.0, 41.0, 160.0, 80.0, 150.0, 100.0, 100.0, 47.0, 110.0, 10.0, 90.0, 30.0, 20.0, 49.0, 150.0, 30.0, 0.0, 50.0, 160.0, 100.0, 58.0, 140.0, 20.0, 140.0, 70.0, 110.0, 140.0, 130.0, 48.0, 60.0, 60.0, 60.0, 60.0, 200.0, 90.0, 54.0, 117.0, 98.0, 96.0, 100.0, 40.0, 33.0, 100.0, 50.0, 190.0, 140.0, 110.0, 100.0, 70.0, 30.0, 50.0, 130.0, 50.0, 150.0, 160.0, 40.0, 70.0, 50.0, 100.0, 70.0, 80.0, 110.0, 40.0, 60.0, 50.0, 60.0, 140.0, 90.0, 160.0, 20.0, 100.0, 150.0, 20.0, 130.0, 90.0, 140.0, 100.0, 90.0, 90.0, 90.0, 90.0, 110.0, 110.0, 240.0, 220.0, 110.0, 70.0, 70.0, 160.0, 98.0, 64.0, 90.0, 84.0, 39.0, 120.0, 130.0, 95.0, 70.0, 20.0, 30.0, 80.0, 95.0, 90.0, 63.0, 60.0, 120.0, 50.0, 99.0, 50.0, 40.0, -27.0, 120.0, 100.0, 170.0, 240.0, 100.0, -17.0, 80.0, 130.0, 90.0, 110.0, 100.0, 140.0, 60.0, 110.0, 40.0, 130.0, 80.0, 170.0, 150.0, 35.0, 150.0, 80.0, 15.0, 80.0, 150.0, 96.0, 90.0, 80.0, 90.0, 25.0, 60.0, 50.0, 40.0, 50.0, 180.0, 60.0, 120.0, 40.0, 170.0, 40.0, 90.0, 60.0, 120.0, 150.0, 60.0, 119.0, 100.0, 20.0, 190.0, 110.0, -1.0, 30.0, 30.0, 31.0, 190.0, 67.0, 90.0, 116.0, 216.0, 40.0, 50.0, 50.0, 60.0, 17.0, 35.0, 140.0, 170.0, 80.0, 23.0, 19.0, 130.0, 119.0, 100.0, 29.0, 40.0, 29.0, 90.0, 80.0, 130.0, 250.0, 100.0, 100.0, 57.0, 70.0, 57.0, 100.0, 140.0, 60.0, 100.0, 140.0, 100.0, 80.0, 110.0, 250.0, 70.0, 151.0, 60.0, 140.0, 50.0, 50.0, 90.0, 115.0, 130.0, 140.0, 90.0, 120.0, 120.0, 220.0, 150.0, 80.0, 140.0, 120.0, 110.0, 50.0, 80.0, 120.0, 250.0, 50.0, 110.0, 140.0, 170.0, 150.0, 90.0, 70.0, 90.0, 120.0, 160.0, 140.0, 180.0, 60.0, 10.0, 50.0, 130.0, 130.0, 130.0, 50.0, 80.0, 70.0, 83.0, 210.0, 90.0, 34.0, 160.0, 100.0, 50.0, 30.0, 100.0, 170.0, 49.0, 60.0, 160.0, 28.0, 120.0, 50.0, 110.0, 80.0, 110.0, 150.0, 200.0, 180.0, 130.0, 100.0, 160.0, 60.0, 210.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.636408499561959, "mean_inference_ms": 1.6331353028175273, "mean_action_processing_ms": 0.5010899984182825, "mean_env_wait_ms": 1.1268023193164745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011988162994384766, "StateBufferConnector_ms": 0.011854887008666992, "ViewRequirementAgentConnector_ms": 0.3745088577270508}, "num_episodes": 18, "episode_return_max": 1410.0, "episode_return_min": 350.0, "episode_return_mean": 951.49}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.75027894369357, "num_env_steps_trained_throughput_per_sec": 20.75027894369357, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 5120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5120000, "timers": {"training_iteration_time_ms": 193574.842, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193574.795, "sample_time_ms": 2518.001, "learn_time_ms": 191036.933, "learn_throughput": 20.938, "synch_weights_time_ms": 10.907}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "done": false, "training_iteration": 128, "trial_id": "1841f_00000", "date": "2024-08-08_06-35-57", "timestamp": 1723113357, "time_this_iter_s": 192.77653884887695, "time_total_s": 26140.671660661697, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29478b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26140.671660661697, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 17.270220588235293, "ram_util_percent": 77.98419117647057}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.155760821112936, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.635536489801538, "policy_loss": -0.013100626199784925, "vf_loss": 8.644496944537178, "vf_explained_var": -0.014760986252968558, "kl": 0.002726041914317519, "entropy": 0.5188690484014435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1206615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 350.0, "episode_reward_mean": 958.89, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -34.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 95.889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1320.0, 930.0, 1030.0, 984.0, 1060.0, 808.0, 1154.0, 1097.0, 1041.0, 745.0, 929.0, 791.0, 983.0, 1021.0, 1040.0, 979.0, 1067.0, 843.0, 350.0, 890.0, 792.0, 1234.0, 759.0, 1335.0, 1096.0, 935.0, 1055.0, 1180.0, 1170.0, 1187.0, 589.0, 901.0, 705.0, 851.0, 1410.0, 911.0, 1020.0, 864.0, 853.0, 1320.0, 648.0, 985.0, 732.0, 1125.0, 930.0, 1060.0, 898.0, 836.0, 909.0, 552.0, 1120.0, 833.0, 705.0, 870.0, 935.0, 536.0, 988.0, 879.0, 957.0, 850.0, 760.0, 1000.0, 1220.0, 950.0, 678.0, 875.0, 990.0, 1006.0, 725.0, 969.0, 767.0, 814.0, 739.0, 1034.0, 1201.0, 985.0, 1190.0, 1240.0, 1040.0, 907.0, 927.0, 1355.0, 1007.0, 1020.0, 961.0, 1057.0, 1282.0, 930.0, 720.0, 1035.0, 1150.0, 1188.0, 1135.0, 715.0, 1127.0, 973.0, 940.0, 485.0, 1097.0, 1118.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [48.0, 100.0, 268.0, 130.0, 210.0, 100.0, 160.0, 197.0, 60.0, 47.0, 120.0, 90.0, 90.0, 90.0, 160.0, 70.0, 60.0, 140.0, 20.0, 90.0, 70.0, 130.0, 90.0, 140.0, 140.0, 40.0, 150.0, 50.0, 140.0, 80.0, 110.0, 40.0, 120.0, 150.0, 120.0, 60.0, 130.0, -6.0, 140.0, 120.0, 130.0, 110.0, 60.0, 90.0, 280.0, 130.0, 40.0, 90.0, 100.0, 30.0, 60.0, 90.0, 140.0, 50.0, 130.0, 100.0, 60.0, 50.0, 70.0, 58.0, 170.0, 130.0, 15.0, 160.0, 100.0, 67.0, 160.0, 190.0, 82.0, 80.0, 80.0, 10.0, 130.0, 100.0, 160.0, 128.0, 50.0, 99.0, 140.0, 200.0, 100.0, 50.0, 40.0, 90.0, 60.0, 170.0, 120.0, 170.0, 81.0, 160.0, -1.0, 90.0, 94.0, 90.0, 80.0, 19.0, 170.0, 4.0, 49.0, 150.0, 220.0, 5.0, 30.0, 140.0, 44.0, 100.0, 100.0, 160.0, 20.0, 110.0, 60.0, 100.0, 60.0, 130.0, 70.0, 80.0, 40.0, 50.0, 120.0, 81.0, 140.0, 50.0, 150.0, 90.0, 66.0, 57.0, 70.0, 20.0, 250.0, 90.0, 70.0, 100.0, 90.0, 140.0, 61.0, 110.0, 140.0, 40.0, 150.0, 120.0, 120.0, 100.0, 80.0, 70.0, 80.0, 60.0, 90.0, 170.0, 130.0, 140.0, 80.0, 70.0, 50.0, 79.0, 180.0, 160.0, 100.0, 20.0, 130.0, 110.0, 200.0, 110.0, 80.0, 120.0, 29.0, 60.0, 80.0, 120.0, 178.0, 90.0, 50.0, 110.0, 90.0, 60.0, 40.0, 53.0, 40.0, 120.0, 140.0, 140.0, 20.0, 57.0, 37.0, 3.0, 15.0, 10.0, 28.0, 100.0, 20.0, 60.0, 130.0, 80.0, 90.0, 70.0, 130.0, 70.0, 90.0, 130.0, 40.0, 60.0, 40.0, 150.0, 7.0, 120.0, 200.0, 70.0, 24.0, 32.0, 50.0, 99.0, 140.0, 120.0, 150.0, 200.0, 110.0, 167.0, 70.0, 30.0, 150.0, 97.0, 40.0, 70.0, 130.0, 60.0, 40.0, 200.0, 30.0, 80.0, 39.0, 70.0, 80.0, 220.0, 120.0, 90.0, 120.0, 200.0, 140.0, 110.0, 117.0, 138.0, 70.0, 140.0, 180.0, 130.0, 110.0, 80.0, 110.0, 150.0, 90.0, 36.0, 70.0, 140.0, 40.0, 40.0, 160.0, 45.0, 130.0, 100.0, 60.0, 150.0, 80.0, 110.0, 100.0, 120.0, 65.0, 150.0, 110.0, 130.0, 100.0, 90.0, 150.0, 90.0, 110.0, 190.0, 110.0, 160.0, 110.0, 90.0, 80.0, 90.0, 170.0, 50.0, 90.0, 190.0, 70.0, 80.0, 105.0, 150.0, 130.0, 135.0, 190.0, 190.0, 60.0, 43.0, 120.0, 80.0, 154.0, 60.0, 200.0, 90.0, 20.0, 30.0, 20.0, 70.0, 28.0, 140.0, 22.0, 70.0, 139.0, 50.0, 90.0, 70.0, 80.0, 80.0, 69.0, 140.0, 135.0, 110.0, 80.0, 47.0, 140.0, 40.0, 70.0, 180.0, 7.0, 10.0, 90.0, 70.0, 30.0, 68.0, 100.0, 80.0, 110.0, 60.0, 80.0, 6.0, 170.0, 135.0, 50.0, 60.0, 80.0, 90.0, 150.0, 190.0, 160.0, 200.0, 150.0, 170.0, 140.0, 80.0, 168.0, 108.0, 80.0, 30.0, 60.0, 45.0, 50.0, 130.0, 90.0, 150.0, 70.0, 80.0, 90.0, 210.0, 90.0, 110.0, 150.0, 70.0, 110.0, 40.0, 50.0, 94.0, 100.0, 120.0, 10.0, 60.0, 140.0, 90.0, 120.0, 80.0, 130.0, 60.0, 200.0, 60.0, 17.0, 170.0, 40.0, 50.0, 50.0, 76.0, 100.0, 190.0, 80.0, 160.0, 90.0, 130.0, 70.0, 280.0, 120.0, 100.0, 48.0, 160.0, 100.0, 0.0, 40.0, 80.0, 90.0, 50.0, 20.0, 60.0, 90.0, 150.0, 120.0, 150.0, 40.0, 50.0, 120.0, 35.0, 100.0, 130.0, 99.0, 36.0, 65.0, 30.0, 210.0, 40.0, 100.0, 45.0, 47.0, 60.0, 100.0, 110.0, 120.0, 80.0, 130.0, 125.0, 20.0, 200.0, 140.0, 100.0, 80.0, 140.0, 60.0, 130.0, 80.0, 130.0, 100.0, 80.0, 60.0, 70.0, 70.0, 100.0, 80.0, 130.0, 90.0, 100.0, 160.0, 50.0, 170.0, 110.0, 134.0, 54.0, 110.0, 90.0, 70.0, 70.0, 80.0, 100.0, 70.0, 120.0, 102.0, 110.0, 20.0, 30.0, 98.0, 100.0, 180.0, 74.0, 62.0, 60.0, 51.0, 30.0, 70.0, 142.0, 120.0, 76.0, 30.0, 80.0, 190.0, 120.0, 80.0, 38.0, 30.0, 130.0, 40.0, 8.0, 70.0, 60.0, 70.0, 26.0, 78.0, 23.0, 120.0, 97.0, 87.0, 120.0, 130.0, 205.0, 110.0, 150.0, 107.0, 5.0, 100.0, 51.0, 90.0, 130.0, 120.0, 120.0, 60.0, 50.0, 90.0, 60.0, 60.0, 90.0, 100.0, 60.0, 40.0, 80.0, 75.0, 50.0, 70.0, 90.0, 160.0, 90.0, 50.0, 40.0, 150.0, 90.0, 90.0, 40.0, 51.0, 100.0, 50.0, 103.0, 41.0, 160.0, 80.0, 150.0, 100.0, 100.0, 47.0, 110.0, 10.0, 90.0, 30.0, 20.0, 49.0, 150.0, 30.0, 0.0, 50.0, 160.0, 100.0, 58.0, 140.0, 20.0, 140.0, 70.0, 110.0, 140.0, 130.0, 48.0, 60.0, 60.0, 60.0, 60.0, 200.0, 90.0, 54.0, 117.0, 98.0, 96.0, 100.0, 40.0, 33.0, 100.0, 50.0, 190.0, 140.0, 110.0, 100.0, 70.0, 30.0, 50.0, 130.0, 50.0, 150.0, 160.0, 40.0, 70.0, 50.0, 100.0, 70.0, 80.0, 110.0, 40.0, 60.0, 50.0, 60.0, 140.0, 90.0, 160.0, 20.0, 100.0, 150.0, 20.0, 130.0, 90.0, 140.0, 100.0, 90.0, 90.0, 90.0, 90.0, 110.0, 110.0, 240.0, 220.0, 110.0, 70.0, 70.0, 160.0, 98.0, 64.0, 90.0, 84.0, 39.0, 120.0, 130.0, 95.0, 70.0, 20.0, 30.0, 80.0, 95.0, 90.0, 63.0, 60.0, 120.0, 50.0, 99.0, 50.0, 40.0, -27.0, 120.0, 100.0, 170.0, 240.0, 100.0, -17.0, 80.0, 130.0, 90.0, 110.0, 100.0, 140.0, 60.0, 110.0, 40.0, 130.0, 80.0, 170.0, 150.0, 35.0, 150.0, 80.0, 15.0, 80.0, 150.0, 96.0, 90.0, 80.0, 90.0, 25.0, 60.0, 50.0, 40.0, 50.0, 180.0, 60.0, 120.0, 40.0, 170.0, 40.0, 90.0, 60.0, 120.0, 150.0, 60.0, 119.0, 100.0, 20.0, 190.0, 110.0, -1.0, 30.0, 30.0, 31.0, 190.0, 67.0, 90.0, 116.0, 216.0, 40.0, 50.0, 50.0, 60.0, 17.0, 35.0, 140.0, 170.0, 80.0, 23.0, 19.0, 130.0, 119.0, 100.0, 29.0, 40.0, 29.0, 90.0, 80.0, 130.0, 250.0, 100.0, 100.0, 57.0, 70.0, 57.0, 100.0, 140.0, 60.0, 100.0, 140.0, 100.0, 80.0, 110.0, 250.0, 70.0, 151.0, 60.0, 140.0, 50.0, 50.0, 90.0, 115.0, 130.0, 140.0, 90.0, 120.0, 120.0, 220.0, 150.0, 80.0, 140.0, 120.0, 110.0, 50.0, 80.0, 120.0, 250.0, 50.0, 110.0, 140.0, 170.0, 150.0, 90.0, 70.0, 90.0, 120.0, 160.0, 140.0, 180.0, 60.0, 10.0, 50.0, 130.0, 130.0, 130.0, 50.0, 80.0, 70.0, 83.0, 210.0, 90.0, 34.0, 160.0, 100.0, 50.0, 30.0, 100.0, 170.0, 49.0, 60.0, 160.0, 28.0, 120.0, 50.0, 110.0, 80.0, 110.0, 150.0, 200.0, 180.0, 130.0, 100.0, 160.0, 60.0, 210.0, 55.0, 110.0, 80.0, 132.0, 110.0, 70.0, 150.0, 140.0, 40.0, 90.0, 85.0, 80.0, 120.0, 220.0, 20.0, 80.0, 100.0, 80.0, 120.0, 100.0, 100.0, 145.0, 179.0, 60.0, 110.0, 40.0, 100.0, 100.0, 70.0, 87.0, 70.0, 98.0, 90.0, 130.0, 43.0, 140.0, 30.0, 140.0, 180.0, 100.0, 106.0, 190.0, 130.0, 110.0, 130.0, 120.0, 46.0, 130.0, 170.0, 96.0, 160.0, 90.0, 40.0, 60.0, 70.0, 110.0, 150.0, 210.0, 30.0, 100.0, 70.0, 90.0, 70.0, 70.0, 100.0, 60.0, 100.0, 70.0, 130.0, 30.0, 0.0, 105.0, 90.0, 150.0, 150.0, 120.0, 150.0, 80.0, 20.0, 100.0, 70.0, 50.0, 140.0, 100.0, 157.0, 160.0, 165.0, 60.0, 140.0, 150.0, 28.0, 130.0, 158.0, 210.0, 50.0, 110.0, 100.0, 150.0, 110.0, 90.0, 80.0, 90.0, 40.0, 130.0, 160.0, 130.0, 130.0, 85.0, 60.0, 130.0, 180.0, 130.0, 100.0, 50.0, 130.0, -34.0, 39.0, 50.0, 110.0, 34.0, 106.0, 57.0, 60.0, 150.0, 140.0, 120.0, 110.0, 140.0, 220.0, 90.0, 40.0, 100.0, 80.0, 109.0, 52.0, 102.0, 130.0, 100.0, 70.0, 140.0, 90.0, 80.0, 90.0, 50.0, 160.0, 110.0, 120.0, 140.0, 60.0, 30.0, 100.0, 40.0, 40.0, 40.0, 90.0, 40.0, 80.0, 90.0, 60.0, 15.0, -10.0, 140.0, 108.0, 90.0, 69.0, 60.0, 80.0, 180.0, 190.0, 70.0, 110.0, 80.0, 245.0, 73.0, 80.0, 110.0, 170.0, 160.0, 50.0, 60.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6343176771564034, "mean_inference_ms": 1.6312299277241555, "mean_action_processing_ms": 0.5006287482226869, "mean_env_wait_ms": 1.1258117930749747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011903047561645508, "StateBufferConnector_ms": 0.011762619018554688, "ViewRequirementAgentConnector_ms": 0.37277817726135254}, "num_episodes": 18, "episode_return_max": 1410.0, "episode_return_min": 350.0, "episode_return_mean": 958.89}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.733732698499338, "num_env_steps_trained_throughput_per_sec": 20.733732698499338, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 5160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5160000, "timers": {"training_iteration_time_ms": 193414.245, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193414.198, "sample_time_ms": 2483.602, "learn_time_ms": 190910.856, "learn_throughput": 20.952, "synch_weights_time_ms": 10.867}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "done": false, "training_iteration": 129, "trial_id": "1841f_00000", "date": "2024-08-08_06-39-10", "timestamp": 1723113550, "time_this_iter_s": 192.93113493919373, "time_total_s": 26333.60279560089, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2947f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26333.60279560089, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 17.02307692307693, "ram_util_percent": 78.04725274725276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3346223172796168, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.013938064238128944, "vf_loss": 8.397163797059633, "vf_explained_var": -0.02281821824618168, "kl": Infinity, "entropy": 0.5332477536381751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1216005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 485.0, "episode_reward_mean": 954.24, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -34.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 95.424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1335.0, 1096.0, 935.0, 1055.0, 1180.0, 1170.0, 1187.0, 589.0, 901.0, 705.0, 851.0, 1410.0, 911.0, 1020.0, 864.0, 853.0, 1320.0, 648.0, 985.0, 732.0, 1125.0, 930.0, 1060.0, 898.0, 836.0, 909.0, 552.0, 1120.0, 833.0, 705.0, 870.0, 935.0, 536.0, 988.0, 879.0, 957.0, 850.0, 760.0, 1000.0, 1220.0, 950.0, 678.0, 875.0, 990.0, 1006.0, 725.0, 969.0, 767.0, 814.0, 739.0, 1034.0, 1201.0, 985.0, 1190.0, 1240.0, 1040.0, 907.0, 927.0, 1355.0, 1007.0, 1020.0, 961.0, 1057.0, 1282.0, 930.0, 720.0, 1035.0, 1150.0, 1188.0, 1135.0, 715.0, 1127.0, 973.0, 940.0, 485.0, 1097.0, 1118.0, 915.0, 865.0, 533.0, 1190.0, 980.0, 1018.0, 1170.0, 760.0, 1189.0, 856.0, 1048.0, 1030.0, 927.0, 979.0, 883.0, 830.0, 885.0, 756.0, 920.0, 1132.0, 1112.0, 519.0, 885.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 220.0, 120.0, 90.0, 120.0, 200.0, 140.0, 110.0, 117.0, 138.0, 70.0, 140.0, 180.0, 130.0, 110.0, 80.0, 110.0, 150.0, 90.0, 36.0, 70.0, 140.0, 40.0, 40.0, 160.0, 45.0, 130.0, 100.0, 60.0, 150.0, 80.0, 110.0, 100.0, 120.0, 65.0, 150.0, 110.0, 130.0, 100.0, 90.0, 150.0, 90.0, 110.0, 190.0, 110.0, 160.0, 110.0, 90.0, 80.0, 90.0, 170.0, 50.0, 90.0, 190.0, 70.0, 80.0, 105.0, 150.0, 130.0, 135.0, 190.0, 190.0, 60.0, 43.0, 120.0, 80.0, 154.0, 60.0, 200.0, 90.0, 20.0, 30.0, 20.0, 70.0, 28.0, 140.0, 22.0, 70.0, 139.0, 50.0, 90.0, 70.0, 80.0, 80.0, 69.0, 140.0, 135.0, 110.0, 80.0, 47.0, 140.0, 40.0, 70.0, 180.0, 7.0, 10.0, 90.0, 70.0, 30.0, 68.0, 100.0, 80.0, 110.0, 60.0, 80.0, 6.0, 170.0, 135.0, 50.0, 60.0, 80.0, 90.0, 150.0, 190.0, 160.0, 200.0, 150.0, 170.0, 140.0, 80.0, 168.0, 108.0, 80.0, 30.0, 60.0, 45.0, 50.0, 130.0, 90.0, 150.0, 70.0, 80.0, 90.0, 210.0, 90.0, 110.0, 150.0, 70.0, 110.0, 40.0, 50.0, 94.0, 100.0, 120.0, 10.0, 60.0, 140.0, 90.0, 120.0, 80.0, 130.0, 60.0, 200.0, 60.0, 17.0, 170.0, 40.0, 50.0, 50.0, 76.0, 100.0, 190.0, 80.0, 160.0, 90.0, 130.0, 70.0, 280.0, 120.0, 100.0, 48.0, 160.0, 100.0, 0.0, 40.0, 80.0, 90.0, 50.0, 20.0, 60.0, 90.0, 150.0, 120.0, 150.0, 40.0, 50.0, 120.0, 35.0, 100.0, 130.0, 99.0, 36.0, 65.0, 30.0, 210.0, 40.0, 100.0, 45.0, 47.0, 60.0, 100.0, 110.0, 120.0, 80.0, 130.0, 125.0, 20.0, 200.0, 140.0, 100.0, 80.0, 140.0, 60.0, 130.0, 80.0, 130.0, 100.0, 80.0, 60.0, 70.0, 70.0, 100.0, 80.0, 130.0, 90.0, 100.0, 160.0, 50.0, 170.0, 110.0, 134.0, 54.0, 110.0, 90.0, 70.0, 70.0, 80.0, 100.0, 70.0, 120.0, 102.0, 110.0, 20.0, 30.0, 98.0, 100.0, 180.0, 74.0, 62.0, 60.0, 51.0, 30.0, 70.0, 142.0, 120.0, 76.0, 30.0, 80.0, 190.0, 120.0, 80.0, 38.0, 30.0, 130.0, 40.0, 8.0, 70.0, 60.0, 70.0, 26.0, 78.0, 23.0, 120.0, 97.0, 87.0, 120.0, 130.0, 205.0, 110.0, 150.0, 107.0, 5.0, 100.0, 51.0, 90.0, 130.0, 120.0, 120.0, 60.0, 50.0, 90.0, 60.0, 60.0, 90.0, 100.0, 60.0, 40.0, 80.0, 75.0, 50.0, 70.0, 90.0, 160.0, 90.0, 50.0, 40.0, 150.0, 90.0, 90.0, 40.0, 51.0, 100.0, 50.0, 103.0, 41.0, 160.0, 80.0, 150.0, 100.0, 100.0, 47.0, 110.0, 10.0, 90.0, 30.0, 20.0, 49.0, 150.0, 30.0, 0.0, 50.0, 160.0, 100.0, 58.0, 140.0, 20.0, 140.0, 70.0, 110.0, 140.0, 130.0, 48.0, 60.0, 60.0, 60.0, 60.0, 200.0, 90.0, 54.0, 117.0, 98.0, 96.0, 100.0, 40.0, 33.0, 100.0, 50.0, 190.0, 140.0, 110.0, 100.0, 70.0, 30.0, 50.0, 130.0, 50.0, 150.0, 160.0, 40.0, 70.0, 50.0, 100.0, 70.0, 80.0, 110.0, 40.0, 60.0, 50.0, 60.0, 140.0, 90.0, 160.0, 20.0, 100.0, 150.0, 20.0, 130.0, 90.0, 140.0, 100.0, 90.0, 90.0, 90.0, 90.0, 110.0, 110.0, 240.0, 220.0, 110.0, 70.0, 70.0, 160.0, 98.0, 64.0, 90.0, 84.0, 39.0, 120.0, 130.0, 95.0, 70.0, 20.0, 30.0, 80.0, 95.0, 90.0, 63.0, 60.0, 120.0, 50.0, 99.0, 50.0, 40.0, -27.0, 120.0, 100.0, 170.0, 240.0, 100.0, -17.0, 80.0, 130.0, 90.0, 110.0, 100.0, 140.0, 60.0, 110.0, 40.0, 130.0, 80.0, 170.0, 150.0, 35.0, 150.0, 80.0, 15.0, 80.0, 150.0, 96.0, 90.0, 80.0, 90.0, 25.0, 60.0, 50.0, 40.0, 50.0, 180.0, 60.0, 120.0, 40.0, 170.0, 40.0, 90.0, 60.0, 120.0, 150.0, 60.0, 119.0, 100.0, 20.0, 190.0, 110.0, -1.0, 30.0, 30.0, 31.0, 190.0, 67.0, 90.0, 116.0, 216.0, 40.0, 50.0, 50.0, 60.0, 17.0, 35.0, 140.0, 170.0, 80.0, 23.0, 19.0, 130.0, 119.0, 100.0, 29.0, 40.0, 29.0, 90.0, 80.0, 130.0, 250.0, 100.0, 100.0, 57.0, 70.0, 57.0, 100.0, 140.0, 60.0, 100.0, 140.0, 100.0, 80.0, 110.0, 250.0, 70.0, 151.0, 60.0, 140.0, 50.0, 50.0, 90.0, 115.0, 130.0, 140.0, 90.0, 120.0, 120.0, 220.0, 150.0, 80.0, 140.0, 120.0, 110.0, 50.0, 80.0, 120.0, 250.0, 50.0, 110.0, 140.0, 170.0, 150.0, 90.0, 70.0, 90.0, 120.0, 160.0, 140.0, 180.0, 60.0, 10.0, 50.0, 130.0, 130.0, 130.0, 50.0, 80.0, 70.0, 83.0, 210.0, 90.0, 34.0, 160.0, 100.0, 50.0, 30.0, 100.0, 170.0, 49.0, 60.0, 160.0, 28.0, 120.0, 50.0, 110.0, 80.0, 110.0, 150.0, 200.0, 180.0, 130.0, 100.0, 160.0, 60.0, 210.0, 55.0, 110.0, 80.0, 132.0, 110.0, 70.0, 150.0, 140.0, 40.0, 90.0, 85.0, 80.0, 120.0, 220.0, 20.0, 80.0, 100.0, 80.0, 120.0, 100.0, 100.0, 145.0, 179.0, 60.0, 110.0, 40.0, 100.0, 100.0, 70.0, 87.0, 70.0, 98.0, 90.0, 130.0, 43.0, 140.0, 30.0, 140.0, 180.0, 100.0, 106.0, 190.0, 130.0, 110.0, 130.0, 120.0, 46.0, 130.0, 170.0, 96.0, 160.0, 90.0, 40.0, 60.0, 70.0, 110.0, 150.0, 210.0, 30.0, 100.0, 70.0, 90.0, 70.0, 70.0, 100.0, 60.0, 100.0, 70.0, 130.0, 30.0, 0.0, 105.0, 90.0, 150.0, 150.0, 120.0, 150.0, 80.0, 20.0, 100.0, 70.0, 50.0, 140.0, 100.0, 157.0, 160.0, 165.0, 60.0, 140.0, 150.0, 28.0, 130.0, 158.0, 210.0, 50.0, 110.0, 100.0, 150.0, 110.0, 90.0, 80.0, 90.0, 40.0, 130.0, 160.0, 130.0, 130.0, 85.0, 60.0, 130.0, 180.0, 130.0, 100.0, 50.0, 130.0, -34.0, 39.0, 50.0, 110.0, 34.0, 106.0, 57.0, 60.0, 150.0, 140.0, 120.0, 110.0, 140.0, 220.0, 90.0, 40.0, 100.0, 80.0, 109.0, 52.0, 102.0, 130.0, 100.0, 70.0, 140.0, 90.0, 80.0, 90.0, 50.0, 160.0, 110.0, 120.0, 140.0, 60.0, 30.0, 100.0, 40.0, 40.0, 40.0, 90.0, 40.0, 80.0, 90.0, 60.0, 15.0, -10.0, 140.0, 108.0, 90.0, 69.0, 60.0, 80.0, 180.0, 190.0, 70.0, 110.0, 80.0, 245.0, 73.0, 80.0, 110.0, 170.0, 160.0, 50.0, 60.0, 90.0, 130.0, 30.0, 140.0, 110.0, 80.0, 40.0, 150.0, 120.0, 35.0, 80.0, 70.0, 150.0, 20.0, 120.0, 106.0, 129.0, 70.0, 30.0, 90.0, 80.0, 1.0, 50.0, 180.0, 0.0, -18.0, 50.0, 110.0, 50.0, 30.0, 80.0, 80.0, 90.0, 140.0, 90.0, 70.0, 100.0, 200.0, 130.0, 80.0, 210.0, 120.0, 120.0, 80.0, 120.0, 100.0, 120.0, 60.0, 90.0, 130.0, 40.0, 44.0, 90.0, 140.0, 119.0, 40.0, 55.0, 100.0, 60.0, 190.0, 180.0, 130.0, 165.0, 160.0, 90.0, 110.0, 105.0, 50.0, 150.0, 100.0, 110.0, 150.0, 20.0, 130.0, 60.0, 70.0, 100.0, 50.0, 30.0, 90.0, 60.0, 90.0, 190.0, 100.0, 90.0, 97.0, 145.0, 91.0, 136.0, 140.0, 110.0, 120.0, 30.0, 90.0, 70.0, 70.0, 85.0, 110.0, 77.0, 140.0, 64.0, 100.0, 110.0, 230.0, 80.0, 80.0, 160.0, 25.0, 110.0, 63.0, 90.0, 100.0, 150.0, 70.0, 100.0, 80.0, 90.0, 70.0, 170.0, 100.0, 100.0, 91.0, 70.0, 50.0, 70.0, 90.0, 220.0, 36.0, 130.0, 100.0, 70.0, 80.0, 70.0, 60.0, 80.0, 130.0, 39.0, 110.0, 230.0, 70.0, 110.0, 90.0, 79.0, 135.0, 0.0, 65.0, 120.0, 100.0, 110.0, 94.0, 90.0, 40.0, 130.0, 90.0, 30.0, 70.0, 30.0, 150.0, 60.0, 200.0, 30.0, 100.0, 70.0, 150.0, 110.0, 120.0, 23.0, 50.0, 90.0, 62.0, 110.0, 150.0, 14.0, 80.0, 110.0, 53.0, 70.0, 19.0, 160.0, 70.0, 30.0, 80.0, 100.0, 70.0, 130.0, 70.0, 120.0, 50.0, 90.0, 110.0, 100.0, 165.0, 70.0, 150.0, 70.0, 60.0, 49.0, 77.0, 82.0, 190.0, 219.0, 24.0, 130.0, 250.0, 90.0, 160.0, 138.0, 100.0, 50.0, 120.0, 50.0, 90.0, 40.0, 50.0, 140.0, 10.0, 70.0, 9.0, 60.0, 10.0, 40.0, 70.0, 70.0, 110.0, 90.0, 110.0, 90.0, 90.0, 80.0, 120.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6317593324630046, "mean_inference_ms": 1.6289385243688537, "mean_action_processing_ms": 0.5000570380924916, "mean_env_wait_ms": 1.1245732087451592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012248754501342773, "StateBufferConnector_ms": 0.008882522583007812, "ViewRequirementAgentConnector_ms": 0.3624389171600342}, "num_episodes": 23, "episode_return_max": 1410.0, "episode_return_min": 485.0, "episode_return_mean": 954.24}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.787849707469206, "num_env_steps_trained_throughput_per_sec": 20.787849707469206, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 5200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5200000, "timers": {"training_iteration_time_ms": 193197.406, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193197.359, "sample_time_ms": 2493.165, "learn_time_ms": 190684.27, "learn_throughput": 20.977, "synch_weights_time_ms": 11.138}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "done": false, "training_iteration": 130, "trial_id": "1841f_00000", "date": "2024-08-08_06-42-23", "timestamp": 1723113743, "time_this_iter_s": 192.42940402030945, "time_total_s": 26526.0321996212, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29e5160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26526.0321996212, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 16.844485294117646, "ram_util_percent": 78.03860294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.429217786771167, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.50669019534565, "policy_loss": -0.013545007646531144, "vf_loss": 8.516412683543814, "vf_explained_var": -0.01330960537044131, "kl": 0.0033558386042823922, "entropy": 0.542905709328362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1225395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "env_runners": {"episode_reward_max": 1460.0, "episode_reward_min": 485.0, "episode_reward_mean": 938.22, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -34.0}, "policy_reward_max": {"policy_0": 340.0}, "policy_reward_mean": {"policy_0": 93.822}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1060.0, 898.0, 836.0, 909.0, 552.0, 1120.0, 833.0, 705.0, 870.0, 935.0, 536.0, 988.0, 879.0, 957.0, 850.0, 760.0, 1000.0, 1220.0, 950.0, 678.0, 875.0, 990.0, 1006.0, 725.0, 969.0, 767.0, 814.0, 739.0, 1034.0, 1201.0, 985.0, 1190.0, 1240.0, 1040.0, 907.0, 927.0, 1355.0, 1007.0, 1020.0, 961.0, 1057.0, 1282.0, 930.0, 720.0, 1035.0, 1150.0, 1188.0, 1135.0, 715.0, 1127.0, 973.0, 940.0, 485.0, 1097.0, 1118.0, 915.0, 865.0, 533.0, 1190.0, 980.0, 1018.0, 1170.0, 760.0, 1189.0, 856.0, 1048.0, 1030.0, 927.0, 979.0, 883.0, 830.0, 885.0, 756.0, 920.0, 1132.0, 1112.0, 519.0, 885.0, 1018.0, 867.0, 554.0, 1137.0, 1034.0, 725.0, 1000.0, 800.0, 957.0, 1336.0, 1122.0, 690.0, 1084.0, 750.0, 537.0, 914.0, 840.0, 1460.0, 934.0, 925.0, 768.0, 748.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 100.0, 80.0, 130.0, 90.0, 100.0, 160.0, 50.0, 170.0, 110.0, 134.0, 54.0, 110.0, 90.0, 70.0, 70.0, 80.0, 100.0, 70.0, 120.0, 102.0, 110.0, 20.0, 30.0, 98.0, 100.0, 180.0, 74.0, 62.0, 60.0, 51.0, 30.0, 70.0, 142.0, 120.0, 76.0, 30.0, 80.0, 190.0, 120.0, 80.0, 38.0, 30.0, 130.0, 40.0, 8.0, 70.0, 60.0, 70.0, 26.0, 78.0, 23.0, 120.0, 97.0, 87.0, 120.0, 130.0, 205.0, 110.0, 150.0, 107.0, 5.0, 100.0, 51.0, 90.0, 130.0, 120.0, 120.0, 60.0, 50.0, 90.0, 60.0, 60.0, 90.0, 100.0, 60.0, 40.0, 80.0, 75.0, 50.0, 70.0, 90.0, 160.0, 90.0, 50.0, 40.0, 150.0, 90.0, 90.0, 40.0, 51.0, 100.0, 50.0, 103.0, 41.0, 160.0, 80.0, 150.0, 100.0, 100.0, 47.0, 110.0, 10.0, 90.0, 30.0, 20.0, 49.0, 150.0, 30.0, 0.0, 50.0, 160.0, 100.0, 58.0, 140.0, 20.0, 140.0, 70.0, 110.0, 140.0, 130.0, 48.0, 60.0, 60.0, 60.0, 60.0, 200.0, 90.0, 54.0, 117.0, 98.0, 96.0, 100.0, 40.0, 33.0, 100.0, 50.0, 190.0, 140.0, 110.0, 100.0, 70.0, 30.0, 50.0, 130.0, 50.0, 150.0, 160.0, 40.0, 70.0, 50.0, 100.0, 70.0, 80.0, 110.0, 40.0, 60.0, 50.0, 60.0, 140.0, 90.0, 160.0, 20.0, 100.0, 150.0, 20.0, 130.0, 90.0, 140.0, 100.0, 90.0, 90.0, 90.0, 90.0, 110.0, 110.0, 240.0, 220.0, 110.0, 70.0, 70.0, 160.0, 98.0, 64.0, 90.0, 84.0, 39.0, 120.0, 130.0, 95.0, 70.0, 20.0, 30.0, 80.0, 95.0, 90.0, 63.0, 60.0, 120.0, 50.0, 99.0, 50.0, 40.0, -27.0, 120.0, 100.0, 170.0, 240.0, 100.0, -17.0, 80.0, 130.0, 90.0, 110.0, 100.0, 140.0, 60.0, 110.0, 40.0, 130.0, 80.0, 170.0, 150.0, 35.0, 150.0, 80.0, 15.0, 80.0, 150.0, 96.0, 90.0, 80.0, 90.0, 25.0, 60.0, 50.0, 40.0, 50.0, 180.0, 60.0, 120.0, 40.0, 170.0, 40.0, 90.0, 60.0, 120.0, 150.0, 60.0, 119.0, 100.0, 20.0, 190.0, 110.0, -1.0, 30.0, 30.0, 31.0, 190.0, 67.0, 90.0, 116.0, 216.0, 40.0, 50.0, 50.0, 60.0, 17.0, 35.0, 140.0, 170.0, 80.0, 23.0, 19.0, 130.0, 119.0, 100.0, 29.0, 40.0, 29.0, 90.0, 80.0, 130.0, 250.0, 100.0, 100.0, 57.0, 70.0, 57.0, 100.0, 140.0, 60.0, 100.0, 140.0, 100.0, 80.0, 110.0, 250.0, 70.0, 151.0, 60.0, 140.0, 50.0, 50.0, 90.0, 115.0, 130.0, 140.0, 90.0, 120.0, 120.0, 220.0, 150.0, 80.0, 140.0, 120.0, 110.0, 50.0, 80.0, 120.0, 250.0, 50.0, 110.0, 140.0, 170.0, 150.0, 90.0, 70.0, 90.0, 120.0, 160.0, 140.0, 180.0, 60.0, 10.0, 50.0, 130.0, 130.0, 130.0, 50.0, 80.0, 70.0, 83.0, 210.0, 90.0, 34.0, 160.0, 100.0, 50.0, 30.0, 100.0, 170.0, 49.0, 60.0, 160.0, 28.0, 120.0, 50.0, 110.0, 80.0, 110.0, 150.0, 200.0, 180.0, 130.0, 100.0, 160.0, 60.0, 210.0, 55.0, 110.0, 80.0, 132.0, 110.0, 70.0, 150.0, 140.0, 40.0, 90.0, 85.0, 80.0, 120.0, 220.0, 20.0, 80.0, 100.0, 80.0, 120.0, 100.0, 100.0, 145.0, 179.0, 60.0, 110.0, 40.0, 100.0, 100.0, 70.0, 87.0, 70.0, 98.0, 90.0, 130.0, 43.0, 140.0, 30.0, 140.0, 180.0, 100.0, 106.0, 190.0, 130.0, 110.0, 130.0, 120.0, 46.0, 130.0, 170.0, 96.0, 160.0, 90.0, 40.0, 60.0, 70.0, 110.0, 150.0, 210.0, 30.0, 100.0, 70.0, 90.0, 70.0, 70.0, 100.0, 60.0, 100.0, 70.0, 130.0, 30.0, 0.0, 105.0, 90.0, 150.0, 150.0, 120.0, 150.0, 80.0, 20.0, 100.0, 70.0, 50.0, 140.0, 100.0, 157.0, 160.0, 165.0, 60.0, 140.0, 150.0, 28.0, 130.0, 158.0, 210.0, 50.0, 110.0, 100.0, 150.0, 110.0, 90.0, 80.0, 90.0, 40.0, 130.0, 160.0, 130.0, 130.0, 85.0, 60.0, 130.0, 180.0, 130.0, 100.0, 50.0, 130.0, -34.0, 39.0, 50.0, 110.0, 34.0, 106.0, 57.0, 60.0, 150.0, 140.0, 120.0, 110.0, 140.0, 220.0, 90.0, 40.0, 100.0, 80.0, 109.0, 52.0, 102.0, 130.0, 100.0, 70.0, 140.0, 90.0, 80.0, 90.0, 50.0, 160.0, 110.0, 120.0, 140.0, 60.0, 30.0, 100.0, 40.0, 40.0, 40.0, 90.0, 40.0, 80.0, 90.0, 60.0, 15.0, -10.0, 140.0, 108.0, 90.0, 69.0, 60.0, 80.0, 180.0, 190.0, 70.0, 110.0, 80.0, 245.0, 73.0, 80.0, 110.0, 170.0, 160.0, 50.0, 60.0, 90.0, 130.0, 30.0, 140.0, 110.0, 80.0, 40.0, 150.0, 120.0, 35.0, 80.0, 70.0, 150.0, 20.0, 120.0, 106.0, 129.0, 70.0, 30.0, 90.0, 80.0, 1.0, 50.0, 180.0, 0.0, -18.0, 50.0, 110.0, 50.0, 30.0, 80.0, 80.0, 90.0, 140.0, 90.0, 70.0, 100.0, 200.0, 130.0, 80.0, 210.0, 120.0, 120.0, 80.0, 120.0, 100.0, 120.0, 60.0, 90.0, 130.0, 40.0, 44.0, 90.0, 140.0, 119.0, 40.0, 55.0, 100.0, 60.0, 190.0, 180.0, 130.0, 165.0, 160.0, 90.0, 110.0, 105.0, 50.0, 150.0, 100.0, 110.0, 150.0, 20.0, 130.0, 60.0, 70.0, 100.0, 50.0, 30.0, 90.0, 60.0, 90.0, 190.0, 100.0, 90.0, 97.0, 145.0, 91.0, 136.0, 140.0, 110.0, 120.0, 30.0, 90.0, 70.0, 70.0, 85.0, 110.0, 77.0, 140.0, 64.0, 100.0, 110.0, 230.0, 80.0, 80.0, 160.0, 25.0, 110.0, 63.0, 90.0, 100.0, 150.0, 70.0, 100.0, 80.0, 90.0, 70.0, 170.0, 100.0, 100.0, 91.0, 70.0, 50.0, 70.0, 90.0, 220.0, 36.0, 130.0, 100.0, 70.0, 80.0, 70.0, 60.0, 80.0, 130.0, 39.0, 110.0, 230.0, 70.0, 110.0, 90.0, 79.0, 135.0, 0.0, 65.0, 120.0, 100.0, 110.0, 94.0, 90.0, 40.0, 130.0, 90.0, 30.0, 70.0, 30.0, 150.0, 60.0, 200.0, 30.0, 100.0, 70.0, 150.0, 110.0, 120.0, 23.0, 50.0, 90.0, 62.0, 110.0, 150.0, 14.0, 80.0, 110.0, 53.0, 70.0, 19.0, 160.0, 70.0, 30.0, 80.0, 100.0, 70.0, 130.0, 70.0, 120.0, 50.0, 90.0, 110.0, 100.0, 165.0, 70.0, 150.0, 70.0, 60.0, 49.0, 77.0, 82.0, 190.0, 219.0, 24.0, 130.0, 250.0, 90.0, 160.0, 138.0, 100.0, 50.0, 120.0, 50.0, 90.0, 40.0, 50.0, 140.0, 10.0, 70.0, 9.0, 60.0, 10.0, 40.0, 70.0, 70.0, 110.0, 90.0, 110.0, 90.0, 90.0, 80.0, 120.0, 55.0, 146.0, 150.0, 220.0, 70.0, 70.0, 80.0, 80.0, 11.0, 90.0, 101.0, 70.0, 80.0, 170.0, 150.0, 30.0, 52.0, 50.0, 90.0, 110.0, 65.0, -19.0, 20.0, 69.0, 42.0, 80.0, -1.0, 146.0, 60.0, 27.0, 130.0, 282.0, 80.0, 110.0, 65.0, 116.0, 170.0, 140.0, 16.0, 98.0, 60.0, 140.0, 90.0, 48.0, 30.0, 46.0, 110.0, 120.0, 220.0, 80.0, 150.0, 10.0, 110.0, 90.0, 30.0, 36.0, 19.0, 90.0, 180.0, 20.0, 140.0, 60.0, 100.0, 190.0, 50.0, 130.0, 80.0, 100.0, 90.0, 100.0, 100.0, 50.0, 120.0, 50.0, 80.0, 130.0, 100.0, 60.0, 60.0, 50.0, 100.0, 90.0, 80.0, 23.0, 120.0, 110.0, 30.0, 25.0, 49.0, 170.0, 260.0, 60.0, 68.0, 180.0, 98.0, 160.0, 180.0, 130.0, 110.0, 150.0, 200.0, 170.0, 126.0, 66.0, 100.0, 110.0, 160.0, 30.0, 70.0, 90.0, 200.0, 80.0, 40.0, 70.0, 60.0, 180.0, 50.0, 70.0, 20.0, 80.0, 40.0, 50.0, 120.0, 106.0, 210.0, 160.0, 70.0, 108.0, 70.0, 140.0, 50.0, 60.0, 70.0, 40.0, 120.0, 110.0, 90.0, 40.0, 30.0, 90.0, 100.0, 80.0, 130.0, 65.0, 60.0, 50.0, -22.0, 78.0, 0.0, 30.0, 66.0, 97.0, 140.0, 70.0, 57.0, 22.0, 70.0, 90.0, 74.0, 195.0, 99.0, 30.0, 120.0, 50.0, 80.0, 150.0, 120.0, 100.0, 50.0, 60.0, 80.0, 190.0, 120.0, 340.0, 220.0, 140.0, 60.0, 90.0, 80.0, 90.0, 130.0, 90.0, 100.0, 10.0, 177.0, 80.0, 70.0, 150.0, 100.0, 17.0, 140.0, 45.0, 107.0, 113.0, 120.0, 90.0, 100.0, 100.0, 50.0, 30.0, 170.0, 50.0, 100.0, 310.0, 6.0, 29.0, 11.0, 55.0, 176.0, 5.0, 26.0, 120.0, 50.0, 60.0, 50.0, 70.0, 102.0, 120.0, 40.0, 110.0, 26.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6304338729835655, "mean_inference_ms": 1.6280550767641362, "mean_action_processing_ms": 0.4996092617545975, "mean_env_wait_ms": 1.123234380287854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012084007263183594, "StateBufferConnector_ms": 0.008910655975341797, "ViewRequirementAgentConnector_ms": 0.36902689933776855}, "num_episodes": 22, "episode_return_max": 1460.0, "episode_return_min": 485.0, "episode_return_mean": 938.22}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.654744966693233, "num_env_steps_trained_throughput_per_sec": 20.654744966693233, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 5240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5240000, "timers": {"training_iteration_time_ms": 193234.813, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193234.766, "sample_time_ms": 2485.595, "learn_time_ms": 190729.16, "learn_throughput": 20.972, "synch_weights_time_ms": 11.289}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "done": false, "training_iteration": 131, "trial_id": "1841f_00000", "date": "2024-08-08_06-45-36", "timestamp": 1723113936, "time_this_iter_s": 193.66959714889526, "time_total_s": 26719.701796770096, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29e5040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26719.701796770096, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 18.193065693430654, "ram_util_percent": 78.4492700729927}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0867521057367577, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.015513915350215353, "vf_loss": 8.539804832267558, "vf_explained_var": -0.026404108540318643, "kl": Infinity, "entropy": 0.5224091463036938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1234785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "env_runners": {"episode_reward_max": 1460.0, "episode_reward_min": 485.0, "episode_reward_mean": 956.16, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -34.0}, "policy_reward_max": {"policy_0": 340.0}, "policy_reward_mean": {"policy_0": 95.616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 678.0, 875.0, 990.0, 1006.0, 725.0, 969.0, 767.0, 814.0, 739.0, 1034.0, 1201.0, 985.0, 1190.0, 1240.0, 1040.0, 907.0, 927.0, 1355.0, 1007.0, 1020.0, 961.0, 1057.0, 1282.0, 930.0, 720.0, 1035.0, 1150.0, 1188.0, 1135.0, 715.0, 1127.0, 973.0, 940.0, 485.0, 1097.0, 1118.0, 915.0, 865.0, 533.0, 1190.0, 980.0, 1018.0, 1170.0, 760.0, 1189.0, 856.0, 1048.0, 1030.0, 927.0, 979.0, 883.0, 830.0, 885.0, 756.0, 920.0, 1132.0, 1112.0, 519.0, 885.0, 1018.0, 867.0, 554.0, 1137.0, 1034.0, 725.0, 1000.0, 800.0, 957.0, 1336.0, 1122.0, 690.0, 1084.0, 750.0, 537.0, 914.0, 840.0, 1460.0, 934.0, 925.0, 768.0, 748.0, 1112.0, 658.0, 1016.0, 821.0, 885.0, 924.0, 1245.0, 1156.0, 769.0, 1218.0, 692.0, 1176.0, 1283.0, 876.0, 1040.0, 1034.0, 929.0, 868.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 160.0, 98.0, 64.0, 90.0, 84.0, 39.0, 120.0, 130.0, 95.0, 70.0, 20.0, 30.0, 80.0, 95.0, 90.0, 63.0, 60.0, 120.0, 50.0, 99.0, 50.0, 40.0, -27.0, 120.0, 100.0, 170.0, 240.0, 100.0, -17.0, 80.0, 130.0, 90.0, 110.0, 100.0, 140.0, 60.0, 110.0, 40.0, 130.0, 80.0, 170.0, 150.0, 35.0, 150.0, 80.0, 15.0, 80.0, 150.0, 96.0, 90.0, 80.0, 90.0, 25.0, 60.0, 50.0, 40.0, 50.0, 180.0, 60.0, 120.0, 40.0, 170.0, 40.0, 90.0, 60.0, 120.0, 150.0, 60.0, 119.0, 100.0, 20.0, 190.0, 110.0, -1.0, 30.0, 30.0, 31.0, 190.0, 67.0, 90.0, 116.0, 216.0, 40.0, 50.0, 50.0, 60.0, 17.0, 35.0, 140.0, 170.0, 80.0, 23.0, 19.0, 130.0, 119.0, 100.0, 29.0, 40.0, 29.0, 90.0, 80.0, 130.0, 250.0, 100.0, 100.0, 57.0, 70.0, 57.0, 100.0, 140.0, 60.0, 100.0, 140.0, 100.0, 80.0, 110.0, 250.0, 70.0, 151.0, 60.0, 140.0, 50.0, 50.0, 90.0, 115.0, 130.0, 140.0, 90.0, 120.0, 120.0, 220.0, 150.0, 80.0, 140.0, 120.0, 110.0, 50.0, 80.0, 120.0, 250.0, 50.0, 110.0, 140.0, 170.0, 150.0, 90.0, 70.0, 90.0, 120.0, 160.0, 140.0, 180.0, 60.0, 10.0, 50.0, 130.0, 130.0, 130.0, 50.0, 80.0, 70.0, 83.0, 210.0, 90.0, 34.0, 160.0, 100.0, 50.0, 30.0, 100.0, 170.0, 49.0, 60.0, 160.0, 28.0, 120.0, 50.0, 110.0, 80.0, 110.0, 150.0, 200.0, 180.0, 130.0, 100.0, 160.0, 60.0, 210.0, 55.0, 110.0, 80.0, 132.0, 110.0, 70.0, 150.0, 140.0, 40.0, 90.0, 85.0, 80.0, 120.0, 220.0, 20.0, 80.0, 100.0, 80.0, 120.0, 100.0, 100.0, 145.0, 179.0, 60.0, 110.0, 40.0, 100.0, 100.0, 70.0, 87.0, 70.0, 98.0, 90.0, 130.0, 43.0, 140.0, 30.0, 140.0, 180.0, 100.0, 106.0, 190.0, 130.0, 110.0, 130.0, 120.0, 46.0, 130.0, 170.0, 96.0, 160.0, 90.0, 40.0, 60.0, 70.0, 110.0, 150.0, 210.0, 30.0, 100.0, 70.0, 90.0, 70.0, 70.0, 100.0, 60.0, 100.0, 70.0, 130.0, 30.0, 0.0, 105.0, 90.0, 150.0, 150.0, 120.0, 150.0, 80.0, 20.0, 100.0, 70.0, 50.0, 140.0, 100.0, 157.0, 160.0, 165.0, 60.0, 140.0, 150.0, 28.0, 130.0, 158.0, 210.0, 50.0, 110.0, 100.0, 150.0, 110.0, 90.0, 80.0, 90.0, 40.0, 130.0, 160.0, 130.0, 130.0, 85.0, 60.0, 130.0, 180.0, 130.0, 100.0, 50.0, 130.0, -34.0, 39.0, 50.0, 110.0, 34.0, 106.0, 57.0, 60.0, 150.0, 140.0, 120.0, 110.0, 140.0, 220.0, 90.0, 40.0, 100.0, 80.0, 109.0, 52.0, 102.0, 130.0, 100.0, 70.0, 140.0, 90.0, 80.0, 90.0, 50.0, 160.0, 110.0, 120.0, 140.0, 60.0, 30.0, 100.0, 40.0, 40.0, 40.0, 90.0, 40.0, 80.0, 90.0, 60.0, 15.0, -10.0, 140.0, 108.0, 90.0, 69.0, 60.0, 80.0, 180.0, 190.0, 70.0, 110.0, 80.0, 245.0, 73.0, 80.0, 110.0, 170.0, 160.0, 50.0, 60.0, 90.0, 130.0, 30.0, 140.0, 110.0, 80.0, 40.0, 150.0, 120.0, 35.0, 80.0, 70.0, 150.0, 20.0, 120.0, 106.0, 129.0, 70.0, 30.0, 90.0, 80.0, 1.0, 50.0, 180.0, 0.0, -18.0, 50.0, 110.0, 50.0, 30.0, 80.0, 80.0, 90.0, 140.0, 90.0, 70.0, 100.0, 200.0, 130.0, 80.0, 210.0, 120.0, 120.0, 80.0, 120.0, 100.0, 120.0, 60.0, 90.0, 130.0, 40.0, 44.0, 90.0, 140.0, 119.0, 40.0, 55.0, 100.0, 60.0, 190.0, 180.0, 130.0, 165.0, 160.0, 90.0, 110.0, 105.0, 50.0, 150.0, 100.0, 110.0, 150.0, 20.0, 130.0, 60.0, 70.0, 100.0, 50.0, 30.0, 90.0, 60.0, 90.0, 190.0, 100.0, 90.0, 97.0, 145.0, 91.0, 136.0, 140.0, 110.0, 120.0, 30.0, 90.0, 70.0, 70.0, 85.0, 110.0, 77.0, 140.0, 64.0, 100.0, 110.0, 230.0, 80.0, 80.0, 160.0, 25.0, 110.0, 63.0, 90.0, 100.0, 150.0, 70.0, 100.0, 80.0, 90.0, 70.0, 170.0, 100.0, 100.0, 91.0, 70.0, 50.0, 70.0, 90.0, 220.0, 36.0, 130.0, 100.0, 70.0, 80.0, 70.0, 60.0, 80.0, 130.0, 39.0, 110.0, 230.0, 70.0, 110.0, 90.0, 79.0, 135.0, 0.0, 65.0, 120.0, 100.0, 110.0, 94.0, 90.0, 40.0, 130.0, 90.0, 30.0, 70.0, 30.0, 150.0, 60.0, 200.0, 30.0, 100.0, 70.0, 150.0, 110.0, 120.0, 23.0, 50.0, 90.0, 62.0, 110.0, 150.0, 14.0, 80.0, 110.0, 53.0, 70.0, 19.0, 160.0, 70.0, 30.0, 80.0, 100.0, 70.0, 130.0, 70.0, 120.0, 50.0, 90.0, 110.0, 100.0, 165.0, 70.0, 150.0, 70.0, 60.0, 49.0, 77.0, 82.0, 190.0, 219.0, 24.0, 130.0, 250.0, 90.0, 160.0, 138.0, 100.0, 50.0, 120.0, 50.0, 90.0, 40.0, 50.0, 140.0, 10.0, 70.0, 9.0, 60.0, 10.0, 40.0, 70.0, 70.0, 110.0, 90.0, 110.0, 90.0, 90.0, 80.0, 120.0, 55.0, 146.0, 150.0, 220.0, 70.0, 70.0, 80.0, 80.0, 11.0, 90.0, 101.0, 70.0, 80.0, 170.0, 150.0, 30.0, 52.0, 50.0, 90.0, 110.0, 65.0, -19.0, 20.0, 69.0, 42.0, 80.0, -1.0, 146.0, 60.0, 27.0, 130.0, 282.0, 80.0, 110.0, 65.0, 116.0, 170.0, 140.0, 16.0, 98.0, 60.0, 140.0, 90.0, 48.0, 30.0, 46.0, 110.0, 120.0, 220.0, 80.0, 150.0, 10.0, 110.0, 90.0, 30.0, 36.0, 19.0, 90.0, 180.0, 20.0, 140.0, 60.0, 100.0, 190.0, 50.0, 130.0, 80.0, 100.0, 90.0, 100.0, 100.0, 50.0, 120.0, 50.0, 80.0, 130.0, 100.0, 60.0, 60.0, 50.0, 100.0, 90.0, 80.0, 23.0, 120.0, 110.0, 30.0, 25.0, 49.0, 170.0, 260.0, 60.0, 68.0, 180.0, 98.0, 160.0, 180.0, 130.0, 110.0, 150.0, 200.0, 170.0, 126.0, 66.0, 100.0, 110.0, 160.0, 30.0, 70.0, 90.0, 200.0, 80.0, 40.0, 70.0, 60.0, 180.0, 50.0, 70.0, 20.0, 80.0, 40.0, 50.0, 120.0, 106.0, 210.0, 160.0, 70.0, 108.0, 70.0, 140.0, 50.0, 60.0, 70.0, 40.0, 120.0, 110.0, 90.0, 40.0, 30.0, 90.0, 100.0, 80.0, 130.0, 65.0, 60.0, 50.0, -22.0, 78.0, 0.0, 30.0, 66.0, 97.0, 140.0, 70.0, 57.0, 22.0, 70.0, 90.0, 74.0, 195.0, 99.0, 30.0, 120.0, 50.0, 80.0, 150.0, 120.0, 100.0, 50.0, 60.0, 80.0, 190.0, 120.0, 340.0, 220.0, 140.0, 60.0, 90.0, 80.0, 90.0, 130.0, 90.0, 100.0, 10.0, 177.0, 80.0, 70.0, 150.0, 100.0, 17.0, 140.0, 45.0, 107.0, 113.0, 120.0, 90.0, 100.0, 100.0, 50.0, 30.0, 170.0, 50.0, 100.0, 310.0, 6.0, 29.0, 11.0, 55.0, 176.0, 5.0, 26.0, 120.0, 50.0, 60.0, 50.0, 70.0, 102.0, 120.0, 40.0, 110.0, 26.0, 50.0, 130.0, 33.0, 106.0, 60.0, 60.0, 150.0, 256.0, 97.0, 170.0, 64.0, 50.0, 110.0, 110.0, 30.0, 110.0, 40.0, 30.0, 50.0, 64.0, 120.0, 40.0, 107.0, 88.0, 118.0, 120.0, 150.0, 33.0, 160.0, 80.0, 31.0, 50.0, 78.0, 16.0, 130.0, 148.0, 23.0, 45.0, 170.0, 130.0, 50.0, 50.0, 80.0, 70.0, 45.0, 90.0, 190.0, 70.0, 100.0, 140.0, 40.0, 110.0, 90.0, 110.0, 130.0, 110.0, 100.0, 95.0, 40.0, 99.0, 130.0, 85.0, 70.0, 150.0, 130.0, 220.0, 110.0, 210.0, 90.0, 50.0, 140.0, 120.0, 100.0, 90.0, 120.0, 70.0, 96.0, 130.0, 160.0, 130.0, 70.0, 100.0, 79.0, 100.0, 60.0, 100.0, 110.0, 100.0, 40.0, 10.0, 118.0, 40.0, 140.0, 210.0, 150.0, 120.0, 110.0, 200.0, 40.0, 90.0, 60.0, 100.0, 130.0, 100.0, 89.0, 0.0, 70.0, 13.0, 70.0, 60.0, 100.0, 98.0, 120.0, 260.0, 90.0, 110.0, 40.0, 108.0, 110.0, 140.0, 100.0, 220.0, 70.0, 96.0, 100.0, 130.0, 140.0, 150.0, 160.0, 117.0, 60.0, 93.0, 46.0, 52.0, 120.0, 90.0, 75.0, 110.0, 100.0, 130.0, 190.0, 112.0, 60.0, -3.0, 30.0, 50.0, 180.0, 91.0, 200.0, 130.0, 80.0, 80.0, 100.0, 160.0, 110.0, 50.0, 120.0, 25.0, 169.0, 140.0, 12.0, 70.0, 50.0, 100.0, 60.0, 100.0, 160.0, 37.0, 190.0, 150.0, 100.0, 31.0, 78.0, 27.0, 90.0, 32.0, 70.0, 200.0, 170.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6273532404200823, "mean_inference_ms": 1.6249840230154455, "mean_action_processing_ms": 0.49904633220892647, "mean_env_wait_ms": 1.1225294559547079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011616706848144531, "StateBufferConnector_ms": 0.008751392364501953, "ViewRequirementAgentConnector_ms": 0.36548614501953125}, "num_episodes": 18, "episode_return_max": 1460.0, "episode_return_min": 485.0, "episode_return_mean": 956.16}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.7384616603989, "num_env_steps_trained_throughput_per_sec": 20.7384616603989, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 5280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5280000, "timers": {"training_iteration_time_ms": 193182.914, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193182.867, "sample_time_ms": 2493.404, "learn_time_ms": 190668.64, "learn_throughput": 20.979, "synch_weights_time_ms": 11.923}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "done": false, "training_iteration": 132, "trial_id": "1841f_00000", "date": "2024-08-08_06-48-49", "timestamp": 1723114129, "time_this_iter_s": 192.889164686203, "time_total_s": 26912.5909614563, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2b1a310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26912.5909614563, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 17.03699633699634, "ram_util_percent": 78.34835164835164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0503673734375463, "cur_kl_coeff": 0.8542968749999998, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.01477621055526274, "vf_loss": 8.448627391130653, "vf_explained_var": -0.014101015702604105, "kl": Infinity, "entropy": 0.5304270146595149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1244175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "env_runners": {"episode_reward_max": 1465.0, "episode_reward_min": 485.0, "episode_reward_mean": 970.89, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -34.0}, "policy_reward_max": {"policy_0": 340.0}, "policy_reward_mean": {"policy_0": 97.089}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1355.0, 1007.0, 1020.0, 961.0, 1057.0, 1282.0, 930.0, 720.0, 1035.0, 1150.0, 1188.0, 1135.0, 715.0, 1127.0, 973.0, 940.0, 485.0, 1097.0, 1118.0, 915.0, 865.0, 533.0, 1190.0, 980.0, 1018.0, 1170.0, 760.0, 1189.0, 856.0, 1048.0, 1030.0, 927.0, 979.0, 883.0, 830.0, 885.0, 756.0, 920.0, 1132.0, 1112.0, 519.0, 885.0, 1018.0, 867.0, 554.0, 1137.0, 1034.0, 725.0, 1000.0, 800.0, 957.0, 1336.0, 1122.0, 690.0, 1084.0, 750.0, 537.0, 914.0, 840.0, 1460.0, 934.0, 925.0, 768.0, 748.0, 1112.0, 658.0, 1016.0, 821.0, 885.0, 924.0, 1245.0, 1156.0, 769.0, 1218.0, 692.0, 1176.0, 1283.0, 876.0, 1040.0, 1034.0, 929.0, 868.0, 1210.0, 850.0, 845.0, 1013.0, 937.0, 1180.0, 922.0, 1047.0, 1090.0, 923.0, 755.0, 1260.0, 780.0, 827.0, 888.0, 1378.0, 1465.0, 1140.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 150.0, 200.0, 180.0, 130.0, 100.0, 160.0, 60.0, 210.0, 55.0, 110.0, 80.0, 132.0, 110.0, 70.0, 150.0, 140.0, 40.0, 90.0, 85.0, 80.0, 120.0, 220.0, 20.0, 80.0, 100.0, 80.0, 120.0, 100.0, 100.0, 145.0, 179.0, 60.0, 110.0, 40.0, 100.0, 100.0, 70.0, 87.0, 70.0, 98.0, 90.0, 130.0, 43.0, 140.0, 30.0, 140.0, 180.0, 100.0, 106.0, 190.0, 130.0, 110.0, 130.0, 120.0, 46.0, 130.0, 170.0, 96.0, 160.0, 90.0, 40.0, 60.0, 70.0, 110.0, 150.0, 210.0, 30.0, 100.0, 70.0, 90.0, 70.0, 70.0, 100.0, 60.0, 100.0, 70.0, 130.0, 30.0, 0.0, 105.0, 90.0, 150.0, 150.0, 120.0, 150.0, 80.0, 20.0, 100.0, 70.0, 50.0, 140.0, 100.0, 157.0, 160.0, 165.0, 60.0, 140.0, 150.0, 28.0, 130.0, 158.0, 210.0, 50.0, 110.0, 100.0, 150.0, 110.0, 90.0, 80.0, 90.0, 40.0, 130.0, 160.0, 130.0, 130.0, 85.0, 60.0, 130.0, 180.0, 130.0, 100.0, 50.0, 130.0, -34.0, 39.0, 50.0, 110.0, 34.0, 106.0, 57.0, 60.0, 150.0, 140.0, 120.0, 110.0, 140.0, 220.0, 90.0, 40.0, 100.0, 80.0, 109.0, 52.0, 102.0, 130.0, 100.0, 70.0, 140.0, 90.0, 80.0, 90.0, 50.0, 160.0, 110.0, 120.0, 140.0, 60.0, 30.0, 100.0, 40.0, 40.0, 40.0, 90.0, 40.0, 80.0, 90.0, 60.0, 15.0, -10.0, 140.0, 108.0, 90.0, 69.0, 60.0, 80.0, 180.0, 190.0, 70.0, 110.0, 80.0, 245.0, 73.0, 80.0, 110.0, 170.0, 160.0, 50.0, 60.0, 90.0, 130.0, 30.0, 140.0, 110.0, 80.0, 40.0, 150.0, 120.0, 35.0, 80.0, 70.0, 150.0, 20.0, 120.0, 106.0, 129.0, 70.0, 30.0, 90.0, 80.0, 1.0, 50.0, 180.0, 0.0, -18.0, 50.0, 110.0, 50.0, 30.0, 80.0, 80.0, 90.0, 140.0, 90.0, 70.0, 100.0, 200.0, 130.0, 80.0, 210.0, 120.0, 120.0, 80.0, 120.0, 100.0, 120.0, 60.0, 90.0, 130.0, 40.0, 44.0, 90.0, 140.0, 119.0, 40.0, 55.0, 100.0, 60.0, 190.0, 180.0, 130.0, 165.0, 160.0, 90.0, 110.0, 105.0, 50.0, 150.0, 100.0, 110.0, 150.0, 20.0, 130.0, 60.0, 70.0, 100.0, 50.0, 30.0, 90.0, 60.0, 90.0, 190.0, 100.0, 90.0, 97.0, 145.0, 91.0, 136.0, 140.0, 110.0, 120.0, 30.0, 90.0, 70.0, 70.0, 85.0, 110.0, 77.0, 140.0, 64.0, 100.0, 110.0, 230.0, 80.0, 80.0, 160.0, 25.0, 110.0, 63.0, 90.0, 100.0, 150.0, 70.0, 100.0, 80.0, 90.0, 70.0, 170.0, 100.0, 100.0, 91.0, 70.0, 50.0, 70.0, 90.0, 220.0, 36.0, 130.0, 100.0, 70.0, 80.0, 70.0, 60.0, 80.0, 130.0, 39.0, 110.0, 230.0, 70.0, 110.0, 90.0, 79.0, 135.0, 0.0, 65.0, 120.0, 100.0, 110.0, 94.0, 90.0, 40.0, 130.0, 90.0, 30.0, 70.0, 30.0, 150.0, 60.0, 200.0, 30.0, 100.0, 70.0, 150.0, 110.0, 120.0, 23.0, 50.0, 90.0, 62.0, 110.0, 150.0, 14.0, 80.0, 110.0, 53.0, 70.0, 19.0, 160.0, 70.0, 30.0, 80.0, 100.0, 70.0, 130.0, 70.0, 120.0, 50.0, 90.0, 110.0, 100.0, 165.0, 70.0, 150.0, 70.0, 60.0, 49.0, 77.0, 82.0, 190.0, 219.0, 24.0, 130.0, 250.0, 90.0, 160.0, 138.0, 100.0, 50.0, 120.0, 50.0, 90.0, 40.0, 50.0, 140.0, 10.0, 70.0, 9.0, 60.0, 10.0, 40.0, 70.0, 70.0, 110.0, 90.0, 110.0, 90.0, 90.0, 80.0, 120.0, 55.0, 146.0, 150.0, 220.0, 70.0, 70.0, 80.0, 80.0, 11.0, 90.0, 101.0, 70.0, 80.0, 170.0, 150.0, 30.0, 52.0, 50.0, 90.0, 110.0, 65.0, -19.0, 20.0, 69.0, 42.0, 80.0, -1.0, 146.0, 60.0, 27.0, 130.0, 282.0, 80.0, 110.0, 65.0, 116.0, 170.0, 140.0, 16.0, 98.0, 60.0, 140.0, 90.0, 48.0, 30.0, 46.0, 110.0, 120.0, 220.0, 80.0, 150.0, 10.0, 110.0, 90.0, 30.0, 36.0, 19.0, 90.0, 180.0, 20.0, 140.0, 60.0, 100.0, 190.0, 50.0, 130.0, 80.0, 100.0, 90.0, 100.0, 100.0, 50.0, 120.0, 50.0, 80.0, 130.0, 100.0, 60.0, 60.0, 50.0, 100.0, 90.0, 80.0, 23.0, 120.0, 110.0, 30.0, 25.0, 49.0, 170.0, 260.0, 60.0, 68.0, 180.0, 98.0, 160.0, 180.0, 130.0, 110.0, 150.0, 200.0, 170.0, 126.0, 66.0, 100.0, 110.0, 160.0, 30.0, 70.0, 90.0, 200.0, 80.0, 40.0, 70.0, 60.0, 180.0, 50.0, 70.0, 20.0, 80.0, 40.0, 50.0, 120.0, 106.0, 210.0, 160.0, 70.0, 108.0, 70.0, 140.0, 50.0, 60.0, 70.0, 40.0, 120.0, 110.0, 90.0, 40.0, 30.0, 90.0, 100.0, 80.0, 130.0, 65.0, 60.0, 50.0, -22.0, 78.0, 0.0, 30.0, 66.0, 97.0, 140.0, 70.0, 57.0, 22.0, 70.0, 90.0, 74.0, 195.0, 99.0, 30.0, 120.0, 50.0, 80.0, 150.0, 120.0, 100.0, 50.0, 60.0, 80.0, 190.0, 120.0, 340.0, 220.0, 140.0, 60.0, 90.0, 80.0, 90.0, 130.0, 90.0, 100.0, 10.0, 177.0, 80.0, 70.0, 150.0, 100.0, 17.0, 140.0, 45.0, 107.0, 113.0, 120.0, 90.0, 100.0, 100.0, 50.0, 30.0, 170.0, 50.0, 100.0, 310.0, 6.0, 29.0, 11.0, 55.0, 176.0, 5.0, 26.0, 120.0, 50.0, 60.0, 50.0, 70.0, 102.0, 120.0, 40.0, 110.0, 26.0, 50.0, 130.0, 33.0, 106.0, 60.0, 60.0, 150.0, 256.0, 97.0, 170.0, 64.0, 50.0, 110.0, 110.0, 30.0, 110.0, 40.0, 30.0, 50.0, 64.0, 120.0, 40.0, 107.0, 88.0, 118.0, 120.0, 150.0, 33.0, 160.0, 80.0, 31.0, 50.0, 78.0, 16.0, 130.0, 148.0, 23.0, 45.0, 170.0, 130.0, 50.0, 50.0, 80.0, 70.0, 45.0, 90.0, 190.0, 70.0, 100.0, 140.0, 40.0, 110.0, 90.0, 110.0, 130.0, 110.0, 100.0, 95.0, 40.0, 99.0, 130.0, 85.0, 70.0, 150.0, 130.0, 220.0, 110.0, 210.0, 90.0, 50.0, 140.0, 120.0, 100.0, 90.0, 120.0, 70.0, 96.0, 130.0, 160.0, 130.0, 70.0, 100.0, 79.0, 100.0, 60.0, 100.0, 110.0, 100.0, 40.0, 10.0, 118.0, 40.0, 140.0, 210.0, 150.0, 120.0, 110.0, 200.0, 40.0, 90.0, 60.0, 100.0, 130.0, 100.0, 89.0, 0.0, 70.0, 13.0, 70.0, 60.0, 100.0, 98.0, 120.0, 260.0, 90.0, 110.0, 40.0, 108.0, 110.0, 140.0, 100.0, 220.0, 70.0, 96.0, 100.0, 130.0, 140.0, 150.0, 160.0, 117.0, 60.0, 93.0, 46.0, 52.0, 120.0, 90.0, 75.0, 110.0, 100.0, 130.0, 190.0, 112.0, 60.0, -3.0, 30.0, 50.0, 180.0, 91.0, 200.0, 130.0, 80.0, 80.0, 100.0, 160.0, 110.0, 50.0, 120.0, 25.0, 169.0, 140.0, 12.0, 70.0, 50.0, 100.0, 60.0, 100.0, 160.0, 37.0, 190.0, 150.0, 100.0, 31.0, 78.0, 27.0, 90.0, 32.0, 70.0, 200.0, 170.0, 70.0, 110.0, 130.0, 180.0, 100.0, 90.0, 110.0, 150.0, 170.0, 90.0, 80.0, 110.0, 60.0, 120.0, 140.0, 40.0, 80.0, 60.0, 70.0, 90.0, 80.0, 20.0, 99.0, 60.0, 80.0, 90.0, 40.0, 100.0, 80.0, 176.0, 100.0, 78.0, 119.0, 70.0, 109.0, 240.0, 15.0, 100.0, 52.0, 70.0, 160.0, 120.0, 100.0, 99.0, 160.0, 98.0, 60.0, 30.0, 100.0, 50.0, 120.0, 120.0, 70.0, 130.0, 110.0, 120.0, 130.0, 160.0, 170.0, 70.0, 100.0, 120.0, 62.0, 60.0, 110.0, 100.0, 100.0, 80.0, 90.0, 120.0, 80.0, 55.0, 180.0, 100.0, 80.0, 140.0, 99.0, 140.0, 68.0, 70.0, 115.0, 40.0, 140.0, 110.0, 130.0, 150.0, 30.0, 180.0, 190.0, 90.0, 30.0, 70.0, 50.0, 150.0, 20.0, 140.0, 120.0, 114.0, 109.0, 90.0, 60.0, 20.0, 138.0, 100.0, 88.0, 2.0, 69.0, 90.0, 60.0, 21.0, 167.0, 100.0, 100.0, 80.0, 150.0, 140.0, 140.0, 210.0, 100.0, 150.0, 90.0, 60.0, 140.0, 80.0, 110.0, 30.0, 110.0, 70.0, 50.0, 20.0, 110.0, 100.0, 90.0, 3.0, 60.0, 80.0, 150.0, 180.0, 34.0, 30.0, 100.0, 70.0, 35.0, 40.0, 80.0, 137.0, 96.0, 60.0, 150.0, 70.0, 150.0, 160.0, 170.0, 121.0, 140.0, 120.0, 140.0, 97.0, 150.0, 130.0, 150.0, 213.0, 160.0, 220.0, 120.0, 210.0, 130.0, 110.0, 80.0, 130.0, 92.0, 120.0, 150.0, 80.0, 150.0, 50.0, 180.0, 20.0, 190.0, 80.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6256575382290976, "mean_inference_ms": 1.6234485539579133, "mean_action_processing_ms": 0.49962252577968996, "mean_env_wait_ms": 1.1217496847702435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012050151824951172, "StateBufferConnector_ms": 0.00904989242553711, "ViewRequirementAgentConnector_ms": 0.3671891689300537}, "num_episodes": 18, "episode_return_max": 1465.0, "episode_return_min": 485.0, "episode_return_mean": 970.89}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.53619851554439, "num_env_steps_trained_throughput_per_sec": 20.53619851554439, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 5320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5320000, "timers": {"training_iteration_time_ms": 193223.331, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193223.285, "sample_time_ms": 2548.275, "learn_time_ms": 190654.217, "learn_throughput": 20.98, "synch_weights_time_ms": 12.008}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "done": false, "training_iteration": 133, "trial_id": "1841f_00000", "date": "2024-08-08_06-52-04", "timestamp": 1723114324, "time_this_iter_s": 194.78788375854492, "time_total_s": 27107.378845214844, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b295cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27107.378845214844, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 18.17709090909091, "ram_util_percent": 77.17127272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3982527422003597, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.012920986264210127, "vf_loss": 8.523718887853166, "vf_explained_var": -0.012299262125271196, "kl": Infinity, "entropy": 0.5187173610551161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1253565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "env_runners": {"episode_reward_max": 1465.0, "episode_reward_min": 519.0, "episode_reward_mean": 968.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -22.0}, "policy_reward_max": {"policy_0": 340.0}, "policy_reward_mean": {"policy_0": 96.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [980.0, 1018.0, 1170.0, 760.0, 1189.0, 856.0, 1048.0, 1030.0, 927.0, 979.0, 883.0, 830.0, 885.0, 756.0, 920.0, 1132.0, 1112.0, 519.0, 885.0, 1018.0, 867.0, 554.0, 1137.0, 1034.0, 725.0, 1000.0, 800.0, 957.0, 1336.0, 1122.0, 690.0, 1084.0, 750.0, 537.0, 914.0, 840.0, 1460.0, 934.0, 925.0, 768.0, 748.0, 1112.0, 658.0, 1016.0, 821.0, 885.0, 924.0, 1245.0, 1156.0, 769.0, 1218.0, 692.0, 1176.0, 1283.0, 876.0, 1040.0, 1034.0, 929.0, 868.0, 1210.0, 850.0, 845.0, 1013.0, 937.0, 1180.0, 922.0, 1047.0, 1090.0, 923.0, 755.0, 1260.0, 780.0, 827.0, 888.0, 1378.0, 1465.0, 1140.0, 874.0, 1120.0, 865.0, 1086.0, 1203.0, 935.0, 1199.0, 859.0, 1087.0, 1310.0, 883.0, 1122.0, 699.0, 946.0, 890.0, 644.0, 893.0, 1115.0, 853.0, 1046.0, 829.0, 927.0, 1149.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 120.0, 80.0, 120.0, 100.0, 120.0, 60.0, 90.0, 130.0, 40.0, 44.0, 90.0, 140.0, 119.0, 40.0, 55.0, 100.0, 60.0, 190.0, 180.0, 130.0, 165.0, 160.0, 90.0, 110.0, 105.0, 50.0, 150.0, 100.0, 110.0, 150.0, 20.0, 130.0, 60.0, 70.0, 100.0, 50.0, 30.0, 90.0, 60.0, 90.0, 190.0, 100.0, 90.0, 97.0, 145.0, 91.0, 136.0, 140.0, 110.0, 120.0, 30.0, 90.0, 70.0, 70.0, 85.0, 110.0, 77.0, 140.0, 64.0, 100.0, 110.0, 230.0, 80.0, 80.0, 160.0, 25.0, 110.0, 63.0, 90.0, 100.0, 150.0, 70.0, 100.0, 80.0, 90.0, 70.0, 170.0, 100.0, 100.0, 91.0, 70.0, 50.0, 70.0, 90.0, 220.0, 36.0, 130.0, 100.0, 70.0, 80.0, 70.0, 60.0, 80.0, 130.0, 39.0, 110.0, 230.0, 70.0, 110.0, 90.0, 79.0, 135.0, 0.0, 65.0, 120.0, 100.0, 110.0, 94.0, 90.0, 40.0, 130.0, 90.0, 30.0, 70.0, 30.0, 150.0, 60.0, 200.0, 30.0, 100.0, 70.0, 150.0, 110.0, 120.0, 23.0, 50.0, 90.0, 62.0, 110.0, 150.0, 14.0, 80.0, 110.0, 53.0, 70.0, 19.0, 160.0, 70.0, 30.0, 80.0, 100.0, 70.0, 130.0, 70.0, 120.0, 50.0, 90.0, 110.0, 100.0, 165.0, 70.0, 150.0, 70.0, 60.0, 49.0, 77.0, 82.0, 190.0, 219.0, 24.0, 130.0, 250.0, 90.0, 160.0, 138.0, 100.0, 50.0, 120.0, 50.0, 90.0, 40.0, 50.0, 140.0, 10.0, 70.0, 9.0, 60.0, 10.0, 40.0, 70.0, 70.0, 110.0, 90.0, 110.0, 90.0, 90.0, 80.0, 120.0, 55.0, 146.0, 150.0, 220.0, 70.0, 70.0, 80.0, 80.0, 11.0, 90.0, 101.0, 70.0, 80.0, 170.0, 150.0, 30.0, 52.0, 50.0, 90.0, 110.0, 65.0, -19.0, 20.0, 69.0, 42.0, 80.0, -1.0, 146.0, 60.0, 27.0, 130.0, 282.0, 80.0, 110.0, 65.0, 116.0, 170.0, 140.0, 16.0, 98.0, 60.0, 140.0, 90.0, 48.0, 30.0, 46.0, 110.0, 120.0, 220.0, 80.0, 150.0, 10.0, 110.0, 90.0, 30.0, 36.0, 19.0, 90.0, 180.0, 20.0, 140.0, 60.0, 100.0, 190.0, 50.0, 130.0, 80.0, 100.0, 90.0, 100.0, 100.0, 50.0, 120.0, 50.0, 80.0, 130.0, 100.0, 60.0, 60.0, 50.0, 100.0, 90.0, 80.0, 23.0, 120.0, 110.0, 30.0, 25.0, 49.0, 170.0, 260.0, 60.0, 68.0, 180.0, 98.0, 160.0, 180.0, 130.0, 110.0, 150.0, 200.0, 170.0, 126.0, 66.0, 100.0, 110.0, 160.0, 30.0, 70.0, 90.0, 200.0, 80.0, 40.0, 70.0, 60.0, 180.0, 50.0, 70.0, 20.0, 80.0, 40.0, 50.0, 120.0, 106.0, 210.0, 160.0, 70.0, 108.0, 70.0, 140.0, 50.0, 60.0, 70.0, 40.0, 120.0, 110.0, 90.0, 40.0, 30.0, 90.0, 100.0, 80.0, 130.0, 65.0, 60.0, 50.0, -22.0, 78.0, 0.0, 30.0, 66.0, 97.0, 140.0, 70.0, 57.0, 22.0, 70.0, 90.0, 74.0, 195.0, 99.0, 30.0, 120.0, 50.0, 80.0, 150.0, 120.0, 100.0, 50.0, 60.0, 80.0, 190.0, 120.0, 340.0, 220.0, 140.0, 60.0, 90.0, 80.0, 90.0, 130.0, 90.0, 100.0, 10.0, 177.0, 80.0, 70.0, 150.0, 100.0, 17.0, 140.0, 45.0, 107.0, 113.0, 120.0, 90.0, 100.0, 100.0, 50.0, 30.0, 170.0, 50.0, 100.0, 310.0, 6.0, 29.0, 11.0, 55.0, 176.0, 5.0, 26.0, 120.0, 50.0, 60.0, 50.0, 70.0, 102.0, 120.0, 40.0, 110.0, 26.0, 50.0, 130.0, 33.0, 106.0, 60.0, 60.0, 150.0, 256.0, 97.0, 170.0, 64.0, 50.0, 110.0, 110.0, 30.0, 110.0, 40.0, 30.0, 50.0, 64.0, 120.0, 40.0, 107.0, 88.0, 118.0, 120.0, 150.0, 33.0, 160.0, 80.0, 31.0, 50.0, 78.0, 16.0, 130.0, 148.0, 23.0, 45.0, 170.0, 130.0, 50.0, 50.0, 80.0, 70.0, 45.0, 90.0, 190.0, 70.0, 100.0, 140.0, 40.0, 110.0, 90.0, 110.0, 130.0, 110.0, 100.0, 95.0, 40.0, 99.0, 130.0, 85.0, 70.0, 150.0, 130.0, 220.0, 110.0, 210.0, 90.0, 50.0, 140.0, 120.0, 100.0, 90.0, 120.0, 70.0, 96.0, 130.0, 160.0, 130.0, 70.0, 100.0, 79.0, 100.0, 60.0, 100.0, 110.0, 100.0, 40.0, 10.0, 118.0, 40.0, 140.0, 210.0, 150.0, 120.0, 110.0, 200.0, 40.0, 90.0, 60.0, 100.0, 130.0, 100.0, 89.0, 0.0, 70.0, 13.0, 70.0, 60.0, 100.0, 98.0, 120.0, 260.0, 90.0, 110.0, 40.0, 108.0, 110.0, 140.0, 100.0, 220.0, 70.0, 96.0, 100.0, 130.0, 140.0, 150.0, 160.0, 117.0, 60.0, 93.0, 46.0, 52.0, 120.0, 90.0, 75.0, 110.0, 100.0, 130.0, 190.0, 112.0, 60.0, -3.0, 30.0, 50.0, 180.0, 91.0, 200.0, 130.0, 80.0, 80.0, 100.0, 160.0, 110.0, 50.0, 120.0, 25.0, 169.0, 140.0, 12.0, 70.0, 50.0, 100.0, 60.0, 100.0, 160.0, 37.0, 190.0, 150.0, 100.0, 31.0, 78.0, 27.0, 90.0, 32.0, 70.0, 200.0, 170.0, 70.0, 110.0, 130.0, 180.0, 100.0, 90.0, 110.0, 150.0, 170.0, 90.0, 80.0, 110.0, 60.0, 120.0, 140.0, 40.0, 80.0, 60.0, 70.0, 90.0, 80.0, 20.0, 99.0, 60.0, 80.0, 90.0, 40.0, 100.0, 80.0, 176.0, 100.0, 78.0, 119.0, 70.0, 109.0, 240.0, 15.0, 100.0, 52.0, 70.0, 160.0, 120.0, 100.0, 99.0, 160.0, 98.0, 60.0, 30.0, 100.0, 50.0, 120.0, 120.0, 70.0, 130.0, 110.0, 120.0, 130.0, 160.0, 170.0, 70.0, 100.0, 120.0, 62.0, 60.0, 110.0, 100.0, 100.0, 80.0, 90.0, 120.0, 80.0, 55.0, 180.0, 100.0, 80.0, 140.0, 99.0, 140.0, 68.0, 70.0, 115.0, 40.0, 140.0, 110.0, 130.0, 150.0, 30.0, 180.0, 190.0, 90.0, 30.0, 70.0, 50.0, 150.0, 20.0, 140.0, 120.0, 114.0, 109.0, 90.0, 60.0, 20.0, 138.0, 100.0, 88.0, 2.0, 69.0, 90.0, 60.0, 21.0, 167.0, 100.0, 100.0, 80.0, 150.0, 140.0, 140.0, 210.0, 100.0, 150.0, 90.0, 60.0, 140.0, 80.0, 110.0, 30.0, 110.0, 70.0, 50.0, 20.0, 110.0, 100.0, 90.0, 3.0, 60.0, 80.0, 150.0, 180.0, 34.0, 30.0, 100.0, 70.0, 35.0, 40.0, 80.0, 137.0, 96.0, 60.0, 150.0, 70.0, 150.0, 160.0, 170.0, 121.0, 140.0, 120.0, 140.0, 97.0, 150.0, 130.0, 150.0, 213.0, 160.0, 220.0, 120.0, 210.0, 130.0, 110.0, 80.0, 130.0, 92.0, 120.0, 150.0, 80.0, 150.0, 50.0, 180.0, 20.0, 190.0, 80.0, 120.0, 30.0, 70.0, 230.0, 60.0, 63.0, 71.0, 90.0, 130.0, 70.0, 60.0, 90.0, 150.0, 80.0, 120.0, 120.0, 170.0, 110.0, 100.0, 60.0, 120.0, 110.0, 110.0, 50.0, 70.0, 110.0, 25.0, 140.0, 30.0, 100.0, 120.0, 140.0, 80.0, 225.0, 93.0, 110.0, 100.0, 73.0, 90.0, 5.0, 170.0, 90.0, 110.0, 290.0, 159.0, 100.0, 140.0, 120.0, 40.0, 129.0, 25.0, 160.0, 130.0, 60.0, 180.0, 103.0, 12.0, 90.0, 60.0, 20.0, 120.0, 110.0, 80.0, 60.0, 210.0, 110.0, 130.0, 90.0, 190.0, 59.0, 160.0, 21.0, 80.0, 50.0, 59.0, 100.0, 99.0, 230.0, 150.0, 0.0, 70.0, 80.0, 90.0, 83.0, 100.0, 85.0, 70.0, 270.0, 79.0, 120.0, 110.0, 150.0, 190.0, 200.0, 140.0, 150.0, 60.0, 140.0, 80.0, 110.0, 90.0, 150.0, 210.0, 40.0, 89.0, 25.0, 19.0, 40.0, 100.0, 140.0, 70.0, 75.0, 12.0, 180.0, 90.0, 120.0, 118.0, 168.0, 149.0, 90.0, 120.0, 40.0, 160.0, 24.0, 68.0, 90.0, 80.0, 80.0, 40.0, 17.0, 100.0, 70.0, 40.0, 80.0, 80.0, 60.0, 140.0, 79.0, 110.0, 80.0, 207.0, 80.0, 40.0, 70.0, 270.0, 70.0, 120.0, 40.0, 50.0, 40.0, 110.0, 20.0, 16.0, 97.0, 110.0, 115.0, 90.0, 70.0, 20.0, 86.0, 20.0, 56.0, 97.0, 60.0, 90.0, 60.0, 100.0, 70.0, 120.0, 50.0, 190.0, 57.0, 55.0, 80.0, 60.0, 124.0, 70.0, 160.0, 190.0, 189.0, 130.0, 50.0, 50.0, 78.0, 80.0, 60.0, 110.0, 48.0, 180.0, 87.0, 110.0, 140.0, 110.0, 160.0, 90.0, 60.0, 60.0, 70.0, 100.0, 126.0, 130.0, 78.0, 80.0, 130.0, 130.0, 90.0, 70.0, 80.0, 100.0, 41.0, 30.0, 136.0, 28.0, 59.0, 90.0, 40.0, 129.0, 80.0, 110.0, 105.0, 150.0, 130.0, 90.0, 110.0, 50.0, 160.0, 180.0, 59.0, 110.0, 70.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6233141038905827, "mean_inference_ms": 1.6224325903234713, "mean_action_processing_ms": 0.5001059611412412, "mean_env_wait_ms": 1.1221569503861426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012130975723266602, "StateBufferConnector_ms": 0.009168863296508789, "ViewRequirementAgentConnector_ms": 0.3802452087402344}, "num_episodes": 23, "episode_return_max": 1465.0, "episode_return_min": 519.0, "episode_return_mean": 968.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.701118752307554, "num_env_steps_trained_throughput_per_sec": 20.701118752307554, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 5360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5360000, "timers": {"training_iteration_time_ms": 193137.9, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193137.854, "sample_time_ms": 2539.518, "learn_time_ms": 190577.656, "learn_throughput": 20.989, "synch_weights_time_ms": 12.037}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "done": false, "training_iteration": 134, "trial_id": "1841f_00000", "date": "2024-08-08_06-55-17", "timestamp": 1723114517, "time_this_iter_s": 193.23663687705994, "time_total_s": 27300.615482091904, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b56b2f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27300.615482091904, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 17.779562043795618, "ram_util_percent": 77.29379562043796}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6839583038648986, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.375035825806558, "policy_loss": -0.011886105197060286, "vf_loss": 8.382773425860908, "vf_explained_var": -0.02825034045563719, "kl": 0.0021582381854517957, "entropy": 0.5453185175205318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1262955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "env_runners": {"episode_reward_max": 1465.0, "episode_reward_min": 537.0, "episode_reward_mean": 968.22, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 340.0}, "policy_reward_mean": {"policy_0": 96.822}, "custom_metrics": {}, "hist_stats": {"episode_reward": [885.0, 1018.0, 867.0, 554.0, 1137.0, 1034.0, 725.0, 1000.0, 800.0, 957.0, 1336.0, 1122.0, 690.0, 1084.0, 750.0, 537.0, 914.0, 840.0, 1460.0, 934.0, 925.0, 768.0, 748.0, 1112.0, 658.0, 1016.0, 821.0, 885.0, 924.0, 1245.0, 1156.0, 769.0, 1218.0, 692.0, 1176.0, 1283.0, 876.0, 1040.0, 1034.0, 929.0, 868.0, 1210.0, 850.0, 845.0, 1013.0, 937.0, 1180.0, 922.0, 1047.0, 1090.0, 923.0, 755.0, 1260.0, 780.0, 827.0, 888.0, 1378.0, 1465.0, 1140.0, 874.0, 1120.0, 865.0, 1086.0, 1203.0, 935.0, 1199.0, 859.0, 1087.0, 1310.0, 883.0, 1122.0, 699.0, 946.0, 890.0, 644.0, 893.0, 1115.0, 853.0, 1046.0, 829.0, 927.0, 1149.0, 980.0, 804.0, 1028.0, 1051.0, 930.0, 632.0, 630.0, 1230.0, 940.0, 1270.0, 795.0, 838.0, 601.0, 1047.0, 979.0, 1000.0, 1019.0, 1217.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 70.0, 110.0, 90.0, 110.0, 90.0, 90.0, 80.0, 120.0, 55.0, 146.0, 150.0, 220.0, 70.0, 70.0, 80.0, 80.0, 11.0, 90.0, 101.0, 70.0, 80.0, 170.0, 150.0, 30.0, 52.0, 50.0, 90.0, 110.0, 65.0, -19.0, 20.0, 69.0, 42.0, 80.0, -1.0, 146.0, 60.0, 27.0, 130.0, 282.0, 80.0, 110.0, 65.0, 116.0, 170.0, 140.0, 16.0, 98.0, 60.0, 140.0, 90.0, 48.0, 30.0, 46.0, 110.0, 120.0, 220.0, 80.0, 150.0, 10.0, 110.0, 90.0, 30.0, 36.0, 19.0, 90.0, 180.0, 20.0, 140.0, 60.0, 100.0, 190.0, 50.0, 130.0, 80.0, 100.0, 90.0, 100.0, 100.0, 50.0, 120.0, 50.0, 80.0, 130.0, 100.0, 60.0, 60.0, 50.0, 100.0, 90.0, 80.0, 23.0, 120.0, 110.0, 30.0, 25.0, 49.0, 170.0, 260.0, 60.0, 68.0, 180.0, 98.0, 160.0, 180.0, 130.0, 110.0, 150.0, 200.0, 170.0, 126.0, 66.0, 100.0, 110.0, 160.0, 30.0, 70.0, 90.0, 200.0, 80.0, 40.0, 70.0, 60.0, 180.0, 50.0, 70.0, 20.0, 80.0, 40.0, 50.0, 120.0, 106.0, 210.0, 160.0, 70.0, 108.0, 70.0, 140.0, 50.0, 60.0, 70.0, 40.0, 120.0, 110.0, 90.0, 40.0, 30.0, 90.0, 100.0, 80.0, 130.0, 65.0, 60.0, 50.0, -22.0, 78.0, 0.0, 30.0, 66.0, 97.0, 140.0, 70.0, 57.0, 22.0, 70.0, 90.0, 74.0, 195.0, 99.0, 30.0, 120.0, 50.0, 80.0, 150.0, 120.0, 100.0, 50.0, 60.0, 80.0, 190.0, 120.0, 340.0, 220.0, 140.0, 60.0, 90.0, 80.0, 90.0, 130.0, 90.0, 100.0, 10.0, 177.0, 80.0, 70.0, 150.0, 100.0, 17.0, 140.0, 45.0, 107.0, 113.0, 120.0, 90.0, 100.0, 100.0, 50.0, 30.0, 170.0, 50.0, 100.0, 310.0, 6.0, 29.0, 11.0, 55.0, 176.0, 5.0, 26.0, 120.0, 50.0, 60.0, 50.0, 70.0, 102.0, 120.0, 40.0, 110.0, 26.0, 50.0, 130.0, 33.0, 106.0, 60.0, 60.0, 150.0, 256.0, 97.0, 170.0, 64.0, 50.0, 110.0, 110.0, 30.0, 110.0, 40.0, 30.0, 50.0, 64.0, 120.0, 40.0, 107.0, 88.0, 118.0, 120.0, 150.0, 33.0, 160.0, 80.0, 31.0, 50.0, 78.0, 16.0, 130.0, 148.0, 23.0, 45.0, 170.0, 130.0, 50.0, 50.0, 80.0, 70.0, 45.0, 90.0, 190.0, 70.0, 100.0, 140.0, 40.0, 110.0, 90.0, 110.0, 130.0, 110.0, 100.0, 95.0, 40.0, 99.0, 130.0, 85.0, 70.0, 150.0, 130.0, 220.0, 110.0, 210.0, 90.0, 50.0, 140.0, 120.0, 100.0, 90.0, 120.0, 70.0, 96.0, 130.0, 160.0, 130.0, 70.0, 100.0, 79.0, 100.0, 60.0, 100.0, 110.0, 100.0, 40.0, 10.0, 118.0, 40.0, 140.0, 210.0, 150.0, 120.0, 110.0, 200.0, 40.0, 90.0, 60.0, 100.0, 130.0, 100.0, 89.0, 0.0, 70.0, 13.0, 70.0, 60.0, 100.0, 98.0, 120.0, 260.0, 90.0, 110.0, 40.0, 108.0, 110.0, 140.0, 100.0, 220.0, 70.0, 96.0, 100.0, 130.0, 140.0, 150.0, 160.0, 117.0, 60.0, 93.0, 46.0, 52.0, 120.0, 90.0, 75.0, 110.0, 100.0, 130.0, 190.0, 112.0, 60.0, -3.0, 30.0, 50.0, 180.0, 91.0, 200.0, 130.0, 80.0, 80.0, 100.0, 160.0, 110.0, 50.0, 120.0, 25.0, 169.0, 140.0, 12.0, 70.0, 50.0, 100.0, 60.0, 100.0, 160.0, 37.0, 190.0, 150.0, 100.0, 31.0, 78.0, 27.0, 90.0, 32.0, 70.0, 200.0, 170.0, 70.0, 110.0, 130.0, 180.0, 100.0, 90.0, 110.0, 150.0, 170.0, 90.0, 80.0, 110.0, 60.0, 120.0, 140.0, 40.0, 80.0, 60.0, 70.0, 90.0, 80.0, 20.0, 99.0, 60.0, 80.0, 90.0, 40.0, 100.0, 80.0, 176.0, 100.0, 78.0, 119.0, 70.0, 109.0, 240.0, 15.0, 100.0, 52.0, 70.0, 160.0, 120.0, 100.0, 99.0, 160.0, 98.0, 60.0, 30.0, 100.0, 50.0, 120.0, 120.0, 70.0, 130.0, 110.0, 120.0, 130.0, 160.0, 170.0, 70.0, 100.0, 120.0, 62.0, 60.0, 110.0, 100.0, 100.0, 80.0, 90.0, 120.0, 80.0, 55.0, 180.0, 100.0, 80.0, 140.0, 99.0, 140.0, 68.0, 70.0, 115.0, 40.0, 140.0, 110.0, 130.0, 150.0, 30.0, 180.0, 190.0, 90.0, 30.0, 70.0, 50.0, 150.0, 20.0, 140.0, 120.0, 114.0, 109.0, 90.0, 60.0, 20.0, 138.0, 100.0, 88.0, 2.0, 69.0, 90.0, 60.0, 21.0, 167.0, 100.0, 100.0, 80.0, 150.0, 140.0, 140.0, 210.0, 100.0, 150.0, 90.0, 60.0, 140.0, 80.0, 110.0, 30.0, 110.0, 70.0, 50.0, 20.0, 110.0, 100.0, 90.0, 3.0, 60.0, 80.0, 150.0, 180.0, 34.0, 30.0, 100.0, 70.0, 35.0, 40.0, 80.0, 137.0, 96.0, 60.0, 150.0, 70.0, 150.0, 160.0, 170.0, 121.0, 140.0, 120.0, 140.0, 97.0, 150.0, 130.0, 150.0, 213.0, 160.0, 220.0, 120.0, 210.0, 130.0, 110.0, 80.0, 130.0, 92.0, 120.0, 150.0, 80.0, 150.0, 50.0, 180.0, 20.0, 190.0, 80.0, 120.0, 30.0, 70.0, 230.0, 60.0, 63.0, 71.0, 90.0, 130.0, 70.0, 60.0, 90.0, 150.0, 80.0, 120.0, 120.0, 170.0, 110.0, 100.0, 60.0, 120.0, 110.0, 110.0, 50.0, 70.0, 110.0, 25.0, 140.0, 30.0, 100.0, 120.0, 140.0, 80.0, 225.0, 93.0, 110.0, 100.0, 73.0, 90.0, 5.0, 170.0, 90.0, 110.0, 290.0, 159.0, 100.0, 140.0, 120.0, 40.0, 129.0, 25.0, 160.0, 130.0, 60.0, 180.0, 103.0, 12.0, 90.0, 60.0, 20.0, 120.0, 110.0, 80.0, 60.0, 210.0, 110.0, 130.0, 90.0, 190.0, 59.0, 160.0, 21.0, 80.0, 50.0, 59.0, 100.0, 99.0, 230.0, 150.0, 0.0, 70.0, 80.0, 90.0, 83.0, 100.0, 85.0, 70.0, 270.0, 79.0, 120.0, 110.0, 150.0, 190.0, 200.0, 140.0, 150.0, 60.0, 140.0, 80.0, 110.0, 90.0, 150.0, 210.0, 40.0, 89.0, 25.0, 19.0, 40.0, 100.0, 140.0, 70.0, 75.0, 12.0, 180.0, 90.0, 120.0, 118.0, 168.0, 149.0, 90.0, 120.0, 40.0, 160.0, 24.0, 68.0, 90.0, 80.0, 80.0, 40.0, 17.0, 100.0, 70.0, 40.0, 80.0, 80.0, 60.0, 140.0, 79.0, 110.0, 80.0, 207.0, 80.0, 40.0, 70.0, 270.0, 70.0, 120.0, 40.0, 50.0, 40.0, 110.0, 20.0, 16.0, 97.0, 110.0, 115.0, 90.0, 70.0, 20.0, 86.0, 20.0, 56.0, 97.0, 60.0, 90.0, 60.0, 100.0, 70.0, 120.0, 50.0, 190.0, 57.0, 55.0, 80.0, 60.0, 124.0, 70.0, 160.0, 190.0, 189.0, 130.0, 50.0, 50.0, 78.0, 80.0, 60.0, 110.0, 48.0, 180.0, 87.0, 110.0, 140.0, 110.0, 160.0, 90.0, 60.0, 60.0, 70.0, 100.0, 126.0, 130.0, 78.0, 80.0, 130.0, 130.0, 90.0, 70.0, 80.0, 100.0, 41.0, 30.0, 136.0, 28.0, 59.0, 90.0, 40.0, 129.0, 80.0, 110.0, 105.0, 150.0, 130.0, 90.0, 110.0, 50.0, 160.0, 180.0, 59.0, 110.0, 70.0, 190.0, 110.0, 70.0, 110.0, 110.0, 100.0, 100.0, 140.0, 80.0, 70.0, 90.0, 90.0, 50.0, 60.0, 130.0, 120.0, 69.0, 8.0, 47.0, 150.0, 80.0, 120.0, 110.0, 50.0, 170.0, 40.0, 88.0, 70.0, 130.0, 160.0, 90.0, 41.0, 170.0, 80.0, 49.0, 90.0, 228.0, 113.0, 170.0, 30.0, 80.0, 50.0, 40.0, 50.0, 210.0, 40.0, 90.0, 70.0, 120.0, 140.0, 120.0, 90.0, 48.0, 80.0, 80.0, 50.0, 22.0, 120.0, 73.0, 49.0, 20.0, 110.0, -40.0, 50.0, 80.0, -80.0, 0.0, 150.0, 70.0, 150.0, 140.0, 160.0, 150.0, 110.0, 90.0, 80.0, 60.0, 80.0, 160.0, 190.0, 150.0, 119.0, 100.0, 80.0, 90.0, 41.0, 50.0, 130.0, 50.0, 210.0, 70.0, 140.0, 170.0, 180.0, 110.0, 70.0, 180.0, 110.0, 40.0, 150.0, 120.0, 70.0, 80.0, 120.0, 110.0, 51.0, -6.0, 160.0, 10.0, 90.0, 110.0, 100.0, 120.0, 60.0, 109.0, 20.0, 40.0, 110.0, 89.0, 80.0, 110.0, 130.0, 20.0, 68.0, 50.0, 30.0, 200.0, 50.0, 36.0, 0.0, 17.0, 140.0, 99.0, 80.0, 90.0, 50.0, 80.0, 67.0, 150.0, 220.0, 71.0, 80.0, 90.0, 90.0, 90.0, 50.0, 49.0, 190.0, 140.0, 90.0, 110.0, 47.0, 18.0, 70.0, 120.0, 130.0, 150.0, 65.0, 140.0, 140.0, 120.0, 180.0, 70.0, 30.0, 140.0, 70.0, 110.0, 130.0, 130.0, 70.0, 89.0, 140.0, 80.0, 130.0, 234.0, 100.0, 120.0, 160.0, 53.0, 90.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.621874535484476, "mean_inference_ms": 1.6196361668012103, "mean_action_processing_ms": 0.5009282279234902, "mean_env_wait_ms": 1.120046440318996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011479616165161133, "StateBufferConnector_ms": 0.013172388076782227, "ViewRequirementAgentConnector_ms": 0.37188291549682617}, "num_episodes": 18, "episode_return_max": 1465.0, "episode_return_min": 537.0, "episode_return_mean": 968.22}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.725740720709535, "num_env_steps_trained_throughput_per_sec": 20.725740720709535, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 5400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5400000, "timers": {"training_iteration_time_ms": 193163.181, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193163.135, "sample_time_ms": 2521.377, "learn_time_ms": 190621.197, "learn_throughput": 20.984, "synch_weights_time_ms": 12.018}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "done": false, "training_iteration": 135, "trial_id": "1841f_00000", "date": "2024-08-08_06-58-30", "timestamp": 1723114710, "time_this_iter_s": 193.00733518600464, "time_total_s": 27493.62281727791, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2450040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27493.62281727791, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 16.953113553113553, "ram_util_percent": 76.93040293040293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.390614867718202, "cur_kl_coeff": 0.9610839843749998, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.01359679558201811, "vf_loss": 8.390230488853332, "vf_explained_var": -0.015224021800155965, "kl": Infinity, "entropy": 0.5591541225536943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1272345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "env_runners": {"episode_reward_max": 1490.0, "episode_reward_min": 261.0, "episode_reward_mean": 982.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 290.0}, "policy_reward_mean": {"policy_0": 98.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [748.0, 1112.0, 658.0, 1016.0, 821.0, 885.0, 924.0, 1245.0, 1156.0, 769.0, 1218.0, 692.0, 1176.0, 1283.0, 876.0, 1040.0, 1034.0, 929.0, 868.0, 1210.0, 850.0, 845.0, 1013.0, 937.0, 1180.0, 922.0, 1047.0, 1090.0, 923.0, 755.0, 1260.0, 780.0, 827.0, 888.0, 1378.0, 1465.0, 1140.0, 874.0, 1120.0, 865.0, 1086.0, 1203.0, 935.0, 1199.0, 859.0, 1087.0, 1310.0, 883.0, 1122.0, 699.0, 946.0, 890.0, 644.0, 893.0, 1115.0, 853.0, 1046.0, 829.0, 927.0, 1149.0, 980.0, 804.0, 1028.0, 1051.0, 930.0, 632.0, 630.0, 1230.0, 940.0, 1270.0, 795.0, 838.0, 601.0, 1047.0, 979.0, 1000.0, 1019.0, 1217.0, 948.0, 880.0, 1199.0, 739.0, 836.0, 1079.0, 773.0, 1120.0, 975.0, 838.0, 261.0, 954.0, 1490.0, 706.0, 1110.0, 1260.0, 948.0, 1292.0, 905.0, 1075.0, 1089.0, 1303.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 50.0, 60.0, 50.0, 70.0, 102.0, 120.0, 40.0, 110.0, 26.0, 50.0, 130.0, 33.0, 106.0, 60.0, 60.0, 150.0, 256.0, 97.0, 170.0, 64.0, 50.0, 110.0, 110.0, 30.0, 110.0, 40.0, 30.0, 50.0, 64.0, 120.0, 40.0, 107.0, 88.0, 118.0, 120.0, 150.0, 33.0, 160.0, 80.0, 31.0, 50.0, 78.0, 16.0, 130.0, 148.0, 23.0, 45.0, 170.0, 130.0, 50.0, 50.0, 80.0, 70.0, 45.0, 90.0, 190.0, 70.0, 100.0, 140.0, 40.0, 110.0, 90.0, 110.0, 130.0, 110.0, 100.0, 95.0, 40.0, 99.0, 130.0, 85.0, 70.0, 150.0, 130.0, 220.0, 110.0, 210.0, 90.0, 50.0, 140.0, 120.0, 100.0, 90.0, 120.0, 70.0, 96.0, 130.0, 160.0, 130.0, 70.0, 100.0, 79.0, 100.0, 60.0, 100.0, 110.0, 100.0, 40.0, 10.0, 118.0, 40.0, 140.0, 210.0, 150.0, 120.0, 110.0, 200.0, 40.0, 90.0, 60.0, 100.0, 130.0, 100.0, 89.0, 0.0, 70.0, 13.0, 70.0, 60.0, 100.0, 98.0, 120.0, 260.0, 90.0, 110.0, 40.0, 108.0, 110.0, 140.0, 100.0, 220.0, 70.0, 96.0, 100.0, 130.0, 140.0, 150.0, 160.0, 117.0, 60.0, 93.0, 46.0, 52.0, 120.0, 90.0, 75.0, 110.0, 100.0, 130.0, 190.0, 112.0, 60.0, -3.0, 30.0, 50.0, 180.0, 91.0, 200.0, 130.0, 80.0, 80.0, 100.0, 160.0, 110.0, 50.0, 120.0, 25.0, 169.0, 140.0, 12.0, 70.0, 50.0, 100.0, 60.0, 100.0, 160.0, 37.0, 190.0, 150.0, 100.0, 31.0, 78.0, 27.0, 90.0, 32.0, 70.0, 200.0, 170.0, 70.0, 110.0, 130.0, 180.0, 100.0, 90.0, 110.0, 150.0, 170.0, 90.0, 80.0, 110.0, 60.0, 120.0, 140.0, 40.0, 80.0, 60.0, 70.0, 90.0, 80.0, 20.0, 99.0, 60.0, 80.0, 90.0, 40.0, 100.0, 80.0, 176.0, 100.0, 78.0, 119.0, 70.0, 109.0, 240.0, 15.0, 100.0, 52.0, 70.0, 160.0, 120.0, 100.0, 99.0, 160.0, 98.0, 60.0, 30.0, 100.0, 50.0, 120.0, 120.0, 70.0, 130.0, 110.0, 120.0, 130.0, 160.0, 170.0, 70.0, 100.0, 120.0, 62.0, 60.0, 110.0, 100.0, 100.0, 80.0, 90.0, 120.0, 80.0, 55.0, 180.0, 100.0, 80.0, 140.0, 99.0, 140.0, 68.0, 70.0, 115.0, 40.0, 140.0, 110.0, 130.0, 150.0, 30.0, 180.0, 190.0, 90.0, 30.0, 70.0, 50.0, 150.0, 20.0, 140.0, 120.0, 114.0, 109.0, 90.0, 60.0, 20.0, 138.0, 100.0, 88.0, 2.0, 69.0, 90.0, 60.0, 21.0, 167.0, 100.0, 100.0, 80.0, 150.0, 140.0, 140.0, 210.0, 100.0, 150.0, 90.0, 60.0, 140.0, 80.0, 110.0, 30.0, 110.0, 70.0, 50.0, 20.0, 110.0, 100.0, 90.0, 3.0, 60.0, 80.0, 150.0, 180.0, 34.0, 30.0, 100.0, 70.0, 35.0, 40.0, 80.0, 137.0, 96.0, 60.0, 150.0, 70.0, 150.0, 160.0, 170.0, 121.0, 140.0, 120.0, 140.0, 97.0, 150.0, 130.0, 150.0, 213.0, 160.0, 220.0, 120.0, 210.0, 130.0, 110.0, 80.0, 130.0, 92.0, 120.0, 150.0, 80.0, 150.0, 50.0, 180.0, 20.0, 190.0, 80.0, 120.0, 30.0, 70.0, 230.0, 60.0, 63.0, 71.0, 90.0, 130.0, 70.0, 60.0, 90.0, 150.0, 80.0, 120.0, 120.0, 170.0, 110.0, 100.0, 60.0, 120.0, 110.0, 110.0, 50.0, 70.0, 110.0, 25.0, 140.0, 30.0, 100.0, 120.0, 140.0, 80.0, 225.0, 93.0, 110.0, 100.0, 73.0, 90.0, 5.0, 170.0, 90.0, 110.0, 290.0, 159.0, 100.0, 140.0, 120.0, 40.0, 129.0, 25.0, 160.0, 130.0, 60.0, 180.0, 103.0, 12.0, 90.0, 60.0, 20.0, 120.0, 110.0, 80.0, 60.0, 210.0, 110.0, 130.0, 90.0, 190.0, 59.0, 160.0, 21.0, 80.0, 50.0, 59.0, 100.0, 99.0, 230.0, 150.0, 0.0, 70.0, 80.0, 90.0, 83.0, 100.0, 85.0, 70.0, 270.0, 79.0, 120.0, 110.0, 150.0, 190.0, 200.0, 140.0, 150.0, 60.0, 140.0, 80.0, 110.0, 90.0, 150.0, 210.0, 40.0, 89.0, 25.0, 19.0, 40.0, 100.0, 140.0, 70.0, 75.0, 12.0, 180.0, 90.0, 120.0, 118.0, 168.0, 149.0, 90.0, 120.0, 40.0, 160.0, 24.0, 68.0, 90.0, 80.0, 80.0, 40.0, 17.0, 100.0, 70.0, 40.0, 80.0, 80.0, 60.0, 140.0, 79.0, 110.0, 80.0, 207.0, 80.0, 40.0, 70.0, 270.0, 70.0, 120.0, 40.0, 50.0, 40.0, 110.0, 20.0, 16.0, 97.0, 110.0, 115.0, 90.0, 70.0, 20.0, 86.0, 20.0, 56.0, 97.0, 60.0, 90.0, 60.0, 100.0, 70.0, 120.0, 50.0, 190.0, 57.0, 55.0, 80.0, 60.0, 124.0, 70.0, 160.0, 190.0, 189.0, 130.0, 50.0, 50.0, 78.0, 80.0, 60.0, 110.0, 48.0, 180.0, 87.0, 110.0, 140.0, 110.0, 160.0, 90.0, 60.0, 60.0, 70.0, 100.0, 126.0, 130.0, 78.0, 80.0, 130.0, 130.0, 90.0, 70.0, 80.0, 100.0, 41.0, 30.0, 136.0, 28.0, 59.0, 90.0, 40.0, 129.0, 80.0, 110.0, 105.0, 150.0, 130.0, 90.0, 110.0, 50.0, 160.0, 180.0, 59.0, 110.0, 70.0, 190.0, 110.0, 70.0, 110.0, 110.0, 100.0, 100.0, 140.0, 80.0, 70.0, 90.0, 90.0, 50.0, 60.0, 130.0, 120.0, 69.0, 8.0, 47.0, 150.0, 80.0, 120.0, 110.0, 50.0, 170.0, 40.0, 88.0, 70.0, 130.0, 160.0, 90.0, 41.0, 170.0, 80.0, 49.0, 90.0, 228.0, 113.0, 170.0, 30.0, 80.0, 50.0, 40.0, 50.0, 210.0, 40.0, 90.0, 70.0, 120.0, 140.0, 120.0, 90.0, 48.0, 80.0, 80.0, 50.0, 22.0, 120.0, 73.0, 49.0, 20.0, 110.0, -40.0, 50.0, 80.0, -80.0, 0.0, 150.0, 70.0, 150.0, 140.0, 160.0, 150.0, 110.0, 90.0, 80.0, 60.0, 80.0, 160.0, 190.0, 150.0, 119.0, 100.0, 80.0, 90.0, 41.0, 50.0, 130.0, 50.0, 210.0, 70.0, 140.0, 170.0, 180.0, 110.0, 70.0, 180.0, 110.0, 40.0, 150.0, 120.0, 70.0, 80.0, 120.0, 110.0, 51.0, -6.0, 160.0, 10.0, 90.0, 110.0, 100.0, 120.0, 60.0, 109.0, 20.0, 40.0, 110.0, 89.0, 80.0, 110.0, 130.0, 20.0, 68.0, 50.0, 30.0, 200.0, 50.0, 36.0, 0.0, 17.0, 140.0, 99.0, 80.0, 90.0, 50.0, 80.0, 67.0, 150.0, 220.0, 71.0, 80.0, 90.0, 90.0, 90.0, 50.0, 49.0, 190.0, 140.0, 90.0, 110.0, 47.0, 18.0, 70.0, 120.0, 130.0, 150.0, 65.0, 140.0, 140.0, 120.0, 180.0, 70.0, 30.0, 140.0, 70.0, 110.0, 130.0, 130.0, 70.0, 89.0, 140.0, 80.0, 130.0, 234.0, 100.0, 120.0, 160.0, 53.0, 90.0, 110.0, 180.0, 100.0, 80.0, 69.0, 100.0, 120.0, 29.0, 100.0, 30.0, 140.0, 60.0, 80.0, 120.0, 70.0, 40.0, 100.0, 70.0, 100.0, 160.0, 80.0, 90.0, 60.0, 102.0, 162.0, 160.0, 135.0, 100.0, 90.0, 140.0, 160.0, 130.0, 58.0, 5.0, 40.0, 59.0, 110.0, 100.0, 110.0, 88.0, 39.0, 200.0, 80.0, 126.0, 40.0, 40.0, 100.0, 20.0, 130.0, 60.0, 40.0, 110.0, 130.0, 60.0, 110.0, 100.0, 100.0, 20.0, 60.0, 219.0, 170.0, 90.0, 70.0, 80.0, 80.0, 90.0, 163.0, 50.0, 60.0, 80.0, 10.0, 180.0, 185.0, 115.0, 50.0, 220.0, 40.0, 80.0, 110.0, 80.0, 60.0, 90.0, 100.0, 70.0, 25.0, 240.0, 50.0, 50.0, 70.0, 50.0, 230.0, 50.0, 50.0, 50.0, 120.0, 80.0, 50.0, 120.0, 140.0, 140.0, 38.0, -8.0, 40.0, 20.0, -3.0, 40.0, 60.0, -6.0, 39.0, 50.0, 29.0, 80.0, 130.0, 129.0, 35.0, 150.0, 100.0, 70.0, 120.0, 120.0, 20.0, 130.0, 130.0, 120.0, 250.0, 130.0, 160.0, 230.0, 130.0, 110.0, 100.0, 80.0, 140.0, 64.0, 80.0, 30.0, 62.0, 13.0, 90.0, 110.0, 37.0, 110.0, 40.0, 70.0, 110.0, 140.0, 230.0, 120.0, 170.0, 80.0, 40.0, 70.0, 100.0, 130.0, 90.0, 180.0, 110.0, 70.0, 130.0, 220.0, 160.0, 70.0, 80.0, 0.0, 52.0, 80.0, 200.0, 160.0, 66.0, 50.0, 190.0, 80.0, 60.0, 166.0, 200.0, 140.0, 110.0, 56.0, 180.0, 160.0, 140.0, 200.0, 110.0, 110.0, 30.0, 25.0, 20.0, 100.0, 120.0, 40.0, 150.0, 150.0, 40.0, 150.0, 80.0, 25.0, 150.0, 130.0, 140.0, 90.0, 120.0, 250.0, 110.0, 219.0, 80.0, 80.0, 45.0, 50.0, 90.0, 50.0, 115.0, 80.0, 94.0, 190.0, 150.0, 100.0, 200.0, 140.0, 99.0, 120.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.619636653334632, "mean_inference_ms": 1.6174165673905554, "mean_action_processing_ms": 0.5016476461952296, "mean_env_wait_ms": 1.1190647597696843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011619329452514648, "StateBufferConnector_ms": 0.013664960861206055, "ViewRequirementAgentConnector_ms": 0.3677339553833008}, "num_episodes": 22, "episode_return_max": 1490.0, "episode_return_min": 261.0, "episode_return_mean": 982.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.629169773416073, "num_env_steps_trained_throughput_per_sec": 20.629169773416073, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 5440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5440000, "timers": {"training_iteration_time_ms": 193269.567, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193269.521, "sample_time_ms": 2524.752, "learn_time_ms": 190724.383, "learn_throughput": 20.973, "synch_weights_time_ms": 11.853}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "done": false, "training_iteration": 136, "trial_id": "1841f_00000", "date": "2024-08-08_07-01-44", "timestamp": 1723114904, "time_this_iter_s": 193.91131901741028, "time_total_s": 27687.53413629532, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29df430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27687.53413629532, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 19.5014598540146, "ram_util_percent": 77.94562043795621}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2087151903440905, "cur_kl_coeff": 1.4416259765625, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.546161980166858, "policy_loss": -0.013176276310916328, "vf_loss": 8.555307705333819, "vf_explained_var": -0.01781522698930531, "kl": 0.002795843787814854, "entropy": 0.536834084955902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1281735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "env_runners": {"episode_reward_max": 1490.0, "episode_reward_min": 261.0, "episode_reward_mean": 984.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -99.0}, "policy_reward_max": {"policy_0": 301.0}, "policy_reward_mean": {"policy_0": 98.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [868.0, 1210.0, 850.0, 845.0, 1013.0, 937.0, 1180.0, 922.0, 1047.0, 1090.0, 923.0, 755.0, 1260.0, 780.0, 827.0, 888.0, 1378.0, 1465.0, 1140.0, 874.0, 1120.0, 865.0, 1086.0, 1203.0, 935.0, 1199.0, 859.0, 1087.0, 1310.0, 883.0, 1122.0, 699.0, 946.0, 890.0, 644.0, 893.0, 1115.0, 853.0, 1046.0, 829.0, 927.0, 1149.0, 980.0, 804.0, 1028.0, 1051.0, 930.0, 632.0, 630.0, 1230.0, 940.0, 1270.0, 795.0, 838.0, 601.0, 1047.0, 979.0, 1000.0, 1019.0, 1217.0, 948.0, 880.0, 1199.0, 739.0, 836.0, 1079.0, 773.0, 1120.0, 975.0, 838.0, 261.0, 954.0, 1490.0, 706.0, 1110.0, 1260.0, 948.0, 1292.0, 905.0, 1075.0, 1089.0, 1303.0, 857.0, 940.0, 874.0, 890.0, 509.0, 1100.0, 747.0, 1050.0, 995.0, 955.0, 1047.0, 1060.0, 1210.0, 1085.0, 1322.0, 1136.0, 945.0, 1045.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 31.0, 78.0, 27.0, 90.0, 32.0, 70.0, 200.0, 170.0, 70.0, 110.0, 130.0, 180.0, 100.0, 90.0, 110.0, 150.0, 170.0, 90.0, 80.0, 110.0, 60.0, 120.0, 140.0, 40.0, 80.0, 60.0, 70.0, 90.0, 80.0, 20.0, 99.0, 60.0, 80.0, 90.0, 40.0, 100.0, 80.0, 176.0, 100.0, 78.0, 119.0, 70.0, 109.0, 240.0, 15.0, 100.0, 52.0, 70.0, 160.0, 120.0, 100.0, 99.0, 160.0, 98.0, 60.0, 30.0, 100.0, 50.0, 120.0, 120.0, 70.0, 130.0, 110.0, 120.0, 130.0, 160.0, 170.0, 70.0, 100.0, 120.0, 62.0, 60.0, 110.0, 100.0, 100.0, 80.0, 90.0, 120.0, 80.0, 55.0, 180.0, 100.0, 80.0, 140.0, 99.0, 140.0, 68.0, 70.0, 115.0, 40.0, 140.0, 110.0, 130.0, 150.0, 30.0, 180.0, 190.0, 90.0, 30.0, 70.0, 50.0, 150.0, 20.0, 140.0, 120.0, 114.0, 109.0, 90.0, 60.0, 20.0, 138.0, 100.0, 88.0, 2.0, 69.0, 90.0, 60.0, 21.0, 167.0, 100.0, 100.0, 80.0, 150.0, 140.0, 140.0, 210.0, 100.0, 150.0, 90.0, 60.0, 140.0, 80.0, 110.0, 30.0, 110.0, 70.0, 50.0, 20.0, 110.0, 100.0, 90.0, 3.0, 60.0, 80.0, 150.0, 180.0, 34.0, 30.0, 100.0, 70.0, 35.0, 40.0, 80.0, 137.0, 96.0, 60.0, 150.0, 70.0, 150.0, 160.0, 170.0, 121.0, 140.0, 120.0, 140.0, 97.0, 150.0, 130.0, 150.0, 213.0, 160.0, 220.0, 120.0, 210.0, 130.0, 110.0, 80.0, 130.0, 92.0, 120.0, 150.0, 80.0, 150.0, 50.0, 180.0, 20.0, 190.0, 80.0, 120.0, 30.0, 70.0, 230.0, 60.0, 63.0, 71.0, 90.0, 130.0, 70.0, 60.0, 90.0, 150.0, 80.0, 120.0, 120.0, 170.0, 110.0, 100.0, 60.0, 120.0, 110.0, 110.0, 50.0, 70.0, 110.0, 25.0, 140.0, 30.0, 100.0, 120.0, 140.0, 80.0, 225.0, 93.0, 110.0, 100.0, 73.0, 90.0, 5.0, 170.0, 90.0, 110.0, 290.0, 159.0, 100.0, 140.0, 120.0, 40.0, 129.0, 25.0, 160.0, 130.0, 60.0, 180.0, 103.0, 12.0, 90.0, 60.0, 20.0, 120.0, 110.0, 80.0, 60.0, 210.0, 110.0, 130.0, 90.0, 190.0, 59.0, 160.0, 21.0, 80.0, 50.0, 59.0, 100.0, 99.0, 230.0, 150.0, 0.0, 70.0, 80.0, 90.0, 83.0, 100.0, 85.0, 70.0, 270.0, 79.0, 120.0, 110.0, 150.0, 190.0, 200.0, 140.0, 150.0, 60.0, 140.0, 80.0, 110.0, 90.0, 150.0, 210.0, 40.0, 89.0, 25.0, 19.0, 40.0, 100.0, 140.0, 70.0, 75.0, 12.0, 180.0, 90.0, 120.0, 118.0, 168.0, 149.0, 90.0, 120.0, 40.0, 160.0, 24.0, 68.0, 90.0, 80.0, 80.0, 40.0, 17.0, 100.0, 70.0, 40.0, 80.0, 80.0, 60.0, 140.0, 79.0, 110.0, 80.0, 207.0, 80.0, 40.0, 70.0, 270.0, 70.0, 120.0, 40.0, 50.0, 40.0, 110.0, 20.0, 16.0, 97.0, 110.0, 115.0, 90.0, 70.0, 20.0, 86.0, 20.0, 56.0, 97.0, 60.0, 90.0, 60.0, 100.0, 70.0, 120.0, 50.0, 190.0, 57.0, 55.0, 80.0, 60.0, 124.0, 70.0, 160.0, 190.0, 189.0, 130.0, 50.0, 50.0, 78.0, 80.0, 60.0, 110.0, 48.0, 180.0, 87.0, 110.0, 140.0, 110.0, 160.0, 90.0, 60.0, 60.0, 70.0, 100.0, 126.0, 130.0, 78.0, 80.0, 130.0, 130.0, 90.0, 70.0, 80.0, 100.0, 41.0, 30.0, 136.0, 28.0, 59.0, 90.0, 40.0, 129.0, 80.0, 110.0, 105.0, 150.0, 130.0, 90.0, 110.0, 50.0, 160.0, 180.0, 59.0, 110.0, 70.0, 190.0, 110.0, 70.0, 110.0, 110.0, 100.0, 100.0, 140.0, 80.0, 70.0, 90.0, 90.0, 50.0, 60.0, 130.0, 120.0, 69.0, 8.0, 47.0, 150.0, 80.0, 120.0, 110.0, 50.0, 170.0, 40.0, 88.0, 70.0, 130.0, 160.0, 90.0, 41.0, 170.0, 80.0, 49.0, 90.0, 228.0, 113.0, 170.0, 30.0, 80.0, 50.0, 40.0, 50.0, 210.0, 40.0, 90.0, 70.0, 120.0, 140.0, 120.0, 90.0, 48.0, 80.0, 80.0, 50.0, 22.0, 120.0, 73.0, 49.0, 20.0, 110.0, -40.0, 50.0, 80.0, -80.0, 0.0, 150.0, 70.0, 150.0, 140.0, 160.0, 150.0, 110.0, 90.0, 80.0, 60.0, 80.0, 160.0, 190.0, 150.0, 119.0, 100.0, 80.0, 90.0, 41.0, 50.0, 130.0, 50.0, 210.0, 70.0, 140.0, 170.0, 180.0, 110.0, 70.0, 180.0, 110.0, 40.0, 150.0, 120.0, 70.0, 80.0, 120.0, 110.0, 51.0, -6.0, 160.0, 10.0, 90.0, 110.0, 100.0, 120.0, 60.0, 109.0, 20.0, 40.0, 110.0, 89.0, 80.0, 110.0, 130.0, 20.0, 68.0, 50.0, 30.0, 200.0, 50.0, 36.0, 0.0, 17.0, 140.0, 99.0, 80.0, 90.0, 50.0, 80.0, 67.0, 150.0, 220.0, 71.0, 80.0, 90.0, 90.0, 90.0, 50.0, 49.0, 190.0, 140.0, 90.0, 110.0, 47.0, 18.0, 70.0, 120.0, 130.0, 150.0, 65.0, 140.0, 140.0, 120.0, 180.0, 70.0, 30.0, 140.0, 70.0, 110.0, 130.0, 130.0, 70.0, 89.0, 140.0, 80.0, 130.0, 234.0, 100.0, 120.0, 160.0, 53.0, 90.0, 110.0, 180.0, 100.0, 80.0, 69.0, 100.0, 120.0, 29.0, 100.0, 30.0, 140.0, 60.0, 80.0, 120.0, 70.0, 40.0, 100.0, 70.0, 100.0, 160.0, 80.0, 90.0, 60.0, 102.0, 162.0, 160.0, 135.0, 100.0, 90.0, 140.0, 160.0, 130.0, 58.0, 5.0, 40.0, 59.0, 110.0, 100.0, 110.0, 88.0, 39.0, 200.0, 80.0, 126.0, 40.0, 40.0, 100.0, 20.0, 130.0, 60.0, 40.0, 110.0, 130.0, 60.0, 110.0, 100.0, 100.0, 20.0, 60.0, 219.0, 170.0, 90.0, 70.0, 80.0, 80.0, 90.0, 163.0, 50.0, 60.0, 80.0, 10.0, 180.0, 185.0, 115.0, 50.0, 220.0, 40.0, 80.0, 110.0, 80.0, 60.0, 90.0, 100.0, 70.0, 25.0, 240.0, 50.0, 50.0, 70.0, 50.0, 230.0, 50.0, 50.0, 50.0, 120.0, 80.0, 50.0, 120.0, 140.0, 140.0, 38.0, -8.0, 40.0, 20.0, -3.0, 40.0, 60.0, -6.0, 39.0, 50.0, 29.0, 80.0, 130.0, 129.0, 35.0, 150.0, 100.0, 70.0, 120.0, 120.0, 20.0, 130.0, 130.0, 120.0, 250.0, 130.0, 160.0, 230.0, 130.0, 110.0, 100.0, 80.0, 140.0, 64.0, 80.0, 30.0, 62.0, 13.0, 90.0, 110.0, 37.0, 110.0, 40.0, 70.0, 110.0, 140.0, 230.0, 120.0, 170.0, 80.0, 40.0, 70.0, 100.0, 130.0, 90.0, 180.0, 110.0, 70.0, 130.0, 220.0, 160.0, 70.0, 80.0, 0.0, 52.0, 80.0, 200.0, 160.0, 66.0, 50.0, 190.0, 80.0, 60.0, 166.0, 200.0, 140.0, 110.0, 56.0, 180.0, 160.0, 140.0, 200.0, 110.0, 110.0, 30.0, 25.0, 20.0, 100.0, 120.0, 40.0, 150.0, 150.0, 40.0, 150.0, 80.0, 25.0, 150.0, 130.0, 140.0, 90.0, 120.0, 250.0, 110.0, 219.0, 80.0, 80.0, 45.0, 50.0, 90.0, 50.0, 115.0, 80.0, 94.0, 190.0, 150.0, 100.0, 200.0, 140.0, 99.0, 120.0, 130.0, 80.0, 20.0, 59.0, 100.0, 160.0, 50.0, 138.0, 130.0, 110.0, 10.0, 60.0, 70.0, 120.0, 100.0, 100.0, 60.0, 80.0, 70.0, 110.0, 170.0, 90.0, 90.0, 120.0, 58.0, 120.0, 50.0, 180.0, 67.0, 80.0, 19.0, 80.0, 120.0, 90.0, 90.0, 90.0, 120.0, 80.0, 50.0, 140.0, 30.0, 23.0, 0.0, 60.0, 100.0, 24.0, 70.0, 59.0, 90.0, 13.0, 70.0, 301.0, 100.0, 200.0, 50.0, 39.0, 100.0, 70.0, 140.0, 60.0, 40.0, 35.0, 8.0, 116.0, 110.0, 60.0, 210.0, 50.0, 38.0, 50.0, 70.0, 130.0, 110.0, 90.0, 50.0, 140.0, 90.0, 190.0, 30.0, 150.0, 70.0, 200.0, 114.0, 140.0, 60.0, 80.0, 160.0, 60.0, -99.0, 160.0, 120.0, 70.0, 80.0, 100.0, 90.0, 170.0, 85.0, 150.0, 70.0, 20.0, 120.0, 110.0, 70.0, 102.0, 210.0, 110.0, 110.0, 85.0, 106.0, 47.0, 97.0, 100.0, 90.0, 110.0, 110.0, 110.0, 80.0, 190.0, 120.0, 70.0, 80.0, 90.0, 110.0, 150.0, 110.0, 50.0, 140.0, 110.0, 210.0, 120.0, 120.0, 110.0, 70.0, 50.0, 80.0, 180.0, 70.0, 70.0, 105.0, 260.0, 90.0, 300.0, 30.0, 114.0, 172.0, 60.0, 120.0, 86.0, 180.0, 110.0, 150.0, 128.0, 130.0, 110.0, 89.0, 81.0, 90.0, 120.0, 168.0, 80.0, 140.0, 60.0, 40.0, 72.0, 150.0, 98.0, 180.0, 110.0, 100.0, 60.0, 75.0, 140.0, 110.0, 80.0, 100.0, 200.0, 100.0, -25.0, 80.0, 140.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.617788141713462, "mean_inference_ms": 1.6156694302746812, "mean_action_processing_ms": 0.5022200796966306, "mean_env_wait_ms": 1.1182683848857613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01153707504272461, "StateBufferConnector_ms": 0.01354217529296875, "ViewRequirementAgentConnector_ms": 0.3664271831512451}, "num_episodes": 18, "episode_return_max": 1490.0, "episode_return_min": 261.0, "episode_return_mean": 984.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.737531664608518, "num_env_steps_trained_throughput_per_sec": 20.737531664608518, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 5480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5480000, "timers": {"training_iteration_time_ms": 193243.765, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193243.717, "sample_time_ms": 2531.018, "learn_time_ms": 190692.296, "learn_throughput": 20.976, "synch_weights_time_ms": 11.993}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "done": false, "training_iteration": 137, "trial_id": "1841f_00000", "date": "2024-08-08_07-04-57", "timestamp": 1723115097, "time_this_iter_s": 192.89625477790833, "time_total_s": 27880.430391073227, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b29df4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27880.430391073227, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 17.15787545787546, "ram_util_percent": 77.9208791208791}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2501579087255354, "cur_kl_coeff": 0.72081298828125, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.014171824521629121, "vf_loss": 7.981290365357242, "vf_explained_var": -0.010595181111456613, "kl": Infinity, "entropy": 0.5812413900328901, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1291125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 182.0, "episode_reward_mean": 974.12, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -99.0}, "policy_reward_max": {"policy_0": 301.0}, "policy_reward_mean": {"policy_0": 97.412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1140.0, 874.0, 1120.0, 865.0, 1086.0, 1203.0, 935.0, 1199.0, 859.0, 1087.0, 1310.0, 883.0, 1122.0, 699.0, 946.0, 890.0, 644.0, 893.0, 1115.0, 853.0, 1046.0, 829.0, 927.0, 1149.0, 980.0, 804.0, 1028.0, 1051.0, 930.0, 632.0, 630.0, 1230.0, 940.0, 1270.0, 795.0, 838.0, 601.0, 1047.0, 979.0, 1000.0, 1019.0, 1217.0, 948.0, 880.0, 1199.0, 739.0, 836.0, 1079.0, 773.0, 1120.0, 975.0, 838.0, 261.0, 954.0, 1490.0, 706.0, 1110.0, 1260.0, 948.0, 1292.0, 905.0, 1075.0, 1089.0, 1303.0, 857.0, 940.0, 874.0, 890.0, 509.0, 1100.0, 747.0, 1050.0, 995.0, 955.0, 1047.0, 1060.0, 1210.0, 1085.0, 1322.0, 1136.0, 945.0, 1045.0, 1585.0, 1035.0, 643.0, 1660.0, 1060.0, 850.0, 1179.0, 713.0, 1112.0, 657.0, 799.0, 182.0, 965.0, 967.0, 939.0, 1026.0, 976.0, 852.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 150.0, 80.0, 150.0, 50.0, 180.0, 20.0, 190.0, 80.0, 120.0, 30.0, 70.0, 230.0, 60.0, 63.0, 71.0, 90.0, 130.0, 70.0, 60.0, 90.0, 150.0, 80.0, 120.0, 120.0, 170.0, 110.0, 100.0, 60.0, 120.0, 110.0, 110.0, 50.0, 70.0, 110.0, 25.0, 140.0, 30.0, 100.0, 120.0, 140.0, 80.0, 225.0, 93.0, 110.0, 100.0, 73.0, 90.0, 5.0, 170.0, 90.0, 110.0, 290.0, 159.0, 100.0, 140.0, 120.0, 40.0, 129.0, 25.0, 160.0, 130.0, 60.0, 180.0, 103.0, 12.0, 90.0, 60.0, 20.0, 120.0, 110.0, 80.0, 60.0, 210.0, 110.0, 130.0, 90.0, 190.0, 59.0, 160.0, 21.0, 80.0, 50.0, 59.0, 100.0, 99.0, 230.0, 150.0, 0.0, 70.0, 80.0, 90.0, 83.0, 100.0, 85.0, 70.0, 270.0, 79.0, 120.0, 110.0, 150.0, 190.0, 200.0, 140.0, 150.0, 60.0, 140.0, 80.0, 110.0, 90.0, 150.0, 210.0, 40.0, 89.0, 25.0, 19.0, 40.0, 100.0, 140.0, 70.0, 75.0, 12.0, 180.0, 90.0, 120.0, 118.0, 168.0, 149.0, 90.0, 120.0, 40.0, 160.0, 24.0, 68.0, 90.0, 80.0, 80.0, 40.0, 17.0, 100.0, 70.0, 40.0, 80.0, 80.0, 60.0, 140.0, 79.0, 110.0, 80.0, 207.0, 80.0, 40.0, 70.0, 270.0, 70.0, 120.0, 40.0, 50.0, 40.0, 110.0, 20.0, 16.0, 97.0, 110.0, 115.0, 90.0, 70.0, 20.0, 86.0, 20.0, 56.0, 97.0, 60.0, 90.0, 60.0, 100.0, 70.0, 120.0, 50.0, 190.0, 57.0, 55.0, 80.0, 60.0, 124.0, 70.0, 160.0, 190.0, 189.0, 130.0, 50.0, 50.0, 78.0, 80.0, 60.0, 110.0, 48.0, 180.0, 87.0, 110.0, 140.0, 110.0, 160.0, 90.0, 60.0, 60.0, 70.0, 100.0, 126.0, 130.0, 78.0, 80.0, 130.0, 130.0, 90.0, 70.0, 80.0, 100.0, 41.0, 30.0, 136.0, 28.0, 59.0, 90.0, 40.0, 129.0, 80.0, 110.0, 105.0, 150.0, 130.0, 90.0, 110.0, 50.0, 160.0, 180.0, 59.0, 110.0, 70.0, 190.0, 110.0, 70.0, 110.0, 110.0, 100.0, 100.0, 140.0, 80.0, 70.0, 90.0, 90.0, 50.0, 60.0, 130.0, 120.0, 69.0, 8.0, 47.0, 150.0, 80.0, 120.0, 110.0, 50.0, 170.0, 40.0, 88.0, 70.0, 130.0, 160.0, 90.0, 41.0, 170.0, 80.0, 49.0, 90.0, 228.0, 113.0, 170.0, 30.0, 80.0, 50.0, 40.0, 50.0, 210.0, 40.0, 90.0, 70.0, 120.0, 140.0, 120.0, 90.0, 48.0, 80.0, 80.0, 50.0, 22.0, 120.0, 73.0, 49.0, 20.0, 110.0, -40.0, 50.0, 80.0, -80.0, 0.0, 150.0, 70.0, 150.0, 140.0, 160.0, 150.0, 110.0, 90.0, 80.0, 60.0, 80.0, 160.0, 190.0, 150.0, 119.0, 100.0, 80.0, 90.0, 41.0, 50.0, 130.0, 50.0, 210.0, 70.0, 140.0, 170.0, 180.0, 110.0, 70.0, 180.0, 110.0, 40.0, 150.0, 120.0, 70.0, 80.0, 120.0, 110.0, 51.0, -6.0, 160.0, 10.0, 90.0, 110.0, 100.0, 120.0, 60.0, 109.0, 20.0, 40.0, 110.0, 89.0, 80.0, 110.0, 130.0, 20.0, 68.0, 50.0, 30.0, 200.0, 50.0, 36.0, 0.0, 17.0, 140.0, 99.0, 80.0, 90.0, 50.0, 80.0, 67.0, 150.0, 220.0, 71.0, 80.0, 90.0, 90.0, 90.0, 50.0, 49.0, 190.0, 140.0, 90.0, 110.0, 47.0, 18.0, 70.0, 120.0, 130.0, 150.0, 65.0, 140.0, 140.0, 120.0, 180.0, 70.0, 30.0, 140.0, 70.0, 110.0, 130.0, 130.0, 70.0, 89.0, 140.0, 80.0, 130.0, 234.0, 100.0, 120.0, 160.0, 53.0, 90.0, 110.0, 180.0, 100.0, 80.0, 69.0, 100.0, 120.0, 29.0, 100.0, 30.0, 140.0, 60.0, 80.0, 120.0, 70.0, 40.0, 100.0, 70.0, 100.0, 160.0, 80.0, 90.0, 60.0, 102.0, 162.0, 160.0, 135.0, 100.0, 90.0, 140.0, 160.0, 130.0, 58.0, 5.0, 40.0, 59.0, 110.0, 100.0, 110.0, 88.0, 39.0, 200.0, 80.0, 126.0, 40.0, 40.0, 100.0, 20.0, 130.0, 60.0, 40.0, 110.0, 130.0, 60.0, 110.0, 100.0, 100.0, 20.0, 60.0, 219.0, 170.0, 90.0, 70.0, 80.0, 80.0, 90.0, 163.0, 50.0, 60.0, 80.0, 10.0, 180.0, 185.0, 115.0, 50.0, 220.0, 40.0, 80.0, 110.0, 80.0, 60.0, 90.0, 100.0, 70.0, 25.0, 240.0, 50.0, 50.0, 70.0, 50.0, 230.0, 50.0, 50.0, 50.0, 120.0, 80.0, 50.0, 120.0, 140.0, 140.0, 38.0, -8.0, 40.0, 20.0, -3.0, 40.0, 60.0, -6.0, 39.0, 50.0, 29.0, 80.0, 130.0, 129.0, 35.0, 150.0, 100.0, 70.0, 120.0, 120.0, 20.0, 130.0, 130.0, 120.0, 250.0, 130.0, 160.0, 230.0, 130.0, 110.0, 100.0, 80.0, 140.0, 64.0, 80.0, 30.0, 62.0, 13.0, 90.0, 110.0, 37.0, 110.0, 40.0, 70.0, 110.0, 140.0, 230.0, 120.0, 170.0, 80.0, 40.0, 70.0, 100.0, 130.0, 90.0, 180.0, 110.0, 70.0, 130.0, 220.0, 160.0, 70.0, 80.0, 0.0, 52.0, 80.0, 200.0, 160.0, 66.0, 50.0, 190.0, 80.0, 60.0, 166.0, 200.0, 140.0, 110.0, 56.0, 180.0, 160.0, 140.0, 200.0, 110.0, 110.0, 30.0, 25.0, 20.0, 100.0, 120.0, 40.0, 150.0, 150.0, 40.0, 150.0, 80.0, 25.0, 150.0, 130.0, 140.0, 90.0, 120.0, 250.0, 110.0, 219.0, 80.0, 80.0, 45.0, 50.0, 90.0, 50.0, 115.0, 80.0, 94.0, 190.0, 150.0, 100.0, 200.0, 140.0, 99.0, 120.0, 130.0, 80.0, 20.0, 59.0, 100.0, 160.0, 50.0, 138.0, 130.0, 110.0, 10.0, 60.0, 70.0, 120.0, 100.0, 100.0, 60.0, 80.0, 70.0, 110.0, 170.0, 90.0, 90.0, 120.0, 58.0, 120.0, 50.0, 180.0, 67.0, 80.0, 19.0, 80.0, 120.0, 90.0, 90.0, 90.0, 120.0, 80.0, 50.0, 140.0, 30.0, 23.0, 0.0, 60.0, 100.0, 24.0, 70.0, 59.0, 90.0, 13.0, 70.0, 301.0, 100.0, 200.0, 50.0, 39.0, 100.0, 70.0, 140.0, 60.0, 40.0, 35.0, 8.0, 116.0, 110.0, 60.0, 210.0, 50.0, 38.0, 50.0, 70.0, 130.0, 110.0, 90.0, 50.0, 140.0, 90.0, 190.0, 30.0, 150.0, 70.0, 200.0, 114.0, 140.0, 60.0, 80.0, 160.0, 60.0, -99.0, 160.0, 120.0, 70.0, 80.0, 100.0, 90.0, 170.0, 85.0, 150.0, 70.0, 20.0, 120.0, 110.0, 70.0, 102.0, 210.0, 110.0, 110.0, 85.0, 106.0, 47.0, 97.0, 100.0, 90.0, 110.0, 110.0, 110.0, 80.0, 190.0, 120.0, 70.0, 80.0, 90.0, 110.0, 150.0, 110.0, 50.0, 140.0, 110.0, 210.0, 120.0, 120.0, 110.0, 70.0, 50.0, 80.0, 180.0, 70.0, 70.0, 105.0, 260.0, 90.0, 300.0, 30.0, 114.0, 172.0, 60.0, 120.0, 86.0, 180.0, 110.0, 150.0, 128.0, 130.0, 110.0, 89.0, 81.0, 90.0, 120.0, 168.0, 80.0, 140.0, 60.0, 40.0, 72.0, 150.0, 98.0, 180.0, 110.0, 100.0, 60.0, 75.0, 140.0, 110.0, 80.0, 100.0, 200.0, 100.0, -25.0, 80.0, 140.0, 120.0, 120.0, 229.0, 140.0, 130.0, 100.0, 160.0, 30.0, 206.0, 230.0, 240.0, 100.0, 110.0, 110.0, 200.0, 80.0, 110.0, 65.0, 40.0, 155.0, 65.0, 90.0, 50.0, 120.0, 130.0, 69.0, 9.0, 18.0, 37.0, 50.0, 70.0, 180.0, 160.0, 180.0, 80.0, 170.0, 120.0, 190.0, 180.0, 180.0, 220.0, 100.0, 80.0, 120.0, 100.0, 110.0, 60.0, 80.0, 170.0, 140.0, 100.0, 50.0, 120.0, 70.0, 50.0, 120.0, 140.0, 130.0, 10.0, 100.0, 60.0, 109.0, 150.0, 70.0, 50.0, 60.0, 110.0, 120.0, 160.0, 130.0, 220.0, 70.0, 130.0, 50.0, 60.0, 15.0, 80.0, 30.0, 150.0, 130.0, -2.0, 110.0, 180.0, 110.0, 80.0, 110.0, 131.0, 81.0, 100.0, 150.0, 60.0, 210.0, 60.0, 70.0, 79.0, 30.0, 30.0, 0.0, 50.0, 100.0, 28.0, 70.0, 50.0, 130.0, 220.0, 58.0, 52.0, 10.0, 60.0, 157.0, -8.0, 18.0, 0.0, 40.0, 10.0, 10.0, 30.0, 40.0, 4.0, 20.0, 10.0, 75.0, 80.0, 114.0, 40.0, 100.0, 50.0, 150.0, 96.0, 80.0, 180.0, 80.0, 100.0, 110.0, 110.0, 59.0, 150.0, 80.0, 89.0, 120.0, 69.0, 190.0, 70.0, 130.0, 120.0, 70.0, 35.0, 109.0, 70.0, 105.0, 40.0, 89.0, 100.0, 130.0, 80.0, 110.0, 90.0, 150.0, 69.0, 40.0, 168.0, 34.0, 50.0, 110.0, 140.0, 187.0, 110.0, 120.0, 60.0, 65.0, 100.0, 70.0, 54.0, 30.0, 130.0, 108.0, 70.0, 150.0, 140.0, 40.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6158163646640389, "mean_inference_ms": 1.6136675694395877, "mean_action_processing_ms": 0.5017946600162605, "mean_env_wait_ms": 1.117374368330231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011245489120483398, "StateBufferConnector_ms": 0.013483524322509766, "ViewRequirementAgentConnector_ms": 0.37010836601257324}, "num_episodes": 18, "episode_return_max": 1660.0, "episode_return_min": 182.0, "episode_return_mean": 974.12}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.666549209944392, "num_env_steps_trained_throughput_per_sec": 20.666549209944392, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 5520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5520000, "timers": {"training_iteration_time_ms": 193321.864, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193321.817, "sample_time_ms": 2532.15, "learn_time_ms": 190769.64, "learn_throughput": 20.968, "synch_weights_time_ms": 12.153}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "done": false, "training_iteration": 138, "trial_id": "1841f_00000", "date": "2024-08-08_07-08-11", "timestamp": 1723115291, "time_this_iter_s": 193.55967164039612, "time_total_s": 28073.990062713623, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b610e8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28073.990062713623, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 17.55, "ram_util_percent": 77.74197080291972}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.373018224297748, "cur_kl_coeff": 1.0812194824218753, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.474734004389363, "policy_loss": -0.014215143469754403, "vf_loss": 8.48496884431321, "vf_explained_var": -0.02046874931699044, "kl": 0.0036813074551847566, "entropy": 0.5487317105800834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1300515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 182.0, "episode_reward_mean": 959.43, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -99.0}, "policy_reward_max": {"policy_0": 301.0}, "policy_reward_mean": {"policy_0": 95.943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1149.0, 980.0, 804.0, 1028.0, 1051.0, 930.0, 632.0, 630.0, 1230.0, 940.0, 1270.0, 795.0, 838.0, 601.0, 1047.0, 979.0, 1000.0, 1019.0, 1217.0, 948.0, 880.0, 1199.0, 739.0, 836.0, 1079.0, 773.0, 1120.0, 975.0, 838.0, 261.0, 954.0, 1490.0, 706.0, 1110.0, 1260.0, 948.0, 1292.0, 905.0, 1075.0, 1089.0, 1303.0, 857.0, 940.0, 874.0, 890.0, 509.0, 1100.0, 747.0, 1050.0, 995.0, 955.0, 1047.0, 1060.0, 1210.0, 1085.0, 1322.0, 1136.0, 945.0, 1045.0, 1585.0, 1035.0, 643.0, 1660.0, 1060.0, 850.0, 1179.0, 713.0, 1112.0, 657.0, 799.0, 182.0, 965.0, 967.0, 939.0, 1026.0, 976.0, 852.0, 980.0, 1164.0, 1060.0, 675.0, 1083.0, 1278.0, 960.0, 725.0, 800.0, 947.0, 1032.0, 590.0, 894.0, 964.0, 930.0, 874.0, 869.0, 918.0, 1000.0, 940.0, 912.0, 865.0, 596.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 90.0, 110.0, 50.0, 160.0, 180.0, 59.0, 110.0, 70.0, 190.0, 110.0, 70.0, 110.0, 110.0, 100.0, 100.0, 140.0, 80.0, 70.0, 90.0, 90.0, 50.0, 60.0, 130.0, 120.0, 69.0, 8.0, 47.0, 150.0, 80.0, 120.0, 110.0, 50.0, 170.0, 40.0, 88.0, 70.0, 130.0, 160.0, 90.0, 41.0, 170.0, 80.0, 49.0, 90.0, 228.0, 113.0, 170.0, 30.0, 80.0, 50.0, 40.0, 50.0, 210.0, 40.0, 90.0, 70.0, 120.0, 140.0, 120.0, 90.0, 48.0, 80.0, 80.0, 50.0, 22.0, 120.0, 73.0, 49.0, 20.0, 110.0, -40.0, 50.0, 80.0, -80.0, 0.0, 150.0, 70.0, 150.0, 140.0, 160.0, 150.0, 110.0, 90.0, 80.0, 60.0, 80.0, 160.0, 190.0, 150.0, 119.0, 100.0, 80.0, 90.0, 41.0, 50.0, 130.0, 50.0, 210.0, 70.0, 140.0, 170.0, 180.0, 110.0, 70.0, 180.0, 110.0, 40.0, 150.0, 120.0, 70.0, 80.0, 120.0, 110.0, 51.0, -6.0, 160.0, 10.0, 90.0, 110.0, 100.0, 120.0, 60.0, 109.0, 20.0, 40.0, 110.0, 89.0, 80.0, 110.0, 130.0, 20.0, 68.0, 50.0, 30.0, 200.0, 50.0, 36.0, 0.0, 17.0, 140.0, 99.0, 80.0, 90.0, 50.0, 80.0, 67.0, 150.0, 220.0, 71.0, 80.0, 90.0, 90.0, 90.0, 50.0, 49.0, 190.0, 140.0, 90.0, 110.0, 47.0, 18.0, 70.0, 120.0, 130.0, 150.0, 65.0, 140.0, 140.0, 120.0, 180.0, 70.0, 30.0, 140.0, 70.0, 110.0, 130.0, 130.0, 70.0, 89.0, 140.0, 80.0, 130.0, 234.0, 100.0, 120.0, 160.0, 53.0, 90.0, 110.0, 180.0, 100.0, 80.0, 69.0, 100.0, 120.0, 29.0, 100.0, 30.0, 140.0, 60.0, 80.0, 120.0, 70.0, 40.0, 100.0, 70.0, 100.0, 160.0, 80.0, 90.0, 60.0, 102.0, 162.0, 160.0, 135.0, 100.0, 90.0, 140.0, 160.0, 130.0, 58.0, 5.0, 40.0, 59.0, 110.0, 100.0, 110.0, 88.0, 39.0, 200.0, 80.0, 126.0, 40.0, 40.0, 100.0, 20.0, 130.0, 60.0, 40.0, 110.0, 130.0, 60.0, 110.0, 100.0, 100.0, 20.0, 60.0, 219.0, 170.0, 90.0, 70.0, 80.0, 80.0, 90.0, 163.0, 50.0, 60.0, 80.0, 10.0, 180.0, 185.0, 115.0, 50.0, 220.0, 40.0, 80.0, 110.0, 80.0, 60.0, 90.0, 100.0, 70.0, 25.0, 240.0, 50.0, 50.0, 70.0, 50.0, 230.0, 50.0, 50.0, 50.0, 120.0, 80.0, 50.0, 120.0, 140.0, 140.0, 38.0, -8.0, 40.0, 20.0, -3.0, 40.0, 60.0, -6.0, 39.0, 50.0, 29.0, 80.0, 130.0, 129.0, 35.0, 150.0, 100.0, 70.0, 120.0, 120.0, 20.0, 130.0, 130.0, 120.0, 250.0, 130.0, 160.0, 230.0, 130.0, 110.0, 100.0, 80.0, 140.0, 64.0, 80.0, 30.0, 62.0, 13.0, 90.0, 110.0, 37.0, 110.0, 40.0, 70.0, 110.0, 140.0, 230.0, 120.0, 170.0, 80.0, 40.0, 70.0, 100.0, 130.0, 90.0, 180.0, 110.0, 70.0, 130.0, 220.0, 160.0, 70.0, 80.0, 0.0, 52.0, 80.0, 200.0, 160.0, 66.0, 50.0, 190.0, 80.0, 60.0, 166.0, 200.0, 140.0, 110.0, 56.0, 180.0, 160.0, 140.0, 200.0, 110.0, 110.0, 30.0, 25.0, 20.0, 100.0, 120.0, 40.0, 150.0, 150.0, 40.0, 150.0, 80.0, 25.0, 150.0, 130.0, 140.0, 90.0, 120.0, 250.0, 110.0, 219.0, 80.0, 80.0, 45.0, 50.0, 90.0, 50.0, 115.0, 80.0, 94.0, 190.0, 150.0, 100.0, 200.0, 140.0, 99.0, 120.0, 130.0, 80.0, 20.0, 59.0, 100.0, 160.0, 50.0, 138.0, 130.0, 110.0, 10.0, 60.0, 70.0, 120.0, 100.0, 100.0, 60.0, 80.0, 70.0, 110.0, 170.0, 90.0, 90.0, 120.0, 58.0, 120.0, 50.0, 180.0, 67.0, 80.0, 19.0, 80.0, 120.0, 90.0, 90.0, 90.0, 120.0, 80.0, 50.0, 140.0, 30.0, 23.0, 0.0, 60.0, 100.0, 24.0, 70.0, 59.0, 90.0, 13.0, 70.0, 301.0, 100.0, 200.0, 50.0, 39.0, 100.0, 70.0, 140.0, 60.0, 40.0, 35.0, 8.0, 116.0, 110.0, 60.0, 210.0, 50.0, 38.0, 50.0, 70.0, 130.0, 110.0, 90.0, 50.0, 140.0, 90.0, 190.0, 30.0, 150.0, 70.0, 200.0, 114.0, 140.0, 60.0, 80.0, 160.0, 60.0, -99.0, 160.0, 120.0, 70.0, 80.0, 100.0, 90.0, 170.0, 85.0, 150.0, 70.0, 20.0, 120.0, 110.0, 70.0, 102.0, 210.0, 110.0, 110.0, 85.0, 106.0, 47.0, 97.0, 100.0, 90.0, 110.0, 110.0, 110.0, 80.0, 190.0, 120.0, 70.0, 80.0, 90.0, 110.0, 150.0, 110.0, 50.0, 140.0, 110.0, 210.0, 120.0, 120.0, 110.0, 70.0, 50.0, 80.0, 180.0, 70.0, 70.0, 105.0, 260.0, 90.0, 300.0, 30.0, 114.0, 172.0, 60.0, 120.0, 86.0, 180.0, 110.0, 150.0, 128.0, 130.0, 110.0, 89.0, 81.0, 90.0, 120.0, 168.0, 80.0, 140.0, 60.0, 40.0, 72.0, 150.0, 98.0, 180.0, 110.0, 100.0, 60.0, 75.0, 140.0, 110.0, 80.0, 100.0, 200.0, 100.0, -25.0, 80.0, 140.0, 120.0, 120.0, 229.0, 140.0, 130.0, 100.0, 160.0, 30.0, 206.0, 230.0, 240.0, 100.0, 110.0, 110.0, 200.0, 80.0, 110.0, 65.0, 40.0, 155.0, 65.0, 90.0, 50.0, 120.0, 130.0, 69.0, 9.0, 18.0, 37.0, 50.0, 70.0, 180.0, 160.0, 180.0, 80.0, 170.0, 120.0, 190.0, 180.0, 180.0, 220.0, 100.0, 80.0, 120.0, 100.0, 110.0, 60.0, 80.0, 170.0, 140.0, 100.0, 50.0, 120.0, 70.0, 50.0, 120.0, 140.0, 130.0, 10.0, 100.0, 60.0, 109.0, 150.0, 70.0, 50.0, 60.0, 110.0, 120.0, 160.0, 130.0, 220.0, 70.0, 130.0, 50.0, 60.0, 15.0, 80.0, 30.0, 150.0, 130.0, -2.0, 110.0, 180.0, 110.0, 80.0, 110.0, 131.0, 81.0, 100.0, 150.0, 60.0, 210.0, 60.0, 70.0, 79.0, 30.0, 30.0, 0.0, 50.0, 100.0, 28.0, 70.0, 50.0, 130.0, 220.0, 58.0, 52.0, 10.0, 60.0, 157.0, -8.0, 18.0, 0.0, 40.0, 10.0, 10.0, 30.0, 40.0, 4.0, 20.0, 10.0, 75.0, 80.0, 114.0, 40.0, 100.0, 50.0, 150.0, 96.0, 80.0, 180.0, 80.0, 100.0, 110.0, 110.0, 59.0, 150.0, 80.0, 89.0, 120.0, 69.0, 190.0, 70.0, 130.0, 120.0, 70.0, 35.0, 109.0, 70.0, 105.0, 40.0, 89.0, 100.0, 130.0, 80.0, 110.0, 90.0, 150.0, 69.0, 40.0, 168.0, 34.0, 50.0, 110.0, 140.0, 187.0, 110.0, 120.0, 60.0, 65.0, 100.0, 70.0, 54.0, 30.0, 130.0, 108.0, 70.0, 150.0, 140.0, 40.0, 60.0, 140.0, 110.0, 180.0, 70.0, 60.0, 90.0, 60.0, 170.0, 50.0, 50.0, 110.0, 90.0, 120.0, 70.0, 130.0, 98.0, 90.0, 56.0, 260.0, 140.0, 130.0, 110.0, 100.0, 170.0, 100.0, 70.0, 100.0, 120.0, 70.0, 90.0, 100.0, 160.0, 40.0, 35.0, 40.0, 120.0, 30.0, 40.0, 40.0, 70.0, 80.0, 102.0, 120.0, 102.0, 170.0, 120.0, 76.0, 210.0, 69.0, 34.0, 120.0, 90.0, 165.0, 170.0, 130.0, 180.0, 120.0, 83.0, 120.0, 100.0, 50.0, 80.0, 30.0, 130.0, 60.0, 110.0, 130.0, 90.0, 160.0, 120.0, 106.0, 90.0, 110.0, 90.0, 80.0, 48.0, 100.0, 20.0, 21.0, 60.0, 100.0, 110.0, 120.0, 130.0, 30.0, 50.0, 60.0, 60.0, 50.0, 90.0, 210.0, 17.0, 150.0, 100.0, 80.0, 25.0, 150.0, 30.0, 95.0, 90.0, 110.0, 190.0, 69.0, -6.0, 120.0, 33.0, 150.0, 166.0, 70.0, 130.0, 100.0, 10.0, 70.0, 0.0, 20.0, 50.0, 200.0, 50.0, 30.0, 60.0, 70.0, 80.0, 70.0, 90.0, 130.0, 70.0, 100.0, 138.0, 80.0, 66.0, 70.0, 90.0, 120.0, 70.0, 34.0, 110.0, 70.0, 80.0, 110.0, 210.0, 70.0, 110.0, 80.0, 90.0, 70.0, 130.0, 110.0, 110.0, 80.0, 80.0, 76.0, 55.0, 90.0, 160.0, 100.0, 73.0, 70.0, 30.0, 110.0, 110.0, 100.0, 100.0, 140.0, 30.0, 90.0, 150.0, 60.0, 50.0, 19.0, 130.0, 80.0, 40.0, 90.0, 180.0, 75.0, 57.0, 212.0, 50.0, 24.0, 110.0, 50.0, 9.0, 190.0, 90.0, 190.0, 60.0, 21.0, 160.0, 130.0, 100.0, 80.0, 110.0, 60.0, 110.0, 40.0, 120.0, 150.0, 80.0, 80.0, 110.0, 80.0, 60.0, 80.0, 70.0, 66.0, 130.0, 46.0, 120.0, 120.0, 140.0, 70.0, 115.0, 120.0, 10.0, 90.0, 60.0, 160.0, 180.0, 30.0, 30.0, 90.0, 0.0, 71.0, 100.0, 57.0, 100.0, 35.0, 120.0, 28.0, -5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6140713310702524, "mean_inference_ms": 1.6121866208435143, "mean_action_processing_ms": 0.5013823943975629, "mean_env_wait_ms": 1.1166473576875404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011685848236083984, "StateBufferConnector_ms": 0.036055803298950195, "ViewRequirementAgentConnector_ms": 0.36983299255371094}, "num_episodes": 23, "episode_return_max": 1660.0, "episode_return_min": 182.0, "episode_return_mean": 959.43}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.601799058258294, "num_env_steps_trained_throughput_per_sec": 20.601799058258294, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 5560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5560000, "timers": {"training_iteration_time_ms": 193445.412, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193445.364, "sample_time_ms": 2606.334, "learn_time_ms": 190818.873, "learn_throughput": 20.962, "synch_weights_time_ms": 12.08}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "done": false, "training_iteration": 139, "trial_id": "1841f_00000", "date": "2024-08-08_07-11-25", "timestamp": 1723115485, "time_this_iter_s": 194.16945886611938, "time_total_s": 28268.159521579742, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b294dc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28268.159521579742, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 17.861313868613138, "ram_util_percent": 78.50401459854014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.110391439924352, "cur_kl_coeff": 0.5406097412109376, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.01504342579379523, "vf_loss": 8.36921864175441, "vf_explained_var": -0.009758301728322738, "kl": Infinity, "entropy": 0.5278577001584859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1309905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 182.0, "episode_reward_mean": 961.01, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -99.0}, "policy_reward_max": {"policy_0": 301.0}, "policy_reward_mean": {"policy_0": 96.101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1217.0, 948.0, 880.0, 1199.0, 739.0, 836.0, 1079.0, 773.0, 1120.0, 975.0, 838.0, 261.0, 954.0, 1490.0, 706.0, 1110.0, 1260.0, 948.0, 1292.0, 905.0, 1075.0, 1089.0, 1303.0, 857.0, 940.0, 874.0, 890.0, 509.0, 1100.0, 747.0, 1050.0, 995.0, 955.0, 1047.0, 1060.0, 1210.0, 1085.0, 1322.0, 1136.0, 945.0, 1045.0, 1585.0, 1035.0, 643.0, 1660.0, 1060.0, 850.0, 1179.0, 713.0, 1112.0, 657.0, 799.0, 182.0, 965.0, 967.0, 939.0, 1026.0, 976.0, 852.0, 980.0, 1164.0, 1060.0, 675.0, 1083.0, 1278.0, 960.0, 725.0, 800.0, 947.0, 1032.0, 590.0, 894.0, 964.0, 930.0, 874.0, 869.0, 918.0, 1000.0, 940.0, 912.0, 865.0, 596.0, 1005.0, 1207.0, 834.0, 1159.0, 859.0, 770.0, 791.0, 910.0, 1071.0, 919.0, 898.0, 877.0, 583.0, 973.0, 973.0, 1534.0, 608.0, 1110.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 80.0, 130.0, 234.0, 100.0, 120.0, 160.0, 53.0, 90.0, 110.0, 180.0, 100.0, 80.0, 69.0, 100.0, 120.0, 29.0, 100.0, 30.0, 140.0, 60.0, 80.0, 120.0, 70.0, 40.0, 100.0, 70.0, 100.0, 160.0, 80.0, 90.0, 60.0, 102.0, 162.0, 160.0, 135.0, 100.0, 90.0, 140.0, 160.0, 130.0, 58.0, 5.0, 40.0, 59.0, 110.0, 100.0, 110.0, 88.0, 39.0, 200.0, 80.0, 126.0, 40.0, 40.0, 100.0, 20.0, 130.0, 60.0, 40.0, 110.0, 130.0, 60.0, 110.0, 100.0, 100.0, 20.0, 60.0, 219.0, 170.0, 90.0, 70.0, 80.0, 80.0, 90.0, 163.0, 50.0, 60.0, 80.0, 10.0, 180.0, 185.0, 115.0, 50.0, 220.0, 40.0, 80.0, 110.0, 80.0, 60.0, 90.0, 100.0, 70.0, 25.0, 240.0, 50.0, 50.0, 70.0, 50.0, 230.0, 50.0, 50.0, 50.0, 120.0, 80.0, 50.0, 120.0, 140.0, 140.0, 38.0, -8.0, 40.0, 20.0, -3.0, 40.0, 60.0, -6.0, 39.0, 50.0, 29.0, 80.0, 130.0, 129.0, 35.0, 150.0, 100.0, 70.0, 120.0, 120.0, 20.0, 130.0, 130.0, 120.0, 250.0, 130.0, 160.0, 230.0, 130.0, 110.0, 100.0, 80.0, 140.0, 64.0, 80.0, 30.0, 62.0, 13.0, 90.0, 110.0, 37.0, 110.0, 40.0, 70.0, 110.0, 140.0, 230.0, 120.0, 170.0, 80.0, 40.0, 70.0, 100.0, 130.0, 90.0, 180.0, 110.0, 70.0, 130.0, 220.0, 160.0, 70.0, 80.0, 0.0, 52.0, 80.0, 200.0, 160.0, 66.0, 50.0, 190.0, 80.0, 60.0, 166.0, 200.0, 140.0, 110.0, 56.0, 180.0, 160.0, 140.0, 200.0, 110.0, 110.0, 30.0, 25.0, 20.0, 100.0, 120.0, 40.0, 150.0, 150.0, 40.0, 150.0, 80.0, 25.0, 150.0, 130.0, 140.0, 90.0, 120.0, 250.0, 110.0, 219.0, 80.0, 80.0, 45.0, 50.0, 90.0, 50.0, 115.0, 80.0, 94.0, 190.0, 150.0, 100.0, 200.0, 140.0, 99.0, 120.0, 130.0, 80.0, 20.0, 59.0, 100.0, 160.0, 50.0, 138.0, 130.0, 110.0, 10.0, 60.0, 70.0, 120.0, 100.0, 100.0, 60.0, 80.0, 70.0, 110.0, 170.0, 90.0, 90.0, 120.0, 58.0, 120.0, 50.0, 180.0, 67.0, 80.0, 19.0, 80.0, 120.0, 90.0, 90.0, 90.0, 120.0, 80.0, 50.0, 140.0, 30.0, 23.0, 0.0, 60.0, 100.0, 24.0, 70.0, 59.0, 90.0, 13.0, 70.0, 301.0, 100.0, 200.0, 50.0, 39.0, 100.0, 70.0, 140.0, 60.0, 40.0, 35.0, 8.0, 116.0, 110.0, 60.0, 210.0, 50.0, 38.0, 50.0, 70.0, 130.0, 110.0, 90.0, 50.0, 140.0, 90.0, 190.0, 30.0, 150.0, 70.0, 200.0, 114.0, 140.0, 60.0, 80.0, 160.0, 60.0, -99.0, 160.0, 120.0, 70.0, 80.0, 100.0, 90.0, 170.0, 85.0, 150.0, 70.0, 20.0, 120.0, 110.0, 70.0, 102.0, 210.0, 110.0, 110.0, 85.0, 106.0, 47.0, 97.0, 100.0, 90.0, 110.0, 110.0, 110.0, 80.0, 190.0, 120.0, 70.0, 80.0, 90.0, 110.0, 150.0, 110.0, 50.0, 140.0, 110.0, 210.0, 120.0, 120.0, 110.0, 70.0, 50.0, 80.0, 180.0, 70.0, 70.0, 105.0, 260.0, 90.0, 300.0, 30.0, 114.0, 172.0, 60.0, 120.0, 86.0, 180.0, 110.0, 150.0, 128.0, 130.0, 110.0, 89.0, 81.0, 90.0, 120.0, 168.0, 80.0, 140.0, 60.0, 40.0, 72.0, 150.0, 98.0, 180.0, 110.0, 100.0, 60.0, 75.0, 140.0, 110.0, 80.0, 100.0, 200.0, 100.0, -25.0, 80.0, 140.0, 120.0, 120.0, 229.0, 140.0, 130.0, 100.0, 160.0, 30.0, 206.0, 230.0, 240.0, 100.0, 110.0, 110.0, 200.0, 80.0, 110.0, 65.0, 40.0, 155.0, 65.0, 90.0, 50.0, 120.0, 130.0, 69.0, 9.0, 18.0, 37.0, 50.0, 70.0, 180.0, 160.0, 180.0, 80.0, 170.0, 120.0, 190.0, 180.0, 180.0, 220.0, 100.0, 80.0, 120.0, 100.0, 110.0, 60.0, 80.0, 170.0, 140.0, 100.0, 50.0, 120.0, 70.0, 50.0, 120.0, 140.0, 130.0, 10.0, 100.0, 60.0, 109.0, 150.0, 70.0, 50.0, 60.0, 110.0, 120.0, 160.0, 130.0, 220.0, 70.0, 130.0, 50.0, 60.0, 15.0, 80.0, 30.0, 150.0, 130.0, -2.0, 110.0, 180.0, 110.0, 80.0, 110.0, 131.0, 81.0, 100.0, 150.0, 60.0, 210.0, 60.0, 70.0, 79.0, 30.0, 30.0, 0.0, 50.0, 100.0, 28.0, 70.0, 50.0, 130.0, 220.0, 58.0, 52.0, 10.0, 60.0, 157.0, -8.0, 18.0, 0.0, 40.0, 10.0, 10.0, 30.0, 40.0, 4.0, 20.0, 10.0, 75.0, 80.0, 114.0, 40.0, 100.0, 50.0, 150.0, 96.0, 80.0, 180.0, 80.0, 100.0, 110.0, 110.0, 59.0, 150.0, 80.0, 89.0, 120.0, 69.0, 190.0, 70.0, 130.0, 120.0, 70.0, 35.0, 109.0, 70.0, 105.0, 40.0, 89.0, 100.0, 130.0, 80.0, 110.0, 90.0, 150.0, 69.0, 40.0, 168.0, 34.0, 50.0, 110.0, 140.0, 187.0, 110.0, 120.0, 60.0, 65.0, 100.0, 70.0, 54.0, 30.0, 130.0, 108.0, 70.0, 150.0, 140.0, 40.0, 60.0, 140.0, 110.0, 180.0, 70.0, 60.0, 90.0, 60.0, 170.0, 50.0, 50.0, 110.0, 90.0, 120.0, 70.0, 130.0, 98.0, 90.0, 56.0, 260.0, 140.0, 130.0, 110.0, 100.0, 170.0, 100.0, 70.0, 100.0, 120.0, 70.0, 90.0, 100.0, 160.0, 40.0, 35.0, 40.0, 120.0, 30.0, 40.0, 40.0, 70.0, 80.0, 102.0, 120.0, 102.0, 170.0, 120.0, 76.0, 210.0, 69.0, 34.0, 120.0, 90.0, 165.0, 170.0, 130.0, 180.0, 120.0, 83.0, 120.0, 100.0, 50.0, 80.0, 30.0, 130.0, 60.0, 110.0, 130.0, 90.0, 160.0, 120.0, 106.0, 90.0, 110.0, 90.0, 80.0, 48.0, 100.0, 20.0, 21.0, 60.0, 100.0, 110.0, 120.0, 130.0, 30.0, 50.0, 60.0, 60.0, 50.0, 90.0, 210.0, 17.0, 150.0, 100.0, 80.0, 25.0, 150.0, 30.0, 95.0, 90.0, 110.0, 190.0, 69.0, -6.0, 120.0, 33.0, 150.0, 166.0, 70.0, 130.0, 100.0, 10.0, 70.0, 0.0, 20.0, 50.0, 200.0, 50.0, 30.0, 60.0, 70.0, 80.0, 70.0, 90.0, 130.0, 70.0, 100.0, 138.0, 80.0, 66.0, 70.0, 90.0, 120.0, 70.0, 34.0, 110.0, 70.0, 80.0, 110.0, 210.0, 70.0, 110.0, 80.0, 90.0, 70.0, 130.0, 110.0, 110.0, 80.0, 80.0, 76.0, 55.0, 90.0, 160.0, 100.0, 73.0, 70.0, 30.0, 110.0, 110.0, 100.0, 100.0, 140.0, 30.0, 90.0, 150.0, 60.0, 50.0, 19.0, 130.0, 80.0, 40.0, 90.0, 180.0, 75.0, 57.0, 212.0, 50.0, 24.0, 110.0, 50.0, 9.0, 190.0, 90.0, 190.0, 60.0, 21.0, 160.0, 130.0, 100.0, 80.0, 110.0, 60.0, 110.0, 40.0, 120.0, 150.0, 80.0, 80.0, 110.0, 80.0, 60.0, 80.0, 70.0, 66.0, 130.0, 46.0, 120.0, 120.0, 140.0, 70.0, 115.0, 120.0, 10.0, 90.0, 60.0, 160.0, 180.0, 30.0, 30.0, 90.0, 0.0, 71.0, 100.0, 57.0, 100.0, 35.0, 120.0, 28.0, -5.0, 260.0, 70.0, 110.0, 134.0, 60.0, 30.0, 11.0, 190.0, 60.0, 80.0, 100.0, 100.0, 140.0, 140.0, 100.0, 208.0, 110.0, 40.0, 109.0, 160.0, 70.0, 70.0, 5.0, 110.0, 60.0, 79.0, 100.0, 100.0, 130.0, 110.0, 100.0, 120.0, 95.0, 50.0, 180.0, 104.0, 100.0, 230.0, 100.0, 80.0, 120.0, 100.0, 100.0, 46.0, 100.0, 100.0, 160.0, 30.0, 120.0, -17.0, 70.0, 34.0, 9.0, 80.0, 190.0, 60.0, 130.0, 34.0, 23.0, 140.0, 50.0, 100.0, 120.0, 100.0, 95.0, 90.0, 80.0, 60.0, 86.0, 10.0, 50.0, 50.0, 200.0, 60.0, 40.0, 60.0, 20.0, 120.0, 240.0, 70.0, 196.0, 55.0, 65.0, 100.0, 75.0, 140.0, 31.0, 180.0, 149.0, 80.0, 159.0, 20.0, 70.0, 20.0, 90.0, 100.0, 80.0, 230.0, 100.0, 50.0, 64.0, 140.0, 110.0, 180.0, 30.0, 60.0, 130.0, 15.0, 70.0, 99.0, 30.0, 70.0, 150.0, 60.0, 130.0, 120.0, 90.0, 110.0, 73.0, 44.0, 50.0, 80.0, 22.0, 80.0, 75.0, 25.0, 70.0, -9.0, 150.0, 40.0, 120.0, 90.0, 250.0, 30.0, 41.0, 60.0, 32.0, 130.0, 120.0, 100.0, 130.0, 106.0, 90.0, 130.0, 60.0, 70.0, 120.0, 87.0, 100.0, 80.0, 240.0, 280.0, 60.0, 180.0, 90.0, 106.0, 160.0, 160.0, 130.0, 128.0, 40.0, 80.0, 180.0, 22.0, 20.0, 10.0, 20.0, 130.0, 76.0, 30.0, 150.0, 130.0, 80.0, 140.0, 100.0, 50.0, 70.0, 100.0, 210.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6129550205437386, "mean_inference_ms": 1.6111908988641381, "mean_action_processing_ms": 0.5010358299090787, "mean_env_wait_ms": 1.1160721296052036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011729001998901367, "StateBufferConnector_ms": 0.03161215782165527, "ViewRequirementAgentConnector_ms": 0.36507296562194824}, "num_episodes": 18, "episode_return_max": 1660.0, "episode_return_min": 182.0, "episode_return_mean": 961.01}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.709106754107914, "num_env_steps_trained_throughput_per_sec": 20.709106754107914, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 5600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5600000, "timers": {"training_iteration_time_ms": 193518.576, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193518.528, "sample_time_ms": 2616.966, "learn_time_ms": 190881.142, "learn_throughput": 20.955, "synch_weights_time_ms": 12.375}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "done": false, "training_iteration": 140, "trial_id": "1841f_00000", "date": "2024-08-08_07-14-38", "timestamp": 1723115678, "time_this_iter_s": 193.16122221946716, "time_total_s": 28461.32074379921, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b294d670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28461.32074379921, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 17.073260073260073, "ram_util_percent": 78.51062271062271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.231601887700149, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.014503051051091407, "vf_loss": 8.60863277625225, "vf_explained_var": -0.03117041083824393, "kl": Infinity, "entropy": 0.4911873405765548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1319295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 182.0, "episode_reward_mean": 971.43, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -99.0}, "policy_reward_max": {"policy_0": 301.0}, "policy_reward_mean": {"policy_0": 97.143}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1303.0, 857.0, 940.0, 874.0, 890.0, 509.0, 1100.0, 747.0, 1050.0, 995.0, 955.0, 1047.0, 1060.0, 1210.0, 1085.0, 1322.0, 1136.0, 945.0, 1045.0, 1585.0, 1035.0, 643.0, 1660.0, 1060.0, 850.0, 1179.0, 713.0, 1112.0, 657.0, 799.0, 182.0, 965.0, 967.0, 939.0, 1026.0, 976.0, 852.0, 980.0, 1164.0, 1060.0, 675.0, 1083.0, 1278.0, 960.0, 725.0, 800.0, 947.0, 1032.0, 590.0, 894.0, 964.0, 930.0, 874.0, 869.0, 918.0, 1000.0, 940.0, 912.0, 865.0, 596.0, 1005.0, 1207.0, 834.0, 1159.0, 859.0, 770.0, 791.0, 910.0, 1071.0, 919.0, 898.0, 877.0, 583.0, 973.0, 973.0, 1534.0, 608.0, 1110.0, 884.0, 1038.0, 1231.0, 1010.0, 1165.0, 1050.0, 960.0, 935.0, 1360.0, 1005.0, 1171.0, 976.0, 1005.0, 860.0, 1013.0, 967.0, 1046.0, 733.0, 1238.0, 703.0, 1126.0, 1260.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 94.0, 190.0, 150.0, 100.0, 200.0, 140.0, 99.0, 120.0, 130.0, 80.0, 20.0, 59.0, 100.0, 160.0, 50.0, 138.0, 130.0, 110.0, 10.0, 60.0, 70.0, 120.0, 100.0, 100.0, 60.0, 80.0, 70.0, 110.0, 170.0, 90.0, 90.0, 120.0, 58.0, 120.0, 50.0, 180.0, 67.0, 80.0, 19.0, 80.0, 120.0, 90.0, 90.0, 90.0, 120.0, 80.0, 50.0, 140.0, 30.0, 23.0, 0.0, 60.0, 100.0, 24.0, 70.0, 59.0, 90.0, 13.0, 70.0, 301.0, 100.0, 200.0, 50.0, 39.0, 100.0, 70.0, 140.0, 60.0, 40.0, 35.0, 8.0, 116.0, 110.0, 60.0, 210.0, 50.0, 38.0, 50.0, 70.0, 130.0, 110.0, 90.0, 50.0, 140.0, 90.0, 190.0, 30.0, 150.0, 70.0, 200.0, 114.0, 140.0, 60.0, 80.0, 160.0, 60.0, -99.0, 160.0, 120.0, 70.0, 80.0, 100.0, 90.0, 170.0, 85.0, 150.0, 70.0, 20.0, 120.0, 110.0, 70.0, 102.0, 210.0, 110.0, 110.0, 85.0, 106.0, 47.0, 97.0, 100.0, 90.0, 110.0, 110.0, 110.0, 80.0, 190.0, 120.0, 70.0, 80.0, 90.0, 110.0, 150.0, 110.0, 50.0, 140.0, 110.0, 210.0, 120.0, 120.0, 110.0, 70.0, 50.0, 80.0, 180.0, 70.0, 70.0, 105.0, 260.0, 90.0, 300.0, 30.0, 114.0, 172.0, 60.0, 120.0, 86.0, 180.0, 110.0, 150.0, 128.0, 130.0, 110.0, 89.0, 81.0, 90.0, 120.0, 168.0, 80.0, 140.0, 60.0, 40.0, 72.0, 150.0, 98.0, 180.0, 110.0, 100.0, 60.0, 75.0, 140.0, 110.0, 80.0, 100.0, 200.0, 100.0, -25.0, 80.0, 140.0, 120.0, 120.0, 229.0, 140.0, 130.0, 100.0, 160.0, 30.0, 206.0, 230.0, 240.0, 100.0, 110.0, 110.0, 200.0, 80.0, 110.0, 65.0, 40.0, 155.0, 65.0, 90.0, 50.0, 120.0, 130.0, 69.0, 9.0, 18.0, 37.0, 50.0, 70.0, 180.0, 160.0, 180.0, 80.0, 170.0, 120.0, 190.0, 180.0, 180.0, 220.0, 100.0, 80.0, 120.0, 100.0, 110.0, 60.0, 80.0, 170.0, 140.0, 100.0, 50.0, 120.0, 70.0, 50.0, 120.0, 140.0, 130.0, 10.0, 100.0, 60.0, 109.0, 150.0, 70.0, 50.0, 60.0, 110.0, 120.0, 160.0, 130.0, 220.0, 70.0, 130.0, 50.0, 60.0, 15.0, 80.0, 30.0, 150.0, 130.0, -2.0, 110.0, 180.0, 110.0, 80.0, 110.0, 131.0, 81.0, 100.0, 150.0, 60.0, 210.0, 60.0, 70.0, 79.0, 30.0, 30.0, 0.0, 50.0, 100.0, 28.0, 70.0, 50.0, 130.0, 220.0, 58.0, 52.0, 10.0, 60.0, 157.0, -8.0, 18.0, 0.0, 40.0, 10.0, 10.0, 30.0, 40.0, 4.0, 20.0, 10.0, 75.0, 80.0, 114.0, 40.0, 100.0, 50.0, 150.0, 96.0, 80.0, 180.0, 80.0, 100.0, 110.0, 110.0, 59.0, 150.0, 80.0, 89.0, 120.0, 69.0, 190.0, 70.0, 130.0, 120.0, 70.0, 35.0, 109.0, 70.0, 105.0, 40.0, 89.0, 100.0, 130.0, 80.0, 110.0, 90.0, 150.0, 69.0, 40.0, 168.0, 34.0, 50.0, 110.0, 140.0, 187.0, 110.0, 120.0, 60.0, 65.0, 100.0, 70.0, 54.0, 30.0, 130.0, 108.0, 70.0, 150.0, 140.0, 40.0, 60.0, 140.0, 110.0, 180.0, 70.0, 60.0, 90.0, 60.0, 170.0, 50.0, 50.0, 110.0, 90.0, 120.0, 70.0, 130.0, 98.0, 90.0, 56.0, 260.0, 140.0, 130.0, 110.0, 100.0, 170.0, 100.0, 70.0, 100.0, 120.0, 70.0, 90.0, 100.0, 160.0, 40.0, 35.0, 40.0, 120.0, 30.0, 40.0, 40.0, 70.0, 80.0, 102.0, 120.0, 102.0, 170.0, 120.0, 76.0, 210.0, 69.0, 34.0, 120.0, 90.0, 165.0, 170.0, 130.0, 180.0, 120.0, 83.0, 120.0, 100.0, 50.0, 80.0, 30.0, 130.0, 60.0, 110.0, 130.0, 90.0, 160.0, 120.0, 106.0, 90.0, 110.0, 90.0, 80.0, 48.0, 100.0, 20.0, 21.0, 60.0, 100.0, 110.0, 120.0, 130.0, 30.0, 50.0, 60.0, 60.0, 50.0, 90.0, 210.0, 17.0, 150.0, 100.0, 80.0, 25.0, 150.0, 30.0, 95.0, 90.0, 110.0, 190.0, 69.0, -6.0, 120.0, 33.0, 150.0, 166.0, 70.0, 130.0, 100.0, 10.0, 70.0, 0.0, 20.0, 50.0, 200.0, 50.0, 30.0, 60.0, 70.0, 80.0, 70.0, 90.0, 130.0, 70.0, 100.0, 138.0, 80.0, 66.0, 70.0, 90.0, 120.0, 70.0, 34.0, 110.0, 70.0, 80.0, 110.0, 210.0, 70.0, 110.0, 80.0, 90.0, 70.0, 130.0, 110.0, 110.0, 80.0, 80.0, 76.0, 55.0, 90.0, 160.0, 100.0, 73.0, 70.0, 30.0, 110.0, 110.0, 100.0, 100.0, 140.0, 30.0, 90.0, 150.0, 60.0, 50.0, 19.0, 130.0, 80.0, 40.0, 90.0, 180.0, 75.0, 57.0, 212.0, 50.0, 24.0, 110.0, 50.0, 9.0, 190.0, 90.0, 190.0, 60.0, 21.0, 160.0, 130.0, 100.0, 80.0, 110.0, 60.0, 110.0, 40.0, 120.0, 150.0, 80.0, 80.0, 110.0, 80.0, 60.0, 80.0, 70.0, 66.0, 130.0, 46.0, 120.0, 120.0, 140.0, 70.0, 115.0, 120.0, 10.0, 90.0, 60.0, 160.0, 180.0, 30.0, 30.0, 90.0, 0.0, 71.0, 100.0, 57.0, 100.0, 35.0, 120.0, 28.0, -5.0, 260.0, 70.0, 110.0, 134.0, 60.0, 30.0, 11.0, 190.0, 60.0, 80.0, 100.0, 100.0, 140.0, 140.0, 100.0, 208.0, 110.0, 40.0, 109.0, 160.0, 70.0, 70.0, 5.0, 110.0, 60.0, 79.0, 100.0, 100.0, 130.0, 110.0, 100.0, 120.0, 95.0, 50.0, 180.0, 104.0, 100.0, 230.0, 100.0, 80.0, 120.0, 100.0, 100.0, 46.0, 100.0, 100.0, 160.0, 30.0, 120.0, -17.0, 70.0, 34.0, 9.0, 80.0, 190.0, 60.0, 130.0, 34.0, 23.0, 140.0, 50.0, 100.0, 120.0, 100.0, 95.0, 90.0, 80.0, 60.0, 86.0, 10.0, 50.0, 50.0, 200.0, 60.0, 40.0, 60.0, 20.0, 120.0, 240.0, 70.0, 196.0, 55.0, 65.0, 100.0, 75.0, 140.0, 31.0, 180.0, 149.0, 80.0, 159.0, 20.0, 70.0, 20.0, 90.0, 100.0, 80.0, 230.0, 100.0, 50.0, 64.0, 140.0, 110.0, 180.0, 30.0, 60.0, 130.0, 15.0, 70.0, 99.0, 30.0, 70.0, 150.0, 60.0, 130.0, 120.0, 90.0, 110.0, 73.0, 44.0, 50.0, 80.0, 22.0, 80.0, 75.0, 25.0, 70.0, -9.0, 150.0, 40.0, 120.0, 90.0, 250.0, 30.0, 41.0, 60.0, 32.0, 130.0, 120.0, 100.0, 130.0, 106.0, 90.0, 130.0, 60.0, 70.0, 120.0, 87.0, 100.0, 80.0, 240.0, 280.0, 60.0, 180.0, 90.0, 106.0, 160.0, 160.0, 130.0, 128.0, 40.0, 80.0, 180.0, 22.0, 20.0, 10.0, 20.0, 130.0, 76.0, 30.0, 150.0, 130.0, 80.0, 140.0, 100.0, 50.0, 70.0, 100.0, 210.0, 80.0, 2.0, 120.0, 100.0, 70.0, 180.0, 28.0, 120.0, 160.0, 64.0, 40.0, 120.0, 50.0, 130.0, 180.0, 240.0, 6.0, 5.0, 60.0, 47.0, 200.0, 100.0, 140.0, 130.0, 101.0, 83.0, 130.0, 87.0, 240.0, 110.0, 110.0, 100.0, 50.0, 280.0, 110.0, 80.0, 80.0, 60.0, 60.0, 90.0, 100.0, 90.0, 180.0, 80.0, 70.0, 70.0, 160.0, 210.0, 150.0, 75.0, 80.0, 130.0, 81.0, 67.0, 21.0, 110.0, 90.0, 202.0, 80.0, 89.0, 180.0, 30.0, 100.0, 70.0, 110.0, 110.0, 90.0, 130.0, 60.0, 150.0, 110.0, 110.0, 80.0, 40.0, 80.0, 130.0, 25.0, 140.0, 70.0, 130.0, 130.0, 70.0, 180.0, 90.0, 200.0, 100.0, 150.0, 150.0, 140.0, 140.0, 140.0, 90.0, 80.0, 100.0, 70.0, 110.0, 260.0, 110.0, 40.0, 115.0, 30.0, 33.0, 80.0, 80.0, 210.0, 210.0, 140.0, 60.0, 85.0, 180.0, 93.0, 235.0, 160.0, 13.0, 30.0, 130.0, 71.0, 40.0, 90.0, 107.0, 100.0, 50.0, 60.0, 150.0, 130.0, 30.0, 70.0, 195.0, 100.0, 120.0, 100.0, 89.0, 130.0, 33.0, 148.0, 100.0, 57.0, 80.0, -47.0, 130.0, 140.0, 90.0, 40.0, 103.0, 50.0, 140.0, 200.0, 110.0, 80.0, 50.0, 150.0, 120.0, 250.0, 30.0, 93.0, 70.0, 60.0, 130.0, 90.0, 60.0, 64.0, 90.0, 90.0, 70.0, 80.0, 90.0, 109.0, 140.0, 140.0, 137.0, 100.0, 20.0, 110.0, 70.0, 40.0, 120.0, 100.0, 100.0, 10.0, 150.0, 13.0, 80.0, 100.0, 100.0, 160.0, 80.0, 90.0, 110.0, 120.0, 260.0, 138.0, 120.0, 70.0, 200.0, 40.0, 48.0, -25.0, 40.0, 90.0, 60.0, 60.0, 70.0, 100.0, 88.0, 80.0, 140.0, 150.0, 110.0, 90.0, 128.0, 170.0, 190.0, 110.0, 90.0, 100.0, 140.0, 90.0, 140.0, 180.0, 120.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6117779340214637, "mean_inference_ms": 1.6099123739624377, "mean_action_processing_ms": 0.5006097912733704, "mean_env_wait_ms": 1.11541040268602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013556480407714844, "StateBufferConnector_ms": 0.03154397010803223, "ViewRequirementAgentConnector_ms": 0.3751511573791504}, "num_episodes": 22, "episode_return_max": 1660.0, "episode_return_min": 182.0, "episode_return_mean": 971.43}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.672035462480025, "num_env_steps_trained_throughput_per_sec": 20.672035462480025, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 5640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5640000, "timers": {"training_iteration_time_ms": 193502.378, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193502.33, "sample_time_ms": 2625.474, "learn_time_ms": 190856.77, "learn_throughput": 20.958, "synch_weights_time_ms": 12.016}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "done": false, "training_iteration": 141, "trial_id": "1841f_00000", "date": "2024-08-08_07-17-52", "timestamp": 1723115872, "time_this_iter_s": 193.5089259147644, "time_total_s": 28654.829669713974, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2947c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28654.829669713974, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 16.972627737226276, "ram_util_percent": 77.9992700729927}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2610657009517294, "cur_kl_coeff": 1.2163719177246093, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.013436467355118194, "vf_loss": 8.595144791496448, "vf_explained_var": -0.020266032295105176, "kl": Infinity, "entropy": 0.4972362619270278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1328685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 182.0, "episode_reward_mean": 977.84, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -47.0}, "policy_reward_max": {"policy_0": 300.0}, "policy_reward_mean": {"policy_0": 97.784}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1045.0, 1585.0, 1035.0, 643.0, 1660.0, 1060.0, 850.0, 1179.0, 713.0, 1112.0, 657.0, 799.0, 182.0, 965.0, 967.0, 939.0, 1026.0, 976.0, 852.0, 980.0, 1164.0, 1060.0, 675.0, 1083.0, 1278.0, 960.0, 725.0, 800.0, 947.0, 1032.0, 590.0, 894.0, 964.0, 930.0, 874.0, 869.0, 918.0, 1000.0, 940.0, 912.0, 865.0, 596.0, 1005.0, 1207.0, 834.0, 1159.0, 859.0, 770.0, 791.0, 910.0, 1071.0, 919.0, 898.0, 877.0, 583.0, 973.0, 973.0, 1534.0, 608.0, 1110.0, 884.0, 1038.0, 1231.0, 1010.0, 1165.0, 1050.0, 960.0, 935.0, 1360.0, 1005.0, 1171.0, 976.0, 1005.0, 860.0, 1013.0, 967.0, 1046.0, 733.0, 1238.0, 703.0, 1126.0, 1260.0, 1235.0, 897.0, 829.0, 880.0, 811.0, 1138.0, 1068.0, 950.0, 1058.0, 955.0, 1300.0, 1590.0, 912.0, 1105.0, 1205.0, 856.0, 870.0, 1007.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 110.0, 80.0, 100.0, 200.0, 100.0, -25.0, 80.0, 140.0, 120.0, 120.0, 229.0, 140.0, 130.0, 100.0, 160.0, 30.0, 206.0, 230.0, 240.0, 100.0, 110.0, 110.0, 200.0, 80.0, 110.0, 65.0, 40.0, 155.0, 65.0, 90.0, 50.0, 120.0, 130.0, 69.0, 9.0, 18.0, 37.0, 50.0, 70.0, 180.0, 160.0, 180.0, 80.0, 170.0, 120.0, 190.0, 180.0, 180.0, 220.0, 100.0, 80.0, 120.0, 100.0, 110.0, 60.0, 80.0, 170.0, 140.0, 100.0, 50.0, 120.0, 70.0, 50.0, 120.0, 140.0, 130.0, 10.0, 100.0, 60.0, 109.0, 150.0, 70.0, 50.0, 60.0, 110.0, 120.0, 160.0, 130.0, 220.0, 70.0, 130.0, 50.0, 60.0, 15.0, 80.0, 30.0, 150.0, 130.0, -2.0, 110.0, 180.0, 110.0, 80.0, 110.0, 131.0, 81.0, 100.0, 150.0, 60.0, 210.0, 60.0, 70.0, 79.0, 30.0, 30.0, 0.0, 50.0, 100.0, 28.0, 70.0, 50.0, 130.0, 220.0, 58.0, 52.0, 10.0, 60.0, 157.0, -8.0, 18.0, 0.0, 40.0, 10.0, 10.0, 30.0, 40.0, 4.0, 20.0, 10.0, 75.0, 80.0, 114.0, 40.0, 100.0, 50.0, 150.0, 96.0, 80.0, 180.0, 80.0, 100.0, 110.0, 110.0, 59.0, 150.0, 80.0, 89.0, 120.0, 69.0, 190.0, 70.0, 130.0, 120.0, 70.0, 35.0, 109.0, 70.0, 105.0, 40.0, 89.0, 100.0, 130.0, 80.0, 110.0, 90.0, 150.0, 69.0, 40.0, 168.0, 34.0, 50.0, 110.0, 140.0, 187.0, 110.0, 120.0, 60.0, 65.0, 100.0, 70.0, 54.0, 30.0, 130.0, 108.0, 70.0, 150.0, 140.0, 40.0, 60.0, 140.0, 110.0, 180.0, 70.0, 60.0, 90.0, 60.0, 170.0, 50.0, 50.0, 110.0, 90.0, 120.0, 70.0, 130.0, 98.0, 90.0, 56.0, 260.0, 140.0, 130.0, 110.0, 100.0, 170.0, 100.0, 70.0, 100.0, 120.0, 70.0, 90.0, 100.0, 160.0, 40.0, 35.0, 40.0, 120.0, 30.0, 40.0, 40.0, 70.0, 80.0, 102.0, 120.0, 102.0, 170.0, 120.0, 76.0, 210.0, 69.0, 34.0, 120.0, 90.0, 165.0, 170.0, 130.0, 180.0, 120.0, 83.0, 120.0, 100.0, 50.0, 80.0, 30.0, 130.0, 60.0, 110.0, 130.0, 90.0, 160.0, 120.0, 106.0, 90.0, 110.0, 90.0, 80.0, 48.0, 100.0, 20.0, 21.0, 60.0, 100.0, 110.0, 120.0, 130.0, 30.0, 50.0, 60.0, 60.0, 50.0, 90.0, 210.0, 17.0, 150.0, 100.0, 80.0, 25.0, 150.0, 30.0, 95.0, 90.0, 110.0, 190.0, 69.0, -6.0, 120.0, 33.0, 150.0, 166.0, 70.0, 130.0, 100.0, 10.0, 70.0, 0.0, 20.0, 50.0, 200.0, 50.0, 30.0, 60.0, 70.0, 80.0, 70.0, 90.0, 130.0, 70.0, 100.0, 138.0, 80.0, 66.0, 70.0, 90.0, 120.0, 70.0, 34.0, 110.0, 70.0, 80.0, 110.0, 210.0, 70.0, 110.0, 80.0, 90.0, 70.0, 130.0, 110.0, 110.0, 80.0, 80.0, 76.0, 55.0, 90.0, 160.0, 100.0, 73.0, 70.0, 30.0, 110.0, 110.0, 100.0, 100.0, 140.0, 30.0, 90.0, 150.0, 60.0, 50.0, 19.0, 130.0, 80.0, 40.0, 90.0, 180.0, 75.0, 57.0, 212.0, 50.0, 24.0, 110.0, 50.0, 9.0, 190.0, 90.0, 190.0, 60.0, 21.0, 160.0, 130.0, 100.0, 80.0, 110.0, 60.0, 110.0, 40.0, 120.0, 150.0, 80.0, 80.0, 110.0, 80.0, 60.0, 80.0, 70.0, 66.0, 130.0, 46.0, 120.0, 120.0, 140.0, 70.0, 115.0, 120.0, 10.0, 90.0, 60.0, 160.0, 180.0, 30.0, 30.0, 90.0, 0.0, 71.0, 100.0, 57.0, 100.0, 35.0, 120.0, 28.0, -5.0, 260.0, 70.0, 110.0, 134.0, 60.0, 30.0, 11.0, 190.0, 60.0, 80.0, 100.0, 100.0, 140.0, 140.0, 100.0, 208.0, 110.0, 40.0, 109.0, 160.0, 70.0, 70.0, 5.0, 110.0, 60.0, 79.0, 100.0, 100.0, 130.0, 110.0, 100.0, 120.0, 95.0, 50.0, 180.0, 104.0, 100.0, 230.0, 100.0, 80.0, 120.0, 100.0, 100.0, 46.0, 100.0, 100.0, 160.0, 30.0, 120.0, -17.0, 70.0, 34.0, 9.0, 80.0, 190.0, 60.0, 130.0, 34.0, 23.0, 140.0, 50.0, 100.0, 120.0, 100.0, 95.0, 90.0, 80.0, 60.0, 86.0, 10.0, 50.0, 50.0, 200.0, 60.0, 40.0, 60.0, 20.0, 120.0, 240.0, 70.0, 196.0, 55.0, 65.0, 100.0, 75.0, 140.0, 31.0, 180.0, 149.0, 80.0, 159.0, 20.0, 70.0, 20.0, 90.0, 100.0, 80.0, 230.0, 100.0, 50.0, 64.0, 140.0, 110.0, 180.0, 30.0, 60.0, 130.0, 15.0, 70.0, 99.0, 30.0, 70.0, 150.0, 60.0, 130.0, 120.0, 90.0, 110.0, 73.0, 44.0, 50.0, 80.0, 22.0, 80.0, 75.0, 25.0, 70.0, -9.0, 150.0, 40.0, 120.0, 90.0, 250.0, 30.0, 41.0, 60.0, 32.0, 130.0, 120.0, 100.0, 130.0, 106.0, 90.0, 130.0, 60.0, 70.0, 120.0, 87.0, 100.0, 80.0, 240.0, 280.0, 60.0, 180.0, 90.0, 106.0, 160.0, 160.0, 130.0, 128.0, 40.0, 80.0, 180.0, 22.0, 20.0, 10.0, 20.0, 130.0, 76.0, 30.0, 150.0, 130.0, 80.0, 140.0, 100.0, 50.0, 70.0, 100.0, 210.0, 80.0, 2.0, 120.0, 100.0, 70.0, 180.0, 28.0, 120.0, 160.0, 64.0, 40.0, 120.0, 50.0, 130.0, 180.0, 240.0, 6.0, 5.0, 60.0, 47.0, 200.0, 100.0, 140.0, 130.0, 101.0, 83.0, 130.0, 87.0, 240.0, 110.0, 110.0, 100.0, 50.0, 280.0, 110.0, 80.0, 80.0, 60.0, 60.0, 90.0, 100.0, 90.0, 180.0, 80.0, 70.0, 70.0, 160.0, 210.0, 150.0, 75.0, 80.0, 130.0, 81.0, 67.0, 21.0, 110.0, 90.0, 202.0, 80.0, 89.0, 180.0, 30.0, 100.0, 70.0, 110.0, 110.0, 90.0, 130.0, 60.0, 150.0, 110.0, 110.0, 80.0, 40.0, 80.0, 130.0, 25.0, 140.0, 70.0, 130.0, 130.0, 70.0, 180.0, 90.0, 200.0, 100.0, 150.0, 150.0, 140.0, 140.0, 140.0, 90.0, 80.0, 100.0, 70.0, 110.0, 260.0, 110.0, 40.0, 115.0, 30.0, 33.0, 80.0, 80.0, 210.0, 210.0, 140.0, 60.0, 85.0, 180.0, 93.0, 235.0, 160.0, 13.0, 30.0, 130.0, 71.0, 40.0, 90.0, 107.0, 100.0, 50.0, 60.0, 150.0, 130.0, 30.0, 70.0, 195.0, 100.0, 120.0, 100.0, 89.0, 130.0, 33.0, 148.0, 100.0, 57.0, 80.0, -47.0, 130.0, 140.0, 90.0, 40.0, 103.0, 50.0, 140.0, 200.0, 110.0, 80.0, 50.0, 150.0, 120.0, 250.0, 30.0, 93.0, 70.0, 60.0, 130.0, 90.0, 60.0, 64.0, 90.0, 90.0, 70.0, 80.0, 90.0, 109.0, 140.0, 140.0, 137.0, 100.0, 20.0, 110.0, 70.0, 40.0, 120.0, 100.0, 100.0, 10.0, 150.0, 13.0, 80.0, 100.0, 100.0, 160.0, 80.0, 90.0, 110.0, 120.0, 260.0, 138.0, 120.0, 70.0, 200.0, 40.0, 48.0, -25.0, 40.0, 90.0, 60.0, 60.0, 70.0, 100.0, 88.0, 80.0, 140.0, 150.0, 110.0, 90.0, 128.0, 170.0, 190.0, 110.0, 90.0, 100.0, 140.0, 90.0, 140.0, 180.0, 120.0, 100.0, 190.0, 125.0, 180.0, 80.0, 150.0, 50.0, 140.0, 120.0, 90.0, 110.0, 160.0, 30.0, 110.0, 130.0, 120.0, 60.0, 50.0, 77.0, 80.0, 80.0, 20.0, 50.0, 90.0, 250.0, 120.0, 69.0, 50.0, 60.0, 80.0, 40.0, 90.0, 100.0, 120.0, 70.0, 80.0, 70.0, 140.0, 130.0, 90.0, -10.0, 70.0, 120.0, 140.0, 37.0, 80.0, 44.0, 110.0, 70.0, 100.0, 40.0, 130.0, 140.0, 90.0, 60.0, 110.0, 80.0, 150.0, 129.0, 150.0, 99.0, 110.0, 110.0, 140.0, 40.0, 150.0, 130.0, 90.0, 170.0, 19.0, 109.0, 100.0, 80.0, 60.0, 100.0, 150.0, 80.0, 80.0, 70.0, 120.0, 110.0, 100.0, 180.0, 146.0, 30.0, 60.0, 110.0, 140.0, 123.0, 79.0, 90.0, 65.0, 100.0, 100.0, 200.0, 70.0, 100.0, 80.0, 90.0, 90.0, 60.0, 250.0, 140.0, 60.0, 120.0, 130.0, 150.0, 220.0, 100.0, 90.0, 40.0, 110.0, 300.0, 240.0, 130.0, 190.0, 80.0, 200.0, 110.0, 50.0, 180.0, 60.0, 30.0, 78.0, 150.0, 120.0, 100.0, 44.0, 120.0, 100.0, 110.0, 160.0, 112.0, 51.0, 140.0, 70.0, 20.0, 140.0, 71.0, 91.0, 250.0, 160.0, 120.0, 80.0, 150.0, 160.0, 78.0, 110.0, 137.0, 70.0, 140.0, 70.0, 138.0, 120.0, 100.0, 40.0, 94.0, 18.0, 150.0, 60.0, 66.0, 90.0, 90.0, 70.0, 120.0, 130.0, 50.0, 20.0, 140.0, 100.0, 60.0, 90.0, 137.0, 170.0, 91.0, 30.0, 120.0, 190.0, 100.0, 50.0, 29.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.610942317332539, "mean_inference_ms": 1.6090334792728351, "mean_action_processing_ms": 0.5002713440313067, "mean_env_wait_ms": 1.114876652288651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013814449310302734, "StateBufferConnector_ms": 0.03166651725769043, "ViewRequirementAgentConnector_ms": 0.3824007511138916}, "num_episodes": 18, "episode_return_max": 1660.0, "episode_return_min": 182.0, "episode_return_mean": 977.84}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.661870999404123, "num_env_steps_trained_throughput_per_sec": 20.661870999404123, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 5680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5680000, "timers": {"training_iteration_time_ms": 193573.875, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193573.828, "sample_time_ms": 2625.536, "learn_time_ms": 190928.968, "learn_throughput": 20.95, "synch_weights_time_ms": 11.341}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "done": false, "training_iteration": 142, "trial_id": "1841f_00000", "date": "2024-08-08_07-21-05", "timestamp": 1723116065, "time_this_iter_s": 193.61333298683167, "time_total_s": 28848.443002700806, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2b09550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28848.443002700806, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 17.825912408759123, "ram_util_percent": 78.9043795620438}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.841983923585778, "cur_kl_coeff": 1.8245578765869144, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.011999279676680677, "vf_loss": 8.242310810139893, "vf_explained_var": -0.013780819055752251, "kl": Infinity, "entropy": 0.5355642745892207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1338075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "env_runners": {"episode_reward_max": 1590.0, "episode_reward_min": 522.0, "episode_reward_mean": 967.89, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 400.0}, "policy_reward_mean": {"policy_0": 96.789}, "custom_metrics": {}, "hist_stats": {"episode_reward": [852.0, 980.0, 1164.0, 1060.0, 675.0, 1083.0, 1278.0, 960.0, 725.0, 800.0, 947.0, 1032.0, 590.0, 894.0, 964.0, 930.0, 874.0, 869.0, 918.0, 1000.0, 940.0, 912.0, 865.0, 596.0, 1005.0, 1207.0, 834.0, 1159.0, 859.0, 770.0, 791.0, 910.0, 1071.0, 919.0, 898.0, 877.0, 583.0, 973.0, 973.0, 1534.0, 608.0, 1110.0, 884.0, 1038.0, 1231.0, 1010.0, 1165.0, 1050.0, 960.0, 935.0, 1360.0, 1005.0, 1171.0, 976.0, 1005.0, 860.0, 1013.0, 967.0, 1046.0, 733.0, 1238.0, 703.0, 1126.0, 1260.0, 1235.0, 897.0, 829.0, 880.0, 811.0, 1138.0, 1068.0, 950.0, 1058.0, 955.0, 1300.0, 1590.0, 912.0, 1105.0, 1205.0, 856.0, 870.0, 1007.0, 853.0, 737.0, 1330.0, 696.0, 790.0, 1100.0, 1239.0, 852.0, 890.0, 1060.0, 921.0, 522.0, 1070.0, 1048.0, 605.0, 1040.0, 785.0, 860.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 54.0, 30.0, 130.0, 108.0, 70.0, 150.0, 140.0, 40.0, 60.0, 140.0, 110.0, 180.0, 70.0, 60.0, 90.0, 60.0, 170.0, 50.0, 50.0, 110.0, 90.0, 120.0, 70.0, 130.0, 98.0, 90.0, 56.0, 260.0, 140.0, 130.0, 110.0, 100.0, 170.0, 100.0, 70.0, 100.0, 120.0, 70.0, 90.0, 100.0, 160.0, 40.0, 35.0, 40.0, 120.0, 30.0, 40.0, 40.0, 70.0, 80.0, 102.0, 120.0, 102.0, 170.0, 120.0, 76.0, 210.0, 69.0, 34.0, 120.0, 90.0, 165.0, 170.0, 130.0, 180.0, 120.0, 83.0, 120.0, 100.0, 50.0, 80.0, 30.0, 130.0, 60.0, 110.0, 130.0, 90.0, 160.0, 120.0, 106.0, 90.0, 110.0, 90.0, 80.0, 48.0, 100.0, 20.0, 21.0, 60.0, 100.0, 110.0, 120.0, 130.0, 30.0, 50.0, 60.0, 60.0, 50.0, 90.0, 210.0, 17.0, 150.0, 100.0, 80.0, 25.0, 150.0, 30.0, 95.0, 90.0, 110.0, 190.0, 69.0, -6.0, 120.0, 33.0, 150.0, 166.0, 70.0, 130.0, 100.0, 10.0, 70.0, 0.0, 20.0, 50.0, 200.0, 50.0, 30.0, 60.0, 70.0, 80.0, 70.0, 90.0, 130.0, 70.0, 100.0, 138.0, 80.0, 66.0, 70.0, 90.0, 120.0, 70.0, 34.0, 110.0, 70.0, 80.0, 110.0, 210.0, 70.0, 110.0, 80.0, 90.0, 70.0, 130.0, 110.0, 110.0, 80.0, 80.0, 76.0, 55.0, 90.0, 160.0, 100.0, 73.0, 70.0, 30.0, 110.0, 110.0, 100.0, 100.0, 140.0, 30.0, 90.0, 150.0, 60.0, 50.0, 19.0, 130.0, 80.0, 40.0, 90.0, 180.0, 75.0, 57.0, 212.0, 50.0, 24.0, 110.0, 50.0, 9.0, 190.0, 90.0, 190.0, 60.0, 21.0, 160.0, 130.0, 100.0, 80.0, 110.0, 60.0, 110.0, 40.0, 120.0, 150.0, 80.0, 80.0, 110.0, 80.0, 60.0, 80.0, 70.0, 66.0, 130.0, 46.0, 120.0, 120.0, 140.0, 70.0, 115.0, 120.0, 10.0, 90.0, 60.0, 160.0, 180.0, 30.0, 30.0, 90.0, 0.0, 71.0, 100.0, 57.0, 100.0, 35.0, 120.0, 28.0, -5.0, 260.0, 70.0, 110.0, 134.0, 60.0, 30.0, 11.0, 190.0, 60.0, 80.0, 100.0, 100.0, 140.0, 140.0, 100.0, 208.0, 110.0, 40.0, 109.0, 160.0, 70.0, 70.0, 5.0, 110.0, 60.0, 79.0, 100.0, 100.0, 130.0, 110.0, 100.0, 120.0, 95.0, 50.0, 180.0, 104.0, 100.0, 230.0, 100.0, 80.0, 120.0, 100.0, 100.0, 46.0, 100.0, 100.0, 160.0, 30.0, 120.0, -17.0, 70.0, 34.0, 9.0, 80.0, 190.0, 60.0, 130.0, 34.0, 23.0, 140.0, 50.0, 100.0, 120.0, 100.0, 95.0, 90.0, 80.0, 60.0, 86.0, 10.0, 50.0, 50.0, 200.0, 60.0, 40.0, 60.0, 20.0, 120.0, 240.0, 70.0, 196.0, 55.0, 65.0, 100.0, 75.0, 140.0, 31.0, 180.0, 149.0, 80.0, 159.0, 20.0, 70.0, 20.0, 90.0, 100.0, 80.0, 230.0, 100.0, 50.0, 64.0, 140.0, 110.0, 180.0, 30.0, 60.0, 130.0, 15.0, 70.0, 99.0, 30.0, 70.0, 150.0, 60.0, 130.0, 120.0, 90.0, 110.0, 73.0, 44.0, 50.0, 80.0, 22.0, 80.0, 75.0, 25.0, 70.0, -9.0, 150.0, 40.0, 120.0, 90.0, 250.0, 30.0, 41.0, 60.0, 32.0, 130.0, 120.0, 100.0, 130.0, 106.0, 90.0, 130.0, 60.0, 70.0, 120.0, 87.0, 100.0, 80.0, 240.0, 280.0, 60.0, 180.0, 90.0, 106.0, 160.0, 160.0, 130.0, 128.0, 40.0, 80.0, 180.0, 22.0, 20.0, 10.0, 20.0, 130.0, 76.0, 30.0, 150.0, 130.0, 80.0, 140.0, 100.0, 50.0, 70.0, 100.0, 210.0, 80.0, 2.0, 120.0, 100.0, 70.0, 180.0, 28.0, 120.0, 160.0, 64.0, 40.0, 120.0, 50.0, 130.0, 180.0, 240.0, 6.0, 5.0, 60.0, 47.0, 200.0, 100.0, 140.0, 130.0, 101.0, 83.0, 130.0, 87.0, 240.0, 110.0, 110.0, 100.0, 50.0, 280.0, 110.0, 80.0, 80.0, 60.0, 60.0, 90.0, 100.0, 90.0, 180.0, 80.0, 70.0, 70.0, 160.0, 210.0, 150.0, 75.0, 80.0, 130.0, 81.0, 67.0, 21.0, 110.0, 90.0, 202.0, 80.0, 89.0, 180.0, 30.0, 100.0, 70.0, 110.0, 110.0, 90.0, 130.0, 60.0, 150.0, 110.0, 110.0, 80.0, 40.0, 80.0, 130.0, 25.0, 140.0, 70.0, 130.0, 130.0, 70.0, 180.0, 90.0, 200.0, 100.0, 150.0, 150.0, 140.0, 140.0, 140.0, 90.0, 80.0, 100.0, 70.0, 110.0, 260.0, 110.0, 40.0, 115.0, 30.0, 33.0, 80.0, 80.0, 210.0, 210.0, 140.0, 60.0, 85.0, 180.0, 93.0, 235.0, 160.0, 13.0, 30.0, 130.0, 71.0, 40.0, 90.0, 107.0, 100.0, 50.0, 60.0, 150.0, 130.0, 30.0, 70.0, 195.0, 100.0, 120.0, 100.0, 89.0, 130.0, 33.0, 148.0, 100.0, 57.0, 80.0, -47.0, 130.0, 140.0, 90.0, 40.0, 103.0, 50.0, 140.0, 200.0, 110.0, 80.0, 50.0, 150.0, 120.0, 250.0, 30.0, 93.0, 70.0, 60.0, 130.0, 90.0, 60.0, 64.0, 90.0, 90.0, 70.0, 80.0, 90.0, 109.0, 140.0, 140.0, 137.0, 100.0, 20.0, 110.0, 70.0, 40.0, 120.0, 100.0, 100.0, 10.0, 150.0, 13.0, 80.0, 100.0, 100.0, 160.0, 80.0, 90.0, 110.0, 120.0, 260.0, 138.0, 120.0, 70.0, 200.0, 40.0, 48.0, -25.0, 40.0, 90.0, 60.0, 60.0, 70.0, 100.0, 88.0, 80.0, 140.0, 150.0, 110.0, 90.0, 128.0, 170.0, 190.0, 110.0, 90.0, 100.0, 140.0, 90.0, 140.0, 180.0, 120.0, 100.0, 190.0, 125.0, 180.0, 80.0, 150.0, 50.0, 140.0, 120.0, 90.0, 110.0, 160.0, 30.0, 110.0, 130.0, 120.0, 60.0, 50.0, 77.0, 80.0, 80.0, 20.0, 50.0, 90.0, 250.0, 120.0, 69.0, 50.0, 60.0, 80.0, 40.0, 90.0, 100.0, 120.0, 70.0, 80.0, 70.0, 140.0, 130.0, 90.0, -10.0, 70.0, 120.0, 140.0, 37.0, 80.0, 44.0, 110.0, 70.0, 100.0, 40.0, 130.0, 140.0, 90.0, 60.0, 110.0, 80.0, 150.0, 129.0, 150.0, 99.0, 110.0, 110.0, 140.0, 40.0, 150.0, 130.0, 90.0, 170.0, 19.0, 109.0, 100.0, 80.0, 60.0, 100.0, 150.0, 80.0, 80.0, 70.0, 120.0, 110.0, 100.0, 180.0, 146.0, 30.0, 60.0, 110.0, 140.0, 123.0, 79.0, 90.0, 65.0, 100.0, 100.0, 200.0, 70.0, 100.0, 80.0, 90.0, 90.0, 60.0, 250.0, 140.0, 60.0, 120.0, 130.0, 150.0, 220.0, 100.0, 90.0, 40.0, 110.0, 300.0, 240.0, 130.0, 190.0, 80.0, 200.0, 110.0, 50.0, 180.0, 60.0, 30.0, 78.0, 150.0, 120.0, 100.0, 44.0, 120.0, 100.0, 110.0, 160.0, 112.0, 51.0, 140.0, 70.0, 20.0, 140.0, 71.0, 91.0, 250.0, 160.0, 120.0, 80.0, 150.0, 160.0, 78.0, 110.0, 137.0, 70.0, 140.0, 70.0, 138.0, 120.0, 100.0, 40.0, 94.0, 18.0, 150.0, 60.0, 66.0, 90.0, 90.0, 70.0, 120.0, 130.0, 50.0, 20.0, 140.0, 100.0, 60.0, 90.0, 137.0, 170.0, 91.0, 30.0, 120.0, 190.0, 100.0, 50.0, 29.0, 80.0, 80.0, 70.0, 80.0, 15.0, 68.0, 120.0, 120.0, 130.0, 90.0, 80.0, 160.0, 98.0, 10.0, 45.0, 100.0, 56.0, 40.0, 58.0, 90.0, 120.0, 160.0, 20.0, 140.0, 70.0, 140.0, 130.0, 120.0, 230.0, 200.0, 19.0, 60.0, 150.0, 98.0, 40.0, 60.0, 60.0, 39.0, 100.0, 70.0, 86.0, 139.0, 15.0, 50.0, 60.0, 90.0, 100.0, 90.0, 60.0, 100.0, 50.0, 60.0, 60.0, 60.0, 70.0, 90.0, 400.0, 100.0, 110.0, 100.0, 120.0, 89.0, 80.0, 170.0, 120.0, 180.0, 120.0, 70.0, 120.0, 170.0, 170.0, 200.0, 100.0, 62.0, 50.0, -30.0, 70.0, 40.0, 120.0, 70.0, 30.0, 100.0, 70.0, 70.0, 120.0, 100.0, 90.0, 70.0, 170.0, 70.0, 140.0, 150.0, 70.0, 10.0, 90.0, 120.0, 120.0, 90.0, 70.0, 200.0, 140.0, 146.0, 200.0, 70.0, 98.0, 40.0, -26.0, 219.0, 30.0, 4.0, 130.0, 14.0, 79.0, 7.0, 90.0, 22.0, 50.0, 40.0, 0.0, 90.0, 100.0, 49.0, 26.0, 160.0, 145.0, 130.0, 160.0, 160.0, 110.0, 30.0, 105.0, 40.0, 43.0, 80.0, 70.0, 140.0, 60.0, 210.0, 110.0, 190.0, 110.0, 50.0, 27.0, 110.0, 30.0, 57.0, 20.0, 20.0, 55.0, 126.0, 60.0, 130.0, 90.0, 80.0, 130.0, 140.0, 130.0, 70.0, 120.0, 90.0, 110.0, 80.0, 110.0, 80.0, -65.0, 140.0, 90.0, 70.0, 100.0, 70.0, 70.0, 100.0, 50.0, 170.0, 80.0, 90.0, 50.0, 100.0, 90.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6101267034283273, "mean_inference_ms": 1.6082238201876118, "mean_action_processing_ms": 0.4999495490419419, "mean_env_wait_ms": 1.1144042352071388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013902902603149414, "StateBufferConnector_ms": 0.031820058822631836, "ViewRequirementAgentConnector_ms": 0.3835747241973877}, "num_episodes": 18, "episode_return_max": 1590.0, "episode_return_min": 522.0, "episode_return_mean": 967.89}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.5133935359834, "num_env_steps_trained_throughput_per_sec": 20.5133935359834, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 5720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5720000, "timers": {"training_iteration_time_ms": 193595.529, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193595.482, "sample_time_ms": 2567.052, "learn_time_ms": 191009.145, "learn_throughput": 20.941, "synch_weights_time_ms": 11.328}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "done": false, "training_iteration": 143, "trial_id": "1841f_00000", "date": "2024-08-08_07-24-20", "timestamp": 1723116260, "time_this_iter_s": 195.00469994544983, "time_total_s": 29043.447702646255, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2b09af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29043.447702646255, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 18.917753623188407, "ram_util_percent": 79.00253623188406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.134862045713634, "cur_kl_coeff": 2.7368368148803706, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.011144893381326074, "vf_loss": 8.584557608623728, "vf_explained_var": -0.027706366168043485, "kl": Infinity, "entropy": 0.49228121510709816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1347465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "env_runners": {"episode_reward_max": 1590.0, "episode_reward_min": 436.0, "episode_reward_mean": 981.98, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 400.0}, "policy_reward_mean": {"policy_0": 98.198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [596.0, 1005.0, 1207.0, 834.0, 1159.0, 859.0, 770.0, 791.0, 910.0, 1071.0, 919.0, 898.0, 877.0, 583.0, 973.0, 973.0, 1534.0, 608.0, 1110.0, 884.0, 1038.0, 1231.0, 1010.0, 1165.0, 1050.0, 960.0, 935.0, 1360.0, 1005.0, 1171.0, 976.0, 1005.0, 860.0, 1013.0, 967.0, 1046.0, 733.0, 1238.0, 703.0, 1126.0, 1260.0, 1235.0, 897.0, 829.0, 880.0, 811.0, 1138.0, 1068.0, 950.0, 1058.0, 955.0, 1300.0, 1590.0, 912.0, 1105.0, 1205.0, 856.0, 870.0, 1007.0, 853.0, 737.0, 1330.0, 696.0, 790.0, 1100.0, 1239.0, 852.0, 890.0, 1060.0, 921.0, 522.0, 1070.0, 1048.0, 605.0, 1040.0, 785.0, 860.0, 1177.0, 1300.0, 436.0, 723.0, 780.0, 850.0, 930.0, 869.0, 1001.0, 1270.0, 960.0, 1245.0, 1110.0, 621.0, 1250.0, 1170.0, 993.0, 1330.0, 999.0, 1020.0, 639.0, 1008.0, 1040.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 0.0, 71.0, 100.0, 57.0, 100.0, 35.0, 120.0, 28.0, -5.0, 260.0, 70.0, 110.0, 134.0, 60.0, 30.0, 11.0, 190.0, 60.0, 80.0, 100.0, 100.0, 140.0, 140.0, 100.0, 208.0, 110.0, 40.0, 109.0, 160.0, 70.0, 70.0, 5.0, 110.0, 60.0, 79.0, 100.0, 100.0, 130.0, 110.0, 100.0, 120.0, 95.0, 50.0, 180.0, 104.0, 100.0, 230.0, 100.0, 80.0, 120.0, 100.0, 100.0, 46.0, 100.0, 100.0, 160.0, 30.0, 120.0, -17.0, 70.0, 34.0, 9.0, 80.0, 190.0, 60.0, 130.0, 34.0, 23.0, 140.0, 50.0, 100.0, 120.0, 100.0, 95.0, 90.0, 80.0, 60.0, 86.0, 10.0, 50.0, 50.0, 200.0, 60.0, 40.0, 60.0, 20.0, 120.0, 240.0, 70.0, 196.0, 55.0, 65.0, 100.0, 75.0, 140.0, 31.0, 180.0, 149.0, 80.0, 159.0, 20.0, 70.0, 20.0, 90.0, 100.0, 80.0, 230.0, 100.0, 50.0, 64.0, 140.0, 110.0, 180.0, 30.0, 60.0, 130.0, 15.0, 70.0, 99.0, 30.0, 70.0, 150.0, 60.0, 130.0, 120.0, 90.0, 110.0, 73.0, 44.0, 50.0, 80.0, 22.0, 80.0, 75.0, 25.0, 70.0, -9.0, 150.0, 40.0, 120.0, 90.0, 250.0, 30.0, 41.0, 60.0, 32.0, 130.0, 120.0, 100.0, 130.0, 106.0, 90.0, 130.0, 60.0, 70.0, 120.0, 87.0, 100.0, 80.0, 240.0, 280.0, 60.0, 180.0, 90.0, 106.0, 160.0, 160.0, 130.0, 128.0, 40.0, 80.0, 180.0, 22.0, 20.0, 10.0, 20.0, 130.0, 76.0, 30.0, 150.0, 130.0, 80.0, 140.0, 100.0, 50.0, 70.0, 100.0, 210.0, 80.0, 2.0, 120.0, 100.0, 70.0, 180.0, 28.0, 120.0, 160.0, 64.0, 40.0, 120.0, 50.0, 130.0, 180.0, 240.0, 6.0, 5.0, 60.0, 47.0, 200.0, 100.0, 140.0, 130.0, 101.0, 83.0, 130.0, 87.0, 240.0, 110.0, 110.0, 100.0, 50.0, 280.0, 110.0, 80.0, 80.0, 60.0, 60.0, 90.0, 100.0, 90.0, 180.0, 80.0, 70.0, 70.0, 160.0, 210.0, 150.0, 75.0, 80.0, 130.0, 81.0, 67.0, 21.0, 110.0, 90.0, 202.0, 80.0, 89.0, 180.0, 30.0, 100.0, 70.0, 110.0, 110.0, 90.0, 130.0, 60.0, 150.0, 110.0, 110.0, 80.0, 40.0, 80.0, 130.0, 25.0, 140.0, 70.0, 130.0, 130.0, 70.0, 180.0, 90.0, 200.0, 100.0, 150.0, 150.0, 140.0, 140.0, 140.0, 90.0, 80.0, 100.0, 70.0, 110.0, 260.0, 110.0, 40.0, 115.0, 30.0, 33.0, 80.0, 80.0, 210.0, 210.0, 140.0, 60.0, 85.0, 180.0, 93.0, 235.0, 160.0, 13.0, 30.0, 130.0, 71.0, 40.0, 90.0, 107.0, 100.0, 50.0, 60.0, 150.0, 130.0, 30.0, 70.0, 195.0, 100.0, 120.0, 100.0, 89.0, 130.0, 33.0, 148.0, 100.0, 57.0, 80.0, -47.0, 130.0, 140.0, 90.0, 40.0, 103.0, 50.0, 140.0, 200.0, 110.0, 80.0, 50.0, 150.0, 120.0, 250.0, 30.0, 93.0, 70.0, 60.0, 130.0, 90.0, 60.0, 64.0, 90.0, 90.0, 70.0, 80.0, 90.0, 109.0, 140.0, 140.0, 137.0, 100.0, 20.0, 110.0, 70.0, 40.0, 120.0, 100.0, 100.0, 10.0, 150.0, 13.0, 80.0, 100.0, 100.0, 160.0, 80.0, 90.0, 110.0, 120.0, 260.0, 138.0, 120.0, 70.0, 200.0, 40.0, 48.0, -25.0, 40.0, 90.0, 60.0, 60.0, 70.0, 100.0, 88.0, 80.0, 140.0, 150.0, 110.0, 90.0, 128.0, 170.0, 190.0, 110.0, 90.0, 100.0, 140.0, 90.0, 140.0, 180.0, 120.0, 100.0, 190.0, 125.0, 180.0, 80.0, 150.0, 50.0, 140.0, 120.0, 90.0, 110.0, 160.0, 30.0, 110.0, 130.0, 120.0, 60.0, 50.0, 77.0, 80.0, 80.0, 20.0, 50.0, 90.0, 250.0, 120.0, 69.0, 50.0, 60.0, 80.0, 40.0, 90.0, 100.0, 120.0, 70.0, 80.0, 70.0, 140.0, 130.0, 90.0, -10.0, 70.0, 120.0, 140.0, 37.0, 80.0, 44.0, 110.0, 70.0, 100.0, 40.0, 130.0, 140.0, 90.0, 60.0, 110.0, 80.0, 150.0, 129.0, 150.0, 99.0, 110.0, 110.0, 140.0, 40.0, 150.0, 130.0, 90.0, 170.0, 19.0, 109.0, 100.0, 80.0, 60.0, 100.0, 150.0, 80.0, 80.0, 70.0, 120.0, 110.0, 100.0, 180.0, 146.0, 30.0, 60.0, 110.0, 140.0, 123.0, 79.0, 90.0, 65.0, 100.0, 100.0, 200.0, 70.0, 100.0, 80.0, 90.0, 90.0, 60.0, 250.0, 140.0, 60.0, 120.0, 130.0, 150.0, 220.0, 100.0, 90.0, 40.0, 110.0, 300.0, 240.0, 130.0, 190.0, 80.0, 200.0, 110.0, 50.0, 180.0, 60.0, 30.0, 78.0, 150.0, 120.0, 100.0, 44.0, 120.0, 100.0, 110.0, 160.0, 112.0, 51.0, 140.0, 70.0, 20.0, 140.0, 71.0, 91.0, 250.0, 160.0, 120.0, 80.0, 150.0, 160.0, 78.0, 110.0, 137.0, 70.0, 140.0, 70.0, 138.0, 120.0, 100.0, 40.0, 94.0, 18.0, 150.0, 60.0, 66.0, 90.0, 90.0, 70.0, 120.0, 130.0, 50.0, 20.0, 140.0, 100.0, 60.0, 90.0, 137.0, 170.0, 91.0, 30.0, 120.0, 190.0, 100.0, 50.0, 29.0, 80.0, 80.0, 70.0, 80.0, 15.0, 68.0, 120.0, 120.0, 130.0, 90.0, 80.0, 160.0, 98.0, 10.0, 45.0, 100.0, 56.0, 40.0, 58.0, 90.0, 120.0, 160.0, 20.0, 140.0, 70.0, 140.0, 130.0, 120.0, 230.0, 200.0, 19.0, 60.0, 150.0, 98.0, 40.0, 60.0, 60.0, 39.0, 100.0, 70.0, 86.0, 139.0, 15.0, 50.0, 60.0, 90.0, 100.0, 90.0, 60.0, 100.0, 50.0, 60.0, 60.0, 60.0, 70.0, 90.0, 400.0, 100.0, 110.0, 100.0, 120.0, 89.0, 80.0, 170.0, 120.0, 180.0, 120.0, 70.0, 120.0, 170.0, 170.0, 200.0, 100.0, 62.0, 50.0, -30.0, 70.0, 40.0, 120.0, 70.0, 30.0, 100.0, 70.0, 70.0, 120.0, 100.0, 90.0, 70.0, 170.0, 70.0, 140.0, 150.0, 70.0, 10.0, 90.0, 120.0, 120.0, 90.0, 70.0, 200.0, 140.0, 146.0, 200.0, 70.0, 98.0, 40.0, -26.0, 219.0, 30.0, 4.0, 130.0, 14.0, 79.0, 7.0, 90.0, 22.0, 50.0, 40.0, 0.0, 90.0, 100.0, 49.0, 26.0, 160.0, 145.0, 130.0, 160.0, 160.0, 110.0, 30.0, 105.0, 40.0, 43.0, 80.0, 70.0, 140.0, 60.0, 210.0, 110.0, 190.0, 110.0, 50.0, 27.0, 110.0, 30.0, 57.0, 20.0, 20.0, 55.0, 126.0, 60.0, 130.0, 90.0, 80.0, 130.0, 140.0, 130.0, 70.0, 120.0, 90.0, 110.0, 80.0, 110.0, 80.0, -65.0, 140.0, 90.0, 70.0, 100.0, 70.0, 70.0, 100.0, 50.0, 170.0, 80.0, 90.0, 50.0, 100.0, 90.0, 60.0, 42.0, 130.0, 210.0, 150.0, 80.0, 143.0, 102.0, 70.0, 80.0, 170.0, 90.0, 160.0, 90.0, 190.0, 140.0, 70.0, 50.0, 180.0, 260.0, 70.0, 20.0, 60.0, 130.0, 33.0, 90.0, 10.0, 40.0, 20.0, 17.0, 16.0, 100.0, 12.0, 30.0, 160.0, 210.0, 11.0, 40.0, 70.0, 50.0, 40.0, 10.0, 90.0, 80.0, 40.0, 50.0, 130.0, 120.0, 170.0, 70.0, 20.0, 90.0, 70.0, 60.0, 80.0, 170.0, 90.0, 60.0, 90.0, 40.0, 100.0, 130.0, 100.0, 100.0, 120.0, 40.0, 130.0, 90.0, 70.0, 40.0, 110.0, 130.0, 60.0, 125.0, 45.0, 39.0, 140.0, 50.0, 120.0, 90.0, 70.0, 10.0, 56.0, 150.0, 120.0, 60.0, 100.0, 120.0, 80.0, 150.0, 155.0, 160.0, 170.0, 76.0, 180.0, 90.0, 104.0, 150.0, 60.0, 90.0, 190.0, 80.0, 40.0, 60.0, 130.0, 60.0, 110.0, 100.0, 150.0, 150.0, 80.0, 90.0, 150.0, 130.0, 170.0, 110.0, 130.0, 115.0, 150.0, 100.0, 100.0, 120.0, 110.0, 150.0, 140.0, 90.0, 140.0, 90.0, 60.0, 110.0, 100.0, 80.0, 150.0, 13.0, 40.0, 48.0, 20.0, 50.0, 130.0, 40.0, 50.0, 140.0, 100.0, 200.0, 90.0, 130.0, 190.0, 120.0, 90.0, 60.0, 130.0, 90.0, 120.0, 160.0, 100.0, 260.0, 40.0, 20.0, 130.0, 130.0, 120.0, 50.0, 110.0, 90.0, 120.0, 56.0, 110.0, 100.0, 87.0, 210.0, 60.0, 230.0, 90.0, 90.0, 140.0, 110.0, 240.0, 110.0, 70.0, 180.0, 70.0, 100.0, 59.0, 80.0, 210.0, 90.0, 130.0, 50.0, 90.0, 120.0, 70.0, 90.0, 200.0, 30.0, 80.0, 120.0, 150.0, 70.0, 60.0, 140.0, 80.0, 60.0, 80.0, 100.0, 110.0, 46.0, 76.0, 50.0, 40.0, 7.0, 70.0, 130.0, 120.0, 90.0, 80.0, 100.0, 108.0, 150.0, 100.0, 70.0, 60.0, 210.0, 120.0, 120.0, 90.0, 100.0, 120.0, 50.0, 30.0, 110.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6082892522586283, "mean_inference_ms": 1.6064708896384419, "mean_action_processing_ms": 0.49941747336626874, "mean_env_wait_ms": 1.1134584379185204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013625621795654297, "StateBufferConnector_ms": 0.009114742279052734, "ViewRequirementAgentConnector_ms": 0.3862619400024414}, "num_episodes": 23, "episode_return_max": 1590.0, "episode_return_min": 436.0, "episode_return_mean": 981.98}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.680642548869233, "num_env_steps_trained_throughput_per_sec": 20.680642548869233, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 5760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5760000, "timers": {"training_iteration_time_ms": 193614.66, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193614.613, "sample_time_ms": 2583.697, "learn_time_ms": 191011.815, "learn_throughput": 20.941, "synch_weights_time_ms": 11.206}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "done": false, "training_iteration": 144, "trial_id": "1841f_00000", "date": "2024-08-08_07-27-34", "timestamp": 1723116454, "time_this_iter_s": 193.4312708377838, "time_total_s": 29236.87897348404, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2b09f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29236.87897348404, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 17.463503649635037, "ram_util_percent": 78.07372262773723}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.266967254109022, "cur_kl_coeff": 4.105255222320557, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.009493408908847327, "vf_loss": 8.536841471482136, "vf_explained_var": -0.025161195029846775, "kl": Infinity, "entropy": 0.4939941530537428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1356855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "env_runners": {"episode_reward_max": 1590.0, "episode_reward_min": 436.0, "episode_reward_mean": 1001.93, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 400.0}, "policy_reward_mean": {"policy_0": 100.193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1010.0, 1165.0, 1050.0, 960.0, 935.0, 1360.0, 1005.0, 1171.0, 976.0, 1005.0, 860.0, 1013.0, 967.0, 1046.0, 733.0, 1238.0, 703.0, 1126.0, 1260.0, 1235.0, 897.0, 829.0, 880.0, 811.0, 1138.0, 1068.0, 950.0, 1058.0, 955.0, 1300.0, 1590.0, 912.0, 1105.0, 1205.0, 856.0, 870.0, 1007.0, 853.0, 737.0, 1330.0, 696.0, 790.0, 1100.0, 1239.0, 852.0, 890.0, 1060.0, 921.0, 522.0, 1070.0, 1048.0, 605.0, 1040.0, 785.0, 860.0, 1177.0, 1300.0, 436.0, 723.0, 780.0, 850.0, 930.0, 869.0, 1001.0, 1270.0, 960.0, 1245.0, 1110.0, 621.0, 1250.0, 1170.0, 993.0, 1330.0, 999.0, 1020.0, 639.0, 1008.0, 1040.0, 895.0, 1160.0, 1116.0, 1330.0, 680.0, 859.0, 1090.0, 1010.0, 780.0, 1120.0, 1259.0, 820.0, 1049.0, 1120.0, 1254.0, 610.0, 1100.0, 1042.0, 900.0, 1460.0, 1060.0, 1111.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 50.0, 280.0, 110.0, 80.0, 80.0, 60.0, 60.0, 90.0, 100.0, 90.0, 180.0, 80.0, 70.0, 70.0, 160.0, 210.0, 150.0, 75.0, 80.0, 130.0, 81.0, 67.0, 21.0, 110.0, 90.0, 202.0, 80.0, 89.0, 180.0, 30.0, 100.0, 70.0, 110.0, 110.0, 90.0, 130.0, 60.0, 150.0, 110.0, 110.0, 80.0, 40.0, 80.0, 130.0, 25.0, 140.0, 70.0, 130.0, 130.0, 70.0, 180.0, 90.0, 200.0, 100.0, 150.0, 150.0, 140.0, 140.0, 140.0, 90.0, 80.0, 100.0, 70.0, 110.0, 260.0, 110.0, 40.0, 115.0, 30.0, 33.0, 80.0, 80.0, 210.0, 210.0, 140.0, 60.0, 85.0, 180.0, 93.0, 235.0, 160.0, 13.0, 30.0, 130.0, 71.0, 40.0, 90.0, 107.0, 100.0, 50.0, 60.0, 150.0, 130.0, 30.0, 70.0, 195.0, 100.0, 120.0, 100.0, 89.0, 130.0, 33.0, 148.0, 100.0, 57.0, 80.0, -47.0, 130.0, 140.0, 90.0, 40.0, 103.0, 50.0, 140.0, 200.0, 110.0, 80.0, 50.0, 150.0, 120.0, 250.0, 30.0, 93.0, 70.0, 60.0, 130.0, 90.0, 60.0, 64.0, 90.0, 90.0, 70.0, 80.0, 90.0, 109.0, 140.0, 140.0, 137.0, 100.0, 20.0, 110.0, 70.0, 40.0, 120.0, 100.0, 100.0, 10.0, 150.0, 13.0, 80.0, 100.0, 100.0, 160.0, 80.0, 90.0, 110.0, 120.0, 260.0, 138.0, 120.0, 70.0, 200.0, 40.0, 48.0, -25.0, 40.0, 90.0, 60.0, 60.0, 70.0, 100.0, 88.0, 80.0, 140.0, 150.0, 110.0, 90.0, 128.0, 170.0, 190.0, 110.0, 90.0, 100.0, 140.0, 90.0, 140.0, 180.0, 120.0, 100.0, 190.0, 125.0, 180.0, 80.0, 150.0, 50.0, 140.0, 120.0, 90.0, 110.0, 160.0, 30.0, 110.0, 130.0, 120.0, 60.0, 50.0, 77.0, 80.0, 80.0, 20.0, 50.0, 90.0, 250.0, 120.0, 69.0, 50.0, 60.0, 80.0, 40.0, 90.0, 100.0, 120.0, 70.0, 80.0, 70.0, 140.0, 130.0, 90.0, -10.0, 70.0, 120.0, 140.0, 37.0, 80.0, 44.0, 110.0, 70.0, 100.0, 40.0, 130.0, 140.0, 90.0, 60.0, 110.0, 80.0, 150.0, 129.0, 150.0, 99.0, 110.0, 110.0, 140.0, 40.0, 150.0, 130.0, 90.0, 170.0, 19.0, 109.0, 100.0, 80.0, 60.0, 100.0, 150.0, 80.0, 80.0, 70.0, 120.0, 110.0, 100.0, 180.0, 146.0, 30.0, 60.0, 110.0, 140.0, 123.0, 79.0, 90.0, 65.0, 100.0, 100.0, 200.0, 70.0, 100.0, 80.0, 90.0, 90.0, 60.0, 250.0, 140.0, 60.0, 120.0, 130.0, 150.0, 220.0, 100.0, 90.0, 40.0, 110.0, 300.0, 240.0, 130.0, 190.0, 80.0, 200.0, 110.0, 50.0, 180.0, 60.0, 30.0, 78.0, 150.0, 120.0, 100.0, 44.0, 120.0, 100.0, 110.0, 160.0, 112.0, 51.0, 140.0, 70.0, 20.0, 140.0, 71.0, 91.0, 250.0, 160.0, 120.0, 80.0, 150.0, 160.0, 78.0, 110.0, 137.0, 70.0, 140.0, 70.0, 138.0, 120.0, 100.0, 40.0, 94.0, 18.0, 150.0, 60.0, 66.0, 90.0, 90.0, 70.0, 120.0, 130.0, 50.0, 20.0, 140.0, 100.0, 60.0, 90.0, 137.0, 170.0, 91.0, 30.0, 120.0, 190.0, 100.0, 50.0, 29.0, 80.0, 80.0, 70.0, 80.0, 15.0, 68.0, 120.0, 120.0, 130.0, 90.0, 80.0, 160.0, 98.0, 10.0, 45.0, 100.0, 56.0, 40.0, 58.0, 90.0, 120.0, 160.0, 20.0, 140.0, 70.0, 140.0, 130.0, 120.0, 230.0, 200.0, 19.0, 60.0, 150.0, 98.0, 40.0, 60.0, 60.0, 39.0, 100.0, 70.0, 86.0, 139.0, 15.0, 50.0, 60.0, 90.0, 100.0, 90.0, 60.0, 100.0, 50.0, 60.0, 60.0, 60.0, 70.0, 90.0, 400.0, 100.0, 110.0, 100.0, 120.0, 89.0, 80.0, 170.0, 120.0, 180.0, 120.0, 70.0, 120.0, 170.0, 170.0, 200.0, 100.0, 62.0, 50.0, -30.0, 70.0, 40.0, 120.0, 70.0, 30.0, 100.0, 70.0, 70.0, 120.0, 100.0, 90.0, 70.0, 170.0, 70.0, 140.0, 150.0, 70.0, 10.0, 90.0, 120.0, 120.0, 90.0, 70.0, 200.0, 140.0, 146.0, 200.0, 70.0, 98.0, 40.0, -26.0, 219.0, 30.0, 4.0, 130.0, 14.0, 79.0, 7.0, 90.0, 22.0, 50.0, 40.0, 0.0, 90.0, 100.0, 49.0, 26.0, 160.0, 145.0, 130.0, 160.0, 160.0, 110.0, 30.0, 105.0, 40.0, 43.0, 80.0, 70.0, 140.0, 60.0, 210.0, 110.0, 190.0, 110.0, 50.0, 27.0, 110.0, 30.0, 57.0, 20.0, 20.0, 55.0, 126.0, 60.0, 130.0, 90.0, 80.0, 130.0, 140.0, 130.0, 70.0, 120.0, 90.0, 110.0, 80.0, 110.0, 80.0, -65.0, 140.0, 90.0, 70.0, 100.0, 70.0, 70.0, 100.0, 50.0, 170.0, 80.0, 90.0, 50.0, 100.0, 90.0, 60.0, 42.0, 130.0, 210.0, 150.0, 80.0, 143.0, 102.0, 70.0, 80.0, 170.0, 90.0, 160.0, 90.0, 190.0, 140.0, 70.0, 50.0, 180.0, 260.0, 70.0, 20.0, 60.0, 130.0, 33.0, 90.0, 10.0, 40.0, 20.0, 17.0, 16.0, 100.0, 12.0, 30.0, 160.0, 210.0, 11.0, 40.0, 70.0, 50.0, 40.0, 10.0, 90.0, 80.0, 40.0, 50.0, 130.0, 120.0, 170.0, 70.0, 20.0, 90.0, 70.0, 60.0, 80.0, 170.0, 90.0, 60.0, 90.0, 40.0, 100.0, 130.0, 100.0, 100.0, 120.0, 40.0, 130.0, 90.0, 70.0, 40.0, 110.0, 130.0, 60.0, 125.0, 45.0, 39.0, 140.0, 50.0, 120.0, 90.0, 70.0, 10.0, 56.0, 150.0, 120.0, 60.0, 100.0, 120.0, 80.0, 150.0, 155.0, 160.0, 170.0, 76.0, 180.0, 90.0, 104.0, 150.0, 60.0, 90.0, 190.0, 80.0, 40.0, 60.0, 130.0, 60.0, 110.0, 100.0, 150.0, 150.0, 80.0, 90.0, 150.0, 130.0, 170.0, 110.0, 130.0, 115.0, 150.0, 100.0, 100.0, 120.0, 110.0, 150.0, 140.0, 90.0, 140.0, 90.0, 60.0, 110.0, 100.0, 80.0, 150.0, 13.0, 40.0, 48.0, 20.0, 50.0, 130.0, 40.0, 50.0, 140.0, 100.0, 200.0, 90.0, 130.0, 190.0, 120.0, 90.0, 60.0, 130.0, 90.0, 120.0, 160.0, 100.0, 260.0, 40.0, 20.0, 130.0, 130.0, 120.0, 50.0, 110.0, 90.0, 120.0, 56.0, 110.0, 100.0, 87.0, 210.0, 60.0, 230.0, 90.0, 90.0, 140.0, 110.0, 240.0, 110.0, 70.0, 180.0, 70.0, 100.0, 59.0, 80.0, 210.0, 90.0, 130.0, 50.0, 90.0, 120.0, 70.0, 90.0, 200.0, 30.0, 80.0, 120.0, 150.0, 70.0, 60.0, 140.0, 80.0, 60.0, 80.0, 100.0, 110.0, 46.0, 76.0, 50.0, 40.0, 7.0, 70.0, 130.0, 120.0, 90.0, 80.0, 100.0, 108.0, 150.0, 100.0, 70.0, 60.0, 210.0, 120.0, 120.0, 90.0, 100.0, 120.0, 50.0, 30.0, 110.0, 90.0, 160.0, 70.0, 57.0, 120.0, 70.0, 57.0, 31.0, 140.0, 90.0, 100.0, 130.0, 100.0, 120.0, 70.0, 30.0, 170.0, 130.0, 210.0, 60.0, 140.0, 138.0, 151.0, 27.0, 80.0, 180.0, 90.0, 140.0, 70.0, 170.0, 70.0, 170.0, 190.0, 150.0, 120.0, 120.0, 90.0, 160.0, 90.0, 60.0, 180.0, 30.0, 30.0, 70.0, 80.0, 90.0, 60.0, 90.0, 10.0, 90.0, 130.0, 66.0, 134.0, 130.0, 59.0, 80.0, 60.0, 120.0, 60.0, 40.0, 110.0, 150.0, 170.0, 100.0, 100.0, 210.0, 100.0, 110.0, 10.0, 50.0, 90.0, 108.0, 80.0, 130.0, 80.0, 40.0, 35.0, 190.0, 70.0, 150.0, 127.0, 20.0, 70.0, 80.0, 90.0, 100.0, 220.0, 70.0, 30.0, 60.0, 40.0, 110.0, 50.0, 50.0, 160.0, 140.0, 110.0, 100.0, 140.0, 160.0, 100.0, 60.0, 90.0, 138.0, 180.0, 77.0, 110.0, 97.0, 140.0, 190.0, 177.0, 40.0, 50.0, 50.0, 30.0, 90.0, 150.0, 210.0, 60.0, 110.0, 30.0, 80.0, 110.0, 159.0, 100.0, 90.0, 140.0, 70.0, 60.0, 120.0, 120.0, 60.0, 90.0, 140.0, 100.0, 100.0, 140.0, 290.0, 60.0, 60.0, 80.0, 160.0, 170.0, 240.0, 60.0, 160.0, 82.0, 47.0, 65.0, 90.0, 180.0, 70.0, 90.0, 0.0, 50.0, 90.0, 40.0, 110.0, 70.0, 40.0, 50.0, 60.0, 190.0, 120.0, 80.0, 100.0, 150.0, 200.0, 50.0, 80.0, 70.0, 90.0, 52.0, 161.0, 150.0, 100.0, 80.0, 138.0, 59.0, 120.0, 92.0, 170.0, 60.0, 60.0, 30.0, 60.0, 50.0, 20.0, 250.0, 130.0, 70.0, 160.0, 80.0, 180.0, 90.0, 110.0, 220.0, 200.0, 60.0, 130.0, 230.0, 47.0, 88.0, 130.0, 132.0, 160.0, 140.0, 130.0, 130.0, 13.0, 90.0, 110.0, 77.0, 80.0, 86.0, 130.0, 120.0, 100.0, 140.0, 58.0, 210.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6081522227650296, "mean_inference_ms": 1.6064617588071355, "mean_action_processing_ms": 0.4992622889687843, "mean_env_wait_ms": 1.1126811167243857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013425350189208984, "StateBufferConnector_ms": 0.009659290313720703, "ViewRequirementAgentConnector_ms": 0.41707301139831543}, "num_episodes": 22, "episode_return_max": 1590.0, "episode_return_min": 436.0, "episode_return_mean": 1001.93}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.679691935598992, "num_env_steps_trained_throughput_per_sec": 20.679691935598992, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 5800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5800000, "timers": {"training_iteration_time_ms": 193657.636, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193657.589, "sample_time_ms": 2639.319, "learn_time_ms": 190998.988, "learn_throughput": 20.943, "synch_weights_time_ms": 11.259}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "done": false, "training_iteration": 145, "trial_id": "1841f_00000", "date": "2024-08-08_07-30-47", "timestamp": 1723116647, "time_this_iter_s": 193.4340739250183, "time_total_s": 29430.313047409058, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2b1f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29430.313047409058, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 17.38571428571429, "ram_util_percent": 78.1820512820513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3195317586136066, "cur_kl_coeff": 6.157882833480835, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.415292904755304, "policy_loss": -0.007125200995286734, "vf_loss": 8.418351931211413, "vf_explained_var": -0.02719717053051828, "kl": 0.0006603204174804186, "entropy": 0.5214610995480808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1366245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "env_runners": {"episode_reward_max": 1590.0, "episode_reward_min": 436.0, "episode_reward_mean": 989.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 400.0}, "policy_reward_mean": {"policy_0": 98.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1260.0, 1235.0, 897.0, 829.0, 880.0, 811.0, 1138.0, 1068.0, 950.0, 1058.0, 955.0, 1300.0, 1590.0, 912.0, 1105.0, 1205.0, 856.0, 870.0, 1007.0, 853.0, 737.0, 1330.0, 696.0, 790.0, 1100.0, 1239.0, 852.0, 890.0, 1060.0, 921.0, 522.0, 1070.0, 1048.0, 605.0, 1040.0, 785.0, 860.0, 1177.0, 1300.0, 436.0, 723.0, 780.0, 850.0, 930.0, 869.0, 1001.0, 1270.0, 960.0, 1245.0, 1110.0, 621.0, 1250.0, 1170.0, 993.0, 1330.0, 999.0, 1020.0, 639.0, 1008.0, 1040.0, 895.0, 1160.0, 1116.0, 1330.0, 680.0, 859.0, 1090.0, 1010.0, 780.0, 1120.0, 1259.0, 820.0, 1049.0, 1120.0, 1254.0, 610.0, 1100.0, 1042.0, 900.0, 1460.0, 1060.0, 1111.0, 757.0, 1023.0, 988.0, 1258.0, 578.0, 1262.0, 912.0, 1235.0, 1135.0, 1060.0, 712.0, 700.0, 781.0, 907.0, 1030.0, 577.0, 905.0, 1210.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [190.0, 110.0, 90.0, 100.0, 140.0, 90.0, 140.0, 180.0, 120.0, 100.0, 190.0, 125.0, 180.0, 80.0, 150.0, 50.0, 140.0, 120.0, 90.0, 110.0, 160.0, 30.0, 110.0, 130.0, 120.0, 60.0, 50.0, 77.0, 80.0, 80.0, 20.0, 50.0, 90.0, 250.0, 120.0, 69.0, 50.0, 60.0, 80.0, 40.0, 90.0, 100.0, 120.0, 70.0, 80.0, 70.0, 140.0, 130.0, 90.0, -10.0, 70.0, 120.0, 140.0, 37.0, 80.0, 44.0, 110.0, 70.0, 100.0, 40.0, 130.0, 140.0, 90.0, 60.0, 110.0, 80.0, 150.0, 129.0, 150.0, 99.0, 110.0, 110.0, 140.0, 40.0, 150.0, 130.0, 90.0, 170.0, 19.0, 109.0, 100.0, 80.0, 60.0, 100.0, 150.0, 80.0, 80.0, 70.0, 120.0, 110.0, 100.0, 180.0, 146.0, 30.0, 60.0, 110.0, 140.0, 123.0, 79.0, 90.0, 65.0, 100.0, 100.0, 200.0, 70.0, 100.0, 80.0, 90.0, 90.0, 60.0, 250.0, 140.0, 60.0, 120.0, 130.0, 150.0, 220.0, 100.0, 90.0, 40.0, 110.0, 300.0, 240.0, 130.0, 190.0, 80.0, 200.0, 110.0, 50.0, 180.0, 60.0, 30.0, 78.0, 150.0, 120.0, 100.0, 44.0, 120.0, 100.0, 110.0, 160.0, 112.0, 51.0, 140.0, 70.0, 20.0, 140.0, 71.0, 91.0, 250.0, 160.0, 120.0, 80.0, 150.0, 160.0, 78.0, 110.0, 137.0, 70.0, 140.0, 70.0, 138.0, 120.0, 100.0, 40.0, 94.0, 18.0, 150.0, 60.0, 66.0, 90.0, 90.0, 70.0, 120.0, 130.0, 50.0, 20.0, 140.0, 100.0, 60.0, 90.0, 137.0, 170.0, 91.0, 30.0, 120.0, 190.0, 100.0, 50.0, 29.0, 80.0, 80.0, 70.0, 80.0, 15.0, 68.0, 120.0, 120.0, 130.0, 90.0, 80.0, 160.0, 98.0, 10.0, 45.0, 100.0, 56.0, 40.0, 58.0, 90.0, 120.0, 160.0, 20.0, 140.0, 70.0, 140.0, 130.0, 120.0, 230.0, 200.0, 19.0, 60.0, 150.0, 98.0, 40.0, 60.0, 60.0, 39.0, 100.0, 70.0, 86.0, 139.0, 15.0, 50.0, 60.0, 90.0, 100.0, 90.0, 60.0, 100.0, 50.0, 60.0, 60.0, 60.0, 70.0, 90.0, 400.0, 100.0, 110.0, 100.0, 120.0, 89.0, 80.0, 170.0, 120.0, 180.0, 120.0, 70.0, 120.0, 170.0, 170.0, 200.0, 100.0, 62.0, 50.0, -30.0, 70.0, 40.0, 120.0, 70.0, 30.0, 100.0, 70.0, 70.0, 120.0, 100.0, 90.0, 70.0, 170.0, 70.0, 140.0, 150.0, 70.0, 10.0, 90.0, 120.0, 120.0, 90.0, 70.0, 200.0, 140.0, 146.0, 200.0, 70.0, 98.0, 40.0, -26.0, 219.0, 30.0, 4.0, 130.0, 14.0, 79.0, 7.0, 90.0, 22.0, 50.0, 40.0, 0.0, 90.0, 100.0, 49.0, 26.0, 160.0, 145.0, 130.0, 160.0, 160.0, 110.0, 30.0, 105.0, 40.0, 43.0, 80.0, 70.0, 140.0, 60.0, 210.0, 110.0, 190.0, 110.0, 50.0, 27.0, 110.0, 30.0, 57.0, 20.0, 20.0, 55.0, 126.0, 60.0, 130.0, 90.0, 80.0, 130.0, 140.0, 130.0, 70.0, 120.0, 90.0, 110.0, 80.0, 110.0, 80.0, -65.0, 140.0, 90.0, 70.0, 100.0, 70.0, 70.0, 100.0, 50.0, 170.0, 80.0, 90.0, 50.0, 100.0, 90.0, 60.0, 42.0, 130.0, 210.0, 150.0, 80.0, 143.0, 102.0, 70.0, 80.0, 170.0, 90.0, 160.0, 90.0, 190.0, 140.0, 70.0, 50.0, 180.0, 260.0, 70.0, 20.0, 60.0, 130.0, 33.0, 90.0, 10.0, 40.0, 20.0, 17.0, 16.0, 100.0, 12.0, 30.0, 160.0, 210.0, 11.0, 40.0, 70.0, 50.0, 40.0, 10.0, 90.0, 80.0, 40.0, 50.0, 130.0, 120.0, 170.0, 70.0, 20.0, 90.0, 70.0, 60.0, 80.0, 170.0, 90.0, 60.0, 90.0, 40.0, 100.0, 130.0, 100.0, 100.0, 120.0, 40.0, 130.0, 90.0, 70.0, 40.0, 110.0, 130.0, 60.0, 125.0, 45.0, 39.0, 140.0, 50.0, 120.0, 90.0, 70.0, 10.0, 56.0, 150.0, 120.0, 60.0, 100.0, 120.0, 80.0, 150.0, 155.0, 160.0, 170.0, 76.0, 180.0, 90.0, 104.0, 150.0, 60.0, 90.0, 190.0, 80.0, 40.0, 60.0, 130.0, 60.0, 110.0, 100.0, 150.0, 150.0, 80.0, 90.0, 150.0, 130.0, 170.0, 110.0, 130.0, 115.0, 150.0, 100.0, 100.0, 120.0, 110.0, 150.0, 140.0, 90.0, 140.0, 90.0, 60.0, 110.0, 100.0, 80.0, 150.0, 13.0, 40.0, 48.0, 20.0, 50.0, 130.0, 40.0, 50.0, 140.0, 100.0, 200.0, 90.0, 130.0, 190.0, 120.0, 90.0, 60.0, 130.0, 90.0, 120.0, 160.0, 100.0, 260.0, 40.0, 20.0, 130.0, 130.0, 120.0, 50.0, 110.0, 90.0, 120.0, 56.0, 110.0, 100.0, 87.0, 210.0, 60.0, 230.0, 90.0, 90.0, 140.0, 110.0, 240.0, 110.0, 70.0, 180.0, 70.0, 100.0, 59.0, 80.0, 210.0, 90.0, 130.0, 50.0, 90.0, 120.0, 70.0, 90.0, 200.0, 30.0, 80.0, 120.0, 150.0, 70.0, 60.0, 140.0, 80.0, 60.0, 80.0, 100.0, 110.0, 46.0, 76.0, 50.0, 40.0, 7.0, 70.0, 130.0, 120.0, 90.0, 80.0, 100.0, 108.0, 150.0, 100.0, 70.0, 60.0, 210.0, 120.0, 120.0, 90.0, 100.0, 120.0, 50.0, 30.0, 110.0, 90.0, 160.0, 70.0, 57.0, 120.0, 70.0, 57.0, 31.0, 140.0, 90.0, 100.0, 130.0, 100.0, 120.0, 70.0, 30.0, 170.0, 130.0, 210.0, 60.0, 140.0, 138.0, 151.0, 27.0, 80.0, 180.0, 90.0, 140.0, 70.0, 170.0, 70.0, 170.0, 190.0, 150.0, 120.0, 120.0, 90.0, 160.0, 90.0, 60.0, 180.0, 30.0, 30.0, 70.0, 80.0, 90.0, 60.0, 90.0, 10.0, 90.0, 130.0, 66.0, 134.0, 130.0, 59.0, 80.0, 60.0, 120.0, 60.0, 40.0, 110.0, 150.0, 170.0, 100.0, 100.0, 210.0, 100.0, 110.0, 10.0, 50.0, 90.0, 108.0, 80.0, 130.0, 80.0, 40.0, 35.0, 190.0, 70.0, 150.0, 127.0, 20.0, 70.0, 80.0, 90.0, 100.0, 220.0, 70.0, 30.0, 60.0, 40.0, 110.0, 50.0, 50.0, 160.0, 140.0, 110.0, 100.0, 140.0, 160.0, 100.0, 60.0, 90.0, 138.0, 180.0, 77.0, 110.0, 97.0, 140.0, 190.0, 177.0, 40.0, 50.0, 50.0, 30.0, 90.0, 150.0, 210.0, 60.0, 110.0, 30.0, 80.0, 110.0, 159.0, 100.0, 90.0, 140.0, 70.0, 60.0, 120.0, 120.0, 60.0, 90.0, 140.0, 100.0, 100.0, 140.0, 290.0, 60.0, 60.0, 80.0, 160.0, 170.0, 240.0, 60.0, 160.0, 82.0, 47.0, 65.0, 90.0, 180.0, 70.0, 90.0, 0.0, 50.0, 90.0, 40.0, 110.0, 70.0, 40.0, 50.0, 60.0, 190.0, 120.0, 80.0, 100.0, 150.0, 200.0, 50.0, 80.0, 70.0, 90.0, 52.0, 161.0, 150.0, 100.0, 80.0, 138.0, 59.0, 120.0, 92.0, 170.0, 60.0, 60.0, 30.0, 60.0, 50.0, 20.0, 250.0, 130.0, 70.0, 160.0, 80.0, 180.0, 90.0, 110.0, 220.0, 200.0, 60.0, 130.0, 230.0, 47.0, 88.0, 130.0, 132.0, 160.0, 140.0, 130.0, 130.0, 13.0, 90.0, 110.0, 77.0, 80.0, 86.0, 130.0, 120.0, 100.0, 140.0, 58.0, 210.0, 50.0, 180.0, 90.0, 30.0, 40.0, 50.0, 47.0, 110.0, 80.0, 80.0, 150.0, 90.0, 200.0, 77.0, 46.0, 60.0, 90.0, 160.0, 40.0, 110.0, 79.0, 100.0, 109.0, 80.0, 110.0, 30.0, 90.0, 150.0, 160.0, 80.0, 100.0, 140.0, 170.0, 110.0, 130.0, 190.0, 180.0, 144.0, 4.0, 90.0, 140.0, 20.0, 66.0, 28.0, 120.0, 30.0, 20.0, 108.0, 20.0, 26.0, 120.0, 66.0, 150.0, 120.0, 140.0, 216.0, 100.0, 140.0, 60.0, 150.0, 70.0, 49.0, 130.0, 80.0, 7.0, 190.0, -8.0, 194.0, 130.0, 70.0, 130.0, 140.0, 60.0, 55.0, 110.0, 130.0, 160.0, 140.0, 180.0, 130.0, 140.0, 98.0, 190.0, 90.0, 140.0, 80.0, 70.0, 120.0, 140.0, 67.0, 60.0, 100.0, 240.0, 40.0, 80.0, 40.0, 80.0, 120.0, 100.0, 200.0, 210.0, 16.0, 50.0, 50.0, 56.0, 120.0, 50.0, 60.0, 30.0, 70.0, 80.0, 130.0, 20.0, 80.0, 30.0, 80.0, 110.0, 40.0, 160.0, -30.0, 120.0, 13.0, 110.0, 40.0, 110.0, 110.0, 80.0, 65.0, 63.0, 70.0, 140.0, -30.0, 190.0, 110.0, 55.0, 50.0, 100.0, 82.0, 90.0, 120.0, 140.0, 150.0, 150.0, 100.0, 110.0, 80.0, 120.0, 70.0, 40.0, 70.0, 56.0, 50.0, 70.0, 110.0, 27.0, 40.0, 30.0, 109.0, 25.0, 60.0, 130.0, 32.0, 20.0, 40.0, 97.0, 200.0, 130.0, 75.0, 51.0, 130.0, 140.0, 80.0, 70.0, 60.0, 240.0, 80.0, 110.0, 160.0, 200.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6057775032515744, "mean_inference_ms": 1.604076569703938, "mean_action_processing_ms": 0.49872500183375096, "mean_env_wait_ms": 1.1123234796141457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011972188949584961, "StateBufferConnector_ms": 0.009233236312866211, "ViewRequirementAgentConnector_ms": 0.407625675201416}, "num_episodes": 18, "episode_return_max": 1590.0, "episode_return_min": 436.0, "episode_return_mean": 989.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.653729379168805, "num_env_steps_trained_throughput_per_sec": 20.653729379168805, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 5840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5840000, "timers": {"training_iteration_time_ms": 193634.58, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193634.532, "sample_time_ms": 2636.765, "learn_time_ms": 190978.384, "learn_throughput": 20.945, "synch_weights_time_ms": 11.348}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "done": false, "training_iteration": 146, "trial_id": "1841f_00000", "date": "2024-08-08_07-34-01", "timestamp": 1723116841, "time_this_iter_s": 193.68055605888367, "time_total_s": 29623.99360346794, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2b1f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29623.99360346794, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 17.16861313868613, "ram_util_percent": 77.66131386861314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.647400308518618, "cur_kl_coeff": 3.0789414167404177, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.010381778056412952, "vf_loss": 8.406698654050897, "vf_explained_var": -0.0457509177370955, "kl": Infinity, "entropy": 0.5318777808048728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1375635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "env_runners": {"episode_reward_max": 1460.0, "episode_reward_min": 436.0, "episode_reward_mean": 965.22, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 400.0}, "policy_reward_mean": {"policy_0": 96.522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1007.0, 853.0, 737.0, 1330.0, 696.0, 790.0, 1100.0, 1239.0, 852.0, 890.0, 1060.0, 921.0, 522.0, 1070.0, 1048.0, 605.0, 1040.0, 785.0, 860.0, 1177.0, 1300.0, 436.0, 723.0, 780.0, 850.0, 930.0, 869.0, 1001.0, 1270.0, 960.0, 1245.0, 1110.0, 621.0, 1250.0, 1170.0, 993.0, 1330.0, 999.0, 1020.0, 639.0, 1008.0, 1040.0, 895.0, 1160.0, 1116.0, 1330.0, 680.0, 859.0, 1090.0, 1010.0, 780.0, 1120.0, 1259.0, 820.0, 1049.0, 1120.0, 1254.0, 610.0, 1100.0, 1042.0, 900.0, 1460.0, 1060.0, 1111.0, 757.0, 1023.0, 988.0, 1258.0, 578.0, 1262.0, 912.0, 1235.0, 1135.0, 1060.0, 712.0, 700.0, 781.0, 907.0, 1030.0, 577.0, 905.0, 1210.0, 681.0, 873.0, 800.0, 860.0, 930.0, 1015.0, 874.0, 921.0, 1078.0, 455.0, 1458.0, 1085.0, 963.0, 678.0, 760.0, 1078.0, 1140.0, 892.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 137.0, 170.0, 91.0, 30.0, 120.0, 190.0, 100.0, 50.0, 29.0, 80.0, 80.0, 70.0, 80.0, 15.0, 68.0, 120.0, 120.0, 130.0, 90.0, 80.0, 160.0, 98.0, 10.0, 45.0, 100.0, 56.0, 40.0, 58.0, 90.0, 120.0, 160.0, 20.0, 140.0, 70.0, 140.0, 130.0, 120.0, 230.0, 200.0, 19.0, 60.0, 150.0, 98.0, 40.0, 60.0, 60.0, 39.0, 100.0, 70.0, 86.0, 139.0, 15.0, 50.0, 60.0, 90.0, 100.0, 90.0, 60.0, 100.0, 50.0, 60.0, 60.0, 60.0, 70.0, 90.0, 400.0, 100.0, 110.0, 100.0, 120.0, 89.0, 80.0, 170.0, 120.0, 180.0, 120.0, 70.0, 120.0, 170.0, 170.0, 200.0, 100.0, 62.0, 50.0, -30.0, 70.0, 40.0, 120.0, 70.0, 30.0, 100.0, 70.0, 70.0, 120.0, 100.0, 90.0, 70.0, 170.0, 70.0, 140.0, 150.0, 70.0, 10.0, 90.0, 120.0, 120.0, 90.0, 70.0, 200.0, 140.0, 146.0, 200.0, 70.0, 98.0, 40.0, -26.0, 219.0, 30.0, 4.0, 130.0, 14.0, 79.0, 7.0, 90.0, 22.0, 50.0, 40.0, 0.0, 90.0, 100.0, 49.0, 26.0, 160.0, 145.0, 130.0, 160.0, 160.0, 110.0, 30.0, 105.0, 40.0, 43.0, 80.0, 70.0, 140.0, 60.0, 210.0, 110.0, 190.0, 110.0, 50.0, 27.0, 110.0, 30.0, 57.0, 20.0, 20.0, 55.0, 126.0, 60.0, 130.0, 90.0, 80.0, 130.0, 140.0, 130.0, 70.0, 120.0, 90.0, 110.0, 80.0, 110.0, 80.0, -65.0, 140.0, 90.0, 70.0, 100.0, 70.0, 70.0, 100.0, 50.0, 170.0, 80.0, 90.0, 50.0, 100.0, 90.0, 60.0, 42.0, 130.0, 210.0, 150.0, 80.0, 143.0, 102.0, 70.0, 80.0, 170.0, 90.0, 160.0, 90.0, 190.0, 140.0, 70.0, 50.0, 180.0, 260.0, 70.0, 20.0, 60.0, 130.0, 33.0, 90.0, 10.0, 40.0, 20.0, 17.0, 16.0, 100.0, 12.0, 30.0, 160.0, 210.0, 11.0, 40.0, 70.0, 50.0, 40.0, 10.0, 90.0, 80.0, 40.0, 50.0, 130.0, 120.0, 170.0, 70.0, 20.0, 90.0, 70.0, 60.0, 80.0, 170.0, 90.0, 60.0, 90.0, 40.0, 100.0, 130.0, 100.0, 100.0, 120.0, 40.0, 130.0, 90.0, 70.0, 40.0, 110.0, 130.0, 60.0, 125.0, 45.0, 39.0, 140.0, 50.0, 120.0, 90.0, 70.0, 10.0, 56.0, 150.0, 120.0, 60.0, 100.0, 120.0, 80.0, 150.0, 155.0, 160.0, 170.0, 76.0, 180.0, 90.0, 104.0, 150.0, 60.0, 90.0, 190.0, 80.0, 40.0, 60.0, 130.0, 60.0, 110.0, 100.0, 150.0, 150.0, 80.0, 90.0, 150.0, 130.0, 170.0, 110.0, 130.0, 115.0, 150.0, 100.0, 100.0, 120.0, 110.0, 150.0, 140.0, 90.0, 140.0, 90.0, 60.0, 110.0, 100.0, 80.0, 150.0, 13.0, 40.0, 48.0, 20.0, 50.0, 130.0, 40.0, 50.0, 140.0, 100.0, 200.0, 90.0, 130.0, 190.0, 120.0, 90.0, 60.0, 130.0, 90.0, 120.0, 160.0, 100.0, 260.0, 40.0, 20.0, 130.0, 130.0, 120.0, 50.0, 110.0, 90.0, 120.0, 56.0, 110.0, 100.0, 87.0, 210.0, 60.0, 230.0, 90.0, 90.0, 140.0, 110.0, 240.0, 110.0, 70.0, 180.0, 70.0, 100.0, 59.0, 80.0, 210.0, 90.0, 130.0, 50.0, 90.0, 120.0, 70.0, 90.0, 200.0, 30.0, 80.0, 120.0, 150.0, 70.0, 60.0, 140.0, 80.0, 60.0, 80.0, 100.0, 110.0, 46.0, 76.0, 50.0, 40.0, 7.0, 70.0, 130.0, 120.0, 90.0, 80.0, 100.0, 108.0, 150.0, 100.0, 70.0, 60.0, 210.0, 120.0, 120.0, 90.0, 100.0, 120.0, 50.0, 30.0, 110.0, 90.0, 160.0, 70.0, 57.0, 120.0, 70.0, 57.0, 31.0, 140.0, 90.0, 100.0, 130.0, 100.0, 120.0, 70.0, 30.0, 170.0, 130.0, 210.0, 60.0, 140.0, 138.0, 151.0, 27.0, 80.0, 180.0, 90.0, 140.0, 70.0, 170.0, 70.0, 170.0, 190.0, 150.0, 120.0, 120.0, 90.0, 160.0, 90.0, 60.0, 180.0, 30.0, 30.0, 70.0, 80.0, 90.0, 60.0, 90.0, 10.0, 90.0, 130.0, 66.0, 134.0, 130.0, 59.0, 80.0, 60.0, 120.0, 60.0, 40.0, 110.0, 150.0, 170.0, 100.0, 100.0, 210.0, 100.0, 110.0, 10.0, 50.0, 90.0, 108.0, 80.0, 130.0, 80.0, 40.0, 35.0, 190.0, 70.0, 150.0, 127.0, 20.0, 70.0, 80.0, 90.0, 100.0, 220.0, 70.0, 30.0, 60.0, 40.0, 110.0, 50.0, 50.0, 160.0, 140.0, 110.0, 100.0, 140.0, 160.0, 100.0, 60.0, 90.0, 138.0, 180.0, 77.0, 110.0, 97.0, 140.0, 190.0, 177.0, 40.0, 50.0, 50.0, 30.0, 90.0, 150.0, 210.0, 60.0, 110.0, 30.0, 80.0, 110.0, 159.0, 100.0, 90.0, 140.0, 70.0, 60.0, 120.0, 120.0, 60.0, 90.0, 140.0, 100.0, 100.0, 140.0, 290.0, 60.0, 60.0, 80.0, 160.0, 170.0, 240.0, 60.0, 160.0, 82.0, 47.0, 65.0, 90.0, 180.0, 70.0, 90.0, 0.0, 50.0, 90.0, 40.0, 110.0, 70.0, 40.0, 50.0, 60.0, 190.0, 120.0, 80.0, 100.0, 150.0, 200.0, 50.0, 80.0, 70.0, 90.0, 52.0, 161.0, 150.0, 100.0, 80.0, 138.0, 59.0, 120.0, 92.0, 170.0, 60.0, 60.0, 30.0, 60.0, 50.0, 20.0, 250.0, 130.0, 70.0, 160.0, 80.0, 180.0, 90.0, 110.0, 220.0, 200.0, 60.0, 130.0, 230.0, 47.0, 88.0, 130.0, 132.0, 160.0, 140.0, 130.0, 130.0, 13.0, 90.0, 110.0, 77.0, 80.0, 86.0, 130.0, 120.0, 100.0, 140.0, 58.0, 210.0, 50.0, 180.0, 90.0, 30.0, 40.0, 50.0, 47.0, 110.0, 80.0, 80.0, 150.0, 90.0, 200.0, 77.0, 46.0, 60.0, 90.0, 160.0, 40.0, 110.0, 79.0, 100.0, 109.0, 80.0, 110.0, 30.0, 90.0, 150.0, 160.0, 80.0, 100.0, 140.0, 170.0, 110.0, 130.0, 190.0, 180.0, 144.0, 4.0, 90.0, 140.0, 20.0, 66.0, 28.0, 120.0, 30.0, 20.0, 108.0, 20.0, 26.0, 120.0, 66.0, 150.0, 120.0, 140.0, 216.0, 100.0, 140.0, 60.0, 150.0, 70.0, 49.0, 130.0, 80.0, 7.0, 190.0, -8.0, 194.0, 130.0, 70.0, 130.0, 140.0, 60.0, 55.0, 110.0, 130.0, 160.0, 140.0, 180.0, 130.0, 140.0, 98.0, 190.0, 90.0, 140.0, 80.0, 70.0, 120.0, 140.0, 67.0, 60.0, 100.0, 240.0, 40.0, 80.0, 40.0, 80.0, 120.0, 100.0, 200.0, 210.0, 16.0, 50.0, 50.0, 56.0, 120.0, 50.0, 60.0, 30.0, 70.0, 80.0, 130.0, 20.0, 80.0, 30.0, 80.0, 110.0, 40.0, 160.0, -30.0, 120.0, 13.0, 110.0, 40.0, 110.0, 110.0, 80.0, 65.0, 63.0, 70.0, 140.0, -30.0, 190.0, 110.0, 55.0, 50.0, 100.0, 82.0, 90.0, 120.0, 140.0, 150.0, 150.0, 100.0, 110.0, 80.0, 120.0, 70.0, 40.0, 70.0, 56.0, 50.0, 70.0, 110.0, 27.0, 40.0, 30.0, 109.0, 25.0, 60.0, 130.0, 32.0, 20.0, 40.0, 97.0, 200.0, 130.0, 75.0, 51.0, 130.0, 140.0, 80.0, 70.0, 60.0, 240.0, 80.0, 110.0, 160.0, 200.0, 70.0, 140.0, 120.0, 85.0, 36.0, 30.0, 50.0, 150.0, 10.0, 20.0, 40.0, 13.0, 95.0, 130.0, 20.0, 75.0, 90.0, 60.0, 180.0, 70.0, 140.0, 150.0, 120.0, -50.0, 100.0, 70.0, 100.0, 120.0, 40.0, 60.0, 90.0, 120.0, 150.0, 80.0, 40.0, 80.0, 90.0, -10.0, 230.0, 40.0, 40.0, 100.0, 110.0, 80.0, 10.0, 50.0, 190.0, 60.0, 70.0, 120.0, 140.0, 100.0, 70.0, 80.0, 70.0, 170.0, 150.0, 110.0, 100.0, 60.0, 105.0, 90.0, 160.0, 19.0, 60.0, 110.0, 150.0, 50.0, 140.0, 60.0, 35.0, 80.0, 100.0, 80.0, 121.0, 70.0, 130.0, 70.0, 70.0, 120.0, 80.0, 120.0, 70.0, 80.0, 90.0, 160.0, 178.0, 180.0, 0.0, 140.0, 60.0, 60.0, 40.0, 0.0, 20.0, 40.0, 50.0, 20.0, 43.0, 2.0, 180.0, 130.0, 130.0, 210.0, 140.0, 180.0, 125.0, 66.0, 150.0, 130.0, 197.0, 110.0, 110.0, 80.0, 110.0, 120.0, 90.0, 200.0, 105.0, 100.0, 60.0, 104.0, 80.0, 20.0, 115.0, 80.0, 130.0, 90.0, 120.0, 24.0, 200.0, 40.0, 29.0, 110.0, 50.0, 130.0, 60.0, 49.0, 70.0, 100.0, 40.0, 50.0, 60.0, 170.0, 40.0, 70.0, 110.0, 50.0, 80.0, 50.0, 80.0, 170.0, 58.0, 80.0, 150.0, 90.0, 80.0, 220.0, 50.0, 50.0, 130.0, 90.0, 130.0, 210.0, 120.0, 150.0, 60.0, 60.0, 60.0, 130.0, 130.0, 80.0, 20.0, 160.0, 47.0, 210.0, 40.0, 90.0, 100.0, 35.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6044863565845662, "mean_inference_ms": 1.6029794921559684, "mean_action_processing_ms": 0.49845278676093796, "mean_env_wait_ms": 1.1118572496473107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012437820434570312, "StateBufferConnector_ms": 0.009227275848388672, "ViewRequirementAgentConnector_ms": 0.4028596878051758}, "num_episodes": 18, "episode_return_max": 1460.0, "episode_return_min": 436.0, "episode_return_mean": 965.22}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.703889950205138, "num_env_steps_trained_throughput_per_sec": 20.703889950205138, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 5880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5880000, "timers": {"training_iteration_time_ms": 193665.922, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193665.875, "sample_time_ms": 2625.919, "learn_time_ms": 191020.614, "learn_throughput": 20.94, "synch_weights_time_ms": 11.239}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "done": false, "training_iteration": 147, "trial_id": "1841f_00000", "date": "2024-08-08_07-37-14", "timestamp": 1723117034, "time_this_iter_s": 193.21018481254578, "time_total_s": 29817.203788280487, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2b1fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29817.203788280487, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 16.963868613138686, "ram_util_percent": 77.11934306569343}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.227287387238524, "cur_kl_coeff": 4.618412125110625, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.316353871393254, "policy_loss": -0.00863409159259714, "vf_loss": 8.320848907931799, "vf_explained_var": -0.017502626399008736, "kl": 0.0008962081520855706, "entropy": 0.5229349902611825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1385025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 436.0, "episode_reward_mean": 973.91, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -57.0}, "policy_reward_max": {"policy_0": 290.0}, "policy_reward_mean": {"policy_0": 97.391}, "custom_metrics": {}, "hist_stats": {"episode_reward": [860.0, 1177.0, 1300.0, 436.0, 723.0, 780.0, 850.0, 930.0, 869.0, 1001.0, 1270.0, 960.0, 1245.0, 1110.0, 621.0, 1250.0, 1170.0, 993.0, 1330.0, 999.0, 1020.0, 639.0, 1008.0, 1040.0, 895.0, 1160.0, 1116.0, 1330.0, 680.0, 859.0, 1090.0, 1010.0, 780.0, 1120.0, 1259.0, 820.0, 1049.0, 1120.0, 1254.0, 610.0, 1100.0, 1042.0, 900.0, 1460.0, 1060.0, 1111.0, 757.0, 1023.0, 988.0, 1258.0, 578.0, 1262.0, 912.0, 1235.0, 1135.0, 1060.0, 712.0, 700.0, 781.0, 907.0, 1030.0, 577.0, 905.0, 1210.0, 681.0, 873.0, 800.0, 860.0, 930.0, 1015.0, 874.0, 921.0, 1078.0, 455.0, 1458.0, 1085.0, 963.0, 678.0, 760.0, 1078.0, 1140.0, 892.0, 846.0, 580.0, 1141.0, 1230.0, 888.0, 787.0, 870.0, 1480.0, 1015.0, 731.0, 1148.0, 510.0, 950.0, 1013.0, 913.0, 917.0, 1105.0, 1290.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 100.0, 50.0, 170.0, 80.0, 90.0, 50.0, 100.0, 90.0, 60.0, 42.0, 130.0, 210.0, 150.0, 80.0, 143.0, 102.0, 70.0, 80.0, 170.0, 90.0, 160.0, 90.0, 190.0, 140.0, 70.0, 50.0, 180.0, 260.0, 70.0, 20.0, 60.0, 130.0, 33.0, 90.0, 10.0, 40.0, 20.0, 17.0, 16.0, 100.0, 12.0, 30.0, 160.0, 210.0, 11.0, 40.0, 70.0, 50.0, 40.0, 10.0, 90.0, 80.0, 40.0, 50.0, 130.0, 120.0, 170.0, 70.0, 20.0, 90.0, 70.0, 60.0, 80.0, 170.0, 90.0, 60.0, 90.0, 40.0, 100.0, 130.0, 100.0, 100.0, 120.0, 40.0, 130.0, 90.0, 70.0, 40.0, 110.0, 130.0, 60.0, 125.0, 45.0, 39.0, 140.0, 50.0, 120.0, 90.0, 70.0, 10.0, 56.0, 150.0, 120.0, 60.0, 100.0, 120.0, 80.0, 150.0, 155.0, 160.0, 170.0, 76.0, 180.0, 90.0, 104.0, 150.0, 60.0, 90.0, 190.0, 80.0, 40.0, 60.0, 130.0, 60.0, 110.0, 100.0, 150.0, 150.0, 80.0, 90.0, 150.0, 130.0, 170.0, 110.0, 130.0, 115.0, 150.0, 100.0, 100.0, 120.0, 110.0, 150.0, 140.0, 90.0, 140.0, 90.0, 60.0, 110.0, 100.0, 80.0, 150.0, 13.0, 40.0, 48.0, 20.0, 50.0, 130.0, 40.0, 50.0, 140.0, 100.0, 200.0, 90.0, 130.0, 190.0, 120.0, 90.0, 60.0, 130.0, 90.0, 120.0, 160.0, 100.0, 260.0, 40.0, 20.0, 130.0, 130.0, 120.0, 50.0, 110.0, 90.0, 120.0, 56.0, 110.0, 100.0, 87.0, 210.0, 60.0, 230.0, 90.0, 90.0, 140.0, 110.0, 240.0, 110.0, 70.0, 180.0, 70.0, 100.0, 59.0, 80.0, 210.0, 90.0, 130.0, 50.0, 90.0, 120.0, 70.0, 90.0, 200.0, 30.0, 80.0, 120.0, 150.0, 70.0, 60.0, 140.0, 80.0, 60.0, 80.0, 100.0, 110.0, 46.0, 76.0, 50.0, 40.0, 7.0, 70.0, 130.0, 120.0, 90.0, 80.0, 100.0, 108.0, 150.0, 100.0, 70.0, 60.0, 210.0, 120.0, 120.0, 90.0, 100.0, 120.0, 50.0, 30.0, 110.0, 90.0, 160.0, 70.0, 57.0, 120.0, 70.0, 57.0, 31.0, 140.0, 90.0, 100.0, 130.0, 100.0, 120.0, 70.0, 30.0, 170.0, 130.0, 210.0, 60.0, 140.0, 138.0, 151.0, 27.0, 80.0, 180.0, 90.0, 140.0, 70.0, 170.0, 70.0, 170.0, 190.0, 150.0, 120.0, 120.0, 90.0, 160.0, 90.0, 60.0, 180.0, 30.0, 30.0, 70.0, 80.0, 90.0, 60.0, 90.0, 10.0, 90.0, 130.0, 66.0, 134.0, 130.0, 59.0, 80.0, 60.0, 120.0, 60.0, 40.0, 110.0, 150.0, 170.0, 100.0, 100.0, 210.0, 100.0, 110.0, 10.0, 50.0, 90.0, 108.0, 80.0, 130.0, 80.0, 40.0, 35.0, 190.0, 70.0, 150.0, 127.0, 20.0, 70.0, 80.0, 90.0, 100.0, 220.0, 70.0, 30.0, 60.0, 40.0, 110.0, 50.0, 50.0, 160.0, 140.0, 110.0, 100.0, 140.0, 160.0, 100.0, 60.0, 90.0, 138.0, 180.0, 77.0, 110.0, 97.0, 140.0, 190.0, 177.0, 40.0, 50.0, 50.0, 30.0, 90.0, 150.0, 210.0, 60.0, 110.0, 30.0, 80.0, 110.0, 159.0, 100.0, 90.0, 140.0, 70.0, 60.0, 120.0, 120.0, 60.0, 90.0, 140.0, 100.0, 100.0, 140.0, 290.0, 60.0, 60.0, 80.0, 160.0, 170.0, 240.0, 60.0, 160.0, 82.0, 47.0, 65.0, 90.0, 180.0, 70.0, 90.0, 0.0, 50.0, 90.0, 40.0, 110.0, 70.0, 40.0, 50.0, 60.0, 190.0, 120.0, 80.0, 100.0, 150.0, 200.0, 50.0, 80.0, 70.0, 90.0, 52.0, 161.0, 150.0, 100.0, 80.0, 138.0, 59.0, 120.0, 92.0, 170.0, 60.0, 60.0, 30.0, 60.0, 50.0, 20.0, 250.0, 130.0, 70.0, 160.0, 80.0, 180.0, 90.0, 110.0, 220.0, 200.0, 60.0, 130.0, 230.0, 47.0, 88.0, 130.0, 132.0, 160.0, 140.0, 130.0, 130.0, 13.0, 90.0, 110.0, 77.0, 80.0, 86.0, 130.0, 120.0, 100.0, 140.0, 58.0, 210.0, 50.0, 180.0, 90.0, 30.0, 40.0, 50.0, 47.0, 110.0, 80.0, 80.0, 150.0, 90.0, 200.0, 77.0, 46.0, 60.0, 90.0, 160.0, 40.0, 110.0, 79.0, 100.0, 109.0, 80.0, 110.0, 30.0, 90.0, 150.0, 160.0, 80.0, 100.0, 140.0, 170.0, 110.0, 130.0, 190.0, 180.0, 144.0, 4.0, 90.0, 140.0, 20.0, 66.0, 28.0, 120.0, 30.0, 20.0, 108.0, 20.0, 26.0, 120.0, 66.0, 150.0, 120.0, 140.0, 216.0, 100.0, 140.0, 60.0, 150.0, 70.0, 49.0, 130.0, 80.0, 7.0, 190.0, -8.0, 194.0, 130.0, 70.0, 130.0, 140.0, 60.0, 55.0, 110.0, 130.0, 160.0, 140.0, 180.0, 130.0, 140.0, 98.0, 190.0, 90.0, 140.0, 80.0, 70.0, 120.0, 140.0, 67.0, 60.0, 100.0, 240.0, 40.0, 80.0, 40.0, 80.0, 120.0, 100.0, 200.0, 210.0, 16.0, 50.0, 50.0, 56.0, 120.0, 50.0, 60.0, 30.0, 70.0, 80.0, 130.0, 20.0, 80.0, 30.0, 80.0, 110.0, 40.0, 160.0, -30.0, 120.0, 13.0, 110.0, 40.0, 110.0, 110.0, 80.0, 65.0, 63.0, 70.0, 140.0, -30.0, 190.0, 110.0, 55.0, 50.0, 100.0, 82.0, 90.0, 120.0, 140.0, 150.0, 150.0, 100.0, 110.0, 80.0, 120.0, 70.0, 40.0, 70.0, 56.0, 50.0, 70.0, 110.0, 27.0, 40.0, 30.0, 109.0, 25.0, 60.0, 130.0, 32.0, 20.0, 40.0, 97.0, 200.0, 130.0, 75.0, 51.0, 130.0, 140.0, 80.0, 70.0, 60.0, 240.0, 80.0, 110.0, 160.0, 200.0, 70.0, 140.0, 120.0, 85.0, 36.0, 30.0, 50.0, 150.0, 10.0, 20.0, 40.0, 13.0, 95.0, 130.0, 20.0, 75.0, 90.0, 60.0, 180.0, 70.0, 140.0, 150.0, 120.0, -50.0, 100.0, 70.0, 100.0, 120.0, 40.0, 60.0, 90.0, 120.0, 150.0, 80.0, 40.0, 80.0, 90.0, -10.0, 230.0, 40.0, 40.0, 100.0, 110.0, 80.0, 10.0, 50.0, 190.0, 60.0, 70.0, 120.0, 140.0, 100.0, 70.0, 80.0, 70.0, 170.0, 150.0, 110.0, 100.0, 60.0, 105.0, 90.0, 160.0, 19.0, 60.0, 110.0, 150.0, 50.0, 140.0, 60.0, 35.0, 80.0, 100.0, 80.0, 121.0, 70.0, 130.0, 70.0, 70.0, 120.0, 80.0, 120.0, 70.0, 80.0, 90.0, 160.0, 178.0, 180.0, 0.0, 140.0, 60.0, 60.0, 40.0, 0.0, 20.0, 40.0, 50.0, 20.0, 43.0, 2.0, 180.0, 130.0, 130.0, 210.0, 140.0, 180.0, 125.0, 66.0, 150.0, 130.0, 197.0, 110.0, 110.0, 80.0, 110.0, 120.0, 90.0, 200.0, 105.0, 100.0, 60.0, 104.0, 80.0, 20.0, 115.0, 80.0, 130.0, 90.0, 120.0, 24.0, 200.0, 40.0, 29.0, 110.0, 50.0, 130.0, 60.0, 49.0, 70.0, 100.0, 40.0, 50.0, 60.0, 170.0, 40.0, 70.0, 110.0, 50.0, 80.0, 50.0, 80.0, 170.0, 58.0, 80.0, 150.0, 90.0, 80.0, 220.0, 50.0, 50.0, 130.0, 90.0, 130.0, 210.0, 120.0, 150.0, 60.0, 60.0, 60.0, 130.0, 130.0, 80.0, 20.0, 160.0, 47.0, 210.0, 40.0, 90.0, 100.0, 35.0, 110.0, 40.0, 110.0, 130.0, 89.0, 60.0, 80.0, 100.0, 130.0, 47.0, 60.0, 40.0, 120.0, 70.0, 50.0, 110.0, 30.0, 60.0, 10.0, 60.0, 30.0, 150.0, 110.0, 60.0, 70.0, 160.0, 221.0, 120.0, 60.0, 70.0, 120.0, 150.0, 120.0, 190.0, 70.0, 100.0, 180.0, 160.0, 40.0, 80.0, 140.0, 109.0, 60.0, 30.0, 80.0, 160.0, 80.0, 140.0, 49.0, 60.0, 120.0, 52.0, 70.0, 120.0, 25.0, 180.0, 65.0, 40.0, 110.0, 55.0, 70.0, 80.0, 80.0, 40.0, 100.0, 70.0, 130.0, 180.0, 50.0, 90.0, 50.0, 100.0, 120.0, 270.0, 170.0, 40.0, 120.0, 230.0, 90.0, 150.0, 190.0, 70.0, 180.0, 110.0, 160.0, 100.0, 70.0, 35.0, 160.0, 70.0, 60.0, 80.0, 78.0, 37.0, 40.0, 46.0, 90.0, 90.0, 60.0, 70.0, 140.0, 230.0, 80.0, 180.0, 120.0, 28.0, 160.0, 70.0, 50.0, 120.0, 110.0, 30.0, 30.0, 10.0, 30.0, 80.0, 20.0, 50.0, 100.0, 100.0, 60.0, 60.0, 40.0, 60.0, 160.0, 20.0, 150.0, 250.0, 0.0, 60.0, 150.0, 250.0, 39.0, 50.0, 170.0, -57.0, 130.0, 130.0, 21.0, 170.0, 110.0, 175.0, 50.0, 60.0, 140.0, 70.0, 70.0, 70.0, 78.0, 130.0, 70.0, 140.0, 39.0, 100.0, 40.0, 140.0, 150.0, 90.0, 38.0, 130.0, 50.0, 200.0, 80.0, 60.0, 20.0, 240.0, 75.0, 40.0, 60.0, 150.0, 180.0, 140.0, 110.0, 120.0, 220.0, 50.0, 130.0, 60.0, 100.0, 130.0, 230.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6031728193272032, "mean_inference_ms": 1.601875161995779, "mean_action_processing_ms": 0.4981765597831759, "mean_env_wait_ms": 1.1113526464044405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012431859970092773, "StateBufferConnector_ms": 0.009163141250610352, "ViewRequirementAgentConnector_ms": 0.4011683464050293}, "num_episodes": 18, "episode_return_max": 1480.0, "episode_return_min": 436.0, "episode_return_mean": 973.91}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.709210742763343, "num_env_steps_trained_throughput_per_sec": 20.709210742763343, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 5920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5920000, "timers": {"training_iteration_time_ms": 193626.05, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193626.004, "sample_time_ms": 2612.775, "learn_time_ms": 190993.774, "learn_throughput": 20.943, "synch_weights_time_ms": 11.086}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "done": false, "training_iteration": 148, "trial_id": "1841f_00000", "date": "2024-08-08_07-40-27", "timestamp": 1723117227, "time_this_iter_s": 193.15991497039795, "time_total_s": 30010.363703250885, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2b3c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30010.363703250885, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 17.18717948717949, "ram_util_percent": 77.27582417582418}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.913008510888702, "cur_kl_coeff": 2.3092060625553126, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.010829976864116459, "vf_loss": 8.3000305490118, "vf_explained_var": -0.011940069631519662, "kl": Infinity, "entropy": 0.5325705614397194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1394415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 455.0, "episode_reward_mean": 964.72, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -57.0}, "policy_reward_max": {"policy_0": 420.0}, "policy_reward_mean": {"policy_0": 96.472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1040.0, 895.0, 1160.0, 1116.0, 1330.0, 680.0, 859.0, 1090.0, 1010.0, 780.0, 1120.0, 1259.0, 820.0, 1049.0, 1120.0, 1254.0, 610.0, 1100.0, 1042.0, 900.0, 1460.0, 1060.0, 1111.0, 757.0, 1023.0, 988.0, 1258.0, 578.0, 1262.0, 912.0, 1235.0, 1135.0, 1060.0, 712.0, 700.0, 781.0, 907.0, 1030.0, 577.0, 905.0, 1210.0, 681.0, 873.0, 800.0, 860.0, 930.0, 1015.0, 874.0, 921.0, 1078.0, 455.0, 1458.0, 1085.0, 963.0, 678.0, 760.0, 1078.0, 1140.0, 892.0, 846.0, 580.0, 1141.0, 1230.0, 888.0, 787.0, 870.0, 1480.0, 1015.0, 731.0, 1148.0, 510.0, 950.0, 1013.0, 913.0, 917.0, 1105.0, 1290.0, 701.0, 1660.0, 716.0, 839.0, 1200.0, 686.0, 830.0, 823.0, 1012.0, 1080.0, 918.0, 798.0, 856.0, 768.0, 988.0, 1123.0, 922.0, 817.0, 799.0, 970.0, 1571.0, 847.0, 698.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [210.0, 120.0, 120.0, 90.0, 100.0, 120.0, 50.0, 30.0, 110.0, 90.0, 160.0, 70.0, 57.0, 120.0, 70.0, 57.0, 31.0, 140.0, 90.0, 100.0, 130.0, 100.0, 120.0, 70.0, 30.0, 170.0, 130.0, 210.0, 60.0, 140.0, 138.0, 151.0, 27.0, 80.0, 180.0, 90.0, 140.0, 70.0, 170.0, 70.0, 170.0, 190.0, 150.0, 120.0, 120.0, 90.0, 160.0, 90.0, 60.0, 180.0, 30.0, 30.0, 70.0, 80.0, 90.0, 60.0, 90.0, 10.0, 90.0, 130.0, 66.0, 134.0, 130.0, 59.0, 80.0, 60.0, 120.0, 60.0, 40.0, 110.0, 150.0, 170.0, 100.0, 100.0, 210.0, 100.0, 110.0, 10.0, 50.0, 90.0, 108.0, 80.0, 130.0, 80.0, 40.0, 35.0, 190.0, 70.0, 150.0, 127.0, 20.0, 70.0, 80.0, 90.0, 100.0, 220.0, 70.0, 30.0, 60.0, 40.0, 110.0, 50.0, 50.0, 160.0, 140.0, 110.0, 100.0, 140.0, 160.0, 100.0, 60.0, 90.0, 138.0, 180.0, 77.0, 110.0, 97.0, 140.0, 190.0, 177.0, 40.0, 50.0, 50.0, 30.0, 90.0, 150.0, 210.0, 60.0, 110.0, 30.0, 80.0, 110.0, 159.0, 100.0, 90.0, 140.0, 70.0, 60.0, 120.0, 120.0, 60.0, 90.0, 140.0, 100.0, 100.0, 140.0, 290.0, 60.0, 60.0, 80.0, 160.0, 170.0, 240.0, 60.0, 160.0, 82.0, 47.0, 65.0, 90.0, 180.0, 70.0, 90.0, 0.0, 50.0, 90.0, 40.0, 110.0, 70.0, 40.0, 50.0, 60.0, 190.0, 120.0, 80.0, 100.0, 150.0, 200.0, 50.0, 80.0, 70.0, 90.0, 52.0, 161.0, 150.0, 100.0, 80.0, 138.0, 59.0, 120.0, 92.0, 170.0, 60.0, 60.0, 30.0, 60.0, 50.0, 20.0, 250.0, 130.0, 70.0, 160.0, 80.0, 180.0, 90.0, 110.0, 220.0, 200.0, 60.0, 130.0, 230.0, 47.0, 88.0, 130.0, 132.0, 160.0, 140.0, 130.0, 130.0, 13.0, 90.0, 110.0, 77.0, 80.0, 86.0, 130.0, 120.0, 100.0, 140.0, 58.0, 210.0, 50.0, 180.0, 90.0, 30.0, 40.0, 50.0, 47.0, 110.0, 80.0, 80.0, 150.0, 90.0, 200.0, 77.0, 46.0, 60.0, 90.0, 160.0, 40.0, 110.0, 79.0, 100.0, 109.0, 80.0, 110.0, 30.0, 90.0, 150.0, 160.0, 80.0, 100.0, 140.0, 170.0, 110.0, 130.0, 190.0, 180.0, 144.0, 4.0, 90.0, 140.0, 20.0, 66.0, 28.0, 120.0, 30.0, 20.0, 108.0, 20.0, 26.0, 120.0, 66.0, 150.0, 120.0, 140.0, 216.0, 100.0, 140.0, 60.0, 150.0, 70.0, 49.0, 130.0, 80.0, 7.0, 190.0, -8.0, 194.0, 130.0, 70.0, 130.0, 140.0, 60.0, 55.0, 110.0, 130.0, 160.0, 140.0, 180.0, 130.0, 140.0, 98.0, 190.0, 90.0, 140.0, 80.0, 70.0, 120.0, 140.0, 67.0, 60.0, 100.0, 240.0, 40.0, 80.0, 40.0, 80.0, 120.0, 100.0, 200.0, 210.0, 16.0, 50.0, 50.0, 56.0, 120.0, 50.0, 60.0, 30.0, 70.0, 80.0, 130.0, 20.0, 80.0, 30.0, 80.0, 110.0, 40.0, 160.0, -30.0, 120.0, 13.0, 110.0, 40.0, 110.0, 110.0, 80.0, 65.0, 63.0, 70.0, 140.0, -30.0, 190.0, 110.0, 55.0, 50.0, 100.0, 82.0, 90.0, 120.0, 140.0, 150.0, 150.0, 100.0, 110.0, 80.0, 120.0, 70.0, 40.0, 70.0, 56.0, 50.0, 70.0, 110.0, 27.0, 40.0, 30.0, 109.0, 25.0, 60.0, 130.0, 32.0, 20.0, 40.0, 97.0, 200.0, 130.0, 75.0, 51.0, 130.0, 140.0, 80.0, 70.0, 60.0, 240.0, 80.0, 110.0, 160.0, 200.0, 70.0, 140.0, 120.0, 85.0, 36.0, 30.0, 50.0, 150.0, 10.0, 20.0, 40.0, 13.0, 95.0, 130.0, 20.0, 75.0, 90.0, 60.0, 180.0, 70.0, 140.0, 150.0, 120.0, -50.0, 100.0, 70.0, 100.0, 120.0, 40.0, 60.0, 90.0, 120.0, 150.0, 80.0, 40.0, 80.0, 90.0, -10.0, 230.0, 40.0, 40.0, 100.0, 110.0, 80.0, 10.0, 50.0, 190.0, 60.0, 70.0, 120.0, 140.0, 100.0, 70.0, 80.0, 70.0, 170.0, 150.0, 110.0, 100.0, 60.0, 105.0, 90.0, 160.0, 19.0, 60.0, 110.0, 150.0, 50.0, 140.0, 60.0, 35.0, 80.0, 100.0, 80.0, 121.0, 70.0, 130.0, 70.0, 70.0, 120.0, 80.0, 120.0, 70.0, 80.0, 90.0, 160.0, 178.0, 180.0, 0.0, 140.0, 60.0, 60.0, 40.0, 0.0, 20.0, 40.0, 50.0, 20.0, 43.0, 2.0, 180.0, 130.0, 130.0, 210.0, 140.0, 180.0, 125.0, 66.0, 150.0, 130.0, 197.0, 110.0, 110.0, 80.0, 110.0, 120.0, 90.0, 200.0, 105.0, 100.0, 60.0, 104.0, 80.0, 20.0, 115.0, 80.0, 130.0, 90.0, 120.0, 24.0, 200.0, 40.0, 29.0, 110.0, 50.0, 130.0, 60.0, 49.0, 70.0, 100.0, 40.0, 50.0, 60.0, 170.0, 40.0, 70.0, 110.0, 50.0, 80.0, 50.0, 80.0, 170.0, 58.0, 80.0, 150.0, 90.0, 80.0, 220.0, 50.0, 50.0, 130.0, 90.0, 130.0, 210.0, 120.0, 150.0, 60.0, 60.0, 60.0, 130.0, 130.0, 80.0, 20.0, 160.0, 47.0, 210.0, 40.0, 90.0, 100.0, 35.0, 110.0, 40.0, 110.0, 130.0, 89.0, 60.0, 80.0, 100.0, 130.0, 47.0, 60.0, 40.0, 120.0, 70.0, 50.0, 110.0, 30.0, 60.0, 10.0, 60.0, 30.0, 150.0, 110.0, 60.0, 70.0, 160.0, 221.0, 120.0, 60.0, 70.0, 120.0, 150.0, 120.0, 190.0, 70.0, 100.0, 180.0, 160.0, 40.0, 80.0, 140.0, 109.0, 60.0, 30.0, 80.0, 160.0, 80.0, 140.0, 49.0, 60.0, 120.0, 52.0, 70.0, 120.0, 25.0, 180.0, 65.0, 40.0, 110.0, 55.0, 70.0, 80.0, 80.0, 40.0, 100.0, 70.0, 130.0, 180.0, 50.0, 90.0, 50.0, 100.0, 120.0, 270.0, 170.0, 40.0, 120.0, 230.0, 90.0, 150.0, 190.0, 70.0, 180.0, 110.0, 160.0, 100.0, 70.0, 35.0, 160.0, 70.0, 60.0, 80.0, 78.0, 37.0, 40.0, 46.0, 90.0, 90.0, 60.0, 70.0, 140.0, 230.0, 80.0, 180.0, 120.0, 28.0, 160.0, 70.0, 50.0, 120.0, 110.0, 30.0, 30.0, 10.0, 30.0, 80.0, 20.0, 50.0, 100.0, 100.0, 60.0, 60.0, 40.0, 60.0, 160.0, 20.0, 150.0, 250.0, 0.0, 60.0, 150.0, 250.0, 39.0, 50.0, 170.0, -57.0, 130.0, 130.0, 21.0, 170.0, 110.0, 175.0, 50.0, 60.0, 140.0, 70.0, 70.0, 70.0, 78.0, 130.0, 70.0, 140.0, 39.0, 100.0, 40.0, 140.0, 150.0, 90.0, 38.0, 130.0, 50.0, 200.0, 80.0, 60.0, 20.0, 240.0, 75.0, 40.0, 60.0, 150.0, 180.0, 140.0, 110.0, 120.0, 220.0, 50.0, 130.0, 60.0, 100.0, 130.0, 230.0, 90.0, 15.0, 60.0, 140.0, 80.0, 20.0, 58.0, 35.0, 13.0, 190.0, 240.0, 50.0, 140.0, 80.0, 160.0, 120.0, 150.0, 160.0, 420.0, 140.0, 75.0, 80.0, 95.0, 60.0, 30.0, 38.0, 170.0, 50.0, 68.0, 50.0, 69.0, 140.0, 120.0, 70.0, 80.0, 90.0, 120.0, 80.0, 50.0, 20.0, 110.0, 70.0, 150.0, 90.0, 170.0, 90.0, 100.0, 180.0, 140.0, 100.0, 80.0, 11.0, 80.0, 147.0, 73.0, 100.0, -10.0, 90.0, 85.0, 30.0, 30.0, 80.0, 130.0, 80.0, 40.0, 110.0, 70.0, 80.0, 110.0, 100.0, 80.0, 130.0, 66.0, 100.0, 69.0, 58.0, 130.0, 60.0, 70.0, 60.0, 70.0, 40.0, 170.0, 80.0, 180.0, 8.0, 50.0, 90.0, 234.0, 90.0, 120.0, 50.0, 140.0, 120.0, 90.0, 70.0, 190.0, 50.0, 180.0, 70.0, 140.0, 60.0, 130.0, 90.0, 180.0, 80.0, 12.0, 70.0, 140.0, 16.0, 38.0, 100.0, 120.0, 30.0, 80.0, 160.0, 160.0, 40.0, 20.0, 50.0, 40.0, 269.0, 90.0, 40.0, -10.0, 60.0, 70.0, 140.0, 77.0, 80.0, 20.0, 69.0, 90.0, 50.0, 30.0, 130.0, 140.0, 240.0, 30.0, -31.0, 90.0, 90.0, 50.0, 95.0, 50.0, 40.0, 230.0, 130.0, 85.0, 128.0, 150.0, 79.0, 54.0, 100.0, 100.0, 110.0, 130.0, 160.0, 120.0, 120.0, 92.0, 120.0, 8.0, 100.0, 150.0, -2.0, 90.0, 84.0, 210.0, 70.0, 100.0, 120.0, 17.0, 20.0, 40.0, 20.0, 120.0, 160.0, 100.0, 120.0, 180.0, 50.0, 40.0, 80.0, 40.0, 120.0, 55.0, 50.0, 14.0, 170.0, 90.0, 120.0, 190.0, 80.0, 90.0, 70.0, 90.0, 80.0, 80.0, 80.0, 220.0, 104.0, 130.0, 360.0, 180.0, 50.0, 80.0, 247.0, 150.0, 50.0, 150.0, 210.0, 80.0, 7.0, 60.0, 33.0, 110.0, 27.0, 80.0, 90.0, 110.0, -21.0, 39.0, 17.0, 140.0, 110.0, 43.0, 120.0, 60.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6017791577995428, "mean_inference_ms": 1.6006883881303942, "mean_action_processing_ms": 0.49790198400501273, "mean_env_wait_ms": 1.1107868425883507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012407302856445312, "StateBufferConnector_ms": 0.011458396911621094, "ViewRequirementAgentConnector_ms": 0.42360568046569824}, "num_episodes": 23, "episode_return_max": 1660.0, "episode_return_min": 455.0, "episode_return_mean": 964.72}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.677031361167113, "num_env_steps_trained_throughput_per_sec": 20.677031361167113, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 5960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5960000, "timers": {"training_iteration_time_ms": 193555.407, "restore_workers_time_ms": 0.012, "training_step_time_ms": 193555.361, "sample_time_ms": 2557.938, "learn_time_ms": 190978.081, "learn_throughput": 20.945, "synch_weights_time_ms": 11.127}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "done": false, "training_iteration": 149, "trial_id": "1841f_00000", "date": "2024-08-08_07-43-41", "timestamp": 1723117421, "time_this_iter_s": 193.4628541469574, "time_total_s": 30203.826557397842, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2b3cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30203.826557397842, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 16.973992673992672, "ram_util_percent": 76.71611721611721}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3839213615090955, "cur_kl_coeff": 3.4638090938329706, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.351830383306876, "policy_loss": -0.009857774651160561, "vf_loss": 8.357136221206225, "vf_explained_var": -0.00531155628899035, "kl": 0.0013141424350137279, "entropy": 0.4913916674316628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1403805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "env_runners": {"episode_reward_max": 1660.0, "episode_reward_min": 85.0, "episode_reward_mean": 938.46, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -131.0}, "policy_reward_max": {"policy_0": 420.0}, "policy_reward_mean": {"policy_0": 93.846}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1111.0, 757.0, 1023.0, 988.0, 1258.0, 578.0, 1262.0, 912.0, 1235.0, 1135.0, 1060.0, 712.0, 700.0, 781.0, 907.0, 1030.0, 577.0, 905.0, 1210.0, 681.0, 873.0, 800.0, 860.0, 930.0, 1015.0, 874.0, 921.0, 1078.0, 455.0, 1458.0, 1085.0, 963.0, 678.0, 760.0, 1078.0, 1140.0, 892.0, 846.0, 580.0, 1141.0, 1230.0, 888.0, 787.0, 870.0, 1480.0, 1015.0, 731.0, 1148.0, 510.0, 950.0, 1013.0, 913.0, 917.0, 1105.0, 1290.0, 701.0, 1660.0, 716.0, 839.0, 1200.0, 686.0, 830.0, 823.0, 1012.0, 1080.0, 918.0, 798.0, 856.0, 768.0, 988.0, 1123.0, 922.0, 817.0, 799.0, 970.0, 1571.0, 847.0, 698.0, 990.0, 1019.0, 1050.0, 820.0, 970.0, 580.0, 968.0, 970.0, 874.0, 590.0, 890.0, 851.0, 1214.0, 1081.0, 800.0, 1167.0, 85.0, 1110.0, 745.0, 1110.0, 1145.0, 1099.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 77.0, 80.0, 86.0, 130.0, 120.0, 100.0, 140.0, 58.0, 210.0, 50.0, 180.0, 90.0, 30.0, 40.0, 50.0, 47.0, 110.0, 80.0, 80.0, 150.0, 90.0, 200.0, 77.0, 46.0, 60.0, 90.0, 160.0, 40.0, 110.0, 79.0, 100.0, 109.0, 80.0, 110.0, 30.0, 90.0, 150.0, 160.0, 80.0, 100.0, 140.0, 170.0, 110.0, 130.0, 190.0, 180.0, 144.0, 4.0, 90.0, 140.0, 20.0, 66.0, 28.0, 120.0, 30.0, 20.0, 108.0, 20.0, 26.0, 120.0, 66.0, 150.0, 120.0, 140.0, 216.0, 100.0, 140.0, 60.0, 150.0, 70.0, 49.0, 130.0, 80.0, 7.0, 190.0, -8.0, 194.0, 130.0, 70.0, 130.0, 140.0, 60.0, 55.0, 110.0, 130.0, 160.0, 140.0, 180.0, 130.0, 140.0, 98.0, 190.0, 90.0, 140.0, 80.0, 70.0, 120.0, 140.0, 67.0, 60.0, 100.0, 240.0, 40.0, 80.0, 40.0, 80.0, 120.0, 100.0, 200.0, 210.0, 16.0, 50.0, 50.0, 56.0, 120.0, 50.0, 60.0, 30.0, 70.0, 80.0, 130.0, 20.0, 80.0, 30.0, 80.0, 110.0, 40.0, 160.0, -30.0, 120.0, 13.0, 110.0, 40.0, 110.0, 110.0, 80.0, 65.0, 63.0, 70.0, 140.0, -30.0, 190.0, 110.0, 55.0, 50.0, 100.0, 82.0, 90.0, 120.0, 140.0, 150.0, 150.0, 100.0, 110.0, 80.0, 120.0, 70.0, 40.0, 70.0, 56.0, 50.0, 70.0, 110.0, 27.0, 40.0, 30.0, 109.0, 25.0, 60.0, 130.0, 32.0, 20.0, 40.0, 97.0, 200.0, 130.0, 75.0, 51.0, 130.0, 140.0, 80.0, 70.0, 60.0, 240.0, 80.0, 110.0, 160.0, 200.0, 70.0, 140.0, 120.0, 85.0, 36.0, 30.0, 50.0, 150.0, 10.0, 20.0, 40.0, 13.0, 95.0, 130.0, 20.0, 75.0, 90.0, 60.0, 180.0, 70.0, 140.0, 150.0, 120.0, -50.0, 100.0, 70.0, 100.0, 120.0, 40.0, 60.0, 90.0, 120.0, 150.0, 80.0, 40.0, 80.0, 90.0, -10.0, 230.0, 40.0, 40.0, 100.0, 110.0, 80.0, 10.0, 50.0, 190.0, 60.0, 70.0, 120.0, 140.0, 100.0, 70.0, 80.0, 70.0, 170.0, 150.0, 110.0, 100.0, 60.0, 105.0, 90.0, 160.0, 19.0, 60.0, 110.0, 150.0, 50.0, 140.0, 60.0, 35.0, 80.0, 100.0, 80.0, 121.0, 70.0, 130.0, 70.0, 70.0, 120.0, 80.0, 120.0, 70.0, 80.0, 90.0, 160.0, 178.0, 180.0, 0.0, 140.0, 60.0, 60.0, 40.0, 0.0, 20.0, 40.0, 50.0, 20.0, 43.0, 2.0, 180.0, 130.0, 130.0, 210.0, 140.0, 180.0, 125.0, 66.0, 150.0, 130.0, 197.0, 110.0, 110.0, 80.0, 110.0, 120.0, 90.0, 200.0, 105.0, 100.0, 60.0, 104.0, 80.0, 20.0, 115.0, 80.0, 130.0, 90.0, 120.0, 24.0, 200.0, 40.0, 29.0, 110.0, 50.0, 130.0, 60.0, 49.0, 70.0, 100.0, 40.0, 50.0, 60.0, 170.0, 40.0, 70.0, 110.0, 50.0, 80.0, 50.0, 80.0, 170.0, 58.0, 80.0, 150.0, 90.0, 80.0, 220.0, 50.0, 50.0, 130.0, 90.0, 130.0, 210.0, 120.0, 150.0, 60.0, 60.0, 60.0, 130.0, 130.0, 80.0, 20.0, 160.0, 47.0, 210.0, 40.0, 90.0, 100.0, 35.0, 110.0, 40.0, 110.0, 130.0, 89.0, 60.0, 80.0, 100.0, 130.0, 47.0, 60.0, 40.0, 120.0, 70.0, 50.0, 110.0, 30.0, 60.0, 10.0, 60.0, 30.0, 150.0, 110.0, 60.0, 70.0, 160.0, 221.0, 120.0, 60.0, 70.0, 120.0, 150.0, 120.0, 190.0, 70.0, 100.0, 180.0, 160.0, 40.0, 80.0, 140.0, 109.0, 60.0, 30.0, 80.0, 160.0, 80.0, 140.0, 49.0, 60.0, 120.0, 52.0, 70.0, 120.0, 25.0, 180.0, 65.0, 40.0, 110.0, 55.0, 70.0, 80.0, 80.0, 40.0, 100.0, 70.0, 130.0, 180.0, 50.0, 90.0, 50.0, 100.0, 120.0, 270.0, 170.0, 40.0, 120.0, 230.0, 90.0, 150.0, 190.0, 70.0, 180.0, 110.0, 160.0, 100.0, 70.0, 35.0, 160.0, 70.0, 60.0, 80.0, 78.0, 37.0, 40.0, 46.0, 90.0, 90.0, 60.0, 70.0, 140.0, 230.0, 80.0, 180.0, 120.0, 28.0, 160.0, 70.0, 50.0, 120.0, 110.0, 30.0, 30.0, 10.0, 30.0, 80.0, 20.0, 50.0, 100.0, 100.0, 60.0, 60.0, 40.0, 60.0, 160.0, 20.0, 150.0, 250.0, 0.0, 60.0, 150.0, 250.0, 39.0, 50.0, 170.0, -57.0, 130.0, 130.0, 21.0, 170.0, 110.0, 175.0, 50.0, 60.0, 140.0, 70.0, 70.0, 70.0, 78.0, 130.0, 70.0, 140.0, 39.0, 100.0, 40.0, 140.0, 150.0, 90.0, 38.0, 130.0, 50.0, 200.0, 80.0, 60.0, 20.0, 240.0, 75.0, 40.0, 60.0, 150.0, 180.0, 140.0, 110.0, 120.0, 220.0, 50.0, 130.0, 60.0, 100.0, 130.0, 230.0, 90.0, 15.0, 60.0, 140.0, 80.0, 20.0, 58.0, 35.0, 13.0, 190.0, 240.0, 50.0, 140.0, 80.0, 160.0, 120.0, 150.0, 160.0, 420.0, 140.0, 75.0, 80.0, 95.0, 60.0, 30.0, 38.0, 170.0, 50.0, 68.0, 50.0, 69.0, 140.0, 120.0, 70.0, 80.0, 90.0, 120.0, 80.0, 50.0, 20.0, 110.0, 70.0, 150.0, 90.0, 170.0, 90.0, 100.0, 180.0, 140.0, 100.0, 80.0, 11.0, 80.0, 147.0, 73.0, 100.0, -10.0, 90.0, 85.0, 30.0, 30.0, 80.0, 130.0, 80.0, 40.0, 110.0, 70.0, 80.0, 110.0, 100.0, 80.0, 130.0, 66.0, 100.0, 69.0, 58.0, 130.0, 60.0, 70.0, 60.0, 70.0, 40.0, 170.0, 80.0, 180.0, 8.0, 50.0, 90.0, 234.0, 90.0, 120.0, 50.0, 140.0, 120.0, 90.0, 70.0, 190.0, 50.0, 180.0, 70.0, 140.0, 60.0, 130.0, 90.0, 180.0, 80.0, 12.0, 70.0, 140.0, 16.0, 38.0, 100.0, 120.0, 30.0, 80.0, 160.0, 160.0, 40.0, 20.0, 50.0, 40.0, 269.0, 90.0, 40.0, -10.0, 60.0, 70.0, 140.0, 77.0, 80.0, 20.0, 69.0, 90.0, 50.0, 30.0, 130.0, 140.0, 240.0, 30.0, -31.0, 90.0, 90.0, 50.0, 95.0, 50.0, 40.0, 230.0, 130.0, 85.0, 128.0, 150.0, 79.0, 54.0, 100.0, 100.0, 110.0, 130.0, 160.0, 120.0, 120.0, 92.0, 120.0, 8.0, 100.0, 150.0, -2.0, 90.0, 84.0, 210.0, 70.0, 100.0, 120.0, 17.0, 20.0, 40.0, 20.0, 120.0, 160.0, 100.0, 120.0, 180.0, 50.0, 40.0, 80.0, 40.0, 120.0, 55.0, 50.0, 14.0, 170.0, 90.0, 120.0, 190.0, 80.0, 90.0, 70.0, 90.0, 80.0, 80.0, 80.0, 220.0, 104.0, 130.0, 360.0, 180.0, 50.0, 80.0, 247.0, 150.0, 50.0, 150.0, 210.0, 80.0, 7.0, 60.0, 33.0, 110.0, 27.0, 80.0, 90.0, 110.0, -21.0, 39.0, 17.0, 140.0, 110.0, 43.0, 120.0, 60.0, 80.0, 120.0, 80.0, 50.0, 190.0, 120.0, 110.0, 80.0, 70.0, 100.0, 70.0, 100.0, 130.0, 126.0, 130.0, 159.0, 84.0, 90.0, 40.0, 90.0, 70.0, 100.0, 150.0, 210.0, 90.0, 60.0, 100.0, 120.0, 90.0, 40.0, 90.0, 30.0, 140.0, 80.0, 50.0, 70.0, 50.0, 60.0, 140.0, 100.0, 100.0, 80.0, 140.0, 80.0, 90.0, 70.0, 90.0, 130.0, 80.0, 190.0, 20.0, 60.0, 100.0, 40.0, 90.0, 80.0, 20.0, 60.0, 20.0, 100.0, 10.0, 120.0, 70.0, 90.0, 90.0, 130.0, 200.0, -2.0, 100.0, 130.0, 40.0, 140.0, 80.0, 180.0, 110.0, 70.0, 150.0, 20.0, 110.0, 30.0, 80.0, 140.0, 77.0, 50.0, 27.0, 40.0, 90.0, 50.0, 180.0, 120.0, 100.0, 80.0, 90.0, 90.0, 30.0, 30.0, 50.0, 70.0, 90.0, 40.0, 20.0, 90.0, 110.0, 100.0, 80.0, 60.0, 60.0, 110.0, 90.0, 90.0, 100.0, 120.0, 150.0, 70.0, 70.0, 95.0, 130.0, 50.0, 90.0, 30.0, 46.0, 100.0, 74.0, 70.0, 180.0, 70.0, 160.0, 160.0, 160.0, 80.0, 160.0, 60.0, 140.0, 190.0, 60.0, 140.0, 50.0, 100.0, 61.0, 170.0, 110.0, 30.0, 110.0, 90.0, 190.0, 50.0, 40.0, 40.0, 100.0, 90.0, 60.0, 120.0, 90.0, 50.0, 87.0, 110.0, 140.0, 150.0, 110.0, 120.0, 190.0, 60.0, 100.0, 90.0, -8.0, -131.0, 50.0, 40.0, 0.0, 14.0, -130.0, 120.0, 110.0, 212.0, 120.0, 60.0, 90.0, 70.0, 90.0, 158.0, 80.0, 90.0, 120.0, 60.0, 40.0, 90.0, 40.0, 100.0, 55.0, 50.0, 100.0, 120.0, 140.0, 160.0, 60.0, 80.0, 60.0, 120.0, 50.0, 190.0, 130.0, 120.0, 110.0, 90.0, 220.0, 74.0, 26.0, 57.0, 220.0, 108.0, 120.0, 150.0, 120.0, 110.0, 70.0, 110.0, 90.0, 180.0, 39.0, 110.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5999530591946114, "mean_inference_ms": 1.5991475451101769, "mean_action_processing_ms": 0.4974860747590103, "mean_env_wait_ms": 1.1099691490876227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012205839157104492, "StateBufferConnector_ms": 0.011003494262695312, "ViewRequirementAgentConnector_ms": 0.40488481521606445}, "num_episodes": 22, "episode_return_max": 1660.0, "episode_return_min": 85.0, "episode_return_mean": 938.46}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.721124122999317, "num_env_steps_trained_throughput_per_sec": 20.721124122999317, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 6000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 6000000, "timers": {"training_iteration_time_ms": 193544.205, "restore_workers_time_ms": 0.011, "training_step_time_ms": 193544.158, "sample_time_ms": 2556.186, "learn_time_ms": 190968.942, "learn_throughput": 20.946, "synch_weights_time_ms": 10.802}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "done": true, "training_iteration": 150, "trial_id": "1841f_00000", "date": "2024-08-08_07-46-54", "timestamp": 1723117614, "time_this_iter_s": 193.0491361618042, "time_total_s": 30396.875693559647, "pid": 8646, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2b01280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30396.875693559647, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 17.108424908424908, "ram_util_percent": 77.3820512820513}}
