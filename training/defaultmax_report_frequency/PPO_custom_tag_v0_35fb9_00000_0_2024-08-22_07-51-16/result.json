{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5412373410488562, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.393530081945753, "policy_loss": -0.019870372522356256, "vf_loss": 7.411249960036505, "vf_explained_var": 0.042772789953877684, "kl": 0.010752507737128153, "entropy": 1.6003373629832394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2365121219287474, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.547357888701101, "policy_loss": -0.017769027589795688, "vf_loss": 5.56319846072525, "vf_explained_var": 0.03272056980107827, "kl": 0.009642254532359186, "entropy": 1.602443208202483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.5909413274791, "num_env_steps_trained_throughput_per_sec": 73.5909413274791, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 54354.524, "restore_workers_time_ms": 0.02, "training_step_time_ms": 54354.451, "sample_time_ms": 4323.976, "learn_time_ms": 50002.905, "learn_throughput": 79.995, "synch_weights_time_ms": 16.187}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "35fb9_00000", "date": "2024-08-22_07-54-31", "timestamp": 1724293471, "time_this_iter_s": 54.425243854522705, "time_total_s": 54.425243854522705, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b5ccee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.425243854522705, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.60632911392405, "ram_util_percent": 83.40126582278482}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3489896625122695, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.101576370915408, "policy_loss": -0.020376968814094586, "vf_loss": 6.119467078062592, "vf_explained_var": 0.11371228146174597, "kl": 0.012431247577948308, "entropy": 1.5870870985682048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.902749425519711, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.530423810746935, "policy_loss": -0.01640692947915307, "vf_loss": 3.5453112932740067, "vf_explained_var": 0.1012880216830622, "kl": 0.0075972524947713485, "entropy": 1.5947628484831915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.42038257841695, "num_env_steps_trained_throughput_per_sec": 73.42038257841695, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 54417.668, "restore_workers_time_ms": 0.05, "training_step_time_ms": 54417.547, "sample_time_ms": 4075.293, "learn_time_ms": 50304.499, "learn_throughput": 79.516, "synch_weights_time_ms": 28.966}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "35fb9_00000", "date": "2024-08-22_07-55-29", "timestamp": 1724293529, "time_this_iter_s": 54.51639199256897, "time_total_s": 108.94163584709167, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b5e7670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 108.94163584709167, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 44.71358024691358, "ram_util_percent": 83.34444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.33292163143713, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.769876096614454, "policy_loss": -0.02279530449181539, "vf_loss": 5.79042548250269, "vf_explained_var": 0.20275359037061216, "kl": 0.011229646123610633, "entropy": 1.573148418797387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5067168477035704, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.226639657550388, "policy_loss": -0.01914579423745631, "vf_loss": 3.243875030045787, "vf_explained_var": 0.114657922428121, "kl": 0.009552155585870857, "entropy": 1.5817319418387439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 70.83585212478137, "num_env_steps_trained_throughput_per_sec": 70.83585212478137, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 55101.308, "restore_workers_time_ms": 0.038, "training_step_time_ms": 55101.212, "sample_time_ms": 3696.772, "learn_time_ms": 51369.17, "learn_throughput": 77.868, "synch_weights_time_ms": 26.976}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "35fb9_00000", "date": "2024-08-22_07-56-25", "timestamp": 1724293585, "time_this_iter_s": 56.50736999511719, "time_total_s": 165.44900584220886, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b612790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 165.44900584220886, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.64875, "ram_util_percent": 83.065}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.95418740936688, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.44610283488319, "policy_loss": -0.022240057676197793, "vf_loss": 5.466156623981617, "vf_explained_var": 0.29990677111363284, "kl": 0.010931312206211111, "entropy": 1.564973100531038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4590204992622295, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.233105937324504, "policy_loss": -0.021262830077231957, "vf_loss": 2.2524682942521634, "vf_explained_var": 0.13927712519332847, "kl": 0.009502325798803694, "entropy": 1.5748121822952594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.47357373607201, "num_env_steps_trained_throughput_per_sec": 76.47357373607201, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 54402.402, "restore_workers_time_ms": 0.043, "training_step_time_ms": 54402.265, "sample_time_ms": 3519.34, "learn_time_ms": 50845.21, "learn_throughput": 78.67, "synch_weights_time_ms": 28.06}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "35fb9_00000", "date": "2024-08-22_07-57-17", "timestamp": 1724293637, "time_this_iter_s": 52.3460590839386, "time_total_s": 217.79506492614746, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b6123a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 217.79506492614746, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 35.60000000000001, "ram_util_percent": 82.86756756756756}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.560591892905967, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.585329724115039, "policy_loss": -0.020201404507471515, "vf_loss": 5.602938089421187, "vf_explained_var": 0.36428615769381245, "kl": 0.012965216640033143, "entropy": 1.5604890374279528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.048314198283922, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.9154327528817312, "policy_loss": -0.02271036683161689, "vf_loss": 1.935973862144682, "vf_explained_var": 0.13529410043721476, "kl": 0.010846258881969979, "entropy": 1.568719185218609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.98940151964734, "num_env_steps_trained_throughput_per_sec": 74.98940151964734, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 54190.097, "restore_workers_time_ms": 0.037, "training_step_time_ms": 54189.965, "sample_time_ms": 3818.524, "learn_time_ms": 50338.093, "learn_throughput": 79.463, "synch_weights_time_ms": 25.215}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "35fb9_00000", "date": "2024-08-22_07-58-11", "timestamp": 1724293691, "time_this_iter_s": 53.382487773895264, "time_total_s": 271.1775527000427, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b6148b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 271.1775527000427, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 33.62894736842105, "ram_util_percent": 82.3592105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.991055834261829, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.811892031866407, "policy_loss": -0.022064247680704783, "vf_loss": 5.8314232051687895, "vf_explained_var": 0.4582293833058978, "kl": 0.01266533995365044, "entropy": 1.5539607955665184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.158198749072968, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.2830000996274291, "policy_loss": -0.016544410352540947, "vf_loss": 1.2978651747028664, "vf_explained_var": 0.180947383528664, "kl": 0.00839670369174903, "entropy": 1.5687135338783265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.4943325547724, "num_env_steps_trained_throughput_per_sec": 78.4943325547724, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 53651.624, "restore_workers_time_ms": 0.034, "training_step_time_ms": 53651.48, "sample_time_ms": 3556.042, "learn_time_ms": 50064.34, "learn_throughput": 79.897, "synch_weights_time_ms": 23.778}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "35fb9_00000", "date": "2024-08-22_07-59-02", "timestamp": 1724293742, "time_this_iter_s": 51.022560834884644, "time_total_s": 322.20011353492737, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b635ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 322.20011353492737, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 33.152054794520545, "ram_util_percent": 82.95890410958906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.65093392401776, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.426074056776743, "policy_loss": -0.021696995845848013, "vf_loss": 6.444701734926335, "vf_explained_var": 0.520363686419038, "kl": 0.015346610359847546, "entropy": 1.5316787850289117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.090610641209537, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.9188577246729028, "policy_loss": -0.02206115440130431, "vf_loss": 1.9389704034126625, "vf_explained_var": 0.2061616268738237, "kl": 0.00974237514504542, "entropy": 1.5482281951677233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 648.6000000000016, "episode_reward_min": 65.60000000000055, "episode_reward_mean": 311.72947522010827, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 19200, "policy_reward_min": {"prey_policy": -384.1249140655181, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 360.5886215262346, "predator_policy": 437.945732978894}, "policy_reward_mean": {"prey_policy": 43.77012336908086, "predator_policy": 112.09461424097317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [403.1000000000021, 464.3000000000038, 318.00000000000045, 502.21850355316565, 313.9000000000001, 74.20000000000007, 438.00381038983824, 196.4999999999967, 93.0999999999989, 238.38567663149715, 333.00000000000034, 402.09999999999957, 232.63097505584292, 392.00000000000057, 159.32525664828498, 180.82240217141552, 366.09999999999985, 302.8567336084134, 361.5000000000002, 405.20000000000175, 562.2198886673219, 648.6000000000016, 69.00000000000023, 517.5999999999998, 143.48886857985732, 71.20000000000023, 354.62482286308057, 193.47947462197544, 291.3999999999993, 328.8000000000011, 184.39999999999813, 233.09999999999945, 418.10000000000036, 421.9000000000016, 338.9000000000008, 644.050843859086, 205.0000000000004, 233.4999999999978, 219.58174491448295, 291.0999999999999, 138.70000000000024, 65.60000000000055, 381.0514839935371, 245.70000000000041, 541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.964866754049874, 338.9063478860582, 296.4062856021409, 109.36639189010505, 117.99150492753955, 1.860157193795023, 27.832384831853233, 157.14197680017693, 2.1127357480887956, 188.42751248688893, 1.5234660678339182, -4.306473480487744, 188.7191590063841, -27.636213717632884, -59.592039333423884, 160.5999999999985, -34.70629727050268, 18.661278719078382, -24.09216611613462, -55.77345753023273, -203.21831045400717, 67.38607572800406, -1.6418912791532847, 236.3022604639305, 50.13929464649561, -114.4400054659767, 147.35661377515765, -12.851291522072668, 17.42074777282035, -80.27914764617988, -203.18125425794796, -280.8877743313891, 203.2691752063312, -119.16515515214667, 183.83441481056633, -384.1249140655181, -119.1003248492344, 216.77692929468904, 348.12892957654566, 51.89772132045287, 176.6398191339703, 320.80345738927235, 333.221255045393, 146.5501227047259, -329.07855876714285, -62.700330544093205, 170.78219062432152, 287.6932110393518, -98.25453325768208, 35.60260764564543, 39.00133985639031, -163.32117938526292, 269.7594536816125, -145.83178233872138, -301.59388916622214, 51.88423242009244, 193.6824543752575, -5.105930430371153, 168.501380697444, 46.62310062642271, 120.59216405346986, -84.24341274912425, -25.396777466214296, 57.50364984742107, -53.43765390225873, 317.9022508729412, 208.13091858438233, 36.05759654915703, -27.575720626461333, 104.87391783452387, 360.5886215262346, 10.070826436928371, -101.72556237483363, 91.38493513151943, -14.008464492530763, 71.67040648191652, -53.98155448827467, 2.357194926100353, -167.4649844663422, 79.27032816998116, -28.836694644396857, 90.59406498902823, -23.392759772966564, -172.50217940018646, 64.9994357200459, -138.52541128221276, 12.559612266881658, 38.18645513039489, 109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866], "policy_predator_policy_reward": [29.735133245950234, 24.493652113941685, 29.793714397859166, 28.733608109893623, 153.16824621753983, 44.98009166112567, 51.97361740515323, 265.2705245159826, 116.45029775063564, 6.909454014386911, 36.176533932166045, 40.80647348048805, 25.61254514185654, 251.30831995923086, 95.4920393334225, 0.0, 91.17406422346947, 17.970954327955212, 125.62862175657457, 192.6226785212908, 293.2183104540087, 175.61392427199567, 1.003295968756508, 166.43633484646634, 181.55207144069598, 115.37961443462837, 150.23054055352682, 107.26413719338794, 125.06522655908864, 97.11842996255386, 363.6523194139506, 301.2391113468089, 89.26887821230439, 192.72710173351018, 97.97905240625985, 405.1681804571096, 157.9743852045523, 105.84901034999281, 0.0, 5.173349103001728, 25.60084756681701, 39.17576457725629, 28.378744954607047, 140.44987729527412, 363.97855876714635, 96.80033054409317, 53.51780937567869, 5.6067889606476236, 136.20921413933718, 69.93158005255515, 0.8986601436099741, 194.62117938526112, 0.0, 230.69715152018884, 437.945732978894, 5.24339838921266, 5.759197994113323, 97.06427806100058, 19.863057100320894, 93.81246157581253, 28.20783594653013, 119.84341274912222, 69.67745019071718, 131.31567742807607, 106.04905687182284, 47.586346157494255, 170.8190991733173, 6.892385693141936, 63.47572062646165, 198.12608216547613, 204.03353590301356, 69.35785999290925, 198.92556237483265, 16.415064868480663, 125.72690734225314, 50.111150668360686, 203.23637016698999, 67.96973430966806, 196.06498446634117, 183.2296718300185, 65.53669464439737, 11.40593501097178, 59.992759772967055, 201.50217940018481, 132.77408263713232, 321.803376918572, 109.84038773311745, 85.11354486960403, 167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.8921134297298075, "mean_inference_ms": 5.3298091250712405, "mean_action_processing_ms": 2.018593167032154, "mean_env_wait_ms": 10.27404540047833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004828721284866333, "StateBufferConnector_ms": 0.005105882883071899, "ViewRequirementAgentConnector_ms": 0.17533749341964722}, "num_episodes": 48, "episode_return_max": 648.6000000000016, "episode_return_min": 65.60000000000055, "episode_return_mean": 311.72947522010827, "episodes_this_iter": 48}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.08460753095846, "num_env_steps_trained_throughput_per_sec": 77.08460753095846, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 53400.112, "restore_workers_time_ms": 0.031, "training_step_time_ms": 53399.982, "sample_time_ms": 3362.83, "learn_time_ms": 50005.855, "learn_throughput": 79.991, "synch_weights_time_ms": 24.483}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "35fb9_00000", "date": "2024-08-22_07-59-54", "timestamp": 1724293794, "time_this_iter_s": 51.972079038619995, "time_total_s": 374.17219257354736, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b61a430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 374.17219257354736, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.24864864864865, "ram_util_percent": 83.29594594594593}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.014034495593378, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.112148519293972, "policy_loss": -0.024393709702417256, "vf_loss": 7.133507501511347, "vf_explained_var": 0.34283228961248247, "kl": 0.015173699498846734, "entropy": 1.4701478141956228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.338237022155177, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.650993206892064, "policy_loss": -0.024561063315541972, "vf_loss": 3.6722841467176166, "vf_explained_var": 0.19161481113030165, "kl": 0.01635062341065831, "entropy": 1.485965820216628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 700.6000000000014, "episode_reward_min": 65.60000000000055, "episode_reward_mean": 327.5292095106287, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -384.1249140655181, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 360.5886215262346, "predator_policy": 459.96916506252677}, "policy_reward_mean": {"prey_policy": 45.92442999869781, "predator_policy": 117.84017475661636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [403.1000000000021, 464.3000000000038, 318.00000000000045, 502.21850355316565, 313.9000000000001, 74.20000000000007, 438.00381038983824, 196.4999999999967, 93.0999999999989, 238.38567663149715, 333.00000000000034, 402.09999999999957, 232.63097505584292, 392.00000000000057, 159.32525664828498, 180.82240217141552, 366.09999999999985, 302.8567336084134, 361.5000000000002, 405.20000000000175, 562.2198886673219, 648.6000000000016, 69.00000000000023, 517.5999999999998, 143.48886857985732, 71.20000000000023, 354.62482286308057, 193.47947462197544, 291.3999999999993, 328.8000000000011, 184.39999999999813, 233.09999999999945, 418.10000000000036, 421.9000000000016, 338.9000000000008, 644.050843859086, 205.0000000000004, 233.4999999999978, 219.58174491448295, 291.0999999999999, 138.70000000000024, 65.60000000000055, 381.0514839935371, 245.70000000000041, 541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.964866754049874, 338.9063478860582, 296.4062856021409, 109.36639189010505, 117.99150492753955, 1.860157193795023, 27.832384831853233, 157.14197680017693, 2.1127357480887956, 188.42751248688893, 1.5234660678339182, -4.306473480487744, 188.7191590063841, -27.636213717632884, -59.592039333423884, 160.5999999999985, -34.70629727050268, 18.661278719078382, -24.09216611613462, -55.77345753023273, -203.21831045400717, 67.38607572800406, -1.6418912791532847, 236.3022604639305, 50.13929464649561, -114.4400054659767, 147.35661377515765, -12.851291522072668, 17.42074777282035, -80.27914764617988, -203.18125425794796, -280.8877743313891, 203.2691752063312, -119.16515515214667, 183.83441481056633, -384.1249140655181, -119.1003248492344, 216.77692929468904, 348.12892957654566, 51.89772132045287, 176.6398191339703, 320.80345738927235, 333.221255045393, 146.5501227047259, -329.07855876714285, -62.700330544093205, 170.78219062432152, 287.6932110393518, -98.25453325768208, 35.60260764564543, 39.00133985639031, -163.32117938526292, 269.7594536816125, -145.83178233872138, -301.59388916622214, 51.88423242009244, 193.6824543752575, -5.105930430371153, 168.501380697444, 46.62310062642271, 120.59216405346986, -84.24341274912425, -25.396777466214296, 57.50364984742107, -53.43765390225873, 317.9022508729412, 208.13091858438233, 36.05759654915703, -27.575720626461333, 104.87391783452387, 360.5886215262346, 10.070826436928371, -101.72556237483363, 91.38493513151943, -14.008464492530763, 71.67040648191652, -53.98155448827467, 2.357194926100353, -167.4649844663422, 79.27032816998116, -28.836694644396857, 90.59406498902823, -23.392759772966564, -172.50217940018646, 64.9994357200459, -138.52541128221276, 12.559612266881658, 38.18645513039489, 109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237], "policy_predator_policy_reward": [29.735133245950234, 24.493652113941685, 29.793714397859166, 28.733608109893623, 153.16824621753983, 44.98009166112567, 51.97361740515323, 265.2705245159826, 116.45029775063564, 6.909454014386911, 36.176533932166045, 40.80647348048805, 25.61254514185654, 251.30831995923086, 95.4920393334225, 0.0, 91.17406422346947, 17.970954327955212, 125.62862175657457, 192.6226785212908, 293.2183104540087, 175.61392427199567, 1.003295968756508, 166.43633484646634, 181.55207144069598, 115.37961443462837, 150.23054055352682, 107.26413719338794, 125.06522655908864, 97.11842996255386, 363.6523194139506, 301.2391113468089, 89.26887821230439, 192.72710173351018, 97.97905240625985, 405.1681804571096, 157.9743852045523, 105.84901034999281, 0.0, 5.173349103001728, 25.60084756681701, 39.17576457725629, 28.378744954607047, 140.44987729527412, 363.97855876714635, 96.80033054409317, 53.51780937567869, 5.6067889606476236, 136.20921413933718, 69.93158005255515, 0.8986601436099741, 194.62117938526112, 0.0, 230.69715152018884, 437.945732978894, 5.24339838921266, 5.759197994113323, 97.06427806100058, 19.863057100320894, 93.81246157581253, 28.20783594653013, 119.84341274912222, 69.67745019071718, 131.31567742807607, 106.04905687182284, 47.586346157494255, 170.8190991733173, 6.892385693141936, 63.47572062646165, 198.12608216547613, 204.03353590301356, 69.35785999290925, 198.92556237483265, 16.415064868480663, 125.72690734225314, 50.111150668360686, 203.23637016698999, 67.96973430966806, 196.06498446634117, 183.2296718300185, 65.53669464439737, 11.40593501097178, 59.992759772967055, 201.50217940018481, 132.77408263713232, 321.803376918572, 109.84038773311745, 85.11354486960403, 167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.89576802207114, "mean_inference_ms": 5.43913110921592, "mean_action_processing_ms": 1.9049232889780976, "mean_env_wait_ms": 10.35890781849056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005481474929385715, "StateBufferConnector_ms": 0.031751725408766, "ViewRequirementAgentConnector_ms": 0.178007615937127}, "num_episodes": 24, "episode_return_max": 700.6000000000014, "episode_return_min": 65.60000000000055, "episode_return_mean": 327.5292095106287, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.59235737600788, "num_env_steps_trained_throughput_per_sec": 78.59235737600788, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 53087.041, "restore_workers_time_ms": 0.029, "training_step_time_ms": 53086.922, "sample_time_ms": 3305.422, "learn_time_ms": 49751.685, "learn_throughput": 80.399, "synch_weights_time_ms": 23.332}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "35fb9_00000", "date": "2024-08-22_08-00-45", "timestamp": 1724293845, "time_this_iter_s": 50.92878603935242, "time_total_s": 425.1009786128998, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc85ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 425.1009786128998, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 31.627777777777776, "ram_util_percent": 83.20138888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.706102102395719, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.53383091669234, "policy_loss": -0.0255732480993386, "vf_loss": 7.556241777965001, "vf_explained_var": 0.37095965856597535, "kl": 0.01581188666279472, "entropy": 1.4665384387843823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.146399839025326, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.162045283040042, "policy_loss": -0.02661057592211932, "vf_loss": 4.185445808481287, "vf_explained_var": 0.19964126903544027, "kl": 0.016050190463041267, "entropy": 1.478294637089684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999993}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 700.6000000000014, "episode_reward_min": 65.60000000000055, "episode_reward_mean": 327.5292095106287, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -384.1249140655181, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 360.5886215262346, "predator_policy": 459.96916506252677}, "policy_reward_mean": {"prey_policy": 45.92442999869781, "predator_policy": 117.84017475661636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [403.1000000000021, 464.3000000000038, 318.00000000000045, 502.21850355316565, 313.9000000000001, 74.20000000000007, 438.00381038983824, 196.4999999999967, 93.0999999999989, 238.38567663149715, 333.00000000000034, 402.09999999999957, 232.63097505584292, 392.00000000000057, 159.32525664828498, 180.82240217141552, 366.09999999999985, 302.8567336084134, 361.5000000000002, 405.20000000000175, 562.2198886673219, 648.6000000000016, 69.00000000000023, 517.5999999999998, 143.48886857985732, 71.20000000000023, 354.62482286308057, 193.47947462197544, 291.3999999999993, 328.8000000000011, 184.39999999999813, 233.09999999999945, 418.10000000000036, 421.9000000000016, 338.9000000000008, 644.050843859086, 205.0000000000004, 233.4999999999978, 219.58174491448295, 291.0999999999999, 138.70000000000024, 65.60000000000055, 381.0514839935371, 245.70000000000041, 541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.964866754049874, 338.9063478860582, 296.4062856021409, 109.36639189010505, 117.99150492753955, 1.860157193795023, 27.832384831853233, 157.14197680017693, 2.1127357480887956, 188.42751248688893, 1.5234660678339182, -4.306473480487744, 188.7191590063841, -27.636213717632884, -59.592039333423884, 160.5999999999985, -34.70629727050268, 18.661278719078382, -24.09216611613462, -55.77345753023273, -203.21831045400717, 67.38607572800406, -1.6418912791532847, 236.3022604639305, 50.13929464649561, -114.4400054659767, 147.35661377515765, -12.851291522072668, 17.42074777282035, -80.27914764617988, -203.18125425794796, -280.8877743313891, 203.2691752063312, -119.16515515214667, 183.83441481056633, -384.1249140655181, -119.1003248492344, 216.77692929468904, 348.12892957654566, 51.89772132045287, 176.6398191339703, 320.80345738927235, 333.221255045393, 146.5501227047259, -329.07855876714285, -62.700330544093205, 170.78219062432152, 287.6932110393518, -98.25453325768208, 35.60260764564543, 39.00133985639031, -163.32117938526292, 269.7594536816125, -145.83178233872138, -301.59388916622214, 51.88423242009244, 193.6824543752575, -5.105930430371153, 168.501380697444, 46.62310062642271, 120.59216405346986, -84.24341274912425, -25.396777466214296, 57.50364984742107, -53.43765390225873, 317.9022508729412, 208.13091858438233, 36.05759654915703, -27.575720626461333, 104.87391783452387, 360.5886215262346, 10.070826436928371, -101.72556237483363, 91.38493513151943, -14.008464492530763, 71.67040648191652, -53.98155448827467, 2.357194926100353, -167.4649844663422, 79.27032816998116, -28.836694644396857, 90.59406498902823, -23.392759772966564, -172.50217940018646, 64.9994357200459, -138.52541128221276, 12.559612266881658, 38.18645513039489, 109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237], "policy_predator_policy_reward": [29.735133245950234, 24.493652113941685, 29.793714397859166, 28.733608109893623, 153.16824621753983, 44.98009166112567, 51.97361740515323, 265.2705245159826, 116.45029775063564, 6.909454014386911, 36.176533932166045, 40.80647348048805, 25.61254514185654, 251.30831995923086, 95.4920393334225, 0.0, 91.17406422346947, 17.970954327955212, 125.62862175657457, 192.6226785212908, 293.2183104540087, 175.61392427199567, 1.003295968756508, 166.43633484646634, 181.55207144069598, 115.37961443462837, 150.23054055352682, 107.26413719338794, 125.06522655908864, 97.11842996255386, 363.6523194139506, 301.2391113468089, 89.26887821230439, 192.72710173351018, 97.97905240625985, 405.1681804571096, 157.9743852045523, 105.84901034999281, 0.0, 5.173349103001728, 25.60084756681701, 39.17576457725629, 28.378744954607047, 140.44987729527412, 363.97855876714635, 96.80033054409317, 53.51780937567869, 5.6067889606476236, 136.20921413933718, 69.93158005255515, 0.8986601436099741, 194.62117938526112, 0.0, 230.69715152018884, 437.945732978894, 5.24339838921266, 5.759197994113323, 97.06427806100058, 19.863057100320894, 93.81246157581253, 28.20783594653013, 119.84341274912222, 69.67745019071718, 131.31567742807607, 106.04905687182284, 47.586346157494255, 170.8190991733173, 6.892385693141936, 63.47572062646165, 198.12608216547613, 204.03353590301356, 69.35785999290925, 198.92556237483265, 16.415064868480663, 125.72690734225314, 50.111150668360686, 203.23637016698999, 67.96973430966806, 196.06498446634117, 183.2296718300185, 65.53669464439737, 11.40593501097178, 59.992759772967055, 201.50217940018481, 132.77408263713232, 321.803376918572, 109.84038773311745, 85.11354486960403, 167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.89576802207114, "mean_inference_ms": 5.43913110921592, "mean_action_processing_ms": 1.9049232889780976, "mean_env_wait_ms": 10.35890781849056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005481474929385715, "StateBufferConnector_ms": 0.031751725408766, "ViewRequirementAgentConnector_ms": 0.178007615937127}, "num_episodes": 0, "episode_return_max": 700.6000000000014, "episode_return_min": 65.60000000000055, "episode_return_mean": 327.5292095106287, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.04274489638941, "num_env_steps_trained_throughput_per_sec": 79.04274489638941, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 52811.318, "restore_workers_time_ms": 0.028, "training_step_time_ms": 52811.207, "sample_time_ms": 3169.402, "learn_time_ms": 49613.391, "learn_throughput": 80.623, "synch_weights_time_ms": 22.368}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "35fb9_00000", "date": "2024-08-22_08-01-36", "timestamp": 1724293896, "time_this_iter_s": 50.65339684486389, "time_total_s": 475.7543754577637, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b61a280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 475.7543754577637, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 32.111111111111114, "ram_util_percent": 83.28611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.025707599725672, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.286650038017798, "policy_loss": -0.023805906720306705, "vf_loss": 7.307439329258348, "vf_explained_var": 0.42796838352919886, "kl": 0.01508316783771589, "entropy": 1.499978513061685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.542159108131651, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.9500948256285735, "policy_loss": -0.020084541426015595, "vf_loss": 2.967610035245381, "vf_explained_var": 0.17177872348714757, "kl": 0.012846673639471489, "entropy": 1.4851378607371497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 700.6000000000014, "episode_reward_min": 65.60000000000055, "episode_reward_mean": 327.5292095106287, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -384.1249140655181, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 360.5886215262346, "predator_policy": 459.96916506252677}, "policy_reward_mean": {"prey_policy": 45.92442999869781, "predator_policy": 117.84017475661636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [403.1000000000021, 464.3000000000038, 318.00000000000045, 502.21850355316565, 313.9000000000001, 74.20000000000007, 438.00381038983824, 196.4999999999967, 93.0999999999989, 238.38567663149715, 333.00000000000034, 402.09999999999957, 232.63097505584292, 392.00000000000057, 159.32525664828498, 180.82240217141552, 366.09999999999985, 302.8567336084134, 361.5000000000002, 405.20000000000175, 562.2198886673219, 648.6000000000016, 69.00000000000023, 517.5999999999998, 143.48886857985732, 71.20000000000023, 354.62482286308057, 193.47947462197544, 291.3999999999993, 328.8000000000011, 184.39999999999813, 233.09999999999945, 418.10000000000036, 421.9000000000016, 338.9000000000008, 644.050843859086, 205.0000000000004, 233.4999999999978, 219.58174491448295, 291.0999999999999, 138.70000000000024, 65.60000000000055, 381.0514839935371, 245.70000000000041, 541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.964866754049874, 338.9063478860582, 296.4062856021409, 109.36639189010505, 117.99150492753955, 1.860157193795023, 27.832384831853233, 157.14197680017693, 2.1127357480887956, 188.42751248688893, 1.5234660678339182, -4.306473480487744, 188.7191590063841, -27.636213717632884, -59.592039333423884, 160.5999999999985, -34.70629727050268, 18.661278719078382, -24.09216611613462, -55.77345753023273, -203.21831045400717, 67.38607572800406, -1.6418912791532847, 236.3022604639305, 50.13929464649561, -114.4400054659767, 147.35661377515765, -12.851291522072668, 17.42074777282035, -80.27914764617988, -203.18125425794796, -280.8877743313891, 203.2691752063312, -119.16515515214667, 183.83441481056633, -384.1249140655181, -119.1003248492344, 216.77692929468904, 348.12892957654566, 51.89772132045287, 176.6398191339703, 320.80345738927235, 333.221255045393, 146.5501227047259, -329.07855876714285, -62.700330544093205, 170.78219062432152, 287.6932110393518, -98.25453325768208, 35.60260764564543, 39.00133985639031, -163.32117938526292, 269.7594536816125, -145.83178233872138, -301.59388916622214, 51.88423242009244, 193.6824543752575, -5.105930430371153, 168.501380697444, 46.62310062642271, 120.59216405346986, -84.24341274912425, -25.396777466214296, 57.50364984742107, -53.43765390225873, 317.9022508729412, 208.13091858438233, 36.05759654915703, -27.575720626461333, 104.87391783452387, 360.5886215262346, 10.070826436928371, -101.72556237483363, 91.38493513151943, -14.008464492530763, 71.67040648191652, -53.98155448827467, 2.357194926100353, -167.4649844663422, 79.27032816998116, -28.836694644396857, 90.59406498902823, -23.392759772966564, -172.50217940018646, 64.9994357200459, -138.52541128221276, 12.559612266881658, 38.18645513039489, 109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237], "policy_predator_policy_reward": [29.735133245950234, 24.493652113941685, 29.793714397859166, 28.733608109893623, 153.16824621753983, 44.98009166112567, 51.97361740515323, 265.2705245159826, 116.45029775063564, 6.909454014386911, 36.176533932166045, 40.80647348048805, 25.61254514185654, 251.30831995923086, 95.4920393334225, 0.0, 91.17406422346947, 17.970954327955212, 125.62862175657457, 192.6226785212908, 293.2183104540087, 175.61392427199567, 1.003295968756508, 166.43633484646634, 181.55207144069598, 115.37961443462837, 150.23054055352682, 107.26413719338794, 125.06522655908864, 97.11842996255386, 363.6523194139506, 301.2391113468089, 89.26887821230439, 192.72710173351018, 97.97905240625985, 405.1681804571096, 157.9743852045523, 105.84901034999281, 0.0, 5.173349103001728, 25.60084756681701, 39.17576457725629, 28.378744954607047, 140.44987729527412, 363.97855876714635, 96.80033054409317, 53.51780937567869, 5.6067889606476236, 136.20921413933718, 69.93158005255515, 0.8986601436099741, 194.62117938526112, 0.0, 230.69715152018884, 437.945732978894, 5.24339838921266, 5.759197994113323, 97.06427806100058, 19.863057100320894, 93.81246157581253, 28.20783594653013, 119.84341274912222, 69.67745019071718, 131.31567742807607, 106.04905687182284, 47.586346157494255, 170.8190991733173, 6.892385693141936, 63.47572062646165, 198.12608216547613, 204.03353590301356, 69.35785999290925, 198.92556237483265, 16.415064868480663, 125.72690734225314, 50.111150668360686, 203.23637016698999, 67.96973430966806, 196.06498446634117, 183.2296718300185, 65.53669464439737, 11.40593501097178, 59.992759772967055, 201.50217940018481, 132.77408263713232, 321.803376918572, 109.84038773311745, 85.11354486960403, 167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.89576802207114, "mean_inference_ms": 5.43913110921592, "mean_action_processing_ms": 1.9049232889780976, "mean_env_wait_ms": 10.35890781849056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005481474929385715, "StateBufferConnector_ms": 0.031751725408766, "ViewRequirementAgentConnector_ms": 0.178007615937127}, "num_episodes": 0, "episode_return_max": 700.6000000000014, "episode_return_min": 65.60000000000055, "episode_return_mean": 327.5292095106287, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.97663245356267, "num_env_steps_trained_throughput_per_sec": 76.97663245356267, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 52726.569, "restore_workers_time_ms": 0.026, "training_step_time_ms": 52726.463, "sample_time_ms": 3055.955, "learn_time_ms": 49643.293, "learn_throughput": 80.575, "synch_weights_time_ms": 21.443}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "35fb9_00000", "date": "2024-08-22_08-02-28", "timestamp": 1724293948, "time_this_iter_s": 52.00153994560242, "time_total_s": 527.7559154033661, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b612310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 527.7559154033661, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 38.21486486486487, "ram_util_percent": 82.02297297297295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.516002318058064, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.784273467997394, "policy_loss": -0.018617182912024122, "vf_loss": 7.800354875080169, "vf_explained_var": 0.3797090840718103, "kl": 0.012679043252553259, "entropy": 1.4896161864043544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9518319613403743, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.2352986109319817, "policy_loss": -0.02359614277667509, "vf_loss": 2.256301513613847, "vf_explained_var": 0.1582289751559969, "kl": 0.012966197806720932, "entropy": 1.485069111226097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 700.6000000000014, "episode_reward_min": 65.60000000000055, "episode_reward_mean": 327.5292095106287, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -384.1249140655181, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 360.5886215262346, "predator_policy": 459.96916506252677}, "policy_reward_mean": {"prey_policy": 45.92442999869781, "predator_policy": 117.84017475661636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [403.1000000000021, 464.3000000000038, 318.00000000000045, 502.21850355316565, 313.9000000000001, 74.20000000000007, 438.00381038983824, 196.4999999999967, 93.0999999999989, 238.38567663149715, 333.00000000000034, 402.09999999999957, 232.63097505584292, 392.00000000000057, 159.32525664828498, 180.82240217141552, 366.09999999999985, 302.8567336084134, 361.5000000000002, 405.20000000000175, 562.2198886673219, 648.6000000000016, 69.00000000000023, 517.5999999999998, 143.48886857985732, 71.20000000000023, 354.62482286308057, 193.47947462197544, 291.3999999999993, 328.8000000000011, 184.39999999999813, 233.09999999999945, 418.10000000000036, 421.9000000000016, 338.9000000000008, 644.050843859086, 205.0000000000004, 233.4999999999978, 219.58174491448295, 291.0999999999999, 138.70000000000024, 65.60000000000055, 381.0514839935371, 245.70000000000041, 541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.964866754049874, 338.9063478860582, 296.4062856021409, 109.36639189010505, 117.99150492753955, 1.860157193795023, 27.832384831853233, 157.14197680017693, 2.1127357480887956, 188.42751248688893, 1.5234660678339182, -4.306473480487744, 188.7191590063841, -27.636213717632884, -59.592039333423884, 160.5999999999985, -34.70629727050268, 18.661278719078382, -24.09216611613462, -55.77345753023273, -203.21831045400717, 67.38607572800406, -1.6418912791532847, 236.3022604639305, 50.13929464649561, -114.4400054659767, 147.35661377515765, -12.851291522072668, 17.42074777282035, -80.27914764617988, -203.18125425794796, -280.8877743313891, 203.2691752063312, -119.16515515214667, 183.83441481056633, -384.1249140655181, -119.1003248492344, 216.77692929468904, 348.12892957654566, 51.89772132045287, 176.6398191339703, 320.80345738927235, 333.221255045393, 146.5501227047259, -329.07855876714285, -62.700330544093205, 170.78219062432152, 287.6932110393518, -98.25453325768208, 35.60260764564543, 39.00133985639031, -163.32117938526292, 269.7594536816125, -145.83178233872138, -301.59388916622214, 51.88423242009244, 193.6824543752575, -5.105930430371153, 168.501380697444, 46.62310062642271, 120.59216405346986, -84.24341274912425, -25.396777466214296, 57.50364984742107, -53.43765390225873, 317.9022508729412, 208.13091858438233, 36.05759654915703, -27.575720626461333, 104.87391783452387, 360.5886215262346, 10.070826436928371, -101.72556237483363, 91.38493513151943, -14.008464492530763, 71.67040648191652, -53.98155448827467, 2.357194926100353, -167.4649844663422, 79.27032816998116, -28.836694644396857, 90.59406498902823, -23.392759772966564, -172.50217940018646, 64.9994357200459, -138.52541128221276, 12.559612266881658, 38.18645513039489, 109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237], "policy_predator_policy_reward": [29.735133245950234, 24.493652113941685, 29.793714397859166, 28.733608109893623, 153.16824621753983, 44.98009166112567, 51.97361740515323, 265.2705245159826, 116.45029775063564, 6.909454014386911, 36.176533932166045, 40.80647348048805, 25.61254514185654, 251.30831995923086, 95.4920393334225, 0.0, 91.17406422346947, 17.970954327955212, 125.62862175657457, 192.6226785212908, 293.2183104540087, 175.61392427199567, 1.003295968756508, 166.43633484646634, 181.55207144069598, 115.37961443462837, 150.23054055352682, 107.26413719338794, 125.06522655908864, 97.11842996255386, 363.6523194139506, 301.2391113468089, 89.26887821230439, 192.72710173351018, 97.97905240625985, 405.1681804571096, 157.9743852045523, 105.84901034999281, 0.0, 5.173349103001728, 25.60084756681701, 39.17576457725629, 28.378744954607047, 140.44987729527412, 363.97855876714635, 96.80033054409317, 53.51780937567869, 5.6067889606476236, 136.20921413933718, 69.93158005255515, 0.8986601436099741, 194.62117938526112, 0.0, 230.69715152018884, 437.945732978894, 5.24339838921266, 5.759197994113323, 97.06427806100058, 19.863057100320894, 93.81246157581253, 28.20783594653013, 119.84341274912222, 69.67745019071718, 131.31567742807607, 106.04905687182284, 47.586346157494255, 170.8190991733173, 6.892385693141936, 63.47572062646165, 198.12608216547613, 204.03353590301356, 69.35785999290925, 198.92556237483265, 16.415064868480663, 125.72690734225314, 50.111150668360686, 203.23637016698999, 67.96973430966806, 196.06498446634117, 183.2296718300185, 65.53669464439737, 11.40593501097178, 59.992759772967055, 201.50217940018481, 132.77408263713232, 321.803376918572, 109.84038773311745, 85.11354486960403, 167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.89576802207114, "mean_inference_ms": 5.43913110921592, "mean_action_processing_ms": 1.9049232889780976, "mean_env_wait_ms": 10.35890781849056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005481474929385715, "StateBufferConnector_ms": 0.031751725408766, "ViewRequirementAgentConnector_ms": 0.178007615937127}, "num_episodes": 0, "episode_return_max": 700.6000000000014, "episode_return_min": 65.60000000000055, "episode_return_mean": 327.5292095106287, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.79008356097184, "num_env_steps_trained_throughput_per_sec": 81.79008356097184, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 52181.689, "restore_workers_time_ms": 0.025, "training_step_time_ms": 52181.58, "sample_time_ms": 2886.252, "learn_time_ms": 49267.053, "learn_throughput": 81.19, "synch_weights_time_ms": 22.79}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "35fb9_00000", "date": "2024-08-22_08-03-17", "timestamp": 1724293997, "time_this_iter_s": 48.929847955703735, "time_total_s": 576.6857633590698, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fca8820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 576.6857633590698, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 27.78695652173913, "ram_util_percent": 81.87391304347824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.965713171416489, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.739424667913447, "policy_loss": -0.025227532194183264, "vf_loss": 7.76213730024913, "vf_explained_var": 0.4927027419761375, "kl": 0.012574480185728697, "entropy": 1.4994122331735318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.843762075995642, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.7699202578534525, "policy_loss": -0.021428917728305335, "vf_loss": 1.7888077639398121, "vf_explained_var": 0.20737863495236353, "kl": 0.012707057179114412, "entropy": 1.4715734588406073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 700.6000000000014, "episode_reward_min": 65.60000000000055, "episode_reward_mean": 327.5292095106287, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28800, "policy_reward_min": {"prey_policy": -384.1249140655181, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 360.5886215262346, "predator_policy": 459.96916506252677}, "policy_reward_mean": {"prey_policy": 45.92442999869781, "predator_policy": 117.84017475661636}, "custom_metrics": {}, "hist_stats": {"episode_reward": [403.1000000000021, 464.3000000000038, 318.00000000000045, 502.21850355316565, 313.9000000000001, 74.20000000000007, 438.00381038983824, 196.4999999999967, 93.0999999999989, 238.38567663149715, 333.00000000000034, 402.09999999999957, 232.63097505584292, 392.00000000000057, 159.32525664828498, 180.82240217141552, 366.09999999999985, 302.8567336084134, 361.5000000000002, 405.20000000000175, 562.2198886673219, 648.6000000000016, 69.00000000000023, 517.5999999999998, 143.48886857985732, 71.20000000000023, 354.62482286308057, 193.47947462197544, 291.3999999999993, 328.8000000000011, 184.39999999999813, 233.09999999999945, 418.10000000000036, 421.9000000000016, 338.9000000000008, 644.050843859086, 205.0000000000004, 233.4999999999978, 219.58174491448295, 291.0999999999999, 138.70000000000024, 65.60000000000055, 381.0514839935371, 245.70000000000041, 541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.964866754049874, 338.9063478860582, 296.4062856021409, 109.36639189010505, 117.99150492753955, 1.860157193795023, 27.832384831853233, 157.14197680017693, 2.1127357480887956, 188.42751248688893, 1.5234660678339182, -4.306473480487744, 188.7191590063841, -27.636213717632884, -59.592039333423884, 160.5999999999985, -34.70629727050268, 18.661278719078382, -24.09216611613462, -55.77345753023273, -203.21831045400717, 67.38607572800406, -1.6418912791532847, 236.3022604639305, 50.13929464649561, -114.4400054659767, 147.35661377515765, -12.851291522072668, 17.42074777282035, -80.27914764617988, -203.18125425794796, -280.8877743313891, 203.2691752063312, -119.16515515214667, 183.83441481056633, -384.1249140655181, -119.1003248492344, 216.77692929468904, 348.12892957654566, 51.89772132045287, 176.6398191339703, 320.80345738927235, 333.221255045393, 146.5501227047259, -329.07855876714285, -62.700330544093205, 170.78219062432152, 287.6932110393518, -98.25453325768208, 35.60260764564543, 39.00133985639031, -163.32117938526292, 269.7594536816125, -145.83178233872138, -301.59388916622214, 51.88423242009244, 193.6824543752575, -5.105930430371153, 168.501380697444, 46.62310062642271, 120.59216405346986, -84.24341274912425, -25.396777466214296, 57.50364984742107, -53.43765390225873, 317.9022508729412, 208.13091858438233, 36.05759654915703, -27.575720626461333, 104.87391783452387, 360.5886215262346, 10.070826436928371, -101.72556237483363, 91.38493513151943, -14.008464492530763, 71.67040648191652, -53.98155448827467, 2.357194926100353, -167.4649844663422, 79.27032816998116, -28.836694644396857, 90.59406498902823, -23.392759772966564, -172.50217940018646, 64.9994357200459, -138.52541128221276, 12.559612266881658, 38.18645513039489, 109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237], "policy_predator_policy_reward": [29.735133245950234, 24.493652113941685, 29.793714397859166, 28.733608109893623, 153.16824621753983, 44.98009166112567, 51.97361740515323, 265.2705245159826, 116.45029775063564, 6.909454014386911, 36.176533932166045, 40.80647348048805, 25.61254514185654, 251.30831995923086, 95.4920393334225, 0.0, 91.17406422346947, 17.970954327955212, 125.62862175657457, 192.6226785212908, 293.2183104540087, 175.61392427199567, 1.003295968756508, 166.43633484646634, 181.55207144069598, 115.37961443462837, 150.23054055352682, 107.26413719338794, 125.06522655908864, 97.11842996255386, 363.6523194139506, 301.2391113468089, 89.26887821230439, 192.72710173351018, 97.97905240625985, 405.1681804571096, 157.9743852045523, 105.84901034999281, 0.0, 5.173349103001728, 25.60084756681701, 39.17576457725629, 28.378744954607047, 140.44987729527412, 363.97855876714635, 96.80033054409317, 53.51780937567869, 5.6067889606476236, 136.20921413933718, 69.93158005255515, 0.8986601436099741, 194.62117938526112, 0.0, 230.69715152018884, 437.945732978894, 5.24339838921266, 5.759197994113323, 97.06427806100058, 19.863057100320894, 93.81246157581253, 28.20783594653013, 119.84341274912222, 69.67745019071718, 131.31567742807607, 106.04905687182284, 47.586346157494255, 170.8190991733173, 6.892385693141936, 63.47572062646165, 198.12608216547613, 204.03353590301356, 69.35785999290925, 198.92556237483265, 16.415064868480663, 125.72690734225314, 50.111150668360686, 203.23637016698999, 67.96973430966806, 196.06498446634117, 183.2296718300185, 65.53669464439737, 11.40593501097178, 59.992759772967055, 201.50217940018481, 132.77408263713232, 321.803376918572, 109.84038773311745, 85.11354486960403, 167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.89576802207114, "mean_inference_ms": 5.43913110921592, "mean_action_processing_ms": 1.9049232889780976, "mean_env_wait_ms": 10.35890781849056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005481474929385715, "StateBufferConnector_ms": 0.031751725408766, "ViewRequirementAgentConnector_ms": 0.178007615937127}, "num_episodes": 0, "episode_return_max": 700.6000000000014, "episode_return_min": 65.60000000000055, "episode_return_mean": 327.5292095106287, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.83055250109537, "num_env_steps_trained_throughput_per_sec": 76.83055250109537, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 51939.871, "restore_workers_time_ms": 0.019, "training_step_time_ms": 51939.77, "sample_time_ms": 2709.607, "learn_time_ms": 49204.554, "learn_throughput": 81.293, "synch_weights_time_ms": 20.139}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "35fb9_00000", "date": "2024-08-22_08-04-09", "timestamp": 1724294049, "time_this_iter_s": 52.1044499874115, "time_total_s": 628.7902133464813, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b5e7670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 628.7902133464813, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 33.943243243243245, "ram_util_percent": 82.68783783783785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.005203166966716, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.378932994257205, "policy_loss": -0.023909690619012706, "vf_loss": 7.400743885393496, "vf_explained_var": 0.48099681892723, "kl": 0.010493998150415127, "entropy": 1.5140830214692171, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0434092957506733, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.4023585804555783, "policy_loss": -0.017312908977289838, "vf_loss": 1.4171726667928317, "vf_explained_var": 0.2260356826756997, "kl": 0.012494123654893387, "entropy": 1.4794515079291408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 700.6000000000014, "episode_reward_min": 65.60000000000055, "episode_reward_mean": 350.99123773086296, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 32400, "policy_reward_min": {"prey_policy": -384.1249140655181, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.8729836863868, "predator_policy": 459.96916506252677}, "policy_reward_mean": {"prey_policy": 60.921741882781156, "predator_policy": 114.57387698265016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [403.1000000000021, 464.3000000000038, 318.00000000000045, 502.21850355316565, 313.9000000000001, 74.20000000000007, 438.00381038983824, 196.4999999999967, 93.0999999999989, 238.38567663149715, 333.00000000000034, 402.09999999999957, 232.63097505584292, 392.00000000000057, 159.32525664828498, 180.82240217141552, 366.09999999999985, 302.8567336084134, 361.5000000000002, 405.20000000000175, 562.2198886673219, 648.6000000000016, 69.00000000000023, 517.5999999999998, 143.48886857985732, 71.20000000000023, 354.62482286308057, 193.47947462197544, 291.3999999999993, 328.8000000000011, 184.39999999999813, 233.09999999999945, 418.10000000000036, 421.9000000000016, 338.9000000000008, 644.050843859086, 205.0000000000004, 233.4999999999978, 219.58174491448295, 291.0999999999999, 138.70000000000024, 65.60000000000055, 381.0514839935371, 245.70000000000041, 541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414, 403.3849463158407, 649.6605688381995, 653.1024591207666, 694.8000000000004, 429.10000000000275, 597.3999999999999, 275.3391971598266, 576.9999999999993, 568.3999999999997], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [9.964866754049874, 338.9063478860582, 296.4062856021409, 109.36639189010505, 117.99150492753955, 1.860157193795023, 27.832384831853233, 157.14197680017693, 2.1127357480887956, 188.42751248688893, 1.5234660678339182, -4.306473480487744, 188.7191590063841, -27.636213717632884, -59.592039333423884, 160.5999999999985, -34.70629727050268, 18.661278719078382, -24.09216611613462, -55.77345753023273, -203.21831045400717, 67.38607572800406, -1.6418912791532847, 236.3022604639305, 50.13929464649561, -114.4400054659767, 147.35661377515765, -12.851291522072668, 17.42074777282035, -80.27914764617988, -203.18125425794796, -280.8877743313891, 203.2691752063312, -119.16515515214667, 183.83441481056633, -384.1249140655181, -119.1003248492344, 216.77692929468904, 348.12892957654566, 51.89772132045287, 176.6398191339703, 320.80345738927235, 333.221255045393, 146.5501227047259, -329.07855876714285, -62.700330544093205, 170.78219062432152, 287.6932110393518, -98.25453325768208, 35.60260764564543, 39.00133985639031, -163.32117938526292, 269.7594536816125, -145.83178233872138, -301.59388916622214, 51.88423242009244, 193.6824543752575, -5.105930430371153, 168.501380697444, 46.62310062642271, 120.59216405346986, -84.24341274912425, -25.396777466214296, 57.50364984742107, -53.43765390225873, 317.9022508729412, 208.13091858438233, 36.05759654915703, -27.575720626461333, 104.87391783452387, 360.5886215262346, 10.070826436928371, -101.72556237483363, 91.38493513151943, -14.008464492530763, 71.67040648191652, -53.98155448827467, 2.357194926100353, -167.4649844663422, 79.27032816998116, -28.836694644396857, 90.59406498902823, -23.392759772966564, -172.50217940018646, 64.9994357200459, -138.52541128221276, 12.559612266881658, 38.18645513039489, 109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237, 119.88533338341648, 140.05495294343908, 244.11686489949642, 96.55160593135005, 247.78853215569092, 256.5484538089569, 324.18096798843004, 294.84285076296163, 387.8729836863868, 7.334222721197738, 269.0367365764463, 238.5168143057404, 61.04616103114271, -268.0750361284804, 117.09616088724516, 366.5235133102798, 294.02385247423115, 58.85929446013026], "policy_predator_policy_reward": [29.735133245950234, 24.493652113941685, 29.793714397859166, 28.733608109893623, 153.16824621753983, 44.98009166112567, 51.97361740515323, 265.2705245159826, 116.45029775063564, 6.909454014386911, 36.176533932166045, 40.80647348048805, 25.61254514185654, 251.30831995923086, 95.4920393334225, 0.0, 91.17406422346947, 17.970954327955212, 125.62862175657457, 192.6226785212908, 293.2183104540087, 175.61392427199567, 1.003295968756508, 166.43633484646634, 181.55207144069598, 115.37961443462837, 150.23054055352682, 107.26413719338794, 125.06522655908864, 97.11842996255386, 363.6523194139506, 301.2391113468089, 89.26887821230439, 192.72710173351018, 97.97905240625985, 405.1681804571096, 157.9743852045523, 105.84901034999281, 0.0, 5.173349103001728, 25.60084756681701, 39.17576457725629, 28.378744954607047, 140.44987729527412, 363.97855876714635, 96.80033054409317, 53.51780937567869, 5.6067889606476236, 136.20921413933718, 69.93158005255515, 0.8986601436099741, 194.62117938526112, 0.0, 230.69715152018884, 437.945732978894, 5.24339838921266, 5.759197994113323, 97.06427806100058, 19.863057100320894, 93.81246157581253, 28.20783594653013, 119.84341274912222, 69.67745019071718, 131.31567742807607, 106.04905687182284, 47.586346157494255, 170.8190991733173, 6.892385693141936, 63.47572062646165, 198.12608216547613, 204.03353590301356, 69.35785999290925, 198.92556237483265, 16.415064868480663, 125.72690734225314, 50.111150668360686, 203.23637016698999, 67.96973430966806, 196.06498446634117, 183.2296718300185, 65.53669464439737, 11.40593501097178, 59.992759772967055, 201.50217940018481, 132.77408263713232, 321.803376918572, 109.84038773311745, 85.11354486960403, 167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259, 66.75128377397041, 76.6933762150143, 177.49315577088947, 131.49894223646353, 61.671684985541475, 87.09378817057755, 14.404937405661258, 61.37124384294695, 2.8270163136132163, 31.065777278802425, 55.223913216656676, 34.62253590115667, 59.63811887197713, 422.72995338518433, 75.741118324378, 17.639207478097056, 163.87324048890864, 51.64361257672965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.8111115644223785, "mean_inference_ms": 5.396503137952448, "mean_action_processing_ms": 1.8732590729892404, "mean_env_wait_ms": 10.341690959578951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005416222560552903, "StateBufferConnector_ms": 0.028648347030451268, "ViewRequirementAgentConnector_ms": 0.18969318013132355}, "num_episodes": 9, "episode_return_max": 700.6000000000014, "episode_return_min": 65.60000000000055, "episode_return_mean": 350.99123773086296, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.04855648469378, "num_env_steps_trained_throughput_per_sec": 77.04855648469378, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 51484.544, "restore_workers_time_ms": 0.019, "training_step_time_ms": 51484.442, "sample_time_ms": 2693.868, "learn_time_ms": 48765.092, "learn_throughput": 82.026, "synch_weights_time_ms": 20.205}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "35fb9_00000", "date": "2024-08-22_08-05-01", "timestamp": 1724294101, "time_this_iter_s": 51.95391011238098, "time_total_s": 680.7441234588623, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fca8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 680.7441234588623, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 33.6445945945946, "ram_util_percent": 82.81891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.946534240119671, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.6001752752475635, "policy_loss": -0.024201234337927962, "vf_loss": 7.621593924931117, "vf_explained_var": 0.46930181289476064, "kl": 0.013913012244837191, "entropy": 1.4296453194012717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.760197946035042, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.441476890019008, "policy_loss": -0.019473390664077467, "vf_loss": 3.4580883413395553, "vf_explained_var": 0.23413702183299595, "kl": 0.014309703564842936, "entropy": 1.3605327242265934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 741.102717979803, "episode_reward_min": 65.60000000000055, "episode_reward_mean": 392.58246487532654, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -384.1249140655181, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.8729836863868, "predator_policy": 503.0660296194917}, "policy_reward_mean": {"prey_policy": 71.52745155019218, "predator_policy": 124.76378088747101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [438.00381038983824, 196.4999999999967, 93.0999999999989, 238.38567663149715, 333.00000000000034, 402.09999999999957, 232.63097505584292, 392.00000000000057, 159.32525664828498, 180.82240217141552, 366.09999999999985, 302.8567336084134, 361.5000000000002, 405.20000000000175, 562.2198886673219, 648.6000000000016, 69.00000000000023, 517.5999999999998, 143.48886857985732, 71.20000000000023, 354.62482286308057, 193.47947462197544, 291.3999999999993, 328.8000000000011, 184.39999999999813, 233.09999999999945, 418.10000000000036, 421.9000000000016, 338.9000000000008, 644.050843859086, 205.0000000000004, 233.4999999999978, 219.58174491448295, 291.0999999999999, 138.70000000000024, 65.60000000000055, 381.0514839935371, 245.70000000000041, 541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414, 403.3849463158407, 649.6605688381995, 653.1024591207666, 694.8000000000004, 429.10000000000275, 597.3999999999999, 275.3391971598266, 576.9999999999993, 568.3999999999997, 342.8999999999992, 420.8757493426506, 714.5851795664869, 464.44634842312206, 733.8, 501.3716860485341, 549.0306180095603, 610.6819660112498, 536.2549217211708, 446.8552871262054, 431.87792126376877, 484.60043352840205, 435.9000000000031, 553.8360679774994, 428.3413100531911, 531.9732765349136, 426.13352108307106, 346.07814926270396, 641.1646079867144, 506.3201659874442, 510.76052593359384, 646.1432436842961, 268.6410373615533, 741.102717979803, 630.0], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [188.7191590063841, -27.636213717632884, -59.592039333423884, 160.5999999999985, -34.70629727050268, 18.661278719078382, -24.09216611613462, -55.77345753023273, -203.21831045400717, 67.38607572800406, -1.6418912791532847, 236.3022604639305, 50.13929464649561, -114.4400054659767, 147.35661377515765, -12.851291522072668, 17.42074777282035, -80.27914764617988, -203.18125425794796, -280.8877743313891, 203.2691752063312, -119.16515515214667, 183.83441481056633, -384.1249140655181, -119.1003248492344, 216.77692929468904, 348.12892957654566, 51.89772132045287, 176.6398191339703, 320.80345738927235, 333.221255045393, 146.5501227047259, -329.07855876714285, -62.700330544093205, 170.78219062432152, 287.6932110393518, -98.25453325768208, 35.60260764564543, 39.00133985639031, -163.32117938526292, 269.7594536816125, -145.83178233872138, -301.59388916622214, 51.88423242009244, 193.6824543752575, -5.105930430371153, 168.501380697444, 46.62310062642271, 120.59216405346986, -84.24341274912425, -25.396777466214296, 57.50364984742107, -53.43765390225873, 317.9022508729412, 208.13091858438233, 36.05759654915703, -27.575720626461333, 104.87391783452387, 360.5886215262346, 10.070826436928371, -101.72556237483363, 91.38493513151943, -14.008464492530763, 71.67040648191652, -53.98155448827467, 2.357194926100353, -167.4649844663422, 79.27032816998116, -28.836694644396857, 90.59406498902823, -23.392759772966564, -172.50217940018646, 64.9994357200459, -138.52541128221276, 12.559612266881658, 38.18645513039489, 109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237, 119.88533338341648, 140.05495294343908, 244.11686489949642, 96.55160593135005, 247.78853215569092, 256.5484538089569, 324.18096798843004, 294.84285076296163, 387.8729836863868, 7.334222721197738, 269.0367365764463, 238.5168143057404, 61.04616103114271, -268.0750361284804, 117.09616088724516, 366.5235133102798, 294.02385247423115, 58.85929446013026, 86.49772600274537, 122.76100070370862, 96.76872272963907, -229.2766389711925, 307.7327311327707, 282.2092489207907, 164.66111548376628, -283.76137506262864, 369.4832707625171, 303.1420883169684, 246.28591979443, 35.419915413962606, 3.7535705146210754, 146.74859982612523, 160.28271015255385, 273.2101198445977, 323.9342462727044, -205.25937194067146, 117.2368980592433, 114.761089745013, 175.87683532883457, -138.74093697785116, 39.56654433447625, 13.047090381143091, -148.59354115241902, 373.8801854451344, 152.88171334989585, 274.6535923998707, 229.52888511336883, -361.96770085311556, 152.11611590030017, -73.44599370856405, -8.464589213689457, 261.2972255229023, -23.951766465242763, 185.1910549455033, 130.72026324642349, 277.97975106918705, -256.41495353422465, 167.09052955918455, 77.83376869717989, 235.81544338373556, 286.6888039224706, 251.98832876275287, 177.92509998144658, -138.32830069217556, 340.2961502094022, 125.8029359419605, 259.5445824416841, 206.98657669469253], "policy_predator_policy_reward": [25.61254514185654, 251.30831995923086, 95.4920393334225, 0.0, 91.17406422346947, 17.970954327955212, 125.62862175657457, 192.6226785212908, 293.2183104540087, 175.61392427199567, 1.003295968756508, 166.43633484646634, 181.55207144069598, 115.37961443462837, 150.23054055352682, 107.26413719338794, 125.06522655908864, 97.11842996255386, 363.6523194139506, 301.2391113468089, 89.26887821230439, 192.72710173351018, 97.97905240625985, 405.1681804571096, 157.9743852045523, 105.84901034999281, 0.0, 5.173349103001728, 25.60084756681701, 39.17576457725629, 28.378744954607047, 140.44987729527412, 363.97855876714635, 96.80033054409317, 53.51780937567869, 5.6067889606476236, 136.20921413933718, 69.93158005255515, 0.8986601436099741, 194.62117938526112, 0.0, 230.69715152018884, 437.945732978894, 5.24339838921266, 5.759197994113323, 97.06427806100058, 19.863057100320894, 93.81246157581253, 28.20783594653013, 119.84341274912222, 69.67745019071718, 131.31567742807607, 106.04905687182284, 47.586346157494255, 170.8190991733173, 6.892385693141936, 63.47572062646165, 198.12608216547613, 204.03353590301356, 69.35785999290925, 198.92556237483265, 16.415064868480663, 125.72690734225314, 50.111150668360686, 203.23637016698999, 67.96973430966806, 196.06498446634117, 183.2296718300185, 65.53669464439737, 11.40593501097178, 59.992759772967055, 201.50217940018481, 132.77408263713232, 321.803376918572, 109.84038773311745, 85.11354486960403, 167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259, 66.75128377397041, 76.6933762150143, 177.49315577088947, 131.49894223646353, 61.671684985541475, 87.09378817057755, 14.404937405661258, 61.37124384294695, 2.8270163136132163, 31.065777278802425, 55.223913216656676, 34.62253590115667, 59.63811887197713, 422.72995338518433, 75.741118324378, 17.639207478097056, 163.87324048890864, 51.64361257672965, 20.146453488288486, 113.49481980525782, 384.11179659606, 169.27186898814404, 76.41488572472666, 48.22831378819889, 142.5431684321773, 441.0034395698073, 49.402652585911596, 11.771988334602874, 136.81991578682383, 82.8459350533183, 53.17193098398548, 345.3565166848286, 86.09925585869603, 91.08988015540227, 46.02067544846684, 371.5593719406716, 60.4852012012978, 154.3720981206513, 172.1420475367418, 222.59997537604394, 287.0826656637411, 144.9041331490411, 200.84611813607873, 9.767237571204385, 51.34102924544513, 74.95973298228813, 276.72566912726916, 284.0544566656702, 403.7404440828033, 49.56271026037344, 79.21440321489142, 94.08648155896428, 72.67376710966874, 112.16509367277457, 128.30079262620444, 104.16380104489949, 92.57856034299311, 503.0660296194917, 24.940181098545256, 172.17113275413328, 29.6497081116151, 77.81640288745754, 41.470305955188046, 187.57393211709328, 125.97164053447425, 149.03199129396614, 25.847475283314235, 137.62136558030923]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.681587320569459, "mean_inference_ms": 5.290137745883836, "mean_action_processing_ms": 1.6983004286082672, "mean_env_wait_ms": 10.34116134454266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050945281982421875, "StateBufferConnector_ms": 0.02465653419494629, "ViewRequirementAgentConnector_ms": 0.19962787628173828}, "num_episodes": 25, "episode_return_max": 741.102717979803, "episode_return_min": 65.60000000000055, "episode_return_mean": 392.58246487532654, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.83475785274001, "num_env_steps_trained_throughput_per_sec": 80.83475785274001, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 51202.343, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51202.261, "sample_time_ms": 2594.541, "learn_time_ms": 48584.821, "learn_throughput": 82.33, "synch_weights_time_ms": 18.668}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "35fb9_00000", "date": "2024-08-22_08-05-50", "timestamp": 1724294150, "time_this_iter_s": 49.52520799636841, "time_total_s": 730.2693314552307, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fca8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 730.2693314552307, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.24285714285715, "ram_util_percent": 82.64428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.826928005773555, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.08681722646037, "policy_loss": -0.022049672473419123, "vf_loss": 8.106069380644136, "vf_explained_var": 0.37568688458866545, "kl": 0.013987624352285392, "entropy": 1.3541338054591385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.616508511670683, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.321640490728711, "policy_loss": -0.024035491401800224, "vf_loss": 5.342104092224565, "vf_explained_var": 0.2211664838765664, "kl": 0.017859410571437032, "entropy": 1.2049359862766569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 741.4617396744449, "episode_reward_min": 65.60000000000055, "episode_reward_mean": 453.7402102673878, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -361.96770085311556, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 503.0660296194917}, "policy_reward_mean": {"prey_policy": 96.44466109133332, "predator_policy": 130.42544404236048}, "custom_metrics": {}, "hist_stats": {"episode_reward": [233.09999999999945, 418.10000000000036, 421.9000000000016, 338.9000000000008, 644.050843859086, 205.0000000000004, 233.4999999999978, 219.58174491448295, 291.0999999999999, 138.70000000000024, 65.60000000000055, 381.0514839935371, 245.70000000000041, 541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414, 403.3849463158407, 649.6605688381995, 653.1024591207666, 694.8000000000004, 429.10000000000275, 597.3999999999999, 275.3391971598266, 576.9999999999993, 568.3999999999997, 342.8999999999992, 420.8757493426506, 714.5851795664869, 464.44634842312206, 733.8, 501.3716860485341, 549.0306180095603, 610.6819660112498, 536.2549217211708, 446.8552871262054, 431.87792126376877, 484.60043352840205, 435.9000000000031, 553.8360679774994, 428.3413100531911, 531.9732765349136, 426.13352108307106, 346.07814926270396, 641.1646079867144, 506.3201659874442, 510.76052593359384, 646.1432436842961, 268.6410373615533, 741.102717979803, 630.0, 412.30560952569556, 357.79302420828077, 662.8361175200994, 590.4099782095747, 544.2717094940876, 435.89999999999975, 83.94768094784058, 524.7822565359439, 692.5876713847405, 681.1, 603.4429841850268, 543.3000000000002, 741.4617396744449, 694.3497957573409, 442.94290853786856, 694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-25.396777466214296, 57.50364984742107, -53.43765390225873, 317.9022508729412, 208.13091858438233, 36.05759654915703, -27.575720626461333, 104.87391783452387, 360.5886215262346, 10.070826436928371, -101.72556237483363, 91.38493513151943, -14.008464492530763, 71.67040648191652, -53.98155448827467, 2.357194926100353, -167.4649844663422, 79.27032816998116, -28.836694644396857, 90.59406498902823, -23.392759772966564, -172.50217940018646, 64.9994357200459, -138.52541128221276, 12.559612266881658, 38.18645513039489, 109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237, 119.88533338341648, 140.05495294343908, 244.11686489949642, 96.55160593135005, 247.78853215569092, 256.5484538089569, 324.18096798843004, 294.84285076296163, 387.8729836863868, 7.334222721197738, 269.0367365764463, 238.5168143057404, 61.04616103114271, -268.0750361284804, 117.09616088724516, 366.5235133102798, 294.02385247423115, 58.85929446013026, 86.49772600274537, 122.76100070370862, 96.76872272963907, -229.2766389711925, 307.7327311327707, 282.2092489207907, 164.66111548376628, -283.76137506262864, 369.4832707625171, 303.1420883169684, 246.28591979443, 35.419915413962606, 3.7535705146210754, 146.74859982612523, 160.28271015255385, 273.2101198445977, 323.9342462727044, -205.25937194067146, 117.2368980592433, 114.761089745013, 175.87683532883457, -138.74093697785116, 39.56654433447625, 13.047090381143091, -148.59354115241902, 373.8801854451344, 152.88171334989585, 274.6535923998707, 229.52888511336883, -361.96770085311556, 152.11611590030017, -73.44599370856405, -8.464589213689457, 261.2972255229023, -23.951766465242763, 185.1910549455033, 130.72026324642349, 277.97975106918705, -256.41495353422465, 167.09052955918455, 77.83376869717989, 235.81544338373556, 286.6888039224706, 251.98832876275287, 177.92509998144658, -138.32830069217556, 340.2961502094022, 125.8029359419605, 259.5445824416841, 206.98657669469253, -57.72693517193404, 196.52678928321936, -186.90061952646928, 87.47692557999727, 243.58227907341717, 198.62993786146745, 133.01481242847245, 90.66666979211698, 299.9064715179807, -221.78693349828185, 197.37297656285864, 60.72971963466922, -5.24327918935133, -41.127368485604286, 197.73108275561054, 18.96803060497109, 258.841759029779, 299.8418264262235, 290.30513576712826, 293.6000273368171, 334.1899589764816, -137.2845019018719, 66.8652009438753, 400.0, 379.34071960847933, 312.1453647525333, 244.79810484704893, 355.00956577315014, -344.8786092499659, 246.1287674952319, 264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864], "policy_predator_policy_reward": [69.67745019071718, 131.31567742807607, 106.04905687182284, 47.586346157494255, 170.8190991733173, 6.892385693141936, 63.47572062646165, 198.12608216547613, 204.03353590301356, 69.35785999290925, 198.92556237483265, 16.415064868480663, 125.72690734225314, 50.111150668360686, 203.23637016698999, 67.96973430966806, 196.06498446634117, 183.2296718300185, 65.53669464439737, 11.40593501097178, 59.992759772967055, 201.50217940018481, 132.77408263713232, 321.803376918572, 109.84038773311745, 85.11354486960403, 167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259, 66.75128377397041, 76.6933762150143, 177.49315577088947, 131.49894223646353, 61.671684985541475, 87.09378817057755, 14.404937405661258, 61.37124384294695, 2.8270163136132163, 31.065777278802425, 55.223913216656676, 34.62253590115667, 59.63811887197713, 422.72995338518433, 75.741118324378, 17.639207478097056, 163.87324048890864, 51.64361257672965, 20.146453488288486, 113.49481980525782, 384.11179659606, 169.27186898814404, 76.41488572472666, 48.22831378819889, 142.5431684321773, 441.0034395698073, 49.402652585911596, 11.771988334602874, 136.81991578682383, 82.8459350533183, 53.17193098398548, 345.3565166848286, 86.09925585869603, 91.08988015540227, 46.02067544846684, 371.5593719406716, 60.4852012012978, 154.3720981206513, 172.1420475367418, 222.59997537604394, 287.0826656637411, 144.9041331490411, 200.84611813607873, 9.767237571204385, 51.34102924544513, 74.95973298228813, 276.72566912726916, 284.0544566656702, 403.7404440828033, 49.56271026037344, 79.21440321489142, 94.08648155896428, 72.67376710966874, 112.16509367277457, 128.30079262620444, 104.16380104489949, 92.57856034299311, 503.0660296194917, 24.940181098545256, 172.17113275413328, 29.6497081116151, 77.81640288745754, 41.470305955188046, 187.57393211709328, 125.97164053447425, 149.03199129396614, 25.847475283314235, 137.62136558030923, 189.47731984554895, 84.02843556886124, 259.50041010506607, 197.7163080496867, 46.4757821068619, 174.14811847835324, 5.101512396512092, 361.62698359247315, 297.652966162459, 168.49920531192979, 74.51410461876672, 103.28319918370536, 52.80658460295237, 77.5117440198439, 88.68669324151104, 219.3964499338513, 26.59415963508053, 107.3099262936579, 41.75796089873731, 55.43687599731739, 29.15302520854516, 377.38450190187194, 76.43479905612502, 0.0, 0.0, 49.97565531343221, 71.47470502220428, 23.067420114937512, 241.31817896804208, 300.3745713245613, 99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.510681264736679, "mean_inference_ms": 5.136260303022252, "mean_action_processing_ms": 1.5668315206474914, "mean_env_wait_ms": 10.363135273271245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011212468147277832, "StateBufferConnector_ms": 0.02479410171508789, "ViewRequirementAgentConnector_ms": 0.20812642574310303}, "num_episodes": 25, "episode_return_max": 741.4617396744449, "episode_return_min": 65.60000000000055, "episode_return_mean": 453.7402102673878, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.40082596895533, "num_env_steps_trained_throughput_per_sec": 76.40082596895533, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 51103.802, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51103.694, "sample_time_ms": 2299.464, "learn_time_ms": 48780.486, "learn_throughput": 82.0, "synch_weights_time_ms": 18.636}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "35fb9_00000", "date": "2024-08-22_08-06-43", "timestamp": 1724294203, "time_this_iter_s": 52.48005509376526, "time_total_s": 782.749386548996, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b61a8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 782.749386548996, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 35.636, "ram_util_percent": 82.32266666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.739115775073016, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.327122561893766, "policy_loss": -0.02448328213258671, "vf_loss": 8.34858398336582, "vf_explained_var": 0.3379883928589089, "kl": 0.01510933404640546, "entropy": 1.284998701867603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.941689103999466, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.582585470764725, "policy_loss": -0.023133790196121606, "vf_loss": 6.6021272626503436, "vf_explained_var": 0.21553065543452268, "kl": 0.017960098989445856, "entropy": 1.083388813179006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 741.4617396744449, "episode_reward_min": 73.00000000000013, "episode_reward_mean": 484.27365831652116, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -415.3215952131382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 503.0660296194917}, "policy_reward_mean": {"prey_policy": 108.31004361374899, "predator_policy": 133.82678554451152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414, 403.3849463158407, 649.6605688381995, 653.1024591207666, 694.8000000000004, 429.10000000000275, 597.3999999999999, 275.3391971598266, 576.9999999999993, 568.3999999999997, 342.8999999999992, 420.8757493426506, 714.5851795664869, 464.44634842312206, 733.8, 501.3716860485341, 549.0306180095603, 610.6819660112498, 536.2549217211708, 446.8552871262054, 431.87792126376877, 484.60043352840205, 435.9000000000031, 553.8360679774994, 428.3413100531911, 531.9732765349136, 426.13352108307106, 346.07814926270396, 641.1646079867144, 506.3201659874442, 510.76052593359384, 646.1432436842961, 268.6410373615533, 741.102717979803, 630.0, 412.30560952569556, 357.79302420828077, 662.8361175200994, 590.4099782095747, 544.2717094940876, 435.89999999999975, 83.94768094784058, 524.7822565359439, 692.5876713847405, 681.1, 603.4429841850268, 543.3000000000002, 741.4617396744449, 694.3497957573409, 442.94290853786856, 694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595, 711.9, 397.172196056187, 597.0999999999999, 510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237, 119.88533338341648, 140.05495294343908, 244.11686489949642, 96.55160593135005, 247.78853215569092, 256.5484538089569, 324.18096798843004, 294.84285076296163, 387.8729836863868, 7.334222721197738, 269.0367365764463, 238.5168143057404, 61.04616103114271, -268.0750361284804, 117.09616088724516, 366.5235133102798, 294.02385247423115, 58.85929446013026, 86.49772600274537, 122.76100070370862, 96.76872272963907, -229.2766389711925, 307.7327311327707, 282.2092489207907, 164.66111548376628, -283.76137506262864, 369.4832707625171, 303.1420883169684, 246.28591979443, 35.419915413962606, 3.7535705146210754, 146.74859982612523, 160.28271015255385, 273.2101198445977, 323.9342462727044, -205.25937194067146, 117.2368980592433, 114.761089745013, 175.87683532883457, -138.74093697785116, 39.56654433447625, 13.047090381143091, -148.59354115241902, 373.8801854451344, 152.88171334989585, 274.6535923998707, 229.52888511336883, -361.96770085311556, 152.11611590030017, -73.44599370856405, -8.464589213689457, 261.2972255229023, -23.951766465242763, 185.1910549455033, 130.72026324642349, 277.97975106918705, -256.41495353422465, 167.09052955918455, 77.83376869717989, 235.81544338373556, 286.6888039224706, 251.98832876275287, 177.92509998144658, -138.32830069217556, 340.2961502094022, 125.8029359419605, 259.5445824416841, 206.98657669469253, -57.72693517193404, 196.52678928321936, -186.90061952646928, 87.47692557999727, 243.58227907341717, 198.62993786146745, 133.01481242847245, 90.66666979211698, 299.9064715179807, -221.78693349828185, 197.37297656285864, 60.72971963466922, -5.24327918935133, -41.127368485604286, 197.73108275561054, 18.96803060497109, 258.841759029779, 299.8418264262235, 290.30513576712826, 293.6000273368171, 334.1899589764816, -137.2845019018719, 66.8652009438753, 400.0, 379.34071960847933, 312.1453647525333, 244.79810484704893, 355.00956577315014, -344.8786092499659, 246.1287674952319, 264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864, 345.93186930258634, 294.5763225440117, -110.34582862626014, 19.77672030202562, 236.32247218049395, 222.72442464854745, 45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926], "policy_predator_policy_reward": [167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259, 66.75128377397041, 76.6933762150143, 177.49315577088947, 131.49894223646353, 61.671684985541475, 87.09378817057755, 14.404937405661258, 61.37124384294695, 2.8270163136132163, 31.065777278802425, 55.223913216656676, 34.62253590115667, 59.63811887197713, 422.72995338518433, 75.741118324378, 17.639207478097056, 163.87324048890864, 51.64361257672965, 20.146453488288486, 113.49481980525782, 384.11179659606, 169.27186898814404, 76.41488572472666, 48.22831378819889, 142.5431684321773, 441.0034395698073, 49.402652585911596, 11.771988334602874, 136.81991578682383, 82.8459350533183, 53.17193098398548, 345.3565166848286, 86.09925585869603, 91.08988015540227, 46.02067544846684, 371.5593719406716, 60.4852012012978, 154.3720981206513, 172.1420475367418, 222.59997537604394, 287.0826656637411, 144.9041331490411, 200.84611813607873, 9.767237571204385, 51.34102924544513, 74.95973298228813, 276.72566912726916, 284.0544566656702, 403.7404440828033, 49.56271026037344, 79.21440321489142, 94.08648155896428, 72.67376710966874, 112.16509367277457, 128.30079262620444, 104.16380104489949, 92.57856034299311, 503.0660296194917, 24.940181098545256, 172.17113275413328, 29.6497081116151, 77.81640288745754, 41.470305955188046, 187.57393211709328, 125.97164053447425, 149.03199129396614, 25.847475283314235, 137.62136558030923, 189.47731984554895, 84.02843556886124, 259.50041010506607, 197.7163080496867, 46.4757821068619, 174.14811847835324, 5.101512396512092, 361.62698359247315, 297.652966162459, 168.49920531192979, 74.51410461876672, 103.28319918370536, 52.80658460295237, 77.5117440198439, 88.68669324151104, 219.3964499338513, 26.59415963508053, 107.3099262936579, 41.75796089873731, 55.43687599731739, 29.15302520854516, 377.38450190187194, 76.43479905612502, 0.0, 0.0, 49.97565531343221, 71.47470502220428, 23.067420114937512, 241.31817896804208, 300.3745713245613, 99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885, 5.068130697413661, 66.32367745598823, 155.06723795062626, 332.67406642979256, 125.19434524058353, 12.85875793037491, 440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.342155639869492, "mean_inference_ms": 4.9352758324176955, "mean_action_processing_ms": 1.5823092474651899, "mean_env_wait_ms": 10.311292717039004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013942122459411621, "StateBufferConnector_ms": 0.02437126636505127, "ViewRequirementAgentConnector_ms": 0.20619571208953857}, "num_episodes": 13, "episode_return_max": 741.4617396744449, "episode_return_min": 73.00000000000013, "episode_return_mean": 484.27365831652116, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.94476919722962, "num_env_steps_trained_throughput_per_sec": 77.94476919722962, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 51139.716, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51139.617, "sample_time_ms": 2291.733, "learn_time_ms": 48824.216, "learn_throughput": 81.927, "synch_weights_time_ms": 18.524}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "35fb9_00000", "date": "2024-08-22_08-07-34", "timestamp": 1724294254, "time_this_iter_s": 51.36909317970276, "time_total_s": 834.1184797286987, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b612a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 834.1184797286987, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.45342465753424, "ram_util_percent": 82.4945205479452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.660843784657736, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.713611295992735, "policy_loss": -0.018276106168777145, "vf_loss": 8.72907528599734, "vf_explained_var": 0.2679774967450944, "kl": 0.014060651662971371, "entropy": 1.2602930068969727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.376546020861025, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.533169940161327, "policy_loss": -0.02225156232471967, "vf_loss": 7.552030137985471, "vf_explained_var": 0.21493165735845213, "kl": 0.016956809072425125, "entropy": 1.0178380957986943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 741.4617396744449, "episode_reward_min": 73.00000000000013, "episode_reward_mean": 484.27365831652116, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -415.3215952131382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 503.0660296194917}, "policy_reward_mean": {"prey_policy": 108.31004361374899, "predator_policy": 133.82678554451152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414, 403.3849463158407, 649.6605688381995, 653.1024591207666, 694.8000000000004, 429.10000000000275, 597.3999999999999, 275.3391971598266, 576.9999999999993, 568.3999999999997, 342.8999999999992, 420.8757493426506, 714.5851795664869, 464.44634842312206, 733.8, 501.3716860485341, 549.0306180095603, 610.6819660112498, 536.2549217211708, 446.8552871262054, 431.87792126376877, 484.60043352840205, 435.9000000000031, 553.8360679774994, 428.3413100531911, 531.9732765349136, 426.13352108307106, 346.07814926270396, 641.1646079867144, 506.3201659874442, 510.76052593359384, 646.1432436842961, 268.6410373615533, 741.102717979803, 630.0, 412.30560952569556, 357.79302420828077, 662.8361175200994, 590.4099782095747, 544.2717094940876, 435.89999999999975, 83.94768094784058, 524.7822565359439, 692.5876713847405, 681.1, 603.4429841850268, 543.3000000000002, 741.4617396744449, 694.3497957573409, 442.94290853786856, 694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595, 711.9, 397.172196056187, 597.0999999999999, 510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237, 119.88533338341648, 140.05495294343908, 244.11686489949642, 96.55160593135005, 247.78853215569092, 256.5484538089569, 324.18096798843004, 294.84285076296163, 387.8729836863868, 7.334222721197738, 269.0367365764463, 238.5168143057404, 61.04616103114271, -268.0750361284804, 117.09616088724516, 366.5235133102798, 294.02385247423115, 58.85929446013026, 86.49772600274537, 122.76100070370862, 96.76872272963907, -229.2766389711925, 307.7327311327707, 282.2092489207907, 164.66111548376628, -283.76137506262864, 369.4832707625171, 303.1420883169684, 246.28591979443, 35.419915413962606, 3.7535705146210754, 146.74859982612523, 160.28271015255385, 273.2101198445977, 323.9342462727044, -205.25937194067146, 117.2368980592433, 114.761089745013, 175.87683532883457, -138.74093697785116, 39.56654433447625, 13.047090381143091, -148.59354115241902, 373.8801854451344, 152.88171334989585, 274.6535923998707, 229.52888511336883, -361.96770085311556, 152.11611590030017, -73.44599370856405, -8.464589213689457, 261.2972255229023, -23.951766465242763, 185.1910549455033, 130.72026324642349, 277.97975106918705, -256.41495353422465, 167.09052955918455, 77.83376869717989, 235.81544338373556, 286.6888039224706, 251.98832876275287, 177.92509998144658, -138.32830069217556, 340.2961502094022, 125.8029359419605, 259.5445824416841, 206.98657669469253, -57.72693517193404, 196.52678928321936, -186.90061952646928, 87.47692557999727, 243.58227907341717, 198.62993786146745, 133.01481242847245, 90.66666979211698, 299.9064715179807, -221.78693349828185, 197.37297656285864, 60.72971963466922, -5.24327918935133, -41.127368485604286, 197.73108275561054, 18.96803060497109, 258.841759029779, 299.8418264262235, 290.30513576712826, 293.6000273368171, 334.1899589764816, -137.2845019018719, 66.8652009438753, 400.0, 379.34071960847933, 312.1453647525333, 244.79810484704893, 355.00956577315014, -344.8786092499659, 246.1287674952319, 264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864, 345.93186930258634, 294.5763225440117, -110.34582862626014, 19.77672030202562, 236.32247218049395, 222.72442464854745, 45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926], "policy_predator_policy_reward": [167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259, 66.75128377397041, 76.6933762150143, 177.49315577088947, 131.49894223646353, 61.671684985541475, 87.09378817057755, 14.404937405661258, 61.37124384294695, 2.8270163136132163, 31.065777278802425, 55.223913216656676, 34.62253590115667, 59.63811887197713, 422.72995338518433, 75.741118324378, 17.639207478097056, 163.87324048890864, 51.64361257672965, 20.146453488288486, 113.49481980525782, 384.11179659606, 169.27186898814404, 76.41488572472666, 48.22831378819889, 142.5431684321773, 441.0034395698073, 49.402652585911596, 11.771988334602874, 136.81991578682383, 82.8459350533183, 53.17193098398548, 345.3565166848286, 86.09925585869603, 91.08988015540227, 46.02067544846684, 371.5593719406716, 60.4852012012978, 154.3720981206513, 172.1420475367418, 222.59997537604394, 287.0826656637411, 144.9041331490411, 200.84611813607873, 9.767237571204385, 51.34102924544513, 74.95973298228813, 276.72566912726916, 284.0544566656702, 403.7404440828033, 49.56271026037344, 79.21440321489142, 94.08648155896428, 72.67376710966874, 112.16509367277457, 128.30079262620444, 104.16380104489949, 92.57856034299311, 503.0660296194917, 24.940181098545256, 172.17113275413328, 29.6497081116151, 77.81640288745754, 41.470305955188046, 187.57393211709328, 125.97164053447425, 149.03199129396614, 25.847475283314235, 137.62136558030923, 189.47731984554895, 84.02843556886124, 259.50041010506607, 197.7163080496867, 46.4757821068619, 174.14811847835324, 5.101512396512092, 361.62698359247315, 297.652966162459, 168.49920531192979, 74.51410461876672, 103.28319918370536, 52.80658460295237, 77.5117440198439, 88.68669324151104, 219.3964499338513, 26.59415963508053, 107.3099262936579, 41.75796089873731, 55.43687599731739, 29.15302520854516, 377.38450190187194, 76.43479905612502, 0.0, 0.0, 49.97565531343221, 71.47470502220428, 23.067420114937512, 241.31817896804208, 300.3745713245613, 99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885, 5.068130697413661, 66.32367745598823, 155.06723795062626, 332.67406642979256, 125.19434524058353, 12.85875793037491, 440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.342155639869492, "mean_inference_ms": 4.9352758324176955, "mean_action_processing_ms": 1.5823092474651899, "mean_env_wait_ms": 10.311292717039004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013942122459411621, "StateBufferConnector_ms": 0.02437126636505127, "ViewRequirementAgentConnector_ms": 0.20619571208953857}, "num_episodes": 0, "episode_return_max": 741.4617396744449, "episode_return_min": 73.00000000000013, "episode_return_mean": 484.27365831652116, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.95518121277279, "num_env_steps_trained_throughput_per_sec": 77.95518121277279, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 51081.766, "restore_workers_time_ms": 0.013, "training_step_time_ms": 51081.667, "sample_time_ms": 2287.969, "learn_time_ms": 48771.435, "learn_throughput": 82.015, "synch_weights_time_ms": 17.097}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "35fb9_00000", "date": "2024-08-22_08-08-26", "timestamp": 1724294306, "time_this_iter_s": 51.34210991859436, "time_total_s": 885.4605896472931, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b611dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 885.4605896472931, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 34.26575342465753, "ram_util_percent": 82.87945205479453}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.497536611241639, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.672576511726177, "policy_loss": -0.021299528567460438, "vf_loss": 8.69080612772987, "vf_explained_var": 0.2776688630618746, "kl": 0.015349573714205277, "entropy": 1.2272161432674953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.025047254247009, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.734723839179549, "policy_loss": -0.018399853826495546, "vf_loss": 7.749988701230004, "vf_explained_var": 0.2314459229587878, "kl": 0.015674853125321013, "entropy": 0.947486646780892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 741.4617396744449, "episode_reward_min": 73.00000000000013, "episode_reward_mean": 484.27365831652116, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -415.3215952131382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 503.0660296194917}, "policy_reward_mean": {"prey_policy": 108.31004361374899, "predator_policy": 133.82678554451152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [541.7000000000003, 336.6743250073913, 297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414, 403.3849463158407, 649.6605688381995, 653.1024591207666, 694.8000000000004, 429.10000000000275, 597.3999999999999, 275.3391971598266, 576.9999999999993, 568.3999999999997, 342.8999999999992, 420.8757493426506, 714.5851795664869, 464.44634842312206, 733.8, 501.3716860485341, 549.0306180095603, 610.6819660112498, 536.2549217211708, 446.8552871262054, 431.87792126376877, 484.60043352840205, 435.9000000000031, 553.8360679774994, 428.3413100531911, 531.9732765349136, 426.13352108307106, 346.07814926270396, 641.1646079867144, 506.3201659874442, 510.76052593359384, 646.1432436842961, 268.6410373615533, 741.102717979803, 630.0, 412.30560952569556, 357.79302420828077, 662.8361175200994, 590.4099782095747, 544.2717094940876, 435.89999999999975, 83.94768094784058, 524.7822565359439, 692.5876713847405, 681.1, 603.4429841850268, 543.3000000000002, 741.4617396744449, 694.3497957573409, 442.94290853786856, 694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595, 711.9, 397.172196056187, 597.0999999999999, 510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [109.2929833465374, 127.3085123309776, 26.980417690598312, 64.03630739171189, 20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237, 119.88533338341648, 140.05495294343908, 244.11686489949642, 96.55160593135005, 247.78853215569092, 256.5484538089569, 324.18096798843004, 294.84285076296163, 387.8729836863868, 7.334222721197738, 269.0367365764463, 238.5168143057404, 61.04616103114271, -268.0750361284804, 117.09616088724516, 366.5235133102798, 294.02385247423115, 58.85929446013026, 86.49772600274537, 122.76100070370862, 96.76872272963907, -229.2766389711925, 307.7327311327707, 282.2092489207907, 164.66111548376628, -283.76137506262864, 369.4832707625171, 303.1420883169684, 246.28591979443, 35.419915413962606, 3.7535705146210754, 146.74859982612523, 160.28271015255385, 273.2101198445977, 323.9342462727044, -205.25937194067146, 117.2368980592433, 114.761089745013, 175.87683532883457, -138.74093697785116, 39.56654433447625, 13.047090381143091, -148.59354115241902, 373.8801854451344, 152.88171334989585, 274.6535923998707, 229.52888511336883, -361.96770085311556, 152.11611590030017, -73.44599370856405, -8.464589213689457, 261.2972255229023, -23.951766465242763, 185.1910549455033, 130.72026324642349, 277.97975106918705, -256.41495353422465, 167.09052955918455, 77.83376869717989, 235.81544338373556, 286.6888039224706, 251.98832876275287, 177.92509998144658, -138.32830069217556, 340.2961502094022, 125.8029359419605, 259.5445824416841, 206.98657669469253, -57.72693517193404, 196.52678928321936, -186.90061952646928, 87.47692557999727, 243.58227907341717, 198.62993786146745, 133.01481242847245, 90.66666979211698, 299.9064715179807, -221.78693349828185, 197.37297656285864, 60.72971963466922, -5.24327918935133, -41.127368485604286, 197.73108275561054, 18.96803060497109, 258.841759029779, 299.8418264262235, 290.30513576712826, 293.6000273368171, 334.1899589764816, -137.2845019018719, 66.8652009438753, 400.0, 379.34071960847933, 312.1453647525333, 244.79810484704893, 355.00956577315014, -344.8786092499659, 246.1287674952319, 264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864, 345.93186930258634, 294.5763225440117, -110.34582862626014, 19.77672030202562, 236.32247218049395, 222.72442464854745, 45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926], "policy_predator_policy_reward": [167.8070166534625, 137.29148766902202, 208.12998009308876, 37.527619831993505, 74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259, 66.75128377397041, 76.6933762150143, 177.49315577088947, 131.49894223646353, 61.671684985541475, 87.09378817057755, 14.404937405661258, 61.37124384294695, 2.8270163136132163, 31.065777278802425, 55.223913216656676, 34.62253590115667, 59.63811887197713, 422.72995338518433, 75.741118324378, 17.639207478097056, 163.87324048890864, 51.64361257672965, 20.146453488288486, 113.49481980525782, 384.11179659606, 169.27186898814404, 76.41488572472666, 48.22831378819889, 142.5431684321773, 441.0034395698073, 49.402652585911596, 11.771988334602874, 136.81991578682383, 82.8459350533183, 53.17193098398548, 345.3565166848286, 86.09925585869603, 91.08988015540227, 46.02067544846684, 371.5593719406716, 60.4852012012978, 154.3720981206513, 172.1420475367418, 222.59997537604394, 287.0826656637411, 144.9041331490411, 200.84611813607873, 9.767237571204385, 51.34102924544513, 74.95973298228813, 276.72566912726916, 284.0544566656702, 403.7404440828033, 49.56271026037344, 79.21440321489142, 94.08648155896428, 72.67376710966874, 112.16509367277457, 128.30079262620444, 104.16380104489949, 92.57856034299311, 503.0660296194917, 24.940181098545256, 172.17113275413328, 29.6497081116151, 77.81640288745754, 41.470305955188046, 187.57393211709328, 125.97164053447425, 149.03199129396614, 25.847475283314235, 137.62136558030923, 189.47731984554895, 84.02843556886124, 259.50041010506607, 197.7163080496867, 46.4757821068619, 174.14811847835324, 5.101512396512092, 361.62698359247315, 297.652966162459, 168.49920531192979, 74.51410461876672, 103.28319918370536, 52.80658460295237, 77.5117440198439, 88.68669324151104, 219.3964499338513, 26.59415963508053, 107.3099262936579, 41.75796089873731, 55.43687599731739, 29.15302520854516, 377.38450190187194, 76.43479905612502, 0.0, 0.0, 49.97565531343221, 71.47470502220428, 23.067420114937512, 241.31817896804208, 300.3745713245613, 99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885, 5.068130697413661, 66.32367745598823, 155.06723795062626, 332.67406642979256, 125.19434524058353, 12.85875793037491, 440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.342155639869492, "mean_inference_ms": 4.9352758324176955, "mean_action_processing_ms": 1.5823092474651899, "mean_env_wait_ms": 10.311292717039004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013942122459411621, "StateBufferConnector_ms": 0.02437126636505127, "ViewRequirementAgentConnector_ms": 0.20619571208953857}, "num_episodes": 0, "episode_return_max": 741.4617396744449, "episode_return_min": 73.00000000000013, "episode_return_mean": 484.27365831652116, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.68989834347062, "num_env_steps_trained_throughput_per_sec": 76.68989834347062, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 51208.023, "restore_workers_time_ms": 0.013, "training_step_time_ms": 51207.925, "sample_time_ms": 2229.481, "learn_time_ms": 48956.467, "learn_throughput": 81.705, "synch_weights_time_ms": 17.005}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "35fb9_00000", "date": "2024-08-22_08-09-18", "timestamp": 1724294358, "time_this_iter_s": 52.19221615791321, "time_total_s": 937.6528058052063, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fca9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 937.6528058052063, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 35.03513513513514, "ram_util_percent": 82.05810810810812}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.007424806602417, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.775580671098497, "policy_loss": -0.0206981565165161, "vf_loss": 8.793417109131182, "vf_explained_var": 0.27037593088452777, "kl": 0.01430857466883642, "entropy": 1.2231861595123534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.775598001290882, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.688922990314544, "policy_loss": -0.017601781708395315, "vf_loss": 7.7040370923501476, "vf_explained_var": 0.2313896399011057, "kl": 0.012438505223740346, "entropy": 0.9258734198789748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999992}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 741.4617396744449, "episode_reward_min": 73.00000000000013, "episode_reward_mean": 479.5447406610042, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -751.7551921563154, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 818.3626325700884}, "policy_reward_mean": {"prey_policy": 97.44788576417218, "predator_policy": 142.32448456632977}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.5999999999989, 408.70000000000203, 364.6000000000007, 394.9717127307322, 386.6000000000016, 518.3946416191088, 187.0999999999998, 238.99999999999892, 700.6000000000014, 378.246750438253, 278.62286173139785, 471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414, 403.3849463158407, 649.6605688381995, 653.1024591207666, 694.8000000000004, 429.10000000000275, 597.3999999999999, 275.3391971598266, 576.9999999999993, 568.3999999999997, 342.8999999999992, 420.8757493426506, 714.5851795664869, 464.44634842312206, 733.8, 501.3716860485341, 549.0306180095603, 610.6819660112498, 536.2549217211708, 446.8552871262054, 431.87792126376877, 484.60043352840205, 435.9000000000031, 553.8360679774994, 428.3413100531911, 531.9732765349136, 426.13352108307106, 346.07814926270396, 641.1646079867144, 506.3201659874442, 510.76052593359384, 646.1432436842961, 268.6410373615533, 741.102717979803, 630.0, 412.30560952569556, 357.79302420828077, 662.8361175200994, 590.4099782095747, 544.2717094940876, 435.89999999999975, 83.94768094784058, 524.7822565359439, 692.5876713847405, 681.1, 603.4429841850268, 543.3000000000002, 741.4617396744449, 694.3497957573409, 442.94290853786856, 694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595, 711.9, 397.172196056187, 597.0999999999999, 510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121, 196.89999999999813, 208.58255945567947], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [20.17204637046203, 140.41165917177491, 341.3853141872971, 44.805464699930866, 287.72514343743995, -154.28572387330064, 125.10170510085071, 135.40082188497172, 306.6251564821421, -92.56483069738691, 23.91417828138293, -101.14173283316654, -125.70399206764552, -170.30964262717214, -45.2697827415393, -82.42969462355599, 314.86657532400875, 321.7268403196356, 167.7796894636898, -136.0872271194591, -103.72505482552, 18.79985326266719, -13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237, 119.88533338341648, 140.05495294343908, 244.11686489949642, 96.55160593135005, 247.78853215569092, 256.5484538089569, 324.18096798843004, 294.84285076296163, 387.8729836863868, 7.334222721197738, 269.0367365764463, 238.5168143057404, 61.04616103114271, -268.0750361284804, 117.09616088724516, 366.5235133102798, 294.02385247423115, 58.85929446013026, 86.49772600274537, 122.76100070370862, 96.76872272963907, -229.2766389711925, 307.7327311327707, 282.2092489207907, 164.66111548376628, -283.76137506262864, 369.4832707625171, 303.1420883169684, 246.28591979443, 35.419915413962606, 3.7535705146210754, 146.74859982612523, 160.28271015255385, 273.2101198445977, 323.9342462727044, -205.25937194067146, 117.2368980592433, 114.761089745013, 175.87683532883457, -138.74093697785116, 39.56654433447625, 13.047090381143091, -148.59354115241902, 373.8801854451344, 152.88171334989585, 274.6535923998707, 229.52888511336883, -361.96770085311556, 152.11611590030017, -73.44599370856405, -8.464589213689457, 261.2972255229023, -23.951766465242763, 185.1910549455033, 130.72026324642349, 277.97975106918705, -256.41495353422465, 167.09052955918455, 77.83376869717989, 235.81544338373556, 286.6888039224706, 251.98832876275287, 177.92509998144658, -138.32830069217556, 340.2961502094022, 125.8029359419605, 259.5445824416841, 206.98657669469253, -57.72693517193404, 196.52678928321936, -186.90061952646928, 87.47692557999727, 243.58227907341717, 198.62993786146745, 133.01481242847245, 90.66666979211698, 299.9064715179807, -221.78693349828185, 197.37297656285864, 60.72971963466922, -5.24327918935133, -41.127368485604286, 197.73108275561054, 18.96803060497109, 258.841759029779, 299.8418264262235, 290.30513576712826, 293.6000273368171, 334.1899589764816, -137.2845019018719, 66.8652009438753, 400.0, 379.34071960847933, 312.1453647525333, 244.79810484704893, 355.00956577315014, -344.8786092499659, 246.1287674952319, 264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864, 345.93186930258634, 294.5763225440117, -110.34582862626014, 19.77672030202562, 236.32247218049395, 222.72442464854745, 45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926, -457.77463328561805, 33.74792389404083, -751.7551921563154, -669.0314476076404], "policy_predator_policy_reward": [74.62795362953796, 62.38834082822533, 20.31468581270268, 2.194535300069431, 38.574856562559916, 192.58572387329923, 32.04224865303223, 102.42693709187738, 49.37484351785795, 123.16483069738631, 258.7944341863267, 336.82776198456725, 165.9039920676438, 317.2096426271745, 87.43044191362715, 279.26903545146854, 43.03342467599121, 20.97315968036417, 190.66780532936698, 155.88648276465162, 361.66140278945727, 1.8866605047949712, 182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259, 66.75128377397041, 76.6933762150143, 177.49315577088947, 131.49894223646353, 61.671684985541475, 87.09378817057755, 14.404937405661258, 61.37124384294695, 2.8270163136132163, 31.065777278802425, 55.223913216656676, 34.62253590115667, 59.63811887197713, 422.72995338518433, 75.741118324378, 17.639207478097056, 163.87324048890864, 51.64361257672965, 20.146453488288486, 113.49481980525782, 384.11179659606, 169.27186898814404, 76.41488572472666, 48.22831378819889, 142.5431684321773, 441.0034395698073, 49.402652585911596, 11.771988334602874, 136.81991578682383, 82.8459350533183, 53.17193098398548, 345.3565166848286, 86.09925585869603, 91.08988015540227, 46.02067544846684, 371.5593719406716, 60.4852012012978, 154.3720981206513, 172.1420475367418, 222.59997537604394, 287.0826656637411, 144.9041331490411, 200.84611813607873, 9.767237571204385, 51.34102924544513, 74.95973298228813, 276.72566912726916, 284.0544566656702, 403.7404440828033, 49.56271026037344, 79.21440321489142, 94.08648155896428, 72.67376710966874, 112.16509367277457, 128.30079262620444, 104.16380104489949, 92.57856034299311, 503.0660296194917, 24.940181098545256, 172.17113275413328, 29.6497081116151, 77.81640288745754, 41.470305955188046, 187.57393211709328, 125.97164053447425, 149.03199129396614, 25.847475283314235, 137.62136558030923, 189.47731984554895, 84.02843556886124, 259.50041010506607, 197.7163080496867, 46.4757821068619, 174.14811847835324, 5.101512396512092, 361.62698359247315, 297.652966162459, 168.49920531192979, 74.51410461876672, 103.28319918370536, 52.80658460295237, 77.5117440198439, 88.68669324151104, 219.3964499338513, 26.59415963508053, 107.3099262936579, 41.75796089873731, 55.43687599731739, 29.15302520854516, 377.38450190187194, 76.43479905612502, 0.0, 0.0, 49.97565531343221, 71.47470502220428, 23.067420114937512, 241.31817896804208, 300.3745713245613, 99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885, 5.068130697413661, 66.32367745598823, 155.06723795062626, 332.67406642979256, 125.19434524058353, 12.85875793037491, 440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419, 8.273635503573587, 612.6530738880039, 818.3626325700884, 811.006566649546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.290115271850645, "mean_inference_ms": 4.928060702692251, "mean_action_processing_ms": 1.580057081387234, "mean_env_wait_ms": 10.291752429951623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013639688491821289, "StateBufferConnector_ms": 0.024358630180358887, "ViewRequirementAgentConnector_ms": 0.2060168981552124}, "num_episodes": 2, "episode_return_max": 741.4617396744449, "episode_return_min": 73.00000000000013, "episode_return_mean": 479.5447406610042, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.16656993540343, "num_env_steps_trained_throughput_per_sec": 78.16656993540343, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 51264.747, "restore_workers_time_ms": 0.013, "training_step_time_ms": 51264.649, "sample_time_ms": 2222.425, "learn_time_ms": 49019.258, "learn_throughput": 81.601, "synch_weights_time_ms": 17.273}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "35fb9_00000", "date": "2024-08-22_08-10-09", "timestamp": 1724294409, "time_this_iter_s": 51.2285521030426, "time_total_s": 988.8813579082489, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fca83a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 988.8813579082489, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 33.800000000000004, "ram_util_percent": 82.4931506849315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.537527391961012, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.276562529518491, "policy_loss": -0.02181389996234978, "vf_loss": 8.295233426775251, "vf_explained_var": 0.3643807726877707, "kl": 0.015714974407471282, "entropy": 1.201970487233823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 997.4199999999983}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.2947021853356135, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.86184685671771, "policy_loss": -0.02123201826178326, "vf_loss": 7.880329301369884, "vf_explained_var": 0.2322445419730333, "kl": 0.013747864872680376, "entropy": 0.9158582291590474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 997.4199999999983}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 741.4617396744449, "episode_reward_min": 59.855766229254925, "episode_reward_mean": 468.16270381884874, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1165.554070568206, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1168.2748079619773}, "policy_reward_mean": {"prey_policy": 29.6048997364106, "predator_policy": 204.47645217301368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [471.1588567136972, 415.4000000000021, 465.46277840350575, 387.20000000000186, 223.7999999999968, 319.7999999999993, 378.42224001641597, 350.2000000000013, 73.00000000000013, 180.39999999999876, 603.8999999999996, 471.70122575974256, 413.4038537663498, 146.23610435841786, 270.8672486624414, 403.3849463158407, 649.6605688381995, 653.1024591207666, 694.8000000000004, 429.10000000000275, 597.3999999999999, 275.3391971598266, 576.9999999999993, 568.3999999999997, 342.8999999999992, 420.8757493426506, 714.5851795664869, 464.44634842312206, 733.8, 501.3716860485341, 549.0306180095603, 610.6819660112498, 536.2549217211708, 446.8552871262054, 431.87792126376877, 484.60043352840205, 435.9000000000031, 553.8360679774994, 428.3413100531911, 531.9732765349136, 426.13352108307106, 346.07814926270396, 641.1646079867144, 506.3201659874442, 510.76052593359384, 646.1432436842961, 268.6410373615533, 741.102717979803, 630.0, 412.30560952569556, 357.79302420828077, 662.8361175200994, 590.4099782095747, 544.2717094940876, 435.89999999999975, 83.94768094784058, 524.7822565359439, 692.5876713847405, 681.1, 603.4429841850268, 543.3000000000002, 741.4617396744449, 694.3497957573409, 442.94290853786856, 694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595, 711.9, 397.172196056187, 597.0999999999999, 510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121, 196.89999999999813, 208.58255945567947, 292.8458169184529, 76.27455375695264, 131.96844193270658, 494.0140965507436, 59.855766229254925, 105.95793749906986, 326.9942188456947, 444.8549006728437, 538.8474741436634, 287.774171657955, 256.8449040966143], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-13.032307760376028, 140.1871767316961, 79.68801598697868, 290.4800220772588, -88.67495366003328, 84.4040511455035, -61.659766679695366, 312.1883557298047, 114.4841397639444, 84.33304249310359, 174.22108887601138, 67.28032493172789, -83.59801747620406, 26.386125993302723, 234.22918893528998, 1.2778307674706417, -128.3183172665503, 29.676938724621134, 140.6820730953515, -121.34432707117, 174.07836326779275, 259.10177459428127, 29.41631114841162, -27.433097359680687, 64.76433482590133, -7.3352915919409725, 8.402429146508736, -187.0290248270278, -15.58686511182434, 139.49417480222237, 119.88533338341648, 140.05495294343908, 244.11686489949642, 96.55160593135005, 247.78853215569092, 256.5484538089569, 324.18096798843004, 294.84285076296163, 387.8729836863868, 7.334222721197738, 269.0367365764463, 238.5168143057404, 61.04616103114271, -268.0750361284804, 117.09616088724516, 366.5235133102798, 294.02385247423115, 58.85929446013026, 86.49772600274537, 122.76100070370862, 96.76872272963907, -229.2766389711925, 307.7327311327707, 282.2092489207907, 164.66111548376628, -283.76137506262864, 369.4832707625171, 303.1420883169684, 246.28591979443, 35.419915413962606, 3.7535705146210754, 146.74859982612523, 160.28271015255385, 273.2101198445977, 323.9342462727044, -205.25937194067146, 117.2368980592433, 114.761089745013, 175.87683532883457, -138.74093697785116, 39.56654433447625, 13.047090381143091, -148.59354115241902, 373.8801854451344, 152.88171334989585, 274.6535923998707, 229.52888511336883, -361.96770085311556, 152.11611590030017, -73.44599370856405, -8.464589213689457, 261.2972255229023, -23.951766465242763, 185.1910549455033, 130.72026324642349, 277.97975106918705, -256.41495353422465, 167.09052955918455, 77.83376869717989, 235.81544338373556, 286.6888039224706, 251.98832876275287, 177.92509998144658, -138.32830069217556, 340.2961502094022, 125.8029359419605, 259.5445824416841, 206.98657669469253, -57.72693517193404, 196.52678928321936, -186.90061952646928, 87.47692557999727, 243.58227907341717, 198.62993786146745, 133.01481242847245, 90.66666979211698, 299.9064715179807, -221.78693349828185, 197.37297656285864, 60.72971963466922, -5.24327918935133, -41.127368485604286, 197.73108275561054, 18.96803060497109, 258.841759029779, 299.8418264262235, 290.30513576712826, 293.6000273368171, 334.1899589764816, -137.2845019018719, 66.8652009438753, 400.0, 379.34071960847933, 312.1453647525333, 244.79810484704893, 355.00956577315014, -344.8786092499659, 246.1287674952319, 264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864, 345.93186930258634, 294.5763225440117, -110.34582862626014, 19.77672030202562, 236.32247218049395, 222.72442464854745, 45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926, -457.77463328561805, 33.74792389404083, -751.7551921563154, -669.0314476076404, -748.9835482909266, -336.6833312305238, -753.7596004071332, -1068.9050804787585, -1017.3506038461142, -605.2326389309587, -250.62302083830423, -551.6687414077346, -1165.554070568206, -678.5237651410367, -934.7445039914603, -585.6766124860462, -286.95618171676097, -405.0917017950269, -880.897459562582, 64.31002004899398, -245.26715703206543, 86.64818881101354, -569.7202834523031, -50.78422113363174, -912.1562939236668, -433.7798316015763], "policy_predator_policy_reward": [182.8137973730589, 161.19019036931772, 11.311984013020039, 33.91997792274118, 459.96916506252677, 9.764515855508074, 95.45976667969376, 41.21164427019529, 11.715860236055127, 13.26695750689542, 45.478911123988595, 32.81967506827056, 200.36191634754718, 235.27221515176947, 78.47081106471009, 36.222169232529296, 162.0183172665484, 9.623061275379115, 30.965029786413254, 130.09722418940393, 77.24241417758354, 93.4774479603426, 292.6082703094803, 177.1097416615315, 188.92765983765068, 167.0471506947389, 0.8702488633802603, 323.99245117555927, 78.47495322746185, 68.48498574458259, 66.75128377397041, 76.6933762150143, 177.49315577088947, 131.49894223646353, 61.671684985541475, 87.09378817057755, 14.404937405661258, 61.37124384294695, 2.8270163136132163, 31.065777278802425, 55.223913216656676, 34.62253590115667, 59.63811887197713, 422.72995338518433, 75.741118324378, 17.639207478097056, 163.87324048890864, 51.64361257672965, 20.146453488288486, 113.49481980525782, 384.11179659606, 169.27186898814404, 76.41488572472666, 48.22831378819889, 142.5431684321773, 441.0034395698073, 49.402652585911596, 11.771988334602874, 136.81991578682383, 82.8459350533183, 53.17193098398548, 345.3565166848286, 86.09925585869603, 91.08988015540227, 46.02067544846684, 371.5593719406716, 60.4852012012978, 154.3720981206513, 172.1420475367418, 222.59997537604394, 287.0826656637411, 144.9041331490411, 200.84611813607873, 9.767237571204385, 51.34102924544513, 74.95973298228813, 276.72566912726916, 284.0544566656702, 403.7404440828033, 49.56271026037344, 79.21440321489142, 94.08648155896428, 72.67376710966874, 112.16509367277457, 128.30079262620444, 104.16380104489949, 92.57856034299311, 503.0660296194917, 24.940181098545256, 172.17113275413328, 29.6497081116151, 77.81640288745754, 41.470305955188046, 187.57393211709328, 125.97164053447425, 149.03199129396614, 25.847475283314235, 137.62136558030923, 189.47731984554895, 84.02843556886124, 259.50041010506607, 197.7163080496867, 46.4757821068619, 174.14811847835324, 5.101512396512092, 361.62698359247315, 297.652966162459, 168.49920531192979, 74.51410461876672, 103.28319918370536, 52.80658460295237, 77.5117440198439, 88.68669324151104, 219.3964499338513, 26.59415963508053, 107.3099262936579, 41.75796089873731, 55.43687599731739, 29.15302520854516, 377.38450190187194, 76.43479905612502, 0.0, 0.0, 49.97565531343221, 71.47470502220428, 23.067420114937512, 241.31817896804208, 300.3745713245613, 99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885, 5.068130697413661, 66.32367745598823, 155.06723795062626, 332.67406642979256, 125.19434524058353, 12.85875793037491, 440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419, 8.273635503573587, 612.6530738880039, 818.3626325700884, 811.006566649546, 558.3995579188444, 820.1131385210581, 1013.1716327397862, 885.7676019030587, 1046.1894314734561, 708.3622532363252, 642.9423781409789, 653.3634806558057, 1168.2748079619773, 735.6587939765202, 660.1910607700376, 966.1879932065385, 491.3594892053583, 527.6826131521244, 291.0489671085476, 970.3933730778843, 240.46566474278222, 457.00077762193274, 407.95433966365374, 500.32433658023575, 804.5078146437746, 798.2732149780834]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.146144005330499, "mean_inference_ms": 4.848645108238825, "mean_action_processing_ms": 1.5172498585129566, "mean_env_wait_ms": 10.249754836389679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013654947280883789, "StateBufferConnector_ms": 0.024321675300598145, "ViewRequirementAgentConnector_ms": 0.21221864223480225}, "num_episodes": 11, "episode_return_max": 741.4617396744449, "episode_return_min": 59.855766229254925, "episode_return_mean": 468.16270381884874, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.1234582741329, "num_env_steps_trained_throughput_per_sec": 77.1234582741329, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 51254.854, "restore_workers_time_ms": 0.013, "training_step_time_ms": 51254.741, "sample_time_ms": 2251.084, "learn_time_ms": 48979.816, "learn_throughput": 81.666, "synch_weights_time_ms": 17.564}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "35fb9_00000", "date": "2024-08-22_08-11-01", "timestamp": 1724294461, "time_this_iter_s": 51.90414500236511, "time_total_s": 1040.785502910614, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fca81f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1040.785502910614, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 35.269863013698625, "ram_util_percent": 82.43424657534246}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.8378242784707, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.439666554284473, "policy_loss": -0.020430278576905568, "vf_loss": 8.457053111343788, "vf_explained_var": 0.29576397888244144, "kl": 0.015218551167676215, "entropy": 1.1719557966504779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.795536086609754, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.861711804828946, "policy_loss": -0.01782865499801658, "vf_loss": 7.876945301590773, "vf_explained_var": 0.2507155408934941, "kl": 0.012975843927685034, "entropy": 0.8478598368230951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 741.4617396744449, "episode_reward_min": 13.239488809782397, "episode_reward_mean": 453.12369326104994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1275.0828792693085, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1275.0828792693085}, "policy_reward_mean": {"prey_policy": -76.1912972035198, "predator_policy": 302.7531438340448}, "custom_metrics": {}, "hist_stats": {"episode_reward": [653.1024591207666, 694.8000000000004, 429.10000000000275, 597.3999999999999, 275.3391971598266, 576.9999999999993, 568.3999999999997, 342.8999999999992, 420.8757493426506, 714.5851795664869, 464.44634842312206, 733.8, 501.3716860485341, 549.0306180095603, 610.6819660112498, 536.2549217211708, 446.8552871262054, 431.87792126376877, 484.60043352840205, 435.9000000000031, 553.8360679774994, 428.3413100531911, 531.9732765349136, 426.13352108307106, 346.07814926270396, 641.1646079867144, 506.3201659874442, 510.76052593359384, 646.1432436842961, 268.6410373615533, 741.102717979803, 630.0, 412.30560952569556, 357.79302420828077, 662.8361175200994, 590.4099782095747, 544.2717094940876, 435.89999999999975, 83.94768094784058, 524.7822565359439, 692.5876713847405, 681.1, 603.4429841850268, 543.3000000000002, 741.4617396744449, 694.3497957573409, 442.94290853786856, 694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595, 711.9, 397.172196056187, 597.0999999999999, 510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121, 196.89999999999813, 208.58255945567947, 292.8458169184529, 76.27455375695264, 131.96844193270658, 494.0140965507436, 59.855766229254925, 105.95793749906986, 326.9942188456947, 444.8549006728437, 538.8474741436634, 287.774171657955, 256.8449040966143, 337.9115295566252, 89.35381624562923, 327.19972939317904, 539.1619804464602, 143.5187370132804, 396.74114925431473, 60.24046543091819, 278.26982231911256, 413.9291942605116, 269.86435383351227, 489.7411115428039, 239.9031235179449, 13.239488809782397, 184.74154597486333, 360.11280643467313, 211.702713444255, 364.46519957686877], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [247.78853215569092, 256.5484538089569, 324.18096798843004, 294.84285076296163, 387.8729836863868, 7.334222721197738, 269.0367365764463, 238.5168143057404, 61.04616103114271, -268.0750361284804, 117.09616088724516, 366.5235133102798, 294.02385247423115, 58.85929446013026, 86.49772600274537, 122.76100070370862, 96.76872272963907, -229.2766389711925, 307.7327311327707, 282.2092489207907, 164.66111548376628, -283.76137506262864, 369.4832707625171, 303.1420883169684, 246.28591979443, 35.419915413962606, 3.7535705146210754, 146.74859982612523, 160.28271015255385, 273.2101198445977, 323.9342462727044, -205.25937194067146, 117.2368980592433, 114.761089745013, 175.87683532883457, -138.74093697785116, 39.56654433447625, 13.047090381143091, -148.59354115241902, 373.8801854451344, 152.88171334989585, 274.6535923998707, 229.52888511336883, -361.96770085311556, 152.11611590030017, -73.44599370856405, -8.464589213689457, 261.2972255229023, -23.951766465242763, 185.1910549455033, 130.72026324642349, 277.97975106918705, -256.41495353422465, 167.09052955918455, 77.83376869717989, 235.81544338373556, 286.6888039224706, 251.98832876275287, 177.92509998144658, -138.32830069217556, 340.2961502094022, 125.8029359419605, 259.5445824416841, 206.98657669469253, -57.72693517193404, 196.52678928321936, -186.90061952646928, 87.47692557999727, 243.58227907341717, 198.62993786146745, 133.01481242847245, 90.66666979211698, 299.9064715179807, -221.78693349828185, 197.37297656285864, 60.72971963466922, -5.24327918935133, -41.127368485604286, 197.73108275561054, 18.96803060497109, 258.841759029779, 299.8418264262235, 290.30513576712826, 293.6000273368171, 334.1899589764816, -137.2845019018719, 66.8652009438753, 400.0, 379.34071960847933, 312.1453647525333, 244.79810484704893, 355.00956577315014, -344.8786092499659, 246.1287674952319, 264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864, 345.93186930258634, 294.5763225440117, -110.34582862626014, 19.77672030202562, 236.32247218049395, 222.72442464854745, 45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926, -457.77463328561805, 33.74792389404083, -751.7551921563154, -669.0314476076404, -748.9835482909266, -336.6833312305238, -753.7596004071332, -1068.9050804787585, -1017.3506038461142, -605.2326389309587, -250.62302083830423, -551.6687414077346, -1165.554070568206, -678.5237651410367, -934.7445039914603, -585.6766124860462, -286.95618171676097, -405.0917017950269, -880.897459562582, 64.31002004899398, -245.26715703206543, 86.64818881101354, -569.7202834523031, -50.78422113363174, -912.1562939236668, -433.7798316015763, -365.4640095028954, -906.0132207428646, -95.29254202226849, -1275.0828792693085, -226.18371777603528, -459.5634166254683, 228.057549587932, -823.3005074752604, -407.3505307075218, -936.0561609704266, -562.3093996784143, -513.756669617369, -968.0509235307851, -56.89303868770372, -954.7376324340505, -651.2773661581565, -332.45332131365086, -94.17730442333361, -398.2498675961642, -990.7321206609673, -181.72484603869438, 58.8200203879087, -5.259245759952449, -702.7724079981833, -1053.9907769926035, -1168.57830171658, -880.4976634520642, -450.03277269184974, -544.4996739793537, -509.8472383114113, -743.2836216386565, -808.1899112269232, -1126.077129046147, 66.95381147352643], "policy_predator_policy_reward": [61.671684985541475, 87.09378817057755, 14.404937405661258, 61.37124384294695, 2.8270163136132163, 31.065777278802425, 55.223913216656676, 34.62253590115667, 59.63811887197713, 422.72995338518433, 75.741118324378, 17.639207478097056, 163.87324048890864, 51.64361257672965, 20.146453488288486, 113.49481980525782, 384.11179659606, 169.27186898814404, 76.41488572472666, 48.22831378819889, 142.5431684321773, 441.0034395698073, 49.402652585911596, 11.771988334602874, 136.81991578682383, 82.8459350533183, 53.17193098398548, 345.3565166848286, 86.09925585869603, 91.08988015540227, 46.02067544846684, 371.5593719406716, 60.4852012012978, 154.3720981206513, 172.1420475367418, 222.59997537604394, 287.0826656637411, 144.9041331490411, 200.84611813607873, 9.767237571204385, 51.34102924544513, 74.95973298228813, 276.72566912726916, 284.0544566656702, 403.7404440828033, 49.56271026037344, 79.21440321489142, 94.08648155896428, 72.67376710966874, 112.16509367277457, 128.30079262620444, 104.16380104489949, 92.57856034299311, 503.0660296194917, 24.940181098545256, 172.17113275413328, 29.6497081116151, 77.81640288745754, 41.470305955188046, 187.57393211709328, 125.97164053447425, 149.03199129396614, 25.847475283314235, 137.62136558030923, 189.47731984554895, 84.02843556886124, 259.50041010506607, 197.7163080496867, 46.4757821068619, 174.14811847835324, 5.101512396512092, 361.62698359247315, 297.652966162459, 168.49920531192979, 74.51410461876672, 103.28319918370536, 52.80658460295237, 77.5117440198439, 88.68669324151104, 219.3964499338513, 26.59415963508053, 107.3099262936579, 41.75796089873731, 55.43687599731739, 29.15302520854516, 377.38450190187194, 76.43479905612502, 0.0, 0.0, 49.97565531343221, 71.47470502220428, 23.067420114937512, 241.31817896804208, 300.3745713245613, 99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885, 5.068130697413661, 66.32367745598823, 155.06723795062626, 332.67406642979256, 125.19434524058353, 12.85875793037491, 440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419, 8.273635503573587, 612.6530738880039, 818.3626325700884, 811.006566649546, 558.3995579188444, 820.1131385210581, 1013.1716327397862, 885.7676019030587, 1046.1894314734561, 708.3622532363252, 642.9423781409789, 653.3634806558057, 1168.2748079619773, 735.6587939765202, 660.1910607700376, 966.1879932065385, 491.3594892053583, 527.6826131521244, 291.0489671085476, 970.3933730778843, 240.46566474278222, 457.00077762193274, 407.95433966365374, 500.32433658023575, 804.5078146437746, 798.2732149780834, 813.1881804503236, 796.2005793520617, 184.64635826789754, 1275.0828792693085, 988.8798329242184, 24.067030870465477, 214.48588544895944, 919.9190528848299, 585.4189228249439, 901.5065058662872, 467.0307762208858, 1005.7764423292128, 1047.5307419006583, 37.65368574874701, 1032.4116006222894, 851.873220289033, 204.5344953680054, 636.0253246294909, 903.0784785518124, 755.7678635388311, 310.35435267229235, 302.29158452129974, 14.576037030088798, 933.3587402459954, 1056.2302658023864, 1179.57830171658, 936.8799931810663, 578.3919889377112, 765.5905368112208, 648.869181914217, 896.7036792973088, 866.4725670125263, 346.92842914163396, 1076.6600880078545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.013309857628042, "mean_inference_ms": 4.639459788815479, "mean_action_processing_ms": 1.580642711344612, "mean_env_wait_ms": 10.141434932217154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013732433319091797, "StateBufferConnector_ms": 0.005991816520690918, "ViewRequirementAgentConnector_ms": 0.2160416841506958}, "num_episodes": 17, "episode_return_max": 741.4617396744449, "episode_return_min": 13.239488809782397, "episode_return_mean": 453.12369326104994, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.09937500822143, "num_env_steps_trained_throughput_per_sec": 71.09937500822143, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 51990.211, "restore_workers_time_ms": 0.013, "training_step_time_ms": 51990.103, "sample_time_ms": 2604.181, "learn_time_ms": 49361.823, "learn_throughput": 81.034, "synch_weights_time_ms": 18.334}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "35fb9_00000", "date": "2024-08-22_08-11-57", "timestamp": 1724294517, "time_this_iter_s": 56.295799016952515, "time_total_s": 1097.0813019275665, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fca9c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1097.0813019275665, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 38.48, "ram_util_percent": 82.11875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.188594528039296, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.717244706078182, "policy_loss": -0.021620864839978004, "vf_loss": 8.736038424476744, "vf_explained_var": 0.2497498365621718, "kl": 0.01413569468339639, "entropy": 1.1136013568393768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.56814645191349, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.371241898511453, "policy_loss": -0.019965118689649793, "vf_loss": 8.388339852025268, "vf_explained_var": 0.22639898597878755, "kl": 0.014335735159847275, "entropy": 0.7888016392314244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 741.4617396744449, "episode_reward_min": 13.239488809782397, "episode_reward_mean": 404.5640743868655, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1275.0828792693085, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1275.0828792693085}, "policy_reward_mean": {"prey_policy": -218.03846683121148, "predator_policy": 420.32050402464426}, "custom_metrics": {}, "hist_stats": {"episode_reward": [431.87792126376877, 484.60043352840205, 435.9000000000031, 553.8360679774994, 428.3413100531911, 531.9732765349136, 426.13352108307106, 346.07814926270396, 641.1646079867144, 506.3201659874442, 510.76052593359384, 646.1432436842961, 268.6410373615533, 741.102717979803, 630.0, 412.30560952569556, 357.79302420828077, 662.8361175200994, 590.4099782095747, 544.2717094940876, 435.89999999999975, 83.94768094784058, 524.7822565359439, 692.5876713847405, 681.1, 603.4429841850268, 543.3000000000002, 741.4617396744449, 694.3497957573409, 442.94290853786856, 694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595, 711.9, 397.172196056187, 597.0999999999999, 510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121, 196.89999999999813, 208.58255945567947, 292.8458169184529, 76.27455375695264, 131.96844193270658, 494.0140965507436, 59.855766229254925, 105.95793749906986, 326.9942188456947, 444.8549006728437, 538.8474741436634, 287.774171657955, 256.8449040966143, 337.9115295566252, 89.35381624562923, 327.19972939317904, 539.1619804464602, 143.5187370132804, 396.74114925431473, 60.24046543091819, 278.26982231911256, 413.9291942605116, 269.86435383351227, 489.7411115428039, 239.9031235179449, 13.239488809782397, 184.74154597486333, 360.11280643467313, 211.702713444255, 364.46519957686877, 231.04778259174623, 607.9707972062336, 238.4948852076862, 272.0417548303233, 15.408539540546098, 329.22558735284616, 83.936454206121, 107.7053405122855, 340.69062385583186, 350.08117817081774, 302.3959402398085, 95.6248167356442, 103.44099677459667, 168.28164429103344, 166.89413160198345, 315.95686767653586, 530.7841843170864], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [175.87683532883457, -138.74093697785116, 39.56654433447625, 13.047090381143091, -148.59354115241902, 373.8801854451344, 152.88171334989585, 274.6535923998707, 229.52888511336883, -361.96770085311556, 152.11611590030017, -73.44599370856405, -8.464589213689457, 261.2972255229023, -23.951766465242763, 185.1910549455033, 130.72026324642349, 277.97975106918705, -256.41495353422465, 167.09052955918455, 77.83376869717989, 235.81544338373556, 286.6888039224706, 251.98832876275287, 177.92509998144658, -138.32830069217556, 340.2961502094022, 125.8029359419605, 259.5445824416841, 206.98657669469253, -57.72693517193404, 196.52678928321936, -186.90061952646928, 87.47692557999727, 243.58227907341717, 198.62993786146745, 133.01481242847245, 90.66666979211698, 299.9064715179807, -221.78693349828185, 197.37297656285864, 60.72971963466922, -5.24327918935133, -41.127368485604286, 197.73108275561054, 18.96803060497109, 258.841759029779, 299.8418264262235, 290.30513576712826, 293.6000273368171, 334.1899589764816, -137.2845019018719, 66.8652009438753, 400.0, 379.34071960847933, 312.1453647525333, 244.79810484704893, 355.00956577315014, -344.8786092499659, 246.1287674952319, 264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864, 345.93186930258634, 294.5763225440117, -110.34582862626014, 19.77672030202562, 236.32247218049395, 222.72442464854745, 45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926, -457.77463328561805, 33.74792389404083, -751.7551921563154, -669.0314476076404, -748.9835482909266, -336.6833312305238, -753.7596004071332, -1068.9050804787585, -1017.3506038461142, -605.2326389309587, -250.62302083830423, -551.6687414077346, -1165.554070568206, -678.5237651410367, -934.7445039914603, -585.6766124860462, -286.95618171676097, -405.0917017950269, -880.897459562582, 64.31002004899398, -245.26715703206543, 86.64818881101354, -569.7202834523031, -50.78422113363174, -912.1562939236668, -433.7798316015763, -365.4640095028954, -906.0132207428646, -95.29254202226849, -1275.0828792693085, -226.18371777603528, -459.5634166254683, 228.057549587932, -823.3005074752604, -407.3505307075218, -936.0561609704266, -562.3093996784143, -513.756669617369, -968.0509235307851, -56.89303868770372, -954.7376324340505, -651.2773661581565, -332.45332131365086, -94.17730442333361, -398.2498675961642, -990.7321206609673, -181.72484603869438, 58.8200203879087, -5.259245759952449, -702.7724079981833, -1053.9907769926035, -1168.57830171658, -880.4976634520642, -450.03277269184974, -544.4996739793537, -509.8472383114113, -743.2836216386565, -808.1899112269232, -1126.077129046147, 66.95381147352643, -667.1540828800106, -1090.70135773455, -368.0983375207618, -593.5813521987848, 72.81395209161029, -992.459920427761, -816.1640998461643, -602.508854963149, -1026.2499129521736, -1094.5566796576186, -603.4166913328571, -439.045442974626, -965.5435275241133, -772.6889049781014, -947.4964049172441, -775.2777269743243, -426.00821170024165, -916.0860758654425, -319.91032361124064, -293.4537514848712, -1126.0202263062731, -605.8350002807175, -512.7066963354526, -877.552811048387, -1045.8824367791997, -836.4840294074826, -945.8657666238561, -756.1698461366406, -748.3343952029009, -1011.1557477373069, -1247.0618973033663, 89.4592857822081, -51.202029897388485, 35.15247493287871], "policy_predator_policy_reward": [172.1420475367418, 222.59997537604394, 287.0826656637411, 144.9041331490411, 200.84611813607873, 9.767237571204385, 51.34102924544513, 74.95973298228813, 276.72566912726916, 284.0544566656702, 403.7404440828033, 49.56271026037344, 79.21440321489142, 94.08648155896428, 72.67376710966874, 112.16509367277457, 128.30079262620444, 104.16380104489949, 92.57856034299311, 503.0660296194917, 24.940181098545256, 172.17113275413328, 29.6497081116151, 77.81640288745754, 41.470305955188046, 187.57393211709328, 125.97164053447425, 149.03199129396614, 25.847475283314235, 137.62136558030923, 189.47731984554895, 84.02843556886124, 259.50041010506607, 197.7163080496867, 46.4757821068619, 174.14811847835324, 5.101512396512092, 361.62698359247315, 297.652966162459, 168.49920531192979, 74.51410461876672, 103.28319918370536, 52.80658460295237, 77.5117440198439, 88.68669324151104, 219.3964499338513, 26.59415963508053, 107.3099262936579, 41.75796089873731, 55.43687599731739, 29.15302520854516, 377.38450190187194, 76.43479905612502, 0.0, 0.0, 49.97565531343221, 71.47470502220428, 23.067420114937512, 241.31817896804208, 300.3745713245613, 99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885, 5.068130697413661, 66.32367745598823, 155.06723795062626, 332.67406642979256, 125.19434524058353, 12.85875793037491, 440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419, 8.273635503573587, 612.6530738880039, 818.3626325700884, 811.006566649546, 558.3995579188444, 820.1131385210581, 1013.1716327397862, 885.7676019030587, 1046.1894314734561, 708.3622532363252, 642.9423781409789, 653.3634806558057, 1168.2748079619773, 735.6587939765202, 660.1910607700376, 966.1879932065385, 491.3594892053583, 527.6826131521244, 291.0489671085476, 970.3933730778843, 240.46566474278222, 457.00077762193274, 407.95433966365374, 500.32433658023575, 804.5078146437746, 798.2732149780834, 813.1881804503236, 796.2005793520617, 184.64635826789754, 1275.0828792693085, 988.8798329242184, 24.067030870465477, 214.48588544895944, 919.9190528848299, 585.4189228249439, 901.5065058662872, 467.0307762208858, 1005.7764423292128, 1047.5307419006583, 37.65368574874701, 1032.4116006222894, 851.873220289033, 204.5344953680054, 636.0253246294909, 903.0784785518124, 755.7678635388311, 310.35435267229235, 302.29158452129974, 14.576037030088798, 933.3587402459954, 1056.2302658023864, 1179.57830171658, 936.8799931810663, 578.3919889377112, 765.5905368112208, 648.869181914217, 896.7036792973088, 866.4725670125263, 346.92842914163396, 1076.6600880078545, 1024.9297848019355, 963.973438404374, 992.0626172410533, 577.5878696847296, 1064.1296095113373, 94.01124403249936, 953.8366720178456, 736.878037621789, 1038.9497960951694, 1097.265336055169, 871.2505415235942, 500.4371801367354, 803.1918174764155, 1018.9770692319199, 934.0634988236931, 896.4159735801608, 1067.251830000767, 615.5330814207507, 932.7028837878931, 30.742369479036192, 1118.1306135055163, 916.1205533212817, 534.7355564527957, 951.1487676666883, 955.0116827078186, 1030.795780253461, 1035.5412584334142, 834.7759986181161, 911.0708956792956, 1015.3133788628952, 612.7356137508659, 860.8238654468274, 499.4317710896683, 47.40196819192787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.047559227083135, "mean_inference_ms": 4.57786509876833, "mean_action_processing_ms": 1.593761815245165, "mean_env_wait_ms": 10.135614395435034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013971805572509766, "StateBufferConnector_ms": 0.006360411643981934, "ViewRequirementAgentConnector_ms": 0.21129047870635986}, "num_episodes": 17, "episode_return_max": 741.4617396744449, "episode_return_min": 13.239488809782397, "episode_return_mean": 404.5640743868655, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.147359090178, "num_env_steps_trained_throughput_per_sec": 72.147359090178, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 52328.158, "restore_workers_time_ms": 0.016, "training_step_time_ms": 52328.032, "sample_time_ms": 2695.001, "learn_time_ms": 49607.82, "learn_throughput": 80.632, "synch_weights_time_ms": 19.481}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "35fb9_00000", "date": "2024-08-22_08-12-53", "timestamp": 1724294573, "time_this_iter_s": 55.47987413406372, "time_total_s": 1152.5611760616302, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b611e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1152.5611760616302, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 41.20126582278482, "ram_util_percent": 82.69240506329116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.606878763405735, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.77973130241273, "policy_loss": -0.021210762382751065, "vf_loss": 8.798133417916675, "vf_explained_var": 0.2927758626206211, "kl": 0.014043212699255458, "entropy": 1.1014632598432914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.165806941695944, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.524427314031692, "policy_loss": -0.018840242939552776, "vf_loss": 8.540747877403541, "vf_explained_var": 0.1815209583315269, "kl": 0.012598345828828988, "entropy": 0.7490867445393214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 741.4617396744449, "episode_reward_min": 13.239488809782397, "episode_reward_mean": 361.622437183231, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1275.0828792693085, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1275.0828792693085}, "policy_reward_mean": {"prey_policy": -346.21485320701214, "predator_policy": 527.0260717986279}, "custom_metrics": {}, "hist_stats": {"episode_reward": [662.8361175200994, 590.4099782095747, 544.2717094940876, 435.89999999999975, 83.94768094784058, 524.7822565359439, 692.5876713847405, 681.1, 603.4429841850268, 543.3000000000002, 741.4617396744449, 694.3497957573409, 442.94290853786856, 694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595, 711.9, 397.172196056187, 597.0999999999999, 510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121, 196.89999999999813, 208.58255945567947, 292.8458169184529, 76.27455375695264, 131.96844193270658, 494.0140965507436, 59.855766229254925, 105.95793749906986, 326.9942188456947, 444.8549006728437, 538.8474741436634, 287.774171657955, 256.8449040966143, 337.9115295566252, 89.35381624562923, 327.19972939317904, 539.1619804464602, 143.5187370132804, 396.74114925431473, 60.24046543091819, 278.26982231911256, 413.9291942605116, 269.86435383351227, 489.7411115428039, 239.9031235179449, 13.239488809782397, 184.74154597486333, 360.11280643467313, 211.702713444255, 364.46519957686877, 231.04778259174623, 607.9707972062336, 238.4948852076862, 272.0417548303233, 15.408539540546098, 329.22558735284616, 83.936454206121, 107.7053405122855, 340.69062385583186, 350.08117817081774, 302.3959402398085, 95.6248167356442, 103.44099677459667, 168.28164429103344, 166.89413160198345, 315.95686767653586, 530.7841843170864, 291.46394588394253, 19.521012703243514, 53.39724465776257, 321.0361903306856, 359.08356827094747, 253.69922056138049, 45.2576636228842, 602.9222905175568, 54.3130017147017, 189.58971419332036, 72.32160991130543, 279.92731458015453, 40.96169880513431, 383.9048128494726, 359.17135036424304, 298.4397619410134, 433.7974910997259], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [243.58227907341717, 198.62993786146745, 133.01481242847245, 90.66666979211698, 299.9064715179807, -221.78693349828185, 197.37297656285864, 60.72971963466922, -5.24327918935133, -41.127368485604286, 197.73108275561054, 18.96803060497109, 258.841759029779, 299.8418264262235, 290.30513576712826, 293.6000273368171, 334.1899589764816, -137.2845019018719, 66.8652009438753, 400.0, 379.34071960847933, 312.1453647525333, 244.79810484704893, 355.00956577315014, -344.8786092499659, 246.1287674952319, 264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864, 345.93186930258634, 294.5763225440117, -110.34582862626014, 19.77672030202562, 236.32247218049395, 222.72442464854745, 45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926, -457.77463328561805, 33.74792389404083, -751.7551921563154, -669.0314476076404, -748.9835482909266, -336.6833312305238, -753.7596004071332, -1068.9050804787585, -1017.3506038461142, -605.2326389309587, -250.62302083830423, -551.6687414077346, -1165.554070568206, -678.5237651410367, -934.7445039914603, -585.6766124860462, -286.95618171676097, -405.0917017950269, -880.897459562582, 64.31002004899398, -245.26715703206543, 86.64818881101354, -569.7202834523031, -50.78422113363174, -912.1562939236668, -433.7798316015763, -365.4640095028954, -906.0132207428646, -95.29254202226849, -1275.0828792693085, -226.18371777603528, -459.5634166254683, 228.057549587932, -823.3005074752604, -407.3505307075218, -936.0561609704266, -562.3093996784143, -513.756669617369, -968.0509235307851, -56.89303868770372, -954.7376324340505, -651.2773661581565, -332.45332131365086, -94.17730442333361, -398.2498675961642, -990.7321206609673, -181.72484603869438, 58.8200203879087, -5.259245759952449, -702.7724079981833, -1053.9907769926035, -1168.57830171658, -880.4976634520642, -450.03277269184974, -544.4996739793537, -509.8472383114113, -743.2836216386565, -808.1899112269232, -1126.077129046147, 66.95381147352643, -667.1540828800106, -1090.70135773455, -368.0983375207618, -593.5813521987848, 72.81395209161029, -992.459920427761, -816.1640998461643, -602.508854963149, -1026.2499129521736, -1094.5566796576186, -603.4166913328571, -439.045442974626, -965.5435275241133, -772.6889049781014, -947.4964049172441, -775.2777269743243, -426.00821170024165, -916.0860758654425, -319.91032361124064, -293.4537514848712, -1126.0202263062731, -605.8350002807175, -512.7066963354526, -877.552811048387, -1045.8824367791997, -836.4840294074826, -945.8657666238561, -756.1698461366406, -748.3343952029009, -1011.1557477373069, -1247.0618973033663, 89.4592857822081, -51.202029897388485, 35.15247493287871, -593.4239160872826, -402.24559874582394, -946.9547224286658, -1012.6647164674591, -1157.7363232225769, -399.6726219238579, -307.67673513019287, -877.889765446061, -1067.1703252801296, -16.888749733734212, -652.9844026057203, -994.685892414591, -1081.223660419167, -958.409831463417, -29.152706840535245, 107.24326701805336, -1033.8564824314703, -1215.3313312045427, -632.9344180429244, -864.901052610299, -733.9486516182983, -832.1524574478537, -186.99275056219466, -1118.2095802640922, -984.4431114388829, -616.4660086650465, -861.0045195369079, -344.59719516826283, -865.6794994514989, 323.4398347874944, -1060.826763044055, -40.07425851264159, 274.40009336620926, -1163.982567924634], "policy_predator_policy_reward": [46.4757821068619, 174.14811847835324, 5.101512396512092, 361.62698359247315, 297.652966162459, 168.49920531192979, 74.51410461876672, 103.28319918370536, 52.80658460295237, 77.5117440198439, 88.68669324151104, 219.3964499338513, 26.59415963508053, 107.3099262936579, 41.75796089873731, 55.43687599731739, 29.15302520854516, 377.38450190187194, 76.43479905612502, 0.0, 0.0, 49.97565531343221, 71.47470502220428, 23.067420114937512, 241.31817896804208, 300.3745713245613, 99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885, 5.068130697413661, 66.32367745598823, 155.06723795062626, 332.67406642979256, 125.19434524058353, 12.85875793037491, 440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419, 8.273635503573587, 612.6530738880039, 818.3626325700884, 811.006566649546, 558.3995579188444, 820.1131385210581, 1013.1716327397862, 885.7676019030587, 1046.1894314734561, 708.3622532363252, 642.9423781409789, 653.3634806558057, 1168.2748079619773, 735.6587939765202, 660.1910607700376, 966.1879932065385, 491.3594892053583, 527.6826131521244, 291.0489671085476, 970.3933730778843, 240.46566474278222, 457.00077762193274, 407.95433966365374, 500.32433658023575, 804.5078146437746, 798.2732149780834, 813.1881804503236, 796.2005793520617, 184.64635826789754, 1275.0828792693085, 988.8798329242184, 24.067030870465477, 214.48588544895944, 919.9190528848299, 585.4189228249439, 901.5065058662872, 467.0307762208858, 1005.7764423292128, 1047.5307419006583, 37.65368574874701, 1032.4116006222894, 851.873220289033, 204.5344953680054, 636.0253246294909, 903.0784785518124, 755.7678635388311, 310.35435267229235, 302.29158452129974, 14.576037030088798, 933.3587402459954, 1056.2302658023864, 1179.57830171658, 936.8799931810663, 578.3919889377112, 765.5905368112208, 648.869181914217, 896.7036792973088, 866.4725670125263, 346.92842914163396, 1076.6600880078545, 1024.9297848019355, 963.973438404374, 992.0626172410533, 577.5878696847296, 1064.1296095113373, 94.01124403249936, 953.8366720178456, 736.878037621789, 1038.9497960951694, 1097.265336055169, 871.2505415235942, 500.4371801367354, 803.1918174764155, 1018.9770692319199, 934.0634988236931, 896.4159735801608, 1067.251830000767, 615.5330814207507, 932.7028837878931, 30.742369479036192, 1118.1306135055163, 916.1205533212817, 534.7355564527957, 951.1487676666883, 955.0116827078186, 1030.795780253461, 1035.5412584334142, 834.7759986181161, 911.0708956792956, 1015.3133788628952, 612.7356137508659, 860.8238654468274, 499.4317710896683, 47.40196819192787, 490.5970700750862, 796.5363906419606, 960.0547224286655, 1019.0857291707027, 581.8920833186748, 1028.9141064855296, 952.0514313291854, 554.5512595777584, 1124.4055449913506, 318.73709829346075, 935.7593258608816, 965.61018972081, 1096.1546771441424, 988.7364783613268, 263.8550650562944, 260.97666528374447, 1070.4247201001906, 1233.0760952505275, 952.6224415809542, 734.8027432655906, 708.1828827460115, 930.239836231447, 457.3610059763905, 1127.7686394300508, 1005.143282027985, 636.7275368810782, 916.8968701869777, 672.6096573676652, 879.2283329365755, 22.18268209167235, 597.9934373184194, 801.3473461792918, 294.9273507185015, 1028.4526149396493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.01441811000188, "mean_inference_ms": 4.615745495273843, "mean_action_processing_ms": 1.6526312310858813, "mean_env_wait_ms": 10.147017438292098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014011621475219727, "StateBufferConnector_ms": 0.005569934844970703, "ViewRequirementAgentConnector_ms": 0.1928478479385376}, "num_episodes": 17, "episode_return_max": 741.4617396744449, "episode_return_min": 13.239488809782397, "episode_return_mean": 361.622437183231, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.7885886820828, "num_env_steps_trained_throughput_per_sec": 73.7885886820828, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 52557.519, "restore_workers_time_ms": 0.016, "training_step_time_ms": 52557.395, "sample_time_ms": 2723.427, "learn_time_ms": 49810.006, "learn_throughput": 80.305, "synch_weights_time_ms": 18.419}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "35fb9_00000", "date": "2024-08-22_08-13-47", "timestamp": 1724294627, "time_this_iter_s": 54.258423805236816, "time_total_s": 1206.819599866867, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc89e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1206.819599866867, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 37.67662337662338, "ram_util_percent": 82.88701298701298}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.931023795831772, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.573353458081604, "policy_loss": -0.022286799137859983, "vf_loss": 8.593008111772082, "vf_explained_var": 0.3334083665615667, "kl": 0.013160666512823096, "entropy": 1.1072849497908637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.526823000870055, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.9909753703566455, "policy_loss": -0.018440202981844622, "vf_loss": 8.006781939854697, "vf_explained_var": 0.2597189565184255, "kl": 0.013168145896788075, "entropy": 0.7579294391094692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 741.4617396744449, "episode_reward_min": 13.239488809782397, "episode_reward_mean": 339.96251978303053, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1275.0828792693085, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1275.0828792693085}, "policy_reward_mean": {"prey_policy": -411.27062901966514, "predator_policy": 581.2518889111806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [603.4429841850268, 543.3000000000002, 741.4617396744449, 694.3497957573409, 442.94290853786856, 694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595, 711.9, 397.172196056187, 597.0999999999999, 510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121, 196.89999999999813, 208.58255945567947, 292.8458169184529, 76.27455375695264, 131.96844193270658, 494.0140965507436, 59.855766229254925, 105.95793749906986, 326.9942188456947, 444.8549006728437, 538.8474741436634, 287.774171657955, 256.8449040966143, 337.9115295566252, 89.35381624562923, 327.19972939317904, 539.1619804464602, 143.5187370132804, 396.74114925431473, 60.24046543091819, 278.26982231911256, 413.9291942605116, 269.86435383351227, 489.7411115428039, 239.9031235179449, 13.239488809782397, 184.74154597486333, 360.11280643467313, 211.702713444255, 364.46519957686877, 231.04778259174623, 607.9707972062336, 238.4948852076862, 272.0417548303233, 15.408539540546098, 329.22558735284616, 83.936454206121, 107.7053405122855, 340.69062385583186, 350.08117817081774, 302.3959402398085, 95.6248167356442, 103.44099677459667, 168.28164429103344, 166.89413160198345, 315.95686767653586, 530.7841843170864, 291.46394588394253, 19.521012703243514, 53.39724465776257, 321.0361903306856, 359.08356827094747, 253.69922056138049, 45.2576636228842, 602.9222905175568, 54.3130017147017, 189.58971419332036, 72.32160991130543, 279.92731458015453, 40.96169880513431, 383.9048128494726, 359.17135036424304, 298.4397619410134, 433.7974910997259, 167.19387840730906, 30.214096284130825, 513.0067013786834, 142.57349917804842, 382.2270490849362, 90.74990508499701, 362.15019634536867, 361.72834830877815], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [334.1899589764816, -137.2845019018719, 66.8652009438753, 400.0, 379.34071960847933, 312.1453647525333, 244.79810484704893, 355.00956577315014, -344.8786092499659, 246.1287674952319, 264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864, 345.93186930258634, 294.5763225440117, -110.34582862626014, 19.77672030202562, 236.32247218049395, 222.72442464854745, 45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926, -457.77463328561805, 33.74792389404083, -751.7551921563154, -669.0314476076404, -748.9835482909266, -336.6833312305238, -753.7596004071332, -1068.9050804787585, -1017.3506038461142, -605.2326389309587, -250.62302083830423, -551.6687414077346, -1165.554070568206, -678.5237651410367, -934.7445039914603, -585.6766124860462, -286.95618171676097, -405.0917017950269, -880.897459562582, 64.31002004899398, -245.26715703206543, 86.64818881101354, -569.7202834523031, -50.78422113363174, -912.1562939236668, -433.7798316015763, -365.4640095028954, -906.0132207428646, -95.29254202226849, -1275.0828792693085, -226.18371777603528, -459.5634166254683, 228.057549587932, -823.3005074752604, -407.3505307075218, -936.0561609704266, -562.3093996784143, -513.756669617369, -968.0509235307851, -56.89303868770372, -954.7376324340505, -651.2773661581565, -332.45332131365086, -94.17730442333361, -398.2498675961642, -990.7321206609673, -181.72484603869438, 58.8200203879087, -5.259245759952449, -702.7724079981833, -1053.9907769926035, -1168.57830171658, -880.4976634520642, -450.03277269184974, -544.4996739793537, -509.8472383114113, -743.2836216386565, -808.1899112269232, -1126.077129046147, 66.95381147352643, -667.1540828800106, -1090.70135773455, -368.0983375207618, -593.5813521987848, 72.81395209161029, -992.459920427761, -816.1640998461643, -602.508854963149, -1026.2499129521736, -1094.5566796576186, -603.4166913328571, -439.045442974626, -965.5435275241133, -772.6889049781014, -947.4964049172441, -775.2777269743243, -426.00821170024165, -916.0860758654425, -319.91032361124064, -293.4537514848712, -1126.0202263062731, -605.8350002807175, -512.7066963354526, -877.552811048387, -1045.8824367791997, -836.4840294074826, -945.8657666238561, -756.1698461366406, -748.3343952029009, -1011.1557477373069, -1247.0618973033663, 89.4592857822081, -51.202029897388485, 35.15247493287871, -593.4239160872826, -402.24559874582394, -946.9547224286658, -1012.6647164674591, -1157.7363232225769, -399.6726219238579, -307.67673513019287, -877.889765446061, -1067.1703252801296, -16.888749733734212, -652.9844026057203, -994.685892414591, -1081.223660419167, -958.409831463417, -29.152706840535245, 107.24326701805336, -1033.8564824314703, -1215.3313312045427, -632.9344180429244, -864.901052610299, -733.9486516182983, -832.1524574478537, -186.99275056219466, -1118.2095802640922, -984.4431114388829, -616.4660086650465, -861.0045195369079, -344.59719516826283, -865.6794994514989, 323.4398347874944, -1060.826763044055, -40.07425851264159, 274.40009336620926, -1163.982567924634, -1016.7460607263803, 35.31839965526176, -1227.9516858546888, -762.8358305558595, -910.4844743932902, -164.6272098504818, -604.0603157384318, -986.0085127105568, -319.34477023836234, -604.5656171079115, -1002.3372681338918, -899.7621872546063, -177.50571692954543, -913.3482997488327, -310.780558720694, -831.0819066040481], "policy_predator_policy_reward": [29.15302520854516, 377.38450190187194, 76.43479905612502, 0.0, 0.0, 49.97565531343221, 71.47470502220428, 23.067420114937512, 241.31817896804208, 300.3745713245613, 99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885, 5.068130697413661, 66.32367745598823, 155.06723795062626, 332.67406642979256, 125.19434524058353, 12.85875793037491, 440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419, 8.273635503573587, 612.6530738880039, 818.3626325700884, 811.006566649546, 558.3995579188444, 820.1131385210581, 1013.1716327397862, 885.7676019030587, 1046.1894314734561, 708.3622532363252, 642.9423781409789, 653.3634806558057, 1168.2748079619773, 735.6587939765202, 660.1910607700376, 966.1879932065385, 491.3594892053583, 527.6826131521244, 291.0489671085476, 970.3933730778843, 240.46566474278222, 457.00077762193274, 407.95433966365374, 500.32433658023575, 804.5078146437746, 798.2732149780834, 813.1881804503236, 796.2005793520617, 184.64635826789754, 1275.0828792693085, 988.8798329242184, 24.067030870465477, 214.48588544895944, 919.9190528848299, 585.4189228249439, 901.5065058662872, 467.0307762208858, 1005.7764423292128, 1047.5307419006583, 37.65368574874701, 1032.4116006222894, 851.873220289033, 204.5344953680054, 636.0253246294909, 903.0784785518124, 755.7678635388311, 310.35435267229235, 302.29158452129974, 14.576037030088798, 933.3587402459954, 1056.2302658023864, 1179.57830171658, 936.8799931810663, 578.3919889377112, 765.5905368112208, 648.869181914217, 896.7036792973088, 866.4725670125263, 346.92842914163396, 1076.6600880078545, 1024.9297848019355, 963.973438404374, 992.0626172410533, 577.5878696847296, 1064.1296095113373, 94.01124403249936, 953.8366720178456, 736.878037621789, 1038.9497960951694, 1097.265336055169, 871.2505415235942, 500.4371801367354, 803.1918174764155, 1018.9770692319199, 934.0634988236931, 896.4159735801608, 1067.251830000767, 615.5330814207507, 932.7028837878931, 30.742369479036192, 1118.1306135055163, 916.1205533212817, 534.7355564527957, 951.1487676666883, 955.0116827078186, 1030.795780253461, 1035.5412584334142, 834.7759986181161, 911.0708956792956, 1015.3133788628952, 612.7356137508659, 860.8238654468274, 499.4317710896683, 47.40196819192787, 490.5970700750862, 796.5363906419606, 960.0547224286655, 1019.0857291707027, 581.8920833186748, 1028.9141064855296, 952.0514313291854, 554.5512595777584, 1124.4055449913506, 318.73709829346075, 935.7593258608816, 965.61018972081, 1096.1546771441424, 988.7364783613268, 263.8550650562944, 260.97666528374447, 1070.4247201001906, 1233.0760952505275, 952.6224415809542, 734.8027432655906, 708.1828827460115, 930.239836231447, 457.3610059763905, 1127.7686394300508, 1005.143282027985, 636.7275368810782, 916.8968701869777, 672.6096573676652, 879.2283329365755, 22.18268209167235, 597.9934373184194, 801.3473461792918, 294.9273507185015, 1028.4526149396493, 778.6028014948038, 370.018737983625, 1228.324643684833, 792.6769690098461, 557.9812000096233, 1030.137185612832, 721.6091602654835, 1011.033167361555, 1014.6090367755537, 291.52839965565636, 1063.1994601683978, 929.6499003050965, 544.4687262051731, 908.5354868185738, 1077.5676731687936, 426.0231404647284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.024510751808104, "mean_inference_ms": 4.644114559656609, "mean_action_processing_ms": 1.650183191598401, "mean_env_wait_ms": 10.172528323893538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008136153221130371, "StateBufferConnector_ms": 0.005725502967834473, "ViewRequirementAgentConnector_ms": 0.1825789213180542}, "num_episodes": 8, "episode_return_max": 741.4617396744449, "episode_return_min": 13.239488809782397, "episode_return_mean": 339.96251978303053, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.94065440626179, "num_env_steps_trained_throughput_per_sec": 81.94065440626179, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 52490.734, "restore_workers_time_ms": 0.016, "training_step_time_ms": 52490.603, "sample_time_ms": 2742.799, "learn_time_ms": 49723.03, "learn_throughput": 80.446, "synch_weights_time_ms": 19.082}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "35fb9_00000", "date": "2024-08-22_08-14-36", "timestamp": 1724294676, "time_this_iter_s": 48.852808237075806, "time_total_s": 1255.6724081039429, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fca9dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1255.6724081039429, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 28.9695652173913, "ram_util_percent": 82.64202898550724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.105811894570708, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.303720130113067, "policy_loss": -0.024810942819603183, "vf_loss": 8.325376862066763, "vf_explained_var": 0.3151039116912418, "kl": 0.015771073320259652, "entropy": 1.1360191568180367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.113832020318066, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.824955489143493, "policy_loss": -0.018256968844475016, "vf_loss": 7.84051098747859, "vf_explained_var": 0.2990882862497259, "kl": 0.013507390750581941, "entropy": 0.7857736709887388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 741.4617396744449, "episode_reward_min": 13.239488809782397, "episode_reward_mean": 339.96251978303053, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1275.0828792693085, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1275.0828792693085}, "policy_reward_mean": {"prey_policy": -411.27062901966514, "predator_policy": 581.2518889111806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [603.4429841850268, 543.3000000000002, 741.4617396744449, 694.3497957573409, 442.94290853786856, 694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595, 711.9, 397.172196056187, 597.0999999999999, 510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121, 196.89999999999813, 208.58255945567947, 292.8458169184529, 76.27455375695264, 131.96844193270658, 494.0140965507436, 59.855766229254925, 105.95793749906986, 326.9942188456947, 444.8549006728437, 538.8474741436634, 287.774171657955, 256.8449040966143, 337.9115295566252, 89.35381624562923, 327.19972939317904, 539.1619804464602, 143.5187370132804, 396.74114925431473, 60.24046543091819, 278.26982231911256, 413.9291942605116, 269.86435383351227, 489.7411115428039, 239.9031235179449, 13.239488809782397, 184.74154597486333, 360.11280643467313, 211.702713444255, 364.46519957686877, 231.04778259174623, 607.9707972062336, 238.4948852076862, 272.0417548303233, 15.408539540546098, 329.22558735284616, 83.936454206121, 107.7053405122855, 340.69062385583186, 350.08117817081774, 302.3959402398085, 95.6248167356442, 103.44099677459667, 168.28164429103344, 166.89413160198345, 315.95686767653586, 530.7841843170864, 291.46394588394253, 19.521012703243514, 53.39724465776257, 321.0361903306856, 359.08356827094747, 253.69922056138049, 45.2576636228842, 602.9222905175568, 54.3130017147017, 189.58971419332036, 72.32160991130543, 279.92731458015453, 40.96169880513431, 383.9048128494726, 359.17135036424304, 298.4397619410134, 433.7974910997259, 167.19387840730906, 30.214096284130825, 513.0067013786834, 142.57349917804842, 382.2270490849362, 90.74990508499701, 362.15019634536867, 361.72834830877815], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [334.1899589764816, -137.2845019018719, 66.8652009438753, 400.0, 379.34071960847933, 312.1453647525333, 244.79810484704893, 355.00956577315014, -344.8786092499659, 246.1287674952319, 264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864, 345.93186930258634, 294.5763225440117, -110.34582862626014, 19.77672030202562, 236.32247218049395, 222.72442464854745, 45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926, -457.77463328561805, 33.74792389404083, -751.7551921563154, -669.0314476076404, -748.9835482909266, -336.6833312305238, -753.7596004071332, -1068.9050804787585, -1017.3506038461142, -605.2326389309587, -250.62302083830423, -551.6687414077346, -1165.554070568206, -678.5237651410367, -934.7445039914603, -585.6766124860462, -286.95618171676097, -405.0917017950269, -880.897459562582, 64.31002004899398, -245.26715703206543, 86.64818881101354, -569.7202834523031, -50.78422113363174, -912.1562939236668, -433.7798316015763, -365.4640095028954, -906.0132207428646, -95.29254202226849, -1275.0828792693085, -226.18371777603528, -459.5634166254683, 228.057549587932, -823.3005074752604, -407.3505307075218, -936.0561609704266, -562.3093996784143, -513.756669617369, -968.0509235307851, -56.89303868770372, -954.7376324340505, -651.2773661581565, -332.45332131365086, -94.17730442333361, -398.2498675961642, -990.7321206609673, -181.72484603869438, 58.8200203879087, -5.259245759952449, -702.7724079981833, -1053.9907769926035, -1168.57830171658, -880.4976634520642, -450.03277269184974, -544.4996739793537, -509.8472383114113, -743.2836216386565, -808.1899112269232, -1126.077129046147, 66.95381147352643, -667.1540828800106, -1090.70135773455, -368.0983375207618, -593.5813521987848, 72.81395209161029, -992.459920427761, -816.1640998461643, -602.508854963149, -1026.2499129521736, -1094.5566796576186, -603.4166913328571, -439.045442974626, -965.5435275241133, -772.6889049781014, -947.4964049172441, -775.2777269743243, -426.00821170024165, -916.0860758654425, -319.91032361124064, -293.4537514848712, -1126.0202263062731, -605.8350002807175, -512.7066963354526, -877.552811048387, -1045.8824367791997, -836.4840294074826, -945.8657666238561, -756.1698461366406, -748.3343952029009, -1011.1557477373069, -1247.0618973033663, 89.4592857822081, -51.202029897388485, 35.15247493287871, -593.4239160872826, -402.24559874582394, -946.9547224286658, -1012.6647164674591, -1157.7363232225769, -399.6726219238579, -307.67673513019287, -877.889765446061, -1067.1703252801296, -16.888749733734212, -652.9844026057203, -994.685892414591, -1081.223660419167, -958.409831463417, -29.152706840535245, 107.24326701805336, -1033.8564824314703, -1215.3313312045427, -632.9344180429244, -864.901052610299, -733.9486516182983, -832.1524574478537, -186.99275056219466, -1118.2095802640922, -984.4431114388829, -616.4660086650465, -861.0045195369079, -344.59719516826283, -865.6794994514989, 323.4398347874944, -1060.826763044055, -40.07425851264159, 274.40009336620926, -1163.982567924634, -1016.7460607263803, 35.31839965526176, -1227.9516858546888, -762.8358305558595, -910.4844743932902, -164.6272098504818, -604.0603157384318, -986.0085127105568, -319.34477023836234, -604.5656171079115, -1002.3372681338918, -899.7621872546063, -177.50571692954543, -913.3482997488327, -310.780558720694, -831.0819066040481], "policy_predator_policy_reward": [29.15302520854516, 377.38450190187194, 76.43479905612502, 0.0, 0.0, 49.97565531343221, 71.47470502220428, 23.067420114937512, 241.31817896804208, 300.3745713245613, 99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885, 5.068130697413661, 66.32367745598823, 155.06723795062626, 332.67406642979256, 125.19434524058353, 12.85875793037491, 440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419, 8.273635503573587, 612.6530738880039, 818.3626325700884, 811.006566649546, 558.3995579188444, 820.1131385210581, 1013.1716327397862, 885.7676019030587, 1046.1894314734561, 708.3622532363252, 642.9423781409789, 653.3634806558057, 1168.2748079619773, 735.6587939765202, 660.1910607700376, 966.1879932065385, 491.3594892053583, 527.6826131521244, 291.0489671085476, 970.3933730778843, 240.46566474278222, 457.00077762193274, 407.95433966365374, 500.32433658023575, 804.5078146437746, 798.2732149780834, 813.1881804503236, 796.2005793520617, 184.64635826789754, 1275.0828792693085, 988.8798329242184, 24.067030870465477, 214.48588544895944, 919.9190528848299, 585.4189228249439, 901.5065058662872, 467.0307762208858, 1005.7764423292128, 1047.5307419006583, 37.65368574874701, 1032.4116006222894, 851.873220289033, 204.5344953680054, 636.0253246294909, 903.0784785518124, 755.7678635388311, 310.35435267229235, 302.29158452129974, 14.576037030088798, 933.3587402459954, 1056.2302658023864, 1179.57830171658, 936.8799931810663, 578.3919889377112, 765.5905368112208, 648.869181914217, 896.7036792973088, 866.4725670125263, 346.92842914163396, 1076.6600880078545, 1024.9297848019355, 963.973438404374, 992.0626172410533, 577.5878696847296, 1064.1296095113373, 94.01124403249936, 953.8366720178456, 736.878037621789, 1038.9497960951694, 1097.265336055169, 871.2505415235942, 500.4371801367354, 803.1918174764155, 1018.9770692319199, 934.0634988236931, 896.4159735801608, 1067.251830000767, 615.5330814207507, 932.7028837878931, 30.742369479036192, 1118.1306135055163, 916.1205533212817, 534.7355564527957, 951.1487676666883, 955.0116827078186, 1030.795780253461, 1035.5412584334142, 834.7759986181161, 911.0708956792956, 1015.3133788628952, 612.7356137508659, 860.8238654468274, 499.4317710896683, 47.40196819192787, 490.5970700750862, 796.5363906419606, 960.0547224286655, 1019.0857291707027, 581.8920833186748, 1028.9141064855296, 952.0514313291854, 554.5512595777584, 1124.4055449913506, 318.73709829346075, 935.7593258608816, 965.61018972081, 1096.1546771441424, 988.7364783613268, 263.8550650562944, 260.97666528374447, 1070.4247201001906, 1233.0760952505275, 952.6224415809542, 734.8027432655906, 708.1828827460115, 930.239836231447, 457.3610059763905, 1127.7686394300508, 1005.143282027985, 636.7275368810782, 916.8968701869777, 672.6096573676652, 879.2283329365755, 22.18268209167235, 597.9934373184194, 801.3473461792918, 294.9273507185015, 1028.4526149396493, 778.6028014948038, 370.018737983625, 1228.324643684833, 792.6769690098461, 557.9812000096233, 1030.137185612832, 721.6091602654835, 1011.033167361555, 1014.6090367755537, 291.52839965565636, 1063.1994601683978, 929.6499003050965, 544.4687262051731, 908.5354868185738, 1077.5676731687936, 426.0231404647284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.024510751808104, "mean_inference_ms": 4.644114559656609, "mean_action_processing_ms": 1.650183191598401, "mean_env_wait_ms": 10.172528323893538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008136153221130371, "StateBufferConnector_ms": 0.005725502967834473, "ViewRequirementAgentConnector_ms": 0.1825789213180542}, "num_episodes": 0, "episode_return_max": 741.4617396744449, "episode_return_min": 13.239488809782397, "episode_return_mean": 339.96251978303053, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.70206492797087, "num_env_steps_trained_throughput_per_sec": 81.70206492797087, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 52151.026, "restore_workers_time_ms": 0.016, "training_step_time_ms": 52150.907, "sample_time_ms": 2741.846, "learn_time_ms": 49383.501, "learn_throughput": 80.999, "synch_weights_time_ms": 19.515}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "35fb9_00000", "date": "2024-08-22_08-15-25", "timestamp": 1724294725, "time_this_iter_s": 48.98361682891846, "time_total_s": 1304.6560249328613, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fca8a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1304.6560249328613, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 28.654285714285713, "ram_util_percent": 82.26142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.287387311395513, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.268761769299784, "policy_loss": -0.01908602848446992, "vf_loss": 8.284669509514298, "vf_explained_var": 0.39534882322821036, "kl": 0.01589153227618053, "entropy": 1.142249087051109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.746740157894356, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.267302439704775, "policy_loss": -0.02072143635796334, "vf_loss": 8.285062361268139, "vf_explained_var": 0.28011424024269066, "kl": 0.01480762912182226, "entropy": 0.7711430500424098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 714.1, "episode_reward_min": 3.89570220896076, "episode_reward_mean": 312.25373840030943, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1308.5019246126876, "predator_policy": 2.5190578287173175}, "policy_reward_max": {"prey_policy": 390.0809421712827, "predator_policy": 1312.3555434873585}, "policy_reward_mean": {"prey_policy": -466.13333728763956, "predator_policy": 622.2602064877944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [694.0968041778643, 566.6369302363858, 503.51440580855535, 576.185737900638, 578.6999999999996, 486.4300785899729, 379.14962975332503, 623.2666687091075, 478.4029724552596, 684.297744831595, 711.9, 397.172196056187, 597.0999999999999, 510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121, 196.89999999999813, 208.58255945567947, 292.8458169184529, 76.27455375695264, 131.96844193270658, 494.0140965507436, 59.855766229254925, 105.95793749906986, 326.9942188456947, 444.8549006728437, 538.8474741436634, 287.774171657955, 256.8449040966143, 337.9115295566252, 89.35381624562923, 327.19972939317904, 539.1619804464602, 143.5187370132804, 396.74114925431473, 60.24046543091819, 278.26982231911256, 413.9291942605116, 269.86435383351227, 489.7411115428039, 239.9031235179449, 13.239488809782397, 184.74154597486333, 360.11280643467313, 211.702713444255, 364.46519957686877, 231.04778259174623, 607.9707972062336, 238.4948852076862, 272.0417548303233, 15.408539540546098, 329.22558735284616, 83.936454206121, 107.7053405122855, 340.69062385583186, 350.08117817081774, 302.3959402398085, 95.6248167356442, 103.44099677459667, 168.28164429103344, 166.89413160198345, 315.95686767653586, 530.7841843170864, 291.46394588394253, 19.521012703243514, 53.39724465776257, 321.0361903306856, 359.08356827094747, 253.69922056138049, 45.2576636228842, 602.9222905175568, 54.3130017147017, 189.58971419332036, 72.32160991130543, 279.92731458015453, 40.96169880513431, 383.9048128494726, 359.17135036424304, 298.4397619410134, 433.7974910997259, 167.19387840730906, 30.214096284130825, 513.0067013786834, 142.57349917804842, 382.2270490849362, 90.74990508499701, 362.15019634536867, 361.72834830877815, 3.89570220896076, 26.0000000000001, 9.05799588476716, 30.880378903827896, 184.78521288502182], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [264.19414598101775, 237.69927910531072, -134.51235487118203, 56.386293962726704, -145.70348370619251, 187.61164048639324, 140.7663578716831, 35.36883208843028, 309.43116168604985, -17.21893431515419, 206.9032230407716, 217.52075957125544, 191.5991349241157, -251.4240764668883, 154.0674144884769, 181.74284343552048, 31.290065255052767, -88.3799377200059, 222.60748016513685, 313.77771420130864, 345.93186930258634, 294.5763225440117, -110.34582862626014, 19.77672030202562, 236.32247218049395, 222.72442464854745, 45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926, -457.77463328561805, 33.74792389404083, -751.7551921563154, -669.0314476076404, -748.9835482909266, -336.6833312305238, -753.7596004071332, -1068.9050804787585, -1017.3506038461142, -605.2326389309587, -250.62302083830423, -551.6687414077346, -1165.554070568206, -678.5237651410367, -934.7445039914603, -585.6766124860462, -286.95618171676097, -405.0917017950269, -880.897459562582, 64.31002004899398, -245.26715703206543, 86.64818881101354, -569.7202834523031, -50.78422113363174, -912.1562939236668, -433.7798316015763, -365.4640095028954, -906.0132207428646, -95.29254202226849, -1275.0828792693085, -226.18371777603528, -459.5634166254683, 228.057549587932, -823.3005074752604, -407.3505307075218, -936.0561609704266, -562.3093996784143, -513.756669617369, -968.0509235307851, -56.89303868770372, -954.7376324340505, -651.2773661581565, -332.45332131365086, -94.17730442333361, -398.2498675961642, -990.7321206609673, -181.72484603869438, 58.8200203879087, -5.259245759952449, -702.7724079981833, -1053.9907769926035, -1168.57830171658, -880.4976634520642, -450.03277269184974, -544.4996739793537, -509.8472383114113, -743.2836216386565, -808.1899112269232, -1126.077129046147, 66.95381147352643, -667.1540828800106, -1090.70135773455, -368.0983375207618, -593.5813521987848, 72.81395209161029, -992.459920427761, -816.1640998461643, -602.508854963149, -1026.2499129521736, -1094.5566796576186, -603.4166913328571, -439.045442974626, -965.5435275241133, -772.6889049781014, -947.4964049172441, -775.2777269743243, -426.00821170024165, -916.0860758654425, -319.91032361124064, -293.4537514848712, -1126.0202263062731, -605.8350002807175, -512.7066963354526, -877.552811048387, -1045.8824367791997, -836.4840294074826, -945.8657666238561, -756.1698461366406, -748.3343952029009, -1011.1557477373069, -1247.0618973033663, 89.4592857822081, -51.202029897388485, 35.15247493287871, -593.4239160872826, -402.24559874582394, -946.9547224286658, -1012.6647164674591, -1157.7363232225769, -399.6726219238579, -307.67673513019287, -877.889765446061, -1067.1703252801296, -16.888749733734212, -652.9844026057203, -994.685892414591, -1081.223660419167, -958.409831463417, -29.152706840535245, 107.24326701805336, -1033.8564824314703, -1215.3313312045427, -632.9344180429244, -864.901052610299, -733.9486516182983, -832.1524574478537, -186.99275056219466, -1118.2095802640922, -984.4431114388829, -616.4660086650465, -861.0045195369079, -344.59719516826283, -865.6794994514989, 323.4398347874944, -1060.826763044055, -40.07425851264159, 274.40009336620926, -1163.982567924634, -1016.7460607263803, 35.31839965526176, -1227.9516858546888, -762.8358305558595, -910.4844743932902, -164.6272098504818, -604.0603157384318, -986.0085127105568, -319.34477023836234, -604.5656171079115, -1002.3372681338918, -899.7621872546063, -177.50571692954543, -913.3482997488327, -310.780558720694, -831.0819066040481, -1308.5019246126876, -1196.89037804246, -568.1733096697529, -802.9297461739687, -962.4167581083608, -1058.1936950152538, -962.7778811899381, -1081.7182714310402, -1067.7434642275396, -106.88165387891964], "policy_predator_policy_reward": [99.67317073619681, 92.53020835533869, 238.91219730547854, 405.85079383936306, 340.11695563515735, 121.4892933931966, 336.3408150080383, 63.70973293248659, 62.568838313950145, 223.91893431515368, 39.000332097207526, 23.005763880738186, 403.02168085947363, 35.9528904366232, 151.7281139518113, 135.72829683329877, 210.98930556247453, 324.50353935773774, 101.42215642458163, 46.490394040567885, 5.068130697413661, 66.32367745598823, 155.06723795062626, 332.67406642979256, 125.19434524058353, 12.85875793037491, 440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419, 8.273635503573587, 612.6530738880039, 818.3626325700884, 811.006566649546, 558.3995579188444, 820.1131385210581, 1013.1716327397862, 885.7676019030587, 1046.1894314734561, 708.3622532363252, 642.9423781409789, 653.3634806558057, 1168.2748079619773, 735.6587939765202, 660.1910607700376, 966.1879932065385, 491.3594892053583, 527.6826131521244, 291.0489671085476, 970.3933730778843, 240.46566474278222, 457.00077762193274, 407.95433966365374, 500.32433658023575, 804.5078146437746, 798.2732149780834, 813.1881804503236, 796.2005793520617, 184.64635826789754, 1275.0828792693085, 988.8798329242184, 24.067030870465477, 214.48588544895944, 919.9190528848299, 585.4189228249439, 901.5065058662872, 467.0307762208858, 1005.7764423292128, 1047.5307419006583, 37.65368574874701, 1032.4116006222894, 851.873220289033, 204.5344953680054, 636.0253246294909, 903.0784785518124, 755.7678635388311, 310.35435267229235, 302.29158452129974, 14.576037030088798, 933.3587402459954, 1056.2302658023864, 1179.57830171658, 936.8799931810663, 578.3919889377112, 765.5905368112208, 648.869181914217, 896.7036792973088, 866.4725670125263, 346.92842914163396, 1076.6600880078545, 1024.9297848019355, 963.973438404374, 992.0626172410533, 577.5878696847296, 1064.1296095113373, 94.01124403249936, 953.8366720178456, 736.878037621789, 1038.9497960951694, 1097.265336055169, 871.2505415235942, 500.4371801367354, 803.1918174764155, 1018.9770692319199, 934.0634988236931, 896.4159735801608, 1067.251830000767, 615.5330814207507, 932.7028837878931, 30.742369479036192, 1118.1306135055163, 916.1205533212817, 534.7355564527957, 951.1487676666883, 955.0116827078186, 1030.795780253461, 1035.5412584334142, 834.7759986181161, 911.0708956792956, 1015.3133788628952, 612.7356137508659, 860.8238654468274, 499.4317710896683, 47.40196819192787, 490.5970700750862, 796.5363906419606, 960.0547224286655, 1019.0857291707027, 581.8920833186748, 1028.9141064855296, 952.0514313291854, 554.5512595777584, 1124.4055449913506, 318.73709829346075, 935.7593258608816, 965.61018972081, 1096.1546771441424, 988.7364783613268, 263.8550650562944, 260.97666528374447, 1070.4247201001906, 1233.0760952505275, 952.6224415809542, 734.8027432655906, 708.1828827460115, 930.239836231447, 457.3610059763905, 1127.7686394300508, 1005.143282027985, 636.7275368810782, 916.8968701869777, 672.6096573676652, 879.2283329365755, 22.18268209167235, 597.9934373184194, 801.3473461792918, 294.9273507185015, 1028.4526149396493, 778.6028014948038, 370.018737983625, 1228.324643684833, 792.6769690098461, 557.9812000096233, 1030.137185612832, 721.6091602654835, 1011.033167361555, 1014.6090367755537, 291.52839965565636, 1063.1994601683978, 929.6499003050965, 544.4687262051731, 908.5354868185738, 1077.5676731687936, 426.0231404647284, 1312.3555434873585, 1196.93246137675, 582.9733096697561, 814.1297461739713, 1044.1485937021494, 985.5198553062316, 976.6582600937668, 1098.7182714310402, 620.128868767951, 739.2814622235279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.029149754561455, "mean_inference_ms": 4.6424538069841415, "mean_action_processing_ms": 1.6727876418995626, "mean_env_wait_ms": 10.180841952900694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0081559419631958, "StateBufferConnector_ms": 0.005735635757446289, "ViewRequirementAgentConnector_ms": 0.18245506286621094}, "num_episodes": 5, "episode_return_max": 714.1, "episode_return_min": 3.89570220896076, "episode_return_mean": 312.25373840030943, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.61861040517611, "num_env_steps_trained_throughput_per_sec": 83.61861040517611, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 51802.811, "restore_workers_time_ms": 0.016, "training_step_time_ms": 51802.699, "sample_time_ms": 2742.693, "learn_time_ms": 49034.369, "learn_throughput": 81.575, "synch_weights_time_ms": 19.722}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "35fb9_00000", "date": "2024-08-22_08-16-13", "timestamp": 1724294773, "time_this_iter_s": 47.87559127807617, "time_total_s": 1352.5316162109375, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b5e7c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1352.5316162109375, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 26.58088235294118, "ram_util_percent": 82.87058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.883489709177976, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.275644688883787, "policy_loss": -0.020466523372725875, "vf_loss": 8.293167145794662, "vf_explained_var": 0.3339429987486077, "kl": 0.014720338212188195, "entropy": 1.1154038673355466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.850426227768892, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.146974722039763, "policy_loss": -0.016345135091000763, "vf_loss": 8.160783114761271, "vf_explained_var": 0.3142114006653034, "kl": 0.012683628745643155, "entropy": 0.7622006671138541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 714.1, "episode_reward_min": 3.89570220896076, "episode_reward_mean": 270.721271222446, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1492.5016445164706, "predator_policy": 2.5190578287173175}, "policy_reward_max": {"prey_policy": 390.0809421712827, "predator_policy": 1346.5533246102464}, "policy_reward_mean": {"prey_policy": -583.8963616171387, "predator_policy": 719.256997228362}, "custom_metrics": {}, "hist_stats": {"episode_reward": [510.46680318245495, 554.4, 455.11620921263693, 714.1, 532.9266505832538, 532.7417632114867, 640.8243452117345, 278.598404669184, 407.50000000000233, 556.7825055535121, 196.89999999999813, 208.58255945567947, 292.8458169184529, 76.27455375695264, 131.96844193270658, 494.0140965507436, 59.855766229254925, 105.95793749906986, 326.9942188456947, 444.8549006728437, 538.8474741436634, 287.774171657955, 256.8449040966143, 337.9115295566252, 89.35381624562923, 327.19972939317904, 539.1619804464602, 143.5187370132804, 396.74114925431473, 60.24046543091819, 278.26982231911256, 413.9291942605116, 269.86435383351227, 489.7411115428039, 239.9031235179449, 13.239488809782397, 184.74154597486333, 360.11280643467313, 211.702713444255, 364.46519957686877, 231.04778259174623, 607.9707972062336, 238.4948852076862, 272.0417548303233, 15.408539540546098, 329.22558735284616, 83.936454206121, 107.7053405122855, 340.69062385583186, 350.08117817081774, 302.3959402398085, 95.6248167356442, 103.44099677459667, 168.28164429103344, 166.89413160198345, 315.95686767653586, 530.7841843170864, 291.46394588394253, 19.521012703243514, 53.39724465776257, 321.0361903306856, 359.08356827094747, 253.69922056138049, 45.2576636228842, 602.9222905175568, 54.3130017147017, 189.58971419332036, 72.32160991130543, 279.92731458015453, 40.96169880513431, 383.9048128494726, 359.17135036424304, 298.4397619410134, 433.7974910997259, 167.19387840730906, 30.214096284130825, 513.0067013786834, 142.57349917804842, 382.2270490849362, 90.74990508499701, 362.15019634536867, 361.72834830877815, 3.89570220896076, 26.0000000000001, 9.05799588476716, 30.880378903827896, 184.78521288502182, 97.16156274622303, 134.9705436101389, 291.7281893218326, 539.852508314432, 397.8516584419797, 223.48727458644095, 155.6568152656098, 308.28895570560627, 238.6367453621083, 206.93016296232815, 241.3653308483623, 244.53690714370452, 43.13979642377107], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [45.57606767445028, -4.135094749938297, 233.67303706131793, 246.44424271273948, 141.29119140908608, 56.683627806948465, 390.0809421712827, 177.60019986953483, -22.87017266316304, 182.941713895714, 81.88595331335081, 57.31223631984041, 255.85336392834296, 167.85091124591588, -415.3215952131382, -115.44029585160278, 279.4723558866367, 34.715496820329754, 108.00288516133858, 201.77590888351926, -457.77463328561805, 33.74792389404083, -751.7551921563154, -669.0314476076404, -748.9835482909266, -336.6833312305238, -753.7596004071332, -1068.9050804787585, -1017.3506038461142, -605.2326389309587, -250.62302083830423, -551.6687414077346, -1165.554070568206, -678.5237651410367, -934.7445039914603, -585.6766124860462, -286.95618171676097, -405.0917017950269, -880.897459562582, 64.31002004899398, -245.26715703206543, 86.64818881101354, -569.7202834523031, -50.78422113363174, -912.1562939236668, -433.7798316015763, -365.4640095028954, -906.0132207428646, -95.29254202226849, -1275.0828792693085, -226.18371777603528, -459.5634166254683, 228.057549587932, -823.3005074752604, -407.3505307075218, -936.0561609704266, -562.3093996784143, -513.756669617369, -968.0509235307851, -56.89303868770372, -954.7376324340505, -651.2773661581565, -332.45332131365086, -94.17730442333361, -398.2498675961642, -990.7321206609673, -181.72484603869438, 58.8200203879087, -5.259245759952449, -702.7724079981833, -1053.9907769926035, -1168.57830171658, -880.4976634520642, -450.03277269184974, -544.4996739793537, -509.8472383114113, -743.2836216386565, -808.1899112269232, -1126.077129046147, 66.95381147352643, -667.1540828800106, -1090.70135773455, -368.0983375207618, -593.5813521987848, 72.81395209161029, -992.459920427761, -816.1640998461643, -602.508854963149, -1026.2499129521736, -1094.5566796576186, -603.4166913328571, -439.045442974626, -965.5435275241133, -772.6889049781014, -947.4964049172441, -775.2777269743243, -426.00821170024165, -916.0860758654425, -319.91032361124064, -293.4537514848712, -1126.0202263062731, -605.8350002807175, -512.7066963354526, -877.552811048387, -1045.8824367791997, -836.4840294074826, -945.8657666238561, -756.1698461366406, -748.3343952029009, -1011.1557477373069, -1247.0618973033663, 89.4592857822081, -51.202029897388485, 35.15247493287871, -593.4239160872826, -402.24559874582394, -946.9547224286658, -1012.6647164674591, -1157.7363232225769, -399.6726219238579, -307.67673513019287, -877.889765446061, -1067.1703252801296, -16.888749733734212, -652.9844026057203, -994.685892414591, -1081.223660419167, -958.409831463417, -29.152706840535245, 107.24326701805336, -1033.8564824314703, -1215.3313312045427, -632.9344180429244, -864.901052610299, -733.9486516182983, -832.1524574478537, -186.99275056219466, -1118.2095802640922, -984.4431114388829, -616.4660086650465, -861.0045195369079, -344.59719516826283, -865.6794994514989, 323.4398347874944, -1060.826763044055, -40.07425851264159, 274.40009336620926, -1163.982567924634, -1016.7460607263803, 35.31839965526176, -1227.9516858546888, -762.8358305558595, -910.4844743932902, -164.6272098504818, -604.0603157384318, -986.0085127105568, -319.34477023836234, -604.5656171079115, -1002.3372681338918, -899.7621872546063, -177.50571692954543, -913.3482997488327, -310.780558720694, -831.0819066040481, -1308.5019246126876, -1196.89037804246, -568.1733096697529, -802.9297461739687, -962.4167581083608, -1058.1936950152538, -962.7778811899381, -1081.7182714310402, -1067.7434642275396, -106.88165387891964, -1009.2580694603854, -1253.0976453676838, 37.69668290996896, -1288.5853023168986, -847.0461263813007, -45.60646176370409, 288.6644834992129, -1051.362301357838, 252.43862639627457, -1008.0761600389992, -1492.5016445164706, -942.2958955614924, -836.57168054207, -710.603357693487, -1100.774409187776, -688.7123781404244, -741.1513694296151, -622.1306896799083, -626.5543495480533, -1067.9299905680716, -746.3620200414009, -669.108224168909, -825.3670547732409, -1132.755421501261, -1151.8929303507527, -1150.9476367803181], "policy_predator_policy_reward": [440.6249729297382, 28.400857328204683, 21.026962938682026, 53.25575728726062, 104.54114354867586, 152.60024644792537, 2.5190578287173175, 143.8998001304652, 231.81166308730099, 141.04344626340188, 59.07731692350831, 334.4662566547874, 20.072985952637538, 197.04708408483796, 482.5335819010404, 326.82671383288454, 88.53636267719325, 4.775784615840567, 227.15174955142993, 19.85196195722419, 8.273635503573587, 612.6530738880039, 818.3626325700884, 811.006566649546, 558.3995579188444, 820.1131385210581, 1013.1716327397862, 885.7676019030587, 1046.1894314734561, 708.3622532363252, 642.9423781409789, 653.3634806558057, 1168.2748079619773, 735.6587939765202, 660.1910607700376, 966.1879932065385, 491.3594892053583, 527.6826131521244, 291.0489671085476, 970.3933730778843, 240.46566474278222, 457.00077762193274, 407.95433966365374, 500.32433658023575, 804.5078146437746, 798.2732149780834, 813.1881804503236, 796.2005793520617, 184.64635826789754, 1275.0828792693085, 988.8798329242184, 24.067030870465477, 214.48588544895944, 919.9190528848299, 585.4189228249439, 901.5065058662872, 467.0307762208858, 1005.7764423292128, 1047.5307419006583, 37.65368574874701, 1032.4116006222894, 851.873220289033, 204.5344953680054, 636.0253246294909, 903.0784785518124, 755.7678635388311, 310.35435267229235, 302.29158452129974, 14.576037030088798, 933.3587402459954, 1056.2302658023864, 1179.57830171658, 936.8799931810663, 578.3919889377112, 765.5905368112208, 648.869181914217, 896.7036792973088, 866.4725670125263, 346.92842914163396, 1076.6600880078545, 1024.9297848019355, 963.973438404374, 992.0626172410533, 577.5878696847296, 1064.1296095113373, 94.01124403249936, 953.8366720178456, 736.878037621789, 1038.9497960951694, 1097.265336055169, 871.2505415235942, 500.4371801367354, 803.1918174764155, 1018.9770692319199, 934.0634988236931, 896.4159735801608, 1067.251830000767, 615.5330814207507, 932.7028837878931, 30.742369479036192, 1118.1306135055163, 916.1205533212817, 534.7355564527957, 951.1487676666883, 955.0116827078186, 1030.795780253461, 1035.5412584334142, 834.7759986181161, 911.0708956792956, 1015.3133788628952, 612.7356137508659, 860.8238654468274, 499.4317710896683, 47.40196819192787, 490.5970700750862, 796.5363906419606, 960.0547224286655, 1019.0857291707027, 581.8920833186748, 1028.9141064855296, 952.0514313291854, 554.5512595777584, 1124.4055449913506, 318.73709829346075, 935.7593258608816, 965.61018972081, 1096.1546771441424, 988.7364783613268, 263.8550650562944, 260.97666528374447, 1070.4247201001906, 1233.0760952505275, 952.6224415809542, 734.8027432655906, 708.1828827460115, 930.239836231447, 457.3610059763905, 1127.7686394300508, 1005.143282027985, 636.7275368810782, 916.8968701869777, 672.6096573676652, 879.2283329365755, 22.18268209167235, 597.9934373184194, 801.3473461792918, 294.9273507185015, 1028.4526149396493, 778.6028014948038, 370.018737983625, 1228.324643684833, 792.6769690098461, 557.9812000096233, 1030.137185612832, 721.6091602654835, 1011.033167361555, 1014.6090367755537, 291.52839965565636, 1063.1994601683978, 929.6499003050965, 544.4687262051731, 908.5354868185738, 1077.5676731687936, 426.0231404647284, 1312.3555434873585, 1196.93246137675, 582.9733096697561, 814.1297461739713, 1044.1485937021494, 985.5198553062316, 976.6582600937668, 1098.7182714310402, 620.128868767951, 739.2814622235279, 1116.682945329678, 1242.8343322446142, 1062.8564104977936, 323.00275251927803, 1180.450250900694, 3.9305265661439606, 260.6544300510958, 1041.8958961219612, 197.94094960980095, 955.5482424749027, 1346.5533246102464, 1311.7314900541598, 1009.2719372477615, 693.5599162534062, 979.6997703870995, 1118.075972646708, 720.3097911715795, 881.6090133000528, 838.288089244753, 1063.1264138337003, 915.8074763824234, 741.0280986762486, 1134.6430251395295, 1068.0163582786774, 1092.1624759855627, 1253.8178875692804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.006628872597392, "mean_inference_ms": 4.59242325028599, "mean_action_processing_ms": 1.7039487312829493, "mean_env_wait_ms": 10.154103514889552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008051753044128418, "StateBufferConnector_ms": 0.00567936897277832, "ViewRequirementAgentConnector_ms": 0.18390023708343506}, "num_episodes": 13, "episode_return_max": 714.1, "episode_return_min": 3.89570220896076, "episode_return_mean": 270.721271222446, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.17012766728688, "num_env_steps_trained_throughput_per_sec": 84.17012766728688, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 51423.937, "restore_workers_time_ms": 0.016, "training_step_time_ms": 51423.826, "sample_time_ms": 2732.585, "learn_time_ms": 48665.663, "learn_throughput": 82.193, "synch_weights_time_ms": 19.844}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "35fb9_00000", "date": "2024-08-22_08-17-01", "timestamp": 1724294821, "time_this_iter_s": 47.57491397857666, "time_total_s": 1400.1065301895142, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc899d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1400.1065301895142, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 25.54029850746269, "ram_util_percent": 82.1194029850746}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.841772439681664, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.083816009602218, "policy_loss": -0.024180302514187086, "vf_loss": 8.104732361546269, "vf_explained_var": 0.33785778760279295, "kl": 0.016319695900430874, "entropy": 1.0767921040613184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.792112906332369, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.7966205122609615, "policy_loss": -0.01865004354807001, "vf_loss": 7.812791821817872, "vf_explained_var": 0.35557471132152296, "kl": 0.01239379862047456, "entropy": 0.7319442497990118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 607.9707972062336, "episode_reward_min": -0.5955299915837164, "episode_reward_mean": 235.27121119033677, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1492.5016445164706, "predator_policy": 3.9305265661439606}, "policy_reward_max": {"prey_policy": 323.4398347874944, "predator_policy": 1390.4831394698572}, "policy_reward_mean": {"prey_policy": -685.0340998850469, "predator_policy": 802.6697054802155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.89999999999813, 208.58255945567947, 292.8458169184529, 76.27455375695264, 131.96844193270658, 494.0140965507436, 59.855766229254925, 105.95793749906986, 326.9942188456947, 444.8549006728437, 538.8474741436634, 287.774171657955, 256.8449040966143, 337.9115295566252, 89.35381624562923, 327.19972939317904, 539.1619804464602, 143.5187370132804, 396.74114925431473, 60.24046543091819, 278.26982231911256, 413.9291942605116, 269.86435383351227, 489.7411115428039, 239.9031235179449, 13.239488809782397, 184.74154597486333, 360.11280643467313, 211.702713444255, 364.46519957686877, 231.04778259174623, 607.9707972062336, 238.4948852076862, 272.0417548303233, 15.408539540546098, 329.22558735284616, 83.936454206121, 107.7053405122855, 340.69062385583186, 350.08117817081774, 302.3959402398085, 95.6248167356442, 103.44099677459667, 168.28164429103344, 166.89413160198345, 315.95686767653586, 530.7841843170864, 291.46394588394253, 19.521012703243514, 53.39724465776257, 321.0361903306856, 359.08356827094747, 253.69922056138049, 45.2576636228842, 602.9222905175568, 54.3130017147017, 189.58971419332036, 72.32160991130543, 279.92731458015453, 40.96169880513431, 383.9048128494726, 359.17135036424304, 298.4397619410134, 433.7974910997259, 167.19387840730906, 30.214096284130825, 513.0067013786834, 142.57349917804842, 382.2270490849362, 90.74990508499701, 362.15019634536867, 361.72834830877815, 3.89570220896076, 26.0000000000001, 9.05799588476716, 30.880378903827896, 184.78521288502182, 97.16156274622303, 134.9705436101389, 291.7281893218326, 539.852508314432, 397.8516584419797, 223.48727458644095, 155.6568152656098, 308.28895570560627, 238.6367453621083, 206.93016296232815, 241.3653308483623, 244.53690714370452, 43.13979642377107, -0.5955299915837164, 85.61515519412544, 223.29910725422337, 365.7412097859951, 20.46538523146517, 386.4331723563776, 35.610704072035006, 368.0871626092377, 117.99431190146842, 35.79999999999989], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-457.77463328561805, 33.74792389404083, -751.7551921563154, -669.0314476076404, -748.9835482909266, -336.6833312305238, -753.7596004071332, -1068.9050804787585, -1017.3506038461142, -605.2326389309587, -250.62302083830423, -551.6687414077346, -1165.554070568206, -678.5237651410367, -934.7445039914603, -585.6766124860462, -286.95618171676097, -405.0917017950269, -880.897459562582, 64.31002004899398, -245.26715703206543, 86.64818881101354, -569.7202834523031, -50.78422113363174, -912.1562939236668, -433.7798316015763, -365.4640095028954, -906.0132207428646, -95.29254202226849, -1275.0828792693085, -226.18371777603528, -459.5634166254683, 228.057549587932, -823.3005074752604, -407.3505307075218, -936.0561609704266, -562.3093996784143, -513.756669617369, -968.0509235307851, -56.89303868770372, -954.7376324340505, -651.2773661581565, -332.45332131365086, -94.17730442333361, -398.2498675961642, -990.7321206609673, -181.72484603869438, 58.8200203879087, -5.259245759952449, -702.7724079981833, -1053.9907769926035, -1168.57830171658, -880.4976634520642, -450.03277269184974, -544.4996739793537, -509.8472383114113, -743.2836216386565, -808.1899112269232, -1126.077129046147, 66.95381147352643, -667.1540828800106, -1090.70135773455, -368.0983375207618, -593.5813521987848, 72.81395209161029, -992.459920427761, -816.1640998461643, -602.508854963149, -1026.2499129521736, -1094.5566796576186, -603.4166913328571, -439.045442974626, -965.5435275241133, -772.6889049781014, -947.4964049172441, -775.2777269743243, -426.00821170024165, -916.0860758654425, -319.91032361124064, -293.4537514848712, -1126.0202263062731, -605.8350002807175, -512.7066963354526, -877.552811048387, -1045.8824367791997, -836.4840294074826, -945.8657666238561, -756.1698461366406, -748.3343952029009, -1011.1557477373069, -1247.0618973033663, 89.4592857822081, -51.202029897388485, 35.15247493287871, -593.4239160872826, -402.24559874582394, -946.9547224286658, -1012.6647164674591, -1157.7363232225769, -399.6726219238579, -307.67673513019287, -877.889765446061, -1067.1703252801296, -16.888749733734212, -652.9844026057203, -994.685892414591, -1081.223660419167, -958.409831463417, -29.152706840535245, 107.24326701805336, -1033.8564824314703, -1215.3313312045427, -632.9344180429244, -864.901052610299, -733.9486516182983, -832.1524574478537, -186.99275056219466, -1118.2095802640922, -984.4431114388829, -616.4660086650465, -861.0045195369079, -344.59719516826283, -865.6794994514989, 323.4398347874944, -1060.826763044055, -40.07425851264159, 274.40009336620926, -1163.982567924634, -1016.7460607263803, 35.31839965526176, -1227.9516858546888, -762.8358305558595, -910.4844743932902, -164.6272098504818, -604.0603157384318, -986.0085127105568, -319.34477023836234, -604.5656171079115, -1002.3372681338918, -899.7621872546063, -177.50571692954543, -913.3482997488327, -310.780558720694, -831.0819066040481, -1308.5019246126876, -1196.89037804246, -568.1733096697529, -802.9297461739687, -962.4167581083608, -1058.1936950152538, -962.7778811899381, -1081.7182714310402, -1067.7434642275396, -106.88165387891964, -1009.2580694603854, -1253.0976453676838, 37.69668290996896, -1288.5853023168986, -847.0461263813007, -45.60646176370409, 288.6644834992129, -1051.362301357838, 252.43862639627457, -1008.0761600389992, -1492.5016445164706, -942.2958955614924, -836.57168054207, -710.603357693487, -1100.774409187776, -688.7123781404244, -741.1513694296151, -622.1306896799083, -626.5543495480533, -1067.9299905680716, -746.3620200414009, -669.108224168909, -825.3670547732409, -1132.755421501261, -1151.8929303507527, -1150.9476367803181, -1332.7494047400505, -1242.8707568087736, -770.43703104435, -908.6581406721878, -845.2973849918408, -666.6166455259892, -533.8658950441563, -1089.6402901400659, -1340.4093217185439, -992.990794499597, -839.00441318795, -368.0660495535674, -1127.674187866734, -924.3217217882932, 36.76800744374211, -1051.9374375332395, -858.3716871576815, -836.4203857956617, -1041.1079978043197, -1390.4831394698572], "policy_predator_policy_reward": [8.273635503573587, 612.6530738880039, 818.3626325700884, 811.006566649546, 558.3995579188444, 820.1131385210581, 1013.1716327397862, 885.7676019030587, 1046.1894314734561, 708.3622532363252, 642.9423781409789, 653.3634806558057, 1168.2748079619773, 735.6587939765202, 660.1910607700376, 966.1879932065385, 491.3594892053583, 527.6826131521244, 291.0489671085476, 970.3933730778843, 240.46566474278222, 457.00077762193274, 407.95433966365374, 500.32433658023575, 804.5078146437746, 798.2732149780834, 813.1881804503236, 796.2005793520617, 184.64635826789754, 1275.0828792693085, 988.8798329242184, 24.067030870465477, 214.48588544895944, 919.9190528848299, 585.4189228249439, 901.5065058662872, 467.0307762208858, 1005.7764423292128, 1047.5307419006583, 37.65368574874701, 1032.4116006222894, 851.873220289033, 204.5344953680054, 636.0253246294909, 903.0784785518124, 755.7678635388311, 310.35435267229235, 302.29158452129974, 14.576037030088798, 933.3587402459954, 1056.2302658023864, 1179.57830171658, 936.8799931810663, 578.3919889377112, 765.5905368112208, 648.869181914217, 896.7036792973088, 866.4725670125263, 346.92842914163396, 1076.6600880078545, 1024.9297848019355, 963.973438404374, 992.0626172410533, 577.5878696847296, 1064.1296095113373, 94.01124403249936, 953.8366720178456, 736.878037621789, 1038.9497960951694, 1097.265336055169, 871.2505415235942, 500.4371801367354, 803.1918174764155, 1018.9770692319199, 934.0634988236931, 896.4159735801608, 1067.251830000767, 615.5330814207507, 932.7028837878931, 30.742369479036192, 1118.1306135055163, 916.1205533212817, 534.7355564527957, 951.1487676666883, 955.0116827078186, 1030.795780253461, 1035.5412584334142, 834.7759986181161, 911.0708956792956, 1015.3133788628952, 612.7356137508659, 860.8238654468274, 499.4317710896683, 47.40196819192787, 490.5970700750862, 796.5363906419606, 960.0547224286655, 1019.0857291707027, 581.8920833186748, 1028.9141064855296, 952.0514313291854, 554.5512595777584, 1124.4055449913506, 318.73709829346075, 935.7593258608816, 965.61018972081, 1096.1546771441424, 988.7364783613268, 263.8550650562944, 260.97666528374447, 1070.4247201001906, 1233.0760952505275, 952.6224415809542, 734.8027432655906, 708.1828827460115, 930.239836231447, 457.3610059763905, 1127.7686394300508, 1005.143282027985, 636.7275368810782, 916.8968701869777, 672.6096573676652, 879.2283329365755, 22.18268209167235, 597.9934373184194, 801.3473461792918, 294.9273507185015, 1028.4526149396493, 778.6028014948038, 370.018737983625, 1228.324643684833, 792.6769690098461, 557.9812000096233, 1030.137185612832, 721.6091602654835, 1011.033167361555, 1014.6090367755537, 291.52839965565636, 1063.1994601683978, 929.6499003050965, 544.4687262051731, 908.5354868185738, 1077.5676731687936, 426.0231404647284, 1312.3555434873585, 1196.93246137675, 582.9733096697561, 814.1297461739713, 1044.1485937021494, 985.5198553062316, 976.6582600937668, 1098.7182714310402, 620.128868767951, 739.2814622235279, 1116.682945329678, 1242.8343322446142, 1062.8564104977936, 323.00275251927803, 1180.450250900694, 3.9305265661439606, 260.6544300510958, 1041.8958961219612, 197.94094960980095, 955.5482424749027, 1346.5533246102464, 1311.7314900541598, 1009.2719372477615, 693.5599162534062, 979.6997703870995, 1118.075972646708, 720.3097911715795, 881.6090133000528, 838.288089244753, 1063.1264138337003, 915.8074763824234, 741.0280986762486, 1134.6430251395295, 1068.0163582786774, 1092.1624759855627, 1253.8178875692804, 1331.8538747484668, 1243.1707568087736, 802.4037135231752, 962.3066133874877, 847.6559798478055, 887.5571579242472, 1079.8971136612497, 909.3502813089684, 1342.874245796453, 1010.9912556531533, 610.2309610006558, 983.2726740972396, 1171.2952504368568, 916.311363290205, 524.2186811089769, 859.0379115897565, 968.7659990591499, 844.0203857956618, 1076.9079978043196, 1390.4831394698572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.955609560467537, "mean_inference_ms": 4.576063238443518, "mean_action_processing_ms": 1.7558694279404812, "mean_env_wait_ms": 10.13375628712869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055876970291137695, "StateBufferConnector_ms": 0.00582432746887207, "ViewRequirementAgentConnector_ms": 0.18467020988464355}, "num_episodes": 10, "episode_return_max": 607.9707972062336, "episode_return_min": -0.5955299915837164, "episode_return_mean": 235.27121119033677, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.57196583151065, "num_env_steps_trained_throughput_per_sec": 84.57196583151065, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 50937.826, "restore_workers_time_ms": 0.016, "training_step_time_ms": 50937.715, "sample_time_ms": 2705.412, "learn_time_ms": 48206.759, "learn_throughput": 82.976, "synch_weights_time_ms": 19.591}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "35fb9_00000", "date": "2024-08-22_08-17-48", "timestamp": 1724294868, "time_this_iter_s": 47.3277051448822, "time_total_s": 1447.4342353343964, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcbdb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1447.4342353343964, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 27.252941176470586, "ram_util_percent": 82.68529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.374793211997503, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.992371836667338, "policy_loss": -0.02169668715503855, "vf_loss": 8.011110945353431, "vf_explained_var": 0.3422488157080595, "kl": 0.014787939558958723, "entropy": 1.101152209882383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.402459163135953, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.695692581852908, "policy_loss": -0.018809951306197534, "vf_loss": 7.712111287394529, "vf_explained_var": 0.42358373157561774, "kl": 0.01195619032735488, "entropy": 0.7828304173769774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 607.9707972062336, "episode_reward_min": -0.5955299915837164, "episode_reward_mean": 229.52325466866066, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1492.5016445164706, "predator_policy": 3.9305265661439606}, "policy_reward_max": {"prey_policy": 323.4398347874944, "predator_policy": 1390.4831394698572}, "policy_reward_mean": {"prey_policy": -713.0125759635686, "predator_policy": 827.7742032978989}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.9115295566252, 89.35381624562923, 327.19972939317904, 539.1619804464602, 143.5187370132804, 396.74114925431473, 60.24046543091819, 278.26982231911256, 413.9291942605116, 269.86435383351227, 489.7411115428039, 239.9031235179449, 13.239488809782397, 184.74154597486333, 360.11280643467313, 211.702713444255, 364.46519957686877, 231.04778259174623, 607.9707972062336, 238.4948852076862, 272.0417548303233, 15.408539540546098, 329.22558735284616, 83.936454206121, 107.7053405122855, 340.69062385583186, 350.08117817081774, 302.3959402398085, 95.6248167356442, 103.44099677459667, 168.28164429103344, 166.89413160198345, 315.95686767653586, 530.7841843170864, 291.46394588394253, 19.521012703243514, 53.39724465776257, 321.0361903306856, 359.08356827094747, 253.69922056138049, 45.2576636228842, 602.9222905175568, 54.3130017147017, 189.58971419332036, 72.32160991130543, 279.92731458015453, 40.96169880513431, 383.9048128494726, 359.17135036424304, 298.4397619410134, 433.7974910997259, 167.19387840730906, 30.214096284130825, 513.0067013786834, 142.57349917804842, 382.2270490849362, 90.74990508499701, 362.15019634536867, 361.72834830877815, 3.89570220896076, 26.0000000000001, 9.05799588476716, 30.880378903827896, 184.78521288502182, 97.16156274622303, 134.9705436101389, 291.7281893218326, 539.852508314432, 397.8516584419797, 223.48727458644095, 155.6568152656098, 308.28895570560627, 238.6367453621083, 206.93016296232815, 241.3653308483623, 244.53690714370452, 43.13979642377107, -0.5955299915837164, 85.61515519412544, 223.29910725422337, 365.7412097859951, 20.46538523146517, 386.4331723563776, 35.610704072035006, 368.0871626092377, 117.99431190146842, 35.79999999999989, 329.12174537623446, 269.548469111097, 530.1150699945186, 190.57768496807745, 98.3788368027139, 293.4556298513983, 364.65813167932527, 21.723624251570293, 13.536371190979274, 30.934129528086793, 293.8404852194577, 96.10511964865916, 314.9238919699011], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-365.4640095028954, -906.0132207428646, -95.29254202226849, -1275.0828792693085, -226.18371777603528, -459.5634166254683, 228.057549587932, -823.3005074752604, -407.3505307075218, -936.0561609704266, -562.3093996784143, -513.756669617369, -968.0509235307851, -56.89303868770372, -954.7376324340505, -651.2773661581565, -332.45332131365086, -94.17730442333361, -398.2498675961642, -990.7321206609673, -181.72484603869438, 58.8200203879087, -5.259245759952449, -702.7724079981833, -1053.9907769926035, -1168.57830171658, -880.4976634520642, -450.03277269184974, -544.4996739793537, -509.8472383114113, -743.2836216386565, -808.1899112269232, -1126.077129046147, 66.95381147352643, -667.1540828800106, -1090.70135773455, -368.0983375207618, -593.5813521987848, 72.81395209161029, -992.459920427761, -816.1640998461643, -602.508854963149, -1026.2499129521736, -1094.5566796576186, -603.4166913328571, -439.045442974626, -965.5435275241133, -772.6889049781014, -947.4964049172441, -775.2777269743243, -426.00821170024165, -916.0860758654425, -319.91032361124064, -293.4537514848712, -1126.0202263062731, -605.8350002807175, -512.7066963354526, -877.552811048387, -1045.8824367791997, -836.4840294074826, -945.8657666238561, -756.1698461366406, -748.3343952029009, -1011.1557477373069, -1247.0618973033663, 89.4592857822081, -51.202029897388485, 35.15247493287871, -593.4239160872826, -402.24559874582394, -946.9547224286658, -1012.6647164674591, -1157.7363232225769, -399.6726219238579, -307.67673513019287, -877.889765446061, -1067.1703252801296, -16.888749733734212, -652.9844026057203, -994.685892414591, -1081.223660419167, -958.409831463417, -29.152706840535245, 107.24326701805336, -1033.8564824314703, -1215.3313312045427, -632.9344180429244, -864.901052610299, -733.9486516182983, -832.1524574478537, -186.99275056219466, -1118.2095802640922, -984.4431114388829, -616.4660086650465, -861.0045195369079, -344.59719516826283, -865.6794994514989, 323.4398347874944, -1060.826763044055, -40.07425851264159, 274.40009336620926, -1163.982567924634, -1016.7460607263803, 35.31839965526176, -1227.9516858546888, -762.8358305558595, -910.4844743932902, -164.6272098504818, -604.0603157384318, -986.0085127105568, -319.34477023836234, -604.5656171079115, -1002.3372681338918, -899.7621872546063, -177.50571692954543, -913.3482997488327, -310.780558720694, -831.0819066040481, -1308.5019246126876, -1196.89037804246, -568.1733096697529, -802.9297461739687, -962.4167581083608, -1058.1936950152538, -962.7778811899381, -1081.7182714310402, -1067.7434642275396, -106.88165387891964, -1009.2580694603854, -1253.0976453676838, 37.69668290996896, -1288.5853023168986, -847.0461263813007, -45.60646176370409, 288.6644834992129, -1051.362301357838, 252.43862639627457, -1008.0761600389992, -1492.5016445164706, -942.2958955614924, -836.57168054207, -710.603357693487, -1100.774409187776, -688.7123781404244, -741.1513694296151, -622.1306896799083, -626.5543495480533, -1067.9299905680716, -746.3620200414009, -669.108224168909, -825.3670547732409, -1132.755421501261, -1151.8929303507527, -1150.9476367803181, -1332.7494047400505, -1242.8707568087736, -770.43703104435, -908.6581406721878, -845.2973849918408, -666.6166455259892, -533.8658950441563, -1089.6402901400659, -1340.4093217185439, -992.990794499597, -839.00441318795, -368.0660495535674, -1127.674187866734, -924.3217217882932, 36.76800744374211, -1051.9374375332395, -858.3716871576815, -836.4203857956617, -1041.1079978043197, -1390.4831394698572, -866.3656651362168, -959.9312184145358, -1205.2420416727869, -297.64314496968785, 152.8723237658262, -929.2399552316195, -1012.1949681279489, -280.85798653963184, -859.8265048260404, -1143.7260921694046, -385.3302755475502, -149.83025489782236, -434.3050720116926, -314.37966924396505, -1067.8487030478468, -1165.705772155972, -1136.7396546689622, -1093.8107603517383, -1315.5191785422564, -973.6291739937041, -1232.6451110154255, -331.4891195683923, -969.601340383899, -733.5797513718973, 61.94468311709932, -1127.2845968285812], "policy_predator_policy_reward": [813.1881804503236, 796.2005793520617, 184.64635826789754, 1275.0828792693085, 988.8798329242184, 24.067030870465477, 214.48588544895944, 919.9190528848299, 585.4189228249439, 901.5065058662872, 467.0307762208858, 1005.7764423292128, 1047.5307419006583, 37.65368574874701, 1032.4116006222894, 851.873220289033, 204.5344953680054, 636.0253246294909, 903.0784785518124, 755.7678635388311, 310.35435267229235, 302.29158452129974, 14.576037030088798, 933.3587402459954, 1056.2302658023864, 1179.57830171658, 936.8799931810663, 578.3919889377112, 765.5905368112208, 648.869181914217, 896.7036792973088, 866.4725670125263, 346.92842914163396, 1076.6600880078545, 1024.9297848019355, 963.973438404374, 992.0626172410533, 577.5878696847296, 1064.1296095113373, 94.01124403249936, 953.8366720178456, 736.878037621789, 1038.9497960951694, 1097.265336055169, 871.2505415235942, 500.4371801367354, 803.1918174764155, 1018.9770692319199, 934.0634988236931, 896.4159735801608, 1067.251830000767, 615.5330814207507, 932.7028837878931, 30.742369479036192, 1118.1306135055163, 916.1205533212817, 534.7355564527957, 951.1487676666883, 955.0116827078186, 1030.795780253461, 1035.5412584334142, 834.7759986181161, 911.0708956792956, 1015.3133788628952, 612.7356137508659, 860.8238654468274, 499.4317710896683, 47.40196819192787, 490.5970700750862, 796.5363906419606, 960.0547224286655, 1019.0857291707027, 581.8920833186748, 1028.9141064855296, 952.0514313291854, 554.5512595777584, 1124.4055449913506, 318.73709829346075, 935.7593258608816, 965.61018972081, 1096.1546771441424, 988.7364783613268, 263.8550650562944, 260.97666528374447, 1070.4247201001906, 1233.0760952505275, 952.6224415809542, 734.8027432655906, 708.1828827460115, 930.239836231447, 457.3610059763905, 1127.7686394300508, 1005.143282027985, 636.7275368810782, 916.8968701869777, 672.6096573676652, 879.2283329365755, 22.18268209167235, 597.9934373184194, 801.3473461792918, 294.9273507185015, 1028.4526149396493, 778.6028014948038, 370.018737983625, 1228.324643684833, 792.6769690098461, 557.9812000096233, 1030.137185612832, 721.6091602654835, 1011.033167361555, 1014.6090367755537, 291.52839965565636, 1063.1994601683978, 929.6499003050965, 544.4687262051731, 908.5354868185738, 1077.5676731687936, 426.0231404647284, 1312.3555434873585, 1196.93246137675, 582.9733096697561, 814.1297461739713, 1044.1485937021494, 985.5198553062316, 976.6582600937668, 1098.7182714310402, 620.128868767951, 739.2814622235279, 1116.682945329678, 1242.8343322446142, 1062.8564104977936, 323.00275251927803, 1180.450250900694, 3.9305265661439606, 260.6544300510958, 1041.8958961219612, 197.94094960980095, 955.5482424749027, 1346.5533246102464, 1311.7314900541598, 1009.2719372477615, 693.5599162534062, 979.6997703870995, 1118.075972646708, 720.3097911715795, 881.6090133000528, 838.288089244753, 1063.1264138337003, 915.8074763824234, 741.0280986762486, 1134.6430251395295, 1068.0163582786774, 1092.1624759855627, 1253.8178875692804, 1331.8538747484668, 1243.1707568087736, 802.4037135231752, 962.3066133874877, 847.6559798478055, 887.5571579242472, 1079.8971136612497, 909.3502813089684, 1342.874245796453, 1010.9912556531533, 610.2309610006558, 983.2726740972396, 1171.2952504368568, 916.311363290205, 524.2186811089769, 859.0379115897565, 968.7659990591499, 844.0203857956618, 1076.9079978043196, 1390.4831394698572, 1176.5412924752418, 978.8773364517452, 1197.393558854839, 575.0400968987351, 387.3670275824382, 919.1156738778742, 1021.9558733567608, 461.67476627889914, 1097.3680473252286, 1004.56338647293, 357.09645862731514, 471.51970166945375, 561.5044182720998, 551.8384546628839, 1087.8412810064528, 1167.4368184489379, 1141.719312443752, 1102.3674737679275, 1113.950452145719, 1206.1320299183285, 1229.554383091059, 628.4203327122161, 815.8073363513953, 983.478875053061, 1178.5431372766327, 201.7206684047501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.979511492649238, "mean_inference_ms": 4.575400819957938, "mean_action_processing_ms": 1.774666129494912, "mean_env_wait_ms": 10.160123262710956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008192896842956543, "StateBufferConnector_ms": 0.005961060523986816, "ViewRequirementAgentConnector_ms": 0.18214035034179688}, "num_episodes": 13, "episode_return_max": 607.9707972062336, "episode_return_min": -0.5955299915837164, "episode_return_mean": 229.52325466866066, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.47871306291142, "num_env_steps_trained_throughput_per_sec": 83.47871306291142, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 50612.19, "restore_workers_time_ms": 0.016, "training_step_time_ms": 50612.057, "sample_time_ms": 2723.119, "learn_time_ms": 47863.475, "learn_throughput": 83.571, "synch_weights_time_ms": 19.321}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "35fb9_00000", "date": "2024-08-22_08-18-36", "timestamp": 1724294916, "time_this_iter_s": 47.93440508842468, "time_total_s": 1495.368640422821, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc89670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1495.368640422821, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.308823529411764, "ram_util_percent": 83.06617647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.272473162885696, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.77611877501957, "policy_loss": -0.02056044107266066, "vf_loss": 7.793587456052266, "vf_explained_var": 0.2567007692087264, "kl": 0.015458827136360384, "entropy": 1.070636089989748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.555986891852484, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.018038318775318, "policy_loss": -0.018864642596488238, "vf_loss": 8.034169798301011, "vf_explained_var": 0.3338364666416532, "kl": 0.013665871576420845, "entropy": 0.753561299282407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 624.1799640455768, "episode_reward_min": -0.5955299915837164, "episode_reward_mean": 217.84990096078644, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1492.5016445164706, "predator_policy": 3.9305265661439606}, "policy_reward_max": {"prey_policy": 323.4398347874944, "predator_policy": 1390.4831394698572}, "policy_reward_mean": {"prey_policy": -744.8232414316287, "predator_policy": 853.7481919120222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.239488809782397, 184.74154597486333, 360.11280643467313, 211.702713444255, 364.46519957686877, 231.04778259174623, 607.9707972062336, 238.4948852076862, 272.0417548303233, 15.408539540546098, 329.22558735284616, 83.936454206121, 107.7053405122855, 340.69062385583186, 350.08117817081774, 302.3959402398085, 95.6248167356442, 103.44099677459667, 168.28164429103344, 166.89413160198345, 315.95686767653586, 530.7841843170864, 291.46394588394253, 19.521012703243514, 53.39724465776257, 321.0361903306856, 359.08356827094747, 253.69922056138049, 45.2576636228842, 602.9222905175568, 54.3130017147017, 189.58971419332036, 72.32160991130543, 279.92731458015453, 40.96169880513431, 383.9048128494726, 359.17135036424304, 298.4397619410134, 433.7974910997259, 167.19387840730906, 30.214096284130825, 513.0067013786834, 142.57349917804842, 382.2270490849362, 90.74990508499701, 362.15019634536867, 361.72834830877815, 3.89570220896076, 26.0000000000001, 9.05799588476716, 30.880378903827896, 184.78521288502182, 97.16156274622303, 134.9705436101389, 291.7281893218326, 539.852508314432, 397.8516584419797, 223.48727458644095, 155.6568152656098, 308.28895570560627, 238.6367453621083, 206.93016296232815, 241.3653308483623, 244.53690714370452, 43.13979642377107, -0.5955299915837164, 85.61515519412544, 223.29910725422337, 365.7412097859951, 20.46538523146517, 386.4331723563776, 35.610704072035006, 368.0871626092377, 117.99431190146842, 35.79999999999989, 329.12174537623446, 269.548469111097, 530.1150699945186, 190.57768496807745, 98.3788368027139, 293.4556298513983, 364.65813167932527, 21.723624251570293, 13.536371190979274, 30.934129528086793, 293.8404852194577, 96.10511964865916, 314.9238919699011, 180.73873419839006, 462.5682157612234, 27.695973337486997, 206.76632386062147, 4.685502285455671, 27.712678125181764, 624.1799640455768, 275.69170081527085, 419.5267505245731, 49.99999999999996, 6.116778274515148, 132.81702079857422], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1053.9907769926035, -1168.57830171658, -880.4976634520642, -450.03277269184974, -544.4996739793537, -509.8472383114113, -743.2836216386565, -808.1899112269232, -1126.077129046147, 66.95381147352643, -667.1540828800106, -1090.70135773455, -368.0983375207618, -593.5813521987848, 72.81395209161029, -992.459920427761, -816.1640998461643, -602.508854963149, -1026.2499129521736, -1094.5566796576186, -603.4166913328571, -439.045442974626, -965.5435275241133, -772.6889049781014, -947.4964049172441, -775.2777269743243, -426.00821170024165, -916.0860758654425, -319.91032361124064, -293.4537514848712, -1126.0202263062731, -605.8350002807175, -512.7066963354526, -877.552811048387, -1045.8824367791997, -836.4840294074826, -945.8657666238561, -756.1698461366406, -748.3343952029009, -1011.1557477373069, -1247.0618973033663, 89.4592857822081, -51.202029897388485, 35.15247493287871, -593.4239160872826, -402.24559874582394, -946.9547224286658, -1012.6647164674591, -1157.7363232225769, -399.6726219238579, -307.67673513019287, -877.889765446061, -1067.1703252801296, -16.888749733734212, -652.9844026057203, -994.685892414591, -1081.223660419167, -958.409831463417, -29.152706840535245, 107.24326701805336, -1033.8564824314703, -1215.3313312045427, -632.9344180429244, -864.901052610299, -733.9486516182983, -832.1524574478537, -186.99275056219466, -1118.2095802640922, -984.4431114388829, -616.4660086650465, -861.0045195369079, -344.59719516826283, -865.6794994514989, 323.4398347874944, -1060.826763044055, -40.07425851264159, 274.40009336620926, -1163.982567924634, -1016.7460607263803, 35.31839965526176, -1227.9516858546888, -762.8358305558595, -910.4844743932902, -164.6272098504818, -604.0603157384318, -986.0085127105568, -319.34477023836234, -604.5656171079115, -1002.3372681338918, -899.7621872546063, -177.50571692954543, -913.3482997488327, -310.780558720694, -831.0819066040481, -1308.5019246126876, -1196.89037804246, -568.1733096697529, -802.9297461739687, -962.4167581083608, -1058.1936950152538, -962.7778811899381, -1081.7182714310402, -1067.7434642275396, -106.88165387891964, -1009.2580694603854, -1253.0976453676838, 37.69668290996896, -1288.5853023168986, -847.0461263813007, -45.60646176370409, 288.6644834992129, -1051.362301357838, 252.43862639627457, -1008.0761600389992, -1492.5016445164706, -942.2958955614924, -836.57168054207, -710.603357693487, -1100.774409187776, -688.7123781404244, -741.1513694296151, -622.1306896799083, -626.5543495480533, -1067.9299905680716, -746.3620200414009, -669.108224168909, -825.3670547732409, -1132.755421501261, -1151.8929303507527, -1150.9476367803181, -1332.7494047400505, -1242.8707568087736, -770.43703104435, -908.6581406721878, -845.2973849918408, -666.6166455259892, -533.8658950441563, -1089.6402901400659, -1340.4093217185439, -992.990794499597, -839.00441318795, -368.0660495535674, -1127.674187866734, -924.3217217882932, 36.76800744374211, -1051.9374375332395, -858.3716871576815, -836.4203857956617, -1041.1079978043197, -1390.4831394698572, -866.3656651362168, -959.9312184145358, -1205.2420416727869, -297.64314496968785, 152.8723237658262, -929.2399552316195, -1012.1949681279489, -280.85798653963184, -859.8265048260404, -1143.7260921694046, -385.3302755475502, -149.83025489782236, -434.3050720116926, -314.37966924396505, -1067.8487030478468, -1165.705772155972, -1136.7396546689622, -1093.8107603517383, -1315.5191785422564, -973.6291739937041, -1232.6451110154255, -331.4891195683923, -969.601340383899, -733.5797513718973, 61.94468311709932, -1127.2845968285812, -1127.3919302613426, -571.7458419867271, -1421.1595134025292, 85.66788960067468, -1035.6338577851766, -534.3601500535975, -559.6159236702973, -1199.6492075780025, -1024.1169313062426, -1089.3625153711462, -322.86181388257694, -1132.8626560227508, 282.99822183565755, -840.4457101430698, 102.91299990456788, -1175.6574906427188, -808.1760622927474, -248.82050473887784, -1238.5815615683807, -1090.811321172447, -1091.5371345657143, -969.8349805957108, -80.36030866135998, -890.5503482651658], "policy_predator_policy_reward": [1056.2302658023864, 1179.57830171658, 936.8799931810663, 578.3919889377112, 765.5905368112208, 648.869181914217, 896.7036792973088, 866.4725670125263, 346.92842914163396, 1076.6600880078545, 1024.9297848019355, 963.973438404374, 992.0626172410533, 577.5878696847296, 1064.1296095113373, 94.01124403249936, 953.8366720178456, 736.878037621789, 1038.9497960951694, 1097.265336055169, 871.2505415235942, 500.4371801367354, 803.1918174764155, 1018.9770692319199, 934.0634988236931, 896.4159735801608, 1067.251830000767, 615.5330814207507, 932.7028837878931, 30.742369479036192, 1118.1306135055163, 916.1205533212817, 534.7355564527957, 951.1487676666883, 955.0116827078186, 1030.795780253461, 1035.5412584334142, 834.7759986181161, 911.0708956792956, 1015.3133788628952, 612.7356137508659, 860.8238654468274, 499.4317710896683, 47.40196819192787, 490.5970700750862, 796.5363906419606, 960.0547224286655, 1019.0857291707027, 581.8920833186748, 1028.9141064855296, 952.0514313291854, 554.5512595777584, 1124.4055449913506, 318.73709829346075, 935.7593258608816, 965.61018972081, 1096.1546771441424, 988.7364783613268, 263.8550650562944, 260.97666528374447, 1070.4247201001906, 1233.0760952505275, 952.6224415809542, 734.8027432655906, 708.1828827460115, 930.239836231447, 457.3610059763905, 1127.7686394300508, 1005.143282027985, 636.7275368810782, 916.8968701869777, 672.6096573676652, 879.2283329365755, 22.18268209167235, 597.9934373184194, 801.3473461792918, 294.9273507185015, 1028.4526149396493, 778.6028014948038, 370.018737983625, 1228.324643684833, 792.6769690098461, 557.9812000096233, 1030.137185612832, 721.6091602654835, 1011.033167361555, 1014.6090367755537, 291.52839965565636, 1063.1994601683978, 929.6499003050965, 544.4687262051731, 908.5354868185738, 1077.5676731687936, 426.0231404647284, 1312.3555434873585, 1196.93246137675, 582.9733096697561, 814.1297461739713, 1044.1485937021494, 985.5198553062316, 976.6582600937668, 1098.7182714310402, 620.128868767951, 739.2814622235279, 1116.682945329678, 1242.8343322446142, 1062.8564104977936, 323.00275251927803, 1180.450250900694, 3.9305265661439606, 260.6544300510958, 1041.8958961219612, 197.94094960980095, 955.5482424749027, 1346.5533246102464, 1311.7314900541598, 1009.2719372477615, 693.5599162534062, 979.6997703870995, 1118.075972646708, 720.3097911715795, 881.6090133000528, 838.288089244753, 1063.1264138337003, 915.8074763824234, 741.0280986762486, 1134.6430251395295, 1068.0163582786774, 1092.1624759855627, 1253.8178875692804, 1331.8538747484668, 1243.1707568087736, 802.4037135231752, 962.3066133874877, 847.6559798478055, 887.5571579242472, 1079.8971136612497, 909.3502813089684, 1342.874245796453, 1010.9912556531533, 610.2309610006558, 983.2726740972396, 1171.2952504368568, 916.311363290205, 524.2186811089769, 859.0379115897565, 968.7659990591499, 844.0203857956618, 1076.9079978043196, 1390.4831394698572, 1176.5412924752418, 978.8773364517452, 1197.393558854839, 575.0400968987351, 387.3670275824382, 919.1156738778742, 1021.9558733567608, 461.67476627889914, 1097.3680473252286, 1004.56338647293, 357.09645862731514, 471.51970166945375, 561.5044182720998, 551.8384546628839, 1087.8412810064528, 1167.4368184489379, 1141.719312443752, 1102.3674737679275, 1113.950452145719, 1206.1320299183285, 1229.554383091059, 628.4203327122161, 815.8073363513953, 983.478875053061, 1178.5431372766327, 201.7206684047501, 795.3278771225168, 1084.5486293239417, 1304.7987690341806, 493.2610705288984, 1037.9338577851772, 559.756123391088, 927.3048045552528, 1038.7266505536707, 1026.5169313062427, 1091.6480176566013, 974.4838846683937, 508.9532633621246, 733.7036870158325, 447.9237653371547, 911.4057039071257, 437.03048764629506, 897.8730866993827, 578.6502308568148, 1245.5815615683807, 1133.8113211724472, 1097.1564389126038, 970.3324545233364, 1091.1106569265241, 12.61702079857614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.92437818178399, "mean_inference_ms": 4.569381172402609, "mean_action_processing_ms": 1.7373894050579428, "mean_env_wait_ms": 10.179114902925791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007936716079711914, "StateBufferConnector_ms": 0.005069255828857422, "ViewRequirementAgentConnector_ms": 0.1729748249053955}, "num_episodes": 12, "episode_return_max": 624.1799640455768, "episode_return_min": -0.5955299915837164, "episode_return_mean": 217.84990096078644, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.16672624970501, "num_env_steps_trained_throughput_per_sec": 76.16672624970501, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 50677.337, "restore_workers_time_ms": 0.016, "training_step_time_ms": 50677.222, "sample_time_ms": 2741.019, "learn_time_ms": 47911.549, "learn_throughput": 83.487, "synch_weights_time_ms": 19.212}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "35fb9_00000", "date": "2024-08-22_08-19-29", "timestamp": 1724294969, "time_this_iter_s": 52.562572956085205, "time_total_s": 1547.9312133789062, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b5e7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1547.9312133789062, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 36.86351351351352, "ram_util_percent": 82.82162162162162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.24582214733911, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.600601644616909, "policy_loss": -0.01899495144773807, "vf_loss": 7.616540453169081, "vf_explained_var": 0.3228677545275007, "kl": 0.015280763804666185, "entropy": 1.0221786721988961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.89976694091918, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.655564049816636, "policy_loss": -0.018862450584552434, "vf_loss": 7.671704529706763, "vf_explained_var": 0.38137210837747687, "kl": 0.013609890800669159, "entropy": 0.7051306744101187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 624.1799640455768, "episode_reward_min": -0.5955299915837164, "episode_reward_mean": 208.52199339423635, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1492.5016445164706, "predator_policy": 3.9305265661439606}, "policy_reward_max": {"prey_policy": 323.4398347874944, "predator_policy": 1434.6506305461653}, "policy_reward_mean": {"prey_policy": -756.9155681910498, "predator_policy": 861.1765648881684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [107.7053405122855, 340.69062385583186, 350.08117817081774, 302.3959402398085, 95.6248167356442, 103.44099677459667, 168.28164429103344, 166.89413160198345, 315.95686767653586, 530.7841843170864, 291.46394588394253, 19.521012703243514, 53.39724465776257, 321.0361903306856, 359.08356827094747, 253.69922056138049, 45.2576636228842, 602.9222905175568, 54.3130017147017, 189.58971419332036, 72.32160991130543, 279.92731458015453, 40.96169880513431, 383.9048128494726, 359.17135036424304, 298.4397619410134, 433.7974910997259, 167.19387840730906, 30.214096284130825, 513.0067013786834, 142.57349917804842, 382.2270490849362, 90.74990508499701, 362.15019634536867, 361.72834830877815, 3.89570220896076, 26.0000000000001, 9.05799588476716, 30.880378903827896, 184.78521288502182, 97.16156274622303, 134.9705436101389, 291.7281893218326, 539.852508314432, 397.8516584419797, 223.48727458644095, 155.6568152656098, 308.28895570560627, 238.6367453621083, 206.93016296232815, 241.3653308483623, 244.53690714370452, 43.13979642377107, -0.5955299915837164, 85.61515519412544, 223.29910725422337, 365.7412097859951, 20.46538523146517, 386.4331723563776, 35.610704072035006, 368.0871626092377, 117.99431190146842, 35.79999999999989, 329.12174537623446, 269.548469111097, 530.1150699945186, 190.57768496807745, 98.3788368027139, 293.4556298513983, 364.65813167932527, 21.723624251570293, 13.536371190979274, 30.934129528086793, 293.8404852194577, 96.10511964865916, 314.9238919699011, 180.73873419839006, 462.5682157612234, 27.695973337486997, 206.76632386062147, 4.685502285455671, 27.712678125181764, 624.1799640455768, 275.69170081527085, 419.5267505245731, 49.99999999999996, 6.116778274515148, 132.81702079857422, 102.88880312459129, 335.6278724266723, 82.80773031873045, 478.40849076526763, -1.0658141036401503e-14, 35.5389570509545, 472.92134814121454, 12.99803839362955, 83.83802286480234, 308.6972336320149, 63.29054530003693, 2.5797565030212706], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-947.4964049172441, -775.2777269743243, -426.00821170024165, -916.0860758654425, -319.91032361124064, -293.4537514848712, -1126.0202263062731, -605.8350002807175, -512.7066963354526, -877.552811048387, -1045.8824367791997, -836.4840294074826, -945.8657666238561, -756.1698461366406, -748.3343952029009, -1011.1557477373069, -1247.0618973033663, 89.4592857822081, -51.202029897388485, 35.15247493287871, -593.4239160872826, -402.24559874582394, -946.9547224286658, -1012.6647164674591, -1157.7363232225769, -399.6726219238579, -307.67673513019287, -877.889765446061, -1067.1703252801296, -16.888749733734212, -652.9844026057203, -994.685892414591, -1081.223660419167, -958.409831463417, -29.152706840535245, 107.24326701805336, -1033.8564824314703, -1215.3313312045427, -632.9344180429244, -864.901052610299, -733.9486516182983, -832.1524574478537, -186.99275056219466, -1118.2095802640922, -984.4431114388829, -616.4660086650465, -861.0045195369079, -344.59719516826283, -865.6794994514989, 323.4398347874944, -1060.826763044055, -40.07425851264159, 274.40009336620926, -1163.982567924634, -1016.7460607263803, 35.31839965526176, -1227.9516858546888, -762.8358305558595, -910.4844743932902, -164.6272098504818, -604.0603157384318, -986.0085127105568, -319.34477023836234, -604.5656171079115, -1002.3372681338918, -899.7621872546063, -177.50571692954543, -913.3482997488327, -310.780558720694, -831.0819066040481, -1308.5019246126876, -1196.89037804246, -568.1733096697529, -802.9297461739687, -962.4167581083608, -1058.1936950152538, -962.7778811899381, -1081.7182714310402, -1067.7434642275396, -106.88165387891964, -1009.2580694603854, -1253.0976453676838, 37.69668290996896, -1288.5853023168986, -847.0461263813007, -45.60646176370409, 288.6644834992129, -1051.362301357838, 252.43862639627457, -1008.0761600389992, -1492.5016445164706, -942.2958955614924, -836.57168054207, -710.603357693487, -1100.774409187776, -688.7123781404244, -741.1513694296151, -622.1306896799083, -626.5543495480533, -1067.9299905680716, -746.3620200414009, -669.108224168909, -825.3670547732409, -1132.755421501261, -1151.8929303507527, -1150.9476367803181, -1332.7494047400505, -1242.8707568087736, -770.43703104435, -908.6581406721878, -845.2973849918408, -666.6166455259892, -533.8658950441563, -1089.6402901400659, -1340.4093217185439, -992.990794499597, -839.00441318795, -368.0660495535674, -1127.674187866734, -924.3217217882932, 36.76800744374211, -1051.9374375332395, -858.3716871576815, -836.4203857956617, -1041.1079978043197, -1390.4831394698572, -866.3656651362168, -959.9312184145358, -1205.2420416727869, -297.64314496968785, 152.8723237658262, -929.2399552316195, -1012.1949681279489, -280.85798653963184, -859.8265048260404, -1143.7260921694046, -385.3302755475502, -149.83025489782236, -434.3050720116926, -314.37966924396505, -1067.8487030478468, -1165.705772155972, -1136.7396546689622, -1093.8107603517383, -1315.5191785422564, -973.6291739937041, -1232.6451110154255, -331.4891195683923, -969.601340383899, -733.5797513718973, 61.94468311709932, -1127.2845968285812, -1127.3919302613426, -571.7458419867271, -1421.1595134025292, 85.66788960067468, -1035.6338577851766, -534.3601500535975, -559.6159236702973, -1199.6492075780025, -1024.1169313062426, -1089.3625153711462, -322.86181388257694, -1132.8626560227508, 282.99822183565755, -840.4457101430698, 102.91299990456788, -1175.6574906427188, -808.1760622927474, -248.82050473887784, -1238.5815615683807, -1090.811321172447, -1091.5371345657143, -969.8349805957108, -80.36030866135998, -890.5503482651658, -1081.3583808202152, -1039.045752643029, 168.2450196021555, -757.312679361859, -922.9678253559016, -868.2348054334165, -101.44841851526897, -529.5760220343005, -1282.8851211582667, -1434.6506305461653, -1114.0736896716521, -1284.3935189108238, -985.8540957635665, -164.92429100878022, -589.8293851423801, -1238.861274409158, 40.0000000000003, 31.141436851922567, -1208.0111627749982, -397.06263528984726, -1364.0386097894245, -949.6019864790512, -1143.8787546110727, -1377.2412591002662], "policy_predator_policy_reward": [934.0634988236931, 896.4159735801608, 1067.251830000767, 615.5330814207507, 932.7028837878931, 30.742369479036192, 1118.1306135055163, 916.1205533212817, 534.7355564527957, 951.1487676666883, 955.0116827078186, 1030.795780253461, 1035.5412584334142, 834.7759986181161, 911.0708956792956, 1015.3133788628952, 612.7356137508659, 860.8238654468274, 499.4317710896683, 47.40196819192787, 490.5970700750862, 796.5363906419606, 960.0547224286655, 1019.0857291707027, 581.8920833186748, 1028.9141064855296, 952.0514313291854, 554.5512595777584, 1124.4055449913506, 318.73709829346075, 935.7593258608816, 965.61018972081, 1096.1546771441424, 988.7364783613268, 263.8550650562944, 260.97666528374447, 1070.4247201001906, 1233.0760952505275, 952.6224415809542, 734.8027432655906, 708.1828827460115, 930.239836231447, 457.3610059763905, 1127.7686394300508, 1005.143282027985, 636.7275368810782, 916.8968701869777, 672.6096573676652, 879.2283329365755, 22.18268209167235, 597.9934373184194, 801.3473461792918, 294.9273507185015, 1028.4526149396493, 778.6028014948038, 370.018737983625, 1228.324643684833, 792.6769690098461, 557.9812000096233, 1030.137185612832, 721.6091602654835, 1011.033167361555, 1014.6090367755537, 291.52839965565636, 1063.1994601683978, 929.6499003050965, 544.4687262051731, 908.5354868185738, 1077.5676731687936, 426.0231404647284, 1312.3555434873585, 1196.93246137675, 582.9733096697561, 814.1297461739713, 1044.1485937021494, 985.5198553062316, 976.6582600937668, 1098.7182714310402, 620.128868767951, 739.2814622235279, 1116.682945329678, 1242.8343322446142, 1062.8564104977936, 323.00275251927803, 1180.450250900694, 3.9305265661439606, 260.6544300510958, 1041.8958961219612, 197.94094960980095, 955.5482424749027, 1346.5533246102464, 1311.7314900541598, 1009.2719372477615, 693.5599162534062, 979.6997703870995, 1118.075972646708, 720.3097911715795, 881.6090133000528, 838.288089244753, 1063.1264138337003, 915.8074763824234, 741.0280986762486, 1134.6430251395295, 1068.0163582786774, 1092.1624759855627, 1253.8178875692804, 1331.8538747484668, 1243.1707568087736, 802.4037135231752, 962.3066133874877, 847.6559798478055, 887.5571579242472, 1079.8971136612497, 909.3502813089684, 1342.874245796453, 1010.9912556531533, 610.2309610006558, 983.2726740972396, 1171.2952504368568, 916.311363290205, 524.2186811089769, 859.0379115897565, 968.7659990591499, 844.0203857956618, 1076.9079978043196, 1390.4831394698572, 1176.5412924752418, 978.8773364517452, 1197.393558854839, 575.0400968987351, 387.3670275824382, 919.1156738778742, 1021.9558733567608, 461.67476627889914, 1097.3680473252286, 1004.56338647293, 357.09645862731514, 471.51970166945375, 561.5044182720998, 551.8384546628839, 1087.8412810064528, 1167.4368184489379, 1141.719312443752, 1102.3674737679275, 1113.950452145719, 1206.1320299183285, 1229.554383091059, 628.4203327122161, 815.8073363513953, 983.478875053061, 1178.5431372766327, 201.7206684047501, 795.3278771225168, 1084.5486293239417, 1304.7987690341806, 493.2610705288984, 1037.9338577851772, 559.756123391088, 927.3048045552528, 1038.7266505536707, 1026.5169313062427, 1091.6480176566013, 974.4838846683937, 508.9532633621246, 733.7036870158325, 447.9237653371547, 911.4057039071257, 437.03048764629506, 897.8730866993827, 578.6502308568148, 1245.5815615683807, 1133.8113211724472, 1097.1564389126038, 970.3324545233364, 1091.1106569265241, 12.61702079857614, 1022.0644368475679, 1201.2284997402687, 375.400810252964, 549.2947219334118, 764.9214131588816, 1109.0889479491655, 404.9273931015431, 704.5055382132945, 1282.8851211582667, 1434.6506305461653, 1153.6623387454847, 1280.343826887945, 672.1423495428813, 951.5573853706808, 602.7274235360118, 1238.9612744091582, 6.353232412162486, 6.343353600717938, 834.2543354122795, 1079.5166962845797, 1361.6058827031593, 1015.3252588653556, 1146.458511114094, 1377.2412591002662]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8541366796431, "mean_inference_ms": 4.536666489096321, "mean_action_processing_ms": 1.744950395368958, "mean_env_wait_ms": 10.194089046254474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007481813430786133, "StateBufferConnector_ms": 0.013280391693115234, "ViewRequirementAgentConnector_ms": 0.19421327114105225}, "num_episodes": 12, "episode_return_max": 624.1799640455768, "episode_return_min": -0.5955299915837164, "episode_return_mean": 208.52199339423635, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.26014672477642, "num_env_steps_trained_throughput_per_sec": 74.26014672477642, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 50437.878, "restore_workers_time_ms": 0.016, "training_step_time_ms": 50437.751, "sample_time_ms": 2454.365, "learn_time_ms": 47959.469, "learn_throughput": 83.404, "synch_weights_time_ms": 18.176}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "35fb9_00000", "date": "2024-08-22_08-20-23", "timestamp": 1724295023, "time_this_iter_s": 53.91444993019104, "time_total_s": 1601.8456633090973, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcc6b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1601.8456633090973, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 40.446753246753254, "ram_util_percent": 82.9948051948052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.037871527167225, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.187950832377036, "policy_loss": -0.021741574093029296, "vf_loss": 7.206583177980292, "vf_explained_var": 0.3925894952009595, "kl": 0.015546113597327675, "entropy": 1.00149827694136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.513103959295485, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.394339769857901, "policy_loss": -0.019184939355574665, "vf_loss": 7.410999740368474, "vf_explained_var": 0.3805982064317774, "kl": 0.0126248818662057, "entropy": 0.7266723128222915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 624.1799640455768, "episode_reward_min": -1.2037269366120085, "episode_reward_mean": 207.25748850531744, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1492.5016445164706, "predator_policy": 3.9305265661439606}, "policy_reward_max": {"prey_policy": 323.4398347874944, "predator_policy": 1434.6506305461653}, "policy_reward_mean": {"prey_policy": -769.8387852640128, "predator_policy": 873.4675295166721}, "custom_metrics": {}, "hist_stats": {"episode_reward": [530.7841843170864, 291.46394588394253, 19.521012703243514, 53.39724465776257, 321.0361903306856, 359.08356827094747, 253.69922056138049, 45.2576636228842, 602.9222905175568, 54.3130017147017, 189.58971419332036, 72.32160991130543, 279.92731458015453, 40.96169880513431, 383.9048128494726, 359.17135036424304, 298.4397619410134, 433.7974910997259, 167.19387840730906, 30.214096284130825, 513.0067013786834, 142.57349917804842, 382.2270490849362, 90.74990508499701, 362.15019634536867, 361.72834830877815, 3.89570220896076, 26.0000000000001, 9.05799588476716, 30.880378903827896, 184.78521288502182, 97.16156274622303, 134.9705436101389, 291.7281893218326, 539.852508314432, 397.8516584419797, 223.48727458644095, 155.6568152656098, 308.28895570560627, 238.6367453621083, 206.93016296232815, 241.3653308483623, 244.53690714370452, 43.13979642377107, -0.5955299915837164, 85.61515519412544, 223.29910725422337, 365.7412097859951, 20.46538523146517, 386.4331723563776, 35.610704072035006, 368.0871626092377, 117.99431190146842, 35.79999999999989, 329.12174537623446, 269.548469111097, 530.1150699945186, 190.57768496807745, 98.3788368027139, 293.4556298513983, 364.65813167932527, 21.723624251570293, 13.536371190979274, 30.934129528086793, 293.8404852194577, 96.10511964865916, 314.9238919699011, 180.73873419839006, 462.5682157612234, 27.695973337486997, 206.76632386062147, 4.685502285455671, 27.712678125181764, 624.1799640455768, 275.69170081527085, 419.5267505245731, 49.99999999999996, 6.116778274515148, 132.81702079857422, 102.88880312459129, 335.6278724266723, 82.80773031873045, 478.40849076526763, -1.0658141036401503e-14, 35.5389570509545, 472.92134814121454, 12.99803839362955, 83.83802286480234, 308.6972336320149, 63.29054530003693, 2.5797565030212706, 231.9873233741841, 375.635811654235, 159.50819102288918, 364.58666537590364, -1.2037269366120085, 51.15630222387081, 206.32426615586542, 38.28350042171058, 398.34271767459904], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-51.202029897388485, 35.15247493287871, -593.4239160872826, -402.24559874582394, -946.9547224286658, -1012.6647164674591, -1157.7363232225769, -399.6726219238579, -307.67673513019287, -877.889765446061, -1067.1703252801296, -16.888749733734212, -652.9844026057203, -994.685892414591, -1081.223660419167, -958.409831463417, -29.152706840535245, 107.24326701805336, -1033.8564824314703, -1215.3313312045427, -632.9344180429244, -864.901052610299, -733.9486516182983, -832.1524574478537, -186.99275056219466, -1118.2095802640922, -984.4431114388829, -616.4660086650465, -861.0045195369079, -344.59719516826283, -865.6794994514989, 323.4398347874944, -1060.826763044055, -40.07425851264159, 274.40009336620926, -1163.982567924634, -1016.7460607263803, 35.31839965526176, -1227.9516858546888, -762.8358305558595, -910.4844743932902, -164.6272098504818, -604.0603157384318, -986.0085127105568, -319.34477023836234, -604.5656171079115, -1002.3372681338918, -899.7621872546063, -177.50571692954543, -913.3482997488327, -310.780558720694, -831.0819066040481, -1308.5019246126876, -1196.89037804246, -568.1733096697529, -802.9297461739687, -962.4167581083608, -1058.1936950152538, -962.7778811899381, -1081.7182714310402, -1067.7434642275396, -106.88165387891964, -1009.2580694603854, -1253.0976453676838, 37.69668290996896, -1288.5853023168986, -847.0461263813007, -45.60646176370409, 288.6644834992129, -1051.362301357838, 252.43862639627457, -1008.0761600389992, -1492.5016445164706, -942.2958955614924, -836.57168054207, -710.603357693487, -1100.774409187776, -688.7123781404244, -741.1513694296151, -622.1306896799083, -626.5543495480533, -1067.9299905680716, -746.3620200414009, -669.108224168909, -825.3670547732409, -1132.755421501261, -1151.8929303507527, -1150.9476367803181, -1332.7494047400505, -1242.8707568087736, -770.43703104435, -908.6581406721878, -845.2973849918408, -666.6166455259892, -533.8658950441563, -1089.6402901400659, -1340.4093217185439, -992.990794499597, -839.00441318795, -368.0660495535674, -1127.674187866734, -924.3217217882932, 36.76800744374211, -1051.9374375332395, -858.3716871576815, -836.4203857956617, -1041.1079978043197, -1390.4831394698572, -866.3656651362168, -959.9312184145358, -1205.2420416727869, -297.64314496968785, 152.8723237658262, -929.2399552316195, -1012.1949681279489, -280.85798653963184, -859.8265048260404, -1143.7260921694046, -385.3302755475502, -149.83025489782236, -434.3050720116926, -314.37966924396505, -1067.8487030478468, -1165.705772155972, -1136.7396546689622, -1093.8107603517383, -1315.5191785422564, -973.6291739937041, -1232.6451110154255, -331.4891195683923, -969.601340383899, -733.5797513718973, 61.94468311709932, -1127.2845968285812, -1127.3919302613426, -571.7458419867271, -1421.1595134025292, 85.66788960067468, -1035.6338577851766, -534.3601500535975, -559.6159236702973, -1199.6492075780025, -1024.1169313062426, -1089.3625153711462, -322.86181388257694, -1132.8626560227508, 282.99822183565755, -840.4457101430698, 102.91299990456788, -1175.6574906427188, -808.1760622927474, -248.82050473887784, -1238.5815615683807, -1090.811321172447, -1091.5371345657143, -969.8349805957108, -80.36030866135998, -890.5503482651658, -1081.3583808202152, -1039.045752643029, 168.2450196021555, -757.312679361859, -922.9678253559016, -868.2348054334165, -101.44841851526897, -529.5760220343005, -1282.8851211582667, -1434.6506305461653, -1114.0736896716521, -1284.3935189108238, -985.8540957635665, -164.92429100878022, -589.8293851423801, -1238.861274409158, 40.0000000000003, 31.141436851922567, -1208.0111627749982, -397.06263528984726, -1364.0386097894245, -949.6019864790512, -1143.8787546110727, -1377.2412591002662, -1171.298016996429, -389.34846679994837, -208.82100959596283, -1200.146735929287, -935.634203405512, -1260.2425311689785, -259.1658504566807, -529.5282205984918, -1126.9694079175067, -1133.1801641984202, -1039.965380512947, -1117.251247296063, -1076.8228165490825, -696.3555888678892, -1291.1157421518808, -931.5655624966791, -898.7613525502709, -620.3131790333332], "policy_predator_policy_reward": [499.4317710896683, 47.40196819192787, 490.5970700750862, 796.5363906419606, 960.0547224286655, 1019.0857291707027, 581.8920833186748, 1028.9141064855296, 952.0514313291854, 554.5512595777584, 1124.4055449913506, 318.73709829346075, 935.7593258608816, 965.61018972081, 1096.1546771441424, 988.7364783613268, 263.8550650562944, 260.97666528374447, 1070.4247201001906, 1233.0760952505275, 952.6224415809542, 734.8027432655906, 708.1828827460115, 930.239836231447, 457.3610059763905, 1127.7686394300508, 1005.143282027985, 636.7275368810782, 916.8968701869777, 672.6096573676652, 879.2283329365755, 22.18268209167235, 597.9934373184194, 801.3473461792918, 294.9273507185015, 1028.4526149396493, 778.6028014948038, 370.018737983625, 1228.324643684833, 792.6769690098461, 557.9812000096233, 1030.137185612832, 721.6091602654835, 1011.033167361555, 1014.6090367755537, 291.52839965565636, 1063.1994601683978, 929.6499003050965, 544.4687262051731, 908.5354868185738, 1077.5676731687936, 426.0231404647284, 1312.3555434873585, 1196.93246137675, 582.9733096697561, 814.1297461739713, 1044.1485937021494, 985.5198553062316, 976.6582600937668, 1098.7182714310402, 620.128868767951, 739.2814622235279, 1116.682945329678, 1242.8343322446142, 1062.8564104977936, 323.00275251927803, 1180.450250900694, 3.9305265661439606, 260.6544300510958, 1041.8958961219612, 197.94094960980095, 955.5482424749027, 1346.5533246102464, 1311.7314900541598, 1009.2719372477615, 693.5599162534062, 979.6997703870995, 1118.075972646708, 720.3097911715795, 881.6090133000528, 838.288089244753, 1063.1264138337003, 915.8074763824234, 741.0280986762486, 1134.6430251395295, 1068.0163582786774, 1092.1624759855627, 1253.8178875692804, 1331.8538747484668, 1243.1707568087736, 802.4037135231752, 962.3066133874877, 847.6559798478055, 887.5571579242472, 1079.8971136612497, 909.3502813089684, 1342.874245796453, 1010.9912556531533, 610.2309610006558, 983.2726740972396, 1171.2952504368568, 916.311363290205, 524.2186811089769, 859.0379115897565, 968.7659990591499, 844.0203857956618, 1076.9079978043196, 1390.4831394698572, 1176.5412924752418, 978.8773364517452, 1197.393558854839, 575.0400968987351, 387.3670275824382, 919.1156738778742, 1021.9558733567608, 461.67476627889914, 1097.3680473252286, 1004.56338647293, 357.09645862731514, 471.51970166945375, 561.5044182720998, 551.8384546628839, 1087.8412810064528, 1167.4368184489379, 1141.719312443752, 1102.3674737679275, 1113.950452145719, 1206.1320299183285, 1229.554383091059, 628.4203327122161, 815.8073363513953, 983.478875053061, 1178.5431372766327, 201.7206684047501, 795.3278771225168, 1084.5486293239417, 1304.7987690341806, 493.2610705288984, 1037.9338577851772, 559.756123391088, 927.3048045552528, 1038.7266505536707, 1026.5169313062427, 1091.6480176566013, 974.4838846683937, 508.9532633621246, 733.7036870158325, 447.9237653371547, 911.4057039071257, 437.03048764629506, 897.8730866993827, 578.6502308568148, 1245.5815615683807, 1133.8113211724472, 1097.1564389126038, 970.3324545233364, 1091.1106569265241, 12.61702079857614, 1022.0644368475679, 1201.2284997402687, 375.400810252964, 549.2947219334118, 764.9214131588816, 1109.0889479491655, 404.9273931015431, 704.5055382132945, 1282.8851211582667, 1434.6506305461653, 1153.6623387454847, 1280.343826887945, 672.1423495428813, 951.5573853706808, 602.7274235360118, 1238.9612744091582, 6.353232412162486, 6.343353600717938, 834.2543354122795, 1079.5166962845797, 1361.6058827031593, 1015.3252588653556, 1146.458511114094, 1377.2412591002662, 1128.4698876612495, 664.1639195093143, 693.3807759570689, 1091.222781222415, 1171.8602550013156, 1183.524670596063, 451.49143140484756, 701.789305026229, 1137.1541269302281, 1121.7917182490876, 1090.5098907038805, 1117.8630393290005, 1043.6944460451268, 935.8082255277128, 1294.5613798932354, 966.4034251770353, 1067.406530002593, 850.0107192556087]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.862818728590097, "mean_inference_ms": 4.540504072381531, "mean_action_processing_ms": 1.6934115792265467, "mean_env_wait_ms": 10.211599911964832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007715821266174316, "StateBufferConnector_ms": 0.013274073600769043, "ViewRequirementAgentConnector_ms": 0.22906827926635742}, "num_episodes": 9, "episode_return_max": 624.1799640455768, "episode_return_min": -1.2037269366120085, "episode_return_mean": 207.25748850531744, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.12932745296068, "num_env_steps_trained_throughput_per_sec": 72.12932745296068, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 50439.263, "restore_workers_time_ms": 0.013, "training_step_time_ms": 50439.147, "sample_time_ms": 2569.071, "learn_time_ms": 47845.69, "learn_throughput": 83.602, "synch_weights_time_ms": 17.64}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "35fb9_00000", "date": "2024-08-22_08-21-18", "timestamp": 1724295078, "time_this_iter_s": 55.500648021698, "time_total_s": 1657.3463113307953, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc89f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1657.3463113307953, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 43.64487179487179, "ram_util_percent": 82.88846153846156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.058949590738488, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1233289327571, "policy_loss": -0.020370818172438594, "vf_loss": 7.140754668927067, "vf_explained_var": 0.39110693165234156, "kl": 0.014725401122911425, "entropy": 0.986839804699812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.045367166226503, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.64055432617349, "policy_loss": -0.018221926580740032, "vf_loss": 7.656065806131514, "vf_explained_var": 0.3848355057693663, "kl": 0.013552317713885001, "entropy": 0.7065522287730818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 624.1799640455768, "episode_reward_min": -1.2037269366120085, "episode_reward_mean": 200.31917915813085, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1492.5016445164706, "predator_policy": 3.9305265661439606}, "policy_reward_max": {"prey_policy": 323.4398347874944, "predator_policy": 1466.132835552609}, "policy_reward_mean": {"prey_policy": -777.1300566854496, "predator_policy": 877.2896462645152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.2576636228842, 602.9222905175568, 54.3130017147017, 189.58971419332036, 72.32160991130543, 279.92731458015453, 40.96169880513431, 383.9048128494726, 359.17135036424304, 298.4397619410134, 433.7974910997259, 167.19387840730906, 30.214096284130825, 513.0067013786834, 142.57349917804842, 382.2270490849362, 90.74990508499701, 362.15019634536867, 361.72834830877815, 3.89570220896076, 26.0000000000001, 9.05799588476716, 30.880378903827896, 184.78521288502182, 97.16156274622303, 134.9705436101389, 291.7281893218326, 539.852508314432, 397.8516584419797, 223.48727458644095, 155.6568152656098, 308.28895570560627, 238.6367453621083, 206.93016296232815, 241.3653308483623, 244.53690714370452, 43.13979642377107, -0.5955299915837164, 85.61515519412544, 223.29910725422337, 365.7412097859951, 20.46538523146517, 386.4331723563776, 35.610704072035006, 368.0871626092377, 117.99431190146842, 35.79999999999989, 329.12174537623446, 269.548469111097, 530.1150699945186, 190.57768496807745, 98.3788368027139, 293.4556298513983, 364.65813167932527, 21.723624251570293, 13.536371190979274, 30.934129528086793, 293.8404852194577, 96.10511964865916, 314.9238919699011, 180.73873419839006, 462.5682157612234, 27.695973337486997, 206.76632386062147, 4.685502285455671, 27.712678125181764, 624.1799640455768, 275.69170081527085, 419.5267505245731, 49.99999999999996, 6.116778274515148, 132.81702079857422, 102.88880312459129, 335.6278724266723, 82.80773031873045, 478.40849076526763, -1.0658141036401503e-14, 35.5389570509545, 472.92134814121454, 12.99803839362955, 83.83802286480234, 308.6972336320149, 63.29054530003693, 2.5797565030212706, 231.9873233741841, 375.635811654235, 159.50819102288918, 364.58666537590364, -1.2037269366120085, 51.15630222387081, 206.32426615586542, 38.28350042171058, 398.34271767459904, 40.218336116081694, 137.32419719795692, 54.83357184285424, 236.5313926929539, 176.76270968463942, 40.465563920660486, 449.01866055124316], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1081.223660419167, -958.409831463417, -29.152706840535245, 107.24326701805336, -1033.8564824314703, -1215.3313312045427, -632.9344180429244, -864.901052610299, -733.9486516182983, -832.1524574478537, -186.99275056219466, -1118.2095802640922, -984.4431114388829, -616.4660086650465, -861.0045195369079, -344.59719516826283, -865.6794994514989, 323.4398347874944, -1060.826763044055, -40.07425851264159, 274.40009336620926, -1163.982567924634, -1016.7460607263803, 35.31839965526176, -1227.9516858546888, -762.8358305558595, -910.4844743932902, -164.6272098504818, -604.0603157384318, -986.0085127105568, -319.34477023836234, -604.5656171079115, -1002.3372681338918, -899.7621872546063, -177.50571692954543, -913.3482997488327, -310.780558720694, -831.0819066040481, -1308.5019246126876, -1196.89037804246, -568.1733096697529, -802.9297461739687, -962.4167581083608, -1058.1936950152538, -962.7778811899381, -1081.7182714310402, -1067.7434642275396, -106.88165387891964, -1009.2580694603854, -1253.0976453676838, 37.69668290996896, -1288.5853023168986, -847.0461263813007, -45.60646176370409, 288.6644834992129, -1051.362301357838, 252.43862639627457, -1008.0761600389992, -1492.5016445164706, -942.2958955614924, -836.57168054207, -710.603357693487, -1100.774409187776, -688.7123781404244, -741.1513694296151, -622.1306896799083, -626.5543495480533, -1067.9299905680716, -746.3620200414009, -669.108224168909, -825.3670547732409, -1132.755421501261, -1151.8929303507527, -1150.9476367803181, -1332.7494047400505, -1242.8707568087736, -770.43703104435, -908.6581406721878, -845.2973849918408, -666.6166455259892, -533.8658950441563, -1089.6402901400659, -1340.4093217185439, -992.990794499597, -839.00441318795, -368.0660495535674, -1127.674187866734, -924.3217217882932, 36.76800744374211, -1051.9374375332395, -858.3716871576815, -836.4203857956617, -1041.1079978043197, -1390.4831394698572, -866.3656651362168, -959.9312184145358, -1205.2420416727869, -297.64314496968785, 152.8723237658262, -929.2399552316195, -1012.1949681279489, -280.85798653963184, -859.8265048260404, -1143.7260921694046, -385.3302755475502, -149.83025489782236, -434.3050720116926, -314.37966924396505, -1067.8487030478468, -1165.705772155972, -1136.7396546689622, -1093.8107603517383, -1315.5191785422564, -973.6291739937041, -1232.6451110154255, -331.4891195683923, -969.601340383899, -733.5797513718973, 61.94468311709932, -1127.2845968285812, -1127.3919302613426, -571.7458419867271, -1421.1595134025292, 85.66788960067468, -1035.6338577851766, -534.3601500535975, -559.6159236702973, -1199.6492075780025, -1024.1169313062426, -1089.3625153711462, -322.86181388257694, -1132.8626560227508, 282.99822183565755, -840.4457101430698, 102.91299990456788, -1175.6574906427188, -808.1760622927474, -248.82050473887784, -1238.5815615683807, -1090.811321172447, -1091.5371345657143, -969.8349805957108, -80.36030866135998, -890.5503482651658, -1081.3583808202152, -1039.045752643029, 168.2450196021555, -757.312679361859, -922.9678253559016, -868.2348054334165, -101.44841851526897, -529.5760220343005, -1282.8851211582667, -1434.6506305461653, -1114.0736896716521, -1284.3935189108238, -985.8540957635665, -164.92429100878022, -589.8293851423801, -1238.861274409158, 40.0000000000003, 31.141436851922567, -1208.0111627749982, -397.06263528984726, -1364.0386097894245, -949.6019864790512, -1143.8787546110727, -1377.2412591002662, -1171.298016996429, -389.34846679994837, -208.82100959596283, -1200.146735929287, -935.634203405512, -1260.2425311689785, -259.1658504566807, -529.5282205984918, -1126.9694079175067, -1133.1801641984202, -1039.965380512947, -1117.251247296063, -1076.8228165490825, -696.3555888678892, -1291.1157421518808, -931.5655624966791, -898.7613525502709, -620.3131790333332, -1298.3680443565174, -1103.5530551568982, -1198.8142644567056, -584.3817838242941, -369.1801798206177, -1213.0293606996272, -574.4874584384766, 34.64091787147546, 38.93164634197064, -1058.4394418565512, -1466.132835552609, -138.26056761998157, 255.87512109245102, -1229.098302261542], "policy_predator_policy_reward": [1096.1546771441424, 988.7364783613268, 263.8550650562944, 260.97666528374447, 1070.4247201001906, 1233.0760952505275, 952.6224415809542, 734.8027432655906, 708.1828827460115, 930.239836231447, 457.3610059763905, 1127.7686394300508, 1005.143282027985, 636.7275368810782, 916.8968701869777, 672.6096573676652, 879.2283329365755, 22.18268209167235, 597.9934373184194, 801.3473461792918, 294.9273507185015, 1028.4526149396493, 778.6028014948038, 370.018737983625, 1228.324643684833, 792.6769690098461, 557.9812000096233, 1030.137185612832, 721.6091602654835, 1011.033167361555, 1014.6090367755537, 291.52839965565636, 1063.1994601683978, 929.6499003050965, 544.4687262051731, 908.5354868185738, 1077.5676731687936, 426.0231404647284, 1312.3555434873585, 1196.93246137675, 582.9733096697561, 814.1297461739713, 1044.1485937021494, 985.5198553062316, 976.6582600937668, 1098.7182714310402, 620.128868767951, 739.2814622235279, 1116.682945329678, 1242.8343322446142, 1062.8564104977936, 323.00275251927803, 1180.450250900694, 3.9305265661439606, 260.6544300510958, 1041.8958961219612, 197.94094960980095, 955.5482424749027, 1346.5533246102464, 1311.7314900541598, 1009.2719372477615, 693.5599162534062, 979.6997703870995, 1118.075972646708, 720.3097911715795, 881.6090133000528, 838.288089244753, 1063.1264138337003, 915.8074763824234, 741.0280986762486, 1134.6430251395295, 1068.0163582786774, 1092.1624759855627, 1253.8178875692804, 1331.8538747484668, 1243.1707568087736, 802.4037135231752, 962.3066133874877, 847.6559798478055, 887.5571579242472, 1079.8971136612497, 909.3502813089684, 1342.874245796453, 1010.9912556531533, 610.2309610006558, 983.2726740972396, 1171.2952504368568, 916.311363290205, 524.2186811089769, 859.0379115897565, 968.7659990591499, 844.0203857956618, 1076.9079978043196, 1390.4831394698572, 1176.5412924752418, 978.8773364517452, 1197.393558854839, 575.0400968987351, 387.3670275824382, 919.1156738778742, 1021.9558733567608, 461.67476627889914, 1097.3680473252286, 1004.56338647293, 357.09645862731514, 471.51970166945375, 561.5044182720998, 551.8384546628839, 1087.8412810064528, 1167.4368184489379, 1141.719312443752, 1102.3674737679275, 1113.950452145719, 1206.1320299183285, 1229.554383091059, 628.4203327122161, 815.8073363513953, 983.478875053061, 1178.5431372766327, 201.7206684047501, 795.3278771225168, 1084.5486293239417, 1304.7987690341806, 493.2610705288984, 1037.9338577851772, 559.756123391088, 927.3048045552528, 1038.7266505536707, 1026.5169313062427, 1091.6480176566013, 974.4838846683937, 508.9532633621246, 733.7036870158325, 447.9237653371547, 911.4057039071257, 437.03048764629506, 897.8730866993827, 578.6502308568148, 1245.5815615683807, 1133.8113211724472, 1097.1564389126038, 970.3324545233364, 1091.1106569265241, 12.61702079857614, 1022.0644368475679, 1201.2284997402687, 375.400810252964, 549.2947219334118, 764.9214131588816, 1109.0889479491655, 404.9273931015431, 704.5055382132945, 1282.8851211582667, 1434.6506305461653, 1153.6623387454847, 1280.343826887945, 672.1423495428813, 951.5573853706808, 602.7274235360118, 1238.9612744091582, 6.353232412162486, 6.343353600717938, 834.2543354122795, 1079.5166962845797, 1361.6058827031593, 1015.3252588653556, 1146.458511114094, 1377.2412591002662, 1128.4698876612495, 664.1639195093143, 693.3807759570689, 1091.222781222415, 1171.8602550013156, 1183.524670596063, 451.49143140484756, 701.789305026229, 1137.1541269302281, 1121.7917182490876, 1090.5098907038805, 1117.8630393290005, 1043.6944460451268, 935.8082255277128, 1294.5613798932354, 966.4034251770353, 1067.406530002593, 850.0107192556087, 1302.4952069126468, 1139.644228716852, 1211.6438632141121, 708.8763822648443, 420.21375166347747, 1216.829360699627, 82.38263748093497, 693.9952957790217, 641.8387155697048, 554.4317896295173, 1466.132835552609, 178.72613154063984, 653.558031693581, 768.6838100267544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8348721951771445, "mean_inference_ms": 4.5353223420701205, "mean_action_processing_ms": 1.6962509781290493, "mean_env_wait_ms": 10.238791940693973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007737994194030762, "StateBufferConnector_ms": 0.014229774475097656, "ViewRequirementAgentConnector_ms": 0.2614166736602783}, "num_episodes": 7, "episode_return_max": 624.1799640455768, "episode_return_min": -1.2037269366120085, "episode_return_mean": 200.31917915813085, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.1682838138639, "num_env_steps_trained_throughput_per_sec": 75.1682838138639, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 50339.764, "restore_workers_time_ms": 0.013, "training_step_time_ms": 50339.648, "sample_time_ms": 2715.475, "learn_time_ms": 47599.524, "learn_throughput": 84.034, "synch_weights_time_ms": 17.569}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "35fb9_00000", "date": "2024-08-22_08-22-11", "timestamp": 1724295131, "time_this_iter_s": 53.26203680038452, "time_total_s": 1710.6083481311798, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b611d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1710.6083481311798, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 38.79736842105264, "ram_util_percent": 82.57105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.284832342402645, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.201664517922376, "policy_loss": -0.018974595389787168, "vf_loss": 7.21783548814279, "vf_explained_var": 0.4476857369854337, "kl": 0.014018067760668971, "entropy": 0.9615629606461399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.272043572153365, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.352024337728188, "policy_loss": -0.01948210457389159, "vf_loss": 7.368828828246505, "vf_explained_var": 0.4195123621395656, "kl": 0.013388088839522824, "entropy": 0.6988954160579298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 624.1799640455768, "episode_reward_min": -22.78577684539289, "episode_reward_mean": 188.06505408218126, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1492.5016445164706, "predator_policy": 3.9305265661439606}, "policy_reward_max": {"prey_policy": 288.6644834992129, "predator_policy": 1466.132835552609}, "policy_reward_mean": {"prey_policy": -797.8234010270052, "predator_policy": 891.855928068096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.19387840730906, 30.214096284130825, 513.0067013786834, 142.57349917804842, 382.2270490849362, 90.74990508499701, 362.15019634536867, 361.72834830877815, 3.89570220896076, 26.0000000000001, 9.05799588476716, 30.880378903827896, 184.78521288502182, 97.16156274622303, 134.9705436101389, 291.7281893218326, 539.852508314432, 397.8516584419797, 223.48727458644095, 155.6568152656098, 308.28895570560627, 238.6367453621083, 206.93016296232815, 241.3653308483623, 244.53690714370452, 43.13979642377107, -0.5955299915837164, 85.61515519412544, 223.29910725422337, 365.7412097859951, 20.46538523146517, 386.4331723563776, 35.610704072035006, 368.0871626092377, 117.99431190146842, 35.79999999999989, 329.12174537623446, 269.548469111097, 530.1150699945186, 190.57768496807745, 98.3788368027139, 293.4556298513983, 364.65813167932527, 21.723624251570293, 13.536371190979274, 30.934129528086793, 293.8404852194577, 96.10511964865916, 314.9238919699011, 180.73873419839006, 462.5682157612234, 27.695973337486997, 206.76632386062147, 4.685502285455671, 27.712678125181764, 624.1799640455768, 275.69170081527085, 419.5267505245731, 49.99999999999996, 6.116778274515148, 132.81702079857422, 102.88880312459129, 335.6278724266723, 82.80773031873045, 478.40849076526763, -1.0658141036401503e-14, 35.5389570509545, 472.92134814121454, 12.99803839362955, 83.83802286480234, 308.6972336320149, 63.29054530003693, 2.5797565030212706, 231.9873233741841, 375.635811654235, 159.50819102288918, 364.58666537590364, -1.2037269366120085, 51.15630222387081, 206.32426615586542, 38.28350042171058, 398.34271767459904, 40.218336116081694, 137.32419719795692, 54.83357184285424, 236.5313926929539, 176.76270968463942, 40.465563920660486, 449.01866055124316, 87.28628976253043, 96.6, 254.84641676694608, 104.76323822324429, 325.6769566158748, 37.50703095326301, 122.48889121300074, -22.78577684539289, 257.4999999999983, 225.79203782076848, 45.519117494321534], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1016.7460607263803, 35.31839965526176, -1227.9516858546888, -762.8358305558595, -910.4844743932902, -164.6272098504818, -604.0603157384318, -986.0085127105568, -319.34477023836234, -604.5656171079115, -1002.3372681338918, -899.7621872546063, -177.50571692954543, -913.3482997488327, -310.780558720694, -831.0819066040481, -1308.5019246126876, -1196.89037804246, -568.1733096697529, -802.9297461739687, -962.4167581083608, -1058.1936950152538, -962.7778811899381, -1081.7182714310402, -1067.7434642275396, -106.88165387891964, -1009.2580694603854, -1253.0976453676838, 37.69668290996896, -1288.5853023168986, -847.0461263813007, -45.60646176370409, 288.6644834992129, -1051.362301357838, 252.43862639627457, -1008.0761600389992, -1492.5016445164706, -942.2958955614924, -836.57168054207, -710.603357693487, -1100.774409187776, -688.7123781404244, -741.1513694296151, -622.1306896799083, -626.5543495480533, -1067.9299905680716, -746.3620200414009, -669.108224168909, -825.3670547732409, -1132.755421501261, -1151.8929303507527, -1150.9476367803181, -1332.7494047400505, -1242.8707568087736, -770.43703104435, -908.6581406721878, -845.2973849918408, -666.6166455259892, -533.8658950441563, -1089.6402901400659, -1340.4093217185439, -992.990794499597, -839.00441318795, -368.0660495535674, -1127.674187866734, -924.3217217882932, 36.76800744374211, -1051.9374375332395, -858.3716871576815, -836.4203857956617, -1041.1079978043197, -1390.4831394698572, -866.3656651362168, -959.9312184145358, -1205.2420416727869, -297.64314496968785, 152.8723237658262, -929.2399552316195, -1012.1949681279489, -280.85798653963184, -859.8265048260404, -1143.7260921694046, -385.3302755475502, -149.83025489782236, -434.3050720116926, -314.37966924396505, -1067.8487030478468, -1165.705772155972, -1136.7396546689622, -1093.8107603517383, -1315.5191785422564, -973.6291739937041, -1232.6451110154255, -331.4891195683923, -969.601340383899, -733.5797513718973, 61.94468311709932, -1127.2845968285812, -1127.3919302613426, -571.7458419867271, -1421.1595134025292, 85.66788960067468, -1035.6338577851766, -534.3601500535975, -559.6159236702973, -1199.6492075780025, -1024.1169313062426, -1089.3625153711462, -322.86181388257694, -1132.8626560227508, 282.99822183565755, -840.4457101430698, 102.91299990456788, -1175.6574906427188, -808.1760622927474, -248.82050473887784, -1238.5815615683807, -1090.811321172447, -1091.5371345657143, -969.8349805957108, -80.36030866135998, -890.5503482651658, -1081.3583808202152, -1039.045752643029, 168.2450196021555, -757.312679361859, -922.9678253559016, -868.2348054334165, -101.44841851526897, -529.5760220343005, -1282.8851211582667, -1434.6506305461653, -1114.0736896716521, -1284.3935189108238, -985.8540957635665, -164.92429100878022, -589.8293851423801, -1238.861274409158, 40.0000000000003, 31.141436851922567, -1208.0111627749982, -397.06263528984726, -1364.0386097894245, -949.6019864790512, -1143.8787546110727, -1377.2412591002662, -1171.298016996429, -389.34846679994837, -208.82100959596283, -1200.146735929287, -935.634203405512, -1260.2425311689785, -259.1658504566807, -529.5282205984918, -1126.9694079175067, -1133.1801641984202, -1039.965380512947, -1117.251247296063, -1076.8228165490825, -696.3555888678892, -1291.1157421518808, -931.5655624966791, -898.7613525502709, -620.3131790333332, -1298.3680443565174, -1103.5530551568982, -1198.8142644567056, -584.3817838242941, -369.1801798206177, -1213.0293606996272, -574.4874584384766, 34.64091787147546, 38.93164634197064, -1058.4394418565512, -1466.132835552609, -138.26056761998157, 255.87512109245102, -1229.098302261542, -1174.1503116794147, -841.0867424899625, -806.3757983097235, -1382.772080946504, -910.6687241843559, -136.6049952435986, -548.0362619313721, -1140.1726959986752, -196.48000941737317, -809.9303738524643, -1216.0096442400134, -1228.500452583681, -1361.1350228502217, -479.04487836870493, -1116.277688118275, -1207.9440940319719, -184.66267936087718, 18.033215646789582, -755.709174363193, -1463.3869146066027, 10.468400714358715, -1127.3255935702382], "policy_predator_policy_reward": [778.6028014948038, 370.018737983625, 1228.324643684833, 792.6769690098461, 557.9812000096233, 1030.137185612832, 721.6091602654835, 1011.033167361555, 1014.6090367755537, 291.52839965565636, 1063.1994601683978, 929.6499003050965, 544.4687262051731, 908.5354868185738, 1077.5676731687936, 426.0231404647284, 1312.3555434873585, 1196.93246137675, 582.9733096697561, 814.1297461739713, 1044.1485937021494, 985.5198553062316, 976.6582600937668, 1098.7182714310402, 620.128868767951, 739.2814622235279, 1116.682945329678, 1242.8343322446142, 1062.8564104977936, 323.00275251927803, 1180.450250900694, 3.9305265661439606, 260.6544300510958, 1041.8958961219612, 197.94094960980095, 955.5482424749027, 1346.5533246102464, 1311.7314900541598, 1009.2719372477615, 693.5599162534062, 979.6997703870995, 1118.075972646708, 720.3097911715795, 881.6090133000528, 838.288089244753, 1063.1264138337003, 915.8074763824234, 741.0280986762486, 1134.6430251395295, 1068.0163582786774, 1092.1624759855627, 1253.8178875692804, 1331.8538747484668, 1243.1707568087736, 802.4037135231752, 962.3066133874877, 847.6559798478055, 887.5571579242472, 1079.8971136612497, 909.3502813089684, 1342.874245796453, 1010.9912556531533, 610.2309610006558, 983.2726740972396, 1171.2952504368568, 916.311363290205, 524.2186811089769, 859.0379115897565, 968.7659990591499, 844.0203857956618, 1076.9079978043196, 1390.4831394698572, 1176.5412924752418, 978.8773364517452, 1197.393558854839, 575.0400968987351, 387.3670275824382, 919.1156738778742, 1021.9558733567608, 461.67476627889914, 1097.3680473252286, 1004.56338647293, 357.09645862731514, 471.51970166945375, 561.5044182720998, 551.8384546628839, 1087.8412810064528, 1167.4368184489379, 1141.719312443752, 1102.3674737679275, 1113.950452145719, 1206.1320299183285, 1229.554383091059, 628.4203327122161, 815.8073363513953, 983.478875053061, 1178.5431372766327, 201.7206684047501, 795.3278771225168, 1084.5486293239417, 1304.7987690341806, 493.2610705288984, 1037.9338577851772, 559.756123391088, 927.3048045552528, 1038.7266505536707, 1026.5169313062427, 1091.6480176566013, 974.4838846683937, 508.9532633621246, 733.7036870158325, 447.9237653371547, 911.4057039071257, 437.03048764629506, 897.8730866993827, 578.6502308568148, 1245.5815615683807, 1133.8113211724472, 1097.1564389126038, 970.3324545233364, 1091.1106569265241, 12.61702079857614, 1022.0644368475679, 1201.2284997402687, 375.400810252964, 549.2947219334118, 764.9214131588816, 1109.0889479491655, 404.9273931015431, 704.5055382132945, 1282.8851211582667, 1434.6506305461653, 1153.6623387454847, 1280.343826887945, 672.1423495428813, 951.5573853706808, 602.7274235360118, 1238.9612744091582, 6.353232412162486, 6.343353600717938, 834.2543354122795, 1079.5166962845797, 1361.6058827031593, 1015.3252588653556, 1146.458511114094, 1377.2412591002662, 1128.4698876612495, 664.1639195093143, 693.3807759570689, 1091.222781222415, 1171.8602550013156, 1183.524670596063, 451.49143140484756, 701.789305026229, 1137.1541269302281, 1121.7917182490876, 1090.5098907038805, 1117.8630393290005, 1043.6944460451268, 935.8082255277128, 1294.5613798932354, 966.4034251770353, 1067.406530002593, 850.0107192556087, 1302.4952069126468, 1139.644228716852, 1211.6438632141121, 708.8763822648443, 420.21375166347747, 1216.829360699627, 82.38263748093497, 693.9952957790217, 641.8387155697048, 554.4317896295173, 1466.132835552609, 178.72613154063984, 653.558031693581, 768.6838100267544, 881.1432858906613, 1221.3800580412465, 902.9757983097231, 1382.772080946504, 1236.9571509036066, 65.16298529129999, 855.0982071669372, 937.8739889863549, 955.5467629512219, 376.5405769344911, 1234.0288617641822, 1247.9882660127744, 797.2549104279814, 1165.4138820039534, 1203.7461746054091, 1097.6898306994449, 58.260998892311676, 365.8684648217759, 1034.0250028388116, 1410.8631239517533, 33.95071677996267, 1128.425593570238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.844988591711081, "mean_inference_ms": 4.491014964536901, "mean_action_processing_ms": 1.67010803499931, "mean_env_wait_ms": 10.249507609015888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0078012943267822266, "StateBufferConnector_ms": 0.014257192611694336, "ViewRequirementAgentConnector_ms": 0.2558324337005615}, "num_episodes": 11, "episode_return_max": 624.1799640455768, "episode_return_min": -22.78577684539289, "episode_return_mean": 188.06505408218126, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.31023138123304, "num_env_steps_trained_throughput_per_sec": 78.31023138123304, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 50566.072, "restore_workers_time_ms": 0.013, "training_step_time_ms": 50565.963, "sample_time_ms": 2716.639, "learn_time_ms": 47825.795, "learn_throughput": 83.637, "synch_weights_time_ms": 16.606}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "35fb9_00000", "date": "2024-08-22_08-23-03", "timestamp": 1724295183, "time_this_iter_s": 51.114638805389404, "time_total_s": 1761.7229869365692, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b635940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1761.7229869365692, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 34.413698630136984, "ram_util_percent": 82.64794520547946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.69137656070568, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.199352027247191, "policy_loss": -0.02206839461165367, "vf_loss": 7.218723743933219, "vf_explained_var": 0.4654718327143836, "kl": 0.01348338095106618, "entropy": 0.887050322596989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.177259704675624, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.321767845860234, "policy_loss": -0.015960122166181763, "vf_loss": 7.335251511467828, "vf_explained_var": 0.4010843752553223, "kl": 0.012382317171308888, "entropy": 0.6865389430333697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 624.1799640455768, "episode_reward_min": -22.78577684539289, "episode_reward_mean": 190.88135105802004, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1492.5016445164706, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.89675998993977, "predator_policy": 1466.132835552609}, "policy_reward_mean": {"prey_policy": -779.4833594754292, "predator_policy": 874.9240350044397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.0000000000001, 9.05799588476716, 30.880378903827896, 184.78521288502182, 97.16156274622303, 134.9705436101389, 291.7281893218326, 539.852508314432, 397.8516584419797, 223.48727458644095, 155.6568152656098, 308.28895570560627, 238.6367453621083, 206.93016296232815, 241.3653308483623, 244.53690714370452, 43.13979642377107, -0.5955299915837164, 85.61515519412544, 223.29910725422337, 365.7412097859951, 20.46538523146517, 386.4331723563776, 35.610704072035006, 368.0871626092377, 117.99431190146842, 35.79999999999989, 329.12174537623446, 269.548469111097, 530.1150699945186, 190.57768496807745, 98.3788368027139, 293.4556298513983, 364.65813167932527, 21.723624251570293, 13.536371190979274, 30.934129528086793, 293.8404852194577, 96.10511964865916, 314.9238919699011, 180.73873419839006, 462.5682157612234, 27.695973337486997, 206.76632386062147, 4.685502285455671, 27.712678125181764, 624.1799640455768, 275.69170081527085, 419.5267505245731, 49.99999999999996, 6.116778274515148, 132.81702079857422, 102.88880312459129, 335.6278724266723, 82.80773031873045, 478.40849076526763, -1.0658141036401503e-14, 35.5389570509545, 472.92134814121454, 12.99803839362955, 83.83802286480234, 308.6972336320149, 63.29054530003693, 2.5797565030212706, 231.9873233741841, 375.635811654235, 159.50819102288918, 364.58666537590364, -1.2037269366120085, 51.15630222387081, 206.32426615586542, 38.28350042171058, 398.34271767459904, 40.218336116081694, 137.32419719795692, 54.83357184285424, 236.5313926929539, 176.76270968463942, 40.465563920660486, 449.01866055124316, 87.28628976253043, 96.6, 254.84641676694608, 104.76323822324429, 325.6769566158748, 37.50703095326301, 122.48889121300074, -22.78577684539289, 257.4999999999983, 225.79203782076848, 45.519117494321534, 141.94730552611946, 431.71872775131493, 76.5112214415783, 460.00608094622066, 224.54689874560844, 168.84324646035506, 388.36229433681495, 301.32283933271856, 142.11045932436184], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-568.1733096697529, -802.9297461739687, -962.4167581083608, -1058.1936950152538, -962.7778811899381, -1081.7182714310402, -1067.7434642275396, -106.88165387891964, -1009.2580694603854, -1253.0976453676838, 37.69668290996896, -1288.5853023168986, -847.0461263813007, -45.60646176370409, 288.6644834992129, -1051.362301357838, 252.43862639627457, -1008.0761600389992, -1492.5016445164706, -942.2958955614924, -836.57168054207, -710.603357693487, -1100.774409187776, -688.7123781404244, -741.1513694296151, -622.1306896799083, -626.5543495480533, -1067.9299905680716, -746.3620200414009, -669.108224168909, -825.3670547732409, -1132.755421501261, -1151.8929303507527, -1150.9476367803181, -1332.7494047400505, -1242.8707568087736, -770.43703104435, -908.6581406721878, -845.2973849918408, -666.6166455259892, -533.8658950441563, -1089.6402901400659, -1340.4093217185439, -992.990794499597, -839.00441318795, -368.0660495535674, -1127.674187866734, -924.3217217882932, 36.76800744374211, -1051.9374375332395, -858.3716871576815, -836.4203857956617, -1041.1079978043197, -1390.4831394698572, -866.3656651362168, -959.9312184145358, -1205.2420416727869, -297.64314496968785, 152.8723237658262, -929.2399552316195, -1012.1949681279489, -280.85798653963184, -859.8265048260404, -1143.7260921694046, -385.3302755475502, -149.83025489782236, -434.3050720116926, -314.37966924396505, -1067.8487030478468, -1165.705772155972, -1136.7396546689622, -1093.8107603517383, -1315.5191785422564, -973.6291739937041, -1232.6451110154255, -331.4891195683923, -969.601340383899, -733.5797513718973, 61.94468311709932, -1127.2845968285812, -1127.3919302613426, -571.7458419867271, -1421.1595134025292, 85.66788960067468, -1035.6338577851766, -534.3601500535975, -559.6159236702973, -1199.6492075780025, -1024.1169313062426, -1089.3625153711462, -322.86181388257694, -1132.8626560227508, 282.99822183565755, -840.4457101430698, 102.91299990456788, -1175.6574906427188, -808.1760622927474, -248.82050473887784, -1238.5815615683807, -1090.811321172447, -1091.5371345657143, -969.8349805957108, -80.36030866135998, -890.5503482651658, -1081.3583808202152, -1039.045752643029, 168.2450196021555, -757.312679361859, -922.9678253559016, -868.2348054334165, -101.44841851526897, -529.5760220343005, -1282.8851211582667, -1434.6506305461653, -1114.0736896716521, -1284.3935189108238, -985.8540957635665, -164.92429100878022, -589.8293851423801, -1238.861274409158, 40.0000000000003, 31.141436851922567, -1208.0111627749982, -397.06263528984726, -1364.0386097894245, -949.6019864790512, -1143.8787546110727, -1377.2412591002662, -1171.298016996429, -389.34846679994837, -208.82100959596283, -1200.146735929287, -935.634203405512, -1260.2425311689785, -259.1658504566807, -529.5282205984918, -1126.9694079175067, -1133.1801641984202, -1039.965380512947, -1117.251247296063, -1076.8228165490825, -696.3555888678892, -1291.1157421518808, -931.5655624966791, -898.7613525502709, -620.3131790333332, -1298.3680443565174, -1103.5530551568982, -1198.8142644567056, -584.3817838242941, -369.1801798206177, -1213.0293606996272, -574.4874584384766, 34.64091787147546, 38.93164634197064, -1058.4394418565512, -1466.132835552609, -138.26056761998157, 255.87512109245102, -1229.098302261542, -1174.1503116794147, -841.0867424899625, -806.3757983097235, -1382.772080946504, -910.6687241843559, -136.6049952435986, -548.0362619313721, -1140.1726959986752, -196.48000941737317, -809.9303738524643, -1216.0096442400134, -1228.500452583681, -1361.1350228502217, -479.04487836870493, -1116.277688118275, -1207.9440940319719, -184.66267936087718, 18.033215646789582, -755.709174363193, -1463.3869146066027, 10.468400714358715, -1127.3255935702382, -947.6950021402184, -589.4060946814848, -889.7510999530043, -389.6195661077145, 36.44945346466114, -1153.5409363384415, -1254.9257568138069, 395.89675998993977, 30.80342422623352, -435.40048885664083, -690.3144590816217, 24.34703320108461, -1020.3647199063269, 186.69882885294106, -1220.621900198291, 291.01134931181406, -583.7187210721509, -1323.3541111492593], "policy_predator_policy_reward": [582.9733096697561, 814.1297461739713, 1044.1485937021494, 985.5198553062316, 976.6582600937668, 1098.7182714310402, 620.128868767951, 739.2814622235279, 1116.682945329678, 1242.8343322446142, 1062.8564104977936, 323.00275251927803, 1180.450250900694, 3.9305265661439606, 260.6544300510958, 1041.8958961219612, 197.94094960980095, 955.5482424749027, 1346.5533246102464, 1311.7314900541598, 1009.2719372477615, 693.5599162534062, 979.6997703870995, 1118.075972646708, 720.3097911715795, 881.6090133000528, 838.288089244753, 1063.1264138337003, 915.8074763824234, 741.0280986762486, 1134.6430251395295, 1068.0163582786774, 1092.1624759855627, 1253.8178875692804, 1331.8538747484668, 1243.1707568087736, 802.4037135231752, 962.3066133874877, 847.6559798478055, 887.5571579242472, 1079.8971136612497, 909.3502813089684, 1342.874245796453, 1010.9912556531533, 610.2309610006558, 983.2726740972396, 1171.2952504368568, 916.311363290205, 524.2186811089769, 859.0379115897565, 968.7659990591499, 844.0203857956618, 1076.9079978043196, 1390.4831394698572, 1176.5412924752418, 978.8773364517452, 1197.393558854839, 575.0400968987351, 387.3670275824382, 919.1156738778742, 1021.9558733567608, 461.67476627889914, 1097.3680473252286, 1004.56338647293, 357.09645862731514, 471.51970166945375, 561.5044182720998, 551.8384546628839, 1087.8412810064528, 1167.4368184489379, 1141.719312443752, 1102.3674737679275, 1113.950452145719, 1206.1320299183285, 1229.554383091059, 628.4203327122161, 815.8073363513953, 983.478875053061, 1178.5431372766327, 201.7206684047501, 795.3278771225168, 1084.5486293239417, 1304.7987690341806, 493.2610705288984, 1037.9338577851772, 559.756123391088, 927.3048045552528, 1038.7266505536707, 1026.5169313062427, 1091.6480176566013, 974.4838846683937, 508.9532633621246, 733.7036870158325, 447.9237653371547, 911.4057039071257, 437.03048764629506, 897.8730866993827, 578.6502308568148, 1245.5815615683807, 1133.8113211724472, 1097.1564389126038, 970.3324545233364, 1091.1106569265241, 12.61702079857614, 1022.0644368475679, 1201.2284997402687, 375.400810252964, 549.2947219334118, 764.9214131588816, 1109.0889479491655, 404.9273931015431, 704.5055382132945, 1282.8851211582667, 1434.6506305461653, 1153.6623387454847, 1280.343826887945, 672.1423495428813, 951.5573853706808, 602.7274235360118, 1238.9612744091582, 6.353232412162486, 6.343353600717938, 834.2543354122795, 1079.5166962845797, 1361.6058827031593, 1015.3252588653556, 1146.458511114094, 1377.2412591002662, 1128.4698876612495, 664.1639195093143, 693.3807759570689, 1091.222781222415, 1171.8602550013156, 1183.524670596063, 451.49143140484756, 701.789305026229, 1137.1541269302281, 1121.7917182490876, 1090.5098907038805, 1117.8630393290005, 1043.6944460451268, 935.8082255277128, 1294.5613798932354, 966.4034251770353, 1067.406530002593, 850.0107192556087, 1302.4952069126468, 1139.644228716852, 1211.6438632141121, 708.8763822648443, 420.21375166347747, 1216.829360699627, 82.38263748093497, 693.9952957790217, 641.8387155697048, 554.4317896295173, 1466.132835552609, 178.72613154063984, 653.558031693581, 768.6838100267544, 881.1432858906613, 1221.3800580412465, 902.9757983097231, 1382.772080946504, 1236.9571509036066, 65.16298529129999, 855.0982071669372, 937.8739889863549, 955.5467629512219, 376.5405769344911, 1234.0288617641822, 1247.9882660127744, 797.2549104279814, 1165.4138820039534, 1203.7461746054091, 1097.6898306994449, 58.260998892311676, 365.8684648217759, 1034.0250028388116, 1410.8631239517533, 33.95071677996267, 1128.425593570238, 1101.3682790735174, 577.6801232743111, 861.6395727233675, 849.4498210886667, 1178.4530886500377, 15.149615665322191, 1253.800100912491, 65.23497685759682, 624.8060527467096, 4.337910629307837, 747.4814575149829, 87.32921482591102, 0.0, 1222.0281853902006, 1222.3698345967514, 8.5635556224441, 1131.4761283951689, 917.7071631506084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.832880159872184, "mean_inference_ms": 4.477964083121465, "mean_action_processing_ms": 1.658704583212826, "mean_env_wait_ms": 10.268892811067696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011004805564880371, "StateBufferConnector_ms": 0.014000415802001953, "ViewRequirementAgentConnector_ms": 0.26334989070892334}, "num_episodes": 9, "episode_return_max": 624.1799640455768, "episode_return_min": -22.78577684539289, "episode_return_mean": 190.88135105802004, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.05922275248041, "num_env_steps_trained_throughput_per_sec": 77.05922275248041, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 50861.048, "restore_workers_time_ms": 0.013, "training_step_time_ms": 50860.958, "sample_time_ms": 2742.711, "learn_time_ms": 48094.957, "learn_throughput": 83.169, "synch_weights_time_ms": 17.062}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "35fb9_00000", "date": "2024-08-22_08-23-55", "timestamp": 1724295235, "time_this_iter_s": 51.977010011672974, "time_total_s": 1813.6999969482422, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcbd940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1813.6999969482422, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 36.952702702702695, "ram_util_percent": 82.47162162162162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.715899610330187, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.755465299616415, "policy_loss": -0.021307738182361598, "vf_loss": 7.7738359756570645, "vf_explained_var": 0.4603761511189597, "kl": 0.014685345487422728, "entropy": 0.8896602030468996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.642622426830272, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.648571046950325, "policy_loss": -0.017077843638915548, "vf_loss": 7.663498239920884, "vf_explained_var": 0.36941376940283194, "kl": 0.010753369280482056, "entropy": 0.6545886789522474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 624.1799640455768, "episode_reward_min": -22.78577684539289, "episode_reward_mean": 185.44527881479434, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1466.132835552609, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.89675998993977, "predator_policy": 1466.132835552609}, "policy_reward_mean": {"prey_policy": -790.2656871033446, "predator_policy": 882.988326510742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.6568152656098, 308.28895570560627, 238.6367453621083, 206.93016296232815, 241.3653308483623, 244.53690714370452, 43.13979642377107, -0.5955299915837164, 85.61515519412544, 223.29910725422337, 365.7412097859951, 20.46538523146517, 386.4331723563776, 35.610704072035006, 368.0871626092377, 117.99431190146842, 35.79999999999989, 329.12174537623446, 269.548469111097, 530.1150699945186, 190.57768496807745, 98.3788368027139, 293.4556298513983, 364.65813167932527, 21.723624251570293, 13.536371190979274, 30.934129528086793, 293.8404852194577, 96.10511964865916, 314.9238919699011, 180.73873419839006, 462.5682157612234, 27.695973337486997, 206.76632386062147, 4.685502285455671, 27.712678125181764, 624.1799640455768, 275.69170081527085, 419.5267505245731, 49.99999999999996, 6.116778274515148, 132.81702079857422, 102.88880312459129, 335.6278724266723, 82.80773031873045, 478.40849076526763, -1.0658141036401503e-14, 35.5389570509545, 472.92134814121454, 12.99803839362955, 83.83802286480234, 308.6972336320149, 63.29054530003693, 2.5797565030212706, 231.9873233741841, 375.635811654235, 159.50819102288918, 364.58666537590364, -1.2037269366120085, 51.15630222387081, 206.32426615586542, 38.28350042171058, 398.34271767459904, 40.218336116081694, 137.32419719795692, 54.83357184285424, 236.5313926929539, 176.76270968463942, 40.465563920660486, 449.01866055124316, 87.28628976253043, 96.6, 254.84641676694608, 104.76323822324429, 325.6769566158748, 37.50703095326301, 122.48889121300074, -22.78577684539289, 257.4999999999983, 225.79203782076848, 45.519117494321534, 141.94730552611946, 431.71872775131493, 76.5112214415783, 460.00608094622066, 224.54689874560844, 168.84324646035506, 388.36229433681495, 301.32283933271856, 142.11045932436184, 3.755738185314335, 4.600000000000001, 5.734954880429133, 215.8086148832542, 437.0281601573768, 213.43884764233243, 205.250893548533, 6.060558839483537, 73.8, 226.69033223536985], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-836.57168054207, -710.603357693487, -1100.774409187776, -688.7123781404244, -741.1513694296151, -622.1306896799083, -626.5543495480533, -1067.9299905680716, -746.3620200414009, -669.108224168909, -825.3670547732409, -1132.755421501261, -1151.8929303507527, -1150.9476367803181, -1332.7494047400505, -1242.8707568087736, -770.43703104435, -908.6581406721878, -845.2973849918408, -666.6166455259892, -533.8658950441563, -1089.6402901400659, -1340.4093217185439, -992.990794499597, -839.00441318795, -368.0660495535674, -1127.674187866734, -924.3217217882932, 36.76800744374211, -1051.9374375332395, -858.3716871576815, -836.4203857956617, -1041.1079978043197, -1390.4831394698572, -866.3656651362168, -959.9312184145358, -1205.2420416727869, -297.64314496968785, 152.8723237658262, -929.2399552316195, -1012.1949681279489, -280.85798653963184, -859.8265048260404, -1143.7260921694046, -385.3302755475502, -149.83025489782236, -434.3050720116926, -314.37966924396505, -1067.8487030478468, -1165.705772155972, -1136.7396546689622, -1093.8107603517383, -1315.5191785422564, -973.6291739937041, -1232.6451110154255, -331.4891195683923, -969.601340383899, -733.5797513718973, 61.94468311709932, -1127.2845968285812, -1127.3919302613426, -571.7458419867271, -1421.1595134025292, 85.66788960067468, -1035.6338577851766, -534.3601500535975, -559.6159236702973, -1199.6492075780025, -1024.1169313062426, -1089.3625153711462, -322.86181388257694, -1132.8626560227508, 282.99822183565755, -840.4457101430698, 102.91299990456788, -1175.6574906427188, -808.1760622927474, -248.82050473887784, -1238.5815615683807, -1090.811321172447, -1091.5371345657143, -969.8349805957108, -80.36030866135998, -890.5503482651658, -1081.3583808202152, -1039.045752643029, 168.2450196021555, -757.312679361859, -922.9678253559016, -868.2348054334165, -101.44841851526897, -529.5760220343005, -1282.8851211582667, -1434.6506305461653, -1114.0736896716521, -1284.3935189108238, -985.8540957635665, -164.92429100878022, -589.8293851423801, -1238.861274409158, 40.0000000000003, 31.141436851922567, -1208.0111627749982, -397.06263528984726, -1364.0386097894245, -949.6019864790512, -1143.8787546110727, -1377.2412591002662, -1171.298016996429, -389.34846679994837, -208.82100959596283, -1200.146735929287, -935.634203405512, -1260.2425311689785, -259.1658504566807, -529.5282205984918, -1126.9694079175067, -1133.1801641984202, -1039.965380512947, -1117.251247296063, -1076.8228165490825, -696.3555888678892, -1291.1157421518808, -931.5655624966791, -898.7613525502709, -620.3131790333332, -1298.3680443565174, -1103.5530551568982, -1198.8142644567056, -584.3817838242941, -369.1801798206177, -1213.0293606996272, -574.4874584384766, 34.64091787147546, 38.93164634197064, -1058.4394418565512, -1466.132835552609, -138.26056761998157, 255.87512109245102, -1229.098302261542, -1174.1503116794147, -841.0867424899625, -806.3757983097235, -1382.772080946504, -910.6687241843559, -136.6049952435986, -548.0362619313721, -1140.1726959986752, -196.48000941737317, -809.9303738524643, -1216.0096442400134, -1228.500452583681, -1361.1350228502217, -479.04487836870493, -1116.277688118275, -1207.9440940319719, -184.66267936087718, 18.033215646789582, -755.709174363193, -1463.3869146066027, 10.468400714358715, -1127.3255935702382, -947.6950021402184, -589.4060946814848, -889.7510999530043, -389.6195661077145, 36.44945346466114, -1153.5409363384415, -1254.9257568138069, 395.89675998993977, 30.80342422623352, -435.40048885664083, -690.3144590816217, 24.34703320108461, -1020.3647199063269, 186.69882885294106, -1220.621900198291, 291.01134931181406, -583.7187210721509, -1323.3541111492593, -1412.047369658606, -995.2254257373646, -871.5507772633364, -1384.3153931997138, -155.7834343271904, -108.99725952622089, -1018.1965058524202, -860.4459838319196, -1351.1842769475875, 38.781966011250404, -1053.120172727591, -1037.0052784854197, -953.3986779726617, -252.3132935575661, -1255.364340862334, -1345.2653800017474, -852.5265656297545, -967.7009510176824, 28.765429785646766, -1319.4364284349308], "policy_predator_policy_reward": [1009.2719372477615, 693.5599162534062, 979.6997703870995, 1118.075972646708, 720.3097911715795, 881.6090133000528, 838.288089244753, 1063.1264138337003, 915.8074763824234, 741.0280986762486, 1134.6430251395295, 1068.0163582786774, 1092.1624759855627, 1253.8178875692804, 1331.8538747484668, 1243.1707568087736, 802.4037135231752, 962.3066133874877, 847.6559798478055, 887.5571579242472, 1079.8971136612497, 909.3502813089684, 1342.874245796453, 1010.9912556531533, 610.2309610006558, 983.2726740972396, 1171.2952504368568, 916.311363290205, 524.2186811089769, 859.0379115897565, 968.7659990591499, 844.0203857956618, 1076.9079978043196, 1390.4831394698572, 1176.5412924752418, 978.8773364517452, 1197.393558854839, 575.0400968987351, 387.3670275824382, 919.1156738778742, 1021.9558733567608, 461.67476627889914, 1097.3680473252286, 1004.56338647293, 357.09645862731514, 471.51970166945375, 561.5044182720998, 551.8384546628839, 1087.8412810064528, 1167.4368184489379, 1141.719312443752, 1102.3674737679275, 1113.950452145719, 1206.1320299183285, 1229.554383091059, 628.4203327122161, 815.8073363513953, 983.478875053061, 1178.5431372766327, 201.7206684047501, 795.3278771225168, 1084.5486293239417, 1304.7987690341806, 493.2610705288984, 1037.9338577851772, 559.756123391088, 927.3048045552528, 1038.7266505536707, 1026.5169313062427, 1091.6480176566013, 974.4838846683937, 508.9532633621246, 733.7036870158325, 447.9237653371547, 911.4057039071257, 437.03048764629506, 897.8730866993827, 578.6502308568148, 1245.5815615683807, 1133.8113211724472, 1097.1564389126038, 970.3324545233364, 1091.1106569265241, 12.61702079857614, 1022.0644368475679, 1201.2284997402687, 375.400810252964, 549.2947219334118, 764.9214131588816, 1109.0889479491655, 404.9273931015431, 704.5055382132945, 1282.8851211582667, 1434.6506305461653, 1153.6623387454847, 1280.343826887945, 672.1423495428813, 951.5573853706808, 602.7274235360118, 1238.9612744091582, 6.353232412162486, 6.343353600717938, 834.2543354122795, 1079.5166962845797, 1361.6058827031593, 1015.3252588653556, 1146.458511114094, 1377.2412591002662, 1128.4698876612495, 664.1639195093143, 693.3807759570689, 1091.222781222415, 1171.8602550013156, 1183.524670596063, 451.49143140484756, 701.789305026229, 1137.1541269302281, 1121.7917182490876, 1090.5098907038805, 1117.8630393290005, 1043.6944460451268, 935.8082255277128, 1294.5613798932354, 966.4034251770353, 1067.406530002593, 850.0107192556087, 1302.4952069126468, 1139.644228716852, 1211.6438632141121, 708.8763822648443, 420.21375166347747, 1216.829360699627, 82.38263748093497, 693.9952957790217, 641.8387155697048, 554.4317896295173, 1466.132835552609, 178.72613154063984, 653.558031693581, 768.6838100267544, 881.1432858906613, 1221.3800580412465, 902.9757983097231, 1382.772080946504, 1236.9571509036066, 65.16298529129999, 855.0982071669372, 937.8739889863549, 955.5467629512219, 376.5405769344911, 1234.0288617641822, 1247.9882660127744, 797.2549104279814, 1165.4138820039534, 1203.7461746054091, 1097.6898306994449, 58.260998892311676, 365.8684648217759, 1034.0250028388116, 1410.8631239517533, 33.95071677996267, 1128.425593570238, 1101.3682790735174, 577.6801232743111, 861.6395727233675, 849.4498210886667, 1178.4530886500377, 15.149615665322191, 1253.800100912491, 65.23497685759682, 624.8060527467096, 4.337910629307837, 747.4814575149829, 87.32921482591102, 0.0, 1222.0281853902006, 1222.3698345967514, 8.5635556224441, 1131.4761283951689, 917.7071631506084, 1412.3473696586059, 998.6811639226797, 876.1507772633373, 1384.3153931997138, 260.1212837727711, 10.394364961068867, 976.7413137072822, 1117.709790860315, 594.6327303395024, 1154.7977407542082, 1143.60691146056, 1159.957387394784, 994.8762530302299, 416.0866120485307, 1261.564340862334, 1345.125938841231, 921.7265656297545, 972.3009510176834, 382.97062482480646, 1134.3907060598497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.821356610811898, "mean_inference_ms": 4.5058921645983965, "mean_action_processing_ms": 1.6408425370578468, "mean_env_wait_ms": 10.310299872297335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010996341705322266, "StateBufferConnector_ms": 0.014687418937683105, "ViewRequirementAgentConnector_ms": 0.2672041654586792}, "num_episodes": 10, "episode_return_max": 624.1799640455768, "episode_return_min": -22.78577684539289, "episode_return_mean": 185.44527881479434, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.4338292169343, "num_env_steps_trained_throughput_per_sec": 82.4338292169343, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 50929.8, "restore_workers_time_ms": 0.013, "training_step_time_ms": 50929.709, "sample_time_ms": 2776.467, "learn_time_ms": 48130.137, "learn_throughput": 83.108, "synch_weights_time_ms": 16.712}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "35fb9_00000", "date": "2024-08-22_08-24-43", "timestamp": 1724295283, "time_this_iter_s": 48.56977319717407, "time_total_s": 1862.2697701454163, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fca9e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1862.2697701454163, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.15507246376812, "ram_util_percent": 81.9144927536232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.502048090526037, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.647143810766715, "policy_loss": -0.02530382638821802, "vf_loss": 7.668654537200927, "vf_explained_var": 0.39542274424638696, "kl": 0.018965512555999257, "entropy": 0.8628429436809802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.263841384554667, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.92728530742504, "policy_loss": -0.014708351913750882, "vf_loss": 7.939849331265404, "vf_explained_var": 0.3111481089440603, "kl": 0.010721534133824722, "entropy": 0.6346899372402323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 803.5928139312634, "episode_reward_min": -22.78577684539289, "episode_reward_mean": 195.2925179577627, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1466.132835552609, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.89675998993977, "predator_policy": 1466.132835552609}, "policy_reward_mean": {"prey_policy": -767.535477192067, "predator_policy": 865.1817361709489}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.61515519412544, 223.29910725422337, 365.7412097859951, 20.46538523146517, 386.4331723563776, 35.610704072035006, 368.0871626092377, 117.99431190146842, 35.79999999999989, 329.12174537623446, 269.548469111097, 530.1150699945186, 190.57768496807745, 98.3788368027139, 293.4556298513983, 364.65813167932527, 21.723624251570293, 13.536371190979274, 30.934129528086793, 293.8404852194577, 96.10511964865916, 314.9238919699011, 180.73873419839006, 462.5682157612234, 27.695973337486997, 206.76632386062147, 4.685502285455671, 27.712678125181764, 624.1799640455768, 275.69170081527085, 419.5267505245731, 49.99999999999996, 6.116778274515148, 132.81702079857422, 102.88880312459129, 335.6278724266723, 82.80773031873045, 478.40849076526763, -1.0658141036401503e-14, 35.5389570509545, 472.92134814121454, 12.99803839362955, 83.83802286480234, 308.6972336320149, 63.29054530003693, 2.5797565030212706, 231.9873233741841, 375.635811654235, 159.50819102288918, 364.58666537590364, -1.2037269366120085, 51.15630222387081, 206.32426615586542, 38.28350042171058, 398.34271767459904, 40.218336116081694, 137.32419719795692, 54.83357184285424, 236.5313926929539, 176.76270968463942, 40.465563920660486, 449.01866055124316, 87.28628976253043, 96.6, 254.84641676694608, 104.76323822324429, 325.6769566158748, 37.50703095326301, 122.48889121300074, -22.78577684539289, 257.4999999999983, 225.79203782076848, 45.519117494321534, 141.94730552611946, 431.71872775131493, 76.5112214415783, 460.00608094622066, 224.54689874560844, 168.84324646035506, 388.36229433681495, 301.32283933271856, 142.11045932436184, 3.755738185314335, 4.600000000000001, 5.734954880429133, 215.8086148832542, 437.0281601573768, 213.43884764233243, 205.250893548533, 6.060558839483537, 73.8, 226.69033223536985, 440.9075003777252, 34.348539776252686, 39.90000000000029, 361.64118641947294, 280.60338631133493, 64.07597132244119, 803.5928139312634, 397.61369987825316], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-770.43703104435, -908.6581406721878, -845.2973849918408, -666.6166455259892, -533.8658950441563, -1089.6402901400659, -1340.4093217185439, -992.990794499597, -839.00441318795, -368.0660495535674, -1127.674187866734, -924.3217217882932, 36.76800744374211, -1051.9374375332395, -858.3716871576815, -836.4203857956617, -1041.1079978043197, -1390.4831394698572, -866.3656651362168, -959.9312184145358, -1205.2420416727869, -297.64314496968785, 152.8723237658262, -929.2399552316195, -1012.1949681279489, -280.85798653963184, -859.8265048260404, -1143.7260921694046, -385.3302755475502, -149.83025489782236, -434.3050720116926, -314.37966924396505, -1067.8487030478468, -1165.705772155972, -1136.7396546689622, -1093.8107603517383, -1315.5191785422564, -973.6291739937041, -1232.6451110154255, -331.4891195683923, -969.601340383899, -733.5797513718973, 61.94468311709932, -1127.2845968285812, -1127.3919302613426, -571.7458419867271, -1421.1595134025292, 85.66788960067468, -1035.6338577851766, -534.3601500535975, -559.6159236702973, -1199.6492075780025, -1024.1169313062426, -1089.3625153711462, -322.86181388257694, -1132.8626560227508, 282.99822183565755, -840.4457101430698, 102.91299990456788, -1175.6574906427188, -808.1760622927474, -248.82050473887784, -1238.5815615683807, -1090.811321172447, -1091.5371345657143, -969.8349805957108, -80.36030866135998, -890.5503482651658, -1081.3583808202152, -1039.045752643029, 168.2450196021555, -757.312679361859, -922.9678253559016, -868.2348054334165, -101.44841851526897, -529.5760220343005, -1282.8851211582667, -1434.6506305461653, -1114.0736896716521, -1284.3935189108238, -985.8540957635665, -164.92429100878022, -589.8293851423801, -1238.861274409158, 40.0000000000003, 31.141436851922567, -1208.0111627749982, -397.06263528984726, -1364.0386097894245, -949.6019864790512, -1143.8787546110727, -1377.2412591002662, -1171.298016996429, -389.34846679994837, -208.82100959596283, -1200.146735929287, -935.634203405512, -1260.2425311689785, -259.1658504566807, -529.5282205984918, -1126.9694079175067, -1133.1801641984202, -1039.965380512947, -1117.251247296063, -1076.8228165490825, -696.3555888678892, -1291.1157421518808, -931.5655624966791, -898.7613525502709, -620.3131790333332, -1298.3680443565174, -1103.5530551568982, -1198.8142644567056, -584.3817838242941, -369.1801798206177, -1213.0293606996272, -574.4874584384766, 34.64091787147546, 38.93164634197064, -1058.4394418565512, -1466.132835552609, -138.26056761998157, 255.87512109245102, -1229.098302261542, -1174.1503116794147, -841.0867424899625, -806.3757983097235, -1382.772080946504, -910.6687241843559, -136.6049952435986, -548.0362619313721, -1140.1726959986752, -196.48000941737317, -809.9303738524643, -1216.0096442400134, -1228.500452583681, -1361.1350228502217, -479.04487836870493, -1116.277688118275, -1207.9440940319719, -184.66267936087718, 18.033215646789582, -755.709174363193, -1463.3869146066027, 10.468400714358715, -1127.3255935702382, -947.6950021402184, -589.4060946814848, -889.7510999530043, -389.6195661077145, 36.44945346466114, -1153.5409363384415, -1254.9257568138069, 395.89675998993977, 30.80342422623352, -435.40048885664083, -690.3144590816217, 24.34703320108461, -1020.3647199063269, 186.69882885294106, -1220.621900198291, 291.01134931181406, -583.7187210721509, -1323.3541111492593, -1412.047369658606, -995.2254257373646, -871.5507772633364, -1384.3153931997138, -155.7834343271904, -108.99725952622089, -1018.1965058524202, -860.4459838319196, -1351.1842769475875, 38.781966011250404, -1053.120172727591, -1037.0052784854197, -953.3986779726617, -252.3132935575661, -1255.364340862334, -1345.2653800017474, -852.5265656297545, -967.7009510176824, 28.765429785646766, -1319.4364284349308, 284.06219512041696, -914.5540754246149, -1173.767356461005, 25.287523958660884, 39.080632075266166, -1298.5293298080994, -818.8236386551667, -556.0813607706591, 40.0000000000003, -1294.9081369677494, -1102.9077362158691, -1339.9317609966142, 141.52673234976245, -1153.5780565673208, -351.85520108157084, -625.4601222540829], "policy_predator_policy_reward": [802.4037135231752, 962.3066133874877, 847.6559798478055, 887.5571579242472, 1079.8971136612497, 909.3502813089684, 1342.874245796453, 1010.9912556531533, 610.2309610006558, 983.2726740972396, 1171.2952504368568, 916.311363290205, 524.2186811089769, 859.0379115897565, 968.7659990591499, 844.0203857956618, 1076.9079978043196, 1390.4831394698572, 1176.5412924752418, 978.8773364517452, 1197.393558854839, 575.0400968987351, 387.3670275824382, 919.1156738778742, 1021.9558733567608, 461.67476627889914, 1097.3680473252286, 1004.56338647293, 357.09645862731514, 471.51970166945375, 561.5044182720998, 551.8384546628839, 1087.8412810064528, 1167.4368184489379, 1141.719312443752, 1102.3674737679275, 1113.950452145719, 1206.1320299183285, 1229.554383091059, 628.4203327122161, 815.8073363513953, 983.478875053061, 1178.5431372766327, 201.7206684047501, 795.3278771225168, 1084.5486293239417, 1304.7987690341806, 493.2610705288984, 1037.9338577851772, 559.756123391088, 927.3048045552528, 1038.7266505536707, 1026.5169313062427, 1091.6480176566013, 974.4838846683937, 508.9532633621246, 733.7036870158325, 447.9237653371547, 911.4057039071257, 437.03048764629506, 897.8730866993827, 578.6502308568148, 1245.5815615683807, 1133.8113211724472, 1097.1564389126038, 970.3324545233364, 1091.1106569265241, 12.61702079857614, 1022.0644368475679, 1201.2284997402687, 375.400810252964, 549.2947219334118, 764.9214131588816, 1109.0889479491655, 404.9273931015431, 704.5055382132945, 1282.8851211582667, 1434.6506305461653, 1153.6623387454847, 1280.343826887945, 672.1423495428813, 951.5573853706808, 602.7274235360118, 1238.9612744091582, 6.353232412162486, 6.343353600717938, 834.2543354122795, 1079.5166962845797, 1361.6058827031593, 1015.3252588653556, 1146.458511114094, 1377.2412591002662, 1128.4698876612495, 664.1639195093143, 693.3807759570689, 1091.222781222415, 1171.8602550013156, 1183.524670596063, 451.49143140484756, 701.789305026229, 1137.1541269302281, 1121.7917182490876, 1090.5098907038805, 1117.8630393290005, 1043.6944460451268, 935.8082255277128, 1294.5613798932354, 966.4034251770353, 1067.406530002593, 850.0107192556087, 1302.4952069126468, 1139.644228716852, 1211.6438632141121, 708.8763822648443, 420.21375166347747, 1216.829360699627, 82.38263748093497, 693.9952957790217, 641.8387155697048, 554.4317896295173, 1466.132835552609, 178.72613154063984, 653.558031693581, 768.6838100267544, 881.1432858906613, 1221.3800580412465, 902.9757983097231, 1382.772080946504, 1236.9571509036066, 65.16298529129999, 855.0982071669372, 937.8739889863549, 955.5467629512219, 376.5405769344911, 1234.0288617641822, 1247.9882660127744, 797.2549104279814, 1165.4138820039534, 1203.7461746054091, 1097.6898306994449, 58.260998892311676, 365.8684648217759, 1034.0250028388116, 1410.8631239517533, 33.95071677996267, 1128.425593570238, 1101.3682790735174, 577.6801232743111, 861.6395727233675, 849.4498210886667, 1178.4530886500377, 15.149615665322191, 1253.800100912491, 65.23497685759682, 624.8060527467096, 4.337910629307837, 747.4814575149829, 87.32921482591102, 0.0, 1222.0281853902006, 1222.3698345967514, 8.5635556224441, 1131.4761283951689, 917.7071631506084, 1412.3473696586059, 998.6811639226797, 876.1507772633373, 1384.3153931997138, 260.1212837727711, 10.394364961068867, 976.7413137072822, 1117.709790860315, 594.6327303395024, 1154.7977407542082, 1143.60691146056, 1159.957387394784, 994.8762530302299, 416.0866120485307, 1261.564340862334, 1345.125938841231, 921.7265656297545, 972.3009510176834, 382.97062482480646, 1134.3907060598497, 926.5160077234425, 144.88337295848095, 1173.8810583350473, 8.947313943549648, 0.8193679247341232, 1298.5293298080994, 574.4206238994072, 1162.1255619458902, 270.0088957891376, 1265.502627489944, 1157.9671269209105, 1348.948341614015, 1029.6904340164544, 785.9537041323682, 673.9449253448763, 700.9840978690323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.82860702693563, "mean_inference_ms": 4.477313377210209, "mean_action_processing_ms": 1.652360614961018, "mean_env_wait_ms": 10.316360395809339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011011123657226562, "StateBufferConnector_ms": 0.014684915542602539, "ViewRequirementAgentConnector_ms": 0.25045037269592285}, "num_episodes": 8, "episode_return_max": 803.5928139312634, "episode_return_min": -22.78577684539289, "episode_return_mean": 195.2925179577627, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.79114995872382, "num_env_steps_trained_throughput_per_sec": 78.79114995872382, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 51254.233, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51254.141, "sample_time_ms": 2871.69, "learn_time_ms": 48358.657, "learn_throughput": 82.715, "synch_weights_time_ms": 17.341}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "35fb9_00000", "date": "2024-08-22_08-25-34", "timestamp": 1724295334, "time_this_iter_s": 50.81728911399841, "time_total_s": 1913.0870592594147, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0f733a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1913.0870592594147, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 33.29305555555556, "ram_util_percent": 83.00833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.985077068982301, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.478665311500509, "policy_loss": -0.02348553772742254, "vf_loss": 7.498963906273009, "vf_explained_var": 0.434683392949836, "kl": 0.015934689813318154, "entropy": 0.8052058364348437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.791948766430849, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.930137228335022, "policy_loss": -0.016439294548232168, "vf_loss": 7.9440787602984715, "vf_explained_var": 0.37138802106418306, "kl": 0.0124888089142996, "entropy": 0.589214119189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 803.5928139312634, "episode_reward_min": -22.78577684539289, "episode_reward_mean": 194.06118950686638, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1526.0919420387872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.89675998993977, "predator_policy": 1526.0919420387872}, "policy_reward_mean": {"prey_policy": -761.5311952675646, "predator_policy": 858.561790020998}, "custom_metrics": {}, "hist_stats": {"episode_reward": [530.1150699945186, 190.57768496807745, 98.3788368027139, 293.4556298513983, 364.65813167932527, 21.723624251570293, 13.536371190979274, 30.934129528086793, 293.8404852194577, 96.10511964865916, 314.9238919699011, 180.73873419839006, 462.5682157612234, 27.695973337486997, 206.76632386062147, 4.685502285455671, 27.712678125181764, 624.1799640455768, 275.69170081527085, 419.5267505245731, 49.99999999999996, 6.116778274515148, 132.81702079857422, 102.88880312459129, 335.6278724266723, 82.80773031873045, 478.40849076526763, -1.0658141036401503e-14, 35.5389570509545, 472.92134814121454, 12.99803839362955, 83.83802286480234, 308.6972336320149, 63.29054530003693, 2.5797565030212706, 231.9873233741841, 375.635811654235, 159.50819102288918, 364.58666537590364, -1.2037269366120085, 51.15630222387081, 206.32426615586542, 38.28350042171058, 398.34271767459904, 40.218336116081694, 137.32419719795692, 54.83357184285424, 236.5313926929539, 176.76270968463942, 40.465563920660486, 449.01866055124316, 87.28628976253043, 96.6, 254.84641676694608, 104.76323822324429, 325.6769566158748, 37.50703095326301, 122.48889121300074, -22.78577684539289, 257.4999999999983, 225.79203782076848, 45.519117494321534, 141.94730552611946, 431.71872775131493, 76.5112214415783, 460.00608094622066, 224.54689874560844, 168.84324646035506, 388.36229433681495, 301.32283933271856, 142.11045932436184, 3.755738185314335, 4.600000000000001, 5.734954880429133, 215.8086148832542, 437.0281601573768, 213.43884764233243, 205.250893548533, 6.060558839483537, 73.8, 226.69033223536985, 440.9075003777252, 34.348539776252686, 39.90000000000029, 361.64118641947294, 280.60338631133493, 64.07597132244119, 803.5928139312634, 397.61369987825316, 141.28348940320055, 123.31050606621059, 79.68773447853229, 199.35318320746345, 541.7480666130741, 39.10000000000023, 195.96866140365955, 1.3131769954423262, 593.193251124573, 143.2255085104704, 56.40000000000053], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [152.8723237658262, -929.2399552316195, -1012.1949681279489, -280.85798653963184, -859.8265048260404, -1143.7260921694046, -385.3302755475502, -149.83025489782236, -434.3050720116926, -314.37966924396505, -1067.8487030478468, -1165.705772155972, -1136.7396546689622, -1093.8107603517383, -1315.5191785422564, -973.6291739937041, -1232.6451110154255, -331.4891195683923, -969.601340383899, -733.5797513718973, 61.94468311709932, -1127.2845968285812, -1127.3919302613426, -571.7458419867271, -1421.1595134025292, 85.66788960067468, -1035.6338577851766, -534.3601500535975, -559.6159236702973, -1199.6492075780025, -1024.1169313062426, -1089.3625153711462, -322.86181388257694, -1132.8626560227508, 282.99822183565755, -840.4457101430698, 102.91299990456788, -1175.6574906427188, -808.1760622927474, -248.82050473887784, -1238.5815615683807, -1090.811321172447, -1091.5371345657143, -969.8349805957108, -80.36030866135998, -890.5503482651658, -1081.3583808202152, -1039.045752643029, 168.2450196021555, -757.312679361859, -922.9678253559016, -868.2348054334165, -101.44841851526897, -529.5760220343005, -1282.8851211582667, -1434.6506305461653, -1114.0736896716521, -1284.3935189108238, -985.8540957635665, -164.92429100878022, -589.8293851423801, -1238.861274409158, 40.0000000000003, 31.141436851922567, -1208.0111627749982, -397.06263528984726, -1364.0386097894245, -949.6019864790512, -1143.8787546110727, -1377.2412591002662, -1171.298016996429, -389.34846679994837, -208.82100959596283, -1200.146735929287, -935.634203405512, -1260.2425311689785, -259.1658504566807, -529.5282205984918, -1126.9694079175067, -1133.1801641984202, -1039.965380512947, -1117.251247296063, -1076.8228165490825, -696.3555888678892, -1291.1157421518808, -931.5655624966791, -898.7613525502709, -620.3131790333332, -1298.3680443565174, -1103.5530551568982, -1198.8142644567056, -584.3817838242941, -369.1801798206177, -1213.0293606996272, -574.4874584384766, 34.64091787147546, 38.93164634197064, -1058.4394418565512, -1466.132835552609, -138.26056761998157, 255.87512109245102, -1229.098302261542, -1174.1503116794147, -841.0867424899625, -806.3757983097235, -1382.772080946504, -910.6687241843559, -136.6049952435986, -548.0362619313721, -1140.1726959986752, -196.48000941737317, -809.9303738524643, -1216.0096442400134, -1228.500452583681, -1361.1350228502217, -479.04487836870493, -1116.277688118275, -1207.9440940319719, -184.66267936087718, 18.033215646789582, -755.709174363193, -1463.3869146066027, 10.468400714358715, -1127.3255935702382, -947.6950021402184, -589.4060946814848, -889.7510999530043, -389.6195661077145, 36.44945346466114, -1153.5409363384415, -1254.9257568138069, 395.89675998993977, 30.80342422623352, -435.40048885664083, -690.3144590816217, 24.34703320108461, -1020.3647199063269, 186.69882885294106, -1220.621900198291, 291.01134931181406, -583.7187210721509, -1323.3541111492593, -1412.047369658606, -995.2254257373646, -871.5507772633364, -1384.3153931997138, -155.7834343271904, -108.99725952622089, -1018.1965058524202, -860.4459838319196, -1351.1842769475875, 38.781966011250404, -1053.120172727591, -1037.0052784854197, -953.3986779726617, -252.3132935575661, -1255.364340862334, -1345.2653800017474, -852.5265656297545, -967.7009510176824, 28.765429785646766, -1319.4364284349308, 284.06219512041696, -914.5540754246149, -1173.767356461005, 25.287523958660884, 39.080632075266166, -1298.5293298080994, -818.8236386551667, -556.0813607706591, 40.0000000000003, -1294.9081369677494, -1102.9077362158691, -1339.9317609966142, 141.52673234976245, -1153.5780565673208, -351.85520108157084, -625.4601222540829, 14.951809933662428, -1057.7966103451015, -987.298873018195, -1256.237251400814, -270.51361869698485, -1052.5903416706728, -1002.8836687860454, -597.387179308407, -1328.9095453465611, -407.29727862098997, -1331.485352088185, 29.85168888052417, -931.4256249925079, -870.5639810075702, -1349.974368748372, -1297.4938521207127, -131.0824782701275, -1119.820897122181, -524.8243454284623, -1526.0919420387872, -8.723815875488201, -669.2626755710035], "policy_predator_policy_reward": [387.3670275824382, 919.1156738778742, 1021.9558733567608, 461.67476627889914, 1097.3680473252286, 1004.56338647293, 357.09645862731514, 471.51970166945375, 561.5044182720998, 551.8384546628839, 1087.8412810064528, 1167.4368184489379, 1141.719312443752, 1102.3674737679275, 1113.950452145719, 1206.1320299183285, 1229.554383091059, 628.4203327122161, 815.8073363513953, 983.478875053061, 1178.5431372766327, 201.7206684047501, 795.3278771225168, 1084.5486293239417, 1304.7987690341806, 493.2610705288984, 1037.9338577851772, 559.756123391088, 927.3048045552528, 1038.7266505536707, 1026.5169313062427, 1091.6480176566013, 974.4838846683937, 508.9532633621246, 733.7036870158325, 447.9237653371547, 911.4057039071257, 437.03048764629506, 897.8730866993827, 578.6502308568148, 1245.5815615683807, 1133.8113211724472, 1097.1564389126038, 970.3324545233364, 1091.1106569265241, 12.61702079857614, 1022.0644368475679, 1201.2284997402687, 375.400810252964, 549.2947219334118, 764.9214131588816, 1109.0889479491655, 404.9273931015431, 704.5055382132945, 1282.8851211582667, 1434.6506305461653, 1153.6623387454847, 1280.343826887945, 672.1423495428813, 951.5573853706808, 602.7274235360118, 1238.9612744091582, 6.353232412162486, 6.343353600717938, 834.2543354122795, 1079.5166962845797, 1361.6058827031593, 1015.3252588653556, 1146.458511114094, 1377.2412591002662, 1128.4698876612495, 664.1639195093143, 693.3807759570689, 1091.222781222415, 1171.8602550013156, 1183.524670596063, 451.49143140484756, 701.789305026229, 1137.1541269302281, 1121.7917182490876, 1090.5098907038805, 1117.8630393290005, 1043.6944460451268, 935.8082255277128, 1294.5613798932354, 966.4034251770353, 1067.406530002593, 850.0107192556087, 1302.4952069126468, 1139.644228716852, 1211.6438632141121, 708.8763822648443, 420.21375166347747, 1216.829360699627, 82.38263748093497, 693.9952957790217, 641.8387155697048, 554.4317896295173, 1466.132835552609, 178.72613154063984, 653.558031693581, 768.6838100267544, 881.1432858906613, 1221.3800580412465, 902.9757983097231, 1382.772080946504, 1236.9571509036066, 65.16298529129999, 855.0982071669372, 937.8739889863549, 955.5467629512219, 376.5405769344911, 1234.0288617641822, 1247.9882660127744, 797.2549104279814, 1165.4138820039534, 1203.7461746054091, 1097.6898306994449, 58.260998892311676, 365.8684648217759, 1034.0250028388116, 1410.8631239517533, 33.95071677996267, 1128.425593570238, 1101.3682790735174, 577.6801232743111, 861.6395727233675, 849.4498210886667, 1178.4530886500377, 15.149615665322191, 1253.800100912491, 65.23497685759682, 624.8060527467096, 4.337910629307837, 747.4814575149829, 87.32921482591102, 0.0, 1222.0281853902006, 1222.3698345967514, 8.5635556224441, 1131.4761283951689, 917.7071631506084, 1412.3473696586059, 998.6811639226797, 876.1507772633373, 1384.3153931997138, 260.1212837727711, 10.394364961068867, 976.7413137072822, 1117.709790860315, 594.6327303395024, 1154.7977407542082, 1143.60691146056, 1159.957387394784, 994.8762530302299, 416.0866120485307, 1261.564340862334, 1345.125938841231, 921.7265656297545, 972.3009510176834, 382.97062482480646, 1134.3907060598497, 926.5160077234425, 144.88337295848095, 1173.8810583350473, 8.947313943549648, 0.8193679247341232, 1298.5293298080994, 574.4206238994072, 1162.1255619458902, 270.0088957891376, 1265.502627489944, 1157.9671269209105, 1348.948341614015, 1029.6904340164544, 785.9537041323682, 673.9449253448763, 700.9840978690323, 441.45504674161936, 742.6732430730187, 1298.6196276787734, 1068.2270028064484, 346.50135317552343, 1056.2903416706738, 519.4885164338097, 1280.13551486811, 1202.5069823556942, 1075.4479082249313, 1331.485352088185, 9.248311119475972, 1279.1081352004762, 718.8501322032603, 1349.974368748372, 1298.8070291161548, 890.952689750753, 953.1439367661324, 668.0498539389292, 1526.0919420387872, 46.2238158754886, 688.1626755710078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.846928237170999, "mean_inference_ms": 4.492122848900377, "mean_action_processing_ms": 1.6495116450520408, "mean_env_wait_ms": 10.33684789356873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010765314102172852, "StateBufferConnector_ms": 0.014432191848754883, "ViewRequirementAgentConnector_ms": 0.247125506401062}, "num_episodes": 11, "episode_return_max": 803.5928139312634, "episode_return_min": -22.78577684539289, "episode_return_mean": 194.06118950686638, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.99874507648056, "num_env_steps_trained_throughput_per_sec": 73.99874507648056, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 51930.03, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51929.929, "sample_time_ms": 2945.423, "learn_time_ms": 48959.045, "learn_throughput": 81.701, "synch_weights_time_ms": 18.865}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "35fb9_00000", "date": "2024-08-22_08-26-28", "timestamp": 1724295388, "time_this_iter_s": 54.107874155044556, "time_total_s": 1967.1949334144592, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc89ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1967.1949334144592, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 40.967532467532465, "ram_util_percent": 82.81818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.403324771999682, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.82712130344734, "policy_loss": -0.022692287031304898, "vf_loss": 7.846756680554183, "vf_explained_var": 0.4222026754939367, "kl": 0.015284487790373898, "entropy": 0.7854700276775965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.520997464278388, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.845465365919487, "policy_loss": -0.01607133911321403, "vf_loss": 7.859139157350732, "vf_explained_var": 0.31311646504376933, "kl": 0.011987667137549982, "entropy": 0.5788852783107253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 803.5928139312634, "episode_reward_min": -22.78577684539289, "episode_reward_mean": 192.29680563530562, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1526.0919420387872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.89675998993977, "predator_policy": 1526.0919420387872}, "policy_reward_mean": {"prey_policy": -764.9859130818775, "predator_policy": 861.1343158995307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [275.69170081527085, 419.5267505245731, 49.99999999999996, 6.116778274515148, 132.81702079857422, 102.88880312459129, 335.6278724266723, 82.80773031873045, 478.40849076526763, -1.0658141036401503e-14, 35.5389570509545, 472.92134814121454, 12.99803839362955, 83.83802286480234, 308.6972336320149, 63.29054530003693, 2.5797565030212706, 231.9873233741841, 375.635811654235, 159.50819102288918, 364.58666537590364, -1.2037269366120085, 51.15630222387081, 206.32426615586542, 38.28350042171058, 398.34271767459904, 40.218336116081694, 137.32419719795692, 54.83357184285424, 236.5313926929539, 176.76270968463942, 40.465563920660486, 449.01866055124316, 87.28628976253043, 96.6, 254.84641676694608, 104.76323822324429, 325.6769566158748, 37.50703095326301, 122.48889121300074, -22.78577684539289, 257.4999999999983, 225.79203782076848, 45.519117494321534, 141.94730552611946, 431.71872775131493, 76.5112214415783, 460.00608094622066, 224.54689874560844, 168.84324646035506, 388.36229433681495, 301.32283933271856, 142.11045932436184, 3.755738185314335, 4.600000000000001, 5.734954880429133, 215.8086148832542, 437.0281601573768, 213.43884764233243, 205.250893548533, 6.060558839483537, 73.8, 226.69033223536985, 440.9075003777252, 34.348539776252686, 39.90000000000029, 361.64118641947294, 280.60338631133493, 64.07597132244119, 803.5928139312634, 397.61369987825316, 141.28348940320055, 123.31050606621059, 79.68773447853229, 199.35318320746345, 541.7480666130741, 39.10000000000023, 195.96866140365955, 1.3131769954423262, 593.193251124573, 143.2255085104704, 56.40000000000053, 313.7126033869613, 301.3695866310617, 90.9930601175686, 196.96970087151493, 1.169618614645306, 14.100000000000003, 389.75566424096013, 20.036437564453507, 196.764840795412, 740.6404930021706, 9.36583317679591, -1.9673909032067418, 206.28561467372103, 125.01156907015547, 385.50000000000205, 184.76397239799243, 135.69930918801973, 295.9870667343166], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [102.91299990456788, -1175.6574906427188, -808.1760622927474, -248.82050473887784, -1238.5815615683807, -1090.811321172447, -1091.5371345657143, -969.8349805957108, -80.36030866135998, -890.5503482651658, -1081.3583808202152, -1039.045752643029, 168.2450196021555, -757.312679361859, -922.9678253559016, -868.2348054334165, -101.44841851526897, -529.5760220343005, -1282.8851211582667, -1434.6506305461653, -1114.0736896716521, -1284.3935189108238, -985.8540957635665, -164.92429100878022, -589.8293851423801, -1238.861274409158, 40.0000000000003, 31.141436851922567, -1208.0111627749982, -397.06263528984726, -1364.0386097894245, -949.6019864790512, -1143.8787546110727, -1377.2412591002662, -1171.298016996429, -389.34846679994837, -208.82100959596283, -1200.146735929287, -935.634203405512, -1260.2425311689785, -259.1658504566807, -529.5282205984918, -1126.9694079175067, -1133.1801641984202, -1039.965380512947, -1117.251247296063, -1076.8228165490825, -696.3555888678892, -1291.1157421518808, -931.5655624966791, -898.7613525502709, -620.3131790333332, -1298.3680443565174, -1103.5530551568982, -1198.8142644567056, -584.3817838242941, -369.1801798206177, -1213.0293606996272, -574.4874584384766, 34.64091787147546, 38.93164634197064, -1058.4394418565512, -1466.132835552609, -138.26056761998157, 255.87512109245102, -1229.098302261542, -1174.1503116794147, -841.0867424899625, -806.3757983097235, -1382.772080946504, -910.6687241843559, -136.6049952435986, -548.0362619313721, -1140.1726959986752, -196.48000941737317, -809.9303738524643, -1216.0096442400134, -1228.500452583681, -1361.1350228502217, -479.04487836870493, -1116.277688118275, -1207.9440940319719, -184.66267936087718, 18.033215646789582, -755.709174363193, -1463.3869146066027, 10.468400714358715, -1127.3255935702382, -947.6950021402184, -589.4060946814848, -889.7510999530043, -389.6195661077145, 36.44945346466114, -1153.5409363384415, -1254.9257568138069, 395.89675998993977, 30.80342422623352, -435.40048885664083, -690.3144590816217, 24.34703320108461, -1020.3647199063269, 186.69882885294106, -1220.621900198291, 291.01134931181406, -583.7187210721509, -1323.3541111492593, -1412.047369658606, -995.2254257373646, -871.5507772633364, -1384.3153931997138, -155.7834343271904, -108.99725952622089, -1018.1965058524202, -860.4459838319196, -1351.1842769475875, 38.781966011250404, -1053.120172727591, -1037.0052784854197, -953.3986779726617, -252.3132935575661, -1255.364340862334, -1345.2653800017474, -852.5265656297545, -967.7009510176824, 28.765429785646766, -1319.4364284349308, 284.06219512041696, -914.5540754246149, -1173.767356461005, 25.287523958660884, 39.080632075266166, -1298.5293298080994, -818.8236386551667, -556.0813607706591, 40.0000000000003, -1294.9081369677494, -1102.9077362158691, -1339.9317609966142, 141.52673234976245, -1153.5780565673208, -351.85520108157084, -625.4601222540829, 14.951809933662428, -1057.7966103451015, -987.298873018195, -1256.237251400814, -270.51361869698485, -1052.5903416706728, -1002.8836687860454, -597.387179308407, -1328.9095453465611, -407.29727862098997, -1331.485352088185, 29.85168888052417, -931.4256249925079, -870.5639810075702, -1349.974368748372, -1297.4938521207127, -131.0824782701275, -1119.820897122181, -524.8243454284623, -1526.0919420387872, -8.723815875488201, -669.2626755710035, -1194.304449647115, -77.78420637232534, -1422.5772248181065, -760.7838869783334, -1017.8926755740348, 12.63352604737466, 20.619653859965062, -933.5946472437262, -943.5068398352614, -1170.916030729192, -913.0634355810208, -1196.8739783556234, -132.81966185898878, -728.2829428318281, -1216.6857907770282, -924.7178821897309, -325.02798065503293, -141.29379543359588, -1392.0029376801137, 6.633182300324057, -959.969659984291, -1196.7810216973996, -1333.223979928367, -1388.4436682967817, -1014.3581339534884, -654.4063318163886, -1264.3906355238964, -737.7032802490139, 32.31224282571532, 292.2198087320103, -315.80247730464396, -1031.5480358879515, -1353.6959339843493, -857.4115750742151, -382.1481680145697, -1006.6175820201198], "policy_predator_policy_reward": [911.4057039071257, 437.03048764629506, 897.8730866993827, 578.6502308568148, 1245.5815615683807, 1133.8113211724472, 1097.1564389126038, 970.3324545233364, 1091.1106569265241, 12.61702079857614, 1022.0644368475679, 1201.2284997402687, 375.400810252964, 549.2947219334118, 764.9214131588816, 1109.0889479491655, 404.9273931015431, 704.5055382132945, 1282.8851211582667, 1434.6506305461653, 1153.6623387454847, 1280.343826887945, 672.1423495428813, 951.5573853706808, 602.7274235360118, 1238.9612744091582, 6.353232412162486, 6.343353600717938, 834.2543354122795, 1079.5166962845797, 1361.6058827031593, 1015.3252588653556, 1146.458511114094, 1377.2412591002662, 1128.4698876612495, 664.1639195093143, 693.3807759570689, 1091.222781222415, 1171.8602550013156, 1183.524670596063, 451.49143140484756, 701.789305026229, 1137.1541269302281, 1121.7917182490876, 1090.5098907038805, 1117.8630393290005, 1043.6944460451268, 935.8082255277128, 1294.5613798932354, 966.4034251770353, 1067.406530002593, 850.0107192556087, 1302.4952069126468, 1139.644228716852, 1211.6438632141121, 708.8763822648443, 420.21375166347747, 1216.829360699627, 82.38263748093497, 693.9952957790217, 641.8387155697048, 554.4317896295173, 1466.132835552609, 178.72613154063984, 653.558031693581, 768.6838100267544, 881.1432858906613, 1221.3800580412465, 902.9757983097231, 1382.772080946504, 1236.9571509036066, 65.16298529129999, 855.0982071669372, 937.8739889863549, 955.5467629512219, 376.5405769344911, 1234.0288617641822, 1247.9882660127744, 797.2549104279814, 1165.4138820039534, 1203.7461746054091, 1097.6898306994449, 58.260998892311676, 365.8684648217759, 1034.0250028388116, 1410.8631239517533, 33.95071677996267, 1128.425593570238, 1101.3682790735174, 577.6801232743111, 861.6395727233675, 849.4498210886667, 1178.4530886500377, 15.149615665322191, 1253.800100912491, 65.23497685759682, 624.8060527467096, 4.337910629307837, 747.4814575149829, 87.32921482591102, 0.0, 1222.0281853902006, 1222.3698345967514, 8.5635556224441, 1131.4761283951689, 917.7071631506084, 1412.3473696586059, 998.6811639226797, 876.1507772633373, 1384.3153931997138, 260.1212837727711, 10.394364961068867, 976.7413137072822, 1117.709790860315, 594.6327303395024, 1154.7977407542082, 1143.60691146056, 1159.957387394784, 994.8762530302299, 416.0866120485307, 1261.564340862334, 1345.125938841231, 921.7265656297545, 972.3009510176834, 382.97062482480646, 1134.3907060598497, 926.5160077234425, 144.88337295848095, 1173.8810583350473, 8.947313943549648, 0.8193679247341232, 1298.5293298080994, 574.4206238994072, 1162.1255619458902, 270.0088957891376, 1265.502627489944, 1157.9671269209105, 1348.948341614015, 1029.6904340164544, 785.9537041323682, 673.9449253448763, 700.9840978690323, 441.45504674161936, 742.6732430730187, 1298.6196276787734, 1068.2270028064484, 346.50135317552343, 1056.2903416706738, 519.4885164338097, 1280.13551486811, 1202.5069823556942, 1075.4479082249313, 1331.485352088185, 9.248311119475972, 1279.1081352004762, 718.8501322032603, 1349.974368748372, 1298.8070291161548, 890.952689750753, 953.1439367661324, 668.0498539389292, 1526.0919420387872, 46.2238158754886, 688.1626755710078, 1092.7335151570012, 493.0677442493994, 1378.5489491591177, 1106.1817492683824, 448.5732803640995, 647.6789292801313, 271.3402200944181, 838.6044741608611, 944.5068398352614, 1171.0856493438375, 914.1634355810211, 1209.8739783556234, 556.6790646272156, 694.1792043045605, 1224.1313152176572, 937.3087953135556, 34.96591211927648, 628.1207047647672, 1272.7411420327448, 853.2691063492109, 969.3354931610868, 1196.7810216973996, 1388.4258455080633, 1331.2744118138785, 1010.6894526281375, 864.3606278154681, 992.667133352878, 1134.4383514901922, 38.41940060666482, 22.548547835609792, 500.4664497026371, 1031.6480358879517, 1351.3142721082168, 995.4925461383692, 691.5819285457769, 993.1708882232329]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.869234296801344, "mean_inference_ms": 4.532028681954373, "mean_action_processing_ms": 1.640853904622355, "mean_env_wait_ms": 10.386286034719172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008306503295898438, "StateBufferConnector_ms": 0.014313101768493652, "ViewRequirementAgentConnector_ms": 0.26480138301849365}, "num_episodes": 18, "episode_return_max": 803.5928139312634, "episode_return_min": -22.78577684539289, "episode_return_mean": 192.29680563530562, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.622203565049, "num_env_steps_trained_throughput_per_sec": 75.622203565049, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 52427.842, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52427.761, "sample_time_ms": 2975.086, "learn_time_ms": 49427.957, "learn_throughput": 80.926, "synch_weights_time_ms": 19.068}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "35fb9_00000", "date": "2024-08-22_08-27-21", "timestamp": 1724295441, "time_this_iter_s": 52.949222803115845, "time_total_s": 2020.144156217575, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b611d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2020.144156217575, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 37.25066666666667, "ram_util_percent": 81.952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.526296394905716, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.631928435582963, "policy_loss": -0.021247669145533884, "vf_loss": 7.650038060183247, "vf_explained_var": 0.42532425904400134, "kl": 0.015690196194395264, "entropy": 0.8149913223016829, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.747580364456883, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.618293583077729, "policy_loss": -0.01703339463959709, "vf_loss": 7.632954758184927, "vf_explained_var": 0.37436894727131675, "kl": 0.01186107851259371, "entropy": 0.5929278333351095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 803.5928139312634, "episode_reward_min": -22.78577684539289, "episode_reward_mean": 189.7020321232898, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1526.0919420387872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.89675998993977, "predator_policy": 1526.0919420387872}, "policy_reward_mean": {"prey_policy": -757.0421684295299, "predator_policy": 851.893184491175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0658141036401503e-14, 35.5389570509545, 472.92134814121454, 12.99803839362955, 83.83802286480234, 308.6972336320149, 63.29054530003693, 2.5797565030212706, 231.9873233741841, 375.635811654235, 159.50819102288918, 364.58666537590364, -1.2037269366120085, 51.15630222387081, 206.32426615586542, 38.28350042171058, 398.34271767459904, 40.218336116081694, 137.32419719795692, 54.83357184285424, 236.5313926929539, 176.76270968463942, 40.465563920660486, 449.01866055124316, 87.28628976253043, 96.6, 254.84641676694608, 104.76323822324429, 325.6769566158748, 37.50703095326301, 122.48889121300074, -22.78577684539289, 257.4999999999983, 225.79203782076848, 45.519117494321534, 141.94730552611946, 431.71872775131493, 76.5112214415783, 460.00608094622066, 224.54689874560844, 168.84324646035506, 388.36229433681495, 301.32283933271856, 142.11045932436184, 3.755738185314335, 4.600000000000001, 5.734954880429133, 215.8086148832542, 437.0281601573768, 213.43884764233243, 205.250893548533, 6.060558839483537, 73.8, 226.69033223536985, 440.9075003777252, 34.348539776252686, 39.90000000000029, 361.64118641947294, 280.60338631133493, 64.07597132244119, 803.5928139312634, 397.61369987825316, 141.28348940320055, 123.31050606621059, 79.68773447853229, 199.35318320746345, 541.7480666130741, 39.10000000000023, 195.96866140365955, 1.3131769954423262, 593.193251124573, 143.2255085104704, 56.40000000000053, 313.7126033869613, 301.3695866310617, 90.9930601175686, 196.96970087151493, 1.169618614645306, 14.100000000000003, 389.75566424096013, 20.036437564453507, 196.764840795412, 740.6404930021706, 9.36583317679591, -1.9673909032067418, 206.28561467372103, 125.01156907015547, 385.50000000000205, 184.76397239799243, 135.69930918801973, 295.9870667343166, 347.4386349600654, 95.6578559228943, 86.64104896191652, 435.87818959966415, 319.0476106528203, 55.5613504913096, 1.2797926827002077, 15.165032730659355, 267.73827984458467], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1282.8851211582667, -1434.6506305461653, -1114.0736896716521, -1284.3935189108238, -985.8540957635665, -164.92429100878022, -589.8293851423801, -1238.861274409158, 40.0000000000003, 31.141436851922567, -1208.0111627749982, -397.06263528984726, -1364.0386097894245, -949.6019864790512, -1143.8787546110727, -1377.2412591002662, -1171.298016996429, -389.34846679994837, -208.82100959596283, -1200.146735929287, -935.634203405512, -1260.2425311689785, -259.1658504566807, -529.5282205984918, -1126.9694079175067, -1133.1801641984202, -1039.965380512947, -1117.251247296063, -1076.8228165490825, -696.3555888678892, -1291.1157421518808, -931.5655624966791, -898.7613525502709, -620.3131790333332, -1298.3680443565174, -1103.5530551568982, -1198.8142644567056, -584.3817838242941, -369.1801798206177, -1213.0293606996272, -574.4874584384766, 34.64091787147546, 38.93164634197064, -1058.4394418565512, -1466.132835552609, -138.26056761998157, 255.87512109245102, -1229.098302261542, -1174.1503116794147, -841.0867424899625, -806.3757983097235, -1382.772080946504, -910.6687241843559, -136.6049952435986, -548.0362619313721, -1140.1726959986752, -196.48000941737317, -809.9303738524643, -1216.0096442400134, -1228.500452583681, -1361.1350228502217, -479.04487836870493, -1116.277688118275, -1207.9440940319719, -184.66267936087718, 18.033215646789582, -755.709174363193, -1463.3869146066027, 10.468400714358715, -1127.3255935702382, -947.6950021402184, -589.4060946814848, -889.7510999530043, -389.6195661077145, 36.44945346466114, -1153.5409363384415, -1254.9257568138069, 395.89675998993977, 30.80342422623352, -435.40048885664083, -690.3144590816217, 24.34703320108461, -1020.3647199063269, 186.69882885294106, -1220.621900198291, 291.01134931181406, -583.7187210721509, -1323.3541111492593, -1412.047369658606, -995.2254257373646, -871.5507772633364, -1384.3153931997138, -155.7834343271904, -108.99725952622089, -1018.1965058524202, -860.4459838319196, -1351.1842769475875, 38.781966011250404, -1053.120172727591, -1037.0052784854197, -953.3986779726617, -252.3132935575661, -1255.364340862334, -1345.2653800017474, -852.5265656297545, -967.7009510176824, 28.765429785646766, -1319.4364284349308, 284.06219512041696, -914.5540754246149, -1173.767356461005, 25.287523958660884, 39.080632075266166, -1298.5293298080994, -818.8236386551667, -556.0813607706591, 40.0000000000003, -1294.9081369677494, -1102.9077362158691, -1339.9317609966142, 141.52673234976245, -1153.5780565673208, -351.85520108157084, -625.4601222540829, 14.951809933662428, -1057.7966103451015, -987.298873018195, -1256.237251400814, -270.51361869698485, -1052.5903416706728, -1002.8836687860454, -597.387179308407, -1328.9095453465611, -407.29727862098997, -1331.485352088185, 29.85168888052417, -931.4256249925079, -870.5639810075702, -1349.974368748372, -1297.4938521207127, -131.0824782701275, -1119.820897122181, -524.8243454284623, -1526.0919420387872, -8.723815875488201, -669.2626755710035, -1194.304449647115, -77.78420637232534, -1422.5772248181065, -760.7838869783334, -1017.8926755740348, 12.63352604737466, 20.619653859965062, -933.5946472437262, -943.5068398352614, -1170.916030729192, -913.0634355810208, -1196.8739783556234, -132.81966185898878, -728.2829428318281, -1216.6857907770282, -924.7178821897309, -325.02798065503293, -141.29379543359588, -1392.0029376801137, 6.633182300324057, -959.969659984291, -1196.7810216973996, -1333.223979928367, -1388.4436682967817, -1014.3581339534884, -654.4063318163886, -1264.3906355238964, -737.7032802490139, 32.31224282571532, 292.2198087320103, -315.80247730464396, -1031.5480358879515, -1353.6959339843493, -857.4115750742151, -382.1481680145697, -1006.6175820201198, 241.34967030036222, -566.7564480561216, -884.2869336362664, -1024.8669965439296, -774.7617376983952, -295.45660044477984, -1219.3542159991075, 300.23231377362424, -977.4463484695868, -79.32608313886463, -856.745862192063, -49.481830420681135, -1013.2849095117414, -1256.803208658992, -748.9890353324356, -1370.0209220733282, -13.404692871333165, -444.9628057172229], "policy_predator_policy_reward": [1282.8851211582667, 1434.6506305461653, 1153.6623387454847, 1280.343826887945, 672.1423495428813, 951.5573853706808, 602.7274235360118, 1238.9612744091582, 6.353232412162486, 6.343353600717938, 834.2543354122795, 1079.5166962845797, 1361.6058827031593, 1015.3252588653556, 1146.458511114094, 1377.2412591002662, 1128.4698876612495, 664.1639195093143, 693.3807759570689, 1091.222781222415, 1171.8602550013156, 1183.524670596063, 451.49143140484756, 701.789305026229, 1137.1541269302281, 1121.7917182490876, 1090.5098907038805, 1117.8630393290005, 1043.6944460451268, 935.8082255277128, 1294.5613798932354, 966.4034251770353, 1067.406530002593, 850.0107192556087, 1302.4952069126468, 1139.644228716852, 1211.6438632141121, 708.8763822648443, 420.21375166347747, 1216.829360699627, 82.38263748093497, 693.9952957790217, 641.8387155697048, 554.4317896295173, 1466.132835552609, 178.72613154063984, 653.558031693581, 768.6838100267544, 881.1432858906613, 1221.3800580412465, 902.9757983097231, 1382.772080946504, 1236.9571509036066, 65.16298529129999, 855.0982071669372, 937.8739889863549, 955.5467629512219, 376.5405769344911, 1234.0288617641822, 1247.9882660127744, 797.2549104279814, 1165.4138820039534, 1203.7461746054091, 1097.6898306994449, 58.260998892311676, 365.8684648217759, 1034.0250028388116, 1410.8631239517533, 33.95071677996267, 1128.425593570238, 1101.3682790735174, 577.6801232743111, 861.6395727233675, 849.4498210886667, 1178.4530886500377, 15.149615665322191, 1253.800100912491, 65.23497685759682, 624.8060527467096, 4.337910629307837, 747.4814575149829, 87.32921482591102, 0.0, 1222.0281853902006, 1222.3698345967514, 8.5635556224441, 1131.4761283951689, 917.7071631506084, 1412.3473696586059, 998.6811639226797, 876.1507772633373, 1384.3153931997138, 260.1212837727711, 10.394364961068867, 976.7413137072822, 1117.709790860315, 594.6327303395024, 1154.7977407542082, 1143.60691146056, 1159.957387394784, 994.8762530302299, 416.0866120485307, 1261.564340862334, 1345.125938841231, 921.7265656297545, 972.3009510176834, 382.97062482480646, 1134.3907060598497, 926.5160077234425, 144.88337295848095, 1173.8810583350473, 8.947313943549648, 0.8193679247341232, 1298.5293298080994, 574.4206238994072, 1162.1255619458902, 270.0088957891376, 1265.502627489944, 1157.9671269209105, 1348.948341614015, 1029.6904340164544, 785.9537041323682, 673.9449253448763, 700.9840978690323, 441.45504674161936, 742.6732430730187, 1298.6196276787734, 1068.2270028064484, 346.50135317552343, 1056.2903416706738, 519.4885164338097, 1280.13551486811, 1202.5069823556942, 1075.4479082249313, 1331.485352088185, 9.248311119475972, 1279.1081352004762, 718.8501322032603, 1349.974368748372, 1298.8070291161548, 890.952689750753, 953.1439367661324, 668.0498539389292, 1526.0919420387872, 46.2238158754886, 688.1626755710078, 1092.7335151570012, 493.0677442493994, 1378.5489491591177, 1106.1817492683824, 448.5732803640995, 647.6789292801313, 271.3402200944181, 838.6044741608611, 944.5068398352614, 1171.0856493438375, 914.1634355810211, 1209.8739783556234, 556.6790646272156, 694.1792043045605, 1224.1313152176572, 937.3087953135556, 34.96591211927648, 628.1207047647672, 1272.7411420327448, 853.2691063492109, 969.3354931610868, 1196.7810216973996, 1388.4258455080633, 1331.2744118138785, 1010.6894526281375, 864.3606278154681, 992.667133352878, 1134.4383514901922, 38.41940060666482, 22.548547835609792, 500.4664497026371, 1031.6480358879517, 1351.3142721082168, 995.4925461383692, 691.5819285457769, 993.1708882232329, 2.949272212385855, 669.8961405034387, 860.9278770862312, 1143.883909016859, 772.3778989806028, 384.4814881244898, 1219.5542159991073, 135.44587582604, 902.7825637947733, 473.03747846649736, 869.4325254471382, 92.3565176569162, 1014.1958639461942, 1257.1720469072393, 763.8540680630982, 1370.320922073328, 643.9628057172241, 82.14297271591471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.881359022594293, "mean_inference_ms": 4.532074292701197, "mean_action_processing_ms": 1.6557357751454622, "mean_env_wait_ms": 10.393700107870767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008339285850524902, "StateBufferConnector_ms": 0.014374136924743652, "ViewRequirementAgentConnector_ms": 0.26146435737609863}, "num_episodes": 9, "episode_return_max": 803.5928139312634, "episode_return_min": -22.78577684539289, "episode_return_mean": 189.7020321232898, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.06355596132137, "num_env_steps_trained_throughput_per_sec": 76.06355596132137, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 52434.965, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52434.868, "sample_time_ms": 3055.721, "learn_time_ms": 49353.533, "learn_throughput": 81.048, "synch_weights_time_ms": 19.53}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "35fb9_00000", "date": "2024-08-22_08-28-14", "timestamp": 1724295494, "time_this_iter_s": 52.62914299964905, "time_total_s": 2072.773299217224, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b61a0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2072.773299217224, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 35.029333333333334, "ram_util_percent": 82.46266666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.284346920661825, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.68306379620991, "policy_loss": -0.02476169573298345, "vf_loss": 7.7045458225976855, "vf_explained_var": 0.43263085399355206, "kl": 0.01639839778309343, "entropy": 0.8030791217687899, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.149856672589742, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.054392588580097, "policy_loss": -0.017404626842056, "vf_loss": 8.069521558600128, "vf_explained_var": 0.24814624830528542, "kl": 0.011378248069662028, "entropy": 0.5940576297580881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 803.5928139312634, "episode_reward_min": -22.78577684539289, "episode_reward_mean": 198.70183984490154, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1526.0919420387872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.89675998993977, "predator_policy": 1526.0919420387872}, "policy_reward_mean": {"prey_policy": -740.7831122048324, "predator_policy": 840.1340321272836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [231.9873233741841, 375.635811654235, 159.50819102288918, 364.58666537590364, -1.2037269366120085, 51.15630222387081, 206.32426615586542, 38.28350042171058, 398.34271767459904, 40.218336116081694, 137.32419719795692, 54.83357184285424, 236.5313926929539, 176.76270968463942, 40.465563920660486, 449.01866055124316, 87.28628976253043, 96.6, 254.84641676694608, 104.76323822324429, 325.6769566158748, 37.50703095326301, 122.48889121300074, -22.78577684539289, 257.4999999999983, 225.79203782076848, 45.519117494321534, 141.94730552611946, 431.71872775131493, 76.5112214415783, 460.00608094622066, 224.54689874560844, 168.84324646035506, 388.36229433681495, 301.32283933271856, 142.11045932436184, 3.755738185314335, 4.600000000000001, 5.734954880429133, 215.8086148832542, 437.0281601573768, 213.43884764233243, 205.250893548533, 6.060558839483537, 73.8, 226.69033223536985, 440.9075003777252, 34.348539776252686, 39.90000000000029, 361.64118641947294, 280.60338631133493, 64.07597132244119, 803.5928139312634, 397.61369987825316, 141.28348940320055, 123.31050606621059, 79.68773447853229, 199.35318320746345, 541.7480666130741, 39.10000000000023, 195.96866140365955, 1.3131769954423262, 593.193251124573, 143.2255085104704, 56.40000000000053, 313.7126033869613, 301.3695866310617, 90.9930601175686, 196.96970087151493, 1.169618614645306, 14.100000000000003, 389.75566424096013, 20.036437564453507, 196.764840795412, 740.6404930021706, 9.36583317679591, -1.9673909032067418, 206.28561467372103, 125.01156907015547, 385.50000000000205, 184.76397239799243, 135.69930918801973, 295.9870667343166, 347.4386349600654, 95.6578559228943, 86.64104896191652, 435.87818959966415, 319.0476106528203, 55.5613504913096, 1.2797926827002077, 15.165032730659355, 267.73827984458467, 254.34743595805605, 21.26849273369711, 119.9455028465266, 182.5009787126917, 310.19739004892205, 412.6793324460705, 234.6497883711782, 344.25575292970746], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1171.298016996429, -389.34846679994837, -208.82100959596283, -1200.146735929287, -935.634203405512, -1260.2425311689785, -259.1658504566807, -529.5282205984918, -1126.9694079175067, -1133.1801641984202, -1039.965380512947, -1117.251247296063, -1076.8228165490825, -696.3555888678892, -1291.1157421518808, -931.5655624966791, -898.7613525502709, -620.3131790333332, -1298.3680443565174, -1103.5530551568982, -1198.8142644567056, -584.3817838242941, -369.1801798206177, -1213.0293606996272, -574.4874584384766, 34.64091787147546, 38.93164634197064, -1058.4394418565512, -1466.132835552609, -138.26056761998157, 255.87512109245102, -1229.098302261542, -1174.1503116794147, -841.0867424899625, -806.3757983097235, -1382.772080946504, -910.6687241843559, -136.6049952435986, -548.0362619313721, -1140.1726959986752, -196.48000941737317, -809.9303738524643, -1216.0096442400134, -1228.500452583681, -1361.1350228502217, -479.04487836870493, -1116.277688118275, -1207.9440940319719, -184.66267936087718, 18.033215646789582, -755.709174363193, -1463.3869146066027, 10.468400714358715, -1127.3255935702382, -947.6950021402184, -589.4060946814848, -889.7510999530043, -389.6195661077145, 36.44945346466114, -1153.5409363384415, -1254.9257568138069, 395.89675998993977, 30.80342422623352, -435.40048885664083, -690.3144590816217, 24.34703320108461, -1020.3647199063269, 186.69882885294106, -1220.621900198291, 291.01134931181406, -583.7187210721509, -1323.3541111492593, -1412.047369658606, -995.2254257373646, -871.5507772633364, -1384.3153931997138, -155.7834343271904, -108.99725952622089, -1018.1965058524202, -860.4459838319196, -1351.1842769475875, 38.781966011250404, -1053.120172727591, -1037.0052784854197, -953.3986779726617, -252.3132935575661, -1255.364340862334, -1345.2653800017474, -852.5265656297545, -967.7009510176824, 28.765429785646766, -1319.4364284349308, 284.06219512041696, -914.5540754246149, -1173.767356461005, 25.287523958660884, 39.080632075266166, -1298.5293298080994, -818.8236386551667, -556.0813607706591, 40.0000000000003, -1294.9081369677494, -1102.9077362158691, -1339.9317609966142, 141.52673234976245, -1153.5780565673208, -351.85520108157084, -625.4601222540829, 14.951809933662428, -1057.7966103451015, -987.298873018195, -1256.237251400814, -270.51361869698485, -1052.5903416706728, -1002.8836687860454, -597.387179308407, -1328.9095453465611, -407.29727862098997, -1331.485352088185, 29.85168888052417, -931.4256249925079, -870.5639810075702, -1349.974368748372, -1297.4938521207127, -131.0824782701275, -1119.820897122181, -524.8243454284623, -1526.0919420387872, -8.723815875488201, -669.2626755710035, -1194.304449647115, -77.78420637232534, -1422.5772248181065, -760.7838869783334, -1017.8926755740348, 12.63352604737466, 20.619653859965062, -933.5946472437262, -943.5068398352614, -1170.916030729192, -913.0634355810208, -1196.8739783556234, -132.81966185898878, -728.2829428318281, -1216.6857907770282, -924.7178821897309, -325.02798065503293, -141.29379543359588, -1392.0029376801137, 6.633182300324057, -959.969659984291, -1196.7810216973996, -1333.223979928367, -1388.4436682967817, -1014.3581339534884, -654.4063318163886, -1264.3906355238964, -737.7032802490139, 32.31224282571532, 292.2198087320103, -315.80247730464396, -1031.5480358879515, -1353.6959339843493, -857.4115750742151, -382.1481680145697, -1006.6175820201198, 241.34967030036222, -566.7564480561216, -884.2869336362664, -1024.8669965439296, -774.7617376983952, -295.45660044477984, -1219.3542159991075, 300.23231377362424, -977.4463484695868, -79.32608313886463, -856.745862192063, -49.481830420681135, -1013.2849095117414, -1256.803208658992, -748.9890353324356, -1370.0209220733282, -13.404692871333165, -444.9628057172229, 21.007605485804625, -719.9644647928307, -1398.7434886954723, -1199.1856805274515, -1287.566950624252, 39.076992799702545, -361.9310049525044, -1037.494376320795, -1102.0950335118541, -203.06953773481774, -1009.7588688051258, 70.10057815908232, 28.40755330942448, -812.0208733843448, -820.816721834842, -1418.2994614337715], "policy_predator_policy_reward": [1128.4698876612495, 664.1639195093143, 693.3807759570689, 1091.222781222415, 1171.8602550013156, 1183.524670596063, 451.49143140484756, 701.789305026229, 1137.1541269302281, 1121.7917182490876, 1090.5098907038805, 1117.8630393290005, 1043.6944460451268, 935.8082255277128, 1294.5613798932354, 966.4034251770353, 1067.406530002593, 850.0107192556087, 1302.4952069126468, 1139.644228716852, 1211.6438632141121, 708.8763822648443, 420.21375166347747, 1216.829360699627, 82.38263748093497, 693.9952957790217, 641.8387155697048, 554.4317896295173, 1466.132835552609, 178.72613154063984, 653.558031693581, 768.6838100267544, 881.1432858906613, 1221.3800580412465, 902.9757983097231, 1382.772080946504, 1236.9571509036066, 65.16298529129999, 855.0982071669372, 937.8739889863549, 955.5467629512219, 376.5405769344911, 1234.0288617641822, 1247.9882660127744, 797.2549104279814, 1165.4138820039534, 1203.7461746054091, 1097.6898306994449, 58.260998892311676, 365.8684648217759, 1034.0250028388116, 1410.8631239517533, 33.95071677996267, 1128.425593570238, 1101.3682790735174, 577.6801232743111, 861.6395727233675, 849.4498210886667, 1178.4530886500377, 15.149615665322191, 1253.800100912491, 65.23497685759682, 624.8060527467096, 4.337910629307837, 747.4814575149829, 87.32921482591102, 0.0, 1222.0281853902006, 1222.3698345967514, 8.5635556224441, 1131.4761283951689, 917.7071631506084, 1412.3473696586059, 998.6811639226797, 876.1507772633373, 1384.3153931997138, 260.1212837727711, 10.394364961068867, 976.7413137072822, 1117.709790860315, 594.6327303395024, 1154.7977407542082, 1143.60691146056, 1159.957387394784, 994.8762530302299, 416.0866120485307, 1261.564340862334, 1345.125938841231, 921.7265656297545, 972.3009510176834, 382.97062482480646, 1134.3907060598497, 926.5160077234425, 144.88337295848095, 1173.8810583350473, 8.947313943549648, 0.8193679247341232, 1298.5293298080994, 574.4206238994072, 1162.1255619458902, 270.0088957891376, 1265.502627489944, 1157.9671269209105, 1348.948341614015, 1029.6904340164544, 785.9537041323682, 673.9449253448763, 700.9840978690323, 441.45504674161936, 742.6732430730187, 1298.6196276787734, 1068.2270028064484, 346.50135317552343, 1056.2903416706738, 519.4885164338097, 1280.13551486811, 1202.5069823556942, 1075.4479082249313, 1331.485352088185, 9.248311119475972, 1279.1081352004762, 718.8501322032603, 1349.974368748372, 1298.8070291161548, 890.952689750753, 953.1439367661324, 668.0498539389292, 1526.0919420387872, 46.2238158754886, 688.1626755710078, 1092.7335151570012, 493.0677442493994, 1378.5489491591177, 1106.1817492683824, 448.5732803640995, 647.6789292801313, 271.3402200944181, 838.6044741608611, 944.5068398352614, 1171.0856493438375, 914.1634355810211, 1209.8739783556234, 556.6790646272156, 694.1792043045605, 1224.1313152176572, 937.3087953135556, 34.96591211927648, 628.1207047647672, 1272.7411420327448, 853.2691063492109, 969.3354931610868, 1196.7810216973996, 1388.4258455080633, 1331.2744118138785, 1010.6894526281375, 864.3606278154681, 992.667133352878, 1134.4383514901922, 38.41940060666482, 22.548547835609792, 500.4664497026371, 1031.6480358879517, 1351.3142721082168, 995.4925461383692, 691.5819285457769, 993.1708882232329, 2.949272212385855, 669.8961405034387, 860.9278770862312, 1143.883909016859, 772.3778989806028, 384.4814881244898, 1219.5542159991073, 135.44587582604, 902.7825637947733, 473.03747846649736, 869.4325254471382, 92.3565176569162, 1014.1958639461942, 1257.1720469072393, 763.8540680630982, 1370.320922073328, 643.9628057172241, 82.14297271591471, 496.26697357791966, 457.0373216871636, 1414.5638011270423, 1204.6338608295785, 670.0453682865807, 698.3900923844964, 581.1723437415639, 1000.754016244436, 1041.4711130786052, 573.890848216985, 933.0062664365649, 419.331356655546, 1018.2631084460999, 0.0, 1232.018682080564, 1351.35325411776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.916846366322004, "mean_inference_ms": 4.548359984402589, "mean_action_processing_ms": 1.6403892765572978, "mean_env_wait_ms": 10.39595562008884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008462667465209961, "StateBufferConnector_ms": 0.006165981292724609, "ViewRequirementAgentConnector_ms": 0.23198401927947998}, "num_episodes": 8, "episode_return_max": 803.5928139312634, "episode_return_min": -22.78577684539289, "episode_return_mean": 198.70183984490154, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.8966465862378, "num_env_steps_trained_throughput_per_sec": 76.8966465862378, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 52250.283, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52250.193, "sample_time_ms": 3007.851, "learn_time_ms": 49218.056, "learn_throughput": 81.271, "synch_weights_time_ms": 18.428}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "35fb9_00000", "date": "2024-08-22_08-29-06", "timestamp": 1724295546, "time_this_iter_s": 52.07077503204346, "time_total_s": 2124.8440742492676, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc85ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2124.8440742492676, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 34.9472972972973, "ram_util_percent": 82.86351351351351}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.838512346164258, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.293797772775882, "policy_loss": -0.022249343998794243, "vf_loss": 7.313288660402651, "vf_explained_var": 0.5418318039210385, "kl": 0.01379225589679899, "entropy": 0.7981555590869258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.312224400232708, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.110248757417871, "policy_loss": -0.01828810622319382, "vf_loss": 8.126065209302952, "vf_explained_var": 0.2648023787945036, "kl": 0.012358352608569755, "entropy": 0.5501307517605484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 803.5928139312634, "episode_reward_min": -22.78577684539289, "episode_reward_mean": 194.60456823701747, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.115168772382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.89675998993977, "predator_policy": 1531.115168772382}, "policy_reward_mean": {"prey_policy": -741.654038215499, "predator_policy": 838.9563223340083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.28350042171058, 398.34271767459904, 40.218336116081694, 137.32419719795692, 54.83357184285424, 236.5313926929539, 176.76270968463942, 40.465563920660486, 449.01866055124316, 87.28628976253043, 96.6, 254.84641676694608, 104.76323822324429, 325.6769566158748, 37.50703095326301, 122.48889121300074, -22.78577684539289, 257.4999999999983, 225.79203782076848, 45.519117494321534, 141.94730552611946, 431.71872775131493, 76.5112214415783, 460.00608094622066, 224.54689874560844, 168.84324646035506, 388.36229433681495, 301.32283933271856, 142.11045932436184, 3.755738185314335, 4.600000000000001, 5.734954880429133, 215.8086148832542, 437.0281601573768, 213.43884764233243, 205.250893548533, 6.060558839483537, 73.8, 226.69033223536985, 440.9075003777252, 34.348539776252686, 39.90000000000029, 361.64118641947294, 280.60338631133493, 64.07597132244119, 803.5928139312634, 397.61369987825316, 141.28348940320055, 123.31050606621059, 79.68773447853229, 199.35318320746345, 541.7480666130741, 39.10000000000023, 195.96866140365955, 1.3131769954423262, 593.193251124573, 143.2255085104704, 56.40000000000053, 313.7126033869613, 301.3695866310617, 90.9930601175686, 196.96970087151493, 1.169618614645306, 14.100000000000003, 389.75566424096013, 20.036437564453507, 196.764840795412, 740.6404930021706, 9.36583317679591, -1.9673909032067418, 206.28561467372103, 125.01156907015547, 385.50000000000205, 184.76397239799243, 135.69930918801973, 295.9870667343166, 347.4386349600654, 95.6578559228943, 86.64104896191652, 435.87818959966415, 319.0476106528203, 55.5613504913096, 1.2797926827002077, 15.165032730659355, 267.73827984458467, 254.34743595805605, 21.26849273369711, 119.9455028465266, 182.5009787126917, 310.19739004892205, 412.6793324460705, 234.6497883711782, 344.25575292970746, 104.4, 317.20916998559017, 12.142186994335036, 55.79408992920837, 24.295592546096415, 349.22325867655934, 115.20337395014144], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1291.1157421518808, -931.5655624966791, -898.7613525502709, -620.3131790333332, -1298.3680443565174, -1103.5530551568982, -1198.8142644567056, -584.3817838242941, -369.1801798206177, -1213.0293606996272, -574.4874584384766, 34.64091787147546, 38.93164634197064, -1058.4394418565512, -1466.132835552609, -138.26056761998157, 255.87512109245102, -1229.098302261542, -1174.1503116794147, -841.0867424899625, -806.3757983097235, -1382.772080946504, -910.6687241843559, -136.6049952435986, -548.0362619313721, -1140.1726959986752, -196.48000941737317, -809.9303738524643, -1216.0096442400134, -1228.500452583681, -1361.1350228502217, -479.04487836870493, -1116.277688118275, -1207.9440940319719, -184.66267936087718, 18.033215646789582, -755.709174363193, -1463.3869146066027, 10.468400714358715, -1127.3255935702382, -947.6950021402184, -589.4060946814848, -889.7510999530043, -389.6195661077145, 36.44945346466114, -1153.5409363384415, -1254.9257568138069, 395.89675998993977, 30.80342422623352, -435.40048885664083, -690.3144590816217, 24.34703320108461, -1020.3647199063269, 186.69882885294106, -1220.621900198291, 291.01134931181406, -583.7187210721509, -1323.3541111492593, -1412.047369658606, -995.2254257373646, -871.5507772633364, -1384.3153931997138, -155.7834343271904, -108.99725952622089, -1018.1965058524202, -860.4459838319196, -1351.1842769475875, 38.781966011250404, -1053.120172727591, -1037.0052784854197, -953.3986779726617, -252.3132935575661, -1255.364340862334, -1345.2653800017474, -852.5265656297545, -967.7009510176824, 28.765429785646766, -1319.4364284349308, 284.06219512041696, -914.5540754246149, -1173.767356461005, 25.287523958660884, 39.080632075266166, -1298.5293298080994, -818.8236386551667, -556.0813607706591, 40.0000000000003, -1294.9081369677494, -1102.9077362158691, -1339.9317609966142, 141.52673234976245, -1153.5780565673208, -351.85520108157084, -625.4601222540829, 14.951809933662428, -1057.7966103451015, -987.298873018195, -1256.237251400814, -270.51361869698485, -1052.5903416706728, -1002.8836687860454, -597.387179308407, -1328.9095453465611, -407.29727862098997, -1331.485352088185, 29.85168888052417, -931.4256249925079, -870.5639810075702, -1349.974368748372, -1297.4938521207127, -131.0824782701275, -1119.820897122181, -524.8243454284623, -1526.0919420387872, -8.723815875488201, -669.2626755710035, -1194.304449647115, -77.78420637232534, -1422.5772248181065, -760.7838869783334, -1017.8926755740348, 12.63352604737466, 20.619653859965062, -933.5946472437262, -943.5068398352614, -1170.916030729192, -913.0634355810208, -1196.8739783556234, -132.81966185898878, -728.2829428318281, -1216.6857907770282, -924.7178821897309, -325.02798065503293, -141.29379543359588, -1392.0029376801137, 6.633182300324057, -959.969659984291, -1196.7810216973996, -1333.223979928367, -1388.4436682967817, -1014.3581339534884, -654.4063318163886, -1264.3906355238964, -737.7032802490139, 32.31224282571532, 292.2198087320103, -315.80247730464396, -1031.5480358879515, -1353.6959339843493, -857.4115750742151, -382.1481680145697, -1006.6175820201198, 241.34967030036222, -566.7564480561216, -884.2869336362664, -1024.8669965439296, -774.7617376983952, -295.45660044477984, -1219.3542159991075, 300.23231377362424, -977.4463484695868, -79.32608313886463, -856.745862192063, -49.481830420681135, -1013.2849095117414, -1256.803208658992, -748.9890353324356, -1370.0209220733282, -13.404692871333165, -444.9628057172229, 21.007605485804625, -719.9644647928307, -1398.7434886954723, -1199.1856805274515, -1287.566950624252, 39.076992799702545, -361.9310049525044, -1037.494376320795, -1102.0950335118541, -203.06953773481774, -1009.7588688051258, 70.10057815908232, 28.40755330942448, -812.0208733843448, -820.816721834842, -1418.2994614337715, -373.3920182821991, -1284.872584519429, -170.25234517356384, -1225.4019801367501, -1197.8072683946637, -845.77056405037, -998.2556305821024, -829.9235177919124, -1003.0430484000626, -1011.4043668138015, 348.46667704978915, -1531.115168772382, -1315.5650237682498, -880.5780027908477], "policy_predator_policy_reward": [1294.5613798932354, 966.4034251770353, 1067.406530002593, 850.0107192556087, 1302.4952069126468, 1139.644228716852, 1211.6438632141121, 708.8763822648443, 420.21375166347747, 1216.829360699627, 82.38263748093497, 693.9952957790217, 641.8387155697048, 554.4317896295173, 1466.132835552609, 178.72613154063984, 653.558031693581, 768.6838100267544, 881.1432858906613, 1221.3800580412465, 902.9757983097231, 1382.772080946504, 1236.9571509036066, 65.16298529129999, 855.0982071669372, 937.8739889863549, 955.5467629512219, 376.5405769344911, 1234.0288617641822, 1247.9882660127744, 797.2549104279814, 1165.4138820039534, 1203.7461746054091, 1097.6898306994449, 58.260998892311676, 365.8684648217759, 1034.0250028388116, 1410.8631239517533, 33.95071677996267, 1128.425593570238, 1101.3682790735174, 577.6801232743111, 861.6395727233675, 849.4498210886667, 1178.4530886500377, 15.149615665322191, 1253.800100912491, 65.23497685759682, 624.8060527467096, 4.337910629307837, 747.4814575149829, 87.32921482591102, 0.0, 1222.0281853902006, 1222.3698345967514, 8.5635556224441, 1131.4761283951689, 917.7071631506084, 1412.3473696586059, 998.6811639226797, 876.1507772633373, 1384.3153931997138, 260.1212837727711, 10.394364961068867, 976.7413137072822, 1117.709790860315, 594.6327303395024, 1154.7977407542082, 1143.60691146056, 1159.957387394784, 994.8762530302299, 416.0866120485307, 1261.564340862334, 1345.125938841231, 921.7265656297545, 972.3009510176834, 382.97062482480646, 1134.3907060598497, 926.5160077234425, 144.88337295848095, 1173.8810583350473, 8.947313943549648, 0.8193679247341232, 1298.5293298080994, 574.4206238994072, 1162.1255619458902, 270.0088957891376, 1265.502627489944, 1157.9671269209105, 1348.948341614015, 1029.6904340164544, 785.9537041323682, 673.9449253448763, 700.9840978690323, 441.45504674161936, 742.6732430730187, 1298.6196276787734, 1068.2270028064484, 346.50135317552343, 1056.2903416706738, 519.4885164338097, 1280.13551486811, 1202.5069823556942, 1075.4479082249313, 1331.485352088185, 9.248311119475972, 1279.1081352004762, 718.8501322032603, 1349.974368748372, 1298.8070291161548, 890.952689750753, 953.1439367661324, 668.0498539389292, 1526.0919420387872, 46.2238158754886, 688.1626755710078, 1092.7335151570012, 493.0677442493994, 1378.5489491591177, 1106.1817492683824, 448.5732803640995, 647.6789292801313, 271.3402200944181, 838.6044741608611, 944.5068398352614, 1171.0856493438375, 914.1634355810211, 1209.8739783556234, 556.6790646272156, 694.1792043045605, 1224.1313152176572, 937.3087953135556, 34.96591211927648, 628.1207047647672, 1272.7411420327448, 853.2691063492109, 969.3354931610868, 1196.7810216973996, 1388.4258455080633, 1331.2744118138785, 1010.6894526281375, 864.3606278154681, 992.667133352878, 1134.4383514901922, 38.41940060666482, 22.548547835609792, 500.4664497026371, 1031.6480358879517, 1351.3142721082168, 995.4925461383692, 691.5819285457769, 993.1708882232329, 2.949272212385855, 669.8961405034387, 860.9278770862312, 1143.883909016859, 772.3778989806028, 384.4814881244898, 1219.5542159991073, 135.44587582604, 902.7825637947733, 473.03747846649736, 869.4325254471382, 92.3565176569162, 1014.1958639461942, 1257.1720469072393, 763.8540680630982, 1370.320922073328, 643.9628057172241, 82.14297271591471, 496.26697357791966, 457.0373216871636, 1414.5638011270423, 1204.6338608295785, 670.0453682865807, 698.3900923844964, 581.1723437415639, 1000.754016244436, 1041.4711130786052, 573.890848216985, 933.0062664365649, 419.331356655546, 1018.2631084460999, 0.0, 1232.018682080564, 1351.35325411776, 477.6920182822001, 1284.972584519429, 472.36347669665474, 1240.500018599247, 1193.774622723568, 861.9453967158012, 998.48585474888, 885.4873835543444, 1046.272534299921, 992.4704734600399, 0.7565816267701605, 1531.115168772382, 1355.3161773124057, 956.030223196836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.909292665275857, "mean_inference_ms": 4.548867379300894, "mean_action_processing_ms": 1.645796639597414, "mean_env_wait_ms": 10.400456836341741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008101224899291992, "StateBufferConnector_ms": 0.005994081497192383, "ViewRequirementAgentConnector_ms": 0.18938934803009033}, "num_episodes": 7, "episode_return_max": 803.5928139312634, "episode_return_min": -22.78577684539289, "episode_return_mean": 194.60456823701747, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.63478100434395, "num_env_steps_trained_throughput_per_sec": 72.63478100434395, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 52211.692, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52211.613, "sample_time_ms": 2836.299, "learn_time_ms": 49350.937, "learn_throughput": 81.052, "synch_weights_time_ms": 19.649}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "35fb9_00000", "date": "2024-08-22_08-30-01", "timestamp": 1724295601, "time_this_iter_s": 55.15335702896118, "time_total_s": 2179.9974312782288, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0f73dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2179.9974312782288, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 41.205128205128204, "ram_util_percent": 83.05128205128206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.819117619436254, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.473796927487409, "policy_loss": -0.018977335967842943, "vf_loss": 7.49029707101287, "vf_explained_var": 0.4860563721290972, "kl": 0.012385850015377241, "entropy": 0.7070134819815399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.660925897908589, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.7378590646874965, "policy_loss": -0.01619815513486703, "vf_loss": 7.751388648199657, "vf_explained_var": 0.2907172660032908, "kl": 0.013342864287366706, "entropy": 0.5533371664544262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 803.5928139312634, "episode_reward_min": -22.78577684539289, "episode_reward_mean": 195.68719298228888, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.115168772382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.89675998993977, "predator_policy": 1531.115168772382}, "policy_reward_mean": {"prey_policy": -739.2201896039525, "predator_policy": 837.0637860950973}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.6, 254.84641676694608, 104.76323822324429, 325.6769566158748, 37.50703095326301, 122.48889121300074, -22.78577684539289, 257.4999999999983, 225.79203782076848, 45.519117494321534, 141.94730552611946, 431.71872775131493, 76.5112214415783, 460.00608094622066, 224.54689874560844, 168.84324646035506, 388.36229433681495, 301.32283933271856, 142.11045932436184, 3.755738185314335, 4.600000000000001, 5.734954880429133, 215.8086148832542, 437.0281601573768, 213.43884764233243, 205.250893548533, 6.060558839483537, 73.8, 226.69033223536985, 440.9075003777252, 34.348539776252686, 39.90000000000029, 361.64118641947294, 280.60338631133493, 64.07597132244119, 803.5928139312634, 397.61369987825316, 141.28348940320055, 123.31050606621059, 79.68773447853229, 199.35318320746345, 541.7480666130741, 39.10000000000023, 195.96866140365955, 1.3131769954423262, 593.193251124573, 143.2255085104704, 56.40000000000053, 313.7126033869613, 301.3695866310617, 90.9930601175686, 196.96970087151493, 1.169618614645306, 14.100000000000003, 389.75566424096013, 20.036437564453507, 196.764840795412, 740.6404930021706, 9.36583317679591, -1.9673909032067418, 206.28561467372103, 125.01156907015547, 385.50000000000205, 184.76397239799243, 135.69930918801973, 295.9870667343166, 347.4386349600654, 95.6578559228943, 86.64104896191652, 435.87818959966415, 319.0476106528203, 55.5613504913096, 1.2797926827002077, 15.165032730659355, 267.73827984458467, 254.34743595805605, 21.26849273369711, 119.9455028465266, 182.5009787126917, 310.19739004892205, 412.6793324460705, 234.6497883711782, 344.25575292970746, 104.4, 317.20916998559017, 12.142186994335036, 55.79408992920837, 24.295592546096415, 349.22325867655934, 115.20337395014144, 339.9575883929492, 21.611218685156746, 2.0577717006452954, 35.79785493530086, 159.39136462742795, 200.45591612139464, 92.8999999999987, 508.3831606138812, 3.025983883483047, 403.74855543212817], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-806.3757983097235, -1382.772080946504, -910.6687241843559, -136.6049952435986, -548.0362619313721, -1140.1726959986752, -196.48000941737317, -809.9303738524643, -1216.0096442400134, -1228.500452583681, -1361.1350228502217, -479.04487836870493, -1116.277688118275, -1207.9440940319719, -184.66267936087718, 18.033215646789582, -755.709174363193, -1463.3869146066027, 10.468400714358715, -1127.3255935702382, -947.6950021402184, -589.4060946814848, -889.7510999530043, -389.6195661077145, 36.44945346466114, -1153.5409363384415, -1254.9257568138069, 395.89675998993977, 30.80342422623352, -435.40048885664083, -690.3144590816217, 24.34703320108461, -1020.3647199063269, 186.69882885294106, -1220.621900198291, 291.01134931181406, -583.7187210721509, -1323.3541111492593, -1412.047369658606, -995.2254257373646, -871.5507772633364, -1384.3153931997138, -155.7834343271904, -108.99725952622089, -1018.1965058524202, -860.4459838319196, -1351.1842769475875, 38.781966011250404, -1053.120172727591, -1037.0052784854197, -953.3986779726617, -252.3132935575661, -1255.364340862334, -1345.2653800017474, -852.5265656297545, -967.7009510176824, 28.765429785646766, -1319.4364284349308, 284.06219512041696, -914.5540754246149, -1173.767356461005, 25.287523958660884, 39.080632075266166, -1298.5293298080994, -818.8236386551667, -556.0813607706591, 40.0000000000003, -1294.9081369677494, -1102.9077362158691, -1339.9317609966142, 141.52673234976245, -1153.5780565673208, -351.85520108157084, -625.4601222540829, 14.951809933662428, -1057.7966103451015, -987.298873018195, -1256.237251400814, -270.51361869698485, -1052.5903416706728, -1002.8836687860454, -597.387179308407, -1328.9095453465611, -407.29727862098997, -1331.485352088185, 29.85168888052417, -931.4256249925079, -870.5639810075702, -1349.974368748372, -1297.4938521207127, -131.0824782701275, -1119.820897122181, -524.8243454284623, -1526.0919420387872, -8.723815875488201, -669.2626755710035, -1194.304449647115, -77.78420637232534, -1422.5772248181065, -760.7838869783334, -1017.8926755740348, 12.63352604737466, 20.619653859965062, -933.5946472437262, -943.5068398352614, -1170.916030729192, -913.0634355810208, -1196.8739783556234, -132.81966185898878, -728.2829428318281, -1216.6857907770282, -924.7178821897309, -325.02798065503293, -141.29379543359588, -1392.0029376801137, 6.633182300324057, -959.969659984291, -1196.7810216973996, -1333.223979928367, -1388.4436682967817, -1014.3581339534884, -654.4063318163886, -1264.3906355238964, -737.7032802490139, 32.31224282571532, 292.2198087320103, -315.80247730464396, -1031.5480358879515, -1353.6959339843493, -857.4115750742151, -382.1481680145697, -1006.6175820201198, 241.34967030036222, -566.7564480561216, -884.2869336362664, -1024.8669965439296, -774.7617376983952, -295.45660044477984, -1219.3542159991075, 300.23231377362424, -977.4463484695868, -79.32608313886463, -856.745862192063, -49.481830420681135, -1013.2849095117414, -1256.803208658992, -748.9890353324356, -1370.0209220733282, -13.404692871333165, -444.9628057172229, 21.007605485804625, -719.9644647928307, -1398.7434886954723, -1199.1856805274515, -1287.566950624252, 39.076992799702545, -361.9310049525044, -1037.494376320795, -1102.0950335118541, -203.06953773481774, -1009.7588688051258, 70.10057815908232, 28.40755330942448, -812.0208733843448, -820.816721834842, -1418.2994614337715, -373.3920182821991, -1284.872584519429, -170.25234517356384, -1225.4019801367501, -1197.8072683946637, -845.77056405037, -998.2556305821024, -829.9235177919124, -1003.0430484000626, -1011.4043668138015, 348.46667704978915, -1531.115168772382, -1315.5650237682498, -880.5780027908477, -397.80425667506654, -927.2330514194823, -1310.417344316095, -798.1534259643611, -921.1771192034104, -1439.5174322399334, -1169.7614101133486, -1077.2384550529976, -1003.1786338658816, -193.4878701655286, -234.42610192139585, 32.24617982257271, -892.857532396158, 38.178137663984906, -343.26519342906164, -1089.9916711606925, -763.443769955464, -1055.5908562784562, -792.6644185355984, -834.7365516237483], "policy_predator_policy_reward": [902.9757983097231, 1382.772080946504, 1236.9571509036066, 65.16298529129999, 855.0982071669372, 937.8739889863549, 955.5467629512219, 376.5405769344911, 1234.0288617641822, 1247.9882660127744, 797.2549104279814, 1165.4138820039534, 1203.7461746054091, 1097.6898306994449, 58.260998892311676, 365.8684648217759, 1034.0250028388116, 1410.8631239517533, 33.95071677996267, 1128.425593570238, 1101.3682790735174, 577.6801232743111, 861.6395727233675, 849.4498210886667, 1178.4530886500377, 15.149615665322191, 1253.800100912491, 65.23497685759682, 624.8060527467096, 4.337910629307837, 747.4814575149829, 87.32921482591102, 0.0, 1222.0281853902006, 1222.3698345967514, 8.5635556224441, 1131.4761283951689, 917.7071631506084, 1412.3473696586059, 998.6811639226797, 876.1507772633373, 1384.3153931997138, 260.1212837727711, 10.394364961068867, 976.7413137072822, 1117.709790860315, 594.6327303395024, 1154.7977407542082, 1143.60691146056, 1159.957387394784, 994.8762530302299, 416.0866120485307, 1261.564340862334, 1345.125938841231, 921.7265656297545, 972.3009510176834, 382.97062482480646, 1134.3907060598497, 926.5160077234425, 144.88337295848095, 1173.8810583350473, 8.947313943549648, 0.8193679247341232, 1298.5293298080994, 574.4206238994072, 1162.1255619458902, 270.0088957891376, 1265.502627489944, 1157.9671269209105, 1348.948341614015, 1029.6904340164544, 785.9537041323682, 673.9449253448763, 700.9840978690323, 441.45504674161936, 742.6732430730187, 1298.6196276787734, 1068.2270028064484, 346.50135317552343, 1056.2903416706738, 519.4885164338097, 1280.13551486811, 1202.5069823556942, 1075.4479082249313, 1331.485352088185, 9.248311119475972, 1279.1081352004762, 718.8501322032603, 1349.974368748372, 1298.8070291161548, 890.952689750753, 953.1439367661324, 668.0498539389292, 1526.0919420387872, 46.2238158754886, 688.1626755710078, 1092.7335151570012, 493.0677442493994, 1378.5489491591177, 1106.1817492683824, 448.5732803640995, 647.6789292801313, 271.3402200944181, 838.6044741608611, 944.5068398352614, 1171.0856493438375, 914.1634355810211, 1209.8739783556234, 556.6790646272156, 694.1792043045605, 1224.1313152176572, 937.3087953135556, 34.96591211927648, 628.1207047647672, 1272.7411420327448, 853.2691063492109, 969.3354931610868, 1196.7810216973996, 1388.4258455080633, 1331.2744118138785, 1010.6894526281375, 864.3606278154681, 992.667133352878, 1134.4383514901922, 38.41940060666482, 22.548547835609792, 500.4664497026371, 1031.6480358879517, 1351.3142721082168, 995.4925461383692, 691.5819285457769, 993.1708882232329, 2.949272212385855, 669.8961405034387, 860.9278770862312, 1143.883909016859, 772.3778989806028, 384.4814881244898, 1219.5542159991073, 135.44587582604, 902.7825637947733, 473.03747846649736, 869.4325254471382, 92.3565176569162, 1014.1958639461942, 1257.1720469072393, 763.8540680630982, 1370.320922073328, 643.9628057172241, 82.14297271591471, 496.26697357791966, 457.0373216871636, 1414.5638011270423, 1204.6338608295785, 670.0453682865807, 698.3900923844964, 581.1723437415639, 1000.754016244436, 1041.4711130786052, 573.890848216985, 933.0062664365649, 419.331356655546, 1018.2631084460999, 0.0, 1232.018682080564, 1351.35325411776, 477.6920182822001, 1284.972584519429, 472.36347669665474, 1240.500018599247, 1193.774622723568, 861.9453967158012, 998.48585474888, 885.4873835543444, 1046.272534299921, 992.4704734600399, 0.7565816267701605, 1531.115168772382, 1355.3161773124057, 956.030223196836, 775.4251947847428, 889.5697017027563, 1310.417344316095, 819.7646446495189, 923.4771192034109, 1439.2752039405789, 1199.9239311393517, 1082.8737889622903, 374.19044799609543, 981.8674206627442, 399.05295557978235, 3.582882640437612, 0.0, 947.5793947321728, 865.6944935938498, 1075.9455316097901, 828.2476640316113, 993.8129460857933, 1010.7263368937839, 1020.4231886976911]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.923625573548254, "mean_inference_ms": 4.533339488860006, "mean_action_processing_ms": 1.6379801391797664, "mean_env_wait_ms": 10.385388008925805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007981419563293457, "StateBufferConnector_ms": 0.00505673885345459, "ViewRequirementAgentConnector_ms": 0.15460526943206787}, "num_episodes": 10, "episode_return_max": 803.5928139312634, "episode_return_min": -22.78577684539289, "episode_return_mean": 195.68719298228888, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.35807529314808, "num_env_steps_trained_throughput_per_sec": 74.35807529314808, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 52269.674, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52269.595, "sample_time_ms": 2664.225, "learn_time_ms": 49579.507, "learn_throughput": 80.678, "synch_weights_time_ms": 20.255}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "35fb9_00000", "date": "2024-08-22_08-30-55", "timestamp": 1724295655, "time_this_iter_s": 53.823697090148926, "time_total_s": 2233.8211283683777, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc85d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2233.8211283683777, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 36.60526315789473, "ram_util_percent": 82.97894736842103}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.883898714736656, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.121498305709274, "policy_loss": -0.02463691908368476, "vf_loss": 7.143064440368975, "vf_explained_var": 0.5794680622835008, "kl": 0.015353884580840785, "entropy": 0.7174501580220681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.851754832393908, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.622303348369699, "policy_loss": -0.017437326072877835, "vf_loss": 7.637127745340741, "vf_explained_var": 0.22390564298503612, "kl": 0.01306465044026337, "entropy": 0.5838277429499954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 803.5928139312634, "episode_reward_min": -1.9673909032067418, "episode_reward_mean": 202.24008205143994, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.115168772382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.89675998993977, "predator_policy": 1531.115168772382}, "policy_reward_mean": {"prey_policy": -728.4465301485542, "predator_policy": 829.5665711742745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [257.4999999999983, 225.79203782076848, 45.519117494321534, 141.94730552611946, 431.71872775131493, 76.5112214415783, 460.00608094622066, 224.54689874560844, 168.84324646035506, 388.36229433681495, 301.32283933271856, 142.11045932436184, 3.755738185314335, 4.600000000000001, 5.734954880429133, 215.8086148832542, 437.0281601573768, 213.43884764233243, 205.250893548533, 6.060558839483537, 73.8, 226.69033223536985, 440.9075003777252, 34.348539776252686, 39.90000000000029, 361.64118641947294, 280.60338631133493, 64.07597132244119, 803.5928139312634, 397.61369987825316, 141.28348940320055, 123.31050606621059, 79.68773447853229, 199.35318320746345, 541.7480666130741, 39.10000000000023, 195.96866140365955, 1.3131769954423262, 593.193251124573, 143.2255085104704, 56.40000000000053, 313.7126033869613, 301.3695866310617, 90.9930601175686, 196.96970087151493, 1.169618614645306, 14.100000000000003, 389.75566424096013, 20.036437564453507, 196.764840795412, 740.6404930021706, 9.36583317679591, -1.9673909032067418, 206.28561467372103, 125.01156907015547, 385.50000000000205, 184.76397239799243, 135.69930918801973, 295.9870667343166, 347.4386349600654, 95.6578559228943, 86.64104896191652, 435.87818959966415, 319.0476106528203, 55.5613504913096, 1.2797926827002077, 15.165032730659355, 267.73827984458467, 254.34743595805605, 21.26849273369711, 119.9455028465266, 182.5009787126917, 310.19739004892205, 412.6793324460705, 234.6497883711782, 344.25575292970746, 104.4, 317.20916998559017, 12.142186994335036, 55.79408992920837, 24.295592546096415, 349.22325867655934, 115.20337395014144, 339.9575883929492, 21.611218685156746, 2.0577717006452954, 35.79785493530086, 159.39136462742795, 200.45591612139464, 92.8999999999987, 508.3831606138812, 3.025983883483047, 403.74855543212817, 413.80387510671744, 60.90373155476038, 221.12982941867264, 472.5877757119291, 360.4478373555451, 0.20000000000000284, 45.312614694412886], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-184.66267936087718, 18.033215646789582, -755.709174363193, -1463.3869146066027, 10.468400714358715, -1127.3255935702382, -947.6950021402184, -589.4060946814848, -889.7510999530043, -389.6195661077145, 36.44945346466114, -1153.5409363384415, -1254.9257568138069, 395.89675998993977, 30.80342422623352, -435.40048885664083, -690.3144590816217, 24.34703320108461, -1020.3647199063269, 186.69882885294106, -1220.621900198291, 291.01134931181406, -583.7187210721509, -1323.3541111492593, -1412.047369658606, -995.2254257373646, -871.5507772633364, -1384.3153931997138, -155.7834343271904, -108.99725952622089, -1018.1965058524202, -860.4459838319196, -1351.1842769475875, 38.781966011250404, -1053.120172727591, -1037.0052784854197, -953.3986779726617, -252.3132935575661, -1255.364340862334, -1345.2653800017474, -852.5265656297545, -967.7009510176824, 28.765429785646766, -1319.4364284349308, 284.06219512041696, -914.5540754246149, -1173.767356461005, 25.287523958660884, 39.080632075266166, -1298.5293298080994, -818.8236386551667, -556.0813607706591, 40.0000000000003, -1294.9081369677494, -1102.9077362158691, -1339.9317609966142, 141.52673234976245, -1153.5780565673208, -351.85520108157084, -625.4601222540829, 14.951809933662428, -1057.7966103451015, -987.298873018195, -1256.237251400814, -270.51361869698485, -1052.5903416706728, -1002.8836687860454, -597.387179308407, -1328.9095453465611, -407.29727862098997, -1331.485352088185, 29.85168888052417, -931.4256249925079, -870.5639810075702, -1349.974368748372, -1297.4938521207127, -131.0824782701275, -1119.820897122181, -524.8243454284623, -1526.0919420387872, -8.723815875488201, -669.2626755710035, -1194.304449647115, -77.78420637232534, -1422.5772248181065, -760.7838869783334, -1017.8926755740348, 12.63352604737466, 20.619653859965062, -933.5946472437262, -943.5068398352614, -1170.916030729192, -913.0634355810208, -1196.8739783556234, -132.81966185898878, -728.2829428318281, -1216.6857907770282, -924.7178821897309, -325.02798065503293, -141.29379543359588, -1392.0029376801137, 6.633182300324057, -959.969659984291, -1196.7810216973996, -1333.223979928367, -1388.4436682967817, -1014.3581339534884, -654.4063318163886, -1264.3906355238964, -737.7032802490139, 32.31224282571532, 292.2198087320103, -315.80247730464396, -1031.5480358879515, -1353.6959339843493, -857.4115750742151, -382.1481680145697, -1006.6175820201198, 241.34967030036222, -566.7564480561216, -884.2869336362664, -1024.8669965439296, -774.7617376983952, -295.45660044477984, -1219.3542159991075, 300.23231377362424, -977.4463484695868, -79.32608313886463, -856.745862192063, -49.481830420681135, -1013.2849095117414, -1256.803208658992, -748.9890353324356, -1370.0209220733282, -13.404692871333165, -444.9628057172229, 21.007605485804625, -719.9644647928307, -1398.7434886954723, -1199.1856805274515, -1287.566950624252, 39.076992799702545, -361.9310049525044, -1037.494376320795, -1102.0950335118541, -203.06953773481774, -1009.7588688051258, 70.10057815908232, 28.40755330942448, -812.0208733843448, -820.816721834842, -1418.2994614337715, -373.3920182821991, -1284.872584519429, -170.25234517356384, -1225.4019801367501, -1197.8072683946637, -845.77056405037, -998.2556305821024, -829.9235177919124, -1003.0430484000626, -1011.4043668138015, 348.46667704978915, -1531.115168772382, -1315.5650237682498, -880.5780027908477, -397.80425667506654, -927.2330514194823, -1310.417344316095, -798.1534259643611, -921.1771192034104, -1439.5174322399334, -1169.7614101133486, -1077.2384550529976, -1003.1786338658816, -193.4878701655286, -234.42610192139585, 32.24617982257271, -892.857532396158, 38.178137663984906, -343.26519342906164, -1089.9916711606925, -763.443769955464, -1055.5908562784562, -792.6644185355984, -834.7365516237483, -464.0866368709083, -1172.263124196551, -0.5295854923891713, -852.7802610285958, -1338.0295113973548, -29.552108953684318, -1199.3853598369367, -512.9490321114231, -1246.6237371082723, 141.8375829010378, -1161.3962214028888, -1270.8830388321223, -1307.998129084979, 29.418334417780954], "policy_predator_policy_reward": [58.260998892311676, 365.8684648217759, 1034.0250028388116, 1410.8631239517533, 33.95071677996267, 1128.425593570238, 1101.3682790735174, 577.6801232743111, 861.6395727233675, 849.4498210886667, 1178.4530886500377, 15.149615665322191, 1253.800100912491, 65.23497685759682, 624.8060527467096, 4.337910629307837, 747.4814575149829, 87.32921482591102, 0.0, 1222.0281853902006, 1222.3698345967514, 8.5635556224441, 1131.4761283951689, 917.7071631506084, 1412.3473696586059, 998.6811639226797, 876.1507772633373, 1384.3153931997138, 260.1212837727711, 10.394364961068867, 976.7413137072822, 1117.709790860315, 594.6327303395024, 1154.7977407542082, 1143.60691146056, 1159.957387394784, 994.8762530302299, 416.0866120485307, 1261.564340862334, 1345.125938841231, 921.7265656297545, 972.3009510176834, 382.97062482480646, 1134.3907060598497, 926.5160077234425, 144.88337295848095, 1173.8810583350473, 8.947313943549648, 0.8193679247341232, 1298.5293298080994, 574.4206238994072, 1162.1255619458902, 270.0088957891376, 1265.502627489944, 1157.9671269209105, 1348.948341614015, 1029.6904340164544, 785.9537041323682, 673.9449253448763, 700.9840978690323, 441.45504674161936, 742.6732430730187, 1298.6196276787734, 1068.2270028064484, 346.50135317552343, 1056.2903416706738, 519.4885164338097, 1280.13551486811, 1202.5069823556942, 1075.4479082249313, 1331.485352088185, 9.248311119475972, 1279.1081352004762, 718.8501322032603, 1349.974368748372, 1298.8070291161548, 890.952689750753, 953.1439367661324, 668.0498539389292, 1526.0919420387872, 46.2238158754886, 688.1626755710078, 1092.7335151570012, 493.0677442493994, 1378.5489491591177, 1106.1817492683824, 448.5732803640995, 647.6789292801313, 271.3402200944181, 838.6044741608611, 944.5068398352614, 1171.0856493438375, 914.1634355810211, 1209.8739783556234, 556.6790646272156, 694.1792043045605, 1224.1313152176572, 937.3087953135556, 34.96591211927648, 628.1207047647672, 1272.7411420327448, 853.2691063492109, 969.3354931610868, 1196.7810216973996, 1388.4258455080633, 1331.2744118138785, 1010.6894526281375, 864.3606278154681, 992.667133352878, 1134.4383514901922, 38.41940060666482, 22.548547835609792, 500.4664497026371, 1031.6480358879517, 1351.3142721082168, 995.4925461383692, 691.5819285457769, 993.1708882232329, 2.949272212385855, 669.8961405034387, 860.9278770862312, 1143.883909016859, 772.3778989806028, 384.4814881244898, 1219.5542159991073, 135.44587582604, 902.7825637947733, 473.03747846649736, 869.4325254471382, 92.3565176569162, 1014.1958639461942, 1257.1720469072393, 763.8540680630982, 1370.320922073328, 643.9628057172241, 82.14297271591471, 496.26697357791966, 457.0373216871636, 1414.5638011270423, 1204.6338608295785, 670.0453682865807, 698.3900923844964, 581.1723437415639, 1000.754016244436, 1041.4711130786052, 573.890848216985, 933.0062664365649, 419.331356655546, 1018.2631084460999, 0.0, 1232.018682080564, 1351.35325411776, 477.6920182822001, 1284.972584519429, 472.36347669665474, 1240.500018599247, 1193.774622723568, 861.9453967158012, 998.48585474888, 885.4873835543444, 1046.272534299921, 992.4704734600399, 0.7565816267701605, 1531.115168772382, 1355.3161773124057, 956.030223196836, 775.4251947847428, 889.5697017027563, 1310.417344316095, 819.7646446495189, 923.4771192034109, 1439.2752039405789, 1199.9239311393517, 1082.8737889622903, 374.19044799609543, 981.8674206627442, 399.05295557978235, 3.582882640437612, 0.0, 947.5793947321728, 865.6944935938498, 1075.9455316097901, 828.2476640316113, 993.8129460857933, 1010.7263368937839, 1020.4231886976911, 1004.1961984267496, 1045.9574377474294, 885.3814953591041, 28.832082716641434, 352.2396723837334, 1236.4717773859804, 1146.9256756808134, 1037.9964919794788, 79.89856570879773, 1385.3354258539828, 1161.5962214028887, 1270.8830388321223, 1313.098129084979, 10.794280276631554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9262484775885875, "mean_inference_ms": 4.52940265353306, "mean_action_processing_ms": 1.6224579276883009, "mean_env_wait_ms": 10.38964574781865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008013606071472168, "StateBufferConnector_ms": 0.005037426948547363, "ViewRequirementAgentConnector_ms": 0.15447568893432617}, "num_episodes": 7, "episode_return_max": 803.5928139312634, "episode_return_min": -1.9673909032067418, "episode_return_mean": 202.24008205143994, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.61691058682854, "num_env_steps_trained_throughput_per_sec": 79.61691058682854, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 52185.842, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52185.758, "sample_time_ms": 2664.448, "learn_time_ms": 49493.626, "learn_throughput": 80.818, "synch_weights_time_ms": 20.673}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "35fb9_00000", "date": "2024-08-22_08-31-45", "timestamp": 1724295705, "time_this_iter_s": 50.29517889022827, "time_total_s": 2284.116307258606, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b61a040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2284.116307258606, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 31.90694444444445, "ram_util_percent": 82.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.76923357702437, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.57586009161813, "policy_loss": -0.025326027133915987, "vf_loss": 6.598287928545917, "vf_explained_var": 0.5784199387308151, "kl": 0.014490983544888281, "entropy": 0.7605684235613183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.668700500707777, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.953511104886494, "policy_loss": -0.016515694038262443, "vf_loss": 6.967736308284538, "vf_explained_var": 0.4216420159138069, "kl": 0.011452401053559567, "entropy": 0.6393182254342175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 803.5928139312634, "episode_reward_min": -1.9673909032067418, "episode_reward_mean": 198.8105833522356, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.115168772382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 376.54721868580754, "predator_policy": 1531.115168772382}, "policy_reward_mean": {"prey_policy": -745.5341187233414, "predator_policy": 844.9394103994595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.32283933271856, 142.11045932436184, 3.755738185314335, 4.600000000000001, 5.734954880429133, 215.8086148832542, 437.0281601573768, 213.43884764233243, 205.250893548533, 6.060558839483537, 73.8, 226.69033223536985, 440.9075003777252, 34.348539776252686, 39.90000000000029, 361.64118641947294, 280.60338631133493, 64.07597132244119, 803.5928139312634, 397.61369987825316, 141.28348940320055, 123.31050606621059, 79.68773447853229, 199.35318320746345, 541.7480666130741, 39.10000000000023, 195.96866140365955, 1.3131769954423262, 593.193251124573, 143.2255085104704, 56.40000000000053, 313.7126033869613, 301.3695866310617, 90.9930601175686, 196.96970087151493, 1.169618614645306, 14.100000000000003, 389.75566424096013, 20.036437564453507, 196.764840795412, 740.6404930021706, 9.36583317679591, -1.9673909032067418, 206.28561467372103, 125.01156907015547, 385.50000000000205, 184.76397239799243, 135.69930918801973, 295.9870667343166, 347.4386349600654, 95.6578559228943, 86.64104896191652, 435.87818959966415, 319.0476106528203, 55.5613504913096, 1.2797926827002077, 15.165032730659355, 267.73827984458467, 254.34743595805605, 21.26849273369711, 119.9455028465266, 182.5009787126917, 310.19739004892205, 412.6793324460705, 234.6497883711782, 344.25575292970746, 104.4, 317.20916998559017, 12.142186994335036, 55.79408992920837, 24.295592546096415, 349.22325867655934, 115.20337395014144, 339.9575883929492, 21.611218685156746, 2.0577717006452954, 35.79785493530086, 159.39136462742795, 200.45591612139464, 92.8999999999987, 508.3831606138812, 3.025983883483047, 403.74855543212817, 413.80387510671744, 60.90373155476038, 221.12982941867264, 472.5877757119291, 360.4478373555451, 0.20000000000000284, 45.312614694412886, 194.0169731062483, 764.5183060872913, 78.16019398074657, 216.7893025671043, 265.77624818663804, 89.34718720593014, 18.35690530782118, 282.55532171851297, 16.723262856360257, 151.55335958601634], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1220.621900198291, 291.01134931181406, -583.7187210721509, -1323.3541111492593, -1412.047369658606, -995.2254257373646, -871.5507772633364, -1384.3153931997138, -155.7834343271904, -108.99725952622089, -1018.1965058524202, -860.4459838319196, -1351.1842769475875, 38.781966011250404, -1053.120172727591, -1037.0052784854197, -953.3986779726617, -252.3132935575661, -1255.364340862334, -1345.2653800017474, -852.5265656297545, -967.7009510176824, 28.765429785646766, -1319.4364284349308, 284.06219512041696, -914.5540754246149, -1173.767356461005, 25.287523958660884, 39.080632075266166, -1298.5293298080994, -818.8236386551667, -556.0813607706591, 40.0000000000003, -1294.9081369677494, -1102.9077362158691, -1339.9317609966142, 141.52673234976245, -1153.5780565673208, -351.85520108157084, -625.4601222540829, 14.951809933662428, -1057.7966103451015, -987.298873018195, -1256.237251400814, -270.51361869698485, -1052.5903416706728, -1002.8836687860454, -597.387179308407, -1328.9095453465611, -407.29727862098997, -1331.485352088185, 29.85168888052417, -931.4256249925079, -870.5639810075702, -1349.974368748372, -1297.4938521207127, -131.0824782701275, -1119.820897122181, -524.8243454284623, -1526.0919420387872, -8.723815875488201, -669.2626755710035, -1194.304449647115, -77.78420637232534, -1422.5772248181065, -760.7838869783334, -1017.8926755740348, 12.63352604737466, 20.619653859965062, -933.5946472437262, -943.5068398352614, -1170.916030729192, -913.0634355810208, -1196.8739783556234, -132.81966185898878, -728.2829428318281, -1216.6857907770282, -924.7178821897309, -325.02798065503293, -141.29379543359588, -1392.0029376801137, 6.633182300324057, -959.969659984291, -1196.7810216973996, -1333.223979928367, -1388.4436682967817, -1014.3581339534884, -654.4063318163886, -1264.3906355238964, -737.7032802490139, 32.31224282571532, 292.2198087320103, -315.80247730464396, -1031.5480358879515, -1353.6959339843493, -857.4115750742151, -382.1481680145697, -1006.6175820201198, 241.34967030036222, -566.7564480561216, -884.2869336362664, -1024.8669965439296, -774.7617376983952, -295.45660044477984, -1219.3542159991075, 300.23231377362424, -977.4463484695868, -79.32608313886463, -856.745862192063, -49.481830420681135, -1013.2849095117414, -1256.803208658992, -748.9890353324356, -1370.0209220733282, -13.404692871333165, -444.9628057172229, 21.007605485804625, -719.9644647928307, -1398.7434886954723, -1199.1856805274515, -1287.566950624252, 39.076992799702545, -361.9310049525044, -1037.494376320795, -1102.0950335118541, -203.06953773481774, -1009.7588688051258, 70.10057815908232, 28.40755330942448, -812.0208733843448, -820.816721834842, -1418.2994614337715, -373.3920182821991, -1284.872584519429, -170.25234517356384, -1225.4019801367501, -1197.8072683946637, -845.77056405037, -998.2556305821024, -829.9235177919124, -1003.0430484000626, -1011.4043668138015, 348.46667704978915, -1531.115168772382, -1315.5650237682498, -880.5780027908477, -397.80425667506654, -927.2330514194823, -1310.417344316095, -798.1534259643611, -921.1771192034104, -1439.5174322399334, -1169.7614101133486, -1077.2384550529976, -1003.1786338658816, -193.4878701655286, -234.42610192139585, 32.24617982257271, -892.857532396158, 38.178137663984906, -343.26519342906164, -1089.9916711606925, -763.443769955464, -1055.5908562784562, -792.6644185355984, -834.7365516237483, -464.0866368709083, -1172.263124196551, -0.5295854923891713, -852.7802610285958, -1338.0295113973548, -29.552108953684318, -1199.3853598369367, -512.9490321114231, -1246.6237371082723, 141.8375829010378, -1161.3962214028888, -1270.8830388321223, -1307.998129084979, 29.418334417780954, 13.679687739856842, -327.3090858323892, -1034.2675733444453, 376.54721868580754, -469.3430034367644, -892.5949646561737, -838.0771235094691, -1054.8424953533417, -353.1379274339013, 40.0000000000003, -438.8745083623494, -919.0198802167242, -768.5204875002554, -1402.4996455489925, -420.2720221834187, -1022.2148312055841, -1191.6560407820068, -1040.9193842326042, -950.8200584204124, -922.7809590484117], "policy_predator_policy_reward": [1222.3698345967514, 8.5635556224441, 1131.4761283951689, 917.7071631506084, 1412.3473696586059, 998.6811639226797, 876.1507772633373, 1384.3153931997138, 260.1212837727711, 10.394364961068867, 976.7413137072822, 1117.709790860315, 594.6327303395024, 1154.7977407542082, 1143.60691146056, 1159.957387394784, 994.8762530302299, 416.0866120485307, 1261.564340862334, 1345.125938841231, 921.7265656297545, 972.3009510176834, 382.97062482480646, 1134.3907060598497, 926.5160077234425, 144.88337295848095, 1173.8810583350473, 8.947313943549648, 0.8193679247341232, 1298.5293298080994, 574.4206238994072, 1162.1255619458902, 270.0088957891376, 1265.502627489944, 1157.9671269209105, 1348.948341614015, 1029.6904340164544, 785.9537041323682, 673.9449253448763, 700.9840978690323, 441.45504674161936, 742.6732430730187, 1298.6196276787734, 1068.2270028064484, 346.50135317552343, 1056.2903416706738, 519.4885164338097, 1280.13551486811, 1202.5069823556942, 1075.4479082249313, 1331.485352088185, 9.248311119475972, 1279.1081352004762, 718.8501322032603, 1349.974368748372, 1298.8070291161548, 890.952689750753, 953.1439367661324, 668.0498539389292, 1526.0919420387872, 46.2238158754886, 688.1626755710078, 1092.7335151570012, 493.0677442493994, 1378.5489491591177, 1106.1817492683824, 448.5732803640995, 647.6789292801313, 271.3402200944181, 838.6044741608611, 944.5068398352614, 1171.0856493438375, 914.1634355810211, 1209.8739783556234, 556.6790646272156, 694.1792043045605, 1224.1313152176572, 937.3087953135556, 34.96591211927648, 628.1207047647672, 1272.7411420327448, 853.2691063492109, 969.3354931610868, 1196.7810216973996, 1388.4258455080633, 1331.2744118138785, 1010.6894526281375, 864.3606278154681, 992.667133352878, 1134.4383514901922, 38.41940060666482, 22.548547835609792, 500.4664497026371, 1031.6480358879517, 1351.3142721082168, 995.4925461383692, 691.5819285457769, 993.1708882232329, 2.949272212385855, 669.8961405034387, 860.9278770862312, 1143.883909016859, 772.3778989806028, 384.4814881244898, 1219.5542159991073, 135.44587582604, 902.7825637947733, 473.03747846649736, 869.4325254471382, 92.3565176569162, 1014.1958639461942, 1257.1720469072393, 763.8540680630982, 1370.320922073328, 643.9628057172241, 82.14297271591471, 496.26697357791966, 457.0373216871636, 1414.5638011270423, 1204.6338608295785, 670.0453682865807, 698.3900923844964, 581.1723437415639, 1000.754016244436, 1041.4711130786052, 573.890848216985, 933.0062664365649, 419.331356655546, 1018.2631084460999, 0.0, 1232.018682080564, 1351.35325411776, 477.6920182822001, 1284.972584519429, 472.36347669665474, 1240.500018599247, 1193.774622723568, 861.9453967158012, 998.48585474888, 885.4873835543444, 1046.272534299921, 992.4704734600399, 0.7565816267701605, 1531.115168772382, 1355.3161773124057, 956.030223196836, 775.4251947847428, 889.5697017027563, 1310.417344316095, 819.7646446495189, 923.4771192034109, 1439.2752039405789, 1199.9239311393517, 1082.8737889622903, 374.19044799609543, 981.8674206627442, 399.05295557978235, 3.582882640437612, 0.0, 947.5793947321728, 865.6944935938498, 1075.9455316097901, 828.2476640316113, 993.8129460857933, 1010.7263368937839, 1020.4231886976911, 1004.1961984267496, 1045.9574377474294, 885.3814953591041, 28.832082716641434, 352.2396723837334, 1236.4717773859804, 1146.9256756808134, 1037.9964919794788, 79.89856570879773, 1385.3354258539828, 1161.5962214028887, 1270.8830388321223, 1313.098129084979, 10.794280276631554, 316.92374268855394, 190.72262851023166, 849.4940521587386, 572.7446085871906, 545.4784816774635, 894.6196803962214, 1123.9371026518706, 985.7718187780448, 405.26579147890095, 173.64838414163788, 941.6985254494214, 505.54305033558774, 787.1475198082259, 1402.2295185488465, 823.3727893573548, 901.6693857501677, 1040.5312936694359, 1208.7673942015347, 970.6829251184987, 1054.4714519363467]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.921703546250434, "mean_inference_ms": 4.529060468386317, "mean_action_processing_ms": 1.629098607900416, "mean_env_wait_ms": 10.384773403478846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043108463287353516, "StateBufferConnector_ms": 0.004987001419067383, "ViewRequirementAgentConnector_ms": 0.15634262561798096}, "num_episodes": 10, "episode_return_max": 803.5928139312634, "episode_return_min": -1.9673909032067418, "episode_return_mean": 198.8105833522356, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.51217582544353, "num_env_steps_trained_throughput_per_sec": 76.51217582544353, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 52222.956, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52222.871, "sample_time_ms": 2781.063, "learn_time_ms": 49414.261, "learn_throughput": 80.948, "synch_weights_time_ms": 20.838}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "35fb9_00000", "date": "2024-08-22_08-32-38", "timestamp": 1724295758, "time_this_iter_s": 52.31769919395447, "time_total_s": 2336.4340064525604, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcd8af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2336.4340064525604, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 33.64054054054054, "ram_util_percent": 82.5891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.095946994155803, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.8091601333920915, "policy_loss": -0.022061084617648725, "vf_loss": 6.828361372720628, "vf_explained_var": 0.5420181510309694, "kl": 0.014299249139777015, "entropy": 0.7049902603109047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.59936702894786, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.278389322442353, "policy_loss": -0.018912482231352775, "vf_loss": 7.294759589149838, "vf_explained_var": 0.3799223397774671, "kl": 0.012710983884427204, "entropy": 0.5993891260926686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 803.5928139312634, "episode_reward_min": -5.98605989872218, "episode_reward_mean": 198.88900280760853, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.115168772382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 386.37026097683406, "predator_policy": 1531.115168772382}, "policy_reward_mean": {"prey_policy": -736.741351440869, "predator_policy": 836.1858528446738}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000029, 361.64118641947294, 280.60338631133493, 64.07597132244119, 803.5928139312634, 397.61369987825316, 141.28348940320055, 123.31050606621059, 79.68773447853229, 199.35318320746345, 541.7480666130741, 39.10000000000023, 195.96866140365955, 1.3131769954423262, 593.193251124573, 143.2255085104704, 56.40000000000053, 313.7126033869613, 301.3695866310617, 90.9930601175686, 196.96970087151493, 1.169618614645306, 14.100000000000003, 389.75566424096013, 20.036437564453507, 196.764840795412, 740.6404930021706, 9.36583317679591, -1.9673909032067418, 206.28561467372103, 125.01156907015547, 385.50000000000205, 184.76397239799243, 135.69930918801973, 295.9870667343166, 347.4386349600654, 95.6578559228943, 86.64104896191652, 435.87818959966415, 319.0476106528203, 55.5613504913096, 1.2797926827002077, 15.165032730659355, 267.73827984458467, 254.34743595805605, 21.26849273369711, 119.9455028465266, 182.5009787126917, 310.19739004892205, 412.6793324460705, 234.6497883711782, 344.25575292970746, 104.4, 317.20916998559017, 12.142186994335036, 55.79408992920837, 24.295592546096415, 349.22325867655934, 115.20337395014144, 339.9575883929492, 21.611218685156746, 2.0577717006452954, 35.79785493530086, 159.39136462742795, 200.45591612139464, 92.8999999999987, 508.3831606138812, 3.025983883483047, 403.74855543212817, 413.80387510671744, 60.90373155476038, 221.12982941867264, 472.5877757119291, 360.4478373555451, 0.20000000000000284, 45.312614694412886, 194.0169731062483, 764.5183060872913, 78.16019398074657, 216.7893025671043, 265.77624818663804, 89.34718720593014, 18.35690530782118, 282.55532171851297, 16.723262856360257, 151.55335958601634, 71.47388548569235, -5.98605989872218, 70.30454893517793, 556.6857823972879, 89.58467645579115, 197.22949888189171, 452.972692538081, 30.810701197737625, 60.73184258468417, 164.27762358536475, 259.208655571905, -0.14292661601425793, 354.4961138169399, 17.05234978463362], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [39.080632075266166, -1298.5293298080994, -818.8236386551667, -556.0813607706591, 40.0000000000003, -1294.9081369677494, -1102.9077362158691, -1339.9317609966142, 141.52673234976245, -1153.5780565673208, -351.85520108157084, -625.4601222540829, 14.951809933662428, -1057.7966103451015, -987.298873018195, -1256.237251400814, -270.51361869698485, -1052.5903416706728, -1002.8836687860454, -597.387179308407, -1328.9095453465611, -407.29727862098997, -1331.485352088185, 29.85168888052417, -931.4256249925079, -870.5639810075702, -1349.974368748372, -1297.4938521207127, -131.0824782701275, -1119.820897122181, -524.8243454284623, -1526.0919420387872, -8.723815875488201, -669.2626755710035, -1194.304449647115, -77.78420637232534, -1422.5772248181065, -760.7838869783334, -1017.8926755740348, 12.63352604737466, 20.619653859965062, -933.5946472437262, -943.5068398352614, -1170.916030729192, -913.0634355810208, -1196.8739783556234, -132.81966185898878, -728.2829428318281, -1216.6857907770282, -924.7178821897309, -325.02798065503293, -141.29379543359588, -1392.0029376801137, 6.633182300324057, -959.969659984291, -1196.7810216973996, -1333.223979928367, -1388.4436682967817, -1014.3581339534884, -654.4063318163886, -1264.3906355238964, -737.7032802490139, 32.31224282571532, 292.2198087320103, -315.80247730464396, -1031.5480358879515, -1353.6959339843493, -857.4115750742151, -382.1481680145697, -1006.6175820201198, 241.34967030036222, -566.7564480561216, -884.2869336362664, -1024.8669965439296, -774.7617376983952, -295.45660044477984, -1219.3542159991075, 300.23231377362424, -977.4463484695868, -79.32608313886463, -856.745862192063, -49.481830420681135, -1013.2849095117414, -1256.803208658992, -748.9890353324356, -1370.0209220733282, -13.404692871333165, -444.9628057172229, 21.007605485804625, -719.9644647928307, -1398.7434886954723, -1199.1856805274515, -1287.566950624252, 39.076992799702545, -361.9310049525044, -1037.494376320795, -1102.0950335118541, -203.06953773481774, -1009.7588688051258, 70.10057815908232, 28.40755330942448, -812.0208733843448, -820.816721834842, -1418.2994614337715, -373.3920182821991, -1284.872584519429, -170.25234517356384, -1225.4019801367501, -1197.8072683946637, -845.77056405037, -998.2556305821024, -829.9235177919124, -1003.0430484000626, -1011.4043668138015, 348.46667704978915, -1531.115168772382, -1315.5650237682498, -880.5780027908477, -397.80425667506654, -927.2330514194823, -1310.417344316095, -798.1534259643611, -921.1771192034104, -1439.5174322399334, -1169.7614101133486, -1077.2384550529976, -1003.1786338658816, -193.4878701655286, -234.42610192139585, 32.24617982257271, -892.857532396158, 38.178137663984906, -343.26519342906164, -1089.9916711606925, -763.443769955464, -1055.5908562784562, -792.6644185355984, -834.7365516237483, -464.0866368709083, -1172.263124196551, -0.5295854923891713, -852.7802610285958, -1338.0295113973548, -29.552108953684318, -1199.3853598369367, -512.9490321114231, -1246.6237371082723, 141.8375829010378, -1161.3962214028888, -1270.8830388321223, -1307.998129084979, 29.418334417780954, 13.679687739856842, -327.3090858323892, -1034.2675733444453, 376.54721868580754, -469.3430034367644, -892.5949646561737, -838.0771235094691, -1054.8424953533417, -353.1379274339013, 40.0000000000003, -438.8745083623494, -919.0198802167242, -768.5204875002554, -1402.4996455489925, -420.2720221834187, -1022.2148312055841, -1191.6560407820068, -1040.9193842326042, -950.8200584204124, -922.7809590484117, -390.19128760297895, -1064.61373059228, -1111.6230912566634, -1230.382441555485, -104.88391131567612, -1053.8406498992108, -836.7443769113196, 386.37026097683406, -716.0626967082362, -911.9455369056385, -665.7128309647592, -409.4318169063763, -927.8914557807115, -184.8857280528559, -586.0781041789604, -589.3813706162332, -1185.9107583343311, -553.556953295606, -667.7028096212367, -269.0663086819284, -1010.3683581701196, -138.76523394370716, -1355.5373245360806, -1212.1643503451396, -3.2937686228909087, -949.9293639600415, -1252.1334547099707, -987.7043061655365], "policy_predator_policy_reward": [0.8193679247341232, 1298.5293298080994, 574.4206238994072, 1162.1255619458902, 270.0088957891376, 1265.502627489944, 1157.9671269209105, 1348.948341614015, 1029.6904340164544, 785.9537041323682, 673.9449253448763, 700.9840978690323, 441.45504674161936, 742.6732430730187, 1298.6196276787734, 1068.2270028064484, 346.50135317552343, 1056.2903416706738, 519.4885164338097, 1280.13551486811, 1202.5069823556942, 1075.4479082249313, 1331.485352088185, 9.248311119475972, 1279.1081352004762, 718.8501322032603, 1349.974368748372, 1298.8070291161548, 890.952689750753, 953.1439367661324, 668.0498539389292, 1526.0919420387872, 46.2238158754886, 688.1626755710078, 1092.7335151570012, 493.0677442493994, 1378.5489491591177, 1106.1817492683824, 448.5732803640995, 647.6789292801313, 271.3402200944181, 838.6044741608611, 944.5068398352614, 1171.0856493438375, 914.1634355810211, 1209.8739783556234, 556.6790646272156, 694.1792043045605, 1224.1313152176572, 937.3087953135556, 34.96591211927648, 628.1207047647672, 1272.7411420327448, 853.2691063492109, 969.3354931610868, 1196.7810216973996, 1388.4258455080633, 1331.2744118138785, 1010.6894526281375, 864.3606278154681, 992.667133352878, 1134.4383514901922, 38.41940060666482, 22.548547835609792, 500.4664497026371, 1031.6480358879517, 1351.3142721082168, 995.4925461383692, 691.5819285457769, 993.1708882232329, 2.949272212385855, 669.8961405034387, 860.9278770862312, 1143.883909016859, 772.3778989806028, 384.4814881244898, 1219.5542159991073, 135.44587582604, 902.7825637947733, 473.03747846649736, 869.4325254471382, 92.3565176569162, 1014.1958639461942, 1257.1720469072393, 763.8540680630982, 1370.320922073328, 643.9628057172241, 82.14297271591471, 496.26697357791966, 457.0373216871636, 1414.5638011270423, 1204.6338608295785, 670.0453682865807, 698.3900923844964, 581.1723437415639, 1000.754016244436, 1041.4711130786052, 573.890848216985, 933.0062664365649, 419.331356655546, 1018.2631084460999, 0.0, 1232.018682080564, 1351.35325411776, 477.6920182822001, 1284.972584519429, 472.36347669665474, 1240.500018599247, 1193.774622723568, 861.9453967158012, 998.48585474888, 885.4873835543444, 1046.272534299921, 992.4704734600399, 0.7565816267701605, 1531.115168772382, 1355.3161773124057, 956.030223196836, 775.4251947847428, 889.5697017027563, 1310.417344316095, 819.7646446495189, 923.4771192034109, 1439.2752039405789, 1199.9239311393517, 1082.8737889622903, 374.19044799609543, 981.8674206627442, 399.05295557978235, 3.582882640437612, 0.0, 947.5793947321728, 865.6944935938498, 1075.9455316097901, 828.2476640316113, 993.8129460857933, 1010.7263368937839, 1020.4231886976911, 1004.1961984267496, 1045.9574377474294, 885.3814953591041, 28.832082716641434, 352.2396723837334, 1236.4717773859804, 1146.9256756808134, 1037.9964919794788, 79.89856570879773, 1385.3354258539828, 1161.5962214028887, 1270.8830388321223, 1313.098129084979, 10.794280276631554, 316.92374268855394, 190.72262851023166, 849.4940521587386, 572.7446085871906, 545.4784816774635, 894.6196803962214, 1123.9371026518706, 985.7718187780448, 405.26579147890095, 173.64838414163788, 941.6985254494214, 505.54305033558774, 787.1475198082259, 1402.2295185488465, 823.3727893573548, 901.6693857501677, 1040.5312936694359, 1208.7673942015347, 970.6829251184987, 1054.4714519363467, 480.17152601278246, 1046.1073776681699, 1375.6054007931875, 960.4140721202318, 176.696897910596, 1052.332212239468, 810.8451925818922, 196.2147057498813, 714.4670680000929, 1003.1258420695755, 249.870841235092, 1022.5033055179345, 863.7887975940151, 701.9610787776309, 171.80400026898042, 1034.4661757239548, 1216.411439565573, 583.7881146490521, 701.0085732106546, 400.0381686778831, 1022.3570998278364, 385.98514785789513, 1369.1769355319793, 1198.381812733227, 385.5569448150651, 922.1623015848076, 1244.0472305613707, 1012.8428800987714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.901809142184725, "mean_inference_ms": 4.528183439731087, "mean_action_processing_ms": 1.6596614437274075, "mean_env_wait_ms": 10.388714949819084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004479765892028809, "StateBufferConnector_ms": 0.004369854927062988, "ViewRequirementAgentConnector_ms": 0.15401089191436768}, "num_episodes": 14, "episode_return_max": 803.5928139312634, "episode_return_min": -5.98605989872218, "episode_return_mean": 198.88900280760853, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.83924645178726, "num_env_steps_trained_throughput_per_sec": 76.83924645178726, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 52576.253, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52576.167, "sample_time_ms": 2770.262, "learn_time_ms": 49777.414, "learn_throughput": 80.358, "synch_weights_time_ms": 20.873}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "35fb9_00000", "date": "2024-08-22_08-33-30", "timestamp": 1724295810, "time_this_iter_s": 52.125332832336426, "time_total_s": 2388.559339284897, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b630dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2388.559339284897, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 35.23243243243243, "ram_util_percent": 83.0662162162162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.422319366503014, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.238865281665136, "policy_loss": -0.02154244834769064, "vf_loss": 7.2576110393281965, "vf_explained_var": 0.5289870272868524, "kl": 0.013983464519192697, "entropy": 0.6820874058695697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.705389326400859, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.375148321837975, "policy_loss": -0.01894960404378633, "vf_loss": 7.391640986588897, "vf_explained_var": 0.2980816170967445, "kl": 0.012284635958907308, "entropy": 0.5463801374038061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 764.5183060872913, "episode_reward_min": -5.98605989872218, "episode_reward_mean": 192.20726202147836, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.115168772382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 386.37026097683406, "predator_policy": 1531.115168772382}, "policy_reward_mean": {"prey_policy": -719.0703260174953, "predator_policy": 815.1739570282349}, "custom_metrics": {}, "hist_stats": {"episode_reward": [313.7126033869613, 301.3695866310617, 90.9930601175686, 196.96970087151493, 1.169618614645306, 14.100000000000003, 389.75566424096013, 20.036437564453507, 196.764840795412, 740.6404930021706, 9.36583317679591, -1.9673909032067418, 206.28561467372103, 125.01156907015547, 385.50000000000205, 184.76397239799243, 135.69930918801973, 295.9870667343166, 347.4386349600654, 95.6578559228943, 86.64104896191652, 435.87818959966415, 319.0476106528203, 55.5613504913096, 1.2797926827002077, 15.165032730659355, 267.73827984458467, 254.34743595805605, 21.26849273369711, 119.9455028465266, 182.5009787126917, 310.19739004892205, 412.6793324460705, 234.6497883711782, 344.25575292970746, 104.4, 317.20916998559017, 12.142186994335036, 55.79408992920837, 24.295592546096415, 349.22325867655934, 115.20337395014144, 339.9575883929492, 21.611218685156746, 2.0577717006452954, 35.79785493530086, 159.39136462742795, 200.45591612139464, 92.8999999999987, 508.3831606138812, 3.025983883483047, 403.74855543212817, 413.80387510671744, 60.90373155476038, 221.12982941867264, 472.5877757119291, 360.4478373555451, 0.20000000000000284, 45.312614694412886, 194.0169731062483, 764.5183060872913, 78.16019398074657, 216.7893025671043, 265.77624818663804, 89.34718720593014, 18.35690530782118, 282.55532171851297, 16.723262856360257, 151.55335958601634, 71.47388548569235, -5.98605989872218, 70.30454893517793, 556.6857823972879, 89.58467645579115, 197.22949888189171, 452.972692538081, 30.810701197737625, 60.73184258468417, 164.27762358536475, 259.208655571905, -0.14292661601425793, 354.4961138169399, 17.05234978463362, 475.73868718384193, 238.2507007078331, 168.88026727370064, 154.65073616767177, 8.357722348120737, 172.69518275162702, 64.9731098773036, 22.800000000000054, 249.2008644348195, 714.8054360274436, 45.030346263109436, 106.91136985841169, 136.1267671431846, 304.2132100608591, 27.12905853808632, 233.94693209301073, 270.1261663233514], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1194.304449647115, -77.78420637232534, -1422.5772248181065, -760.7838869783334, -1017.8926755740348, 12.63352604737466, 20.619653859965062, -933.5946472437262, -943.5068398352614, -1170.916030729192, -913.0634355810208, -1196.8739783556234, -132.81966185898878, -728.2829428318281, -1216.6857907770282, -924.7178821897309, -325.02798065503293, -141.29379543359588, -1392.0029376801137, 6.633182300324057, -959.969659984291, -1196.7810216973996, -1333.223979928367, -1388.4436682967817, -1014.3581339534884, -654.4063318163886, -1264.3906355238964, -737.7032802490139, 32.31224282571532, 292.2198087320103, -315.80247730464396, -1031.5480358879515, -1353.6959339843493, -857.4115750742151, -382.1481680145697, -1006.6175820201198, 241.34967030036222, -566.7564480561216, -884.2869336362664, -1024.8669965439296, -774.7617376983952, -295.45660044477984, -1219.3542159991075, 300.23231377362424, -977.4463484695868, -79.32608313886463, -856.745862192063, -49.481830420681135, -1013.2849095117414, -1256.803208658992, -748.9890353324356, -1370.0209220733282, -13.404692871333165, -444.9628057172229, 21.007605485804625, -719.9644647928307, -1398.7434886954723, -1199.1856805274515, -1287.566950624252, 39.076992799702545, -361.9310049525044, -1037.494376320795, -1102.0950335118541, -203.06953773481774, -1009.7588688051258, 70.10057815908232, 28.40755330942448, -812.0208733843448, -820.816721834842, -1418.2994614337715, -373.3920182821991, -1284.872584519429, -170.25234517356384, -1225.4019801367501, -1197.8072683946637, -845.77056405037, -998.2556305821024, -829.9235177919124, -1003.0430484000626, -1011.4043668138015, 348.46667704978915, -1531.115168772382, -1315.5650237682498, -880.5780027908477, -397.80425667506654, -927.2330514194823, -1310.417344316095, -798.1534259643611, -921.1771192034104, -1439.5174322399334, -1169.7614101133486, -1077.2384550529976, -1003.1786338658816, -193.4878701655286, -234.42610192139585, 32.24617982257271, -892.857532396158, 38.178137663984906, -343.26519342906164, -1089.9916711606925, -763.443769955464, -1055.5908562784562, -792.6644185355984, -834.7365516237483, -464.0866368709083, -1172.263124196551, -0.5295854923891713, -852.7802610285958, -1338.0295113973548, -29.552108953684318, -1199.3853598369367, -512.9490321114231, -1246.6237371082723, 141.8375829010378, -1161.3962214028888, -1270.8830388321223, -1307.998129084979, 29.418334417780954, 13.679687739856842, -327.3090858323892, -1034.2675733444453, 376.54721868580754, -469.3430034367644, -892.5949646561737, -838.0771235094691, -1054.8424953533417, -353.1379274339013, 40.0000000000003, -438.8745083623494, -919.0198802167242, -768.5204875002554, -1402.4996455489925, -420.2720221834187, -1022.2148312055841, -1191.6560407820068, -1040.9193842326042, -950.8200584204124, -922.7809590484117, -390.19128760297895, -1064.61373059228, -1111.6230912566634, -1230.382441555485, -104.88391131567612, -1053.8406498992108, -836.7443769113196, 386.37026097683406, -716.0626967082362, -911.9455369056385, -665.7128309647592, -409.4318169063763, -927.8914557807115, -184.8857280528559, -586.0781041789604, -589.3813706162332, -1185.9107583343311, -553.556953295606, -667.7028096212367, -269.0663086819284, -1010.3683581701196, -138.76523394370716, -1355.5373245360806, -1212.1643503451396, -3.2937686228909087, -949.9293639600415, -1252.1334547099707, -987.7043061655365, 311.9061654122173, -552.5382831005769, -123.24475750010646, -1143.081065327753, -648.7297651380721, -308.3710849937944, -930.5984368348466, -5.981648689539712, -992.8067851591023, -843.3685116962756, -162.91156748888588, -1046.7557850674007, -508.0854212726299, -1064.826644749205, -1112.7034930319728, -611.967274317448, -774.2773730952957, -876.1514503729595, 237.26635690102947, -301.2694845261223, -1217.76961292611, 40.0000000000003, -1023.3699019499218, -108.71521615783917, -1126.8787922595116, -721.307677211728, -366.8072268783317, -929.0683024513369, -876.9252430993074, -1401.331956253194, -1146.567162628531, -97.50205289795554, -1162.3094993278387, -867.0741417699556], "policy_predator_policy_reward": [1092.7335151570012, 493.0677442493994, 1378.5489491591177, 1106.1817492683824, 448.5732803640995, 647.6789292801313, 271.3402200944181, 838.6044741608611, 944.5068398352614, 1171.0856493438375, 914.1634355810211, 1209.8739783556234, 556.6790646272156, 694.1792043045605, 1224.1313152176572, 937.3087953135556, 34.96591211927648, 628.1207047647672, 1272.7411420327448, 853.2691063492109, 969.3354931610868, 1196.7810216973996, 1388.4258455080633, 1331.2744118138785, 1010.6894526281375, 864.3606278154681, 992.667133352878, 1134.4383514901922, 38.41940060666482, 22.548547835609792, 500.4664497026371, 1031.6480358879517, 1351.3142721082168, 995.4925461383692, 691.5819285457769, 993.1708882232329, 2.949272212385855, 669.8961405034387, 860.9278770862312, 1143.883909016859, 772.3778989806028, 384.4814881244898, 1219.5542159991073, 135.44587582604, 902.7825637947733, 473.03747846649736, 869.4325254471382, 92.3565176569162, 1014.1958639461942, 1257.1720469072393, 763.8540680630982, 1370.320922073328, 643.9628057172241, 82.14297271591471, 496.26697357791966, 457.0373216871636, 1414.5638011270423, 1204.6338608295785, 670.0453682865807, 698.3900923844964, 581.1723437415639, 1000.754016244436, 1041.4711130786052, 573.890848216985, 933.0062664365649, 419.331356655546, 1018.2631084460999, 0.0, 1232.018682080564, 1351.35325411776, 477.6920182822001, 1284.972584519429, 472.36347669665474, 1240.500018599247, 1193.774622723568, 861.9453967158012, 998.48585474888, 885.4873835543444, 1046.272534299921, 992.4704734600399, 0.7565816267701605, 1531.115168772382, 1355.3161773124057, 956.030223196836, 775.4251947847428, 889.5697017027563, 1310.417344316095, 819.7646446495189, 923.4771192034109, 1439.2752039405789, 1199.9239311393517, 1082.8737889622903, 374.19044799609543, 981.8674206627442, 399.05295557978235, 3.582882640437612, 0.0, 947.5793947321728, 865.6944935938498, 1075.9455316097901, 828.2476640316113, 993.8129460857933, 1010.7263368937839, 1020.4231886976911, 1004.1961984267496, 1045.9574377474294, 885.3814953591041, 28.832082716641434, 352.2396723837334, 1236.4717773859804, 1146.9256756808134, 1037.9964919794788, 79.89856570879773, 1385.3354258539828, 1161.5962214028887, 1270.8830388321223, 1313.098129084979, 10.794280276631554, 316.92374268855394, 190.72262851023166, 849.4940521587386, 572.7446085871906, 545.4784816774635, 894.6196803962214, 1123.9371026518706, 985.7718187780448, 405.26579147890095, 173.64838414163788, 941.6985254494214, 505.54305033558774, 787.1475198082259, 1402.2295185488465, 823.3727893573548, 901.6693857501677, 1040.5312936694359, 1208.7673942015347, 970.6829251184987, 1054.4714519363467, 480.17152601278246, 1046.1073776681699, 1375.6054007931875, 960.4140721202318, 176.696897910596, 1052.332212239468, 810.8451925818922, 196.2147057498813, 714.4670680000929, 1003.1258420695755, 249.870841235092, 1022.5033055179345, 863.7887975940151, 701.9610787776309, 171.80400026898042, 1034.4661757239548, 1216.411439565573, 583.7881146490521, 701.0085732106546, 400.0381686778831, 1022.3570998278364, 385.98514785789513, 1369.1769355319793, 1198.381812733227, 385.5569448150651, 922.1623015848076, 1244.0472305613707, 1012.8428800987714, 162.72557605671125, 553.6452288154918, 1164.3884231123404, 340.1881004233527, 867.6255992327733, 258.355518172795, 354.99298701828866, 736.2378346737719, 1004.7992305680511, 839.7337886354512, 451.7083608577693, 930.6541744501451, 643.7766711444621, 994.1085047546762, 1115.6034930319736, 631.8672743174525, 1053.7976451418012, 845.8320427612732, 478.64840795117726, 300.16015570135903, 1217.76961292611, 5.030346263108996, 966.3675830414295, 272.628904924743, 1138.4889679013327, 845.8242687130924, 688.6561809826625, 911.4325584078658, 909.9401655162005, 1395.4460923743893, 1068.3901596224587, 409.62598799703653, 1035.3495972010599, 1264.1602102200918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.928142170649681, "mean_inference_ms": 4.530716928041187, "mean_action_processing_ms": 1.6315911569838357, "mean_env_wait_ms": 10.409038043581106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006169676780700684, "StateBufferConnector_ms": 0.004936933517456055, "ViewRequirementAgentConnector_ms": 0.17152225971221924}, "num_episodes": 17, "episode_return_max": 764.5183060872913, "episode_return_min": -5.98605989872218, "episode_return_mean": 192.20726202147836, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.56186253697867, "num_env_steps_trained_throughput_per_sec": 76.56186253697867, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 52724.074, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52723.988, "sample_time_ms": 2762.778, "learn_time_ms": 49933.474, "learn_throughput": 80.107, "synch_weights_time_ms": 20.011}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "35fb9_00000", "date": "2024-08-22_08-34-22", "timestamp": 1724295862, "time_this_iter_s": 52.359288930892944, "time_total_s": 2440.91862821579, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcd8c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2440.91862821579, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 38.09466666666667, "ram_util_percent": 82.492}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.630439535082964, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.798938420966819, "policy_loss": -0.021873041780212175, "vf_loss": 6.817970818565005, "vf_explained_var": 0.5618221335940891, "kl": 0.014203209959453456, "entropy": 0.6487209811254784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.584402808878156, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.355149098552724, "policy_loss": -0.01993036703403704, "vf_loss": 7.372657047251545, "vf_explained_var": 0.25322622675744316, "kl": 0.012112039388970488, "entropy": 0.5243818712139886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 764.5183060872913, "episode_reward_min": -9.744421301678223, "episode_reward_mean": 203.06767180297862, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.115168772382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 386.37026097683406, "predator_policy": 1531.115168772382}, "policy_reward_mean": {"prey_policy": -699.509422944559, "predator_policy": 801.0432588460488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.764840795412, 740.6404930021706, 9.36583317679591, -1.9673909032067418, 206.28561467372103, 125.01156907015547, 385.50000000000205, 184.76397239799243, 135.69930918801973, 295.9870667343166, 347.4386349600654, 95.6578559228943, 86.64104896191652, 435.87818959966415, 319.0476106528203, 55.5613504913096, 1.2797926827002077, 15.165032730659355, 267.73827984458467, 254.34743595805605, 21.26849273369711, 119.9455028465266, 182.5009787126917, 310.19739004892205, 412.6793324460705, 234.6497883711782, 344.25575292970746, 104.4, 317.20916998559017, 12.142186994335036, 55.79408992920837, 24.295592546096415, 349.22325867655934, 115.20337395014144, 339.9575883929492, 21.611218685156746, 2.0577717006452954, 35.79785493530086, 159.39136462742795, 200.45591612139464, 92.8999999999987, 508.3831606138812, 3.025983883483047, 403.74855543212817, 413.80387510671744, 60.90373155476038, 221.12982941867264, 472.5877757119291, 360.4478373555451, 0.20000000000000284, 45.312614694412886, 194.0169731062483, 764.5183060872913, 78.16019398074657, 216.7893025671043, 265.77624818663804, 89.34718720593014, 18.35690530782118, 282.55532171851297, 16.723262856360257, 151.55335958601634, 71.47388548569235, -5.98605989872218, 70.30454893517793, 556.6857823972879, 89.58467645579115, 197.22949888189171, 452.972692538081, 30.810701197737625, 60.73184258468417, 164.27762358536475, 259.208655571905, -0.14292661601425793, 354.4961138169399, 17.05234978463362, 475.73868718384193, 238.2507007078331, 168.88026727370064, 154.65073616767177, 8.357722348120737, 172.69518275162702, 64.9731098773036, 22.800000000000054, 249.2008644348195, 714.8054360274436, 45.030346263109436, 106.91136985841169, 136.1267671431846, 304.2132100608591, 27.12905853808632, 233.94693209301073, 270.1261663233514, 631.8871286952602, 5.893220215258989, 346.73322902012944, 612.9744693828698, 286.3000000000038, 421.1536563924208, -9.744421301678223, 118.9503671729292], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-325.02798065503293, -141.29379543359588, -1392.0029376801137, 6.633182300324057, -959.969659984291, -1196.7810216973996, -1333.223979928367, -1388.4436682967817, -1014.3581339534884, -654.4063318163886, -1264.3906355238964, -737.7032802490139, 32.31224282571532, 292.2198087320103, -315.80247730464396, -1031.5480358879515, -1353.6959339843493, -857.4115750742151, -382.1481680145697, -1006.6175820201198, 241.34967030036222, -566.7564480561216, -884.2869336362664, -1024.8669965439296, -774.7617376983952, -295.45660044477984, -1219.3542159991075, 300.23231377362424, -977.4463484695868, -79.32608313886463, -856.745862192063, -49.481830420681135, -1013.2849095117414, -1256.803208658992, -748.9890353324356, -1370.0209220733282, -13.404692871333165, -444.9628057172229, 21.007605485804625, -719.9644647928307, -1398.7434886954723, -1199.1856805274515, -1287.566950624252, 39.076992799702545, -361.9310049525044, -1037.494376320795, -1102.0950335118541, -203.06953773481774, -1009.7588688051258, 70.10057815908232, 28.40755330942448, -812.0208733843448, -820.816721834842, -1418.2994614337715, -373.3920182821991, -1284.872584519429, -170.25234517356384, -1225.4019801367501, -1197.8072683946637, -845.77056405037, -998.2556305821024, -829.9235177919124, -1003.0430484000626, -1011.4043668138015, 348.46667704978915, -1531.115168772382, -1315.5650237682498, -880.5780027908477, -397.80425667506654, -927.2330514194823, -1310.417344316095, -798.1534259643611, -921.1771192034104, -1439.5174322399334, -1169.7614101133486, -1077.2384550529976, -1003.1786338658816, -193.4878701655286, -234.42610192139585, 32.24617982257271, -892.857532396158, 38.178137663984906, -343.26519342906164, -1089.9916711606925, -763.443769955464, -1055.5908562784562, -792.6644185355984, -834.7365516237483, -464.0866368709083, -1172.263124196551, -0.5295854923891713, -852.7802610285958, -1338.0295113973548, -29.552108953684318, -1199.3853598369367, -512.9490321114231, -1246.6237371082723, 141.8375829010378, -1161.3962214028888, -1270.8830388321223, -1307.998129084979, 29.418334417780954, 13.679687739856842, -327.3090858323892, -1034.2675733444453, 376.54721868580754, -469.3430034367644, -892.5949646561737, -838.0771235094691, -1054.8424953533417, -353.1379274339013, 40.0000000000003, -438.8745083623494, -919.0198802167242, -768.5204875002554, -1402.4996455489925, -420.2720221834187, -1022.2148312055841, -1191.6560407820068, -1040.9193842326042, -950.8200584204124, -922.7809590484117, -390.19128760297895, -1064.61373059228, -1111.6230912566634, -1230.382441555485, -104.88391131567612, -1053.8406498992108, -836.7443769113196, 386.37026097683406, -716.0626967082362, -911.9455369056385, -665.7128309647592, -409.4318169063763, -927.8914557807115, -184.8857280528559, -586.0781041789604, -589.3813706162332, -1185.9107583343311, -553.556953295606, -667.7028096212367, -269.0663086819284, -1010.3683581701196, -138.76523394370716, -1355.5373245360806, -1212.1643503451396, -3.2937686228909087, -949.9293639600415, -1252.1334547099707, -987.7043061655365, 311.9061654122173, -552.5382831005769, -123.24475750010646, -1143.081065327753, -648.7297651380721, -308.3710849937944, -930.5984368348466, -5.981648689539712, -992.8067851591023, -843.3685116962756, -162.91156748888588, -1046.7557850674007, -508.0854212726299, -1064.826644749205, -1112.7034930319728, -611.967274317448, -774.2773730952957, -876.1514503729595, 237.26635690102947, -301.2694845261223, -1217.76961292611, 40.0000000000003, -1023.3699019499218, -108.71521615783917, -1126.8787922595116, -721.307677211728, -366.8072268783317, -929.0683024513369, -876.9252430993074, -1401.331956253194, -1146.567162628531, -97.50205289795554, -1162.3094993278387, -867.0741417699556, 196.8229105611189, -998.8855385696554, -949.4821126412658, -859.7610680107471, -243.02380108932599, -294.8067054499716, -1146.27737721158, 30.273548446340133, -105.7433190651669, 234.3029389473304, -1261.5606820365097, 17.36391716401435, -590.3144329872397, -942.4615931366825, -785.4280534497177, -989.3884897686911], "policy_predator_policy_reward": [34.96591211927648, 628.1207047647672, 1272.7411420327448, 853.2691063492109, 969.3354931610868, 1196.7810216973996, 1388.4258455080633, 1331.2744118138785, 1010.6894526281375, 864.3606278154681, 992.667133352878, 1134.4383514901922, 38.41940060666482, 22.548547835609792, 500.4664497026371, 1031.6480358879517, 1351.3142721082168, 995.4925461383692, 691.5819285457769, 993.1708882232329, 2.949272212385855, 669.8961405034387, 860.9278770862312, 1143.883909016859, 772.3778989806028, 384.4814881244898, 1219.5542159991073, 135.44587582604, 902.7825637947733, 473.03747846649736, 869.4325254471382, 92.3565176569162, 1014.1958639461942, 1257.1720469072393, 763.8540680630982, 1370.320922073328, 643.9628057172241, 82.14297271591471, 496.26697357791966, 457.0373216871636, 1414.5638011270423, 1204.6338608295785, 670.0453682865807, 698.3900923844964, 581.1723437415639, 1000.754016244436, 1041.4711130786052, 573.890848216985, 933.0062664365649, 419.331356655546, 1018.2631084460999, 0.0, 1232.018682080564, 1351.35325411776, 477.6920182822001, 1284.972584519429, 472.36347669665474, 1240.500018599247, 1193.774622723568, 861.9453967158012, 998.48585474888, 885.4873835543444, 1046.272534299921, 992.4704734600399, 0.7565816267701605, 1531.115168772382, 1355.3161773124057, 956.030223196836, 775.4251947847428, 889.5697017027563, 1310.417344316095, 819.7646446495189, 923.4771192034109, 1439.2752039405789, 1199.9239311393517, 1082.8737889622903, 374.19044799609543, 981.8674206627442, 399.05295557978235, 3.582882640437612, 0.0, 947.5793947321728, 865.6944935938498, 1075.9455316097901, 828.2476640316113, 993.8129460857933, 1010.7263368937839, 1020.4231886976911, 1004.1961984267496, 1045.9574377474294, 885.3814953591041, 28.832082716641434, 352.2396723837334, 1236.4717773859804, 1146.9256756808134, 1037.9964919794788, 79.89856570879773, 1385.3354258539828, 1161.5962214028887, 1270.8830388321223, 1313.098129084979, 10.794280276631554, 316.92374268855394, 190.72262851023166, 849.4940521587386, 572.7446085871906, 545.4784816774635, 894.6196803962214, 1123.9371026518706, 985.7718187780448, 405.26579147890095, 173.64838414163788, 941.6985254494214, 505.54305033558774, 787.1475198082259, 1402.2295185488465, 823.3727893573548, 901.6693857501677, 1040.5312936694359, 1208.7673942015347, 970.6829251184987, 1054.4714519363467, 480.17152601278246, 1046.1073776681699, 1375.6054007931875, 960.4140721202318, 176.696897910596, 1052.332212239468, 810.8451925818922, 196.2147057498813, 714.4670680000929, 1003.1258420695755, 249.870841235092, 1022.5033055179345, 863.7887975940151, 701.9610787776309, 171.80400026898042, 1034.4661757239548, 1216.411439565573, 583.7881146490521, 701.0085732106546, 400.0381686778831, 1022.3570998278364, 385.98514785789513, 1369.1769355319793, 1198.381812733227, 385.5569448150651, 922.1623015848076, 1244.0472305613707, 1012.8428800987714, 162.72557605671125, 553.6452288154918, 1164.3884231123404, 340.1881004233527, 867.6255992327733, 258.355518172795, 354.99298701828866, 736.2378346737719, 1004.7992305680511, 839.7337886354512, 451.7083608577693, 930.6541744501451, 643.7766711444621, 994.1085047546762, 1115.6034930319736, 631.8672743174525, 1053.7976451418012, 845.8320427612732, 478.64840795117726, 300.16015570135903, 1217.76961292611, 5.030346263108996, 966.3675830414295, 272.628904924743, 1138.4889679013327, 845.8242687130924, 688.6561809826625, 911.4325584078658, 909.9401655162005, 1395.4460923743893, 1068.3901596224587, 409.62598799703653, 1035.3495972010599, 1264.1602102200918, 952.8988986691774, 481.0508580346194, 947.2278738536447, 867.908527013628, 309.5160621002022, 575.0476734592273, 1000.3651664474985, 728.6131317006116, 15.027290749485683, 142.7130893683502, 1200.2093249606257, 465.141096304285, 446.9063312797461, 1076.1252735425012, 917.4736541447118, 976.2932562466282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.92384380714012, "mean_inference_ms": 4.552863706315635, "mean_action_processing_ms": 1.6261314217946694, "mean_env_wait_ms": 10.444066960030334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005907893180847168, "StateBufferConnector_ms": 0.004904389381408691, "ViewRequirementAgentConnector_ms": 0.17063093185424805}, "num_episodes": 8, "episode_return_max": 764.5183060872913, "episode_return_min": -9.744421301678223, "episode_return_mean": 203.06767180297862, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.87066878643749, "num_env_steps_trained_throughput_per_sec": 79.87066878643749, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 52326.673, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52326.594, "sample_time_ms": 2854.889, "learn_time_ms": 49444.595, "learn_throughput": 80.899, "synch_weights_time_ms": 19.609}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "35fb9_00000", "date": "2024-08-22_08-35-12", "timestamp": 1724295912, "time_this_iter_s": 50.117252826690674, "time_total_s": 2491.0358810424805, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b5cc700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2491.0358810424805, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 29.453521126760556, "ram_util_percent": 82.1338028169014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.6542172580169, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.53538728870412, "policy_loss": -0.02171592501462708, "vf_loss": 6.554429274009018, "vf_explained_var": 0.5553321753860151, "kl": 0.013369731516848324, "entropy": 0.6601580359317638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.432985473814465, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.063505775714047, "policy_loss": -0.017317421086595723, "vf_loss": 7.0784533755489125, "vf_explained_var": 0.29545201151459305, "kl": 0.011849114369162451, "entropy": 0.5417398873302671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 764.5183060872913, "episode_reward_min": -9.744421301678223, "episode_reward_mean": 199.4940606946011, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.115168772382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 386.37026097683406, "predator_policy": 1531.115168772382}, "policy_reward_mean": {"prey_policy": -686.6971869992994, "predator_policy": 786.4442173466005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [385.50000000000205, 184.76397239799243, 135.69930918801973, 295.9870667343166, 347.4386349600654, 95.6578559228943, 86.64104896191652, 435.87818959966415, 319.0476106528203, 55.5613504913096, 1.2797926827002077, 15.165032730659355, 267.73827984458467, 254.34743595805605, 21.26849273369711, 119.9455028465266, 182.5009787126917, 310.19739004892205, 412.6793324460705, 234.6497883711782, 344.25575292970746, 104.4, 317.20916998559017, 12.142186994335036, 55.79408992920837, 24.295592546096415, 349.22325867655934, 115.20337395014144, 339.9575883929492, 21.611218685156746, 2.0577717006452954, 35.79785493530086, 159.39136462742795, 200.45591612139464, 92.8999999999987, 508.3831606138812, 3.025983883483047, 403.74855543212817, 413.80387510671744, 60.90373155476038, 221.12982941867264, 472.5877757119291, 360.4478373555451, 0.20000000000000284, 45.312614694412886, 194.0169731062483, 764.5183060872913, 78.16019398074657, 216.7893025671043, 265.77624818663804, 89.34718720593014, 18.35690530782118, 282.55532171851297, 16.723262856360257, 151.55335958601634, 71.47388548569235, -5.98605989872218, 70.30454893517793, 556.6857823972879, 89.58467645579115, 197.22949888189171, 452.972692538081, 30.810701197737625, 60.73184258468417, 164.27762358536475, 259.208655571905, -0.14292661601425793, 354.4961138169399, 17.05234978463362, 475.73868718384193, 238.2507007078331, 168.88026727370064, 154.65073616767177, 8.357722348120737, 172.69518275162702, 64.9731098773036, 22.800000000000054, 249.2008644348195, 714.8054360274436, 45.030346263109436, 106.91136985841169, 136.1267671431846, 304.2132100608591, 27.12905853808632, 233.94693209301073, 270.1261663233514, 631.8871286952602, 5.893220215258989, 346.73322902012944, 612.9744693828698, 286.3000000000038, 421.1536563924208, -9.744421301678223, 118.9503671729292, 81.2113623543525, 36.30000000000022, 170.66294219547282, 477.3265814254534, 70.0570741354955, 83.18188886652055], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [32.31224282571532, 292.2198087320103, -315.80247730464396, -1031.5480358879515, -1353.6959339843493, -857.4115750742151, -382.1481680145697, -1006.6175820201198, 241.34967030036222, -566.7564480561216, -884.2869336362664, -1024.8669965439296, -774.7617376983952, -295.45660044477984, -1219.3542159991075, 300.23231377362424, -977.4463484695868, -79.32608313886463, -856.745862192063, -49.481830420681135, -1013.2849095117414, -1256.803208658992, -748.9890353324356, -1370.0209220733282, -13.404692871333165, -444.9628057172229, 21.007605485804625, -719.9644647928307, -1398.7434886954723, -1199.1856805274515, -1287.566950624252, 39.076992799702545, -361.9310049525044, -1037.494376320795, -1102.0950335118541, -203.06953773481774, -1009.7588688051258, 70.10057815908232, 28.40755330942448, -812.0208733843448, -820.816721834842, -1418.2994614337715, -373.3920182821991, -1284.872584519429, -170.25234517356384, -1225.4019801367501, -1197.8072683946637, -845.77056405037, -998.2556305821024, -829.9235177919124, -1003.0430484000626, -1011.4043668138015, 348.46667704978915, -1531.115168772382, -1315.5650237682498, -880.5780027908477, -397.80425667506654, -927.2330514194823, -1310.417344316095, -798.1534259643611, -921.1771192034104, -1439.5174322399334, -1169.7614101133486, -1077.2384550529976, -1003.1786338658816, -193.4878701655286, -234.42610192139585, 32.24617982257271, -892.857532396158, 38.178137663984906, -343.26519342906164, -1089.9916711606925, -763.443769955464, -1055.5908562784562, -792.6644185355984, -834.7365516237483, -464.0866368709083, -1172.263124196551, -0.5295854923891713, -852.7802610285958, -1338.0295113973548, -29.552108953684318, -1199.3853598369367, -512.9490321114231, -1246.6237371082723, 141.8375829010378, -1161.3962214028888, -1270.8830388321223, -1307.998129084979, 29.418334417780954, 13.679687739856842, -327.3090858323892, -1034.2675733444453, 376.54721868580754, -469.3430034367644, -892.5949646561737, -838.0771235094691, -1054.8424953533417, -353.1379274339013, 40.0000000000003, -438.8745083623494, -919.0198802167242, -768.5204875002554, -1402.4996455489925, -420.2720221834187, -1022.2148312055841, -1191.6560407820068, -1040.9193842326042, -950.8200584204124, -922.7809590484117, -390.19128760297895, -1064.61373059228, -1111.6230912566634, -1230.382441555485, -104.88391131567612, -1053.8406498992108, -836.7443769113196, 386.37026097683406, -716.0626967082362, -911.9455369056385, -665.7128309647592, -409.4318169063763, -927.8914557807115, -184.8857280528559, -586.0781041789604, -589.3813706162332, -1185.9107583343311, -553.556953295606, -667.7028096212367, -269.0663086819284, -1010.3683581701196, -138.76523394370716, -1355.5373245360806, -1212.1643503451396, -3.2937686228909087, -949.9293639600415, -1252.1334547099707, -987.7043061655365, 311.9061654122173, -552.5382831005769, -123.24475750010646, -1143.081065327753, -648.7297651380721, -308.3710849937944, -930.5984368348466, -5.981648689539712, -992.8067851591023, -843.3685116962756, -162.91156748888588, -1046.7557850674007, -508.0854212726299, -1064.826644749205, -1112.7034930319728, -611.967274317448, -774.2773730952957, -876.1514503729595, 237.26635690102947, -301.2694845261223, -1217.76961292611, 40.0000000000003, -1023.3699019499218, -108.71521615783917, -1126.8787922595116, -721.307677211728, -366.8072268783317, -929.0683024513369, -876.9252430993074, -1401.331956253194, -1146.567162628531, -97.50205289795554, -1162.3094993278387, -867.0741417699556, 196.8229105611189, -998.8855385696554, -949.4821126412658, -859.7610680107471, -243.02380108932599, -294.8067054499716, -1146.27737721158, 30.273548446340133, -105.7433190651669, 234.3029389473304, -1261.5606820365097, 17.36391716401435, -590.3144329872397, -942.4615931366825, -785.4280534497177, -989.3884897686911, -638.0099149417459, -1179.0013585175618, -945.7125732663287, -244.80585722374508, -608.2754714380354, -926.6662710110038, -77.0141018647871, -1055.5883751425804, -1289.4308162583989, 34.11920890817794, -426.2523339943946, -481.8831891157203], "policy_predator_policy_reward": [38.41940060666482, 22.548547835609792, 500.4664497026371, 1031.6480358879517, 1351.3142721082168, 995.4925461383692, 691.5819285457769, 993.1708882232329, 2.949272212385855, 669.8961405034387, 860.9278770862312, 1143.883909016859, 772.3778989806028, 384.4814881244898, 1219.5542159991073, 135.44587582604, 902.7825637947733, 473.03747846649736, 869.4325254471382, 92.3565176569162, 1014.1958639461942, 1257.1720469072393, 763.8540680630982, 1370.320922073328, 643.9628057172241, 82.14297271591471, 496.26697357791966, 457.0373216871636, 1414.5638011270423, 1204.6338608295785, 670.0453682865807, 698.3900923844964, 581.1723437415639, 1000.754016244436, 1041.4711130786052, 573.890848216985, 933.0062664365649, 419.331356655546, 1018.2631084460999, 0.0, 1232.018682080564, 1351.35325411776, 477.6920182822001, 1284.972584519429, 472.36347669665474, 1240.500018599247, 1193.774622723568, 861.9453967158012, 998.48585474888, 885.4873835543444, 1046.272534299921, 992.4704734600399, 0.7565816267701605, 1531.115168772382, 1355.3161773124057, 956.030223196836, 775.4251947847428, 889.5697017027563, 1310.417344316095, 819.7646446495189, 923.4771192034109, 1439.2752039405789, 1199.9239311393517, 1082.8737889622903, 374.19044799609543, 981.8674206627442, 399.05295557978235, 3.582882640437612, 0.0, 947.5793947321728, 865.6944935938498, 1075.9455316097901, 828.2476640316113, 993.8129460857933, 1010.7263368937839, 1020.4231886976911, 1004.1961984267496, 1045.9574377474294, 885.3814953591041, 28.832082716641434, 352.2396723837334, 1236.4717773859804, 1146.9256756808134, 1037.9964919794788, 79.89856570879773, 1385.3354258539828, 1161.5962214028887, 1270.8830388321223, 1313.098129084979, 10.794280276631554, 316.92374268855394, 190.72262851023166, 849.4940521587386, 572.7446085871906, 545.4784816774635, 894.6196803962214, 1123.9371026518706, 985.7718187780448, 405.26579147890095, 173.64838414163788, 941.6985254494214, 505.54305033558774, 787.1475198082259, 1402.2295185488465, 823.3727893573548, 901.6693857501677, 1040.5312936694359, 1208.7673942015347, 970.6829251184987, 1054.4714519363467, 480.17152601278246, 1046.1073776681699, 1375.6054007931875, 960.4140721202318, 176.696897910596, 1052.332212239468, 810.8451925818922, 196.2147057498813, 714.4670680000929, 1003.1258420695755, 249.870841235092, 1022.5033055179345, 863.7887975940151, 701.9610787776309, 171.80400026898042, 1034.4661757239548, 1216.411439565573, 583.7881146490521, 701.0085732106546, 400.0381686778831, 1022.3570998278364, 385.98514785789513, 1369.1769355319793, 1198.381812733227, 385.5569448150651, 922.1623015848076, 1244.0472305613707, 1012.8428800987714, 162.72557605671125, 553.6452288154918, 1164.3884231123404, 340.1881004233527, 867.6255992327733, 258.355518172795, 354.99298701828866, 736.2378346737719, 1004.7992305680511, 839.7337886354512, 451.7083608577693, 930.6541744501451, 643.7766711444621, 994.1085047546762, 1115.6034930319736, 631.8672743174525, 1053.7976451418012, 845.8320427612732, 478.64840795117726, 300.16015570135903, 1217.76961292611, 5.030346263108996, 966.3675830414295, 272.628904924743, 1138.4889679013327, 845.8242687130924, 688.6561809826625, 911.4325584078658, 909.9401655162005, 1395.4460923743893, 1068.3901596224587, 409.62598799703653, 1035.3495972010599, 1264.1602102200918, 952.8988986691774, 481.0508580346194, 947.2278738536447, 867.908527013628, 309.5160621002022, 575.0476734592273, 1000.3651664474985, 728.6131317006116, 15.027290749485683, 142.7130893683502, 1200.2093249606257, 465.141096304285, 446.9063312797461, 1076.1252735425012, 917.4736541447118, 976.2932562466282, 897.6070588883344, 1000.6155769253234, 950.7125732663287, 276.105857223749, 818.4250155312367, 887.1796691132831, 708.5222036667952, 901.4068547660241, 1289.4308162583989, 35.93786522731754, 192.97600122877276, 798.3414107478663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.935885527345128, "mean_inference_ms": 4.557692760166864, "mean_action_processing_ms": 1.6184345071791515, "mean_env_wait_ms": 10.44307962661287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005927443504333496, "StateBufferConnector_ms": 0.004881858825683594, "ViewRequirementAgentConnector_ms": 0.15935230255126953}, "num_episodes": 6, "episode_return_max": 764.5183060872913, "episode_return_min": -9.744421301678223, "episode_return_mean": 199.4940606946011, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.40146712944986, "num_env_steps_trained_throughput_per_sec": 77.40146712944986, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 52205.084, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52205.004, "sample_time_ms": 2820.203, "learn_time_ms": 49357.922, "learn_throughput": 81.041, "synch_weights_time_ms": 19.363}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "35fb9_00000", "date": "2024-08-22_08-36-04", "timestamp": 1724295964, "time_this_iter_s": 51.73672795295715, "time_total_s": 2542.7726089954376, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcbdaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2542.7726089954376, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 33.37671232876713, "ram_util_percent": 82.5205479452055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.871249586816818, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.467977664331911, "policy_loss": -0.024686140200202034, "vf_loss": 6.489568990878958, "vf_explained_var": 0.6455193625556098, "kl": 0.015474119393164834, "entropy": 0.6683841936172001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.724296264484446, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.57704416103464, "policy_loss": -0.014958856191249594, "vf_loss": 6.590029304242008, "vf_explained_var": 0.3354048932355548, "kl": 0.009868578267254171, "entropy": 0.6063385487548889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 764.5183060872913, "episode_reward_min": -9.744421301678223, "episode_reward_mean": 198.49395667959766, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.115168772382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 386.37026097683406, "predator_policy": 1531.115168772382}, "policy_reward_mean": {"prey_policy": -689.1490449743044, "predator_policy": 788.3960233141037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.6578559228943, 86.64104896191652, 435.87818959966415, 319.0476106528203, 55.5613504913096, 1.2797926827002077, 15.165032730659355, 267.73827984458467, 254.34743595805605, 21.26849273369711, 119.9455028465266, 182.5009787126917, 310.19739004892205, 412.6793324460705, 234.6497883711782, 344.25575292970746, 104.4, 317.20916998559017, 12.142186994335036, 55.79408992920837, 24.295592546096415, 349.22325867655934, 115.20337395014144, 339.9575883929492, 21.611218685156746, 2.0577717006452954, 35.79785493530086, 159.39136462742795, 200.45591612139464, 92.8999999999987, 508.3831606138812, 3.025983883483047, 403.74855543212817, 413.80387510671744, 60.90373155476038, 221.12982941867264, 472.5877757119291, 360.4478373555451, 0.20000000000000284, 45.312614694412886, 194.0169731062483, 764.5183060872913, 78.16019398074657, 216.7893025671043, 265.77624818663804, 89.34718720593014, 18.35690530782118, 282.55532171851297, 16.723262856360257, 151.55335958601634, 71.47388548569235, -5.98605989872218, 70.30454893517793, 556.6857823972879, 89.58467645579115, 197.22949888189171, 452.972692538081, 30.810701197737625, 60.73184258468417, 164.27762358536475, 259.208655571905, -0.14292661601425793, 354.4961138169399, 17.05234978463362, 475.73868718384193, 238.2507007078331, 168.88026727370064, 154.65073616767177, 8.357722348120737, 172.69518275162702, 64.9731098773036, 22.800000000000054, 249.2008644348195, 714.8054360274436, 45.030346263109436, 106.91136985841169, 136.1267671431846, 304.2132100608591, 27.12905853808632, 233.94693209301073, 270.1261663233514, 631.8871286952602, 5.893220215258989, 346.73322902012944, 612.9744693828698, 286.3000000000038, 421.1536563924208, -9.744421301678223, 118.9503671729292, 81.2113623543525, 36.30000000000022, 170.66294219547282, 477.3265814254534, 70.0570741354955, 83.18188886652055, 19.092297314080348, 334.7334584708073, 54.983659285232314, 437.50624052569907, 403.06292618422697], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-884.2869336362664, -1024.8669965439296, -774.7617376983952, -295.45660044477984, -1219.3542159991075, 300.23231377362424, -977.4463484695868, -79.32608313886463, -856.745862192063, -49.481830420681135, -1013.2849095117414, -1256.803208658992, -748.9890353324356, -1370.0209220733282, -13.404692871333165, -444.9628057172229, 21.007605485804625, -719.9644647928307, -1398.7434886954723, -1199.1856805274515, -1287.566950624252, 39.076992799702545, -361.9310049525044, -1037.494376320795, -1102.0950335118541, -203.06953773481774, -1009.7588688051258, 70.10057815908232, 28.40755330942448, -812.0208733843448, -820.816721834842, -1418.2994614337715, -373.3920182821991, -1284.872584519429, -170.25234517356384, -1225.4019801367501, -1197.8072683946637, -845.77056405037, -998.2556305821024, -829.9235177919124, -1003.0430484000626, -1011.4043668138015, 348.46667704978915, -1531.115168772382, -1315.5650237682498, -880.5780027908477, -397.80425667506654, -927.2330514194823, -1310.417344316095, -798.1534259643611, -921.1771192034104, -1439.5174322399334, -1169.7614101133486, -1077.2384550529976, -1003.1786338658816, -193.4878701655286, -234.42610192139585, 32.24617982257271, -892.857532396158, 38.178137663984906, -343.26519342906164, -1089.9916711606925, -763.443769955464, -1055.5908562784562, -792.6644185355984, -834.7365516237483, -464.0866368709083, -1172.263124196551, -0.5295854923891713, -852.7802610285958, -1338.0295113973548, -29.552108953684318, -1199.3853598369367, -512.9490321114231, -1246.6237371082723, 141.8375829010378, -1161.3962214028888, -1270.8830388321223, -1307.998129084979, 29.418334417780954, 13.679687739856842, -327.3090858323892, -1034.2675733444453, 376.54721868580754, -469.3430034367644, -892.5949646561737, -838.0771235094691, -1054.8424953533417, -353.1379274339013, 40.0000000000003, -438.8745083623494, -919.0198802167242, -768.5204875002554, -1402.4996455489925, -420.2720221834187, -1022.2148312055841, -1191.6560407820068, -1040.9193842326042, -950.8200584204124, -922.7809590484117, -390.19128760297895, -1064.61373059228, -1111.6230912566634, -1230.382441555485, -104.88391131567612, -1053.8406498992108, -836.7443769113196, 386.37026097683406, -716.0626967082362, -911.9455369056385, -665.7128309647592, -409.4318169063763, -927.8914557807115, -184.8857280528559, -586.0781041789604, -589.3813706162332, -1185.9107583343311, -553.556953295606, -667.7028096212367, -269.0663086819284, -1010.3683581701196, -138.76523394370716, -1355.5373245360806, -1212.1643503451396, -3.2937686228909087, -949.9293639600415, -1252.1334547099707, -987.7043061655365, 311.9061654122173, -552.5382831005769, -123.24475750010646, -1143.081065327753, -648.7297651380721, -308.3710849937944, -930.5984368348466, -5.981648689539712, -992.8067851591023, -843.3685116962756, -162.91156748888588, -1046.7557850674007, -508.0854212726299, -1064.826644749205, -1112.7034930319728, -611.967274317448, -774.2773730952957, -876.1514503729595, 237.26635690102947, -301.2694845261223, -1217.76961292611, 40.0000000000003, -1023.3699019499218, -108.71521615783917, -1126.8787922595116, -721.307677211728, -366.8072268783317, -929.0683024513369, -876.9252430993074, -1401.331956253194, -1146.567162628531, -97.50205289795554, -1162.3094993278387, -867.0741417699556, 196.8229105611189, -998.8855385696554, -949.4821126412658, -859.7610680107471, -243.02380108932599, -294.8067054499716, -1146.27737721158, 30.273548446340133, -105.7433190651669, 234.3029389473304, -1261.5606820365097, 17.36391716401435, -590.3144329872397, -942.4615931366825, -785.4280534497177, -989.3884897686911, -638.0099149417459, -1179.0013585175618, -945.7125732663287, -244.80585722374508, -608.2754714380354, -926.6662710110038, -77.0141018647871, -1055.5883751425804, -1289.4308162583989, 34.11920890817794, -426.2523339943946, -481.8831891157203, -713.9759692852524, -1175.3999003794936, -614.1290764778548, -169.3144722192811, -695.4085296670885, -36.24598561098494, -1094.7428234025222, -222.90735731802266, 277.85721410764523, -994.203193232017], "policy_predator_policy_reward": [860.9278770862312, 1143.883909016859, 772.3778989806028, 384.4814881244898, 1219.5542159991073, 135.44587582604, 902.7825637947733, 473.03747846649736, 869.4325254471382, 92.3565176569162, 1014.1958639461942, 1257.1720469072393, 763.8540680630982, 1370.320922073328, 643.9628057172241, 82.14297271591471, 496.26697357791966, 457.0373216871636, 1414.5638011270423, 1204.6338608295785, 670.0453682865807, 698.3900923844964, 581.1723437415639, 1000.754016244436, 1041.4711130786052, 573.890848216985, 933.0062664365649, 419.331356655546, 1018.2631084460999, 0.0, 1232.018682080564, 1351.35325411776, 477.6920182822001, 1284.972584519429, 472.36347669665474, 1240.500018599247, 1193.774622723568, 861.9453967158012, 998.48585474888, 885.4873835543444, 1046.272534299921, 992.4704734600399, 0.7565816267701605, 1531.115168772382, 1355.3161773124057, 956.030223196836, 775.4251947847428, 889.5697017027563, 1310.417344316095, 819.7646446495189, 923.4771192034109, 1439.2752039405789, 1199.9239311393517, 1082.8737889622903, 374.19044799609543, 981.8674206627442, 399.05295557978235, 3.582882640437612, 0.0, 947.5793947321728, 865.6944935938498, 1075.9455316097901, 828.2476640316113, 993.8129460857933, 1010.7263368937839, 1020.4231886976911, 1004.1961984267496, 1045.9574377474294, 885.3814953591041, 28.832082716641434, 352.2396723837334, 1236.4717773859804, 1146.9256756808134, 1037.9964919794788, 79.89856570879773, 1385.3354258539828, 1161.5962214028887, 1270.8830388321223, 1313.098129084979, 10.794280276631554, 316.92374268855394, 190.72262851023166, 849.4940521587386, 572.7446085871906, 545.4784816774635, 894.6196803962214, 1123.9371026518706, 985.7718187780448, 405.26579147890095, 173.64838414163788, 941.6985254494214, 505.54305033558774, 787.1475198082259, 1402.2295185488465, 823.3727893573548, 901.6693857501677, 1040.5312936694359, 1208.7673942015347, 970.6829251184987, 1054.4714519363467, 480.17152601278246, 1046.1073776681699, 1375.6054007931875, 960.4140721202318, 176.696897910596, 1052.332212239468, 810.8451925818922, 196.2147057498813, 714.4670680000929, 1003.1258420695755, 249.870841235092, 1022.5033055179345, 863.7887975940151, 701.9610787776309, 171.80400026898042, 1034.4661757239548, 1216.411439565573, 583.7881146490521, 701.0085732106546, 400.0381686778831, 1022.3570998278364, 385.98514785789513, 1369.1769355319793, 1198.381812733227, 385.5569448150651, 922.1623015848076, 1244.0472305613707, 1012.8428800987714, 162.72557605671125, 553.6452288154918, 1164.3884231123404, 340.1881004233527, 867.6255992327733, 258.355518172795, 354.99298701828866, 736.2378346737719, 1004.7992305680511, 839.7337886354512, 451.7083608577693, 930.6541744501451, 643.7766711444621, 994.1085047546762, 1115.6034930319736, 631.8672743174525, 1053.7976451418012, 845.8320427612732, 478.64840795117726, 300.16015570135903, 1217.76961292611, 5.030346263108996, 966.3675830414295, 272.628904924743, 1138.4889679013327, 845.8242687130924, 688.6561809826625, 911.4325584078658, 909.9401655162005, 1395.4460923743893, 1068.3901596224587, 409.62598799703653, 1035.3495972010599, 1264.1602102200918, 952.8988986691774, 481.0508580346194, 947.2278738536447, 867.908527013628, 309.5160621002022, 575.0476734592273, 1000.3651664474985, 728.6131317006116, 15.027290749485683, 142.7130893683502, 1200.2093249606257, 465.141096304285, 446.9063312797461, 1076.1252735425012, 917.4736541447118, 976.2932562466282, 897.6070588883344, 1000.6155769253234, 950.7125732663287, 276.105857223749, 818.4250155312367, 887.1796691132831, 708.5222036667952, 901.4068547660241, 1289.4308162583989, 35.93786522731754, 192.97600122877276, 798.3414107478663, 909.1127925364445, 999.3553744423865, 551.7840898160638, 566.3929173518746, 678.6600252044362, 107.97814935887025, 984.8435909459012, 770.3128303003396, 156.28677582695755, 963.122129481641]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.944241678941057, "mean_inference_ms": 4.548179777409271, "mean_action_processing_ms": 1.617370749659411, "mean_env_wait_ms": 10.440298794806562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005974292755126953, "StateBufferConnector_ms": 0.0048029422760009766, "ViewRequirementAgentConnector_ms": 0.14770269393920898}, "num_episodes": 5, "episode_return_max": 764.5183060872913, "episode_return_min": -9.744421301678223, "episode_return_mean": 198.49395667959766, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.40624815449122, "num_env_steps_trained_throughput_per_sec": 77.40624815449122, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 52113.865, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52113.801, "sample_time_ms": 2702.256, "learn_time_ms": 49385.52, "learn_throughput": 80.995, "synch_weights_time_ms": 18.702}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "35fb9_00000", "date": "2024-08-22_08-36-56", "timestamp": 1724296016, "time_this_iter_s": 51.71072196960449, "time_total_s": 2594.483330965042, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0f73940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2594.483330965042, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 35.11081081081081, "ram_util_percent": 81.82702702702703}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.98711518389838, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.3174565373274385, "policy_loss": -0.023819246037774498, "vf_loss": 6.338384248087646, "vf_explained_var": 0.6078942390030654, "kl": 0.014457672922231414, "entropy": 0.7022267525158231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.873767051368795, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.394330116554543, "policy_loss": -0.017010792034983676, "vf_loss": 6.408599005300532, "vf_explained_var": 0.34673266536975034, "kl": 0.01370943261312922, "entropy": 0.6405006968155109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 764.5183060872913, "episode_reward_min": -74.9259714294466, "episode_reward_mean": 201.5036494441536, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.115168772382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 386.37026097683406, "predator_policy": 1531.115168772382}, "policy_reward_mean": {"prey_policy": -656.232377016446, "predator_policy": 756.9842017385234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [119.9455028465266, 182.5009787126917, 310.19739004892205, 412.6793324460705, 234.6497883711782, 344.25575292970746, 104.4, 317.20916998559017, 12.142186994335036, 55.79408992920837, 24.295592546096415, 349.22325867655934, 115.20337395014144, 339.9575883929492, 21.611218685156746, 2.0577717006452954, 35.79785493530086, 159.39136462742795, 200.45591612139464, 92.8999999999987, 508.3831606138812, 3.025983883483047, 403.74855543212817, 413.80387510671744, 60.90373155476038, 221.12982941867264, 472.5877757119291, 360.4478373555451, 0.20000000000000284, 45.312614694412886, 194.0169731062483, 764.5183060872913, 78.16019398074657, 216.7893025671043, 265.77624818663804, 89.34718720593014, 18.35690530782118, 282.55532171851297, 16.723262856360257, 151.55335958601634, 71.47388548569235, -5.98605989872218, 70.30454893517793, 556.6857823972879, 89.58467645579115, 197.22949888189171, 452.972692538081, 30.810701197737625, 60.73184258468417, 164.27762358536475, 259.208655571905, -0.14292661601425793, 354.4961138169399, 17.05234978463362, 475.73868718384193, 238.2507007078331, 168.88026727370064, 154.65073616767177, 8.357722348120737, 172.69518275162702, 64.9731098773036, 22.800000000000054, 249.2008644348195, 714.8054360274436, 45.030346263109436, 106.91136985841169, 136.1267671431846, 304.2132100608591, 27.12905853808632, 233.94693209301073, 270.1261663233514, 631.8871286952602, 5.893220215258989, 346.73322902012944, 612.9744693828698, 286.3000000000038, 421.1536563924208, -9.744421301678223, 118.9503671729292, 81.2113623543525, 36.30000000000022, 170.66294219547282, 477.3265814254534, 70.0570741354955, 83.18188886652055, 19.092297314080348, 334.7334584708073, 54.983659285232314, 437.50624052569907, 403.06292618422697, 6.439218785909347, 77.21047540648304, 414.66276496470067, 200.8050182075983, 263.6207359994834, -74.9259714294466, 180.65008653876833, 287.37745408316965, 95.58377744954092, 402.1308060276948], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1287.566950624252, 39.076992799702545, -361.9310049525044, -1037.494376320795, -1102.0950335118541, -203.06953773481774, -1009.7588688051258, 70.10057815908232, 28.40755330942448, -812.0208733843448, -820.816721834842, -1418.2994614337715, -373.3920182821991, -1284.872584519429, -170.25234517356384, -1225.4019801367501, -1197.8072683946637, -845.77056405037, -998.2556305821024, -829.9235177919124, -1003.0430484000626, -1011.4043668138015, 348.46667704978915, -1531.115168772382, -1315.5650237682498, -880.5780027908477, -397.80425667506654, -927.2330514194823, -1310.417344316095, -798.1534259643611, -921.1771192034104, -1439.5174322399334, -1169.7614101133486, -1077.2384550529976, -1003.1786338658816, -193.4878701655286, -234.42610192139585, 32.24617982257271, -892.857532396158, 38.178137663984906, -343.26519342906164, -1089.9916711606925, -763.443769955464, -1055.5908562784562, -792.6644185355984, -834.7365516237483, -464.0866368709083, -1172.263124196551, -0.5295854923891713, -852.7802610285958, -1338.0295113973548, -29.552108953684318, -1199.3853598369367, -512.9490321114231, -1246.6237371082723, 141.8375829010378, -1161.3962214028888, -1270.8830388321223, -1307.998129084979, 29.418334417780954, 13.679687739856842, -327.3090858323892, -1034.2675733444453, 376.54721868580754, -469.3430034367644, -892.5949646561737, -838.0771235094691, -1054.8424953533417, -353.1379274339013, 40.0000000000003, -438.8745083623494, -919.0198802167242, -768.5204875002554, -1402.4996455489925, -420.2720221834187, -1022.2148312055841, -1191.6560407820068, -1040.9193842326042, -950.8200584204124, -922.7809590484117, -390.19128760297895, -1064.61373059228, -1111.6230912566634, -1230.382441555485, -104.88391131567612, -1053.8406498992108, -836.7443769113196, 386.37026097683406, -716.0626967082362, -911.9455369056385, -665.7128309647592, -409.4318169063763, -927.8914557807115, -184.8857280528559, -586.0781041789604, -589.3813706162332, -1185.9107583343311, -553.556953295606, -667.7028096212367, -269.0663086819284, -1010.3683581701196, -138.76523394370716, -1355.5373245360806, -1212.1643503451396, -3.2937686228909087, -949.9293639600415, -1252.1334547099707, -987.7043061655365, 311.9061654122173, -552.5382831005769, -123.24475750010646, -1143.081065327753, -648.7297651380721, -308.3710849937944, -930.5984368348466, -5.981648689539712, -992.8067851591023, -843.3685116962756, -162.91156748888588, -1046.7557850674007, -508.0854212726299, -1064.826644749205, -1112.7034930319728, -611.967274317448, -774.2773730952957, -876.1514503729595, 237.26635690102947, -301.2694845261223, -1217.76961292611, 40.0000000000003, -1023.3699019499218, -108.71521615783917, -1126.8787922595116, -721.307677211728, -366.8072268783317, -929.0683024513369, -876.9252430993074, -1401.331956253194, -1146.567162628531, -97.50205289795554, -1162.3094993278387, -867.0741417699556, 196.8229105611189, -998.8855385696554, -949.4821126412658, -859.7610680107471, -243.02380108932599, -294.8067054499716, -1146.27737721158, 30.273548446340133, -105.7433190651669, 234.3029389473304, -1261.5606820365097, 17.36391716401435, -590.3144329872397, -942.4615931366825, -785.4280534497177, -989.3884897686911, -638.0099149417459, -1179.0013585175618, -945.7125732663287, -244.80585722374508, -608.2754714380354, -926.6662710110038, -77.0141018647871, -1055.5883751425804, -1289.4308162583989, 34.11920890817794, -426.2523339943946, -481.8831891157203, -713.9759692852524, -1175.3999003794936, -614.1290764778548, -169.3144722192811, -695.4085296670885, -36.24598561098494, -1094.7428234025222, -222.90735731802266, 277.85721410764523, -994.203193232017, -612.3274634529313, -785.9774581575616, -544.725299416091, -248.16062143677405, -603.18566935651, 140.65655861462784, -386.1670448955635, 27.69092523530989, -1003.4806598264222, -140.30789943842512, -616.9209238135539, -796.3149529763323, -545.1355472025641, 32.90849543296736, -456.37160528652475, -371.5995245654865, -223.76169051069425, -218.46462666978024, 384.5825037617225, -455.4498019327936], "policy_predator_policy_reward": [670.0453682865807, 698.3900923844964, 581.1723437415639, 1000.754016244436, 1041.4711130786052, 573.890848216985, 933.0062664365649, 419.331356655546, 1018.2631084460999, 0.0, 1232.018682080564, 1351.35325411776, 477.6920182822001, 1284.972584519429, 472.36347669665474, 1240.500018599247, 1193.774622723568, 861.9453967158012, 998.48585474888, 885.4873835543444, 1046.272534299921, 992.4704734600399, 0.7565816267701605, 1531.115168772382, 1355.3161773124057, 956.030223196836, 775.4251947847428, 889.5697017027563, 1310.417344316095, 819.7646446495189, 923.4771192034109, 1439.2752039405789, 1199.9239311393517, 1082.8737889622903, 374.19044799609543, 981.8674206627442, 399.05295557978235, 3.582882640437612, 0.0, 947.5793947321728, 865.6944935938498, 1075.9455316097901, 828.2476640316113, 993.8129460857933, 1010.7263368937839, 1020.4231886976911, 1004.1961984267496, 1045.9574377474294, 885.3814953591041, 28.832082716641434, 352.2396723837334, 1236.4717773859804, 1146.9256756808134, 1037.9964919794788, 79.89856570879773, 1385.3354258539828, 1161.5962214028887, 1270.8830388321223, 1313.098129084979, 10.794280276631554, 316.92374268855394, 190.72262851023166, 849.4940521587386, 572.7446085871906, 545.4784816774635, 894.6196803962214, 1123.9371026518706, 985.7718187780448, 405.26579147890095, 173.64838414163788, 941.6985254494214, 505.54305033558774, 787.1475198082259, 1402.2295185488465, 823.3727893573548, 901.6693857501677, 1040.5312936694359, 1208.7673942015347, 970.6829251184987, 1054.4714519363467, 480.17152601278246, 1046.1073776681699, 1375.6054007931875, 960.4140721202318, 176.696897910596, 1052.332212239468, 810.8451925818922, 196.2147057498813, 714.4670680000929, 1003.1258420695755, 249.870841235092, 1022.5033055179345, 863.7887975940151, 701.9610787776309, 171.80400026898042, 1034.4661757239548, 1216.411439565573, 583.7881146490521, 701.0085732106546, 400.0381686778831, 1022.3570998278364, 385.98514785789513, 1369.1769355319793, 1198.381812733227, 385.5569448150651, 922.1623015848076, 1244.0472305613707, 1012.8428800987714, 162.72557605671125, 553.6452288154918, 1164.3884231123404, 340.1881004233527, 867.6255992327733, 258.355518172795, 354.99298701828866, 736.2378346737719, 1004.7992305680511, 839.7337886354512, 451.7083608577693, 930.6541744501451, 643.7766711444621, 994.1085047546762, 1115.6034930319736, 631.8672743174525, 1053.7976451418012, 845.8320427612732, 478.64840795117726, 300.16015570135903, 1217.76961292611, 5.030346263108996, 966.3675830414295, 272.628904924743, 1138.4889679013327, 845.8242687130924, 688.6561809826625, 911.4325584078658, 909.9401655162005, 1395.4460923743893, 1068.3901596224587, 409.62598799703653, 1035.3495972010599, 1264.1602102200918, 952.8988986691774, 481.0508580346194, 947.2278738536447, 867.908527013628, 309.5160621002022, 575.0476734592273, 1000.3651664474985, 728.6131317006116, 15.027290749485683, 142.7130893683502, 1200.2093249606257, 465.141096304285, 446.9063312797461, 1076.1252735425012, 917.4736541447118, 976.2932562466282, 897.6070588883344, 1000.6155769253234, 950.7125732663287, 276.105857223749, 818.4250155312367, 887.1796691132831, 708.5222036667952, 901.4068547660241, 1289.4308162583989, 35.93786522731754, 192.97600122877276, 798.3414107478663, 909.1127925364445, 999.3553744423865, 551.7840898160638, 566.3929173518746, 678.6600252044362, 107.97814935887025, 984.8435909459012, 770.3128303003396, 156.28677582695755, 963.122129481641, 802.1599396083964, 602.5842007880093, 562.640278258001, 307.4561180013503, 210.81862635778376, 666.3732493487996, 392.64313893103645, 166.63799893682398, 919.2373480859133, 488.1719471784144, 523.7114979326362, 814.5984074278059, 33.985828197824866, 658.891310110541, 655.5877487040952, 459.7608352310868, 240.01945334388296, 297.7906412861313, 0.8483022659694665, 472.1498019327971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9251791232796895, "mean_inference_ms": 4.527413084195304, "mean_action_processing_ms": 1.626703530880177, "mean_env_wait_ms": 10.445282971158116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005907177925109863, "StateBufferConnector_ms": 0.004760026931762695, "ViewRequirementAgentConnector_ms": 0.14822041988372803}, "num_episodes": 10, "episode_return_max": 764.5183060872913, "episode_return_min": -74.9259714294466, "episode_return_mean": 201.5036494441536, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.1360938579754, "num_env_steps_trained_throughput_per_sec": 80.1360938579754, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 51903.586, "restore_workers_time_ms": 0.015, "training_step_time_ms": 51903.498, "sample_time_ms": 2638.823, "learn_time_ms": 49238.36, "learn_throughput": 81.237, "synch_weights_time_ms": 19.041}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "35fb9_00000", "date": "2024-08-22_08-37-46", "timestamp": 1724296066, "time_this_iter_s": 49.955771923065186, "time_total_s": 2644.4391028881073, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcdad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2644.4391028881073, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 29.32676056338028, "ram_util_percent": 81.77746478873239}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.785980708510788, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.672288224810646, "policy_loss": -0.018725625267276964, "vf_loss": 6.688004709930016, "vf_explained_var": 0.5658021832584704, "kl": 0.01504571246963842, "entropy": 0.6841523047792848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.94880327465673, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.356133082808641, "policy_loss": -0.016288445292227956, "vf_loss": 6.36994486511069, "vf_explained_var": 0.365106779400003, "kl": 0.012383327259381533, "entropy": 0.6221485448577416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 764.5183060872913, "episode_reward_min": -74.9259714294466, "episode_reward_mean": 190.83477371142556, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.115168772382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 386.37026097683406, "predator_policy": 1531.115168772382}, "policy_reward_mean": {"prey_policy": -638.2901790484465, "predator_policy": 733.7075659041599}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.295592546096415, 349.22325867655934, 115.20337395014144, 339.9575883929492, 21.611218685156746, 2.0577717006452954, 35.79785493530086, 159.39136462742795, 200.45591612139464, 92.8999999999987, 508.3831606138812, 3.025983883483047, 403.74855543212817, 413.80387510671744, 60.90373155476038, 221.12982941867264, 472.5877757119291, 360.4478373555451, 0.20000000000000284, 45.312614694412886, 194.0169731062483, 764.5183060872913, 78.16019398074657, 216.7893025671043, 265.77624818663804, 89.34718720593014, 18.35690530782118, 282.55532171851297, 16.723262856360257, 151.55335958601634, 71.47388548569235, -5.98605989872218, 70.30454893517793, 556.6857823972879, 89.58467645579115, 197.22949888189171, 452.972692538081, 30.810701197737625, 60.73184258468417, 164.27762358536475, 259.208655571905, -0.14292661601425793, 354.4961138169399, 17.05234978463362, 475.73868718384193, 238.2507007078331, 168.88026727370064, 154.65073616767177, 8.357722348120737, 172.69518275162702, 64.9731098773036, 22.800000000000054, 249.2008644348195, 714.8054360274436, 45.030346263109436, 106.91136985841169, 136.1267671431846, 304.2132100608591, 27.12905853808632, 233.94693209301073, 270.1261663233514, 631.8871286952602, 5.893220215258989, 346.73322902012944, 612.9744693828698, 286.3000000000038, 421.1536563924208, -9.744421301678223, 118.9503671729292, 81.2113623543525, 36.30000000000022, 170.66294219547282, 477.3265814254534, 70.0570741354955, 83.18188886652055, 19.092297314080348, 334.7334584708073, 54.983659285232314, 437.50624052569907, 403.06292618422697, 6.439218785909347, 77.21047540648304, 414.66276496470067, 200.8050182075983, 263.6207359994834, -74.9259714294466, 180.65008653876833, 287.37745408316965, 95.58377744954092, 402.1308060276948, 10.88573200053634, 238.27512382235275, 107.769242886139, 74.50381152020552, 230.59328937180305, 143.52822974390767, -2.4891760162368755, 63.84496422043412, 145.11309323661234, 14.862308205661186], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1003.0430484000626, -1011.4043668138015, 348.46667704978915, -1531.115168772382, -1315.5650237682498, -880.5780027908477, -397.80425667506654, -927.2330514194823, -1310.417344316095, -798.1534259643611, -921.1771192034104, -1439.5174322399334, -1169.7614101133486, -1077.2384550529976, -1003.1786338658816, -193.4878701655286, -234.42610192139585, 32.24617982257271, -892.857532396158, 38.178137663984906, -343.26519342906164, -1089.9916711606925, -763.443769955464, -1055.5908562784562, -792.6644185355984, -834.7365516237483, -464.0866368709083, -1172.263124196551, -0.5295854923891713, -852.7802610285958, -1338.0295113973548, -29.552108953684318, -1199.3853598369367, -512.9490321114231, -1246.6237371082723, 141.8375829010378, -1161.3962214028888, -1270.8830388321223, -1307.998129084979, 29.418334417780954, 13.679687739856842, -327.3090858323892, -1034.2675733444453, 376.54721868580754, -469.3430034367644, -892.5949646561737, -838.0771235094691, -1054.8424953533417, -353.1379274339013, 40.0000000000003, -438.8745083623494, -919.0198802167242, -768.5204875002554, -1402.4996455489925, -420.2720221834187, -1022.2148312055841, -1191.6560407820068, -1040.9193842326042, -950.8200584204124, -922.7809590484117, -390.19128760297895, -1064.61373059228, -1111.6230912566634, -1230.382441555485, -104.88391131567612, -1053.8406498992108, -836.7443769113196, 386.37026097683406, -716.0626967082362, -911.9455369056385, -665.7128309647592, -409.4318169063763, -927.8914557807115, -184.8857280528559, -586.0781041789604, -589.3813706162332, -1185.9107583343311, -553.556953295606, -667.7028096212367, -269.0663086819284, -1010.3683581701196, -138.76523394370716, -1355.5373245360806, -1212.1643503451396, -3.2937686228909087, -949.9293639600415, -1252.1334547099707, -987.7043061655365, 311.9061654122173, -552.5382831005769, -123.24475750010646, -1143.081065327753, -648.7297651380721, -308.3710849937944, -930.5984368348466, -5.981648689539712, -992.8067851591023, -843.3685116962756, -162.91156748888588, -1046.7557850674007, -508.0854212726299, -1064.826644749205, -1112.7034930319728, -611.967274317448, -774.2773730952957, -876.1514503729595, 237.26635690102947, -301.2694845261223, -1217.76961292611, 40.0000000000003, -1023.3699019499218, -108.71521615783917, -1126.8787922595116, -721.307677211728, -366.8072268783317, -929.0683024513369, -876.9252430993074, -1401.331956253194, -1146.567162628531, -97.50205289795554, -1162.3094993278387, -867.0741417699556, 196.8229105611189, -998.8855385696554, -949.4821126412658, -859.7610680107471, -243.02380108932599, -294.8067054499716, -1146.27737721158, 30.273548446340133, -105.7433190651669, 234.3029389473304, -1261.5606820365097, 17.36391716401435, -590.3144329872397, -942.4615931366825, -785.4280534497177, -989.3884897686911, -638.0099149417459, -1179.0013585175618, -945.7125732663287, -244.80585722374508, -608.2754714380354, -926.6662710110038, -77.0141018647871, -1055.5883751425804, -1289.4308162583989, 34.11920890817794, -426.2523339943946, -481.8831891157203, -713.9759692852524, -1175.3999003794936, -614.1290764778548, -169.3144722192811, -695.4085296670885, -36.24598561098494, -1094.7428234025222, -222.90735731802266, 277.85721410764523, -994.203193232017, -612.3274634529313, -785.9774581575616, -544.725299416091, -248.16062143677405, -603.18566935651, 140.65655861462784, -386.1670448955635, 27.69092523530989, -1003.4806598264222, -140.30789943842512, -616.9209238135539, -796.3149529763323, -545.1355472025641, 32.90849543296736, -456.37160528652475, -371.5995245654865, -223.76169051069425, -218.46462666978024, 384.5825037617225, -455.4498019327936, -782.8638258441715, -793.8143007939683, -483.790623765417, -1408.861358090592, -154.9395705626469, -542.4225345167971, -531.2762172355294, -614.9584611490643, -751.1146148641301, -543.1134090330861, -113.03127238701634, -538.7909495882844, -881.2917929508606, -669.551988267837, -675.6575747860553, 27.073017717903088, -472.22587123693563, -415.89166604804063, -30.591940310001696, -875.5890659526416], "policy_predator_policy_reward": [1046.272534299921, 992.4704734600399, 0.7565816267701605, 1531.115168772382, 1355.3161773124057, 956.030223196836, 775.4251947847428, 889.5697017027563, 1310.417344316095, 819.7646446495189, 923.4771192034109, 1439.2752039405789, 1199.9239311393517, 1082.8737889622903, 374.19044799609543, 981.8674206627442, 399.05295557978235, 3.582882640437612, 0.0, 947.5793947321728, 865.6944935938498, 1075.9455316097901, 828.2476640316113, 993.8129460857933, 1010.7263368937839, 1020.4231886976911, 1004.1961984267496, 1045.9574377474294, 885.3814953591041, 28.832082716641434, 352.2396723837334, 1236.4717773859804, 1146.9256756808134, 1037.9964919794788, 79.89856570879773, 1385.3354258539828, 1161.5962214028887, 1270.8830388321223, 1313.098129084979, 10.794280276631554, 316.92374268855394, 190.72262851023166, 849.4940521587386, 572.7446085871906, 545.4784816774635, 894.6196803962214, 1123.9371026518706, 985.7718187780448, 405.26579147890095, 173.64838414163788, 941.6985254494214, 505.54305033558774, 787.1475198082259, 1402.2295185488465, 823.3727893573548, 901.6693857501677, 1040.5312936694359, 1208.7673942015347, 970.6829251184987, 1054.4714519363467, 480.17152601278246, 1046.1073776681699, 1375.6054007931875, 960.4140721202318, 176.696897910596, 1052.332212239468, 810.8451925818922, 196.2147057498813, 714.4670680000929, 1003.1258420695755, 249.870841235092, 1022.5033055179345, 863.7887975940151, 701.9610787776309, 171.80400026898042, 1034.4661757239548, 1216.411439565573, 583.7881146490521, 701.0085732106546, 400.0381686778831, 1022.3570998278364, 385.98514785789513, 1369.1769355319793, 1198.381812733227, 385.5569448150651, 922.1623015848076, 1244.0472305613707, 1012.8428800987714, 162.72557605671125, 553.6452288154918, 1164.3884231123404, 340.1881004233527, 867.6255992327733, 258.355518172795, 354.99298701828866, 736.2378346737719, 1004.7992305680511, 839.7337886354512, 451.7083608577693, 930.6541744501451, 643.7766711444621, 994.1085047546762, 1115.6034930319736, 631.8672743174525, 1053.7976451418012, 845.8320427612732, 478.64840795117726, 300.16015570135903, 1217.76961292611, 5.030346263108996, 966.3675830414295, 272.628904924743, 1138.4889679013327, 845.8242687130924, 688.6561809826625, 911.4325584078658, 909.9401655162005, 1395.4460923743893, 1068.3901596224587, 409.62598799703653, 1035.3495972010599, 1264.1602102200918, 952.8988986691774, 481.0508580346194, 947.2278738536447, 867.908527013628, 309.5160621002022, 575.0476734592273, 1000.3651664474985, 728.6131317006116, 15.027290749485683, 142.7130893683502, 1200.2093249606257, 465.141096304285, 446.9063312797461, 1076.1252735425012, 917.4736541447118, 976.2932562466282, 897.6070588883344, 1000.6155769253234, 950.7125732663287, 276.105857223749, 818.4250155312367, 887.1796691132831, 708.5222036667952, 901.4068547660241, 1289.4308162583989, 35.93786522731754, 192.97600122877276, 798.3414107478663, 909.1127925364445, 999.3553744423865, 551.7840898160638, 566.3929173518746, 678.6600252044362, 107.97814935887025, 984.8435909459012, 770.3128303003396, 156.28677582695755, 963.122129481641, 802.1599396083964, 602.5842007880093, 562.640278258001, 307.4561180013503, 210.81862635778376, 666.3732493487996, 392.64313893103645, 166.63799893682398, 919.2373480859133, 488.1719471784144, 523.7114979326362, 814.5984074278059, 33.985828197824866, 658.891310110541, 655.5877487040952, 459.7608352310868, 240.01945334388296, 297.7906412861313, 0.8483022659694665, 472.1498019327971, 886.3992320250835, 701.1646266135936, 1307.3853921324555, 823.5417135459127, 61.634709770042875, 743.4966381955413, 703.0665814551104, 517.6719084496925, 973.7036655410006, 551.117647728026, 292.84061111626033, 502.5098406029496, 930.8975348485955, 617.4570703538702, 695.4575747860573, 16.971946502530752, 636.0340230273126, 397.19660749427965, 37.81962727005034, 883.2236871982542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.93333161326341, "mean_inference_ms": 4.51606734745892, "mean_action_processing_ms": 1.6131038003121887, "mean_env_wait_ms": 10.449182571544878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005718350410461426, "StateBufferConnector_ms": 0.0045882463455200195, "ViewRequirementAgentConnector_ms": 0.15451955795288086}, "num_episodes": 10, "episode_return_max": 764.5183060872913, "episode_return_min": -74.9259714294466, "episode_return_mean": 190.83477371142556, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.72528437757333, "num_env_steps_trained_throughput_per_sec": 79.72528437757333, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 51413.812, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51413.714, "sample_time_ms": 2624.241, "learn_time_ms": 48765.547, "learn_throughput": 82.025, "synch_weights_time_ms": 16.828}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "35fb9_00000", "date": "2024-08-22_08-38-36", "timestamp": 1724296116, "time_this_iter_s": 50.230947971343994, "time_total_s": 2694.6700508594513, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b630d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2694.6700508594513, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 30.79295774647887, "ram_util_percent": 81.4211267605634}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.857953716018212, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.051201564798911, "policy_loss": -0.02459622503618005, "vf_loss": 7.072391197921107, "vf_explained_var": 0.5913173218252797, "kl": 0.01703294254050999, "entropy": 0.7146452095458117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.566992513527946, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.834634332555942, "policy_loss": -0.019085351530851787, "vf_loss": 6.851096036699083, "vf_explained_var": 0.38952353385390426, "kl": 0.0131182999961157, "entropy": 0.5732533181628222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 764.5183060872913, "episode_reward_min": -74.9259714294466, "episode_reward_mean": 198.16212240292927, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1408.861358090592, "predator_policy": 0.8483022659694665}, "policy_reward_max": {"prey_policy": 386.37026097683406, "predator_policy": 1402.2295185488465}, "policy_reward_mean": {"prey_policy": -595.9023204870489, "predator_policy": 694.9833816885141}, "custom_metrics": {}, "hist_stats": {"episode_reward": [403.74855543212817, 413.80387510671744, 60.90373155476038, 221.12982941867264, 472.5877757119291, 360.4478373555451, 0.20000000000000284, 45.312614694412886, 194.0169731062483, 764.5183060872913, 78.16019398074657, 216.7893025671043, 265.77624818663804, 89.34718720593014, 18.35690530782118, 282.55532171851297, 16.723262856360257, 151.55335958601634, 71.47388548569235, -5.98605989872218, 70.30454893517793, 556.6857823972879, 89.58467645579115, 197.22949888189171, 452.972692538081, 30.810701197737625, 60.73184258468417, 164.27762358536475, 259.208655571905, -0.14292661601425793, 354.4961138169399, 17.05234978463362, 475.73868718384193, 238.2507007078331, 168.88026727370064, 154.65073616767177, 8.357722348120737, 172.69518275162702, 64.9731098773036, 22.800000000000054, 249.2008644348195, 714.8054360274436, 45.030346263109436, 106.91136985841169, 136.1267671431846, 304.2132100608591, 27.12905853808632, 233.94693209301073, 270.1261663233514, 631.8871286952602, 5.893220215258989, 346.73322902012944, 612.9744693828698, 286.3000000000038, 421.1536563924208, -9.744421301678223, 118.9503671729292, 81.2113623543525, 36.30000000000022, 170.66294219547282, 477.3265814254534, 70.0570741354955, 83.18188886652055, 19.092297314080348, 334.7334584708073, 54.983659285232314, 437.50624052569907, 403.06292618422697, 6.439218785909347, 77.21047540648304, 414.66276496470067, 200.8050182075983, 263.6207359994834, -74.9259714294466, 180.65008653876833, 287.37745408316965, 95.58377744954092, 402.1308060276948, 10.88573200053634, 238.27512382235275, 107.769242886139, 74.50381152020552, 230.59328937180305, 143.52822974390767, -2.4891760162368755, 63.84496422043412, 145.11309323661234, 14.862308205661186, 75.6950429112666, 188.07655842447008, 408.7000000000022, 214.47992575672214, 180.0192673690004, 114.06844783711803, 87.0216332161416, 25.600000000000087, 34.35431806394472, 691.3717466013524, 363.4000000000009, 202.25101310339332], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-792.6644185355984, -834.7365516237483, -464.0866368709083, -1172.263124196551, -0.5295854923891713, -852.7802610285958, -1338.0295113973548, -29.552108953684318, -1199.3853598369367, -512.9490321114231, -1246.6237371082723, 141.8375829010378, -1161.3962214028888, -1270.8830388321223, -1307.998129084979, 29.418334417780954, 13.679687739856842, -327.3090858323892, -1034.2675733444453, 376.54721868580754, -469.3430034367644, -892.5949646561737, -838.0771235094691, -1054.8424953533417, -353.1379274339013, 40.0000000000003, -438.8745083623494, -919.0198802167242, -768.5204875002554, -1402.4996455489925, -420.2720221834187, -1022.2148312055841, -1191.6560407820068, -1040.9193842326042, -950.8200584204124, -922.7809590484117, -390.19128760297895, -1064.61373059228, -1111.6230912566634, -1230.382441555485, -104.88391131567612, -1053.8406498992108, -836.7443769113196, 386.37026097683406, -716.0626967082362, -911.9455369056385, -665.7128309647592, -409.4318169063763, -927.8914557807115, -184.8857280528559, -586.0781041789604, -589.3813706162332, -1185.9107583343311, -553.556953295606, -667.7028096212367, -269.0663086819284, -1010.3683581701196, -138.76523394370716, -1355.5373245360806, -1212.1643503451396, -3.2937686228909087, -949.9293639600415, -1252.1334547099707, -987.7043061655365, 311.9061654122173, -552.5382831005769, -123.24475750010646, -1143.081065327753, -648.7297651380721, -308.3710849937944, -930.5984368348466, -5.981648689539712, -992.8067851591023, -843.3685116962756, -162.91156748888588, -1046.7557850674007, -508.0854212726299, -1064.826644749205, -1112.7034930319728, -611.967274317448, -774.2773730952957, -876.1514503729595, 237.26635690102947, -301.2694845261223, -1217.76961292611, 40.0000000000003, -1023.3699019499218, -108.71521615783917, -1126.8787922595116, -721.307677211728, -366.8072268783317, -929.0683024513369, -876.9252430993074, -1401.331956253194, -1146.567162628531, -97.50205289795554, -1162.3094993278387, -867.0741417699556, 196.8229105611189, -998.8855385696554, -949.4821126412658, -859.7610680107471, -243.02380108932599, -294.8067054499716, -1146.27737721158, 30.273548446340133, -105.7433190651669, 234.3029389473304, -1261.5606820365097, 17.36391716401435, -590.3144329872397, -942.4615931366825, -785.4280534497177, -989.3884897686911, -638.0099149417459, -1179.0013585175618, -945.7125732663287, -244.80585722374508, -608.2754714380354, -926.6662710110038, -77.0141018647871, -1055.5883751425804, -1289.4308162583989, 34.11920890817794, -426.2523339943946, -481.8831891157203, -713.9759692852524, -1175.3999003794936, -614.1290764778548, -169.3144722192811, -695.4085296670885, -36.24598561098494, -1094.7428234025222, -222.90735731802266, 277.85721410764523, -994.203193232017, -612.3274634529313, -785.9774581575616, -544.725299416091, -248.16062143677405, -603.18566935651, 140.65655861462784, -386.1670448955635, 27.69092523530989, -1003.4806598264222, -140.30789943842512, -616.9209238135539, -796.3149529763323, -545.1355472025641, 32.90849543296736, -456.37160528652475, -371.5995245654865, -223.76169051069425, -218.46462666978024, 384.5825037617225, -455.4498019327936, -782.8638258441715, -793.8143007939683, -483.790623765417, -1408.861358090592, -154.9395705626469, -542.4225345167971, -531.2762172355294, -614.9584611490643, -751.1146148641301, -543.1134090330861, -113.03127238701634, -538.7909495882844, -881.2917929508606, -669.551988267837, -675.6575747860553, 27.073017717903088, -472.22587123693563, -415.89166604804063, -30.591940310001696, -875.5890659526416, -428.8248205489195, -783.8788238262249, -998.4101471361921, -111.66199376362877, 365.7158901450151, -23.677505533706473, -13.442896108207643, -574.4935856602915, -1053.2066119328354, -680.2090891506535, -609.702516488712, -269.316245888413, -375.58214926465706, -1029.443458299071, -267.82790572612043, -999.5491218907987, -510.0996775883865, -133.1771784562321, -1126.5527732848436, -31.276479265478272, -179.5097940972935, 325.82976134261617, -58.75670739441431, -895.7331980693631], "policy_predator_policy_reward": [1010.7263368937839, 1020.4231886976911, 1004.1961984267496, 1045.9574377474294, 885.3814953591041, 28.832082716641434, 352.2396723837334, 1236.4717773859804, 1146.9256756808134, 1037.9964919794788, 79.89856570879773, 1385.3354258539828, 1161.5962214028887, 1270.8830388321223, 1313.098129084979, 10.794280276631554, 316.92374268855394, 190.72262851023166, 849.4940521587386, 572.7446085871906, 545.4784816774635, 894.6196803962214, 1123.9371026518706, 985.7718187780448, 405.26579147890095, 173.64838414163788, 941.6985254494214, 505.54305033558774, 787.1475198082259, 1402.2295185488465, 823.3727893573548, 901.6693857501677, 1040.5312936694359, 1208.7673942015347, 970.6829251184987, 1054.4714519363467, 480.17152601278246, 1046.1073776681699, 1375.6054007931875, 960.4140721202318, 176.696897910596, 1052.332212239468, 810.8451925818922, 196.2147057498813, 714.4670680000929, 1003.1258420695755, 249.870841235092, 1022.5033055179345, 863.7887975940151, 701.9610787776309, 171.80400026898042, 1034.4661757239548, 1216.411439565573, 583.7881146490521, 701.0085732106546, 400.0381686778831, 1022.3570998278364, 385.98514785789513, 1369.1769355319793, 1198.381812733227, 385.5569448150651, 922.1623015848076, 1244.0472305613707, 1012.8428800987714, 162.72557605671125, 553.6452288154918, 1164.3884231123404, 340.1881004233527, 867.6255992327733, 258.355518172795, 354.99298701828866, 736.2378346737719, 1004.7992305680511, 839.7337886354512, 451.7083608577693, 930.6541744501451, 643.7766711444621, 994.1085047546762, 1115.6034930319736, 631.8672743174525, 1053.7976451418012, 845.8320427612732, 478.64840795117726, 300.16015570135903, 1217.76961292611, 5.030346263108996, 966.3675830414295, 272.628904924743, 1138.4889679013327, 845.8242687130924, 688.6561809826625, 911.4325584078658, 909.9401655162005, 1395.4460923743893, 1068.3901596224587, 409.62598799703653, 1035.3495972010599, 1264.1602102200918, 952.8988986691774, 481.0508580346194, 947.2278738536447, 867.908527013628, 309.5160621002022, 575.0476734592273, 1000.3651664474985, 728.6131317006116, 15.027290749485683, 142.7130893683502, 1200.2093249606257, 465.141096304285, 446.9063312797461, 1076.1252735425012, 917.4736541447118, 976.2932562466282, 897.6070588883344, 1000.6155769253234, 950.7125732663287, 276.105857223749, 818.4250155312367, 887.1796691132831, 708.5222036667952, 901.4068547660241, 1289.4308162583989, 35.93786522731754, 192.97600122877276, 798.3414107478663, 909.1127925364445, 999.3553744423865, 551.7840898160638, 566.3929173518746, 678.6600252044362, 107.97814935887025, 984.8435909459012, 770.3128303003396, 156.28677582695755, 963.122129481641, 802.1599396083964, 602.5842007880093, 562.640278258001, 307.4561180013503, 210.81862635778376, 666.3732493487996, 392.64313893103645, 166.63799893682398, 919.2373480859133, 488.1719471784144, 523.7114979326362, 814.5984074278059, 33.985828197824866, 658.891310110541, 655.5877487040952, 459.7608352310868, 240.01945334388296, 297.7906412861313, 0.8483022659694665, 472.1498019327971, 886.3992320250835, 701.1646266135936, 1307.3853921324555, 823.5417135459127, 61.634709770042875, 743.4966381955413, 703.0665814551104, 517.6719084496925, 973.7036655410006, 551.117647728026, 292.84061111626033, 502.5098406029496, 930.8975348485955, 617.4570703538702, 695.4575747860573, 16.971946502530752, 636.0340230273126, 397.19660749427965, 37.81962727005034, 883.2236871982542, 981.2349103908549, 307.16377689556384, 493.0080634709877, 805.1406358533035, 7.2841098549848535, 59.37750553370698, 269.78343268437817, 532.6329748408463, 1034.1991566129757, 879.2358118395165, 630.9195069733198, 362.1677032409263, 1093.790743332764, 398.25649744711035, 292.32790572612026, 1000.6491218907988, 533.6314179721568, 143.9997561364086, 1024.656412511655, 824.5445866400145, 206.80979409729204, 10.270238657383818, 582.0183978716653, 574.7225206955042]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.91405152513382, "mean_inference_ms": 4.511331427358233, "mean_action_processing_ms": 1.6138164984524144, "mean_env_wait_ms": 10.46266189564363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005807757377624512, "StateBufferConnector_ms": 0.004612088203430176, "ViewRequirementAgentConnector_ms": 0.15650367736816406}, "num_episodes": 12, "episode_return_max": 764.5183060872913, "episode_return_min": -74.9259714294466, "episode_return_mean": 198.16212240292927, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.26140291392365, "num_env_steps_trained_throughput_per_sec": 81.26140291392365, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 50956.823, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50956.726, "sample_time_ms": 2610.975, "learn_time_ms": 48323.011, "learn_throughput": 82.776, "synch_weights_time_ms": 16.828}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "35fb9_00000", "date": "2024-08-22_08-39-25", "timestamp": 1724296165, "time_this_iter_s": 49.26886987686157, "time_total_s": 2743.938920736313, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fca9f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2743.938920736313, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 28.627142857142857, "ram_util_percent": 81.11000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.608190173636038, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.962351798002051, "policy_loss": -0.024049741077291034, "vf_loss": 6.98331225183275, "vf_explained_var": 0.5684054281030383, "kl": 0.015446501480730832, "entropy": 0.7274183946942526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.629004006663328, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.897579220363072, "policy_loss": -0.015900073886267525, "vf_loss": 6.9112573535354045, "vf_explained_var": 0.30077587719316834, "kl": 0.011109716395438505, "entropy": 0.5663145726793026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 714.8054360274436, "episode_reward_min": -74.9259714294466, "episode_reward_mean": 193.05304076668642, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1408.861358090592, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 386.37026097683406, "predator_policy": 1402.2295185488465}, "policy_reward_mean": {"prey_policy": -568.4637812442643, "predator_policy": 664.9903016276082}, "custom_metrics": {}, "hist_stats": {"episode_reward": [265.77624818663804, 89.34718720593014, 18.35690530782118, 282.55532171851297, 16.723262856360257, 151.55335958601634, 71.47388548569235, -5.98605989872218, 70.30454893517793, 556.6857823972879, 89.58467645579115, 197.22949888189171, 452.972692538081, 30.810701197737625, 60.73184258468417, 164.27762358536475, 259.208655571905, -0.14292661601425793, 354.4961138169399, 17.05234978463362, 475.73868718384193, 238.2507007078331, 168.88026727370064, 154.65073616767177, 8.357722348120737, 172.69518275162702, 64.9731098773036, 22.800000000000054, 249.2008644348195, 714.8054360274436, 45.030346263109436, 106.91136985841169, 136.1267671431846, 304.2132100608591, 27.12905853808632, 233.94693209301073, 270.1261663233514, 631.8871286952602, 5.893220215258989, 346.73322902012944, 612.9744693828698, 286.3000000000038, 421.1536563924208, -9.744421301678223, 118.9503671729292, 81.2113623543525, 36.30000000000022, 170.66294219547282, 477.3265814254534, 70.0570741354955, 83.18188886652055, 19.092297314080348, 334.7334584708073, 54.983659285232314, 437.50624052569907, 403.06292618422697, 6.439218785909347, 77.21047540648304, 414.66276496470067, 200.8050182075983, 263.6207359994834, -74.9259714294466, 180.65008653876833, 287.37745408316965, 95.58377744954092, 402.1308060276948, 10.88573200053634, 238.27512382235275, 107.769242886139, 74.50381152020552, 230.59328937180305, 143.52822974390767, -2.4891760162368755, 63.84496422043412, 145.11309323661234, 14.862308205661186, 75.6950429112666, 188.07655842447008, 408.7000000000022, 214.47992575672214, 180.0192673690004, 114.06844783711803, 87.0216332161416, 25.600000000000087, 34.35431806394472, 691.3717466013524, 363.4000000000009, 202.25101310339332, 296.31783176430025, 281.8150380532654, 53.988779339019, 358.15317449179264, 8.66790052423426, 428.7921726351028, 85.38540440958502, 8.198669654316648, 287.4569857592227, -38.882724241478364, 402.11759900190975, 548.7000000000023], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-353.1379274339013, 40.0000000000003, -438.8745083623494, -919.0198802167242, -768.5204875002554, -1402.4996455489925, -420.2720221834187, -1022.2148312055841, -1191.6560407820068, -1040.9193842326042, -950.8200584204124, -922.7809590484117, -390.19128760297895, -1064.61373059228, -1111.6230912566634, -1230.382441555485, -104.88391131567612, -1053.8406498992108, -836.7443769113196, 386.37026097683406, -716.0626967082362, -911.9455369056385, -665.7128309647592, -409.4318169063763, -927.8914557807115, -184.8857280528559, -586.0781041789604, -589.3813706162332, -1185.9107583343311, -553.556953295606, -667.7028096212367, -269.0663086819284, -1010.3683581701196, -138.76523394370716, -1355.5373245360806, -1212.1643503451396, -3.2937686228909087, -949.9293639600415, -1252.1334547099707, -987.7043061655365, 311.9061654122173, -552.5382831005769, -123.24475750010646, -1143.081065327753, -648.7297651380721, -308.3710849937944, -930.5984368348466, -5.981648689539712, -992.8067851591023, -843.3685116962756, -162.91156748888588, -1046.7557850674007, -508.0854212726299, -1064.826644749205, -1112.7034930319728, -611.967274317448, -774.2773730952957, -876.1514503729595, 237.26635690102947, -301.2694845261223, -1217.76961292611, 40.0000000000003, -1023.3699019499218, -108.71521615783917, -1126.8787922595116, -721.307677211728, -366.8072268783317, -929.0683024513369, -876.9252430993074, -1401.331956253194, -1146.567162628531, -97.50205289795554, -1162.3094993278387, -867.0741417699556, 196.8229105611189, -998.8855385696554, -949.4821126412658, -859.7610680107471, -243.02380108932599, -294.8067054499716, -1146.27737721158, 30.273548446340133, -105.7433190651669, 234.3029389473304, -1261.5606820365097, 17.36391716401435, -590.3144329872397, -942.4615931366825, -785.4280534497177, -989.3884897686911, -638.0099149417459, -1179.0013585175618, -945.7125732663287, -244.80585722374508, -608.2754714380354, -926.6662710110038, -77.0141018647871, -1055.5883751425804, -1289.4308162583989, 34.11920890817794, -426.2523339943946, -481.8831891157203, -713.9759692852524, -1175.3999003794936, -614.1290764778548, -169.3144722192811, -695.4085296670885, -36.24598561098494, -1094.7428234025222, -222.90735731802266, 277.85721410764523, -994.203193232017, -612.3274634529313, -785.9774581575616, -544.725299416091, -248.16062143677405, -603.18566935651, 140.65655861462784, -386.1670448955635, 27.69092523530989, -1003.4806598264222, -140.30789943842512, -616.9209238135539, -796.3149529763323, -545.1355472025641, 32.90849543296736, -456.37160528652475, -371.5995245654865, -223.76169051069425, -218.46462666978024, 384.5825037617225, -455.4498019327936, -782.8638258441715, -793.8143007939683, -483.790623765417, -1408.861358090592, -154.9395705626469, -542.4225345167971, -531.2762172355294, -614.9584611490643, -751.1146148641301, -543.1134090330861, -113.03127238701634, -538.7909495882844, -881.2917929508606, -669.551988267837, -675.6575747860553, 27.073017717903088, -472.22587123693563, -415.89166604804063, -30.591940310001696, -875.5890659526416, -428.8248205489195, -783.8788238262249, -998.4101471361921, -111.66199376362877, 365.7158901450151, -23.677505533706473, -13.442896108207643, -574.4935856602915, -1053.2066119328354, -680.2090891506535, -609.702516488712, -269.316245888413, -375.58214926465706, -1029.443458299071, -267.82790572612043, -999.5491218907987, -510.0996775883865, -133.1771784562321, -1126.5527732848436, -31.276479265478272, -179.5097940972935, 325.82976134261617, -58.75670739441431, -895.7331980693631, -8.65837464255911, -396.22742318744105, -288.4901336786529, -801.0232581848703, -175.74508183772056, -344.1495594834421, -477.2618027972046, -207.25887856563088, -369.32481193876816, -276.30106858966155, -736.2326303682684, -414.0402398234288, -477.49828092471574, -784.4632696739726, -1334.0066268899452, -976.1909987780141, -1135.7779918991914, -514.8488302759337, -187.83138477350207, -717.2043307063785, -855.8343017046111, 350.1726814658714, 385.7190585059827, -8.643751554604368], "policy_predator_policy_reward": [405.26579147890095, 173.64838414163788, 941.6985254494214, 505.54305033558774, 787.1475198082259, 1402.2295185488465, 823.3727893573548, 901.6693857501677, 1040.5312936694359, 1208.7673942015347, 970.6829251184987, 1054.4714519363467, 480.17152601278246, 1046.1073776681699, 1375.6054007931875, 960.4140721202318, 176.696897910596, 1052.332212239468, 810.8451925818922, 196.2147057498813, 714.4670680000929, 1003.1258420695755, 249.870841235092, 1022.5033055179345, 863.7887975940151, 701.9610787776309, 171.80400026898042, 1034.4661757239548, 1216.411439565573, 583.7881146490521, 701.0085732106546, 400.0381686778831, 1022.3570998278364, 385.98514785789513, 1369.1769355319793, 1198.381812733227, 385.5569448150651, 922.1623015848076, 1244.0472305613707, 1012.8428800987714, 162.72557605671125, 553.6452288154918, 1164.3884231123404, 340.1881004233527, 867.6255992327733, 258.355518172795, 354.99298701828866, 736.2378346737719, 1004.7992305680511, 839.7337886354512, 451.7083608577693, 930.6541744501451, 643.7766711444621, 994.1085047546762, 1115.6034930319736, 631.8672743174525, 1053.7976451418012, 845.8320427612732, 478.64840795117726, 300.16015570135903, 1217.76961292611, 5.030346263108996, 966.3675830414295, 272.628904924743, 1138.4889679013327, 845.8242687130924, 688.6561809826625, 911.4325584078658, 909.9401655162005, 1395.4460923743893, 1068.3901596224587, 409.62598799703653, 1035.3495972010599, 1264.1602102200918, 952.8988986691774, 481.0508580346194, 947.2278738536447, 867.908527013628, 309.5160621002022, 575.0476734592273, 1000.3651664474985, 728.6131317006116, 15.027290749485683, 142.7130893683502, 1200.2093249606257, 465.141096304285, 446.9063312797461, 1076.1252735425012, 917.4736541447118, 976.2932562466282, 897.6070588883344, 1000.6155769253234, 950.7125732663287, 276.105857223749, 818.4250155312367, 887.1796691132831, 708.5222036667952, 901.4068547660241, 1289.4308162583989, 35.93786522731754, 192.97600122877276, 798.3414107478663, 909.1127925364445, 999.3553744423865, 551.7840898160638, 566.3929173518746, 678.6600252044362, 107.97814935887025, 984.8435909459012, 770.3128303003396, 156.28677582695755, 963.122129481641, 802.1599396083964, 602.5842007880093, 562.640278258001, 307.4561180013503, 210.81862635778376, 666.3732493487996, 392.64313893103645, 166.63799893682398, 919.2373480859133, 488.1719471784144, 523.7114979326362, 814.5984074278059, 33.985828197824866, 658.891310110541, 655.5877487040952, 459.7608352310868, 240.01945334388296, 297.7906412861313, 0.8483022659694665, 472.1498019327971, 886.3992320250835, 701.1646266135936, 1307.3853921324555, 823.5417135459127, 61.634709770042875, 743.4966381955413, 703.0665814551104, 517.6719084496925, 973.7036655410006, 551.117647728026, 292.84061111626033, 502.5098406029496, 930.8975348485955, 617.4570703538702, 695.4575747860573, 16.971946502530752, 636.0340230273126, 397.19660749427965, 37.81962727005034, 883.2236871982542, 981.2349103908549, 307.16377689556384, 493.0080634709877, 805.1406358533035, 7.2841098549848535, 59.37750553370698, 269.78343268437817, 532.6329748408463, 1034.1991566129757, 879.2358118395165, 630.9195069733198, 362.1677032409263, 1093.790743332764, 398.25649744711035, 292.32790572612026, 1000.6491218907988, 533.6314179721568, 143.9997561364086, 1024.656412511655, 824.5445866400145, 206.80979409729204, 10.270238657383818, 582.0183978716653, 574.7225206955042, 283.41156944901275, 417.79206014529234, 573.7277073608672, 797.6007225559239, 221.0004082007864, 352.8830124593988, 593.7116764300981, 448.96217942452995, 0.0, 654.2937810526647, 914.1068885818503, 664.9581542449513, 537.247023566269, 810.0999314420037, 1340.0052965442617, 978.3909987780141, 1050.9521286796999, 887.1316792546535, 37.08176033199851, 829.0712309064065, 855.2881052856418, 52.49111395500784, 7.280941494017313, 164.343751554604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.90350825382928, "mean_inference_ms": 4.510977694602977, "mean_action_processing_ms": 1.6186063865895983, "mean_env_wait_ms": 10.45926905181754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060253143310546875, "StateBufferConnector_ms": 0.004780292510986328, "ViewRequirementAgentConnector_ms": 0.1620398759841919}, "num_episodes": 12, "episode_return_max": 714.8054360274436, "episode_return_min": -74.9259714294466, "episode_return_mean": 193.05304076668642, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.1218484878223, "num_env_steps_trained_throughput_per_sec": 79.1218484878223, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 50988.258, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50988.151, "sample_time_ms": 2606.656, "learn_time_ms": 48359.356, "learn_throughput": 82.714, "synch_weights_time_ms": 17.359}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "35fb9_00000", "date": "2024-08-22_08-40-16", "timestamp": 1724296216, "time_this_iter_s": 50.591049909591675, "time_total_s": 2794.5299706459045, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b5cc700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2794.5299706459045, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 31.930555555555557, "ram_util_percent": 81.95833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.253878655383197, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.66733885265532, "policy_loss": -0.025362397581659177, "vf_loss": 6.6897251366307495, "vf_explained_var": 0.5917506795080881, "kl": 0.014880531821424564, "entropy": 0.6873404226290486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.866876263404018, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.015285356965645, "policy_loss": -0.016952573890901275, "vf_loss": 7.029929628826323, "vf_explained_var": 0.29594951262549746, "kl": 0.011541598518970348, "entropy": 0.5639915121137781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 714.8054360274436, "episode_reward_min": -74.9259714294466, "episode_reward_mean": 188.1246919654547, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1618.2914975960452, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 385.7190585059827, "predator_policy": 1622.7914975960452}, "policy_reward_mean": {"prey_policy": -557.724439610185, "predator_policy": 651.786785592913}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.14292661601425793, 354.4961138169399, 17.05234978463362, 475.73868718384193, 238.2507007078331, 168.88026727370064, 154.65073616767177, 8.357722348120737, 172.69518275162702, 64.9731098773036, 22.800000000000054, 249.2008644348195, 714.8054360274436, 45.030346263109436, 106.91136985841169, 136.1267671431846, 304.2132100608591, 27.12905853808632, 233.94693209301073, 270.1261663233514, 631.8871286952602, 5.893220215258989, 346.73322902012944, 612.9744693828698, 286.3000000000038, 421.1536563924208, -9.744421301678223, 118.9503671729292, 81.2113623543525, 36.30000000000022, 170.66294219547282, 477.3265814254534, 70.0570741354955, 83.18188886652055, 19.092297314080348, 334.7334584708073, 54.983659285232314, 437.50624052569907, 403.06292618422697, 6.439218785909347, 77.21047540648304, 414.66276496470067, 200.8050182075983, 263.6207359994834, -74.9259714294466, 180.65008653876833, 287.37745408316965, 95.58377744954092, 402.1308060276948, 10.88573200053634, 238.27512382235275, 107.769242886139, 74.50381152020552, 230.59328937180305, 143.52822974390767, -2.4891760162368755, 63.84496422043412, 145.11309323661234, 14.862308205661186, 75.6950429112666, 188.07655842447008, 408.7000000000022, 214.47992575672214, 180.0192673690004, 114.06844783711803, 87.0216332161416, 25.600000000000087, 34.35431806394472, 691.3717466013524, 363.4000000000009, 202.25101310339332, 296.31783176430025, 281.8150380532654, 53.988779339019, 358.15317449179264, 8.66790052423426, 428.7921726351028, 85.38540440958502, 8.198669654316648, 287.4569857592227, -38.882724241478364, 402.11759900190975, 548.7000000000023, 160.73527851541937, 29.100000000000144, 7.49194776032925, 127.8912183082054, 455.68423914429485, 402.30252057855836, -0.8053255455714403, 126.05450210035667, 6.799999999999997, 104.0077637585006, 239.42286961059196, 32.0000000000002, 10.543428764270935, 224.33424648918736, 243.26354315591993, 64.82982278865651, 45.11519704428133], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1355.5373245360806, -1212.1643503451396, -3.2937686228909087, -949.9293639600415, -1252.1334547099707, -987.7043061655365, 311.9061654122173, -552.5382831005769, -123.24475750010646, -1143.081065327753, -648.7297651380721, -308.3710849937944, -930.5984368348466, -5.981648689539712, -992.8067851591023, -843.3685116962756, -162.91156748888588, -1046.7557850674007, -508.0854212726299, -1064.826644749205, -1112.7034930319728, -611.967274317448, -774.2773730952957, -876.1514503729595, 237.26635690102947, -301.2694845261223, -1217.76961292611, 40.0000000000003, -1023.3699019499218, -108.71521615783917, -1126.8787922595116, -721.307677211728, -366.8072268783317, -929.0683024513369, -876.9252430993074, -1401.331956253194, -1146.567162628531, -97.50205289795554, -1162.3094993278387, -867.0741417699556, 196.8229105611189, -998.8855385696554, -949.4821126412658, -859.7610680107471, -243.02380108932599, -294.8067054499716, -1146.27737721158, 30.273548446340133, -105.7433190651669, 234.3029389473304, -1261.5606820365097, 17.36391716401435, -590.3144329872397, -942.4615931366825, -785.4280534497177, -989.3884897686911, -638.0099149417459, -1179.0013585175618, -945.7125732663287, -244.80585722374508, -608.2754714380354, -926.6662710110038, -77.0141018647871, -1055.5883751425804, -1289.4308162583989, 34.11920890817794, -426.2523339943946, -481.8831891157203, -713.9759692852524, -1175.3999003794936, -614.1290764778548, -169.3144722192811, -695.4085296670885, -36.24598561098494, -1094.7428234025222, -222.90735731802266, 277.85721410764523, -994.203193232017, -612.3274634529313, -785.9774581575616, -544.725299416091, -248.16062143677405, -603.18566935651, 140.65655861462784, -386.1670448955635, 27.69092523530989, -1003.4806598264222, -140.30789943842512, -616.9209238135539, -796.3149529763323, -545.1355472025641, 32.90849543296736, -456.37160528652475, -371.5995245654865, -223.76169051069425, -218.46462666978024, 384.5825037617225, -455.4498019327936, -782.8638258441715, -793.8143007939683, -483.790623765417, -1408.861358090592, -154.9395705626469, -542.4225345167971, -531.2762172355294, -614.9584611490643, -751.1146148641301, -543.1134090330861, -113.03127238701634, -538.7909495882844, -881.2917929508606, -669.551988267837, -675.6575747860553, 27.073017717903088, -472.22587123693563, -415.89166604804063, -30.591940310001696, -875.5890659526416, -428.8248205489195, -783.8788238262249, -998.4101471361921, -111.66199376362877, 365.7158901450151, -23.677505533706473, -13.442896108207643, -574.4935856602915, -1053.2066119328354, -680.2090891506535, -609.702516488712, -269.316245888413, -375.58214926465706, -1029.443458299071, -267.82790572612043, -999.5491218907987, -510.0996775883865, -133.1771784562321, -1126.5527732848436, -31.276479265478272, -179.5097940972935, 325.82976134261617, -58.75670739441431, -895.7331980693631, -8.65837464255911, -396.22742318744105, -288.4901336786529, -801.0232581848703, -175.74508183772056, -344.1495594834421, -477.2618027972046, -207.25887856563088, -369.32481193876816, -276.30106858966155, -736.2326303682684, -414.0402398234288, -477.49828092471574, -784.4632696739726, -1334.0066268899452, -976.1909987780141, -1135.7779918991914, -514.8488302759337, -187.83138477350207, -717.2043307063785, -855.8343017046111, 350.1726814658714, 385.7190585059827, -8.643751554604368, -197.8784512309034, -305.0321900819431, -460.6753263040774, -955.6088795211516, -1340.9198463420219, -941.9355285486618, -98.38541279995762, -968.6622355686969, -822.9481157414382, 383.8173887239609, 40.0000000000003, -590.8666441102439, -1315.534284093637, -1156.2586997529802, -572.7790393183333, -145.36422535178457, -684.0812401875436, -1042.9525813269652, -670.9603731397058, -204.08036262789227, -623.3025897281823, -1272.1911056679717, -169.8839294891269, -1187.0961684633733, -1618.2914975960452, -784.1613337513421, -730.5873580299714, -324.77654978570706, -439.05055073759985, -685.0042983806068, -416.566376073151, -711.4734614223246, -246.8262556075199, -205.19908637936334], "policy_predator_policy_reward": [1369.1769355319793, 1198.381812733227, 385.5569448150651, 922.1623015848076, 1244.0472305613707, 1012.8428800987714, 162.72557605671125, 553.6452288154918, 1164.3884231123404, 340.1881004233527, 867.6255992327733, 258.355518172795, 354.99298701828866, 736.2378346737719, 1004.7992305680511, 839.7337886354512, 451.7083608577693, 930.6541744501451, 643.7766711444621, 994.1085047546762, 1115.6034930319736, 631.8672743174525, 1053.7976451418012, 845.8320427612732, 478.64840795117726, 300.16015570135903, 1217.76961292611, 5.030346263108996, 966.3675830414295, 272.628904924743, 1138.4889679013327, 845.8242687130924, 688.6561809826625, 911.4325584078658, 909.9401655162005, 1395.4460923743893, 1068.3901596224587, 409.62598799703653, 1035.3495972010599, 1264.1602102200918, 952.8988986691774, 481.0508580346194, 947.2278738536447, 867.908527013628, 309.5160621002022, 575.0476734592273, 1000.3651664474985, 728.6131317006116, 15.027290749485683, 142.7130893683502, 1200.2093249606257, 465.141096304285, 446.9063312797461, 1076.1252735425012, 917.4736541447118, 976.2932562466282, 897.6070588883344, 1000.6155769253234, 950.7125732663287, 276.105857223749, 818.4250155312367, 887.1796691132831, 708.5222036667952, 901.4068547660241, 1289.4308162583989, 35.93786522731754, 192.97600122877276, 798.3414107478663, 909.1127925364445, 999.3553744423865, 551.7840898160638, 566.3929173518746, 678.6600252044362, 107.97814935887025, 984.8435909459012, 770.3128303003396, 156.28677582695755, 963.122129481641, 802.1599396083964, 602.5842007880093, 562.640278258001, 307.4561180013503, 210.81862635778376, 666.3732493487996, 392.64313893103645, 166.63799893682398, 919.2373480859133, 488.1719471784144, 523.7114979326362, 814.5984074278059, 33.985828197824866, 658.891310110541, 655.5877487040952, 459.7608352310868, 240.01945334388296, 297.7906412861313, 0.8483022659694665, 472.1498019327971, 886.3992320250835, 701.1646266135936, 1307.3853921324555, 823.5417135459127, 61.634709770042875, 743.4966381955413, 703.0665814551104, 517.6719084496925, 973.7036655410006, 551.117647728026, 292.84061111626033, 502.5098406029496, 930.8975348485955, 617.4570703538702, 695.4575747860573, 16.971946502530752, 636.0340230273126, 397.19660749427965, 37.81962727005034, 883.2236871982542, 981.2349103908549, 307.16377689556384, 493.0080634709877, 805.1406358533035, 7.2841098549848535, 59.37750553370698, 269.78343268437817, 532.6329748408463, 1034.1991566129757, 879.2358118395165, 630.9195069733198, 362.1677032409263, 1093.790743332764, 398.25649744711035, 292.32790572612026, 1000.6491218907988, 533.6314179721568, 143.9997561364086, 1024.656412511655, 824.5445866400145, 206.80979409729204, 10.270238657383818, 582.0183978716653, 574.7225206955042, 283.41156944901275, 417.79206014529234, 573.7277073608672, 797.6007225559239, 221.0004082007864, 352.8830124593988, 593.7116764300981, 448.96217942452995, 0.0, 654.2937810526647, 914.1068885818503, 664.9581542449513, 537.247023566269, 810.0999314420037, 1340.0052965442617, 978.3909987780141, 1050.9521286796999, 887.1316792546535, 37.08176033199851, 829.0712309064065, 855.2881052856418, 52.49111395500784, 7.280941494017313, 164.343751554604, 334.81852099182294, 328.8273988364459, 478.07532630408133, 967.3088795211515, 1346.011794102351, 944.3355285486622, 732.6030703543199, 462.3357963225379, 793.225532281789, 101.58943387998501, 485.65812407121996, 467.51104061757803, 1316.734284093637, 1154.2533742074088, 198.25764535801986, 645.9401214124612, 686.3812401875442, 1047.4525813269656, 721.5669937649111, 257.48150576118985, 949.1081588623247, 1185.8084061444256, 196.2839294891254, 1192.6961684633734, 1622.7914975960452, 790.204762515614, 722.084192057361, 557.6139622475046, 625.7168255348638, 741.6015667392675, 282.94860414226576, 909.9210561418676, 196.17186686345133, 300.9686721677135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.911629772684919, "mean_inference_ms": 4.499425896242539, "mean_action_processing_ms": 1.575683927505752, "mean_env_wait_ms": 10.464546249340831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01591777801513672, "StateBufferConnector_ms": 0.004669666290283203, "ViewRequirementAgentConnector_ms": 0.15489137172698975}, "num_episodes": 17, "episode_return_max": 714.8054360274436, "episode_return_min": -74.9259714294466, "episode_return_mean": 188.1246919654547, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.05861249110184, "num_env_steps_trained_throughput_per_sec": 79.05861249110184, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 50819.868, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50819.764, "sample_time_ms": 2491.633, "learn_time_ms": 48307.169, "learn_throughput": 82.803, "synch_weights_time_ms": 16.356}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "35fb9_00000", "date": "2024-08-22_08-41-07", "timestamp": 1724296267, "time_this_iter_s": 50.642942905426025, "time_total_s": 2845.1729135513306, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcbd550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2845.1729135513306, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 32.1861111111111, "ram_util_percent": 82.27916666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.336417712547162, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.131476921253103, "policy_loss": -0.01936315503193154, "vf_loss": 7.147952981726833, "vf_explained_var": 0.5277152522531136, "kl": 0.01443547302433265, "entropy": 0.6838983793738027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.245652600760183, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.150425748219566, "policy_loss": -0.012887873815707666, "vf_loss": 7.1613293776436455, "vf_explained_var": 0.23868759728613353, "kl": 0.009921228940593739, "entropy": 0.5319858207431419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 714.8054360274436, "episode_reward_min": -74.9259714294466, "episode_reward_mean": 192.16577960698774, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1618.2914975960452, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 385.7190585059827, "predator_policy": 1622.7914975960452}, "policy_reward_mean": {"prey_policy": -538.2485651651903, "predator_policy": 634.3314549686847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [154.65073616767177, 8.357722348120737, 172.69518275162702, 64.9731098773036, 22.800000000000054, 249.2008644348195, 714.8054360274436, 45.030346263109436, 106.91136985841169, 136.1267671431846, 304.2132100608591, 27.12905853808632, 233.94693209301073, 270.1261663233514, 631.8871286952602, 5.893220215258989, 346.73322902012944, 612.9744693828698, 286.3000000000038, 421.1536563924208, -9.744421301678223, 118.9503671729292, 81.2113623543525, 36.30000000000022, 170.66294219547282, 477.3265814254534, 70.0570741354955, 83.18188886652055, 19.092297314080348, 334.7334584708073, 54.983659285232314, 437.50624052569907, 403.06292618422697, 6.439218785909347, 77.21047540648304, 414.66276496470067, 200.8050182075983, 263.6207359994834, -74.9259714294466, 180.65008653876833, 287.37745408316965, 95.58377744954092, 402.1308060276948, 10.88573200053634, 238.27512382235275, 107.769242886139, 74.50381152020552, 230.59328937180305, 143.52822974390767, -2.4891760162368755, 63.84496422043412, 145.11309323661234, 14.862308205661186, 75.6950429112666, 188.07655842447008, 408.7000000000022, 214.47992575672214, 180.0192673690004, 114.06844783711803, 87.0216332161416, 25.600000000000087, 34.35431806394472, 691.3717466013524, 363.4000000000009, 202.25101310339332, 296.31783176430025, 281.8150380532654, 53.988779339019, 358.15317449179264, 8.66790052423426, 428.7921726351028, 85.38540440958502, 8.198669654316648, 287.4569857592227, -38.882724241478364, 402.11759900190975, 548.7000000000023, 160.73527851541937, 29.100000000000144, 7.49194776032925, 127.8912183082054, 455.68423914429485, 402.30252057855836, -0.8053255455714403, 126.05450210035667, 6.799999999999997, 104.0077637585006, 239.42286961059196, 32.0000000000002, 10.543428764270935, 224.33424648918736, 243.26354315591993, 64.82982278865651, 45.11519704428133, 418.38244061117945, 512.167324183569, 367.9214489732478, 129.43590176003107, 247.56946445678304, -17.092623680576814], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-930.5984368348466, -5.981648689539712, -992.8067851591023, -843.3685116962756, -162.91156748888588, -1046.7557850674007, -508.0854212726299, -1064.826644749205, -1112.7034930319728, -611.967274317448, -774.2773730952957, -876.1514503729595, 237.26635690102947, -301.2694845261223, -1217.76961292611, 40.0000000000003, -1023.3699019499218, -108.71521615783917, -1126.8787922595116, -721.307677211728, -366.8072268783317, -929.0683024513369, -876.9252430993074, -1401.331956253194, -1146.567162628531, -97.50205289795554, -1162.3094993278387, -867.0741417699556, 196.8229105611189, -998.8855385696554, -949.4821126412658, -859.7610680107471, -243.02380108932599, -294.8067054499716, -1146.27737721158, 30.273548446340133, -105.7433190651669, 234.3029389473304, -1261.5606820365097, 17.36391716401435, -590.3144329872397, -942.4615931366825, -785.4280534497177, -989.3884897686911, -638.0099149417459, -1179.0013585175618, -945.7125732663287, -244.80585722374508, -608.2754714380354, -926.6662710110038, -77.0141018647871, -1055.5883751425804, -1289.4308162583989, 34.11920890817794, -426.2523339943946, -481.8831891157203, -713.9759692852524, -1175.3999003794936, -614.1290764778548, -169.3144722192811, -695.4085296670885, -36.24598561098494, -1094.7428234025222, -222.90735731802266, 277.85721410764523, -994.203193232017, -612.3274634529313, -785.9774581575616, -544.725299416091, -248.16062143677405, -603.18566935651, 140.65655861462784, -386.1670448955635, 27.69092523530989, -1003.4806598264222, -140.30789943842512, -616.9209238135539, -796.3149529763323, -545.1355472025641, 32.90849543296736, -456.37160528652475, -371.5995245654865, -223.76169051069425, -218.46462666978024, 384.5825037617225, -455.4498019327936, -782.8638258441715, -793.8143007939683, -483.790623765417, -1408.861358090592, -154.9395705626469, -542.4225345167971, -531.2762172355294, -614.9584611490643, -751.1146148641301, -543.1134090330861, -113.03127238701634, -538.7909495882844, -881.2917929508606, -669.551988267837, -675.6575747860553, 27.073017717903088, -472.22587123693563, -415.89166604804063, -30.591940310001696, -875.5890659526416, -428.8248205489195, -783.8788238262249, -998.4101471361921, -111.66199376362877, 365.7158901450151, -23.677505533706473, -13.442896108207643, -574.4935856602915, -1053.2066119328354, -680.2090891506535, -609.702516488712, -269.316245888413, -375.58214926465706, -1029.443458299071, -267.82790572612043, -999.5491218907987, -510.0996775883865, -133.1771784562321, -1126.5527732848436, -31.276479265478272, -179.5097940972935, 325.82976134261617, -58.75670739441431, -895.7331980693631, -8.65837464255911, -396.22742318744105, -288.4901336786529, -801.0232581848703, -175.74508183772056, -344.1495594834421, -477.2618027972046, -207.25887856563088, -369.32481193876816, -276.30106858966155, -736.2326303682684, -414.0402398234288, -477.49828092471574, -784.4632696739726, -1334.0066268899452, -976.1909987780141, -1135.7779918991914, -514.8488302759337, -187.83138477350207, -717.2043307063785, -855.8343017046111, 350.1726814658714, 385.7190585059827, -8.643751554604368, -197.8784512309034, -305.0321900819431, -460.6753263040774, -955.6088795211516, -1340.9198463420219, -941.9355285486618, -98.38541279995762, -968.6622355686969, -822.9481157414382, 383.8173887239609, 40.0000000000003, -590.8666441102439, -1315.534284093637, -1156.2586997529802, -572.7790393183333, -145.36422535178457, -684.0812401875436, -1042.9525813269652, -670.9603731397058, -204.08036262789227, -623.3025897281823, -1272.1911056679717, -169.8839294891269, -1187.0961684633733, -1618.2914975960452, -784.1613337513421, -730.5873580299714, -324.77654978570706, -439.05055073759985, -685.0042983806068, -416.566376073151, -711.4734614223246, -246.8262556075199, -205.19908637936334, -643.341854102956, -242.56854921505663, 295.5463519833289, -401.0598884433674, -772.8358780316051, 331.2473477587989, -843.4365767396605, 8.31966140961298, -82.34552898553505, -1057.2512993337625, -337.952313148858, -583.9679431397345], "policy_predator_policy_reward": [354.99298701828866, 736.2378346737719, 1004.7992305680511, 839.7337886354512, 451.7083608577693, 930.6541744501451, 643.7766711444621, 994.1085047546762, 1115.6034930319736, 631.8672743174525, 1053.7976451418012, 845.8320427612732, 478.64840795117726, 300.16015570135903, 1217.76961292611, 5.030346263108996, 966.3675830414295, 272.628904924743, 1138.4889679013327, 845.8242687130924, 688.6561809826625, 911.4325584078658, 909.9401655162005, 1395.4460923743893, 1068.3901596224587, 409.62598799703653, 1035.3495972010599, 1264.1602102200918, 952.8988986691774, 481.0508580346194, 947.2278738536447, 867.908527013628, 309.5160621002022, 575.0476734592273, 1000.3651664474985, 728.6131317006116, 15.027290749485683, 142.7130893683502, 1200.2093249606257, 465.141096304285, 446.9063312797461, 1076.1252735425012, 917.4736541447118, 976.2932562466282, 897.6070588883344, 1000.6155769253234, 950.7125732663287, 276.105857223749, 818.4250155312367, 887.1796691132831, 708.5222036667952, 901.4068547660241, 1289.4308162583989, 35.93786522731754, 192.97600122877276, 798.3414107478663, 909.1127925364445, 999.3553744423865, 551.7840898160638, 566.3929173518746, 678.6600252044362, 107.97814935887025, 984.8435909459012, 770.3128303003396, 156.28677582695755, 963.122129481641, 802.1599396083964, 602.5842007880093, 562.640278258001, 307.4561180013503, 210.81862635778376, 666.3732493487996, 392.64313893103645, 166.63799893682398, 919.2373480859133, 488.1719471784144, 523.7114979326362, 814.5984074278059, 33.985828197824866, 658.891310110541, 655.5877487040952, 459.7608352310868, 240.01945334388296, 297.7906412861313, 0.8483022659694665, 472.1498019327971, 886.3992320250835, 701.1646266135936, 1307.3853921324555, 823.5417135459127, 61.634709770042875, 743.4966381955413, 703.0665814551104, 517.6719084496925, 973.7036655410006, 551.117647728026, 292.84061111626033, 502.5098406029496, 930.8975348485955, 617.4570703538702, 695.4575747860573, 16.971946502530752, 636.0340230273126, 397.19660749427965, 37.81962727005034, 883.2236871982542, 981.2349103908549, 307.16377689556384, 493.0080634709877, 805.1406358533035, 7.2841098549848535, 59.37750553370698, 269.78343268437817, 532.6329748408463, 1034.1991566129757, 879.2358118395165, 630.9195069733198, 362.1677032409263, 1093.790743332764, 398.25649744711035, 292.32790572612026, 1000.6491218907988, 533.6314179721568, 143.9997561364086, 1024.656412511655, 824.5445866400145, 206.80979409729204, 10.270238657383818, 582.0183978716653, 574.7225206955042, 283.41156944901275, 417.79206014529234, 573.7277073608672, 797.6007225559239, 221.0004082007864, 352.8830124593988, 593.7116764300981, 448.96217942452995, 0.0, 654.2937810526647, 914.1068885818503, 664.9581542449513, 537.247023566269, 810.0999314420037, 1340.0052965442617, 978.3909987780141, 1050.9521286796999, 887.1316792546535, 37.08176033199851, 829.0712309064065, 855.2881052856418, 52.49111395500784, 7.280941494017313, 164.343751554604, 334.81852099182294, 328.8273988364459, 478.07532630408133, 967.3088795211515, 1346.011794102351, 944.3355285486622, 732.6030703543199, 462.3357963225379, 793.225532281789, 101.58943387998501, 485.65812407121996, 467.51104061757803, 1316.734284093637, 1154.2533742074088, 198.25764535801986, 645.9401214124612, 686.3812401875442, 1047.4525813269656, 721.5669937649111, 257.48150576118985, 949.1081588623247, 1185.8084061444256, 196.2839294891254, 1192.6961684633734, 1622.7914975960452, 790.204762515614, 722.084192057361, 557.6139622475046, 625.7168255348638, 741.6015667392675, 282.94860414226576, 909.9210561418676, 196.17186686345133, 300.9686721677135, 615.0772410931152, 689.2156028360773, 216.34594913051336, 401.3349115130941, 47.98644289718226, 761.5235363488717, 356.6070871420979, 607.94572994798, 481.4280723843025, 905.7382203917795, 878.3102406043971, 26.517392003622973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.899411505581415, "mean_inference_ms": 4.492485765879292, "mean_action_processing_ms": 1.5767560102964109, "mean_env_wait_ms": 10.463583818527914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015748023986816406, "StateBufferConnector_ms": 0.0040711164474487305, "ViewRequirementAgentConnector_ms": 0.15292060375213623}, "num_episodes": 6, "episode_return_max": 714.8054360274436, "episode_return_min": -74.9259714294466, "episode_return_mean": 192.16577960698774, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.70666620848796, "num_env_steps_trained_throughput_per_sec": 81.70666620848796, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 50509.757, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50509.652, "sample_time_ms": 2475.969, "learn_time_ms": 48013.978, "learn_throughput": 83.309, "synch_weights_time_ms": 16.186}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "35fb9_00000", "date": "2024-08-22_08-41-56", "timestamp": 1724296316, "time_this_iter_s": 48.99479103088379, "time_total_s": 2894.1677045822144, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcda790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2894.1677045822144, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 28.33478260869565, "ram_util_percent": 83.0463768115942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.714524800562984, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.57259776428263, "policy_loss": -0.019998390432176175, "vf_loss": 6.590135203467475, "vf_explained_var": 0.5607017385581183, "kl": 0.012304739825176223, "entropy": 0.6331406677526141, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.234016984354252, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.176860219460947, "policy_loss": -0.01814516450933836, "vf_loss": 7.192535139265514, "vf_explained_var": 0.17404462329294315, "kl": 0.012351232228761234, "entropy": 0.5086886443789043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 714.8054360274436, "episode_reward_min": -74.9259714294466, "episode_reward_mean": 193.45715288070147, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1618.2914975960452, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 385.7190585059827, "predator_policy": 1622.7914975960452}, "policy_reward_mean": {"prey_policy": -534.7415070989312, "predator_policy": 631.4700835392825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.9731098773036, 22.800000000000054, 249.2008644348195, 714.8054360274436, 45.030346263109436, 106.91136985841169, 136.1267671431846, 304.2132100608591, 27.12905853808632, 233.94693209301073, 270.1261663233514, 631.8871286952602, 5.893220215258989, 346.73322902012944, 612.9744693828698, 286.3000000000038, 421.1536563924208, -9.744421301678223, 118.9503671729292, 81.2113623543525, 36.30000000000022, 170.66294219547282, 477.3265814254534, 70.0570741354955, 83.18188886652055, 19.092297314080348, 334.7334584708073, 54.983659285232314, 437.50624052569907, 403.06292618422697, 6.439218785909347, 77.21047540648304, 414.66276496470067, 200.8050182075983, 263.6207359994834, -74.9259714294466, 180.65008653876833, 287.37745408316965, 95.58377744954092, 402.1308060276948, 10.88573200053634, 238.27512382235275, 107.769242886139, 74.50381152020552, 230.59328937180305, 143.52822974390767, -2.4891760162368755, 63.84496422043412, 145.11309323661234, 14.862308205661186, 75.6950429112666, 188.07655842447008, 408.7000000000022, 214.47992575672214, 180.0192673690004, 114.06844783711803, 87.0216332161416, 25.600000000000087, 34.35431806394472, 691.3717466013524, 363.4000000000009, 202.25101310339332, 296.31783176430025, 281.8150380532654, 53.988779339019, 358.15317449179264, 8.66790052423426, 428.7921726351028, 85.38540440958502, 8.198669654316648, 287.4569857592227, -38.882724241478364, 402.11759900190975, 548.7000000000023, 160.73527851541937, 29.100000000000144, 7.49194776032925, 127.8912183082054, 455.68423914429485, 402.30252057855836, -0.8053255455714403, 126.05450210035667, 6.799999999999997, 104.0077637585006, 239.42286961059196, 32.0000000000002, 10.543428764270935, 224.33424648918736, 243.26354315591993, 64.82982278865651, 45.11519704428133, 418.38244061117945, 512.167324183569, 367.9214489732478, 129.43590176003107, 247.56946445678304, -17.092623680576814, 117.43726132535139, 162.1162565262091, 185.28745078723233], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-508.0854212726299, -1064.826644749205, -1112.7034930319728, -611.967274317448, -774.2773730952957, -876.1514503729595, 237.26635690102947, -301.2694845261223, -1217.76961292611, 40.0000000000003, -1023.3699019499218, -108.71521615783917, -1126.8787922595116, -721.307677211728, -366.8072268783317, -929.0683024513369, -876.9252430993074, -1401.331956253194, -1146.567162628531, -97.50205289795554, -1162.3094993278387, -867.0741417699556, 196.8229105611189, -998.8855385696554, -949.4821126412658, -859.7610680107471, -243.02380108932599, -294.8067054499716, -1146.27737721158, 30.273548446340133, -105.7433190651669, 234.3029389473304, -1261.5606820365097, 17.36391716401435, -590.3144329872397, -942.4615931366825, -785.4280534497177, -989.3884897686911, -638.0099149417459, -1179.0013585175618, -945.7125732663287, -244.80585722374508, -608.2754714380354, -926.6662710110038, -77.0141018647871, -1055.5883751425804, -1289.4308162583989, 34.11920890817794, -426.2523339943946, -481.8831891157203, -713.9759692852524, -1175.3999003794936, -614.1290764778548, -169.3144722192811, -695.4085296670885, -36.24598561098494, -1094.7428234025222, -222.90735731802266, 277.85721410764523, -994.203193232017, -612.3274634529313, -785.9774581575616, -544.725299416091, -248.16062143677405, -603.18566935651, 140.65655861462784, -386.1670448955635, 27.69092523530989, -1003.4806598264222, -140.30789943842512, -616.9209238135539, -796.3149529763323, -545.1355472025641, 32.90849543296736, -456.37160528652475, -371.5995245654865, -223.76169051069425, -218.46462666978024, 384.5825037617225, -455.4498019327936, -782.8638258441715, -793.8143007939683, -483.790623765417, -1408.861358090592, -154.9395705626469, -542.4225345167971, -531.2762172355294, -614.9584611490643, -751.1146148641301, -543.1134090330861, -113.03127238701634, -538.7909495882844, -881.2917929508606, -669.551988267837, -675.6575747860553, 27.073017717903088, -472.22587123693563, -415.89166604804063, -30.591940310001696, -875.5890659526416, -428.8248205489195, -783.8788238262249, -998.4101471361921, -111.66199376362877, 365.7158901450151, -23.677505533706473, -13.442896108207643, -574.4935856602915, -1053.2066119328354, -680.2090891506535, -609.702516488712, -269.316245888413, -375.58214926465706, -1029.443458299071, -267.82790572612043, -999.5491218907987, -510.0996775883865, -133.1771784562321, -1126.5527732848436, -31.276479265478272, -179.5097940972935, 325.82976134261617, -58.75670739441431, -895.7331980693631, -8.65837464255911, -396.22742318744105, -288.4901336786529, -801.0232581848703, -175.74508183772056, -344.1495594834421, -477.2618027972046, -207.25887856563088, -369.32481193876816, -276.30106858966155, -736.2326303682684, -414.0402398234288, -477.49828092471574, -784.4632696739726, -1334.0066268899452, -976.1909987780141, -1135.7779918991914, -514.8488302759337, -187.83138477350207, -717.2043307063785, -855.8343017046111, 350.1726814658714, 385.7190585059827, -8.643751554604368, -197.8784512309034, -305.0321900819431, -460.6753263040774, -955.6088795211516, -1340.9198463420219, -941.9355285486618, -98.38541279995762, -968.6622355686969, -822.9481157414382, 383.8173887239609, 40.0000000000003, -590.8666441102439, -1315.534284093637, -1156.2586997529802, -572.7790393183333, -145.36422535178457, -684.0812401875436, -1042.9525813269652, -670.9603731397058, -204.08036262789227, -623.3025897281823, -1272.1911056679717, -169.8839294891269, -1187.0961684633733, -1618.2914975960452, -784.1613337513421, -730.5873580299714, -324.77654978570706, -439.05055073759985, -685.0042983806068, -416.566376073151, -711.4734614223246, -246.8262556075199, -205.19908637936334, -643.341854102956, -242.56854921505663, 295.5463519833289, -401.0598884433674, -772.8358780316051, 331.2473477587989, -843.4365767396605, 8.31966140961298, -82.34552898553505, -1057.2512993337625, -337.952313148858, -583.9679431397345, -926.0754186918373, -891.7674503600697, 36.59463038142586, -414.4091568776721, -473.15358737814506, -612.2001387579373], "policy_predator_policy_reward": [643.7766711444621, 994.1085047546762, 1115.6034930319736, 631.8672743174525, 1053.7976451418012, 845.8320427612732, 478.64840795117726, 300.16015570135903, 1217.76961292611, 5.030346263108996, 966.3675830414295, 272.628904924743, 1138.4889679013327, 845.8242687130924, 688.6561809826625, 911.4325584078658, 909.9401655162005, 1395.4460923743893, 1068.3901596224587, 409.62598799703653, 1035.3495972010599, 1264.1602102200918, 952.8988986691774, 481.0508580346194, 947.2278738536447, 867.908527013628, 309.5160621002022, 575.0476734592273, 1000.3651664474985, 728.6131317006116, 15.027290749485683, 142.7130893683502, 1200.2093249606257, 465.141096304285, 446.9063312797461, 1076.1252735425012, 917.4736541447118, 976.2932562466282, 897.6070588883344, 1000.6155769253234, 950.7125732663287, 276.105857223749, 818.4250155312367, 887.1796691132831, 708.5222036667952, 901.4068547660241, 1289.4308162583989, 35.93786522731754, 192.97600122877276, 798.3414107478663, 909.1127925364445, 999.3553744423865, 551.7840898160638, 566.3929173518746, 678.6600252044362, 107.97814935887025, 984.8435909459012, 770.3128303003396, 156.28677582695755, 963.122129481641, 802.1599396083964, 602.5842007880093, 562.640278258001, 307.4561180013503, 210.81862635778376, 666.3732493487996, 392.64313893103645, 166.63799893682398, 919.2373480859133, 488.1719471784144, 523.7114979326362, 814.5984074278059, 33.985828197824866, 658.891310110541, 655.5877487040952, 459.7608352310868, 240.01945334388296, 297.7906412861313, 0.8483022659694665, 472.1498019327971, 886.3992320250835, 701.1646266135936, 1307.3853921324555, 823.5417135459127, 61.634709770042875, 743.4966381955413, 703.0665814551104, 517.6719084496925, 973.7036655410006, 551.117647728026, 292.84061111626033, 502.5098406029496, 930.8975348485955, 617.4570703538702, 695.4575747860573, 16.971946502530752, 636.0340230273126, 397.19660749427965, 37.81962727005034, 883.2236871982542, 981.2349103908549, 307.16377689556384, 493.0080634709877, 805.1406358533035, 7.2841098549848535, 59.37750553370698, 269.78343268437817, 532.6329748408463, 1034.1991566129757, 879.2358118395165, 630.9195069733198, 362.1677032409263, 1093.790743332764, 398.25649744711035, 292.32790572612026, 1000.6491218907988, 533.6314179721568, 143.9997561364086, 1024.656412511655, 824.5445866400145, 206.80979409729204, 10.270238657383818, 582.0183978716653, 574.7225206955042, 283.41156944901275, 417.79206014529234, 573.7277073608672, 797.6007225559239, 221.0004082007864, 352.8830124593988, 593.7116764300981, 448.96217942452995, 0.0, 654.2937810526647, 914.1068885818503, 664.9581542449513, 537.247023566269, 810.0999314420037, 1340.0052965442617, 978.3909987780141, 1050.9521286796999, 887.1316792546535, 37.08176033199851, 829.0712309064065, 855.2881052856418, 52.49111395500784, 7.280941494017313, 164.343751554604, 334.81852099182294, 328.8273988364459, 478.07532630408133, 967.3088795211515, 1346.011794102351, 944.3355285486622, 732.6030703543199, 462.3357963225379, 793.225532281789, 101.58943387998501, 485.65812407121996, 467.51104061757803, 1316.734284093637, 1154.2533742074088, 198.25764535801986, 645.9401214124612, 686.3812401875442, 1047.4525813269656, 721.5669937649111, 257.48150576118985, 949.1081588623247, 1185.8084061444256, 196.2839294891254, 1192.6961684633734, 1622.7914975960452, 790.204762515614, 722.084192057361, 557.6139622475046, 625.7168255348638, 741.6015667392675, 282.94860414226576, 909.9210561418676, 196.17186686345133, 300.9686721677135, 615.0772410931152, 689.2156028360773, 216.34594913051336, 401.3349115130941, 47.98644289718226, 761.5235363488717, 356.6070871420979, 607.94572994798, 481.4280723843025, 905.7382203917795, 878.3102406043971, 26.517392003622973, 1065.621243026604, 869.6588873506576, 51.484147593601556, 488.44663542885684, 620.0981057910708, 650.543071132249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.893057810568718, "mean_inference_ms": 4.49297770948844, "mean_action_processing_ms": 1.5717681423575989, "mean_env_wait_ms": 10.463995299096753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014281392097473145, "StateBufferConnector_ms": 0.004055380821228027, "ViewRequirementAgentConnector_ms": 0.1499110460281372}, "num_episodes": 3, "episode_return_max": 714.8054360274436, "episode_return_min": -74.9259714294466, "episode_return_mean": 193.45715288070147, "episodes_this_iter": 3}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.76888820532587, "num_env_steps_trained_throughput_per_sec": 79.76888820532587, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 50299.71, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50299.605, "sample_time_ms": 2422.891, "learn_time_ms": 47855.485, "learn_throughput": 83.585, "synch_weights_time_ms": 17.855}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "35fb9_00000", "date": "2024-08-22_08-42-46", "timestamp": 1724296366, "time_this_iter_s": 50.1774787902832, "time_total_s": 2944.3451833724976, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcd9e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2944.3451833724976, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 31.319444444444443, "ram_util_percent": 82.99861111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.15772899786631, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.968704067210041, "policy_loss": -0.020470849640307723, "vf_loss": 5.986780968166533, "vf_explained_var": 0.6116605305167102, "kl": 0.011969688013146716, "entropy": 0.6312507227142021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.078391732740654, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.565358516652748, "policy_loss": -0.01955942268774071, "vf_loss": 6.582361135785542, "vf_explained_var": 0.2433270242163744, "kl": 0.012784053153043031, "entropy": 0.5486517218527971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 691.3717466013524, "episode_reward_min": -74.9259714294466, "episode_reward_mean": 187.27483518092777, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1618.2914975960452, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 385.7190585059827, "predator_policy": 1622.7914975960452}, "policy_reward_mean": {"prey_policy": -532.8559085922977, "predator_policy": 626.4933261827623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [631.8871286952602, 5.893220215258989, 346.73322902012944, 612.9744693828698, 286.3000000000038, 421.1536563924208, -9.744421301678223, 118.9503671729292, 81.2113623543525, 36.30000000000022, 170.66294219547282, 477.3265814254534, 70.0570741354955, 83.18188886652055, 19.092297314080348, 334.7334584708073, 54.983659285232314, 437.50624052569907, 403.06292618422697, 6.439218785909347, 77.21047540648304, 414.66276496470067, 200.8050182075983, 263.6207359994834, -74.9259714294466, 180.65008653876833, 287.37745408316965, 95.58377744954092, 402.1308060276948, 10.88573200053634, 238.27512382235275, 107.769242886139, 74.50381152020552, 230.59328937180305, 143.52822974390767, -2.4891760162368755, 63.84496422043412, 145.11309323661234, 14.862308205661186, 75.6950429112666, 188.07655842447008, 408.7000000000022, 214.47992575672214, 180.0192673690004, 114.06844783711803, 87.0216332161416, 25.600000000000087, 34.35431806394472, 691.3717466013524, 363.4000000000009, 202.25101310339332, 296.31783176430025, 281.8150380532654, 53.988779339019, 358.15317449179264, 8.66790052423426, 428.7921726351028, 85.38540440958502, 8.198669654316648, 287.4569857592227, -38.882724241478364, 402.11759900190975, 548.7000000000023, 160.73527851541937, 29.100000000000144, 7.49194776032925, 127.8912183082054, 455.68423914429485, 402.30252057855836, -0.8053255455714403, 126.05450210035667, 6.799999999999997, 104.0077637585006, 239.42286961059196, 32.0000000000002, 10.543428764270935, 224.33424648918736, 243.26354315591993, 64.82982278865651, 45.11519704428133, 418.38244061117945, 512.167324183569, 367.9214489732478, 129.43590176003107, 247.56946445678304, -17.092623680576814, 117.43726132535139, 162.1162565262091, 185.28745078723233, 82.82100496010477, 62.258314117633724, 302.6753800873844, 17.872810533516372, 83.15571922446195, 19.00630587783896, 25.83019981987438, 538.4484326096551, 55.86837627487466, 213.2915518655908, 155.80339527127927], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [196.8229105611189, -998.8855385696554, -949.4821126412658, -859.7610680107471, -243.02380108932599, -294.8067054499716, -1146.27737721158, 30.273548446340133, -105.7433190651669, 234.3029389473304, -1261.5606820365097, 17.36391716401435, -590.3144329872397, -942.4615931366825, -785.4280534497177, -989.3884897686911, -638.0099149417459, -1179.0013585175618, -945.7125732663287, -244.80585722374508, -608.2754714380354, -926.6662710110038, -77.0141018647871, -1055.5883751425804, -1289.4308162583989, 34.11920890817794, -426.2523339943946, -481.8831891157203, -713.9759692852524, -1175.3999003794936, -614.1290764778548, -169.3144722192811, -695.4085296670885, -36.24598561098494, -1094.7428234025222, -222.90735731802266, 277.85721410764523, -994.203193232017, -612.3274634529313, -785.9774581575616, -544.725299416091, -248.16062143677405, -603.18566935651, 140.65655861462784, -386.1670448955635, 27.69092523530989, -1003.4806598264222, -140.30789943842512, -616.9209238135539, -796.3149529763323, -545.1355472025641, 32.90849543296736, -456.37160528652475, -371.5995245654865, -223.76169051069425, -218.46462666978024, 384.5825037617225, -455.4498019327936, -782.8638258441715, -793.8143007939683, -483.790623765417, -1408.861358090592, -154.9395705626469, -542.4225345167971, -531.2762172355294, -614.9584611490643, -751.1146148641301, -543.1134090330861, -113.03127238701634, -538.7909495882844, -881.2917929508606, -669.551988267837, -675.6575747860553, 27.073017717903088, -472.22587123693563, -415.89166604804063, -30.591940310001696, -875.5890659526416, -428.8248205489195, -783.8788238262249, -998.4101471361921, -111.66199376362877, 365.7158901450151, -23.677505533706473, -13.442896108207643, -574.4935856602915, -1053.2066119328354, -680.2090891506535, -609.702516488712, -269.316245888413, -375.58214926465706, -1029.443458299071, -267.82790572612043, -999.5491218907987, -510.0996775883865, -133.1771784562321, -1126.5527732848436, -31.276479265478272, -179.5097940972935, 325.82976134261617, -58.75670739441431, -895.7331980693631, -8.65837464255911, -396.22742318744105, -288.4901336786529, -801.0232581848703, -175.74508183772056, -344.1495594834421, -477.2618027972046, -207.25887856563088, -369.32481193876816, -276.30106858966155, -736.2326303682684, -414.0402398234288, -477.49828092471574, -784.4632696739726, -1334.0066268899452, -976.1909987780141, -1135.7779918991914, -514.8488302759337, -187.83138477350207, -717.2043307063785, -855.8343017046111, 350.1726814658714, 385.7190585059827, -8.643751554604368, -197.8784512309034, -305.0321900819431, -460.6753263040774, -955.6088795211516, -1340.9198463420219, -941.9355285486618, -98.38541279995762, -968.6622355686969, -822.9481157414382, 383.8173887239609, 40.0000000000003, -590.8666441102439, -1315.534284093637, -1156.2586997529802, -572.7790393183333, -145.36422535178457, -684.0812401875436, -1042.9525813269652, -670.9603731397058, -204.08036262789227, -623.3025897281823, -1272.1911056679717, -169.8839294891269, -1187.0961684633733, -1618.2914975960452, -784.1613337513421, -730.5873580299714, -324.77654978570706, -439.05055073759985, -685.0042983806068, -416.566376073151, -711.4734614223246, -246.8262556075199, -205.19908637936334, -643.341854102956, -242.56854921505663, 295.5463519833289, -401.0598884433674, -772.8358780316051, 331.2473477587989, -843.4365767396605, 8.31966140961298, -82.34552898553505, -1057.2512993337625, -337.952313148858, -583.9679431397345, -926.0754186918373, -891.7674503600697, 36.59463038142586, -414.4091568776721, -473.15358737814506, -612.2001387579373, -244.09905124178266, -440.1409788068478, -1062.8211128331263, 31.760394717823313, -1336.210872996541, 28.50818046983852, -666.3075762572728, -769.2452310175137, -87.57151831845623, -1065.8497820408309, -512.7521623190185, -591.3968733199001, -1510.0985030582299, -805.0266785266637, -1170.853573388443, 17.93455118094652, -561.0630092950375, -1160.481164069238, -889.8947007046115, -780.3767218126286, -633.8296924211569, -1430.7057928907984], "policy_predator_policy_reward": [952.8988986691774, 481.0508580346194, 947.2278738536447, 867.908527013628, 309.5160621002022, 575.0476734592273, 1000.3651664474985, 728.6131317006116, 15.027290749485683, 142.7130893683502, 1200.2093249606257, 465.141096304285, 446.9063312797461, 1076.1252735425012, 917.4736541447118, 976.2932562466282, 897.6070588883344, 1000.6155769253234, 950.7125732663287, 276.105857223749, 818.4250155312367, 887.1796691132831, 708.5222036667952, 901.4068547660241, 1289.4308162583989, 35.93786522731754, 192.97600122877276, 798.3414107478663, 909.1127925364445, 999.3553744423865, 551.7840898160638, 566.3929173518746, 678.6600252044362, 107.97814935887025, 984.8435909459012, 770.3128303003396, 156.28677582695755, 963.122129481641, 802.1599396083964, 602.5842007880093, 562.640278258001, 307.4561180013503, 210.81862635778376, 666.3732493487996, 392.64313893103645, 166.63799893682398, 919.2373480859133, 488.1719471784144, 523.7114979326362, 814.5984074278059, 33.985828197824866, 658.891310110541, 655.5877487040952, 459.7608352310868, 240.01945334388296, 297.7906412861313, 0.8483022659694665, 472.1498019327971, 886.3992320250835, 701.1646266135936, 1307.3853921324555, 823.5417135459127, 61.634709770042875, 743.4966381955413, 703.0665814551104, 517.6719084496925, 973.7036655410006, 551.117647728026, 292.84061111626033, 502.5098406029496, 930.8975348485955, 617.4570703538702, 695.4575747860573, 16.971946502530752, 636.0340230273126, 397.19660749427965, 37.81962727005034, 883.2236871982542, 981.2349103908549, 307.16377689556384, 493.0080634709877, 805.1406358533035, 7.2841098549848535, 59.37750553370698, 269.78343268437817, 532.6329748408463, 1034.1991566129757, 879.2358118395165, 630.9195069733198, 362.1677032409263, 1093.790743332764, 398.25649744711035, 292.32790572612026, 1000.6491218907988, 533.6314179721568, 143.9997561364086, 1024.656412511655, 824.5445866400145, 206.80979409729204, 10.270238657383818, 582.0183978716653, 574.7225206955042, 283.41156944901275, 417.79206014529234, 573.7277073608672, 797.6007225559239, 221.0004082007864, 352.8830124593988, 593.7116764300981, 448.96217942452995, 0.0, 654.2937810526647, 914.1068885818503, 664.9581542449513, 537.247023566269, 810.0999314420037, 1340.0052965442617, 978.3909987780141, 1050.9521286796999, 887.1316792546535, 37.08176033199851, 829.0712309064065, 855.2881052856418, 52.49111395500784, 7.280941494017313, 164.343751554604, 334.81852099182294, 328.8273988364459, 478.07532630408133, 967.3088795211515, 1346.011794102351, 944.3355285486622, 732.6030703543199, 462.3357963225379, 793.225532281789, 101.58943387998501, 485.65812407121996, 467.51104061757803, 1316.734284093637, 1154.2533742074088, 198.25764535801986, 645.9401214124612, 686.3812401875442, 1047.4525813269656, 721.5669937649111, 257.48150576118985, 949.1081588623247, 1185.8084061444256, 196.2839294891254, 1192.6961684633734, 1622.7914975960452, 790.204762515614, 722.084192057361, 557.6139622475046, 625.7168255348638, 741.6015667392675, 282.94860414226576, 909.9210561418676, 196.17186686345133, 300.9686721677135, 615.0772410931152, 689.2156028360773, 216.34594913051336, 401.3349115130941, 47.98644289718226, 761.5235363488717, 356.6070871420979, 607.94572994798, 481.4280723843025, 905.7382203917795, 878.3102406043971, 26.517392003622973, 1065.621243026604, 869.6588873506576, 51.484147593601556, 488.44663542885684, 620.0981057910708, 650.543071132249, 767.0610350087361, 0.0, 1071.0933841388085, 22.225648094128445, 854.8722992294297, 755.5057733846546, 535.9441337626467, 917.4814840456614, 162.08316922962808, 1074.4938503541198, 525.6732975366933, 597.4820439800668, 1492.03641472082, 848.9189666839465, 1069.9738784815984, 621.3935763355485, 683.2841540055279, 1094.1283956336206, 799.4869723006401, 1084.076002082196, 843.5048324077625, 1376.8340481754692]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.881163414643065, "mean_inference_ms": 4.465431457225052, "mean_action_processing_ms": 1.5707607948661535, "mean_env_wait_ms": 10.437919248426681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014378666877746582, "StateBufferConnector_ms": 0.004740238189697266, "ViewRequirementAgentConnector_ms": 0.17148149013519287}, "num_episodes": 11, "episode_return_max": 691.3717466013524, "episode_return_min": -74.9259714294466, "episode_return_mean": 187.27483518092777, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.03801969282046, "num_env_steps_trained_throughput_per_sec": 80.03801969282046, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 50289.239, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50289.13, "sample_time_ms": 2315.963, "learn_time_ms": 47952.301, "learn_throughput": 83.416, "synch_weights_time_ms": 17.336}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "35fb9_00000", "date": "2024-08-22_08-43-36", "timestamp": 1724296416, "time_this_iter_s": 50.02082395553589, "time_total_s": 2994.3660073280334, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0f73a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2994.3660073280334, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 28.87323943661972, "ram_util_percent": 83.01267605633802}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.554427676352244, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.3206384613400415, "policy_loss": -0.0194227473583644, "vf_loss": 6.337996942277939, "vf_explained_var": 0.6027011835385883, "kl": 0.010321378731168807, "entropy": 0.6293721003664865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.895430160704112, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.7279067475959735, "policy_loss": -0.016543522407916723, "vf_loss": 6.7421677904785, "vf_explained_var": 0.18662782834951208, "kl": 0.011412362514738802, "entropy": 0.5337750811425467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 970.4875000000028}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 691.3717466013524, "episode_reward_min": -74.9259714294466, "episode_reward_mean": 180.99704812665723, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1618.2914975960452, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 385.7190585059827, "predator_policy": 1622.7914975960452}, "policy_reward_mean": {"prey_policy": -523.5411479024374, "predator_policy": 614.0396719657666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.66294219547282, 477.3265814254534, 70.0570741354955, 83.18188886652055, 19.092297314080348, 334.7334584708073, 54.983659285232314, 437.50624052569907, 403.06292618422697, 6.439218785909347, 77.21047540648304, 414.66276496470067, 200.8050182075983, 263.6207359994834, -74.9259714294466, 180.65008653876833, 287.37745408316965, 95.58377744954092, 402.1308060276948, 10.88573200053634, 238.27512382235275, 107.769242886139, 74.50381152020552, 230.59328937180305, 143.52822974390767, -2.4891760162368755, 63.84496422043412, 145.11309323661234, 14.862308205661186, 75.6950429112666, 188.07655842447008, 408.7000000000022, 214.47992575672214, 180.0192673690004, 114.06844783711803, 87.0216332161416, 25.600000000000087, 34.35431806394472, 691.3717466013524, 363.4000000000009, 202.25101310339332, 296.31783176430025, 281.8150380532654, 53.988779339019, 358.15317449179264, 8.66790052423426, 428.7921726351028, 85.38540440958502, 8.198669654316648, 287.4569857592227, -38.882724241478364, 402.11759900190975, 548.7000000000023, 160.73527851541937, 29.100000000000144, 7.49194776032925, 127.8912183082054, 455.68423914429485, 402.30252057855836, -0.8053255455714403, 126.05450210035667, 6.799999999999997, 104.0077637585006, 239.42286961059196, 32.0000000000002, 10.543428764270935, 224.33424648918736, 243.26354315591993, 64.82982278865651, 45.11519704428133, 418.38244061117945, 512.167324183569, 367.9214489732478, 129.43590176003107, 247.56946445678304, -17.092623680576814, 117.43726132535139, 162.1162565262091, 185.28745078723233, 82.82100496010477, 62.258314117633724, 302.6753800873844, 17.872810533516372, 83.15571922446195, 19.00630587783896, 25.83019981987438, 538.4484326096551, 55.86837627487466, 213.2915518655908, 155.80339527127927, 395.424225916999, 203.57657085036848, 500.61393985612756, 67.70000000000043, 48.10000000000004, 43.364054810029174, 155.81192773793072, 70.93490298568737, 7.846348668216047, 410.50833567913384], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-608.2754714380354, -926.6662710110038, -77.0141018647871, -1055.5883751425804, -1289.4308162583989, 34.11920890817794, -426.2523339943946, -481.8831891157203, -713.9759692852524, -1175.3999003794936, -614.1290764778548, -169.3144722192811, -695.4085296670885, -36.24598561098494, -1094.7428234025222, -222.90735731802266, 277.85721410764523, -994.203193232017, -612.3274634529313, -785.9774581575616, -544.725299416091, -248.16062143677405, -603.18566935651, 140.65655861462784, -386.1670448955635, 27.69092523530989, -1003.4806598264222, -140.30789943842512, -616.9209238135539, -796.3149529763323, -545.1355472025641, 32.90849543296736, -456.37160528652475, -371.5995245654865, -223.76169051069425, -218.46462666978024, 384.5825037617225, -455.4498019327936, -782.8638258441715, -793.8143007939683, -483.790623765417, -1408.861358090592, -154.9395705626469, -542.4225345167971, -531.2762172355294, -614.9584611490643, -751.1146148641301, -543.1134090330861, -113.03127238701634, -538.7909495882844, -881.2917929508606, -669.551988267837, -675.6575747860553, 27.073017717903088, -472.22587123693563, -415.89166604804063, -30.591940310001696, -875.5890659526416, -428.8248205489195, -783.8788238262249, -998.4101471361921, -111.66199376362877, 365.7158901450151, -23.677505533706473, -13.442896108207643, -574.4935856602915, -1053.2066119328354, -680.2090891506535, -609.702516488712, -269.316245888413, -375.58214926465706, -1029.443458299071, -267.82790572612043, -999.5491218907987, -510.0996775883865, -133.1771784562321, -1126.5527732848436, -31.276479265478272, -179.5097940972935, 325.82976134261617, -58.75670739441431, -895.7331980693631, -8.65837464255911, -396.22742318744105, -288.4901336786529, -801.0232581848703, -175.74508183772056, -344.1495594834421, -477.2618027972046, -207.25887856563088, -369.32481193876816, -276.30106858966155, -736.2326303682684, -414.0402398234288, -477.49828092471574, -784.4632696739726, -1334.0066268899452, -976.1909987780141, -1135.7779918991914, -514.8488302759337, -187.83138477350207, -717.2043307063785, -855.8343017046111, 350.1726814658714, 385.7190585059827, -8.643751554604368, -197.8784512309034, -305.0321900819431, -460.6753263040774, -955.6088795211516, -1340.9198463420219, -941.9355285486618, -98.38541279995762, -968.6622355686969, -822.9481157414382, 383.8173887239609, 40.0000000000003, -590.8666441102439, -1315.534284093637, -1156.2586997529802, -572.7790393183333, -145.36422535178457, -684.0812401875436, -1042.9525813269652, -670.9603731397058, -204.08036262789227, -623.3025897281823, -1272.1911056679717, -169.8839294891269, -1187.0961684633733, -1618.2914975960452, -784.1613337513421, -730.5873580299714, -324.77654978570706, -439.05055073759985, -685.0042983806068, -416.566376073151, -711.4734614223246, -246.8262556075199, -205.19908637936334, -643.341854102956, -242.56854921505663, 295.5463519833289, -401.0598884433674, -772.8358780316051, 331.2473477587989, -843.4365767396605, 8.31966140961298, -82.34552898553505, -1057.2512993337625, -337.952313148858, -583.9679431397345, -926.0754186918373, -891.7674503600697, 36.59463038142586, -414.4091568776721, -473.15358737814506, -612.2001387579373, -244.09905124178266, -440.1409788068478, -1062.8211128331263, 31.760394717823313, -1336.210872996541, 28.50818046983852, -666.3075762572728, -769.2452310175137, -87.57151831845623, -1065.8497820408309, -512.7521623190185, -591.3968733199001, -1510.0985030582299, -805.0266785266637, -1170.853573388443, 17.93455118094652, -561.0630092950375, -1160.481164069238, -889.8947007046115, -780.3767218126286, -633.8296924211569, -1430.7057928907984, -666.3676043930675, 38.87309893315555, -11.95795516451519, -1066.0858387599528, 372.84562593224126, -136.42888657291098, -144.25615151915105, 37.59525040003331, -560.8074706848032, -925.1338124706092, -1137.899530608858, -458.0200903977928, -644.7746614816679, -268.7130348916557, -395.2927282582562, -972.1176267533086, -789.8038051744696, -642.1292886912091, -554.4812497944946, -907.9916639237484], "policy_predator_policy_reward": [818.4250155312367, 887.1796691132831, 708.5222036667952, 901.4068547660241, 1289.4308162583989, 35.93786522731754, 192.97600122877276, 798.3414107478663, 909.1127925364445, 999.3553744423865, 551.7840898160638, 566.3929173518746, 678.6600252044362, 107.97814935887025, 984.8435909459012, 770.3128303003396, 156.28677582695755, 963.122129481641, 802.1599396083964, 602.5842007880093, 562.640278258001, 307.4561180013503, 210.81862635778376, 666.3732493487996, 392.64313893103645, 166.63799893682398, 919.2373480859133, 488.1719471784144, 523.7114979326362, 814.5984074278059, 33.985828197824866, 658.891310110541, 655.5877487040952, 459.7608352310868, 240.01945334388296, 297.7906412861313, 0.8483022659694665, 472.1498019327971, 886.3992320250835, 701.1646266135936, 1307.3853921324555, 823.5417135459127, 61.634709770042875, 743.4966381955413, 703.0665814551104, 517.6719084496925, 973.7036655410006, 551.117647728026, 292.84061111626033, 502.5098406029496, 930.8975348485955, 617.4570703538702, 695.4575747860573, 16.971946502530752, 636.0340230273126, 397.19660749427965, 37.81962727005034, 883.2236871982542, 981.2349103908549, 307.16377689556384, 493.0080634709877, 805.1406358533035, 7.2841098549848535, 59.37750553370698, 269.78343268437817, 532.6329748408463, 1034.1991566129757, 879.2358118395165, 630.9195069733198, 362.1677032409263, 1093.790743332764, 398.25649744711035, 292.32790572612026, 1000.6491218907988, 533.6314179721568, 143.9997561364086, 1024.656412511655, 824.5445866400145, 206.80979409729204, 10.270238657383818, 582.0183978716653, 574.7225206955042, 283.41156944901275, 417.79206014529234, 573.7277073608672, 797.6007225559239, 221.0004082007864, 352.8830124593988, 593.7116764300981, 448.96217942452995, 0.0, 654.2937810526647, 914.1068885818503, 664.9581542449513, 537.247023566269, 810.0999314420037, 1340.0052965442617, 978.3909987780141, 1050.9521286796999, 887.1316792546535, 37.08176033199851, 829.0712309064065, 855.2881052856418, 52.49111395500784, 7.280941494017313, 164.343751554604, 334.81852099182294, 328.8273988364459, 478.07532630408133, 967.3088795211515, 1346.011794102351, 944.3355285486622, 732.6030703543199, 462.3357963225379, 793.225532281789, 101.58943387998501, 485.65812407121996, 467.51104061757803, 1316.734284093637, 1154.2533742074088, 198.25764535801986, 645.9401214124612, 686.3812401875442, 1047.4525813269656, 721.5669937649111, 257.48150576118985, 949.1081588623247, 1185.8084061444256, 196.2839294891254, 1192.6961684633734, 1622.7914975960452, 790.204762515614, 722.084192057361, 557.6139622475046, 625.7168255348638, 741.6015667392675, 282.94860414226576, 909.9210561418676, 196.17186686345133, 300.9686721677135, 615.0772410931152, 689.2156028360773, 216.34594913051336, 401.3349115130941, 47.98644289718226, 761.5235363488717, 356.6070871420979, 607.94572994798, 481.4280723843025, 905.7382203917795, 878.3102406043971, 26.517392003622973, 1065.621243026604, 869.6588873506576, 51.484147593601556, 488.44663542885684, 620.0981057910708, 650.543071132249, 767.0610350087361, 0.0, 1071.0933841388085, 22.225648094128445, 854.8722992294297, 755.5057733846546, 535.9441337626467, 917.4814840456614, 162.08316922962808, 1074.4938503541198, 525.6732975366933, 597.4820439800668, 1492.03641472082, 848.9189666839465, 1069.9738784815984, 621.3935763355485, 683.2841540055279, 1094.1283956336206, 799.4869723006401, 1084.076002082196, 843.5048324077625, 1376.8340481754692, 429.82538711482016, 593.0933442620857, 461.27294380988917, 820.3474209649467, 130.08525853851484, 134.1119419582766, 172.15615151914946, 2.2047495999669566, 898.8972514412469, 635.1440317141688, 1135.0585518926032, 504.2251239240798, 435.4626792684199, 633.8369448428386, 491.3123719029803, 947.032886094276, 795.8145893714812, 643.9648531624147, 839.9274745298362, 1033.0537748675397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8667339767957465, "mean_inference_ms": 4.447595249369331, "mean_action_processing_ms": 1.5619550344972282, "mean_env_wait_ms": 10.430053824976058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014277219772338867, "StateBufferConnector_ms": 0.004747152328491211, "ViewRequirementAgentConnector_ms": 0.17295515537261963}, "num_episodes": 10, "episode_return_max": 691.3717466013524, "episode_return_min": -74.9259714294466, "episode_return_mean": 180.99704812665723, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.52352300430621, "num_env_steps_trained_throughput_per_sec": 81.52352300430621, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 50027.935, "restore_workers_time_ms": 0.013, "training_step_time_ms": 50027.828, "sample_time_ms": 2352.472, "learn_time_ms": 47654.175, "learn_throughput": 83.938, "synch_weights_time_ms": 17.332}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "35fb9_00000", "date": "2024-08-22_08-44-25", "timestamp": 1724296465, "time_this_iter_s": 49.1165771484375, "time_total_s": 3043.482584476471, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc894c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3043.482584476471, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 28.474285714285713, "ram_util_percent": 82.6557142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.355169140977203, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.0301669057714875, "policy_loss": -0.025336756014570635, "vf_loss": 6.0531105215587315, "vf_explained_var": 0.6211735064390476, "kl": 0.011965639542950879, "entropy": 0.6355743920519239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.384795161277529, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.45379619875913, "policy_loss": -0.018980702031871906, "vf_loss": 6.470209034914693, "vf_explained_var": 0.34150174569200586, "kl": 0.01283933668811288, "entropy": 0.5560422842622434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 691.3717466013524, "episode_reward_min": -74.9259714294466, "episode_reward_mean": 170.46838182853458, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1618.2914975960452, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 385.7190585059827, "predator_policy": 1622.7914975960452}, "policy_reward_mean": {"prey_policy": -526.7519121352263, "predator_policy": 611.9861030494943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [414.66276496470067, 200.8050182075983, 263.6207359994834, -74.9259714294466, 180.65008653876833, 287.37745408316965, 95.58377744954092, 402.1308060276948, 10.88573200053634, 238.27512382235275, 107.769242886139, 74.50381152020552, 230.59328937180305, 143.52822974390767, -2.4891760162368755, 63.84496422043412, 145.11309323661234, 14.862308205661186, 75.6950429112666, 188.07655842447008, 408.7000000000022, 214.47992575672214, 180.0192673690004, 114.06844783711803, 87.0216332161416, 25.600000000000087, 34.35431806394472, 691.3717466013524, 363.4000000000009, 202.25101310339332, 296.31783176430025, 281.8150380532654, 53.988779339019, 358.15317449179264, 8.66790052423426, 428.7921726351028, 85.38540440958502, 8.198669654316648, 287.4569857592227, -38.882724241478364, 402.11759900190975, 548.7000000000023, 160.73527851541937, 29.100000000000144, 7.49194776032925, 127.8912183082054, 455.68423914429485, 402.30252057855836, -0.8053255455714403, 126.05450210035667, 6.799999999999997, 104.0077637585006, 239.42286961059196, 32.0000000000002, 10.543428764270935, 224.33424648918736, 243.26354315591993, 64.82982278865651, 45.11519704428133, 418.38244061117945, 512.167324183569, 367.9214489732478, 129.43590176003107, 247.56946445678304, -17.092623680576814, 117.43726132535139, 162.1162565262091, 185.28745078723233, 82.82100496010477, 62.258314117633724, 302.6753800873844, 17.872810533516372, 83.15571922446195, 19.00630587783896, 25.83019981987438, 538.4484326096551, 55.86837627487466, 213.2915518655908, 155.80339527127927, 395.424225916999, 203.57657085036848, 500.61393985612756, 67.70000000000043, 48.10000000000004, 43.364054810029174, 155.81192773793072, 70.93490298568737, 7.846348668216047, 410.50833567913384, 44.210992599135075, 282.7929938478636, 105.58469438907275, 94.34429649450156, 166.2007695369835, 72.54720485461672, 17.099999999999984, -12.326855335955202, 80.42821678456687, 42.96960586306087, 187.5382137492661], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-603.18566935651, 140.65655861462784, -386.1670448955635, 27.69092523530989, -1003.4806598264222, -140.30789943842512, -616.9209238135539, -796.3149529763323, -545.1355472025641, 32.90849543296736, -456.37160528652475, -371.5995245654865, -223.76169051069425, -218.46462666978024, 384.5825037617225, -455.4498019327936, -782.8638258441715, -793.8143007939683, -483.790623765417, -1408.861358090592, -154.9395705626469, -542.4225345167971, -531.2762172355294, -614.9584611490643, -751.1146148641301, -543.1134090330861, -113.03127238701634, -538.7909495882844, -881.2917929508606, -669.551988267837, -675.6575747860553, 27.073017717903088, -472.22587123693563, -415.89166604804063, -30.591940310001696, -875.5890659526416, -428.8248205489195, -783.8788238262249, -998.4101471361921, -111.66199376362877, 365.7158901450151, -23.677505533706473, -13.442896108207643, -574.4935856602915, -1053.2066119328354, -680.2090891506535, -609.702516488712, -269.316245888413, -375.58214926465706, -1029.443458299071, -267.82790572612043, -999.5491218907987, -510.0996775883865, -133.1771784562321, -1126.5527732848436, -31.276479265478272, -179.5097940972935, 325.82976134261617, -58.75670739441431, -895.7331980693631, -8.65837464255911, -396.22742318744105, -288.4901336786529, -801.0232581848703, -175.74508183772056, -344.1495594834421, -477.2618027972046, -207.25887856563088, -369.32481193876816, -276.30106858966155, -736.2326303682684, -414.0402398234288, -477.49828092471574, -784.4632696739726, -1334.0066268899452, -976.1909987780141, -1135.7779918991914, -514.8488302759337, -187.83138477350207, -717.2043307063785, -855.8343017046111, 350.1726814658714, 385.7190585059827, -8.643751554604368, -197.8784512309034, -305.0321900819431, -460.6753263040774, -955.6088795211516, -1340.9198463420219, -941.9355285486618, -98.38541279995762, -968.6622355686969, -822.9481157414382, 383.8173887239609, 40.0000000000003, -590.8666441102439, -1315.534284093637, -1156.2586997529802, -572.7790393183333, -145.36422535178457, -684.0812401875436, -1042.9525813269652, -670.9603731397058, -204.08036262789227, -623.3025897281823, -1272.1911056679717, -169.8839294891269, -1187.0961684633733, -1618.2914975960452, -784.1613337513421, -730.5873580299714, -324.77654978570706, -439.05055073759985, -685.0042983806068, -416.566376073151, -711.4734614223246, -246.8262556075199, -205.19908637936334, -643.341854102956, -242.56854921505663, 295.5463519833289, -401.0598884433674, -772.8358780316051, 331.2473477587989, -843.4365767396605, 8.31966140961298, -82.34552898553505, -1057.2512993337625, -337.952313148858, -583.9679431397345, -926.0754186918373, -891.7674503600697, 36.59463038142586, -414.4091568776721, -473.15358737814506, -612.2001387579373, -244.09905124178266, -440.1409788068478, -1062.8211128331263, 31.760394717823313, -1336.210872996541, 28.50818046983852, -666.3075762572728, -769.2452310175137, -87.57151831845623, -1065.8497820408309, -512.7521623190185, -591.3968733199001, -1510.0985030582299, -805.0266785266637, -1170.853573388443, 17.93455118094652, -561.0630092950375, -1160.481164069238, -889.8947007046115, -780.3767218126286, -633.8296924211569, -1430.7057928907984, -666.3676043930675, 38.87309893315555, -11.95795516451519, -1066.0858387599528, 372.84562593224126, -136.42888657291098, -144.25615151915105, 37.59525040003331, -560.8074706848032, -925.1338124706092, -1137.899530608858, -458.0200903977928, -644.7746614816679, -268.7130348916557, -395.2927282582562, -972.1176267533086, -789.8038051744696, -642.1292886912091, -554.4812497944946, -907.9916639237484, -715.6034775428969, -614.1451335376478, -51.44483747706158, -1450.5378522288222, -987.3350844063624, 38.67235152901048, -503.4667640031903, -331.34606392615933, -1298.4702975841303, -330.5519268025167, -145.167732839118, -488.54926089159886, -729.7006236381676, -1451.1223110423418, -274.2660899822618, -595.789219441566, 40.90000000000031, -422.2583319178967, -568.3408557559106, -633.4418447682821, -1052.4888471642064, -538.3509290016431], "policy_predator_policy_reward": [210.81862635778376, 666.3732493487996, 392.64313893103645, 166.63799893682398, 919.2373480859133, 488.1719471784144, 523.7114979326362, 814.5984074278059, 33.985828197824866, 658.891310110541, 655.5877487040952, 459.7608352310868, 240.01945334388296, 297.7906412861313, 0.8483022659694665, 472.1498019327971, 886.3992320250835, 701.1646266135936, 1307.3853921324555, 823.5417135459127, 61.634709770042875, 743.4966381955413, 703.0665814551104, 517.6719084496925, 973.7036655410006, 551.117647728026, 292.84061111626033, 502.5098406029496, 930.8975348485955, 617.4570703538702, 695.4575747860573, 16.971946502530752, 636.0340230273126, 397.19660749427965, 37.81962727005034, 883.2236871982542, 981.2349103908549, 307.16377689556384, 493.0080634709877, 805.1406358533035, 7.2841098549848535, 59.37750553370698, 269.78343268437817, 532.6329748408463, 1034.1991566129757, 879.2358118395165, 630.9195069733198, 362.1677032409263, 1093.790743332764, 398.25649744711035, 292.32790572612026, 1000.6491218907988, 533.6314179721568, 143.9997561364086, 1024.656412511655, 824.5445866400145, 206.80979409729204, 10.270238657383818, 582.0183978716653, 574.7225206955042, 283.41156944901275, 417.79206014529234, 573.7277073608672, 797.6007225559239, 221.0004082007864, 352.8830124593988, 593.7116764300981, 448.96217942452995, 0.0, 654.2937810526647, 914.1068885818503, 664.9581542449513, 537.247023566269, 810.0999314420037, 1340.0052965442617, 978.3909987780141, 1050.9521286796999, 887.1316792546535, 37.08176033199851, 829.0712309064065, 855.2881052856418, 52.49111395500784, 7.280941494017313, 164.343751554604, 334.81852099182294, 328.8273988364459, 478.07532630408133, 967.3088795211515, 1346.011794102351, 944.3355285486622, 732.6030703543199, 462.3357963225379, 793.225532281789, 101.58943387998501, 485.65812407121996, 467.51104061757803, 1316.734284093637, 1154.2533742074088, 198.25764535801986, 645.9401214124612, 686.3812401875442, 1047.4525813269656, 721.5669937649111, 257.48150576118985, 949.1081588623247, 1185.8084061444256, 196.2839294891254, 1192.6961684633734, 1622.7914975960452, 790.204762515614, 722.084192057361, 557.6139622475046, 625.7168255348638, 741.6015667392675, 282.94860414226576, 909.9210561418676, 196.17186686345133, 300.9686721677135, 615.0772410931152, 689.2156028360773, 216.34594913051336, 401.3349115130941, 47.98644289718226, 761.5235363488717, 356.6070871420979, 607.94572994798, 481.4280723843025, 905.7382203917795, 878.3102406043971, 26.517392003622973, 1065.621243026604, 869.6588873506576, 51.484147593601556, 488.44663542885684, 620.0981057910708, 650.543071132249, 767.0610350087361, 0.0, 1071.0933841388085, 22.225648094128445, 854.8722992294297, 755.5057733846546, 535.9441337626467, 917.4814840456614, 162.08316922962808, 1074.4938503541198, 525.6732975366933, 597.4820439800668, 1492.03641472082, 848.9189666839465, 1069.9738784815984, 621.3935763355485, 683.2841540055279, 1094.1283956336206, 799.4869723006401, 1084.076002082196, 843.5048324077625, 1376.8340481754692, 429.82538711482016, 593.0933442620857, 461.27294380988917, 820.3474209649467, 130.08525853851484, 134.1119419582766, 172.15615151914946, 2.2047495999669566, 898.8972514412469, 635.1440317141688, 1135.0585518926032, 504.2251239240798, 435.4626792684199, 633.8369448428386, 491.3123719029803, 947.032886094276, 795.8145893714812, 643.9648531624147, 839.9274745298362, 1033.0537748675397, 713.8492428412426, 660.1103608384387, 364.352980744605, 1420.4227028091407, 93.4728425130748, 960.7745847533519, 314.4552994787375, 614.701824945117, 1295.1595383119013, 500.0634556117319, 165.2701304838357, 540.9940681014971, 746.8006236381704, 1451.1223110423418, 431.1049039717741, 426.6235501161036, 2.592325382488712, 459.194223319978, 501.6087304220711, 743.1435759651844, 933.0471541463432, 845.330835768773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.84242676284925, "mean_inference_ms": 4.430168391925176, "mean_action_processing_ms": 1.5597826332568614, "mean_env_wait_ms": 10.425581005493491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01495659351348877, "StateBufferConnector_ms": 0.004786133766174316, "ViewRequirementAgentConnector_ms": 0.17289507389068604}, "num_episodes": 11, "episode_return_max": 691.3717466013524, "episode_return_min": -74.9259714294466, "episode_return_mean": 170.46838182853458, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.32758667645588, "num_env_steps_trained_throughput_per_sec": 82.32758667645588, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 49719.032, "restore_workers_time_ms": 0.013, "training_step_time_ms": 49718.923, "sample_time_ms": 2363.066, "learn_time_ms": 47333.389, "learn_throughput": 84.507, "synch_weights_time_ms": 18.196}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "35fb9_00000", "date": "2024-08-22_08-45-14", "timestamp": 1724296514, "time_this_iter_s": 48.64809322357178, "time_total_s": 3092.1306777000427, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc7ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3092.1306777000427, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 28.811594202898554, "ram_util_percent": 82.58695652173914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.25742297576218, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.973475599036646, "policy_loss": -0.02301806525435673, "vf_loss": 5.994089833264629, "vf_explained_var": 0.5205473087767445, "kl": 0.012019111761187633, "entropy": 0.6243515501735072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.741218403407506, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.112464954234936, "policy_loss": -0.01889316397990105, "vf_loss": 6.128904445839938, "vf_explained_var": 0.2983271304577116, "kl": 0.012268415998381675, "entropy": 0.5591252627196135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 691.3717466013524, "episode_reward_min": -38.882724241478364, "episode_reward_mean": 171.69780620611945, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1618.2914975960452, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 385.7190585059827, "predator_policy": 1622.7914975960452}, "policy_reward_mean": {"prey_policy": -528.2812608603584, "predator_policy": 614.1301639634189}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.59328937180305, 143.52822974390767, -2.4891760162368755, 63.84496422043412, 145.11309323661234, 14.862308205661186, 75.6950429112666, 188.07655842447008, 408.7000000000022, 214.47992575672214, 180.0192673690004, 114.06844783711803, 87.0216332161416, 25.600000000000087, 34.35431806394472, 691.3717466013524, 363.4000000000009, 202.25101310339332, 296.31783176430025, 281.8150380532654, 53.988779339019, 358.15317449179264, 8.66790052423426, 428.7921726351028, 85.38540440958502, 8.198669654316648, 287.4569857592227, -38.882724241478364, 402.11759900190975, 548.7000000000023, 160.73527851541937, 29.100000000000144, 7.49194776032925, 127.8912183082054, 455.68423914429485, 402.30252057855836, -0.8053255455714403, 126.05450210035667, 6.799999999999997, 104.0077637585006, 239.42286961059196, 32.0000000000002, 10.543428764270935, 224.33424648918736, 243.26354315591993, 64.82982278865651, 45.11519704428133, 418.38244061117945, 512.167324183569, 367.9214489732478, 129.43590176003107, 247.56946445678304, -17.092623680576814, 117.43726132535139, 162.1162565262091, 185.28745078723233, 82.82100496010477, 62.258314117633724, 302.6753800873844, 17.872810533516372, 83.15571922446195, 19.00630587783896, 25.83019981987438, 538.4484326096551, 55.86837627487466, 213.2915518655908, 155.80339527127927, 395.424225916999, 203.57657085036848, 500.61393985612756, 67.70000000000043, 48.10000000000004, 43.364054810029174, 155.81192773793072, 70.93490298568737, 7.846348668216047, 410.50833567913384, 44.210992599135075, 282.7929938478636, 105.58469438907275, 94.34429649450156, 166.2007695369835, 72.54720485461672, 17.099999999999984, -12.326855335955202, 80.42821678456687, 42.96960586306087, 187.5382137492661, 390.0999999999997, 115.05016362064364, 645.7188041762919, 35.64029909237771, 222.99598865053161, 45.3330212976205, 4.010958698165373, 24.302675350735353, 200.7726307789881, 253.28339726085224, 116.67308090302683, 270.40000000000197], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-751.1146148641301, -543.1134090330861, -113.03127238701634, -538.7909495882844, -881.2917929508606, -669.551988267837, -675.6575747860553, 27.073017717903088, -472.22587123693563, -415.89166604804063, -30.591940310001696, -875.5890659526416, -428.8248205489195, -783.8788238262249, -998.4101471361921, -111.66199376362877, 365.7158901450151, -23.677505533706473, -13.442896108207643, -574.4935856602915, -1053.2066119328354, -680.2090891506535, -609.702516488712, -269.316245888413, -375.58214926465706, -1029.443458299071, -267.82790572612043, -999.5491218907987, -510.0996775883865, -133.1771784562321, -1126.5527732848436, -31.276479265478272, -179.5097940972935, 325.82976134261617, -58.75670739441431, -895.7331980693631, -8.65837464255911, -396.22742318744105, -288.4901336786529, -801.0232581848703, -175.74508183772056, -344.1495594834421, -477.2618027972046, -207.25887856563088, -369.32481193876816, -276.30106858966155, -736.2326303682684, -414.0402398234288, -477.49828092471574, -784.4632696739726, -1334.0066268899452, -976.1909987780141, -1135.7779918991914, -514.8488302759337, -187.83138477350207, -717.2043307063785, -855.8343017046111, 350.1726814658714, 385.7190585059827, -8.643751554604368, -197.8784512309034, -305.0321900819431, -460.6753263040774, -955.6088795211516, -1340.9198463420219, -941.9355285486618, -98.38541279995762, -968.6622355686969, -822.9481157414382, 383.8173887239609, 40.0000000000003, -590.8666441102439, -1315.534284093637, -1156.2586997529802, -572.7790393183333, -145.36422535178457, -684.0812401875436, -1042.9525813269652, -670.9603731397058, -204.08036262789227, -623.3025897281823, -1272.1911056679717, -169.8839294891269, -1187.0961684633733, -1618.2914975960452, -784.1613337513421, -730.5873580299714, -324.77654978570706, -439.05055073759985, -685.0042983806068, -416.566376073151, -711.4734614223246, -246.8262556075199, -205.19908637936334, -643.341854102956, -242.56854921505663, 295.5463519833289, -401.0598884433674, -772.8358780316051, 331.2473477587989, -843.4365767396605, 8.31966140961298, -82.34552898553505, -1057.2512993337625, -337.952313148858, -583.9679431397345, -926.0754186918373, -891.7674503600697, 36.59463038142586, -414.4091568776721, -473.15358737814506, -612.2001387579373, -244.09905124178266, -440.1409788068478, -1062.8211128331263, 31.760394717823313, -1336.210872996541, 28.50818046983852, -666.3075762572728, -769.2452310175137, -87.57151831845623, -1065.8497820408309, -512.7521623190185, -591.3968733199001, -1510.0985030582299, -805.0266785266637, -1170.853573388443, 17.93455118094652, -561.0630092950375, -1160.481164069238, -889.8947007046115, -780.3767218126286, -633.8296924211569, -1430.7057928907984, -666.3676043930675, 38.87309893315555, -11.95795516451519, -1066.0858387599528, 372.84562593224126, -136.42888657291098, -144.25615151915105, 37.59525040003331, -560.8074706848032, -925.1338124706092, -1137.899530608858, -458.0200903977928, -644.7746614816679, -268.7130348916557, -395.2927282582562, -972.1176267533086, -789.8038051744696, -642.1292886912091, -554.4812497944946, -907.9916639237484, -715.6034775428969, -614.1451335376478, -51.44483747706158, -1450.5378522288222, -987.3350844063624, 38.67235152901048, -503.4667640031903, -331.34606392615933, -1298.4702975841303, -330.5519268025167, -145.167732839118, -488.54926089159886, -729.7006236381676, -1451.1223110423418, -274.2660899822618, -595.789219441566, 40.90000000000031, -422.2583319178967, -568.3408557559106, -633.4418447682821, -1052.4888471642064, -538.3509290016431, 365.53718320972575, -575.285200681487, -363.1649757774135, -516.1544383321927, -984.9199013712825, 90.91926131169407, -698.4375067499413, -720.0238345008439, -716.71067365637, -514.3711723306546, -566.4530737584768, 32.51443562631158, -799.4605478251223, -1184.7337233544697, -91.29018469752779, -330.1250952400853, -936.808952487594, 31.38787658940612, -333.33615425677255, -889.3485685172681, -456.73202548561136, -677.0109297567142, -151.6487941681918, 135.53889579623234], "policy_predator_policy_reward": [973.7036655410006, 551.117647728026, 292.84061111626033, 502.5098406029496, 930.8975348485955, 617.4570703538702, 695.4575747860573, 16.971946502530752, 636.0340230273126, 397.19660749427965, 37.81962727005034, 883.2236871982542, 981.2349103908549, 307.16377689556384, 493.0080634709877, 805.1406358533035, 7.2841098549848535, 59.37750553370698, 269.78343268437817, 532.6329748408463, 1034.1991566129757, 879.2358118395165, 630.9195069733198, 362.1677032409263, 1093.790743332764, 398.25649744711035, 292.32790572612026, 1000.6491218907988, 533.6314179721568, 143.9997561364086, 1024.656412511655, 824.5445866400145, 206.80979409729204, 10.270238657383818, 582.0183978716653, 574.7225206955042, 283.41156944901275, 417.79206014529234, 573.7277073608672, 797.6007225559239, 221.0004082007864, 352.8830124593988, 593.7116764300981, 448.96217942452995, 0.0, 654.2937810526647, 914.1068885818503, 664.9581542449513, 537.247023566269, 810.0999314420037, 1340.0052965442617, 978.3909987780141, 1050.9521286796999, 887.1316792546535, 37.08176033199851, 829.0712309064065, 855.2881052856418, 52.49111395500784, 7.280941494017313, 164.343751554604, 334.81852099182294, 328.8273988364459, 478.07532630408133, 967.3088795211515, 1346.011794102351, 944.3355285486622, 732.6030703543199, 462.3357963225379, 793.225532281789, 101.58943387998501, 485.65812407121996, 467.51104061757803, 1316.734284093637, 1154.2533742074088, 198.25764535801986, 645.9401214124612, 686.3812401875442, 1047.4525813269656, 721.5669937649111, 257.48150576118985, 949.1081588623247, 1185.8084061444256, 196.2839294891254, 1192.6961684633734, 1622.7914975960452, 790.204762515614, 722.084192057361, 557.6139622475046, 625.7168255348638, 741.6015667392675, 282.94860414226576, 909.9210561418676, 196.17186686345133, 300.9686721677135, 615.0772410931152, 689.2156028360773, 216.34594913051336, 401.3349115130941, 47.98644289718226, 761.5235363488717, 356.6070871420979, 607.94572994798, 481.4280723843025, 905.7382203917795, 878.3102406043971, 26.517392003622973, 1065.621243026604, 869.6588873506576, 51.484147593601556, 488.44663542885684, 620.0981057910708, 650.543071132249, 767.0610350087361, 0.0, 1071.0933841388085, 22.225648094128445, 854.8722992294297, 755.5057733846546, 535.9441337626467, 917.4814840456614, 162.08316922962808, 1074.4938503541198, 525.6732975366933, 597.4820439800668, 1492.03641472082, 848.9189666839465, 1069.9738784815984, 621.3935763355485, 683.2841540055279, 1094.1283956336206, 799.4869723006401, 1084.076002082196, 843.5048324077625, 1376.8340481754692, 429.82538711482016, 593.0933442620857, 461.27294380988917, 820.3474209649467, 130.08525853851484, 134.1119419582766, 172.15615151914946, 2.2047495999669566, 898.8972514412469, 635.1440317141688, 1135.0585518926032, 504.2251239240798, 435.4626792684199, 633.8369448428386, 491.3123719029803, 947.032886094276, 795.8145893714812, 643.9648531624147, 839.9274745298362, 1033.0537748675397, 713.8492428412426, 660.1103608384387, 364.352980744605, 1420.4227028091407, 93.4728425130748, 960.7745847533519, 314.4552994787375, 614.701824945117, 1295.1595383119013, 500.0634556117319, 165.2701304838357, 540.9940681014971, 746.8006236381704, 1451.1223110423418, 431.1049039717741, 426.6235501161036, 2.592325382488712, 459.194223319978, 501.6087304220711, 743.1435759651844, 933.0471541463432, 845.330835768773, 16.462816790274246, 583.3852006814861, 671.8259239964112, 322.5436537338481, 872.0505555875759, 667.6688886483048, 796.3985808777117, 657.7030594654545, 891.1343044110424, 562.9435302265177, 577.0403956332949, 2.231263796490333, 799.7605478251223, 1188.4446820526348, 195.59062221290878, 250.12733307544107, 401.54615888558357, 704.6475477915961, 934.2291552015836, 541.7389648333171, 418.03746413618234, 832.3785720091752, 192.24879416819, 94.26110420376699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.824918203306248, "mean_inference_ms": 4.408422239987241, "mean_action_processing_ms": 1.5614325130799456, "mean_env_wait_ms": 10.407697271245807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019004106521606445, "StateBufferConnector_ms": 0.004768729209899902, "ViewRequirementAgentConnector_ms": 0.1644594669342041}, "num_episodes": 12, "episode_return_max": 691.3717466013524, "episode_return_min": -38.882724241478364, "episode_return_mean": 171.69780620611945, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.12872947623586, "num_env_steps_trained_throughput_per_sec": 81.12872947623586, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 49657.972, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49657.878, "sample_time_ms": 2376.049, "learn_time_ms": 47259.1, "learn_throughput": 84.64, "synch_weights_time_ms": 17.94}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "35fb9_00000", "date": "2024-08-22_08-46-03", "timestamp": 1724296563, "time_this_iter_s": 49.32742691040039, "time_total_s": 3141.458104610443, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0f73a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3141.458104610443, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 28.68550724637681, "ram_util_percent": 83.03623188405798}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.734834775722845, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.546552344226333, "policy_loss": -0.021812805467871604, "vf_loss": 5.565617487922547, "vf_explained_var": 0.5585081485213426, "kl": 0.013738318484414506, "entropy": 0.7124731268832293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.43725394338527, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.941313108565315, "policy_loss": -0.016119296994755075, "vf_loss": 5.955185709302388, "vf_explained_var": 0.354104206234059, "kl": 0.011233565846591123, "entropy": 0.5779770019193174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 691.3717466013524, "episode_reward_min": -53.42292152064988, "episode_reward_mean": 176.91398567957992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1618.2914975960452, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 385.7190585059827, "predator_policy": 1622.7914975960452}, "policy_reward_mean": {"prey_policy": -522.6277386749598, "predator_policy": 611.0847315147504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.06844783711803, 87.0216332161416, 25.600000000000087, 34.35431806394472, 691.3717466013524, 363.4000000000009, 202.25101310339332, 296.31783176430025, 281.8150380532654, 53.988779339019, 358.15317449179264, 8.66790052423426, 428.7921726351028, 85.38540440958502, 8.198669654316648, 287.4569857592227, -38.882724241478364, 402.11759900190975, 548.7000000000023, 160.73527851541937, 29.100000000000144, 7.49194776032925, 127.8912183082054, 455.68423914429485, 402.30252057855836, -0.8053255455714403, 126.05450210035667, 6.799999999999997, 104.0077637585006, 239.42286961059196, 32.0000000000002, 10.543428764270935, 224.33424648918736, 243.26354315591993, 64.82982278865651, 45.11519704428133, 418.38244061117945, 512.167324183569, 367.9214489732478, 129.43590176003107, 247.56946445678304, -17.092623680576814, 117.43726132535139, 162.1162565262091, 185.28745078723233, 82.82100496010477, 62.258314117633724, 302.6753800873844, 17.872810533516372, 83.15571922446195, 19.00630587783896, 25.83019981987438, 538.4484326096551, 55.86837627487466, 213.2915518655908, 155.80339527127927, 395.424225916999, 203.57657085036848, 500.61393985612756, 67.70000000000043, 48.10000000000004, 43.364054810029174, 155.81192773793072, 70.93490298568737, 7.846348668216047, 410.50833567913384, 44.210992599135075, 282.7929938478636, 105.58469438907275, 94.34429649450156, 166.2007695369835, 72.54720485461672, 17.099999999999984, -12.326855335955202, 80.42821678456687, 42.96960586306087, 187.5382137492661, 390.0999999999997, 115.05016362064364, 645.7188041762919, 35.64029909237771, 222.99598865053161, 45.3330212976205, 4.010958698165373, 24.302675350735353, 200.7726307789881, 253.28339726085224, 116.67308090302683, 270.40000000000197, -53.42292152064988, 283.81115494286786, 572.3624844283535, 44.51135818172011, 305.3901107002325, 181.14090209316169, 72.90000000000013, 78.59999999999981, 173.9374707434096, 365.21089100059, 159.59999999999962], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-609.702516488712, -269.316245888413, -375.58214926465706, -1029.443458299071, -267.82790572612043, -999.5491218907987, -510.0996775883865, -133.1771784562321, -1126.5527732848436, -31.276479265478272, -179.5097940972935, 325.82976134261617, -58.75670739441431, -895.7331980693631, -8.65837464255911, -396.22742318744105, -288.4901336786529, -801.0232581848703, -175.74508183772056, -344.1495594834421, -477.2618027972046, -207.25887856563088, -369.32481193876816, -276.30106858966155, -736.2326303682684, -414.0402398234288, -477.49828092471574, -784.4632696739726, -1334.0066268899452, -976.1909987780141, -1135.7779918991914, -514.8488302759337, -187.83138477350207, -717.2043307063785, -855.8343017046111, 350.1726814658714, 385.7190585059827, -8.643751554604368, -197.8784512309034, -305.0321900819431, -460.6753263040774, -955.6088795211516, -1340.9198463420219, -941.9355285486618, -98.38541279995762, -968.6622355686969, -822.9481157414382, 383.8173887239609, 40.0000000000003, -590.8666441102439, -1315.534284093637, -1156.2586997529802, -572.7790393183333, -145.36422535178457, -684.0812401875436, -1042.9525813269652, -670.9603731397058, -204.08036262789227, -623.3025897281823, -1272.1911056679717, -169.8839294891269, -1187.0961684633733, -1618.2914975960452, -784.1613337513421, -730.5873580299714, -324.77654978570706, -439.05055073759985, -685.0042983806068, -416.566376073151, -711.4734614223246, -246.8262556075199, -205.19908637936334, -643.341854102956, -242.56854921505663, 295.5463519833289, -401.0598884433674, -772.8358780316051, 331.2473477587989, -843.4365767396605, 8.31966140961298, -82.34552898553505, -1057.2512993337625, -337.952313148858, -583.9679431397345, -926.0754186918373, -891.7674503600697, 36.59463038142586, -414.4091568776721, -473.15358737814506, -612.2001387579373, -244.09905124178266, -440.1409788068478, -1062.8211128331263, 31.760394717823313, -1336.210872996541, 28.50818046983852, -666.3075762572728, -769.2452310175137, -87.57151831845623, -1065.8497820408309, -512.7521623190185, -591.3968733199001, -1510.0985030582299, -805.0266785266637, -1170.853573388443, 17.93455118094652, -561.0630092950375, -1160.481164069238, -889.8947007046115, -780.3767218126286, -633.8296924211569, -1430.7057928907984, -666.3676043930675, 38.87309893315555, -11.95795516451519, -1066.0858387599528, 372.84562593224126, -136.42888657291098, -144.25615151915105, 37.59525040003331, -560.8074706848032, -925.1338124706092, -1137.899530608858, -458.0200903977928, -644.7746614816679, -268.7130348916557, -395.2927282582562, -972.1176267533086, -789.8038051744696, -642.1292886912091, -554.4812497944946, -907.9916639237484, -715.6034775428969, -614.1451335376478, -51.44483747706158, -1450.5378522288222, -987.3350844063624, 38.67235152901048, -503.4667640031903, -331.34606392615933, -1298.4702975841303, -330.5519268025167, -145.167732839118, -488.54926089159886, -729.7006236381676, -1451.1223110423418, -274.2660899822618, -595.789219441566, 40.90000000000031, -422.2583319178967, -568.3408557559106, -633.4418447682821, -1052.4888471642064, -538.3509290016431, 365.53718320972575, -575.285200681487, -363.1649757774135, -516.1544383321927, -984.9199013712825, 90.91926131169407, -698.4375067499413, -720.0238345008439, -716.71067365637, -514.3711723306546, -566.4530737584768, 32.51443562631158, -799.4605478251223, -1184.7337233544697, -91.29018469752779, -330.1250952400853, -936.808952487594, 31.38787658940612, -333.33615425677255, -889.3485685172681, -456.73202548561136, -677.0109297567142, -151.6487941681918, 135.53889579623234, -964.6639471920957, -354.38676718499187, -429.68166005336474, -491.7629807542881, 13.09113907945234, -800.3277805558224, -286.2797892528909, -817.3953674767699, -748.5598171126613, -234.81491988595639, -729.0432491896918, -677.871041730333, -47.129904602223824, 18.32384570406369, 20.024913356893062, 40.0000000000003, -292.89167031361075, -557.2449328909471, -537.1263542718782, -520.1073987984312, -196.3373921470876, -516.9771988702702], "policy_predator_policy_reward": [630.9195069733198, 362.1677032409263, 1093.790743332764, 398.25649744711035, 292.32790572612026, 1000.6491218907988, 533.6314179721568, 143.9997561364086, 1024.656412511655, 824.5445866400145, 206.80979409729204, 10.270238657383818, 582.0183978716653, 574.7225206955042, 283.41156944901275, 417.79206014529234, 573.7277073608672, 797.6007225559239, 221.0004082007864, 352.8830124593988, 593.7116764300981, 448.96217942452995, 0.0, 654.2937810526647, 914.1068885818503, 664.9581542449513, 537.247023566269, 810.0999314420037, 1340.0052965442617, 978.3909987780141, 1050.9521286796999, 887.1316792546535, 37.08176033199851, 829.0712309064065, 855.2881052856418, 52.49111395500784, 7.280941494017313, 164.343751554604, 334.81852099182294, 328.8273988364459, 478.07532630408133, 967.3088795211515, 1346.011794102351, 944.3355285486622, 732.6030703543199, 462.3357963225379, 793.225532281789, 101.58943387998501, 485.65812407121996, 467.51104061757803, 1316.734284093637, 1154.2533742074088, 198.25764535801986, 645.9401214124612, 686.3812401875442, 1047.4525813269656, 721.5669937649111, 257.48150576118985, 949.1081588623247, 1185.8084061444256, 196.2839294891254, 1192.6961684633734, 1622.7914975960452, 790.204762515614, 722.084192057361, 557.6139622475046, 625.7168255348638, 741.6015667392675, 282.94860414226576, 909.9210561418676, 196.17186686345133, 300.9686721677135, 615.0772410931152, 689.2156028360773, 216.34594913051336, 401.3349115130941, 47.98644289718226, 761.5235363488717, 356.6070871420979, 607.94572994798, 481.4280723843025, 905.7382203917795, 878.3102406043971, 26.517392003622973, 1065.621243026604, 869.6588873506576, 51.484147593601556, 488.44663542885684, 620.0981057910708, 650.543071132249, 767.0610350087361, 0.0, 1071.0933841388085, 22.225648094128445, 854.8722992294297, 755.5057733846546, 535.9441337626467, 917.4814840456614, 162.08316922962808, 1074.4938503541198, 525.6732975366933, 597.4820439800668, 1492.03641472082, 848.9189666839465, 1069.9738784815984, 621.3935763355485, 683.2841540055279, 1094.1283956336206, 799.4869723006401, 1084.076002082196, 843.5048324077625, 1376.8340481754692, 429.82538711482016, 593.0933442620857, 461.27294380988917, 820.3474209649467, 130.08525853851484, 134.1119419582766, 172.15615151914946, 2.2047495999669566, 898.8972514412469, 635.1440317141688, 1135.0585518926032, 504.2251239240798, 435.4626792684199, 633.8369448428386, 491.3123719029803, 947.032886094276, 795.8145893714812, 643.9648531624147, 839.9274745298362, 1033.0537748675397, 713.8492428412426, 660.1103608384387, 364.352980744605, 1420.4227028091407, 93.4728425130748, 960.7745847533519, 314.4552994787375, 614.701824945117, 1295.1595383119013, 500.0634556117319, 165.2701304838357, 540.9940681014971, 746.8006236381704, 1451.1223110423418, 431.1049039717741, 426.6235501161036, 2.592325382488712, 459.194223319978, 501.6087304220711, 743.1435759651844, 933.0471541463432, 845.330835768773, 16.462816790274246, 583.3852006814861, 671.8259239964112, 322.5436537338481, 872.0505555875759, 667.6688886483048, 796.3985808777117, 657.7030594654545, 891.1343044110424, 562.9435302265177, 577.0403956332949, 2.231263796490333, 799.7605478251223, 1188.4446820526348, 195.59062221290878, 250.12733307544107, 401.54615888558357, 704.6475477915961, 934.2291552015836, 541.7389648333171, 418.03746413618234, 832.3785720091752, 192.24879416819, 94.26110420376699, 325.5212314905774, 940.1065613658664, 557.0962111888919, 648.1595845616287, 657.3991500695073, 702.1999758352126, 324.80384695315365, 823.3826679582282, 570.693946468379, 718.0709012304662, 717.1137564343577, 870.9414365788284, 81.82990460222314, 19.876154295936317, 18.57508664310695, 0.0, 638.6395869413686, 385.4344870065978, 677.386659858025, 745.0579842128781, 424.2286011667665, 448.68598985059384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.825844353445473, "mean_inference_ms": 4.409795778581285, "mean_action_processing_ms": 1.5298685846622526, "mean_env_wait_ms": 10.41632993089079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01902472972869873, "StateBufferConnector_ms": 0.004826545715332031, "ViewRequirementAgentConnector_ms": 0.15993010997772217}, "num_episodes": 11, "episode_return_max": 691.3717466013524, "episode_return_min": -53.42292152064988, "episode_return_mean": 176.91398567957992, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.91245988744379, "num_env_steps_trained_throughput_per_sec": 74.91245988744379, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 49980.309, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49980.223, "sample_time_ms": 2376.277, "learn_time_ms": 47579.557, "learn_throughput": 84.07, "synch_weights_time_ms": 19.399}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "35fb9_00000", "date": "2024-08-22_08-46-57", "timestamp": 1724296617, "time_this_iter_s": 53.45729613304138, "time_total_s": 3194.9154007434845, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc7b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3194.9154007434845, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 36.46052631578947, "ram_util_percent": 82.9342105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.48216617750743, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.9625500996907554, "policy_loss": -0.02281681274645346, "vf_loss": 5.982616395294351, "vf_explained_var": 0.5633039420243924, "kl": 0.01375255217632801, "entropy": 0.6900621722299586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.144973645071504, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.102770895932717, "policy_loss": -0.019589593829389997, "vf_loss": 6.119986320929552, "vf_explained_var": 0.25533633355110413, "kl": 0.01187083219244544, "entropy": 0.5832128996413851, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 741.0948673647298, "episode_reward_min": -53.42292152064988, "episode_reward_mean": 176.78944706277179, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1618.2914975960452, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1622.7914975960452}, "policy_reward_mean": {"prey_policy": -521.3846819958349, "predator_policy": 609.7794055272213}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.38540440958502, 8.198669654316648, 287.4569857592227, -38.882724241478364, 402.11759900190975, 548.7000000000023, 160.73527851541937, 29.100000000000144, 7.49194776032925, 127.8912183082054, 455.68423914429485, 402.30252057855836, -0.8053255455714403, 126.05450210035667, 6.799999999999997, 104.0077637585006, 239.42286961059196, 32.0000000000002, 10.543428764270935, 224.33424648918736, 243.26354315591993, 64.82982278865651, 45.11519704428133, 418.38244061117945, 512.167324183569, 367.9214489732478, 129.43590176003107, 247.56946445678304, -17.092623680576814, 117.43726132535139, 162.1162565262091, 185.28745078723233, 82.82100496010477, 62.258314117633724, 302.6753800873844, 17.872810533516372, 83.15571922446195, 19.00630587783896, 25.83019981987438, 538.4484326096551, 55.86837627487466, 213.2915518655908, 155.80339527127927, 395.424225916999, 203.57657085036848, 500.61393985612756, 67.70000000000043, 48.10000000000004, 43.364054810029174, 155.81192773793072, 70.93490298568737, 7.846348668216047, 410.50833567913384, 44.210992599135075, 282.7929938478636, 105.58469438907275, 94.34429649450156, 166.2007695369835, 72.54720485461672, 17.099999999999984, -12.326855335955202, 80.42821678456687, 42.96960586306087, 187.5382137492661, 390.0999999999997, 115.05016362064364, 645.7188041762919, 35.64029909237771, 222.99598865053161, 45.3330212976205, 4.010958698165373, 24.302675350735353, 200.7726307789881, 253.28339726085224, 116.67308090302683, 270.40000000000197, -53.42292152064988, 283.81115494286786, 572.3624844283535, 44.51135818172011, 305.3901107002325, 181.14090209316169, 72.90000000000013, 78.59999999999981, 173.9374707434096, 365.21089100059, 159.59999999999962, 165.59999999999803, 380.83762161811285, 209.71033161561235, 137.29181053887157, 213.39913754168387, 167.86590331990993, 60.34669540819036, 51.9373018801809, 741.0948673647298, 513.3393565858045, 160.25590068243804, 51.037953099351526, 80.63131429396955], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-477.49828092471574, -784.4632696739726, -1334.0066268899452, -976.1909987780141, -1135.7779918991914, -514.8488302759337, -187.83138477350207, -717.2043307063785, -855.8343017046111, 350.1726814658714, 385.7190585059827, -8.643751554604368, -197.8784512309034, -305.0321900819431, -460.6753263040774, -955.6088795211516, -1340.9198463420219, -941.9355285486618, -98.38541279995762, -968.6622355686969, -822.9481157414382, 383.8173887239609, 40.0000000000003, -590.8666441102439, -1315.534284093637, -1156.2586997529802, -572.7790393183333, -145.36422535178457, -684.0812401875436, -1042.9525813269652, -670.9603731397058, -204.08036262789227, -623.3025897281823, -1272.1911056679717, -169.8839294891269, -1187.0961684633733, -1618.2914975960452, -784.1613337513421, -730.5873580299714, -324.77654978570706, -439.05055073759985, -685.0042983806068, -416.566376073151, -711.4734614223246, -246.8262556075199, -205.19908637936334, -643.341854102956, -242.56854921505663, 295.5463519833289, -401.0598884433674, -772.8358780316051, 331.2473477587989, -843.4365767396605, 8.31966140961298, -82.34552898553505, -1057.2512993337625, -337.952313148858, -583.9679431397345, -926.0754186918373, -891.7674503600697, 36.59463038142586, -414.4091568776721, -473.15358737814506, -612.2001387579373, -244.09905124178266, -440.1409788068478, -1062.8211128331263, 31.760394717823313, -1336.210872996541, 28.50818046983852, -666.3075762572728, -769.2452310175137, -87.57151831845623, -1065.8497820408309, -512.7521623190185, -591.3968733199001, -1510.0985030582299, -805.0266785266637, -1170.853573388443, 17.93455118094652, -561.0630092950375, -1160.481164069238, -889.8947007046115, -780.3767218126286, -633.8296924211569, -1430.7057928907984, -666.3676043930675, 38.87309893315555, -11.95795516451519, -1066.0858387599528, 372.84562593224126, -136.42888657291098, -144.25615151915105, 37.59525040003331, -560.8074706848032, -925.1338124706092, -1137.899530608858, -458.0200903977928, -644.7746614816679, -268.7130348916557, -395.2927282582562, -972.1176267533086, -789.8038051744696, -642.1292886912091, -554.4812497944946, -907.9916639237484, -715.6034775428969, -614.1451335376478, -51.44483747706158, -1450.5378522288222, -987.3350844063624, 38.67235152901048, -503.4667640031903, -331.34606392615933, -1298.4702975841303, -330.5519268025167, -145.167732839118, -488.54926089159886, -729.7006236381676, -1451.1223110423418, -274.2660899822618, -595.789219441566, 40.90000000000031, -422.2583319178967, -568.3408557559106, -633.4418447682821, -1052.4888471642064, -538.3509290016431, 365.53718320972575, -575.285200681487, -363.1649757774135, -516.1544383321927, -984.9199013712825, 90.91926131169407, -698.4375067499413, -720.0238345008439, -716.71067365637, -514.3711723306546, -566.4530737584768, 32.51443562631158, -799.4605478251223, -1184.7337233544697, -91.29018469752779, -330.1250952400853, -936.808952487594, 31.38787658940612, -333.33615425677255, -889.3485685172681, -456.73202548561136, -677.0109297567142, -151.6487941681918, 135.53889579623234, -964.6639471920957, -354.38676718499187, -429.68166005336474, -491.7629807542881, 13.09113907945234, -800.3277805558224, -286.2797892528909, -817.3953674767699, -748.5598171126613, -234.81491988595639, -729.0432491896918, -677.871041730333, -47.129904602223824, 18.32384570406369, 20.024913356893062, 40.0000000000003, -292.89167031361075, -557.2449328909471, -537.1263542718782, -520.1073987984312, -196.3373921470876, -516.9771988702702, -1420.4385593969469, 157.8999999999985, -137.574489196933, 75.06021319024657, -230.99778100992683, -35.18535272223059, -107.74523763675325, -266.62660996475677, -304.73066537558014, -588.4511184784742, -716.2384227550671, 5.85070982187742, -1121.3666945318264, -510.3726562522989, -838.0756403990601, -356.35912360113844, -479.44906627724345, 370.8207414783054, -699.9099150857809, 400.0, -92.4601139244062, -803.558913180366, -946.1961723657779, -260.4204815106142, -762.0733262336764, -738.2006962353923], "policy_predator_policy_reward": [537.247023566269, 810.0999314420037, 1340.0052965442617, 978.3909987780141, 1050.9521286796999, 887.1316792546535, 37.08176033199851, 829.0712309064065, 855.2881052856418, 52.49111395500784, 7.280941494017313, 164.343751554604, 334.81852099182294, 328.8273988364459, 478.07532630408133, 967.3088795211515, 1346.011794102351, 944.3355285486622, 732.6030703543199, 462.3357963225379, 793.225532281789, 101.58943387998501, 485.65812407121996, 467.51104061757803, 1316.734284093637, 1154.2533742074088, 198.25764535801986, 645.9401214124612, 686.3812401875442, 1047.4525813269656, 721.5669937649111, 257.48150576118985, 949.1081588623247, 1185.8084061444256, 196.2839294891254, 1192.6961684633734, 1622.7914975960452, 790.204762515614, 722.084192057361, 557.6139622475046, 625.7168255348638, 741.6015667392675, 282.94860414226576, 909.9210561418676, 196.17186686345133, 300.9686721677135, 615.0772410931152, 689.2156028360773, 216.34594913051336, 401.3349115130941, 47.98644289718226, 761.5235363488717, 356.6070871420979, 607.94572994798, 481.4280723843025, 905.7382203917795, 878.3102406043971, 26.517392003622973, 1065.621243026604, 869.6588873506576, 51.484147593601556, 488.44663542885684, 620.0981057910708, 650.543071132249, 767.0610350087361, 0.0, 1071.0933841388085, 22.225648094128445, 854.8722992294297, 755.5057733846546, 535.9441337626467, 917.4814840456614, 162.08316922962808, 1074.4938503541198, 525.6732975366933, 597.4820439800668, 1492.03641472082, 848.9189666839465, 1069.9738784815984, 621.3935763355485, 683.2841540055279, 1094.1283956336206, 799.4869723006401, 1084.076002082196, 843.5048324077625, 1376.8340481754692, 429.82538711482016, 593.0933442620857, 461.27294380988917, 820.3474209649467, 130.08525853851484, 134.1119419582766, 172.15615151914946, 2.2047495999669566, 898.8972514412469, 635.1440317141688, 1135.0585518926032, 504.2251239240798, 435.4626792684199, 633.8369448428386, 491.3123719029803, 947.032886094276, 795.8145893714812, 643.9648531624147, 839.9274745298362, 1033.0537748675397, 713.8492428412426, 660.1103608384387, 364.352980744605, 1420.4227028091407, 93.4728425130748, 960.7745847533519, 314.4552994787375, 614.701824945117, 1295.1595383119013, 500.0634556117319, 165.2701304838357, 540.9940681014971, 746.8006236381704, 1451.1223110423418, 431.1049039717741, 426.6235501161036, 2.592325382488712, 459.194223319978, 501.6087304220711, 743.1435759651844, 933.0471541463432, 845.330835768773, 16.462816790274246, 583.3852006814861, 671.8259239964112, 322.5436537338481, 872.0505555875759, 667.6688886483048, 796.3985808777117, 657.7030594654545, 891.1343044110424, 562.9435302265177, 577.0403956332949, 2.231263796490333, 799.7605478251223, 1188.4446820526348, 195.59062221290878, 250.12733307544107, 401.54615888558357, 704.6475477915961, 934.2291552015836, 541.7389648333171, 418.03746413618234, 832.3785720091752, 192.24879416819, 94.26110420376699, 325.5212314905774, 940.1065613658664, 557.0962111888919, 648.1595845616287, 657.3991500695073, 702.1999758352126, 324.80384695315365, 823.3826679582282, 570.693946468379, 718.0709012304662, 717.1137564343577, 870.9414365788284, 81.82990460222314, 19.876154295936317, 18.57508664310695, 0.0, 638.6395869413686, 385.4344870065978, 677.386659858025, 745.0579842128781, 424.2286011667665, 448.68598985059384, 1428.1385593969399, 0.0, 204.55944757302302, 238.79245005177285, 247.9668748798696, 227.9265904679019, 242.97218206007233, 268.69147608031545, 503.4517880268994, 603.1291333688403, 182.55604750654868, 695.6975687465562, 1175.4869662038777, 516.5990799884373, 702.4067301291557, 543.9653357512298, 405.639676683829, 444.08351547983887, 265.4658415603547, 547.7834301112294, 303.26059449618253, 753.0143332910269, 883.790374466514, 373.8642325092342, 1290.8332615584534, 290.07207520458746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.798942828308009, "mean_inference_ms": 4.4005266281009225, "mean_action_processing_ms": 1.5336645933195927, "mean_env_wait_ms": 10.432849315829412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03986096382141113, "StateBufferConnector_ms": 0.00523686408996582, "ViewRequirementAgentConnector_ms": 0.20447933673858643}, "num_episodes": 13, "episode_return_max": 741.0948673647298, "episode_return_min": -53.42292152064988, "episode_return_mean": 176.78944706277179, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.043140684497842, "num_env_steps_trained_throughput_per_sec": 5.043140684497842, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 124373.576, "restore_workers_time_ms": 0.014, "training_step_time_ms": 124373.491, "sample_time_ms": 2687.674, "learn_time_ms": 121661.5, "learn_throughput": 32.878, "synch_weights_time_ms": 19.248}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "35fb9_00000", "date": "2024-08-22_09-00-10", "timestamp": 1724297410, "time_this_iter_s": 793.2814521789551, "time_total_s": 3988.1968529224396, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc7bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3988.1968529224396, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 57.084375, "ram_util_percent": 83.13125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.28183382162972, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.764825825464158, "policy_loss": -0.02087869252935643, "vf_loss": 5.782791679372233, "vf_explained_var": 0.5700434012072427, "kl": 0.014564310118097753, "entropy": 0.6723270001234831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.937296271450306, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.685425151340545, "policy_loss": -0.02118483770148405, "vf_loss": 5.704043986053063, "vf_explained_var": 0.21732011062127574, "kl": 0.012829973664942873, "entropy": 0.6098948889150821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 741.0948673647298, "episode_reward_min": -53.42292152064988, "episode_reward_mean": 181.90728725118552, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1618.2914975960452, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1622.7914975960452}, "policy_reward_mean": {"prey_policy": -500.216568801418, "predator_policy": 591.1702124270114}, "custom_metrics": {}, "hist_stats": {"episode_reward": [402.11759900190975, 548.7000000000023, 160.73527851541937, 29.100000000000144, 7.49194776032925, 127.8912183082054, 455.68423914429485, 402.30252057855836, -0.8053255455714403, 126.05450210035667, 6.799999999999997, 104.0077637585006, 239.42286961059196, 32.0000000000002, 10.543428764270935, 224.33424648918736, 243.26354315591993, 64.82982278865651, 45.11519704428133, 418.38244061117945, 512.167324183569, 367.9214489732478, 129.43590176003107, 247.56946445678304, -17.092623680576814, 117.43726132535139, 162.1162565262091, 185.28745078723233, 82.82100496010477, 62.258314117633724, 302.6753800873844, 17.872810533516372, 83.15571922446195, 19.00630587783896, 25.83019981987438, 538.4484326096551, 55.86837627487466, 213.2915518655908, 155.80339527127927, 395.424225916999, 203.57657085036848, 500.61393985612756, 67.70000000000043, 48.10000000000004, 43.364054810029174, 155.81192773793072, 70.93490298568737, 7.846348668216047, 410.50833567913384, 44.210992599135075, 282.7929938478636, 105.58469438907275, 94.34429649450156, 166.2007695369835, 72.54720485461672, 17.099999999999984, -12.326855335955202, 80.42821678456687, 42.96960586306087, 187.5382137492661, 390.0999999999997, 115.05016362064364, 645.7188041762919, 35.64029909237771, 222.99598865053161, 45.3330212976205, 4.010958698165373, 24.302675350735353, 200.7726307789881, 253.28339726085224, 116.67308090302683, 270.40000000000197, -53.42292152064988, 283.81115494286786, 572.3624844283535, 44.51135818172011, 305.3901107002325, 181.14090209316169, 72.90000000000013, 78.59999999999981, 173.9374707434096, 365.21089100059, 159.59999999999962, 165.59999999999803, 380.83762161811285, 209.71033161561235, 137.29181053887157, 213.39913754168387, 167.86590331990993, 60.34669540819036, 51.9373018801809, 741.0948673647298, 513.3393565858045, 160.25590068243804, 51.037953099351526, 80.63131429396955, 54.40000000000051, 81.04093866620497, 215.85999607939138, 502.64141967741904], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-855.8343017046111, 350.1726814658714, 385.7190585059827, -8.643751554604368, -197.8784512309034, -305.0321900819431, -460.6753263040774, -955.6088795211516, -1340.9198463420219, -941.9355285486618, -98.38541279995762, -968.6622355686969, -822.9481157414382, 383.8173887239609, 40.0000000000003, -590.8666441102439, -1315.534284093637, -1156.2586997529802, -572.7790393183333, -145.36422535178457, -684.0812401875436, -1042.9525813269652, -670.9603731397058, -204.08036262789227, -623.3025897281823, -1272.1911056679717, -169.8839294891269, -1187.0961684633733, -1618.2914975960452, -784.1613337513421, -730.5873580299714, -324.77654978570706, -439.05055073759985, -685.0042983806068, -416.566376073151, -711.4734614223246, -246.8262556075199, -205.19908637936334, -643.341854102956, -242.56854921505663, 295.5463519833289, -401.0598884433674, -772.8358780316051, 331.2473477587989, -843.4365767396605, 8.31966140961298, -82.34552898553505, -1057.2512993337625, -337.952313148858, -583.9679431397345, -926.0754186918373, -891.7674503600697, 36.59463038142586, -414.4091568776721, -473.15358737814506, -612.2001387579373, -244.09905124178266, -440.1409788068478, -1062.8211128331263, 31.760394717823313, -1336.210872996541, 28.50818046983852, -666.3075762572728, -769.2452310175137, -87.57151831845623, -1065.8497820408309, -512.7521623190185, -591.3968733199001, -1510.0985030582299, -805.0266785266637, -1170.853573388443, 17.93455118094652, -561.0630092950375, -1160.481164069238, -889.8947007046115, -780.3767218126286, -633.8296924211569, -1430.7057928907984, -666.3676043930675, 38.87309893315555, -11.95795516451519, -1066.0858387599528, 372.84562593224126, -136.42888657291098, -144.25615151915105, 37.59525040003331, -560.8074706848032, -925.1338124706092, -1137.899530608858, -458.0200903977928, -644.7746614816679, -268.7130348916557, -395.2927282582562, -972.1176267533086, -789.8038051744696, -642.1292886912091, -554.4812497944946, -907.9916639237484, -715.6034775428969, -614.1451335376478, -51.44483747706158, -1450.5378522288222, -987.3350844063624, 38.67235152901048, -503.4667640031903, -331.34606392615933, -1298.4702975841303, -330.5519268025167, -145.167732839118, -488.54926089159886, -729.7006236381676, -1451.1223110423418, -274.2660899822618, -595.789219441566, 40.90000000000031, -422.2583319178967, -568.3408557559106, -633.4418447682821, -1052.4888471642064, -538.3509290016431, 365.53718320972575, -575.285200681487, -363.1649757774135, -516.1544383321927, -984.9199013712825, 90.91926131169407, -698.4375067499413, -720.0238345008439, -716.71067365637, -514.3711723306546, -566.4530737584768, 32.51443562631158, -799.4605478251223, -1184.7337233544697, -91.29018469752779, -330.1250952400853, -936.808952487594, 31.38787658940612, -333.33615425677255, -889.3485685172681, -456.73202548561136, -677.0109297567142, -151.6487941681918, 135.53889579623234, -964.6639471920957, -354.38676718499187, -429.68166005336474, -491.7629807542881, 13.09113907945234, -800.3277805558224, -286.2797892528909, -817.3953674767699, -748.5598171126613, -234.81491988595639, -729.0432491896918, -677.871041730333, -47.129904602223824, 18.32384570406369, 20.024913356893062, 40.0000000000003, -292.89167031361075, -557.2449328909471, -537.1263542718782, -520.1073987984312, -196.3373921470876, -516.9771988702702, -1420.4385593969469, 157.8999999999985, -137.574489196933, 75.06021319024657, -230.99778100992683, -35.18535272223059, -107.74523763675325, -266.62660996475677, -304.73066537558014, -588.4511184784742, -716.2384227550671, 5.85070982187742, -1121.3666945318264, -510.3726562522989, -838.0756403990601, -356.35912360113844, -479.44906627724345, 370.8207414783054, -699.9099150857809, 400.0, -92.4601139244062, -803.558913180366, -946.1961723657779, -260.4204815106142, -762.0733262336764, -738.2006962353923, -13.568961350551058, -411.8627619968813, -43.57310640337345, 40.0000000000003, -315.95547448259225, -875.3160242002409, 384.55558099579036, -658.4783276004426], "policy_predator_policy_reward": [855.2881052856418, 52.49111395500784, 7.280941494017313, 164.343751554604, 334.81852099182294, 328.8273988364459, 478.07532630408133, 967.3088795211515, 1346.011794102351, 944.3355285486622, 732.6030703543199, 462.3357963225379, 793.225532281789, 101.58943387998501, 485.65812407121996, 467.51104061757803, 1316.734284093637, 1154.2533742074088, 198.25764535801986, 645.9401214124612, 686.3812401875442, 1047.4525813269656, 721.5669937649111, 257.48150576118985, 949.1081588623247, 1185.8084061444256, 196.2839294891254, 1192.6961684633734, 1622.7914975960452, 790.204762515614, 722.084192057361, 557.6139622475046, 625.7168255348638, 741.6015667392675, 282.94860414226576, 909.9210561418676, 196.17186686345133, 300.9686721677135, 615.0772410931152, 689.2156028360773, 216.34594913051336, 401.3349115130941, 47.98644289718226, 761.5235363488717, 356.6070871420979, 607.94572994798, 481.4280723843025, 905.7382203917795, 878.3102406043971, 26.517392003622973, 1065.621243026604, 869.6588873506576, 51.484147593601556, 488.44663542885684, 620.0981057910708, 650.543071132249, 767.0610350087361, 0.0, 1071.0933841388085, 22.225648094128445, 854.8722992294297, 755.5057733846546, 535.9441337626467, 917.4814840456614, 162.08316922962808, 1074.4938503541198, 525.6732975366933, 597.4820439800668, 1492.03641472082, 848.9189666839465, 1069.9738784815984, 621.3935763355485, 683.2841540055279, 1094.1283956336206, 799.4869723006401, 1084.076002082196, 843.5048324077625, 1376.8340481754692, 429.82538711482016, 593.0933442620857, 461.27294380988917, 820.3474209649467, 130.08525853851484, 134.1119419582766, 172.15615151914946, 2.2047495999669566, 898.8972514412469, 635.1440317141688, 1135.0585518926032, 504.2251239240798, 435.4626792684199, 633.8369448428386, 491.3123719029803, 947.032886094276, 795.8145893714812, 643.9648531624147, 839.9274745298362, 1033.0537748675397, 713.8492428412426, 660.1103608384387, 364.352980744605, 1420.4227028091407, 93.4728425130748, 960.7745847533519, 314.4552994787375, 614.701824945117, 1295.1595383119013, 500.0634556117319, 165.2701304838357, 540.9940681014971, 746.8006236381704, 1451.1223110423418, 431.1049039717741, 426.6235501161036, 2.592325382488712, 459.194223319978, 501.6087304220711, 743.1435759651844, 933.0471541463432, 845.330835768773, 16.462816790274246, 583.3852006814861, 671.8259239964112, 322.5436537338481, 872.0505555875759, 667.6688886483048, 796.3985808777117, 657.7030594654545, 891.1343044110424, 562.9435302265177, 577.0403956332949, 2.231263796490333, 799.7605478251223, 1188.4446820526348, 195.59062221290878, 250.12733307544107, 401.54615888558357, 704.6475477915961, 934.2291552015836, 541.7389648333171, 418.03746413618234, 832.3785720091752, 192.24879416819, 94.26110420376699, 325.5212314905774, 940.1065613658664, 557.0962111888919, 648.1595845616287, 657.3991500695073, 702.1999758352126, 324.80384695315365, 823.3826679582282, 570.693946468379, 718.0709012304662, 717.1137564343577, 870.9414365788284, 81.82990460222314, 19.876154295936317, 18.57508664310695, 0.0, 638.6395869413686, 385.4344870065978, 677.386659858025, 745.0579842128781, 424.2286011667665, 448.68598985059384, 1428.1385593969399, 0.0, 204.55944757302302, 238.79245005177285, 247.9668748798696, 227.9265904679019, 242.97218206007233, 268.69147608031545, 503.4517880268994, 603.1291333688403, 182.55604750654868, 695.6975687465562, 1175.4869662038777, 516.5990799884373, 702.4067301291557, 543.9653357512298, 405.639676683829, 444.08351547983887, 265.4658415603547, 547.7834301112294, 303.26059449618253, 753.0143332910269, 883.790374466514, 373.8642325092342, 1290.8332615584534, 290.07207520458746, 50.268961350551535, 429.56276199688534, 74.45870723334012, 10.1553378362382, 739.7976491531413, 667.3338456090827, 113.28731069172665, 663.2768555903444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.802725957865495, "mean_inference_ms": 4.412669607953907, "mean_action_processing_ms": 1.520349996004565, "mean_env_wait_ms": 10.440297180423904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039687275886535645, "StateBufferConnector_ms": 0.005219697952270508, "ViewRequirementAgentConnector_ms": 0.20439374446868896}, "num_episodes": 4, "episode_return_max": 741.0948673647298, "episode_return_min": -53.42292152064988, "episode_return_mean": 181.90728725118552, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.39683173754108, "num_env_steps_trained_throughput_per_sec": 76.39683173754108, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 124553.902, "restore_workers_time_ms": 0.014, "training_step_time_ms": 124553.826, "sample_time_ms": 2754.043, "learn_time_ms": 121776.45, "learn_throughput": 32.847, "synch_weights_time_ms": 18.566}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "35fb9_00000", "date": "2024-08-22_09-01-03", "timestamp": 1724297463, "time_this_iter_s": 52.41908383369446, "time_total_s": 4040.615936756134, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b611c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4040.615936756134, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 36.80666666666667, "ram_util_percent": 82.956}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.45717232731915, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.176304247518065, "policy_loss": -0.021338064875638496, "vf_loss": 5.1948166166033065, "vf_explained_var": 0.5325546107279561, "kl": 0.014128461393907114, "entropy": 0.710250994799629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.15456030747247, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.3142574524753305, "policy_loss": -0.01835020991047184, "vf_loss": 5.330368373129103, "vf_explained_var": 0.38171728338514055, "kl": 0.011196470551596826, "entropy": 0.6155648389979015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 741.0948673647298, "episode_reward_min": -53.42292152064988, "episode_reward_mean": 167.05560260604008, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1618.2914975960452, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1622.7914975960452}, "policy_reward_mean": {"prey_policy": -497.0791251327921, "predator_policy": 580.6069264358127}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.05450210035667, 6.799999999999997, 104.0077637585006, 239.42286961059196, 32.0000000000002, 10.543428764270935, 224.33424648918736, 243.26354315591993, 64.82982278865651, 45.11519704428133, 418.38244061117945, 512.167324183569, 367.9214489732478, 129.43590176003107, 247.56946445678304, -17.092623680576814, 117.43726132535139, 162.1162565262091, 185.28745078723233, 82.82100496010477, 62.258314117633724, 302.6753800873844, 17.872810533516372, 83.15571922446195, 19.00630587783896, 25.83019981987438, 538.4484326096551, 55.86837627487466, 213.2915518655908, 155.80339527127927, 395.424225916999, 203.57657085036848, 500.61393985612756, 67.70000000000043, 48.10000000000004, 43.364054810029174, 155.81192773793072, 70.93490298568737, 7.846348668216047, 410.50833567913384, 44.210992599135075, 282.7929938478636, 105.58469438907275, 94.34429649450156, 166.2007695369835, 72.54720485461672, 17.099999999999984, -12.326855335955202, 80.42821678456687, 42.96960586306087, 187.5382137492661, 390.0999999999997, 115.05016362064364, 645.7188041762919, 35.64029909237771, 222.99598865053161, 45.3330212976205, 4.010958698165373, 24.302675350735353, 200.7726307789881, 253.28339726085224, 116.67308090302683, 270.40000000000197, -53.42292152064988, 283.81115494286786, 572.3624844283535, 44.51135818172011, 305.3901107002325, 181.14090209316169, 72.90000000000013, 78.59999999999981, 173.9374707434096, 365.21089100059, 159.59999999999962, 165.59999999999803, 380.83762161811285, 209.71033161561235, 137.29181053887157, 213.39913754168387, 167.86590331990993, 60.34669540819036, 51.9373018801809, 741.0948673647298, 513.3393565858045, 160.25590068243804, 51.037953099351526, 80.63131429396955, 54.40000000000051, 81.04093866620497, 215.85999607939138, 502.64141967741904, 37.71803398875015, 49.252730108822995, 114.30747997962955, 71.6000000000002, 25.200000000000088, -14.481304259101227, 293.631227704209, 49.93509221758458, 20.885753508713446], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-572.7790393183333, -145.36422535178457, -684.0812401875436, -1042.9525813269652, -670.9603731397058, -204.08036262789227, -623.3025897281823, -1272.1911056679717, -169.8839294891269, -1187.0961684633733, -1618.2914975960452, -784.1613337513421, -730.5873580299714, -324.77654978570706, -439.05055073759985, -685.0042983806068, -416.566376073151, -711.4734614223246, -246.8262556075199, -205.19908637936334, -643.341854102956, -242.56854921505663, 295.5463519833289, -401.0598884433674, -772.8358780316051, 331.2473477587989, -843.4365767396605, 8.31966140961298, -82.34552898553505, -1057.2512993337625, -337.952313148858, -583.9679431397345, -926.0754186918373, -891.7674503600697, 36.59463038142586, -414.4091568776721, -473.15358737814506, -612.2001387579373, -244.09905124178266, -440.1409788068478, -1062.8211128331263, 31.760394717823313, -1336.210872996541, 28.50818046983852, -666.3075762572728, -769.2452310175137, -87.57151831845623, -1065.8497820408309, -512.7521623190185, -591.3968733199001, -1510.0985030582299, -805.0266785266637, -1170.853573388443, 17.93455118094652, -561.0630092950375, -1160.481164069238, -889.8947007046115, -780.3767218126286, -633.8296924211569, -1430.7057928907984, -666.3676043930675, 38.87309893315555, -11.95795516451519, -1066.0858387599528, 372.84562593224126, -136.42888657291098, -144.25615151915105, 37.59525040003331, -560.8074706848032, -925.1338124706092, -1137.899530608858, -458.0200903977928, -644.7746614816679, -268.7130348916557, -395.2927282582562, -972.1176267533086, -789.8038051744696, -642.1292886912091, -554.4812497944946, -907.9916639237484, -715.6034775428969, -614.1451335376478, -51.44483747706158, -1450.5378522288222, -987.3350844063624, 38.67235152901048, -503.4667640031903, -331.34606392615933, -1298.4702975841303, -330.5519268025167, -145.167732839118, -488.54926089159886, -729.7006236381676, -1451.1223110423418, -274.2660899822618, -595.789219441566, 40.90000000000031, -422.2583319178967, -568.3408557559106, -633.4418447682821, -1052.4888471642064, -538.3509290016431, 365.53718320972575, -575.285200681487, -363.1649757774135, -516.1544383321927, -984.9199013712825, 90.91926131169407, -698.4375067499413, -720.0238345008439, -716.71067365637, -514.3711723306546, -566.4530737584768, 32.51443562631158, -799.4605478251223, -1184.7337233544697, -91.29018469752779, -330.1250952400853, -936.808952487594, 31.38787658940612, -333.33615425677255, -889.3485685172681, -456.73202548561136, -677.0109297567142, -151.6487941681918, 135.53889579623234, -964.6639471920957, -354.38676718499187, -429.68166005336474, -491.7629807542881, 13.09113907945234, -800.3277805558224, -286.2797892528909, -817.3953674767699, -748.5598171126613, -234.81491988595639, -729.0432491896918, -677.871041730333, -47.129904602223824, 18.32384570406369, 20.024913356893062, 40.0000000000003, -292.89167031361075, -557.2449328909471, -537.1263542718782, -520.1073987984312, -196.3373921470876, -516.9771988702702, -1420.4385593969469, 157.8999999999985, -137.574489196933, 75.06021319024657, -230.99778100992683, -35.18535272223059, -107.74523763675325, -266.62660996475677, -304.73066537558014, -588.4511184784742, -716.2384227550671, 5.85070982187742, -1121.3666945318264, -510.3726562522989, -838.0756403990601, -356.35912360113844, -479.44906627724345, 370.8207414783054, -699.9099150857809, 400.0, -92.4601139244062, -803.558913180366, -946.1961723657779, -260.4204815106142, -762.0733262336764, -738.2006962353923, -13.568961350551058, -411.8627619968813, -43.57310640337345, 40.0000000000003, -315.95547448259225, -875.3160242002409, 384.55558099579036, -658.4783276004426, -84.25928467523512, -823.9104286361852, -447.292872505867, -10.311522314218756, -1035.6038650751825, -49.72472311010272, -14.129313077645483, -12.738541446431958, -489.3250910385338, -1129.104836324588, -668.3575256522978, -503.6024174633716, -298.7066811962521, -227.394445610006, -469.4324019360572, -902.0730969373332, -561.9391133371305, -504.07964459747643], "policy_predator_policy_reward": [198.25764535801986, 645.9401214124612, 686.3812401875442, 1047.4525813269656, 721.5669937649111, 257.48150576118985, 949.1081588623247, 1185.8084061444256, 196.2839294891254, 1192.6961684633734, 1622.7914975960452, 790.204762515614, 722.084192057361, 557.6139622475046, 625.7168255348638, 741.6015667392675, 282.94860414226576, 909.9210561418676, 196.17186686345133, 300.9686721677135, 615.0772410931152, 689.2156028360773, 216.34594913051336, 401.3349115130941, 47.98644289718226, 761.5235363488717, 356.6070871420979, 607.94572994798, 481.4280723843025, 905.7382203917795, 878.3102406043971, 26.517392003622973, 1065.621243026604, 869.6588873506576, 51.484147593601556, 488.44663542885684, 620.0981057910708, 650.543071132249, 767.0610350087361, 0.0, 1071.0933841388085, 22.225648094128445, 854.8722992294297, 755.5057733846546, 535.9441337626467, 917.4814840456614, 162.08316922962808, 1074.4938503541198, 525.6732975366933, 597.4820439800668, 1492.03641472082, 848.9189666839465, 1069.9738784815984, 621.3935763355485, 683.2841540055279, 1094.1283956336206, 799.4869723006401, 1084.076002082196, 843.5048324077625, 1376.8340481754692, 429.82538711482016, 593.0933442620857, 461.27294380988917, 820.3474209649467, 130.08525853851484, 134.1119419582766, 172.15615151914946, 2.2047495999669566, 898.8972514412469, 635.1440317141688, 1135.0585518926032, 504.2251239240798, 435.4626792684199, 633.8369448428386, 491.3123719029803, 947.032886094276, 795.8145893714812, 643.9648531624147, 839.9274745298362, 1033.0537748675397, 713.8492428412426, 660.1103608384387, 364.352980744605, 1420.4227028091407, 93.4728425130748, 960.7745847533519, 314.4552994787375, 614.701824945117, 1295.1595383119013, 500.0634556117319, 165.2701304838357, 540.9940681014971, 746.8006236381704, 1451.1223110423418, 431.1049039717741, 426.6235501161036, 2.592325382488712, 459.194223319978, 501.6087304220711, 743.1435759651844, 933.0471541463432, 845.330835768773, 16.462816790274246, 583.3852006814861, 671.8259239964112, 322.5436537338481, 872.0505555875759, 667.6688886483048, 796.3985808777117, 657.7030594654545, 891.1343044110424, 562.9435302265177, 577.0403956332949, 2.231263796490333, 799.7605478251223, 1188.4446820526348, 195.59062221290878, 250.12733307544107, 401.54615888558357, 704.6475477915961, 934.2291552015836, 541.7389648333171, 418.03746413618234, 832.3785720091752, 192.24879416819, 94.26110420376699, 325.5212314905774, 940.1065613658664, 557.0962111888919, 648.1595845616287, 657.3991500695073, 702.1999758352126, 324.80384695315365, 823.3826679582282, 570.693946468379, 718.0709012304662, 717.1137564343577, 870.9414365788284, 81.82990460222314, 19.876154295936317, 18.57508664310695, 0.0, 638.6395869413686, 385.4344870065978, 677.386659858025, 745.0579842128781, 424.2286011667665, 448.68598985059384, 1428.1385593969399, 0.0, 204.55944757302302, 238.79245005177285, 247.9668748798696, 227.9265904679019, 242.97218206007233, 268.69147608031545, 503.4517880268994, 603.1291333688403, 182.55604750654868, 695.6975687465562, 1175.4869662038777, 516.5990799884373, 702.4067301291557, 543.9653357512298, 405.639676683829, 444.08351547983887, 265.4658415603547, 547.7834301112294, 303.26059449618253, 753.0143332910269, 883.790374466514, 373.8642325092342, 1290.8332615584534, 290.07207520458746, 50.268961350551535, 429.56276199688534, 74.45870723334012, 10.1553378362382, 739.7976491531413, 667.3338456090827, 113.28731069172665, 663.2768555903444, 701.9723039348129, 243.91544336535569, 506.8571249289118, 0.0, 163.72241589376392, 1035.9136522711512, 91.97459750604331, 6.49325701803497, 508.7250910385382, 1134.9048363245881, 451.35465503549034, 706.123983821083, 774.5674199862962, 45.164934524169155, 703.3375458192647, 718.1030452717152, 541.1951323600751, 545.709379083246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.797599424252607, "mean_inference_ms": 4.405744630644954, "mean_action_processing_ms": 1.515825445210928, "mean_env_wait_ms": 10.441881523486936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03969407081604004, "StateBufferConnector_ms": 0.005250215530395508, "ViewRequirementAgentConnector_ms": 0.2040388584136963}, "num_episodes": 9, "episode_return_max": 741.0948673647298, "episode_return_min": -53.42292152064988, "episode_return_mean": 167.05560260604008, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.4184882643365, "num_env_steps_trained_throughput_per_sec": 80.4184882643365, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 124468.345, "restore_workers_time_ms": 0.014, "training_step_time_ms": 124468.269, "sample_time_ms": 2761.104, "learn_time_ms": 121683.97, "learn_throughput": 32.872, "synch_weights_time_ms": 18.46}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "35fb9_00000", "date": "2024-08-22_09-01-52", "timestamp": 1724297512, "time_this_iter_s": 49.78503704071045, "time_total_s": 4090.4009737968445, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc8b670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4090.4009737968445, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 31.052857142857146, "ram_util_percent": 83.28857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.768064145877878, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.015338504882086, "policy_loss": -0.02246704869878986, "vf_loss": 5.035213246799651, "vf_explained_var": 0.5573930181838848, "kl": 0.012961545403770827, "entropy": 0.6852504203874598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.93192346985378, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.2142745774889745, "policy_loss": -0.022144532256892748, "vf_loss": 5.234089314874518, "vf_explained_var": 0.2630487671604863, "kl": 0.011648942921162834, "entropy": 0.5983183936782615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 741.0948673647298, "episode_reward_min": -121.90847536196947, "episode_reward_mean": 163.46392992547123, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1632.5131871732658, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1628.4005983180482}, "policy_reward_mean": {"prey_policy": -468.301427857716, "predator_policy": 550.0333928204523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [512.167324183569, 367.9214489732478, 129.43590176003107, 247.56946445678304, -17.092623680576814, 117.43726132535139, 162.1162565262091, 185.28745078723233, 82.82100496010477, 62.258314117633724, 302.6753800873844, 17.872810533516372, 83.15571922446195, 19.00630587783896, 25.83019981987438, 538.4484326096551, 55.86837627487466, 213.2915518655908, 155.80339527127927, 395.424225916999, 203.57657085036848, 500.61393985612756, 67.70000000000043, 48.10000000000004, 43.364054810029174, 155.81192773793072, 70.93490298568737, 7.846348668216047, 410.50833567913384, 44.210992599135075, 282.7929938478636, 105.58469438907275, 94.34429649450156, 166.2007695369835, 72.54720485461672, 17.099999999999984, -12.326855335955202, 80.42821678456687, 42.96960586306087, 187.5382137492661, 390.0999999999997, 115.05016362064364, 645.7188041762919, 35.64029909237771, 222.99598865053161, 45.3330212976205, 4.010958698165373, 24.302675350735353, 200.7726307789881, 253.28339726085224, 116.67308090302683, 270.40000000000197, -53.42292152064988, 283.81115494286786, 572.3624844283535, 44.51135818172011, 305.3901107002325, 181.14090209316169, 72.90000000000013, 78.59999999999981, 173.9374707434096, 365.21089100059, 159.59999999999962, 165.59999999999803, 380.83762161811285, 209.71033161561235, 137.29181053887157, 213.39913754168387, 167.86590331990993, 60.34669540819036, 51.9373018801809, 741.0948673647298, 513.3393565858045, 160.25590068243804, 51.037953099351526, 80.63131429396955, 54.40000000000051, 81.04093866620497, 215.85999607939138, 502.64141967741904, 37.71803398875015, 49.252730108822995, 114.30747997962955, 71.6000000000002, 25.200000000000088, -14.481304259101227, 293.631227704209, 49.93509221758458, 20.885753508713446, 182.35568028020467, 28.933954284994947, -121.90847536196947, 329.5999847533703, 42.40656691789585, 79.00421627885822, 67.58277296286835, 109.53943838119581, 12.253533792723731, 48.70658350974759, 377.1122904661684], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [295.5463519833289, -401.0598884433674, -772.8358780316051, 331.2473477587989, -843.4365767396605, 8.31966140961298, -82.34552898553505, -1057.2512993337625, -337.952313148858, -583.9679431397345, -926.0754186918373, -891.7674503600697, 36.59463038142586, -414.4091568776721, -473.15358737814506, -612.2001387579373, -244.09905124178266, -440.1409788068478, -1062.8211128331263, 31.760394717823313, -1336.210872996541, 28.50818046983852, -666.3075762572728, -769.2452310175137, -87.57151831845623, -1065.8497820408309, -512.7521623190185, -591.3968733199001, -1510.0985030582299, -805.0266785266637, -1170.853573388443, 17.93455118094652, -561.0630092950375, -1160.481164069238, -889.8947007046115, -780.3767218126286, -633.8296924211569, -1430.7057928907984, -666.3676043930675, 38.87309893315555, -11.95795516451519, -1066.0858387599528, 372.84562593224126, -136.42888657291098, -144.25615151915105, 37.59525040003331, -560.8074706848032, -925.1338124706092, -1137.899530608858, -458.0200903977928, -644.7746614816679, -268.7130348916557, -395.2927282582562, -972.1176267533086, -789.8038051744696, -642.1292886912091, -554.4812497944946, -907.9916639237484, -715.6034775428969, -614.1451335376478, -51.44483747706158, -1450.5378522288222, -987.3350844063624, 38.67235152901048, -503.4667640031903, -331.34606392615933, -1298.4702975841303, -330.5519268025167, -145.167732839118, -488.54926089159886, -729.7006236381676, -1451.1223110423418, -274.2660899822618, -595.789219441566, 40.90000000000031, -422.2583319178967, -568.3408557559106, -633.4418447682821, -1052.4888471642064, -538.3509290016431, 365.53718320972575, -575.285200681487, -363.1649757774135, -516.1544383321927, -984.9199013712825, 90.91926131169407, -698.4375067499413, -720.0238345008439, -716.71067365637, -514.3711723306546, -566.4530737584768, 32.51443562631158, -799.4605478251223, -1184.7337233544697, -91.29018469752779, -330.1250952400853, -936.808952487594, 31.38787658940612, -333.33615425677255, -889.3485685172681, -456.73202548561136, -677.0109297567142, -151.6487941681918, 135.53889579623234, -964.6639471920957, -354.38676718499187, -429.68166005336474, -491.7629807542881, 13.09113907945234, -800.3277805558224, -286.2797892528909, -817.3953674767699, -748.5598171126613, -234.81491988595639, -729.0432491896918, -677.871041730333, -47.129904602223824, 18.32384570406369, 20.024913356893062, 40.0000000000003, -292.89167031361075, -557.2449328909471, -537.1263542718782, -520.1073987984312, -196.3373921470876, -516.9771988702702, -1420.4385593969469, 157.8999999999985, -137.574489196933, 75.06021319024657, -230.99778100992683, -35.18535272223059, -107.74523763675325, -266.62660996475677, -304.73066537558014, -588.4511184784742, -716.2384227550671, 5.85070982187742, -1121.3666945318264, -510.3726562522989, -838.0756403990601, -356.35912360113844, -479.44906627724345, 370.8207414783054, -699.9099150857809, 400.0, -92.4601139244062, -803.558913180366, -946.1961723657779, -260.4204815106142, -762.0733262336764, -738.2006962353923, -13.568961350551058, -411.8627619968813, -43.57310640337345, 40.0000000000003, -315.95547448259225, -875.3160242002409, 384.55558099579036, -658.4783276004426, -84.25928467523512, -823.9104286361852, -447.292872505867, -10.311522314218756, -1035.6038650751825, -49.72472311010272, -14.129313077645483, -12.738541446431958, -489.3250910385338, -1129.104836324588, -668.3575256522978, -503.6024174633716, -298.7066811962521, -227.394445610006, -469.4324019360572, -902.0730969373332, -561.9391133371305, -504.07964459747643, -157.60429043448582, -12.538992799440962, -765.0984663563507, -321.0510566126083, -436.5469963702042, -466.2080999783565, -31.283467381187855, -497.2961421497664, -316.75983338340933, -283.3908242482087, -18.068544360502578, -428.74808279582095, 18.304492602824244, -465.2397427613773, -1632.5131871732658, -24.07491413151537, -321.672851140659, -859.8383827692014, -270.1437220400188, -637.740446583958, 156.06035684857656, -93.54613734836866], "policy_predator_policy_reward": [216.34594913051336, 401.3349115130941, 47.98644289718226, 761.5235363488717, 356.6070871420979, 607.94572994798, 481.4280723843025, 905.7382203917795, 878.3102406043971, 26.517392003622973, 1065.621243026604, 869.6588873506576, 51.484147593601556, 488.44663542885684, 620.0981057910708, 650.543071132249, 767.0610350087361, 0.0, 1071.0933841388085, 22.225648094128445, 854.8722992294297, 755.5057733846546, 535.9441337626467, 917.4814840456614, 162.08316922962808, 1074.4938503541198, 525.6732975366933, 597.4820439800668, 1492.03641472082, 848.9189666839465, 1069.9738784815984, 621.3935763355485, 683.2841540055279, 1094.1283956336206, 799.4869723006401, 1084.076002082196, 843.5048324077625, 1376.8340481754692, 429.82538711482016, 593.0933442620857, 461.27294380988917, 820.3474209649467, 130.08525853851484, 134.1119419582766, 172.15615151914946, 2.2047495999669566, 898.8972514412469, 635.1440317141688, 1135.0585518926032, 504.2251239240798, 435.4626792684199, 633.8369448428386, 491.3123719029803, 947.032886094276, 795.8145893714812, 643.9648531624147, 839.9274745298362, 1033.0537748675397, 713.8492428412426, 660.1103608384387, 364.352980744605, 1420.4227028091407, 93.4728425130748, 960.7745847533519, 314.4552994787375, 614.701824945117, 1295.1595383119013, 500.0634556117319, 165.2701304838357, 540.9940681014971, 746.8006236381704, 1451.1223110423418, 431.1049039717741, 426.6235501161036, 2.592325382488712, 459.194223319978, 501.6087304220711, 743.1435759651844, 933.0471541463432, 845.330835768773, 16.462816790274246, 583.3852006814861, 671.8259239964112, 322.5436537338481, 872.0505555875759, 667.6688886483048, 796.3985808777117, 657.7030594654545, 891.1343044110424, 562.9435302265177, 577.0403956332949, 2.231263796490333, 799.7605478251223, 1188.4446820526348, 195.59062221290878, 250.12733307544107, 401.54615888558357, 704.6475477915961, 934.2291552015836, 541.7389648333171, 418.03746413618234, 832.3785720091752, 192.24879416819, 94.26110420376699, 325.5212314905774, 940.1065613658664, 557.0962111888919, 648.1595845616287, 657.3991500695073, 702.1999758352126, 324.80384695315365, 823.3826679582282, 570.693946468379, 718.0709012304662, 717.1137564343577, 870.9414365788284, 81.82990460222314, 19.876154295936317, 18.57508664310695, 0.0, 638.6395869413686, 385.4344870065978, 677.386659858025, 745.0579842128781, 424.2286011667665, 448.68598985059384, 1428.1385593969399, 0.0, 204.55944757302302, 238.79245005177285, 247.9668748798696, 227.9265904679019, 242.97218206007233, 268.69147608031545, 503.4517880268994, 603.1291333688403, 182.55604750654868, 695.6975687465562, 1175.4869662038777, 516.5990799884373, 702.4067301291557, 543.9653357512298, 405.639676683829, 444.08351547983887, 265.4658415603547, 547.7834301112294, 303.26059449618253, 753.0143332910269, 883.790374466514, 373.8642325092342, 1290.8332615584534, 290.07207520458746, 50.268961350551535, 429.56276199688534, 74.45870723334012, 10.1553378362382, 739.7976491531413, 667.3338456090827, 113.28731069172665, 663.2768555903444, 701.9723039348129, 243.91544336535569, 506.8571249289118, 0.0, 163.72241589376392, 1035.9136522711512, 91.97459750604331, 6.49325701803497, 508.7250910385382, 1134.9048363245881, 451.35465503549034, 706.123983821083, 774.5674199862962, 45.164934524169155, 703.3375458192647, 718.1030452717152, 541.1951323600751, 545.709379083246, 196.95653921686045, 155.54242429726904, 184.44819761318277, 930.63527964078, 199.4760819065468, 581.3705390800479, 436.6753207227322, 421.5042735615952, 160.97703030609622, 481.58019424342444, 328.0094685699285, 197.81137486525762, 18.614999014348335, 495.9030241070781, 1628.4005983180482, 137.72694136792933, 335.22306920191323, 858.5416985006707, 563.0052921867236, 393.5854599470067, 221.36736082231397, 93.23071014364344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.789537802871583, "mean_inference_ms": 4.401849037949444, "mean_action_processing_ms": 1.511771767722473, "mean_env_wait_ms": 10.452165520599085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029837965965270996, "StateBufferConnector_ms": 0.005303859710693359, "ViewRequirementAgentConnector_ms": 0.20679426193237305}, "num_episodes": 11, "episode_return_max": 741.0948673647298, "episode_return_min": -121.90847536196947, "episode_return_mean": 163.46392992547123, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.62923488040799, "num_env_steps_trained_throughput_per_sec": 79.62923488040799, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 124596.064, "restore_workers_time_ms": 0.014, "training_step_time_ms": 124595.989, "sample_time_ms": 2767.028, "learn_time_ms": 121805.429, "learn_throughput": 32.839, "synch_weights_time_ms": 18.479}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "35fb9_00000", "date": "2024-08-22_09-02-43", "timestamp": 1724297563, "time_this_iter_s": 50.27156686782837, "time_total_s": 4140.672540664673, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcbd940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4140.672540664673, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 31.379166666666663, "ram_util_percent": 82.69722222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.28449026983251, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.025322414201403, "policy_loss": -0.02448996347523043, "vf_loss": 5.047213000721402, "vf_explained_var": 0.4885545085977625, "kl": 0.012996976096527996, "entropy": 0.7154032953832515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.769228422011016, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.307407822684636, "policy_loss": -0.023813962411115726, "vf_loss": 5.3287329048076, "vf_explained_var": 0.3140243484229638, "kl": 0.01244441206559598, "entropy": 0.5997717771895978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 970.9600000000065}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 741.0948673647298, "episode_reward_min": -121.90847536196947, "episode_reward_mean": 165.4441470189959, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1632.5131871732658, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1628.4005983180482}, "policy_reward_mean": {"prey_policy": -451.49913941502774, "predator_policy": 534.2212129245265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.6753800873844, 17.872810533516372, 83.15571922446195, 19.00630587783896, 25.83019981987438, 538.4484326096551, 55.86837627487466, 213.2915518655908, 155.80339527127927, 395.424225916999, 203.57657085036848, 500.61393985612756, 67.70000000000043, 48.10000000000004, 43.364054810029174, 155.81192773793072, 70.93490298568737, 7.846348668216047, 410.50833567913384, 44.210992599135075, 282.7929938478636, 105.58469438907275, 94.34429649450156, 166.2007695369835, 72.54720485461672, 17.099999999999984, -12.326855335955202, 80.42821678456687, 42.96960586306087, 187.5382137492661, 390.0999999999997, 115.05016362064364, 645.7188041762919, 35.64029909237771, 222.99598865053161, 45.3330212976205, 4.010958698165373, 24.302675350735353, 200.7726307789881, 253.28339726085224, 116.67308090302683, 270.40000000000197, -53.42292152064988, 283.81115494286786, 572.3624844283535, 44.51135818172011, 305.3901107002325, 181.14090209316169, 72.90000000000013, 78.59999999999981, 173.9374707434096, 365.21089100059, 159.59999999999962, 165.59999999999803, 380.83762161811285, 209.71033161561235, 137.29181053887157, 213.39913754168387, 167.86590331990993, 60.34669540819036, 51.9373018801809, 741.0948673647298, 513.3393565858045, 160.25590068243804, 51.037953099351526, 80.63131429396955, 54.40000000000051, 81.04093866620497, 215.85999607939138, 502.64141967741904, 37.71803398875015, 49.252730108822995, 114.30747997962955, 71.6000000000002, 25.200000000000088, -14.481304259101227, 293.631227704209, 49.93509221758458, 20.885753508713446, 182.35568028020467, 28.933954284994947, -121.90847536196947, 329.5999847533703, 42.40656691789585, 79.00421627885822, 67.58277296286835, 109.53943838119581, 12.253533792723731, 48.70658350974759, 377.1122904661684, 188.08684927850737, 284.14037404572474, 35.02404481804818, 253.41193201983097, 73.62436674992966, 473.29655077707275, 361.11597928626736, 19.10147461371583, 155.4432201576657, 204.69872101529307], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1336.210872996541, 28.50818046983852, -666.3075762572728, -769.2452310175137, -87.57151831845623, -1065.8497820408309, -512.7521623190185, -591.3968733199001, -1510.0985030582299, -805.0266785266637, -1170.853573388443, 17.93455118094652, -561.0630092950375, -1160.481164069238, -889.8947007046115, -780.3767218126286, -633.8296924211569, -1430.7057928907984, -666.3676043930675, 38.87309893315555, -11.95795516451519, -1066.0858387599528, 372.84562593224126, -136.42888657291098, -144.25615151915105, 37.59525040003331, -560.8074706848032, -925.1338124706092, -1137.899530608858, -458.0200903977928, -644.7746614816679, -268.7130348916557, -395.2927282582562, -972.1176267533086, -789.8038051744696, -642.1292886912091, -554.4812497944946, -907.9916639237484, -715.6034775428969, -614.1451335376478, -51.44483747706158, -1450.5378522288222, -987.3350844063624, 38.67235152901048, -503.4667640031903, -331.34606392615933, -1298.4702975841303, -330.5519268025167, -145.167732839118, -488.54926089159886, -729.7006236381676, -1451.1223110423418, -274.2660899822618, -595.789219441566, 40.90000000000031, -422.2583319178967, -568.3408557559106, -633.4418447682821, -1052.4888471642064, -538.3509290016431, 365.53718320972575, -575.285200681487, -363.1649757774135, -516.1544383321927, -984.9199013712825, 90.91926131169407, -698.4375067499413, -720.0238345008439, -716.71067365637, -514.3711723306546, -566.4530737584768, 32.51443562631158, -799.4605478251223, -1184.7337233544697, -91.29018469752779, -330.1250952400853, -936.808952487594, 31.38787658940612, -333.33615425677255, -889.3485685172681, -456.73202548561136, -677.0109297567142, -151.6487941681918, 135.53889579623234, -964.6639471920957, -354.38676718499187, -429.68166005336474, -491.7629807542881, 13.09113907945234, -800.3277805558224, -286.2797892528909, -817.3953674767699, -748.5598171126613, -234.81491988595639, -729.0432491896918, -677.871041730333, -47.129904602223824, 18.32384570406369, 20.024913356893062, 40.0000000000003, -292.89167031361075, -557.2449328909471, -537.1263542718782, -520.1073987984312, -196.3373921470876, -516.9771988702702, -1420.4385593969469, 157.8999999999985, -137.574489196933, 75.06021319024657, -230.99778100992683, -35.18535272223059, -107.74523763675325, -266.62660996475677, -304.73066537558014, -588.4511184784742, -716.2384227550671, 5.85070982187742, -1121.3666945318264, -510.3726562522989, -838.0756403990601, -356.35912360113844, -479.44906627724345, 370.8207414783054, -699.9099150857809, 400.0, -92.4601139244062, -803.558913180366, -946.1961723657779, -260.4204815106142, -762.0733262336764, -738.2006962353923, -13.568961350551058, -411.8627619968813, -43.57310640337345, 40.0000000000003, -315.95547448259225, -875.3160242002409, 384.55558099579036, -658.4783276004426, -84.25928467523512, -823.9104286361852, -447.292872505867, -10.311522314218756, -1035.6038650751825, -49.72472311010272, -14.129313077645483, -12.738541446431958, -489.3250910385338, -1129.104836324588, -668.3575256522978, -503.6024174633716, -298.7066811962521, -227.394445610006, -469.4324019360572, -902.0730969373332, -561.9391133371305, -504.07964459747643, -157.60429043448582, -12.538992799440962, -765.0984663563507, -321.0510566126083, -436.5469963702042, -466.2080999783565, -31.283467381187855, -497.2961421497664, -316.75983338340933, -283.3908242482087, -18.068544360502578, -428.74808279582095, 18.304492602824244, -465.2397427613773, -1632.5131871732658, -24.07491413151537, -321.672851140659, -859.8383827692014, -270.1437220400188, -637.740446583958, 156.06035684857656, -93.54613734836866, -37.086788053447094, -322.37538185680654, -153.98854255348468, -622.3434610313144, -196.69858277824744, -686.9793200172637, -48.748739859434416, -574.5101903898071, 25.592667879579352, -69.50600824640702, -757.1308353177515, 383.21690450358426, 268.23075752069843, -572.1371232701156, -203.6321288637337, -362.546029073424, -232.8010918559712, -109.87698074691019, -276.6448461423045, -529.6245278287456], "policy_predator_policy_reward": [854.8722992294297, 755.5057733846546, 535.9441337626467, 917.4814840456614, 162.08316922962808, 1074.4938503541198, 525.6732975366933, 597.4820439800668, 1492.03641472082, 848.9189666839465, 1069.9738784815984, 621.3935763355485, 683.2841540055279, 1094.1283956336206, 799.4869723006401, 1084.076002082196, 843.5048324077625, 1376.8340481754692, 429.82538711482016, 593.0933442620857, 461.27294380988917, 820.3474209649467, 130.08525853851484, 134.1119419582766, 172.15615151914946, 2.2047495999669566, 898.8972514412469, 635.1440317141688, 1135.0585518926032, 504.2251239240798, 435.4626792684199, 633.8369448428386, 491.3123719029803, 947.032886094276, 795.8145893714812, 643.9648531624147, 839.9274745298362, 1033.0537748675397, 713.8492428412426, 660.1103608384387, 364.352980744605, 1420.4227028091407, 93.4728425130748, 960.7745847533519, 314.4552994787375, 614.701824945117, 1295.1595383119013, 500.0634556117319, 165.2701304838357, 540.9940681014971, 746.8006236381704, 1451.1223110423418, 431.1049039717741, 426.6235501161036, 2.592325382488712, 459.194223319978, 501.6087304220711, 743.1435759651844, 933.0471541463432, 845.330835768773, 16.462816790274246, 583.3852006814861, 671.8259239964112, 322.5436537338481, 872.0505555875759, 667.6688886483048, 796.3985808777117, 657.7030594654545, 891.1343044110424, 562.9435302265177, 577.0403956332949, 2.231263796490333, 799.7605478251223, 1188.4446820526348, 195.59062221290878, 250.12733307544107, 401.54615888558357, 704.6475477915961, 934.2291552015836, 541.7389648333171, 418.03746413618234, 832.3785720091752, 192.24879416819, 94.26110420376699, 325.5212314905774, 940.1065613658664, 557.0962111888919, 648.1595845616287, 657.3991500695073, 702.1999758352126, 324.80384695315365, 823.3826679582282, 570.693946468379, 718.0709012304662, 717.1137564343577, 870.9414365788284, 81.82990460222314, 19.876154295936317, 18.57508664310695, 0.0, 638.6395869413686, 385.4344870065978, 677.386659858025, 745.0579842128781, 424.2286011667665, 448.68598985059384, 1428.1385593969399, 0.0, 204.55944757302302, 238.79245005177285, 247.9668748798696, 227.9265904679019, 242.97218206007233, 268.69147608031545, 503.4517880268994, 603.1291333688403, 182.55604750654868, 695.6975687465562, 1175.4869662038777, 516.5990799884373, 702.4067301291557, 543.9653357512298, 405.639676683829, 444.08351547983887, 265.4658415603547, 547.7834301112294, 303.26059449618253, 753.0143332910269, 883.790374466514, 373.8642325092342, 1290.8332615584534, 290.07207520458746, 50.268961350551535, 429.56276199688534, 74.45870723334012, 10.1553378362382, 739.7976491531413, 667.3338456090827, 113.28731069172665, 663.2768555903444, 701.9723039348129, 243.91544336535569, 506.8571249289118, 0.0, 163.72241589376392, 1035.9136522711512, 91.97459750604331, 6.49325701803497, 508.7250910385382, 1134.9048363245881, 451.35465503549034, 706.123983821083, 774.5674199862962, 45.164934524169155, 703.3375458192647, 718.1030452717152, 541.1951323600751, 545.709379083246, 196.95653921686045, 155.54242429726904, 184.44819761318277, 930.63527964078, 199.4760819065468, 581.3705390800479, 436.6753207227322, 421.5042735615952, 160.97703030609622, 481.58019424342444, 328.0094685699285, 197.81137486525762, 18.614999014348335, 495.9030241070781, 1628.4005983180482, 137.72694136792933, 335.22306920191323, 858.5416985006707, 563.0052921867236, 393.5854599470067, 221.36736082231397, 93.23071014364344, 227.94184280518377, 319.60717638358625, 598.6197559944682, 461.85262163605375, 86.2485517755329, 832.4533958380299, 428.7860945775972, 447.88476769147945, 14.931698870350283, 102.60600824640525, 264.8946331701034, 582.3158484211342, 264.82483839688194, 400.19750663880257, 207.98425011773094, 377.29538243314465, 248.682758688271, 249.43853407227567, 402.2158706391004, 608.7522243472462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7853987531354765, "mean_inference_ms": 4.391014019969045, "mean_action_processing_ms": 1.5200751695456463, "mean_env_wait_ms": 10.462899722863058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029727935791015625, "StateBufferConnector_ms": 0.005375266075134277, "ViewRequirementAgentConnector_ms": 0.21514832973480225}, "num_episodes": 10, "episode_return_max": 741.0948673647298, "episode_return_min": -121.90847536196947, "episode_return_mean": 165.4441470189959, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.29042055143326, "num_env_steps_trained_throughput_per_sec": 78.29042055143326, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 124690.76, "restore_workers_time_ms": 0.014, "training_step_time_ms": 124690.667, "sample_time_ms": 2838.545, "learn_time_ms": 121828.489, "learn_throughput": 32.833, "synch_weights_time_ms": 17.608}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "35fb9_00000", "date": "2024-08-22_09-03-34", "timestamp": 1724297614, "time_this_iter_s": 51.113385915756226, "time_total_s": 4191.785926580429, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc7bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4191.785926580429, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 32.93424657534247, "ram_util_percent": 83.0041095890411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.535387024046882, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.808591707673653, "policy_loss": -0.017976321120100915, "vf_loss": 4.824252483705995, "vf_explained_var": 0.6476355218067371, "kl": 0.011577811254257405, "entropy": 0.7353785414859731, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.513237537088848, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.3642914514693, "policy_loss": -0.020699109400193844, "vf_loss": 5.382576908131756, "vf_explained_var": 0.28847547356413783, "kl": 0.012068271727631332, "entropy": 0.5531251310671448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 741.0948673647298, "episode_reward_min": -121.90847536196947, "episode_reward_mean": 158.49563440767642, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1632.5131871732658, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1628.4005983180482}, "policy_reward_mean": {"prey_policy": -418.9348817945205, "predator_policy": 498.18269899835957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.70000000000043, 48.10000000000004, 43.364054810029174, 155.81192773793072, 70.93490298568737, 7.846348668216047, 410.50833567913384, 44.210992599135075, 282.7929938478636, 105.58469438907275, 94.34429649450156, 166.2007695369835, 72.54720485461672, 17.099999999999984, -12.326855335955202, 80.42821678456687, 42.96960586306087, 187.5382137492661, 390.0999999999997, 115.05016362064364, 645.7188041762919, 35.64029909237771, 222.99598865053161, 45.3330212976205, 4.010958698165373, 24.302675350735353, 200.7726307789881, 253.28339726085224, 116.67308090302683, 270.40000000000197, -53.42292152064988, 283.81115494286786, 572.3624844283535, 44.51135818172011, 305.3901107002325, 181.14090209316169, 72.90000000000013, 78.59999999999981, 173.9374707434096, 365.21089100059, 159.59999999999962, 165.59999999999803, 380.83762161811285, 209.71033161561235, 137.29181053887157, 213.39913754168387, 167.86590331990993, 60.34669540819036, 51.9373018801809, 741.0948673647298, 513.3393565858045, 160.25590068243804, 51.037953099351526, 80.63131429396955, 54.40000000000051, 81.04093866620497, 215.85999607939138, 502.64141967741904, 37.71803398875015, 49.252730108822995, 114.30747997962955, 71.6000000000002, 25.200000000000088, -14.481304259101227, 293.631227704209, 49.93509221758458, 20.885753508713446, 182.35568028020467, 28.933954284994947, -121.90847536196947, 329.5999847533703, 42.40656691789585, 79.00421627885822, 67.58277296286835, 109.53943838119581, 12.253533792723731, 48.70658350974759, 377.1122904661684, 188.08684927850737, 284.14037404572474, 35.02404481804818, 253.41193201983097, 73.62436674992966, 473.29655077707275, 361.11597928626736, 19.10147461371583, 155.4432201576657, 204.69872101529307, -18.40756858784433, 43.02563940232515, 124.55479284219462, 76.88621301765029, 386.8319692723352, 247.29999999999788, 87.48864655819915, 204.16625214516534, 232.24359288207503, 54.55622028826161, 13.725830214967651, 364.34405902069636], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-144.25615151915105, 37.59525040003331, -560.8074706848032, -925.1338124706092, -1137.899530608858, -458.0200903977928, -644.7746614816679, -268.7130348916557, -395.2927282582562, -972.1176267533086, -789.8038051744696, -642.1292886912091, -554.4812497944946, -907.9916639237484, -715.6034775428969, -614.1451335376478, -51.44483747706158, -1450.5378522288222, -987.3350844063624, 38.67235152901048, -503.4667640031903, -331.34606392615933, -1298.4702975841303, -330.5519268025167, -145.167732839118, -488.54926089159886, -729.7006236381676, -1451.1223110423418, -274.2660899822618, -595.789219441566, 40.90000000000031, -422.2583319178967, -568.3408557559106, -633.4418447682821, -1052.4888471642064, -538.3509290016431, 365.53718320972575, -575.285200681487, -363.1649757774135, -516.1544383321927, -984.9199013712825, 90.91926131169407, -698.4375067499413, -720.0238345008439, -716.71067365637, -514.3711723306546, -566.4530737584768, 32.51443562631158, -799.4605478251223, -1184.7337233544697, -91.29018469752779, -330.1250952400853, -936.808952487594, 31.38787658940612, -333.33615425677255, -889.3485685172681, -456.73202548561136, -677.0109297567142, -151.6487941681918, 135.53889579623234, -964.6639471920957, -354.38676718499187, -429.68166005336474, -491.7629807542881, 13.09113907945234, -800.3277805558224, -286.2797892528909, -817.3953674767699, -748.5598171126613, -234.81491988595639, -729.0432491896918, -677.871041730333, -47.129904602223824, 18.32384570406369, 20.024913356893062, 40.0000000000003, -292.89167031361075, -557.2449328909471, -537.1263542718782, -520.1073987984312, -196.3373921470876, -516.9771988702702, -1420.4385593969469, 157.8999999999985, -137.574489196933, 75.06021319024657, -230.99778100992683, -35.18535272223059, -107.74523763675325, -266.62660996475677, -304.73066537558014, -588.4511184784742, -716.2384227550671, 5.85070982187742, -1121.3666945318264, -510.3726562522989, -838.0756403990601, -356.35912360113844, -479.44906627724345, 370.8207414783054, -699.9099150857809, 400.0, -92.4601139244062, -803.558913180366, -946.1961723657779, -260.4204815106142, -762.0733262336764, -738.2006962353923, -13.568961350551058, -411.8627619968813, -43.57310640337345, 40.0000000000003, -315.95547448259225, -875.3160242002409, 384.55558099579036, -658.4783276004426, -84.25928467523512, -823.9104286361852, -447.292872505867, -10.311522314218756, -1035.6038650751825, -49.72472311010272, -14.129313077645483, -12.738541446431958, -489.3250910385338, -1129.104836324588, -668.3575256522978, -503.6024174633716, -298.7066811962521, -227.394445610006, -469.4324019360572, -902.0730969373332, -561.9391133371305, -504.07964459747643, -157.60429043448582, -12.538992799440962, -765.0984663563507, -321.0510566126083, -436.5469963702042, -466.2080999783565, -31.283467381187855, -497.2961421497664, -316.75983338340933, -283.3908242482087, -18.068544360502578, -428.74808279582095, 18.304492602824244, -465.2397427613773, -1632.5131871732658, -24.07491413151537, -321.672851140659, -859.8383827692014, -270.1437220400188, -637.740446583958, 156.06035684857656, -93.54613734836866, -37.086788053447094, -322.37538185680654, -153.98854255348468, -622.3434610313144, -196.69858277824744, -686.9793200172637, -48.748739859434416, -574.5101903898071, 25.592667879579352, -69.50600824640702, -757.1308353177515, 383.21690450358426, 268.23075752069843, -572.1371232701156, -203.6321288637337, -362.546029073424, -232.8010918559712, -109.87698074691019, -276.6448461423045, -529.6245278287456, -676.8916594824578, -33.49214102154252, -339.2978769878869, -238.82651017558925, -417.59727661823104, -123.46811565818916, -238.80480631196292, -53.352254168870665, 35.324156926946344, -728.663080180929, -110.96910756469353, 167.79585220374878, -651.0182891129087, -661.0515811670176, -1002.3339569628894, -24.98794890229798, -580.9602165570298, -601.300004170106, -1005.2324648096343, -438.6346484564281, -426.21792555122414, -354.3553086594439, 65.61173018342578, -442.7677235039272], "policy_predator_policy_reward": [172.15615151914946, 2.2047495999669566, 898.8972514412469, 635.1440317141688, 1135.0585518926032, 504.2251239240798, 435.4626792684199, 633.8369448428386, 491.3123719029803, 947.032886094276, 795.8145893714812, 643.9648531624147, 839.9274745298362, 1033.0537748675397, 713.8492428412426, 660.1103608384387, 364.352980744605, 1420.4227028091407, 93.4728425130748, 960.7745847533519, 314.4552994787375, 614.701824945117, 1295.1595383119013, 500.0634556117319, 165.2701304838357, 540.9940681014971, 746.8006236381704, 1451.1223110423418, 431.1049039717741, 426.6235501161036, 2.592325382488712, 459.194223319978, 501.6087304220711, 743.1435759651844, 933.0471541463432, 845.330835768773, 16.462816790274246, 583.3852006814861, 671.8259239964112, 322.5436537338481, 872.0505555875759, 667.6688886483048, 796.3985808777117, 657.7030594654545, 891.1343044110424, 562.9435302265177, 577.0403956332949, 2.231263796490333, 799.7605478251223, 1188.4446820526348, 195.59062221290878, 250.12733307544107, 401.54615888558357, 704.6475477915961, 934.2291552015836, 541.7389648333171, 418.03746413618234, 832.3785720091752, 192.24879416819, 94.26110420376699, 325.5212314905774, 940.1065613658664, 557.0962111888919, 648.1595845616287, 657.3991500695073, 702.1999758352126, 324.80384695315365, 823.3826679582282, 570.693946468379, 718.0709012304662, 717.1137564343577, 870.9414365788284, 81.82990460222314, 19.876154295936317, 18.57508664310695, 0.0, 638.6395869413686, 385.4344870065978, 677.386659858025, 745.0579842128781, 424.2286011667665, 448.68598985059384, 1428.1385593969399, 0.0, 204.55944757302302, 238.79245005177285, 247.9668748798696, 227.9265904679019, 242.97218206007233, 268.69147608031545, 503.4517880268994, 603.1291333688403, 182.55604750654868, 695.6975687465562, 1175.4869662038777, 516.5990799884373, 702.4067301291557, 543.9653357512298, 405.639676683829, 444.08351547983887, 265.4658415603547, 547.7834301112294, 303.26059449618253, 753.0143332910269, 883.790374466514, 373.8642325092342, 1290.8332615584534, 290.07207520458746, 50.268961350551535, 429.56276199688534, 74.45870723334012, 10.1553378362382, 739.7976491531413, 667.3338456090827, 113.28731069172665, 663.2768555903444, 701.9723039348129, 243.91544336535569, 506.8571249289118, 0.0, 163.72241589376392, 1035.9136522711512, 91.97459750604331, 6.49325701803497, 508.7250910385382, 1134.9048363245881, 451.35465503549034, 706.123983821083, 774.5674199862962, 45.164934524169155, 703.3375458192647, 718.1030452717152, 541.1951323600751, 545.709379083246, 196.95653921686045, 155.54242429726904, 184.44819761318277, 930.63527964078, 199.4760819065468, 581.3705390800479, 436.6753207227322, 421.5042735615952, 160.97703030609622, 481.58019424342444, 328.0094685699285, 197.81137486525762, 18.614999014348335, 495.9030241070781, 1628.4005983180482, 137.72694136792933, 335.22306920191323, 858.5416985006707, 563.0052921867236, 393.5854599470067, 221.36736082231397, 93.23071014364344, 227.94184280518377, 319.60717638358625, 598.6197559944682, 461.85262163605375, 86.2485517755329, 832.4533958380299, 428.7860945775972, 447.88476769147945, 14.931698870350283, 102.60600824640525, 264.8946331701034, 582.3158484211342, 264.82483839688194, 400.19750663880257, 207.98425011773094, 377.29538243314465, 248.682758688271, 249.43853407227567, 402.2158706391004, 608.7522243472462, 493.7705542767878, 198.20567763936717, 383.4836829630921, 237.66634360271186, 412.53329914413, 253.08688597449097, 206.08084983520703, 162.96242366327633, 466.1720592602472, 613.9988332660687, 144.16910756469164, 46.30414779625062, 389.28524527766905, 1010.2732715604642, 938.9274398859739, 292.5607181243813, 603.745148716609, 810.7586648926051, 969.7712584909445, 528.6520750633819, 6.80769499336664, 787.4913694322735, 269.4149618541754, 472.0850904870247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.781144047360601, "mean_inference_ms": 4.417159917073511, "mean_action_processing_ms": 1.501961236462884, "mean_env_wait_ms": 10.488177614007586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029609203338623047, "StateBufferConnector_ms": 0.004813432693481445, "ViewRequirementAgentConnector_ms": 0.1878131628036499}, "num_episodes": 12, "episode_return_max": 741.0948673647298, "episode_return_min": -121.90847536196947, "episode_return_mean": 158.49563440767642, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.5180998106314, "num_env_steps_trained_throughput_per_sec": 78.5180998106314, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 124787.502, "restore_workers_time_ms": 0.014, "training_step_time_ms": 124787.412, "sample_time_ms": 2830.33, "learn_time_ms": 121933.604, "learn_throughput": 32.805, "synch_weights_time_ms": 17.615}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "35fb9_00000", "date": "2024-08-22_09-04-25", "timestamp": 1724297665, "time_this_iter_s": 50.989537954330444, "time_total_s": 4242.7754645347595, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcdad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4242.7754645347595, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 33.358333333333334, "ram_util_percent": 82.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.615417834753712, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.172827602946569, "policy_loss": -0.019036526060613887, "vf_loss": 4.189572913053805, "vf_explained_var": 0.6417548176157412, "kl": 0.011456028522958081, "entropy": 0.8002267869692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.540874586345026, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.360978420449312, "policy_loss": -0.019110102615954857, "vf_loss": 4.377632203808537, "vf_explained_var": 0.3680452934963993, "kl": 0.012281546930452346, "entropy": 0.6417297701987009, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 741.0948673647298, "episode_reward_min": -121.90847536196947, "episode_reward_mean": 160.6053070551606, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1632.5131871732658, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1628.4005983180482}, "policy_reward_mean": {"prey_policy": -393.06929403680914, "predator_policy": 473.37194756439027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [282.7929938478636, 105.58469438907275, 94.34429649450156, 166.2007695369835, 72.54720485461672, 17.099999999999984, -12.326855335955202, 80.42821678456687, 42.96960586306087, 187.5382137492661, 390.0999999999997, 115.05016362064364, 645.7188041762919, 35.64029909237771, 222.99598865053161, 45.3330212976205, 4.010958698165373, 24.302675350735353, 200.7726307789881, 253.28339726085224, 116.67308090302683, 270.40000000000197, -53.42292152064988, 283.81115494286786, 572.3624844283535, 44.51135818172011, 305.3901107002325, 181.14090209316169, 72.90000000000013, 78.59999999999981, 173.9374707434096, 365.21089100059, 159.59999999999962, 165.59999999999803, 380.83762161811285, 209.71033161561235, 137.29181053887157, 213.39913754168387, 167.86590331990993, 60.34669540819036, 51.9373018801809, 741.0948673647298, 513.3393565858045, 160.25590068243804, 51.037953099351526, 80.63131429396955, 54.40000000000051, 81.04093866620497, 215.85999607939138, 502.64141967741904, 37.71803398875015, 49.252730108822995, 114.30747997962955, 71.6000000000002, 25.200000000000088, -14.481304259101227, 293.631227704209, 49.93509221758458, 20.885753508713446, 182.35568028020467, 28.933954284994947, -121.90847536196947, 329.5999847533703, 42.40656691789585, 79.00421627885822, 67.58277296286835, 109.53943838119581, 12.253533792723731, 48.70658350974759, 377.1122904661684, 188.08684927850737, 284.14037404572474, 35.02404481804818, 253.41193201983097, 73.62436674992966, 473.29655077707275, 361.11597928626736, 19.10147461371583, 155.4432201576657, 204.69872101529307, -18.40756858784433, 43.02563940232515, 124.55479284219462, 76.88621301765029, 386.8319692723352, 247.29999999999788, 87.48864655819915, 204.16625214516534, 232.24359288207503, 54.55622028826161, 13.725830214967651, 364.34405902069636, 84.25090012714571, 365.0691682089804, 294.30000000000604, 57.93684587964413, 67.00000000000047, 111.36180992510764, 70.50000000000018, 9.025103087664043], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-51.44483747706158, -1450.5378522288222, -987.3350844063624, 38.67235152901048, -503.4667640031903, -331.34606392615933, -1298.4702975841303, -330.5519268025167, -145.167732839118, -488.54926089159886, -729.7006236381676, -1451.1223110423418, -274.2660899822618, -595.789219441566, 40.90000000000031, -422.2583319178967, -568.3408557559106, -633.4418447682821, -1052.4888471642064, -538.3509290016431, 365.53718320972575, -575.285200681487, -363.1649757774135, -516.1544383321927, -984.9199013712825, 90.91926131169407, -698.4375067499413, -720.0238345008439, -716.71067365637, -514.3711723306546, -566.4530737584768, 32.51443562631158, -799.4605478251223, -1184.7337233544697, -91.29018469752779, -330.1250952400853, -936.808952487594, 31.38787658940612, -333.33615425677255, -889.3485685172681, -456.73202548561136, -677.0109297567142, -151.6487941681918, 135.53889579623234, -964.6639471920957, -354.38676718499187, -429.68166005336474, -491.7629807542881, 13.09113907945234, -800.3277805558224, -286.2797892528909, -817.3953674767699, -748.5598171126613, -234.81491988595639, -729.0432491896918, -677.871041730333, -47.129904602223824, 18.32384570406369, 20.024913356893062, 40.0000000000003, -292.89167031361075, -557.2449328909471, -537.1263542718782, -520.1073987984312, -196.3373921470876, -516.9771988702702, -1420.4385593969469, 157.8999999999985, -137.574489196933, 75.06021319024657, -230.99778100992683, -35.18535272223059, -107.74523763675325, -266.62660996475677, -304.73066537558014, -588.4511184784742, -716.2384227550671, 5.85070982187742, -1121.3666945318264, -510.3726562522989, -838.0756403990601, -356.35912360113844, -479.44906627724345, 370.8207414783054, -699.9099150857809, 400.0, -92.4601139244062, -803.558913180366, -946.1961723657779, -260.4204815106142, -762.0733262336764, -738.2006962353923, -13.568961350551058, -411.8627619968813, -43.57310640337345, 40.0000000000003, -315.95547448259225, -875.3160242002409, 384.55558099579036, -658.4783276004426, -84.25928467523512, -823.9104286361852, -447.292872505867, -10.311522314218756, -1035.6038650751825, -49.72472311010272, -14.129313077645483, -12.738541446431958, -489.3250910385338, -1129.104836324588, -668.3575256522978, -503.6024174633716, -298.7066811962521, -227.394445610006, -469.4324019360572, -902.0730969373332, -561.9391133371305, -504.07964459747643, -157.60429043448582, -12.538992799440962, -765.0984663563507, -321.0510566126083, -436.5469963702042, -466.2080999783565, -31.283467381187855, -497.2961421497664, -316.75983338340933, -283.3908242482087, -18.068544360502578, -428.74808279582095, 18.304492602824244, -465.2397427613773, -1632.5131871732658, -24.07491413151537, -321.672851140659, -859.8383827692014, -270.1437220400188, -637.740446583958, 156.06035684857656, -93.54613734836866, -37.086788053447094, -322.37538185680654, -153.98854255348468, -622.3434610313144, -196.69858277824744, -686.9793200172637, -48.748739859434416, -574.5101903898071, 25.592667879579352, -69.50600824640702, -757.1308353177515, 383.21690450358426, 268.23075752069843, -572.1371232701156, -203.6321288637337, -362.546029073424, -232.8010918559712, -109.87698074691019, -276.6448461423045, -529.6245278287456, -676.8916594824578, -33.49214102154252, -339.2978769878869, -238.82651017558925, -417.59727661823104, -123.46811565818916, -238.80480631196292, -53.352254168870665, 35.324156926946344, -728.663080180929, -110.96910756469353, 167.79585220374878, -651.0182891129087, -661.0515811670176, -1002.3339569628894, -24.98794890229798, -580.9602165570298, -601.300004170106, -1005.2324648096343, -438.6346484564281, -426.21792555122414, -354.3553086594439, 65.61173018342578, -442.7677235039272, -1139.4533757373717, -165.6778756944886, -261.3379887317922, -107.15056127555374, 265.0000000000017, -121.3980787490602, -136.29142580096504, -932.8033136847426, -59.14920034782863, -195.8940988260051, 33.949797926410284, -50.596962995655126, -118.74605220725687, -140.50500724142543, -738.593712785601, -651.8090676369465], "policy_predator_policy_reward": [364.352980744605, 1420.4227028091407, 93.4728425130748, 960.7745847533519, 314.4552994787375, 614.701824945117, 1295.1595383119013, 500.0634556117319, 165.2701304838357, 540.9940681014971, 746.8006236381704, 1451.1223110423418, 431.1049039717741, 426.6235501161036, 2.592325382488712, 459.194223319978, 501.6087304220711, 743.1435759651844, 933.0471541463432, 845.330835768773, 16.462816790274246, 583.3852006814861, 671.8259239964112, 322.5436537338481, 872.0505555875759, 667.6688886483048, 796.3985808777117, 657.7030594654545, 891.1343044110424, 562.9435302265177, 577.0403956332949, 2.231263796490333, 799.7605478251223, 1188.4446820526348, 195.59062221290878, 250.12733307544107, 401.54615888558357, 704.6475477915961, 934.2291552015836, 541.7389648333171, 418.03746413618234, 832.3785720091752, 192.24879416819, 94.26110420376699, 325.5212314905774, 940.1065613658664, 557.0962111888919, 648.1595845616287, 657.3991500695073, 702.1999758352126, 324.80384695315365, 823.3826679582282, 570.693946468379, 718.0709012304662, 717.1137564343577, 870.9414365788284, 81.82990460222314, 19.876154295936317, 18.57508664310695, 0.0, 638.6395869413686, 385.4344870065978, 677.386659858025, 745.0579842128781, 424.2286011667665, 448.68598985059384, 1428.1385593969399, 0.0, 204.55944757302302, 238.79245005177285, 247.9668748798696, 227.9265904679019, 242.97218206007233, 268.69147608031545, 503.4517880268994, 603.1291333688403, 182.55604750654868, 695.6975687465562, 1175.4869662038777, 516.5990799884373, 702.4067301291557, 543.9653357512298, 405.639676683829, 444.08351547983887, 265.4658415603547, 547.7834301112294, 303.26059449618253, 753.0143332910269, 883.790374466514, 373.8642325092342, 1290.8332615584534, 290.07207520458746, 50.268961350551535, 429.56276199688534, 74.45870723334012, 10.1553378362382, 739.7976491531413, 667.3338456090827, 113.28731069172665, 663.2768555903444, 701.9723039348129, 243.91544336535569, 506.8571249289118, 0.0, 163.72241589376392, 1035.9136522711512, 91.97459750604331, 6.49325701803497, 508.7250910385382, 1134.9048363245881, 451.35465503549034, 706.123983821083, 774.5674199862962, 45.164934524169155, 703.3375458192647, 718.1030452717152, 541.1951323600751, 545.709379083246, 196.95653921686045, 155.54242429726904, 184.44819761318277, 930.63527964078, 199.4760819065468, 581.3705390800479, 436.6753207227322, 421.5042735615952, 160.97703030609622, 481.58019424342444, 328.0094685699285, 197.81137486525762, 18.614999014348335, 495.9030241070781, 1628.4005983180482, 137.72694136792933, 335.22306920191323, 858.5416985006707, 563.0052921867236, 393.5854599470067, 221.36736082231397, 93.23071014364344, 227.94184280518377, 319.60717638358625, 598.6197559944682, 461.85262163605375, 86.2485517755329, 832.4533958380299, 428.7860945775972, 447.88476769147945, 14.931698870350283, 102.60600824640525, 264.8946331701034, 582.3158484211342, 264.82483839688194, 400.19750663880257, 207.98425011773094, 377.29538243314465, 248.682758688271, 249.43853407227567, 402.2158706391004, 608.7522243472462, 493.7705542767878, 198.20567763936717, 383.4836829630921, 237.66634360271186, 412.53329914413, 253.08688597449097, 206.08084983520703, 162.96242366327633, 466.1720592602472, 613.9988332660687, 144.16910756469164, 46.30414779625062, 389.28524527766905, 1010.2732715604642, 938.9274398859739, 292.5607181243813, 603.745148716609, 810.7586648926051, 969.7712584909445, 528.6520750633819, 6.80769499336664, 787.4913694322735, 269.4149618541754, 472.0850904870247, 1138.4856803200253, 250.89647123897973, 596.142238754558, 137.41547946176942, 0.0, 150.69807874905865, 223.35896202004815, 903.6726233453018, 92.54920034782715, 229.4940988260034, 42.1120119986999, 85.89696299565408, 159.34605220725538, 170.4050072414241, 722.4677342128939, 676.9601492973184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.790695397856916, "mean_inference_ms": 4.415033921694986, "mean_action_processing_ms": 1.5014147339429398, "mean_env_wait_ms": 10.478075787928121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030045747756958008, "StateBufferConnector_ms": 0.005006074905395508, "ViewRequirementAgentConnector_ms": 0.18777835369110107}, "num_episodes": 8, "episode_return_max": 741.0948673647298, "episode_return_min": -121.90847536196947, "episode_return_mean": 160.6053070551606, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.57032830413107, "num_env_steps_trained_throughput_per_sec": 77.57032830413107, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 125037.553, "restore_workers_time_ms": 0.014, "training_step_time_ms": 125037.463, "sample_time_ms": 2879.209, "learn_time_ms": 122133.72, "learn_throughput": 32.751, "synch_weights_time_ms": 18.561}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "35fb9_00000", "date": "2024-08-22_09-05-17", "timestamp": 1724297717, "time_this_iter_s": 51.60910701751709, "time_total_s": 4294.384571552277, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b6300d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4294.384571552277, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 35.249315068493146, "ram_util_percent": 83.32328767123288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.392453032448179, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.8539047438000877, "policy_loss": -0.021881166326680353, "vf_loss": 3.8731648219325554, "vf_explained_var": 0.6855945258859604, "kl": 0.013105422113504675, "entropy": 0.7382689487051081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.560609878055633, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.4099433843420925, "policy_loss": -0.017492298580578002, "vf_loss": 4.424719343992768, "vf_explained_var": 0.40430791838459235, "kl": 0.013581764402616986, "entropy": 0.615748816287076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 741.0948673647298, "episode_reward_min": -121.90847536196947, "episode_reward_mean": 165.87358326054473, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1632.5131871732658, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1628.4005983180482}, "policy_reward_mean": {"prey_policy": -377.0792843429839, "predator_policy": 460.01607597325693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.05016362064364, 645.7188041762919, 35.64029909237771, 222.99598865053161, 45.3330212976205, 4.010958698165373, 24.302675350735353, 200.7726307789881, 253.28339726085224, 116.67308090302683, 270.40000000000197, -53.42292152064988, 283.81115494286786, 572.3624844283535, 44.51135818172011, 305.3901107002325, 181.14090209316169, 72.90000000000013, 78.59999999999981, 173.9374707434096, 365.21089100059, 159.59999999999962, 165.59999999999803, 380.83762161811285, 209.71033161561235, 137.29181053887157, 213.39913754168387, 167.86590331990993, 60.34669540819036, 51.9373018801809, 741.0948673647298, 513.3393565858045, 160.25590068243804, 51.037953099351526, 80.63131429396955, 54.40000000000051, 81.04093866620497, 215.85999607939138, 502.64141967741904, 37.71803398875015, 49.252730108822995, 114.30747997962955, 71.6000000000002, 25.200000000000088, -14.481304259101227, 293.631227704209, 49.93509221758458, 20.885753508713446, 182.35568028020467, 28.933954284994947, -121.90847536196947, 329.5999847533703, 42.40656691789585, 79.00421627885822, 67.58277296286835, 109.53943838119581, 12.253533792723731, 48.70658350974759, 377.1122904661684, 188.08684927850737, 284.14037404572474, 35.02404481804818, 253.41193201983097, 73.62436674992966, 473.29655077707275, 361.11597928626736, 19.10147461371583, 155.4432201576657, 204.69872101529307, -18.40756858784433, 43.02563940232515, 124.55479284219462, 76.88621301765029, 386.8319692723352, 247.29999999999788, 87.48864655819915, 204.16625214516534, 232.24359288207503, 54.55622028826161, 13.725830214967651, 364.34405902069636, 84.25090012714571, 365.0691682089804, 294.30000000000604, 57.93684587964413, 67.00000000000047, 111.36180992510764, 70.50000000000018, 9.025103087664043, 444.4547781900025, 124.33656119625475, 177.05537892758537, -7.808445730422971, 249.73260356218665, 216.86464495645606, 412.7795097064589, 142.26561438557135, 191.69153496987542, -35.43363958116312, 38.16822013958303], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-363.1649757774135, -516.1544383321927, -984.9199013712825, 90.91926131169407, -698.4375067499413, -720.0238345008439, -716.71067365637, -514.3711723306546, -566.4530737584768, 32.51443562631158, -799.4605478251223, -1184.7337233544697, -91.29018469752779, -330.1250952400853, -936.808952487594, 31.38787658940612, -333.33615425677255, -889.3485685172681, -456.73202548561136, -677.0109297567142, -151.6487941681918, 135.53889579623234, -964.6639471920957, -354.38676718499187, -429.68166005336474, -491.7629807542881, 13.09113907945234, -800.3277805558224, -286.2797892528909, -817.3953674767699, -748.5598171126613, -234.81491988595639, -729.0432491896918, -677.871041730333, -47.129904602223824, 18.32384570406369, 20.024913356893062, 40.0000000000003, -292.89167031361075, -557.2449328909471, -537.1263542718782, -520.1073987984312, -196.3373921470876, -516.9771988702702, -1420.4385593969469, 157.8999999999985, -137.574489196933, 75.06021319024657, -230.99778100992683, -35.18535272223059, -107.74523763675325, -266.62660996475677, -304.73066537558014, -588.4511184784742, -716.2384227550671, 5.85070982187742, -1121.3666945318264, -510.3726562522989, -838.0756403990601, -356.35912360113844, -479.44906627724345, 370.8207414783054, -699.9099150857809, 400.0, -92.4601139244062, -803.558913180366, -946.1961723657779, -260.4204815106142, -762.0733262336764, -738.2006962353923, -13.568961350551058, -411.8627619968813, -43.57310640337345, 40.0000000000003, -315.95547448259225, -875.3160242002409, 384.55558099579036, -658.4783276004426, -84.25928467523512, -823.9104286361852, -447.292872505867, -10.311522314218756, -1035.6038650751825, -49.72472311010272, -14.129313077645483, -12.738541446431958, -489.3250910385338, -1129.104836324588, -668.3575256522978, -503.6024174633716, -298.7066811962521, -227.394445610006, -469.4324019360572, -902.0730969373332, -561.9391133371305, -504.07964459747643, -157.60429043448582, -12.538992799440962, -765.0984663563507, -321.0510566126083, -436.5469963702042, -466.2080999783565, -31.283467381187855, -497.2961421497664, -316.75983338340933, -283.3908242482087, -18.068544360502578, -428.74808279582095, 18.304492602824244, -465.2397427613773, -1632.5131871732658, -24.07491413151537, -321.672851140659, -859.8383827692014, -270.1437220400188, -637.740446583958, 156.06035684857656, -93.54613734836866, -37.086788053447094, -322.37538185680654, -153.98854255348468, -622.3434610313144, -196.69858277824744, -686.9793200172637, -48.748739859434416, -574.5101903898071, 25.592667879579352, -69.50600824640702, -757.1308353177515, 383.21690450358426, 268.23075752069843, -572.1371232701156, -203.6321288637337, -362.546029073424, -232.8010918559712, -109.87698074691019, -276.6448461423045, -529.6245278287456, -676.8916594824578, -33.49214102154252, -339.2978769878869, -238.82651017558925, -417.59727661823104, -123.46811565818916, -238.80480631196292, -53.352254168870665, 35.324156926946344, -728.663080180929, -110.96910756469353, 167.79585220374878, -651.0182891129087, -661.0515811670176, -1002.3339569628894, -24.98794890229798, -580.9602165570298, -601.300004170106, -1005.2324648096343, -438.6346484564281, -426.21792555122414, -354.3553086594439, 65.61173018342578, -442.7677235039272, -1139.4533757373717, -165.6778756944886, -261.3379887317922, -107.15056127555374, 265.0000000000017, -121.3980787490602, -136.29142580096504, -932.8033136847426, -59.14920034782863, -195.8940988260051, 33.949797926410284, -50.596962995655126, -118.74605220725687, -140.50500724142543, -738.593712785601, -651.8090676369465, -75.48120900571854, -644.3325737115834, -886.6436436391327, -222.50397239651204, -143.6070584323904, -871.4170250612524, -251.61319538086582, -297.6219064723521, -724.0892563711659, -460.93642822224655, -543.0710630399401, -542.7186271969075, -456.9258222418897, 380.84347102509196, -698.4903558568285, -125.26042402329676, -369.0357445706438, -107.25443710915576, -872.3031973705337, -230.70597299628034, -239.2054095140743, -402.4287484612415], "policy_predator_policy_reward": [671.8259239964112, 322.5436537338481, 872.0505555875759, 667.6688886483048, 796.3985808777117, 657.7030594654545, 891.1343044110424, 562.9435302265177, 577.0403956332949, 2.231263796490333, 799.7605478251223, 1188.4446820526348, 195.59062221290878, 250.12733307544107, 401.54615888558357, 704.6475477915961, 934.2291552015836, 541.7389648333171, 418.03746413618234, 832.3785720091752, 192.24879416819, 94.26110420376699, 325.5212314905774, 940.1065613658664, 557.0962111888919, 648.1595845616287, 657.3991500695073, 702.1999758352126, 324.80384695315365, 823.3826679582282, 570.693946468379, 718.0709012304662, 717.1137564343577, 870.9414365788284, 81.82990460222314, 19.876154295936317, 18.57508664310695, 0.0, 638.6395869413686, 385.4344870065978, 677.386659858025, 745.0579842128781, 424.2286011667665, 448.68598985059384, 1428.1385593969399, 0.0, 204.55944757302302, 238.79245005177285, 247.9668748798696, 227.9265904679019, 242.97218206007233, 268.69147608031545, 503.4517880268994, 603.1291333688403, 182.55604750654868, 695.6975687465562, 1175.4869662038777, 516.5990799884373, 702.4067301291557, 543.9653357512298, 405.639676683829, 444.08351547983887, 265.4658415603547, 547.7834301112294, 303.26059449618253, 753.0143332910269, 883.790374466514, 373.8642325092342, 1290.8332615584534, 290.07207520458746, 50.268961350551535, 429.56276199688534, 74.45870723334012, 10.1553378362382, 739.7976491531413, 667.3338456090827, 113.28731069172665, 663.2768555903444, 701.9723039348129, 243.91544336535569, 506.8571249289118, 0.0, 163.72241589376392, 1035.9136522711512, 91.97459750604331, 6.49325701803497, 508.7250910385382, 1134.9048363245881, 451.35465503549034, 706.123983821083, 774.5674199862962, 45.164934524169155, 703.3375458192647, 718.1030452717152, 541.1951323600751, 545.709379083246, 196.95653921686045, 155.54242429726904, 184.44819761318277, 930.63527964078, 199.4760819065468, 581.3705390800479, 436.6753207227322, 421.5042735615952, 160.97703030609622, 481.58019424342444, 328.0094685699285, 197.81137486525762, 18.614999014348335, 495.9030241070781, 1628.4005983180482, 137.72694136792933, 335.22306920191323, 858.5416985006707, 563.0052921867236, 393.5854599470067, 221.36736082231397, 93.23071014364344, 227.94184280518377, 319.60717638358625, 598.6197559944682, 461.85262163605375, 86.2485517755329, 832.4533958380299, 428.7860945775972, 447.88476769147945, 14.931698870350283, 102.60600824640525, 264.8946331701034, 582.3158484211342, 264.82483839688194, 400.19750663880257, 207.98425011773094, 377.29538243314465, 248.682758688271, 249.43853407227567, 402.2158706391004, 608.7522243472462, 493.7705542767878, 198.20567763936717, 383.4836829630921, 237.66634360271186, 412.53329914413, 253.08688597449097, 206.08084983520703, 162.96242366327633, 466.1720592602472, 613.9988332660687, 144.16910756469164, 46.30414779625062, 389.28524527766905, 1010.2732715604642, 938.9274398859739, 292.5607181243813, 603.745148716609, 810.7586648926051, 969.7712584909445, 528.6520750633819, 6.80769499336664, 787.4913694322735, 269.4149618541754, 472.0850904870247, 1138.4856803200253, 250.89647123897973, 596.142238754558, 137.41547946176942, 0.0, 150.69807874905865, 223.35896202004815, 903.6726233453018, 92.54920034782715, 229.4940988260034, 42.1120119986999, 85.89696299565408, 159.34605220725538, 170.4050072414241, 722.4677342128939, 676.9601492973184, 567.5792665942099, 596.6892943130924, 439.2333851036899, 794.2507921282097, 961.8045083516677, 230.27495406956075, 532.7855654656275, 8.641090657173569, 586.8732267502501, 847.8850614053557, 557.2227661376722, 745.4315690556332, 467.72582224189006, 21.13603868136662, 629.0995192574842, 336.91687500821297, 525.635744570644, 142.34597207902996, 204.5419228762638, 863.0336079093865, 389.1808236915413, 290.6215544233606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.791406089826369, "mean_inference_ms": 4.425916493480365, "mean_action_processing_ms": 1.491771384837243, "mean_env_wait_ms": 10.495093421268848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029490351676940918, "StateBufferConnector_ms": 0.0051877498626708984, "ViewRequirementAgentConnector_ms": 0.191511869430542}, "num_episodes": 11, "episode_return_max": 741.0948673647298, "episode_return_min": -121.90847536196947, "episode_return_mean": 165.87358326054473, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.08305849266236, "num_env_steps_trained_throughput_per_sec": 68.08305849266236, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 126054.092, "restore_workers_time_ms": 0.014, "training_step_time_ms": 126054.003, "sample_time_ms": 2918.063, "learn_time_ms": 123111.678, "learn_throughput": 32.491, "synch_weights_time_ms": 18.555}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "35fb9_00000", "date": "2024-08-22_09-06-15", "timestamp": 1724297775, "time_this_iter_s": 58.790481090545654, "time_total_s": 4353.175052642822, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc7bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4353.175052642822, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 49.39642857142857, "ram_util_percent": 82.92738095238096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.959906386067628, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.154498278274738, "policy_loss": -0.025413899609471657, "vf_loss": 4.177359873403317, "vf_explained_var": 0.6032105278401148, "kl": 0.012761511223479396, "entropy": 0.7729533222617295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.223535600919572, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.601517671378201, "policy_loss": -0.02092003375193272, "vf_loss": 4.619592318333015, "vf_explained_var": 0.399759632412088, "kl": 0.01422698711360455, "entropy": 0.6135081634477333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 970.4874999999885}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 741.0948673647298, "episode_reward_min": -121.90847536196947, "episode_reward_mean": 158.10445329042759, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1632.5131871732658, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1628.4005983180482}, "policy_reward_mean": {"prey_policy": -342.07430913751864, "predator_policy": 421.1265357827331}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.51135818172011, 305.3901107002325, 181.14090209316169, 72.90000000000013, 78.59999999999981, 173.9374707434096, 365.21089100059, 159.59999999999962, 165.59999999999803, 380.83762161811285, 209.71033161561235, 137.29181053887157, 213.39913754168387, 167.86590331990993, 60.34669540819036, 51.9373018801809, 741.0948673647298, 513.3393565858045, 160.25590068243804, 51.037953099351526, 80.63131429396955, 54.40000000000051, 81.04093866620497, 215.85999607939138, 502.64141967741904, 37.71803398875015, 49.252730108822995, 114.30747997962955, 71.6000000000002, 25.200000000000088, -14.481304259101227, 293.631227704209, 49.93509221758458, 20.885753508713446, 182.35568028020467, 28.933954284994947, -121.90847536196947, 329.5999847533703, 42.40656691789585, 79.00421627885822, 67.58277296286835, 109.53943838119581, 12.253533792723731, 48.70658350974759, 377.1122904661684, 188.08684927850737, 284.14037404572474, 35.02404481804818, 253.41193201983097, 73.62436674992966, 473.29655077707275, 361.11597928626736, 19.10147461371583, 155.4432201576657, 204.69872101529307, -18.40756858784433, 43.02563940232515, 124.55479284219462, 76.88621301765029, 386.8319692723352, 247.29999999999788, 87.48864655819915, 204.16625214516534, 232.24359288207503, 54.55622028826161, 13.725830214967651, 364.34405902069636, 84.25090012714571, 365.0691682089804, 294.30000000000604, 57.93684587964413, 67.00000000000047, 111.36180992510764, 70.50000000000018, 9.025103087664043, 444.4547781900025, 124.33656119625475, 177.05537892758537, -7.808445730422971, 249.73260356218665, 216.86464495645606, 412.7795097064589, 142.26561438557135, 191.69153496987542, -35.43363958116312, 38.16822013958303, 66.2000000000005, 87.98958473543472, 64.95224314538166, 111.70071140378577, 63.74684062937235, 73.49683974713618, 35.85661747703209, 369.6605120994634, 59.80000000000057, 75.7723282572432, 109.40266627697126, 106.91761683224883, 234.485313011826, 500.03746705219237], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-286.2797892528909, -817.3953674767699, -748.5598171126613, -234.81491988595639, -729.0432491896918, -677.871041730333, -47.129904602223824, 18.32384570406369, 20.024913356893062, 40.0000000000003, -292.89167031361075, -557.2449328909471, -537.1263542718782, -520.1073987984312, -196.3373921470876, -516.9771988702702, -1420.4385593969469, 157.8999999999985, -137.574489196933, 75.06021319024657, -230.99778100992683, -35.18535272223059, -107.74523763675325, -266.62660996475677, -304.73066537558014, -588.4511184784742, -716.2384227550671, 5.85070982187742, -1121.3666945318264, -510.3726562522989, -838.0756403990601, -356.35912360113844, -479.44906627724345, 370.8207414783054, -699.9099150857809, 400.0, -92.4601139244062, -803.558913180366, -946.1961723657779, -260.4204815106142, -762.0733262336764, -738.2006962353923, -13.568961350551058, -411.8627619968813, -43.57310640337345, 40.0000000000003, -315.95547448259225, -875.3160242002409, 384.55558099579036, -658.4783276004426, -84.25928467523512, -823.9104286361852, -447.292872505867, -10.311522314218756, -1035.6038650751825, -49.72472311010272, -14.129313077645483, -12.738541446431958, -489.3250910385338, -1129.104836324588, -668.3575256522978, -503.6024174633716, -298.7066811962521, -227.394445610006, -469.4324019360572, -902.0730969373332, -561.9391133371305, -504.07964459747643, -157.60429043448582, -12.538992799440962, -765.0984663563507, -321.0510566126083, -436.5469963702042, -466.2080999783565, -31.283467381187855, -497.2961421497664, -316.75983338340933, -283.3908242482087, -18.068544360502578, -428.74808279582095, 18.304492602824244, -465.2397427613773, -1632.5131871732658, -24.07491413151537, -321.672851140659, -859.8383827692014, -270.1437220400188, -637.740446583958, 156.06035684857656, -93.54613734836866, -37.086788053447094, -322.37538185680654, -153.98854255348468, -622.3434610313144, -196.69858277824744, -686.9793200172637, -48.748739859434416, -574.5101903898071, 25.592667879579352, -69.50600824640702, -757.1308353177515, 383.21690450358426, 268.23075752069843, -572.1371232701156, -203.6321288637337, -362.546029073424, -232.8010918559712, -109.87698074691019, -276.6448461423045, -529.6245278287456, -676.8916594824578, -33.49214102154252, -339.2978769878869, -238.82651017558925, -417.59727661823104, -123.46811565818916, -238.80480631196292, -53.352254168870665, 35.324156926946344, -728.663080180929, -110.96910756469353, 167.79585220374878, -651.0182891129087, -661.0515811670176, -1002.3339569628894, -24.98794890229798, -580.9602165570298, -601.300004170106, -1005.2324648096343, -438.6346484564281, -426.21792555122414, -354.3553086594439, 65.61173018342578, -442.7677235039272, -1139.4533757373717, -165.6778756944886, -261.3379887317922, -107.15056127555374, 265.0000000000017, -121.3980787490602, -136.29142580096504, -932.8033136847426, -59.14920034782863, -195.8940988260051, 33.949797926410284, -50.596962995655126, -118.74605220725687, -140.50500724142543, -738.593712785601, -651.8090676369465, -75.48120900571854, -644.3325737115834, -886.6436436391327, -222.50397239651204, -143.6070584323904, -871.4170250612524, -251.61319538086582, -297.6219064723521, -724.0892563711659, -460.93642822224655, -543.0710630399401, -542.7186271969075, -456.9258222418897, 380.84347102509196, -698.4903558568285, -125.26042402329676, -369.0357445706438, -107.25443710915576, -872.3031973705337, -230.70597299628034, -239.2054095140743, -402.4287484612415, -89.14134808505827, -186.22012069018916, 35.270123075147126, -136.14516967347427, -682.8285663113206, -28.883804782408177, -316.23692993747886, -91.70810986535896, -184.24804680644738, -316.2749717051111, -253.0295978848285, -624.3022550715601, -684.3277535498518, -220.36373389841006, 232.05029037171266, -162.6427387224675, -167.13984938453476, -167.96770713135493, -213.87852338714083, 14.563825351069527, -375.5755844645924, -961.9146546948149, -218.20713452750374, -18.007281142331443, -242.11748851822966, -509.7348473427553, 154.2883684438157, -252.38342817547718], "policy_predator_policy_reward": [324.80384695315365, 823.3826679582282, 570.693946468379, 718.0709012304662, 717.1137564343577, 870.9414365788284, 81.82990460222314, 19.876154295936317, 18.57508664310695, 0.0, 638.6395869413686, 385.4344870065978, 677.386659858025, 745.0579842128781, 424.2286011667665, 448.68598985059384, 1428.1385593969399, 0.0, 204.55944757302302, 238.79245005177285, 247.9668748798696, 227.9265904679019, 242.97218206007233, 268.69147608031545, 503.4517880268994, 603.1291333688403, 182.55604750654868, 695.6975687465562, 1175.4869662038777, 516.5990799884373, 702.4067301291557, 543.9653357512298, 405.639676683829, 444.08351547983887, 265.4658415603547, 547.7834301112294, 303.26059449618253, 753.0143332910269, 883.790374466514, 373.8642325092342, 1290.8332615584534, 290.07207520458746, 50.268961350551535, 429.56276199688534, 74.45870723334012, 10.1553378362382, 739.7976491531413, 667.3338456090827, 113.28731069172665, 663.2768555903444, 701.9723039348129, 243.91544336535569, 506.8571249289118, 0.0, 163.72241589376392, 1035.9136522711512, 91.97459750604331, 6.49325701803497, 508.7250910385382, 1134.9048363245881, 451.35465503549034, 706.123983821083, 774.5674199862962, 45.164934524169155, 703.3375458192647, 718.1030452717152, 541.1951323600751, 545.709379083246, 196.95653921686045, 155.54242429726904, 184.44819761318277, 930.63527964078, 199.4760819065468, 581.3705390800479, 436.6753207227322, 421.5042735615952, 160.97703030609622, 481.58019424342444, 328.0094685699285, 197.81137486525762, 18.614999014348335, 495.9030241070781, 1628.4005983180482, 137.72694136792933, 335.22306920191323, 858.5416985006707, 563.0052921867236, 393.5854599470067, 221.36736082231397, 93.23071014364344, 227.94184280518377, 319.60717638358625, 598.6197559944682, 461.85262163605375, 86.2485517755329, 832.4533958380299, 428.7860945775972, 447.88476769147945, 14.931698870350283, 102.60600824640525, 264.8946331701034, 582.3158484211342, 264.82483839688194, 400.19750663880257, 207.98425011773094, 377.29538243314465, 248.682758688271, 249.43853407227567, 402.2158706391004, 608.7522243472462, 493.7705542767878, 198.20567763936717, 383.4836829630921, 237.66634360271186, 412.53329914413, 253.08688597449097, 206.08084983520703, 162.96242366327633, 466.1720592602472, 613.9988332660687, 144.16910756469164, 46.30414779625062, 389.28524527766905, 1010.2732715604642, 938.9274398859739, 292.5607181243813, 603.745148716609, 810.7586648926051, 969.7712584909445, 528.6520750633819, 6.80769499336664, 787.4913694322735, 269.4149618541754, 472.0850904870247, 1138.4856803200253, 250.89647123897973, 596.142238754558, 137.41547946176942, 0.0, 150.69807874905865, 223.35896202004815, 903.6726233453018, 92.54920034782715, 229.4940988260034, 42.1120119986999, 85.89696299565408, 159.34605220725538, 170.4050072414241, 722.4677342128939, 676.9601492973184, 567.5792665942099, 596.6892943130924, 439.2333851036899, 794.2507921282097, 961.8045083516677, 230.27495406956075, 532.7855654656275, 8.641090657173569, 586.8732267502501, 847.8850614053557, 557.2227661376722, 745.4315690556332, 467.72582224189006, 21.13603868136662, 629.0995192574842, 336.91687500821297, 525.635744570644, 142.34597207902996, 204.5419228762638, 863.0336079093865, 389.1808236915413, 290.6215544233606, 124.14134808505628, 217.4201206901874, 162.33949844469183, 26.525132889069233, 676.4609469000237, 100.20366733908772, 304.6268964629782, 215.0188547436499, 215.06650134535428, 349.20335779557894, 385.8593256534287, 564.9693670500974, 692.4277535498535, 248.1203513754404, 206.1148491436508, 94.13811130656441, 196.73984938453358, 198.1677071313532, 229.99544885547428, 45.09157743783933, 1220.763193039062, 226.1297123973214, 53.727197046368005, 289.40483545571817, 386.3452564841956, 599.9923923886213, 360.78236786500094, 237.35015891885178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.788648668586996, "mean_inference_ms": 4.443672462327615, "mean_action_processing_ms": 1.4832831330091178, "mean_env_wait_ms": 10.52416179459331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025908827781677246, "StateBufferConnector_ms": 0.005239605903625488, "ViewRequirementAgentConnector_ms": 0.21256113052368164}, "num_episodes": 14, "episode_return_max": 741.0948673647298, "episode_return_min": -121.90847536196947, "episode_return_mean": 158.10445329042759, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.27286139963994, "num_env_steps_trained_throughput_per_sec": 73.27286139963994, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 126582.69, "restore_workers_time_ms": 0.014, "training_step_time_ms": 126582.582, "sample_time_ms": 2892.214, "learn_time_ms": 123666.315, "learn_throughput": 32.345, "synch_weights_time_ms": 18.328}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "35fb9_00000", "date": "2024-08-22_09-07-10", "timestamp": 1724297830, "time_this_iter_s": 54.62332797050476, "time_total_s": 4407.798380613327, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcbdaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4407.798380613327, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 42.71948051948053, "ram_util_percent": 82.46103896103897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.490153478630006, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.070328824356119, "policy_loss": -0.025231530571297286, "vf_loss": 4.093019236206378, "vf_explained_var": 0.5688365443989083, "kl": 0.012705512700612268, "entropy": 0.8069159292670154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.00597294783466, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.920784411354671, "policy_loss": -0.021548686884146517, "vf_loss": 4.93999494080821, "vf_explained_var": 0.23107010460404492, "kl": 0.011690781699252074, "entropy": 0.6070930043540934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 741.0948673647298, "episode_reward_min": -121.90847536196947, "episode_reward_mean": 163.53393505797976, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1632.5131871732658, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1628.4005983180482}, "policy_reward_mean": {"prey_policy": -333.47493541817926, "predator_policy": 415.2419029471699}, "custom_metrics": {}, "hist_stats": {"episode_reward": [165.59999999999803, 380.83762161811285, 209.71033161561235, 137.29181053887157, 213.39913754168387, 167.86590331990993, 60.34669540819036, 51.9373018801809, 741.0948673647298, 513.3393565858045, 160.25590068243804, 51.037953099351526, 80.63131429396955, 54.40000000000051, 81.04093866620497, 215.85999607939138, 502.64141967741904, 37.71803398875015, 49.252730108822995, 114.30747997962955, 71.6000000000002, 25.200000000000088, -14.481304259101227, 293.631227704209, 49.93509221758458, 20.885753508713446, 182.35568028020467, 28.933954284994947, -121.90847536196947, 329.5999847533703, 42.40656691789585, 79.00421627885822, 67.58277296286835, 109.53943838119581, 12.253533792723731, 48.70658350974759, 377.1122904661684, 188.08684927850737, 284.14037404572474, 35.02404481804818, 253.41193201983097, 73.62436674992966, 473.29655077707275, 361.11597928626736, 19.10147461371583, 155.4432201576657, 204.69872101529307, -18.40756858784433, 43.02563940232515, 124.55479284219462, 76.88621301765029, 386.8319692723352, 247.29999999999788, 87.48864655819915, 204.16625214516534, 232.24359288207503, 54.55622028826161, 13.725830214967651, 364.34405902069636, 84.25090012714571, 365.0691682089804, 294.30000000000604, 57.93684587964413, 67.00000000000047, 111.36180992510764, 70.50000000000018, 9.025103087664043, 444.4547781900025, 124.33656119625475, 177.05537892758537, -7.808445730422971, 249.73260356218665, 216.86464495645606, 412.7795097064589, 142.26561438557135, 191.69153496987542, -35.43363958116312, 38.16822013958303, 66.2000000000005, 87.98958473543472, 64.95224314538166, 111.70071140378577, 63.74684062937235, 73.49683974713618, 35.85661747703209, 369.6605120994634, 59.80000000000057, 75.7723282572432, 109.40266627697126, 106.91761683224883, 234.485313011826, 500.03746705219237, 500.33302651356536, 118.51620499634667, 250.68887656032888, 316.091428996378, 106.8373249382522, 438.41246498877916, 61.90000000000061, 131.45958248068035], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1420.4385593969469, 157.8999999999985, -137.574489196933, 75.06021319024657, -230.99778100992683, -35.18535272223059, -107.74523763675325, -266.62660996475677, -304.73066537558014, -588.4511184784742, -716.2384227550671, 5.85070982187742, -1121.3666945318264, -510.3726562522989, -838.0756403990601, -356.35912360113844, -479.44906627724345, 370.8207414783054, -699.9099150857809, 400.0, -92.4601139244062, -803.558913180366, -946.1961723657779, -260.4204815106142, -762.0733262336764, -738.2006962353923, -13.568961350551058, -411.8627619968813, -43.57310640337345, 40.0000000000003, -315.95547448259225, -875.3160242002409, 384.55558099579036, -658.4783276004426, -84.25928467523512, -823.9104286361852, -447.292872505867, -10.311522314218756, -1035.6038650751825, -49.72472311010272, -14.129313077645483, -12.738541446431958, -489.3250910385338, -1129.104836324588, -668.3575256522978, -503.6024174633716, -298.7066811962521, -227.394445610006, -469.4324019360572, -902.0730969373332, -561.9391133371305, -504.07964459747643, -157.60429043448582, -12.538992799440962, -765.0984663563507, -321.0510566126083, -436.5469963702042, -466.2080999783565, -31.283467381187855, -497.2961421497664, -316.75983338340933, -283.3908242482087, -18.068544360502578, -428.74808279582095, 18.304492602824244, -465.2397427613773, -1632.5131871732658, -24.07491413151537, -321.672851140659, -859.8383827692014, -270.1437220400188, -637.740446583958, 156.06035684857656, -93.54613734836866, -37.086788053447094, -322.37538185680654, -153.98854255348468, -622.3434610313144, -196.69858277824744, -686.9793200172637, -48.748739859434416, -574.5101903898071, 25.592667879579352, -69.50600824640702, -757.1308353177515, 383.21690450358426, 268.23075752069843, -572.1371232701156, -203.6321288637337, -362.546029073424, -232.8010918559712, -109.87698074691019, -276.6448461423045, -529.6245278287456, -676.8916594824578, -33.49214102154252, -339.2978769878869, -238.82651017558925, -417.59727661823104, -123.46811565818916, -238.80480631196292, -53.352254168870665, 35.324156926946344, -728.663080180929, -110.96910756469353, 167.79585220374878, -651.0182891129087, -661.0515811670176, -1002.3339569628894, -24.98794890229798, -580.9602165570298, -601.300004170106, -1005.2324648096343, -438.6346484564281, -426.21792555122414, -354.3553086594439, 65.61173018342578, -442.7677235039272, -1139.4533757373717, -165.6778756944886, -261.3379887317922, -107.15056127555374, 265.0000000000017, -121.3980787490602, -136.29142580096504, -932.8033136847426, -59.14920034782863, -195.8940988260051, 33.949797926410284, -50.596962995655126, -118.74605220725687, -140.50500724142543, -738.593712785601, -651.8090676369465, -75.48120900571854, -644.3325737115834, -886.6436436391327, -222.50397239651204, -143.6070584323904, -871.4170250612524, -251.61319538086582, -297.6219064723521, -724.0892563711659, -460.93642822224655, -543.0710630399401, -542.7186271969075, -456.9258222418897, 380.84347102509196, -698.4903558568285, -125.26042402329676, -369.0357445706438, -107.25443710915576, -872.3031973705337, -230.70597299628034, -239.2054095140743, -402.4287484612415, -89.14134808505827, -186.22012069018916, 35.270123075147126, -136.14516967347427, -682.8285663113206, -28.883804782408177, -316.23692993747886, -91.70810986535896, -184.24804680644738, -316.2749717051111, -253.0295978848285, -624.3022550715601, -684.3277535498518, -220.36373389841006, 232.05029037171266, -162.6427387224675, -167.13984938453476, -167.96770713135493, -213.87852338714083, 14.563825351069527, -375.5755844645924, -961.9146546948149, -218.20713452750374, -18.007281142331443, -242.11748851822966, -509.7348473427553, 154.2883684438157, -252.38342817547718, 69.63205508322665, -195.15048227685838, -408.5092109116641, -553.2765777164008, -10.138295337093211, -350.80606769376595, -247.7999200824008, -157.69912072216653, -335.5943024290453, -60.18583263575257, -707.3949592406872, 253.2702121438129, 23.54813008904228, -690.9390827434307, -688.3723274065155, -304.13975173421403], "policy_predator_policy_reward": [1428.1385593969399, 0.0, 204.55944757302302, 238.79245005177285, 247.9668748798696, 227.9265904679019, 242.97218206007233, 268.69147608031545, 503.4517880268994, 603.1291333688403, 182.55604750654868, 695.6975687465562, 1175.4869662038777, 516.5990799884373, 702.4067301291557, 543.9653357512298, 405.639676683829, 444.08351547983887, 265.4658415603547, 547.7834301112294, 303.26059449618253, 753.0143332910269, 883.790374466514, 373.8642325092342, 1290.8332615584534, 290.07207520458746, 50.268961350551535, 429.56276199688534, 74.45870723334012, 10.1553378362382, 739.7976491531413, 667.3338456090827, 113.28731069172665, 663.2768555903444, 701.9723039348129, 243.91544336535569, 506.8571249289118, 0.0, 163.72241589376392, 1035.9136522711512, 91.97459750604331, 6.49325701803497, 508.7250910385382, 1134.9048363245881, 451.35465503549034, 706.123983821083, 774.5674199862962, 45.164934524169155, 703.3375458192647, 718.1030452717152, 541.1951323600751, 545.709379083246, 196.95653921686045, 155.54242429726904, 184.44819761318277, 930.63527964078, 199.4760819065468, 581.3705390800479, 436.6753207227322, 421.5042735615952, 160.97703030609622, 481.58019424342444, 328.0094685699285, 197.81137486525762, 18.614999014348335, 495.9030241070781, 1628.4005983180482, 137.72694136792933, 335.22306920191323, 858.5416985006707, 563.0052921867236, 393.5854599470067, 221.36736082231397, 93.23071014364344, 227.94184280518377, 319.60717638358625, 598.6197559944682, 461.85262163605375, 86.2485517755329, 832.4533958380299, 428.7860945775972, 447.88476769147945, 14.931698870350283, 102.60600824640525, 264.8946331701034, 582.3158484211342, 264.82483839688194, 400.19750663880257, 207.98425011773094, 377.29538243314465, 248.682758688271, 249.43853407227567, 402.2158706391004, 608.7522243472462, 493.7705542767878, 198.20567763936717, 383.4836829630921, 237.66634360271186, 412.53329914413, 253.08688597449097, 206.08084983520703, 162.96242366327633, 466.1720592602472, 613.9988332660687, 144.16910756469164, 46.30414779625062, 389.28524527766905, 1010.2732715604642, 938.9274398859739, 292.5607181243813, 603.745148716609, 810.7586648926051, 969.7712584909445, 528.6520750633819, 6.80769499336664, 787.4913694322735, 269.4149618541754, 472.0850904870247, 1138.4856803200253, 250.89647123897973, 596.142238754558, 137.41547946176942, 0.0, 150.69807874905865, 223.35896202004815, 903.6726233453018, 92.54920034782715, 229.4940988260034, 42.1120119986999, 85.89696299565408, 159.34605220725538, 170.4050072414241, 722.4677342128939, 676.9601492973184, 567.5792665942099, 596.6892943130924, 439.2333851036899, 794.2507921282097, 961.8045083516677, 230.27495406956075, 532.7855654656275, 8.641090657173569, 586.8732267502501, 847.8850614053557, 557.2227661376722, 745.4315690556332, 467.72582224189006, 21.13603868136662, 629.0995192574842, 336.91687500821297, 525.635744570644, 142.34597207902996, 204.5419228762638, 863.0336079093865, 389.1808236915413, 290.6215544233606, 124.14134808505628, 217.4201206901874, 162.33949844469183, 26.525132889069233, 676.4609469000237, 100.20366733908772, 304.6268964629782, 215.0188547436499, 215.06650134535428, 349.20335779557894, 385.8593256534287, 564.9693670500974, 692.4277535498535, 248.1203513754404, 206.1148491436508, 94.13811130656441, 196.73984938453358, 198.1677071313532, 229.99544885547428, 45.09157743783933, 1220.763193039062, 226.1297123973214, 53.727197046368005, 289.40483545571817, 386.3452564841956, 599.9923923886213, 360.78236786500094, 237.35015891885178, 351.9286268024513, 273.9228269047427, 514.6750792255311, 565.626914398885, 238.72717189742286, 372.906067693771, 272.7277841274048, 448.86268567354387, 313.329920286966, 189.28753971608495, 230.82572646182982, 661.7114856238255, 15.451869910957754, 713.8390827434357, 714.1885695592954, 409.78309206212145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.797680347696662, "mean_inference_ms": 4.455391114021882, "mean_action_processing_ms": 1.4855263694135905, "mean_env_wait_ms": 10.52980236719681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027662038803100586, "StateBufferConnector_ms": 0.005238890647888184, "ViewRequirementAgentConnector_ms": 0.25423967838287354}, "num_episodes": 8, "episode_return_max": 741.0948673647298, "episode_return_min": -121.90847536196947, "episode_return_mean": 163.53393505797976, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 68.96434331209225, "num_env_steps_trained_throughput_per_sec": 68.96434331209225, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 127043.223, "restore_workers_time_ms": 0.014, "training_step_time_ms": 127043.115, "sample_time_ms": 3192.249, "learn_time_ms": 123827.472, "learn_throughput": 32.303, "synch_weights_time_ms": 17.732}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "35fb9_00000", "date": "2024-08-22_09-08-08", "timestamp": 1724297888, "time_this_iter_s": 58.057010889053345, "time_total_s": 4465.85539150238, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc7b0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4465.85539150238, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 44.45301204819276, "ram_util_percent": 83.08795180722893}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.465920561583584, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.120654110050706, "policy_loss": -0.020591468610135572, "vf_loss": 4.138660185046928, "vf_explained_var": 0.631331821408852, "kl": 0.012926937701062314, "entropy": 0.8231190182544567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.061163209039698, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.488780030245503, "policy_loss": -0.01870648379304579, "vf_loss": 4.505207746621793, "vf_explained_var": 0.3272796935505337, "kl": 0.011393797664444835, "entropy": 0.6099184539582995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 741.0948673647298, "episode_reward_min": -121.90847536196947, "episode_reward_mean": 158.56664609388395, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1632.5131871732658, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1628.4005983180482}, "policy_reward_mean": {"prey_policy": -328.5492964151761, "predator_policy": 407.83261946211877}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.9373018801809, 741.0948673647298, 513.3393565858045, 160.25590068243804, 51.037953099351526, 80.63131429396955, 54.40000000000051, 81.04093866620497, 215.85999607939138, 502.64141967741904, 37.71803398875015, 49.252730108822995, 114.30747997962955, 71.6000000000002, 25.200000000000088, -14.481304259101227, 293.631227704209, 49.93509221758458, 20.885753508713446, 182.35568028020467, 28.933954284994947, -121.90847536196947, 329.5999847533703, 42.40656691789585, 79.00421627885822, 67.58277296286835, 109.53943838119581, 12.253533792723731, 48.70658350974759, 377.1122904661684, 188.08684927850737, 284.14037404572474, 35.02404481804818, 253.41193201983097, 73.62436674992966, 473.29655077707275, 361.11597928626736, 19.10147461371583, 155.4432201576657, 204.69872101529307, -18.40756858784433, 43.02563940232515, 124.55479284219462, 76.88621301765029, 386.8319692723352, 247.29999999999788, 87.48864655819915, 204.16625214516534, 232.24359288207503, 54.55622028826161, 13.725830214967651, 364.34405902069636, 84.25090012714571, 365.0691682089804, 294.30000000000604, 57.93684587964413, 67.00000000000047, 111.36180992510764, 70.50000000000018, 9.025103087664043, 444.4547781900025, 124.33656119625475, 177.05537892758537, -7.808445730422971, 249.73260356218665, 216.86464495645606, 412.7795097064589, 142.26561438557135, 191.69153496987542, -35.43363958116312, 38.16822013958303, 66.2000000000005, 87.98958473543472, 64.95224314538166, 111.70071140378577, 63.74684062937235, 73.49683974713618, 35.85661747703209, 369.6605120994634, 59.80000000000057, 75.7723282572432, 109.40266627697126, 106.91761683224883, 234.485313011826, 500.03746705219237, 500.33302651356536, 118.51620499634667, 250.68887656032888, 316.091428996378, 106.8373249382522, 438.41246498877916, 61.90000000000061, 131.45958248068035, 63.02209258649139, 184.31370344275373, 119.27404357867398, 160.83292239484652, 108.871943035849, 52.069171197434805, 149.93872739675277], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-838.0756403990601, -356.35912360113844, -479.44906627724345, 370.8207414783054, -699.9099150857809, 400.0, -92.4601139244062, -803.558913180366, -946.1961723657779, -260.4204815106142, -762.0733262336764, -738.2006962353923, -13.568961350551058, -411.8627619968813, -43.57310640337345, 40.0000000000003, -315.95547448259225, -875.3160242002409, 384.55558099579036, -658.4783276004426, -84.25928467523512, -823.9104286361852, -447.292872505867, -10.311522314218756, -1035.6038650751825, -49.72472311010272, -14.129313077645483, -12.738541446431958, -489.3250910385338, -1129.104836324588, -668.3575256522978, -503.6024174633716, -298.7066811962521, -227.394445610006, -469.4324019360572, -902.0730969373332, -561.9391133371305, -504.07964459747643, -157.60429043448582, -12.538992799440962, -765.0984663563507, -321.0510566126083, -436.5469963702042, -466.2080999783565, -31.283467381187855, -497.2961421497664, -316.75983338340933, -283.3908242482087, -18.068544360502578, -428.74808279582095, 18.304492602824244, -465.2397427613773, -1632.5131871732658, -24.07491413151537, -321.672851140659, -859.8383827692014, -270.1437220400188, -637.740446583958, 156.06035684857656, -93.54613734836866, -37.086788053447094, -322.37538185680654, -153.98854255348468, -622.3434610313144, -196.69858277824744, -686.9793200172637, -48.748739859434416, -574.5101903898071, 25.592667879579352, -69.50600824640702, -757.1308353177515, 383.21690450358426, 268.23075752069843, -572.1371232701156, -203.6321288637337, -362.546029073424, -232.8010918559712, -109.87698074691019, -276.6448461423045, -529.6245278287456, -676.8916594824578, -33.49214102154252, -339.2978769878869, -238.82651017558925, -417.59727661823104, -123.46811565818916, -238.80480631196292, -53.352254168870665, 35.324156926946344, -728.663080180929, -110.96910756469353, 167.79585220374878, -651.0182891129087, -661.0515811670176, -1002.3339569628894, -24.98794890229798, -580.9602165570298, -601.300004170106, -1005.2324648096343, -438.6346484564281, -426.21792555122414, -354.3553086594439, 65.61173018342578, -442.7677235039272, -1139.4533757373717, -165.6778756944886, -261.3379887317922, -107.15056127555374, 265.0000000000017, -121.3980787490602, -136.29142580096504, -932.8033136847426, -59.14920034782863, -195.8940988260051, 33.949797926410284, -50.596962995655126, -118.74605220725687, -140.50500724142543, -738.593712785601, -651.8090676369465, -75.48120900571854, -644.3325737115834, -886.6436436391327, -222.50397239651204, -143.6070584323904, -871.4170250612524, -251.61319538086582, -297.6219064723521, -724.0892563711659, -460.93642822224655, -543.0710630399401, -542.7186271969075, -456.9258222418897, 380.84347102509196, -698.4903558568285, -125.26042402329676, -369.0357445706438, -107.25443710915576, -872.3031973705337, -230.70597299628034, -239.2054095140743, -402.4287484612415, -89.14134808505827, -186.22012069018916, 35.270123075147126, -136.14516967347427, -682.8285663113206, -28.883804782408177, -316.23692993747886, -91.70810986535896, -184.24804680644738, -316.2749717051111, -253.0295978848285, -624.3022550715601, -684.3277535498518, -220.36373389841006, 232.05029037171266, -162.6427387224675, -167.13984938453476, -167.96770713135493, -213.87852338714083, 14.563825351069527, -375.5755844645924, -961.9146546948149, -218.20713452750374, -18.007281142331443, -242.11748851822966, -509.7348473427553, 154.2883684438157, -252.38342817547718, 69.63205508322665, -195.15048227685838, -408.5092109116641, -553.2765777164008, -10.138295337093211, -350.80606769376595, -247.7999200824008, -157.69912072216653, -335.5943024290453, -60.18583263575257, -707.3949592406872, 253.2702121438129, 23.54813008904228, -690.9390827434307, -688.3723274065155, -304.13975173421403, -106.75075354133682, -76.64440599131008, -750.6144464396547, -137.00587882462477, -833.7444518424979, -278.84673129462084, -130.03548016644854, 75.99999999999964, -290.72375250392014, -729.0320128119065, -126.27328781922674, -158.32216156860827, -667.6099998068263, -6.185501097066558], "policy_predator_policy_reward": [702.4067301291557, 543.9653357512298, 405.639676683829, 444.08351547983887, 265.4658415603547, 547.7834301112294, 303.26059449618253, 753.0143332910269, 883.790374466514, 373.8642325092342, 1290.8332615584534, 290.07207520458746, 50.268961350551535, 429.56276199688534, 74.45870723334012, 10.1553378362382, 739.7976491531413, 667.3338456090827, 113.28731069172665, 663.2768555903444, 701.9723039348129, 243.91544336535569, 506.8571249289118, 0.0, 163.72241589376392, 1035.9136522711512, 91.97459750604331, 6.49325701803497, 508.7250910385382, 1134.9048363245881, 451.35465503549034, 706.123983821083, 774.5674199862962, 45.164934524169155, 703.3375458192647, 718.1030452717152, 541.1951323600751, 545.709379083246, 196.95653921686045, 155.54242429726904, 184.44819761318277, 930.63527964078, 199.4760819065468, 581.3705390800479, 436.6753207227322, 421.5042735615952, 160.97703030609622, 481.58019424342444, 328.0094685699285, 197.81137486525762, 18.614999014348335, 495.9030241070781, 1628.4005983180482, 137.72694136792933, 335.22306920191323, 858.5416985006707, 563.0052921867236, 393.5854599470067, 221.36736082231397, 93.23071014364344, 227.94184280518377, 319.60717638358625, 598.6197559944682, 461.85262163605375, 86.2485517755329, 832.4533958380299, 428.7860945775972, 447.88476769147945, 14.931698870350283, 102.60600824640525, 264.8946331701034, 582.3158484211342, 264.82483839688194, 400.19750663880257, 207.98425011773094, 377.29538243314465, 248.682758688271, 249.43853407227567, 402.2158706391004, 608.7522243472462, 493.7705542767878, 198.20567763936717, 383.4836829630921, 237.66634360271186, 412.53329914413, 253.08688597449097, 206.08084983520703, 162.96242366327633, 466.1720592602472, 613.9988332660687, 144.16910756469164, 46.30414779625062, 389.28524527766905, 1010.2732715604642, 938.9274398859739, 292.5607181243813, 603.745148716609, 810.7586648926051, 969.7712584909445, 528.6520750633819, 6.80769499336664, 787.4913694322735, 269.4149618541754, 472.0850904870247, 1138.4856803200253, 250.89647123897973, 596.142238754558, 137.41547946176942, 0.0, 150.69807874905865, 223.35896202004815, 903.6726233453018, 92.54920034782715, 229.4940988260034, 42.1120119986999, 85.89696299565408, 159.34605220725538, 170.4050072414241, 722.4677342128939, 676.9601492973184, 567.5792665942099, 596.6892943130924, 439.2333851036899, 794.2507921282097, 961.8045083516677, 230.27495406956075, 532.7855654656275, 8.641090657173569, 586.8732267502501, 847.8850614053557, 557.2227661376722, 745.4315690556332, 467.72582224189006, 21.13603868136662, 629.0995192574842, 336.91687500821297, 525.635744570644, 142.34597207902996, 204.5419228762638, 863.0336079093865, 389.1808236915413, 290.6215544233606, 124.14134808505628, 217.4201206901874, 162.33949844469183, 26.525132889069233, 676.4609469000237, 100.20366733908772, 304.6268964629782, 215.0188547436499, 215.06650134535428, 349.20335779557894, 385.8593256534287, 564.9693670500974, 692.4277535498535, 248.1203513754404, 206.1148491436508, 94.13811130656441, 196.73984938453358, 198.1677071313532, 229.99544885547428, 45.09157743783933, 1220.763193039062, 226.1297123973214, 53.727197046368005, 289.40483545571817, 386.3452564841956, 599.9923923886213, 360.78236786500094, 237.35015891885178, 351.9286268024513, 273.9228269047427, 514.6750792255311, 565.626914398885, 238.72717189742286, 372.906067693771, 272.7277841274048, 448.86268567354387, 313.329920286966, 189.28753971608495, 230.82572646182982, 661.7114856238255, 15.451869910957754, 713.8390827434357, 714.1885695592954, 409.78309206212145, 136.27784361697638, 110.13940850215792, 644.4867027084877, 427.4473259985441, 824.7485214680132, 407.1167052477792, 159.20657723107615, 55.661825330220815, 232.20967996629008, 896.4180283853876, 235.82286067914046, 100.84175990612542, 622.8683435941912, 200.8658847064552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.817258254919142, "mean_inference_ms": 4.469425371293195, "mean_action_processing_ms": 1.4712092800615608, "mean_env_wait_ms": 10.560156919904053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027617931365966797, "StateBufferConnector_ms": 0.0064154863357543945, "ViewRequirementAgentConnector_ms": 0.2709418535232544}, "num_episodes": 7, "episode_return_max": 741.0948673647298, "episode_return_min": -121.90847536196947, "episode_return_mean": 158.56664609388395, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.92674334806593, "num_env_steps_trained_throughput_per_sec": 77.92674334806593, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 52860.596, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52860.487, "sample_time_ms": 3024.256, "learn_time_ms": 49812.573, "learn_throughput": 80.301, "synch_weights_time_ms": 18.043}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "35fb9_00000", "date": "2024-08-22_09-09-00", "timestamp": 1724297940, "time_this_iter_s": 51.40669107437134, "time_total_s": 4517.262082576752, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b630f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4517.262082576752, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 33.78493150684931, "ram_util_percent": 83.14520547945206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.693608478831237, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.87003494810175, "policy_loss": -0.01979550871980825, "vf_loss": 3.887202099895982, "vf_explained_var": 0.6278259514185487, "kl": 0.013141773061003911, "entropy": 0.8257607047204618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.85860291044548, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.065746797203387, "policy_loss": -0.016469429777664128, "vf_loss": 4.079926681896997, "vf_explained_var": 0.3748989971226485, "kl": 0.011447684395511354, "entropy": 0.5976005409918134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 500.33302651356536, "episode_reward_min": -121.90847536196947, "episode_reward_mean": 145.17316213534474, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1632.5131871732658, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.21690450358426, "predator_policy": 1628.4005983180482}, "policy_reward_mean": {"prey_policy": -325.957759825289, "predator_policy": 398.54434089296194}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.30747997962955, 71.6000000000002, 25.200000000000088, -14.481304259101227, 293.631227704209, 49.93509221758458, 20.885753508713446, 182.35568028020467, 28.933954284994947, -121.90847536196947, 329.5999847533703, 42.40656691789585, 79.00421627885822, 67.58277296286835, 109.53943838119581, 12.253533792723731, 48.70658350974759, 377.1122904661684, 188.08684927850737, 284.14037404572474, 35.02404481804818, 253.41193201983097, 73.62436674992966, 473.29655077707275, 361.11597928626736, 19.10147461371583, 155.4432201576657, 204.69872101529307, -18.40756858784433, 43.02563940232515, 124.55479284219462, 76.88621301765029, 386.8319692723352, 247.29999999999788, 87.48864655819915, 204.16625214516534, 232.24359288207503, 54.55622028826161, 13.725830214967651, 364.34405902069636, 84.25090012714571, 365.0691682089804, 294.30000000000604, 57.93684587964413, 67.00000000000047, 111.36180992510764, 70.50000000000018, 9.025103087664043, 444.4547781900025, 124.33656119625475, 177.05537892758537, -7.808445730422971, 249.73260356218665, 216.86464495645606, 412.7795097064589, 142.26561438557135, 191.69153496987542, -35.43363958116312, 38.16822013958303, 66.2000000000005, 87.98958473543472, 64.95224314538166, 111.70071140378577, 63.74684062937235, 73.49683974713618, 35.85661747703209, 369.6605120994634, 59.80000000000057, 75.7723282572432, 109.40266627697126, 106.91761683224883, 234.485313011826, 500.03746705219237, 500.33302651356536, 118.51620499634667, 250.68887656032888, 316.091428996378, 106.8373249382522, 438.41246498877916, 61.90000000000061, 131.45958248068035, 63.02209258649139, 184.31370344275373, 119.27404357867398, 160.83292239484652, 108.871943035849, 52.069171197434805, 149.93872739675277, 48.400000000000425, 111.33289031567783, 131.57899744882738, 114.6819965281934, 61.312106740927035, 69.42673469954602, 137.90841780116997, 64.01302849688028, 69.44561034197876, 286.00146386939684, 53.68606797750017, 52.074102353045205], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1035.6038650751825, -49.72472311010272, -14.129313077645483, -12.738541446431958, -489.3250910385338, -1129.104836324588, -668.3575256522978, -503.6024174633716, -298.7066811962521, -227.394445610006, -469.4324019360572, -902.0730969373332, -561.9391133371305, -504.07964459747643, -157.60429043448582, -12.538992799440962, -765.0984663563507, -321.0510566126083, -436.5469963702042, -466.2080999783565, -31.283467381187855, -497.2961421497664, -316.75983338340933, -283.3908242482087, -18.068544360502578, -428.74808279582095, 18.304492602824244, -465.2397427613773, -1632.5131871732658, -24.07491413151537, -321.672851140659, -859.8383827692014, -270.1437220400188, -637.740446583958, 156.06035684857656, -93.54613734836866, -37.086788053447094, -322.37538185680654, -153.98854255348468, -622.3434610313144, -196.69858277824744, -686.9793200172637, -48.748739859434416, -574.5101903898071, 25.592667879579352, -69.50600824640702, -757.1308353177515, 383.21690450358426, 268.23075752069843, -572.1371232701156, -203.6321288637337, -362.546029073424, -232.8010918559712, -109.87698074691019, -276.6448461423045, -529.6245278287456, -676.8916594824578, -33.49214102154252, -339.2978769878869, -238.82651017558925, -417.59727661823104, -123.46811565818916, -238.80480631196292, -53.352254168870665, 35.324156926946344, -728.663080180929, -110.96910756469353, 167.79585220374878, -651.0182891129087, -661.0515811670176, -1002.3339569628894, -24.98794890229798, -580.9602165570298, -601.300004170106, -1005.2324648096343, -438.6346484564281, -426.21792555122414, -354.3553086594439, 65.61173018342578, -442.7677235039272, -1139.4533757373717, -165.6778756944886, -261.3379887317922, -107.15056127555374, 265.0000000000017, -121.3980787490602, -136.29142580096504, -932.8033136847426, -59.14920034782863, -195.8940988260051, 33.949797926410284, -50.596962995655126, -118.74605220725687, -140.50500724142543, -738.593712785601, -651.8090676369465, -75.48120900571854, -644.3325737115834, -886.6436436391327, -222.50397239651204, -143.6070584323904, -871.4170250612524, -251.61319538086582, -297.6219064723521, -724.0892563711659, -460.93642822224655, -543.0710630399401, -542.7186271969075, -456.9258222418897, 380.84347102509196, -698.4903558568285, -125.26042402329676, -369.0357445706438, -107.25443710915576, -872.3031973705337, -230.70597299628034, -239.2054095140743, -402.4287484612415, -89.14134808505827, -186.22012069018916, 35.270123075147126, -136.14516967347427, -682.8285663113206, -28.883804782408177, -316.23692993747886, -91.70810986535896, -184.24804680644738, -316.2749717051111, -253.0295978848285, -624.3022550715601, -684.3277535498518, -220.36373389841006, 232.05029037171266, -162.6427387224675, -167.13984938453476, -167.96770713135493, -213.87852338714083, 14.563825351069527, -375.5755844645924, -961.9146546948149, -218.20713452750374, -18.007281142331443, -242.11748851822966, -509.7348473427553, 154.2883684438157, -252.38342817547718, 69.63205508322665, -195.15048227685838, -408.5092109116641, -553.2765777164008, -10.138295337093211, -350.80606769376595, -247.7999200824008, -157.69912072216653, -335.5943024290453, -60.18583263575257, -707.3949592406872, 253.2702121438129, 23.54813008904228, -690.9390827434307, -688.3723274065155, -304.13975173421403, -106.75075354133682, -76.64440599131008, -750.6144464396547, -137.00587882462477, -833.7444518424979, -278.84673129462084, -130.03548016644854, 75.99999999999964, -290.72375250392014, -729.0320128119065, -126.27328781922674, -158.32216156860827, -667.6099998068263, -6.185501097066558, -101.17478237501561, -1084.8192918899, -3.5549201243625457, -983.2770419589846, -525.8331365589269, -310.2172105649164, -501.1102391892948, 66.07170070710677, -37.14362055186532, -291.72554195536065, -348.3600052564796, -149.87670879318927, -65.4491614872403, -163.6598375841644, -158.87574182350218, -1289.5239590894296, -74.40601593516803, -14.00107619948259, -468.9697098479102, 108.03612446758399, -375.20063537417656, -171.09665900334014, -1041.43477266785, 38.053670528363], "policy_predator_policy_reward": [163.72241589376392, 1035.9136522711512, 91.97459750604331, 6.49325701803497, 508.7250910385382, 1134.9048363245881, 451.35465503549034, 706.123983821083, 774.5674199862962, 45.164934524169155, 703.3375458192647, 718.1030452717152, 541.1951323600751, 545.709379083246, 196.95653921686045, 155.54242429726904, 184.44819761318277, 930.63527964078, 199.4760819065468, 581.3705390800479, 436.6753207227322, 421.5042735615952, 160.97703030609622, 481.58019424342444, 328.0094685699285, 197.81137486525762, 18.614999014348335, 495.9030241070781, 1628.4005983180482, 137.72694136792933, 335.22306920191323, 858.5416985006707, 563.0052921867236, 393.5854599470067, 221.36736082231397, 93.23071014364344, 227.94184280518377, 319.60717638358625, 598.6197559944682, 461.85262163605375, 86.2485517755329, 832.4533958380299, 428.7860945775972, 447.88476769147945, 14.931698870350283, 102.60600824640525, 264.8946331701034, 582.3158484211342, 264.82483839688194, 400.19750663880257, 207.98425011773094, 377.29538243314465, 248.682758688271, 249.43853407227567, 402.2158706391004, 608.7522243472462, 493.7705542767878, 198.20567763936717, 383.4836829630921, 237.66634360271186, 412.53329914413, 253.08688597449097, 206.08084983520703, 162.96242366327633, 466.1720592602472, 613.9988332660687, 144.16910756469164, 46.30414779625062, 389.28524527766905, 1010.2732715604642, 938.9274398859739, 292.5607181243813, 603.745148716609, 810.7586648926051, 969.7712584909445, 528.6520750633819, 6.80769499336664, 787.4913694322735, 269.4149618541754, 472.0850904870247, 1138.4856803200253, 250.89647123897973, 596.142238754558, 137.41547946176942, 0.0, 150.69807874905865, 223.35896202004815, 903.6726233453018, 92.54920034782715, 229.4940988260034, 42.1120119986999, 85.89696299565408, 159.34605220725538, 170.4050072414241, 722.4677342128939, 676.9601492973184, 567.5792665942099, 596.6892943130924, 439.2333851036899, 794.2507921282097, 961.8045083516677, 230.27495406956075, 532.7855654656275, 8.641090657173569, 586.8732267502501, 847.8850614053557, 557.2227661376722, 745.4315690556332, 467.72582224189006, 21.13603868136662, 629.0995192574842, 336.91687500821297, 525.635744570644, 142.34597207902996, 204.5419228762638, 863.0336079093865, 389.1808236915413, 290.6215544233606, 124.14134808505628, 217.4201206901874, 162.33949844469183, 26.525132889069233, 676.4609469000237, 100.20366733908772, 304.6268964629782, 215.0188547436499, 215.06650134535428, 349.20335779557894, 385.8593256534287, 564.9693670500974, 692.4277535498535, 248.1203513754404, 206.1148491436508, 94.13811130656441, 196.73984938453358, 198.1677071313532, 229.99544885547428, 45.09157743783933, 1220.763193039062, 226.1297123973214, 53.727197046368005, 289.40483545571817, 386.3452564841956, 599.9923923886213, 360.78236786500094, 237.35015891885178, 351.9286268024513, 273.9228269047427, 514.6750792255311, 565.626914398885, 238.72717189742286, 372.906067693771, 272.7277841274048, 448.86268567354387, 313.329920286966, 189.28753971608495, 230.82572646182982, 661.7114856238255, 15.451869910957754, 713.8390827434357, 714.1885695592954, 409.78309206212145, 136.27784361697638, 110.13940850215792, 644.4867027084877, 427.4473259985441, 824.7485214680132, 407.1167052477792, 159.20657723107615, 55.661825330220815, 232.20967996629008, 896.4180283853876, 235.82286067914046, 100.84175990612542, 622.8683435941912, 200.8658847064552, 132.37478237501466, 1102.0192918898845, 111.45192262531194, 986.712929773719, 402.3613065126999, 565.2680380599758, 459.18424576625137, 90.536289244136, 84.97490252273174, 305.2063667254253, 155.406024094477, 412.257424654741, 238.79597453320366, 128.22144233937064, 223.20679690867289, 1289.2059325011387, 104.91003057216392, 52.942671904463815, 270.4303011830782, 376.5047480666486, 386.4040900834523, 213.57927227156563, 1041.83477266785, 13.620431824682058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.81968904099593, "mean_inference_ms": 4.455791361194759, "mean_action_processing_ms": 1.4923135454308951, "mean_env_wait_ms": 10.54389876516343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007340788841247559, "StateBufferConnector_ms": 0.006342768669128418, "ViewRequirementAgentConnector_ms": 0.23074603080749512}, "num_episodes": 12, "episode_return_max": 500.33302651356536, "episode_return_min": -121.90847536196947, "episode_return_mean": 145.17316213534474, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.20716763312451, "num_env_steps_trained_throughput_per_sec": 76.20716763312451, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 52873.627, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52873.525, "sample_time_ms": 3025.094, "learn_time_ms": 49823.393, "learn_throughput": 80.284, "synch_weights_time_ms": 19.202}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "35fb9_00000", "date": "2024-08-22_09-09-52", "timestamp": 1724297992, "time_this_iter_s": 52.52797484397888, "time_total_s": 4569.790057420731, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc83e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4569.790057420731, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 37.63243243243244, "ram_util_percent": 82.17297297297297}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.004868383886954, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.337846594512778, "policy_loss": -0.01975142016979772, "vf_loss": 3.3556177781372476, "vf_explained_var": 0.6730649219934272, "kl": 0.009901183315986403, "entropy": 0.8294183956252204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.605579886739216, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.8750056246601083, "policy_loss": -0.023720053998413423, "vf_loss": 3.8959295723173355, "vf_explained_var": 0.3474261288605039, "kl": 0.013980531611814898, "entropy": 0.6654401850132715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 500.33302651356536, "episode_reward_min": -121.90847536196947, "episode_reward_mean": 143.8987850554357, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1632.5131871732658, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.21690450358426, "predator_policy": 1628.4005983180482}, "policy_reward_mean": {"prey_policy": -309.5255401507268, "predator_policy": 381.47493267844527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.93509221758458, 20.885753508713446, 182.35568028020467, 28.933954284994947, -121.90847536196947, 329.5999847533703, 42.40656691789585, 79.00421627885822, 67.58277296286835, 109.53943838119581, 12.253533792723731, 48.70658350974759, 377.1122904661684, 188.08684927850737, 284.14037404572474, 35.02404481804818, 253.41193201983097, 73.62436674992966, 473.29655077707275, 361.11597928626736, 19.10147461371583, 155.4432201576657, 204.69872101529307, -18.40756858784433, 43.02563940232515, 124.55479284219462, 76.88621301765029, 386.8319692723352, 247.29999999999788, 87.48864655819915, 204.16625214516534, 232.24359288207503, 54.55622028826161, 13.725830214967651, 364.34405902069636, 84.25090012714571, 365.0691682089804, 294.30000000000604, 57.93684587964413, 67.00000000000047, 111.36180992510764, 70.50000000000018, 9.025103087664043, 444.4547781900025, 124.33656119625475, 177.05537892758537, -7.808445730422971, 249.73260356218665, 216.86464495645606, 412.7795097064589, 142.26561438557135, 191.69153496987542, -35.43363958116312, 38.16822013958303, 66.2000000000005, 87.98958473543472, 64.95224314538166, 111.70071140378577, 63.74684062937235, 73.49683974713618, 35.85661747703209, 369.6605120994634, 59.80000000000057, 75.7723282572432, 109.40266627697126, 106.91761683224883, 234.485313011826, 500.03746705219237, 500.33302651356536, 118.51620499634667, 250.68887656032888, 316.091428996378, 106.8373249382522, 438.41246498877916, 61.90000000000061, 131.45958248068035, 63.02209258649139, 184.31370344275373, 119.27404357867398, 160.83292239484652, 108.871943035849, 52.069171197434805, 149.93872739675277, 48.400000000000425, 111.33289031567783, 131.57899744882738, 114.6819965281934, 61.312106740927035, 69.42673469954602, 137.90841780116997, 64.01302849688028, 69.44561034197876, 286.00146386939684, 53.68606797750017, 52.074102353045205, 70.93041885596368, 34.88424215965815, 76.49999999999993, 115.00503441820858, 65.50000000000055], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-469.4324019360572, -902.0730969373332, -561.9391133371305, -504.07964459747643, -157.60429043448582, -12.538992799440962, -765.0984663563507, -321.0510566126083, -436.5469963702042, -466.2080999783565, -31.283467381187855, -497.2961421497664, -316.75983338340933, -283.3908242482087, -18.068544360502578, -428.74808279582095, 18.304492602824244, -465.2397427613773, -1632.5131871732658, -24.07491413151537, -321.672851140659, -859.8383827692014, -270.1437220400188, -637.740446583958, 156.06035684857656, -93.54613734836866, -37.086788053447094, -322.37538185680654, -153.98854255348468, -622.3434610313144, -196.69858277824744, -686.9793200172637, -48.748739859434416, -574.5101903898071, 25.592667879579352, -69.50600824640702, -757.1308353177515, 383.21690450358426, 268.23075752069843, -572.1371232701156, -203.6321288637337, -362.546029073424, -232.8010918559712, -109.87698074691019, -276.6448461423045, -529.6245278287456, -676.8916594824578, -33.49214102154252, -339.2978769878869, -238.82651017558925, -417.59727661823104, -123.46811565818916, -238.80480631196292, -53.352254168870665, 35.324156926946344, -728.663080180929, -110.96910756469353, 167.79585220374878, -651.0182891129087, -661.0515811670176, -1002.3339569628894, -24.98794890229798, -580.9602165570298, -601.300004170106, -1005.2324648096343, -438.6346484564281, -426.21792555122414, -354.3553086594439, 65.61173018342578, -442.7677235039272, -1139.4533757373717, -165.6778756944886, -261.3379887317922, -107.15056127555374, 265.0000000000017, -121.3980787490602, -136.29142580096504, -932.8033136847426, -59.14920034782863, -195.8940988260051, 33.949797926410284, -50.596962995655126, -118.74605220725687, -140.50500724142543, -738.593712785601, -651.8090676369465, -75.48120900571854, -644.3325737115834, -886.6436436391327, -222.50397239651204, -143.6070584323904, -871.4170250612524, -251.61319538086582, -297.6219064723521, -724.0892563711659, -460.93642822224655, -543.0710630399401, -542.7186271969075, -456.9258222418897, 380.84347102509196, -698.4903558568285, -125.26042402329676, -369.0357445706438, -107.25443710915576, -872.3031973705337, -230.70597299628034, -239.2054095140743, -402.4287484612415, -89.14134808505827, -186.22012069018916, 35.270123075147126, -136.14516967347427, -682.8285663113206, -28.883804782408177, -316.23692993747886, -91.70810986535896, -184.24804680644738, -316.2749717051111, -253.0295978848285, -624.3022550715601, -684.3277535498518, -220.36373389841006, 232.05029037171266, -162.6427387224675, -167.13984938453476, -167.96770713135493, -213.87852338714083, 14.563825351069527, -375.5755844645924, -961.9146546948149, -218.20713452750374, -18.007281142331443, -242.11748851822966, -509.7348473427553, 154.2883684438157, -252.38342817547718, 69.63205508322665, -195.15048227685838, -408.5092109116641, -553.2765777164008, -10.138295337093211, -350.80606769376595, -247.7999200824008, -157.69912072216653, -335.5943024290453, -60.18583263575257, -707.3949592406872, 253.2702121438129, 23.54813008904228, -690.9390827434307, -688.3723274065155, -304.13975173421403, -106.75075354133682, -76.64440599131008, -750.6144464396547, -137.00587882462477, -833.7444518424979, -278.84673129462084, -130.03548016644854, 75.99999999999964, -290.72375250392014, -729.0320128119065, -126.27328781922674, -158.32216156860827, -667.6099998068263, -6.185501097066558, -101.17478237501561, -1084.8192918899, -3.5549201243625457, -983.2770419589846, -525.8331365589269, -310.2172105649164, -501.1102391892948, 66.07170070710677, -37.14362055186532, -291.72554195536065, -348.3600052564796, -149.87670879318927, -65.4491614872403, -163.6598375841644, -158.87574182350218, -1289.5239590894296, -74.40601593516803, -14.00107619948259, -468.9697098479102, 108.03612446758399, -375.20063537417656, -171.09665900334014, -1041.43477266785, 38.053670528363, -80.45053871047463, -19.70748643001624, -327.04897660294483, -401.8759677945909, 24.432243141793695, -4.003256582443058, -147.03835928513686, 26.460577812280643, 14.509052868500378, -227.5207934989492], "policy_predator_policy_reward": [703.3375458192647, 718.1030452717152, 541.1951323600751, 545.709379083246, 196.95653921686045, 155.54242429726904, 184.44819761318277, 930.63527964078, 199.4760819065468, 581.3705390800479, 436.6753207227322, 421.5042735615952, 160.97703030609622, 481.58019424342444, 328.0094685699285, 197.81137486525762, 18.614999014348335, 495.9030241070781, 1628.4005983180482, 137.72694136792933, 335.22306920191323, 858.5416985006707, 563.0052921867236, 393.5854599470067, 221.36736082231397, 93.23071014364344, 227.94184280518377, 319.60717638358625, 598.6197559944682, 461.85262163605375, 86.2485517755329, 832.4533958380299, 428.7860945775972, 447.88476769147945, 14.931698870350283, 102.60600824640525, 264.8946331701034, 582.3158484211342, 264.82483839688194, 400.19750663880257, 207.98425011773094, 377.29538243314465, 248.682758688271, 249.43853407227567, 402.2158706391004, 608.7522243472462, 493.7705542767878, 198.20567763936717, 383.4836829630921, 237.66634360271186, 412.53329914413, 253.08688597449097, 206.08084983520703, 162.96242366327633, 466.1720592602472, 613.9988332660687, 144.16910756469164, 46.30414779625062, 389.28524527766905, 1010.2732715604642, 938.9274398859739, 292.5607181243813, 603.745148716609, 810.7586648926051, 969.7712584909445, 528.6520750633819, 6.80769499336664, 787.4913694322735, 269.4149618541754, 472.0850904870247, 1138.4856803200253, 250.89647123897973, 596.142238754558, 137.41547946176942, 0.0, 150.69807874905865, 223.35896202004815, 903.6726233453018, 92.54920034782715, 229.4940988260034, 42.1120119986999, 85.89696299565408, 159.34605220725538, 170.4050072414241, 722.4677342128939, 676.9601492973184, 567.5792665942099, 596.6892943130924, 439.2333851036899, 794.2507921282097, 961.8045083516677, 230.27495406956075, 532.7855654656275, 8.641090657173569, 586.8732267502501, 847.8850614053557, 557.2227661376722, 745.4315690556332, 467.72582224189006, 21.13603868136662, 629.0995192574842, 336.91687500821297, 525.635744570644, 142.34597207902996, 204.5419228762638, 863.0336079093865, 389.1808236915413, 290.6215544233606, 124.14134808505628, 217.4201206901874, 162.33949844469183, 26.525132889069233, 676.4609469000237, 100.20366733908772, 304.6268964629782, 215.0188547436499, 215.06650134535428, 349.20335779557894, 385.8593256534287, 564.9693670500974, 692.4277535498535, 248.1203513754404, 206.1148491436508, 94.13811130656441, 196.73984938453358, 198.1677071313532, 229.99544885547428, 45.09157743783933, 1220.763193039062, 226.1297123973214, 53.727197046368005, 289.40483545571817, 386.3452564841956, 599.9923923886213, 360.78236786500094, 237.35015891885178, 351.9286268024513, 273.9228269047427, 514.6750792255311, 565.626914398885, 238.72717189742286, 372.906067693771, 272.7277841274048, 448.86268567354387, 313.329920286966, 189.28753971608495, 230.82572646182982, 661.7114856238255, 15.451869910957754, 713.8390827434357, 714.1885695592954, 409.78309206212145, 136.27784361697638, 110.13940850215792, 644.4867027084877, 427.4473259985441, 824.7485214680132, 407.1167052477792, 159.20657723107615, 55.661825330220815, 232.20967996629008, 896.4180283853876, 235.82286067914046, 100.84175990612542, 622.8683435941912, 200.8658847064552, 132.37478237501466, 1102.0192918898845, 111.45192262531194, 986.712929773719, 402.3613065126999, 565.2680380599758, 459.18424576625137, 90.536289244136, 84.97490252273174, 305.2063667254253, 155.406024094477, 412.257424654741, 238.79597453320366, 128.22144233937064, 223.20679690867289, 1289.2059325011387, 104.91003057216392, 52.942671904463815, 270.4303011830782, 376.5047480666486, 386.4040900834523, 213.57927227156563, 1041.83477266785, 13.620431824682058, 116.15053871047292, 54.93790528598018, 334.2532614471853, 429.5559251100148, 14.167756858206353, 41.90325658244338, 167.8365310651554, 67.74628482591079, 23.790947131499657, 254.72079349894764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.818730944549969, "mean_inference_ms": 4.475950097169188, "mean_action_processing_ms": 1.486349628277781, "mean_env_wait_ms": 10.566179440552634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00738072395324707, "StateBufferConnector_ms": 0.006342649459838867, "ViewRequirementAgentConnector_ms": 0.2206047773361206}, "num_episodes": 5, "episode_return_max": 500.33302651356536, "episode_return_min": -121.90847536196947, "episode_return_mean": 143.8987850554357, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.86100012312416, "num_env_steps_trained_throughput_per_sec": 81.86100012312416, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 52785.978, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52785.866, "sample_time_ms": 3022.325, "learn_time_ms": 49737.818, "learn_throughput": 80.422, "synch_weights_time_ms": 19.401}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "35fb9_00000", "date": "2024-08-22_09-10-41", "timestamp": 1724298041, "time_this_iter_s": 48.92467713356018, "time_total_s": 4618.714734554291, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcda4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4618.714734554291, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 31.321428571428577, "ram_util_percent": 81.42285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.224826730054524, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.5767197201491663, "policy_loss": -0.017638996992846608, "vf_loss": 3.5924256722132366, "vf_explained_var": 0.5380142610539835, "kl": 0.009665239746214221, "entropy": 0.7802245923766383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.798081173530962, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.7310749292373657, "policy_loss": -0.024451890363476225, "vf_loss": 3.7527353569313333, "vf_explained_var": 0.43953951584599005, "kl": 0.01395730670164561, "entropy": 0.6757682100805656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 830.8996795706444, "episode_reward_min": -35.43363958116312, "episode_reward_mean": 156.81425350015468, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1316.0636910512164, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.21690450358426, "predator_policy": 1289.2059325011387}, "policy_reward_mean": {"prey_policy": -295.08317363476317, "predator_policy": 373.49030038484096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.08684927850737, 284.14037404572474, 35.02404481804818, 253.41193201983097, 73.62436674992966, 473.29655077707275, 361.11597928626736, 19.10147461371583, 155.4432201576657, 204.69872101529307, -18.40756858784433, 43.02563940232515, 124.55479284219462, 76.88621301765029, 386.8319692723352, 247.29999999999788, 87.48864655819915, 204.16625214516534, 232.24359288207503, 54.55622028826161, 13.725830214967651, 364.34405902069636, 84.25090012714571, 365.0691682089804, 294.30000000000604, 57.93684587964413, 67.00000000000047, 111.36180992510764, 70.50000000000018, 9.025103087664043, 444.4547781900025, 124.33656119625475, 177.05537892758537, -7.808445730422971, 249.73260356218665, 216.86464495645606, 412.7795097064589, 142.26561438557135, 191.69153496987542, -35.43363958116312, 38.16822013958303, 66.2000000000005, 87.98958473543472, 64.95224314538166, 111.70071140378577, 63.74684062937235, 73.49683974713618, 35.85661747703209, 369.6605120994634, 59.80000000000057, 75.7723282572432, 109.40266627697126, 106.91761683224883, 234.485313011826, 500.03746705219237, 500.33302651356536, 118.51620499634667, 250.68887656032888, 316.091428996378, 106.8373249382522, 438.41246498877916, 61.90000000000061, 131.45958248068035, 63.02209258649139, 184.31370344275373, 119.27404357867398, 160.83292239484652, 108.871943035849, 52.069171197434805, 149.93872739675277, 48.400000000000425, 111.33289031567783, 131.57899744882738, 114.6819965281934, 61.312106740927035, 69.42673469954602, 137.90841780116997, 64.01302849688028, 69.44561034197876, 286.00146386939684, 53.68606797750017, 52.074102353045205, 70.93041885596368, 34.88424215965815, 76.49999999999993, 115.00503441820858, 65.50000000000055, 130.77892213987656, 78.29678158579691, 483.85641934667444, 122.37257025560491, 226.5578698693928, 81.79999999999954, 830.8996795706444, 52.193259317277935, 62.94561976304472, 70.40000000000026, 63.03278219070302, 251.49254255590134, 63.32778986933799], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-37.086788053447094, -322.37538185680654, -153.98854255348468, -622.3434610313144, -196.69858277824744, -686.9793200172637, -48.748739859434416, -574.5101903898071, 25.592667879579352, -69.50600824640702, -757.1308353177515, 383.21690450358426, 268.23075752069843, -572.1371232701156, -203.6321288637337, -362.546029073424, -232.8010918559712, -109.87698074691019, -276.6448461423045, -529.6245278287456, -676.8916594824578, -33.49214102154252, -339.2978769878869, -238.82651017558925, -417.59727661823104, -123.46811565818916, -238.80480631196292, -53.352254168870665, 35.324156926946344, -728.663080180929, -110.96910756469353, 167.79585220374878, -651.0182891129087, -661.0515811670176, -1002.3339569628894, -24.98794890229798, -580.9602165570298, -601.300004170106, -1005.2324648096343, -438.6346484564281, -426.21792555122414, -354.3553086594439, 65.61173018342578, -442.7677235039272, -1139.4533757373717, -165.6778756944886, -261.3379887317922, -107.15056127555374, 265.0000000000017, -121.3980787490602, -136.29142580096504, -932.8033136847426, -59.14920034782863, -195.8940988260051, 33.949797926410284, -50.596962995655126, -118.74605220725687, -140.50500724142543, -738.593712785601, -651.8090676369465, -75.48120900571854, -644.3325737115834, -886.6436436391327, -222.50397239651204, -143.6070584323904, -871.4170250612524, -251.61319538086582, -297.6219064723521, -724.0892563711659, -460.93642822224655, -543.0710630399401, -542.7186271969075, -456.9258222418897, 380.84347102509196, -698.4903558568285, -125.26042402329676, -369.0357445706438, -107.25443710915576, -872.3031973705337, -230.70597299628034, -239.2054095140743, -402.4287484612415, -89.14134808505827, -186.22012069018916, 35.270123075147126, -136.14516967347427, -682.8285663113206, -28.883804782408177, -316.23692993747886, -91.70810986535896, -184.24804680644738, -316.2749717051111, -253.0295978848285, -624.3022550715601, -684.3277535498518, -220.36373389841006, 232.05029037171266, -162.6427387224675, -167.13984938453476, -167.96770713135493, -213.87852338714083, 14.563825351069527, -375.5755844645924, -961.9146546948149, -218.20713452750374, -18.007281142331443, -242.11748851822966, -509.7348473427553, 154.2883684438157, -252.38342817547718, 69.63205508322665, -195.15048227685838, -408.5092109116641, -553.2765777164008, -10.138295337093211, -350.80606769376595, -247.7999200824008, -157.69912072216653, -335.5943024290453, -60.18583263575257, -707.3949592406872, 253.2702121438129, 23.54813008904228, -690.9390827434307, -688.3723274065155, -304.13975173421403, -106.75075354133682, -76.64440599131008, -750.6144464396547, -137.00587882462477, -833.7444518424979, -278.84673129462084, -130.03548016644854, 75.99999999999964, -290.72375250392014, -729.0320128119065, -126.27328781922674, -158.32216156860827, -667.6099998068263, -6.185501097066558, -101.17478237501561, -1084.8192918899, -3.5549201243625457, -983.2770419589846, -525.8331365589269, -310.2172105649164, -501.1102391892948, 66.07170070710677, -37.14362055186532, -291.72554195536065, -348.3600052564796, -149.87670879318927, -65.4491614872403, -163.6598375841644, -158.87574182350218, -1289.5239590894296, -74.40601593516803, -14.00107619948259, -468.9697098479102, 108.03612446758399, -375.20063537417656, -171.09665900334014, -1041.43477266785, 38.053670528363, -80.45053871047463, -19.70748643001624, -327.04897660294483, -401.8759677945909, 24.432243141793695, -4.003256582443058, -147.03835928513686, 26.460577812280643, 14.509052868500378, -227.5207934989492, -335.6790720976474, -120.42951047768281, -43.774129024283916, -27.224902052802584, 307.4633167542156, -710.746555412369, -146.78738474998872, -1316.0636910512164, -391.83247461670305, -11.53716883301548, -681.0007747886524, 24.175453330227135, -174.04276080195135, -993.8009727715413, 13.570703969395522, -35.9018233792496, -25.195072852495024, -617.0264328705083, -22.67597503643264, -84.10039907549054, -884.5950861356904, -325.34621304716626, -105.82694329749563, -284.5118308834212, -201.19260167207722, -219.96798410853089], "policy_predator_policy_reward": [227.94184280518377, 319.60717638358625, 598.6197559944682, 461.85262163605375, 86.2485517755329, 832.4533958380299, 428.7860945775972, 447.88476769147945, 14.931698870350283, 102.60600824640525, 264.8946331701034, 582.3158484211342, 264.82483839688194, 400.19750663880257, 207.98425011773094, 377.29538243314465, 248.682758688271, 249.43853407227567, 402.2158706391004, 608.7522243472462, 493.7705542767878, 198.20567763936717, 383.4836829630921, 237.66634360271186, 412.53329914413, 253.08688597449097, 206.08084983520703, 162.96242366327633, 466.1720592602472, 613.9988332660687, 144.16910756469164, 46.30414779625062, 389.28524527766905, 1010.2732715604642, 938.9274398859739, 292.5607181243813, 603.745148716609, 810.7586648926051, 969.7712584909445, 528.6520750633819, 6.80769499336664, 787.4913694322735, 269.4149618541754, 472.0850904870247, 1138.4856803200253, 250.89647123897973, 596.142238754558, 137.41547946176942, 0.0, 150.69807874905865, 223.35896202004815, 903.6726233453018, 92.54920034782715, 229.4940988260034, 42.1120119986999, 85.89696299565408, 159.34605220725538, 170.4050072414241, 722.4677342128939, 676.9601492973184, 567.5792665942099, 596.6892943130924, 439.2333851036899, 794.2507921282097, 961.8045083516677, 230.27495406956075, 532.7855654656275, 8.641090657173569, 586.8732267502501, 847.8850614053557, 557.2227661376722, 745.4315690556332, 467.72582224189006, 21.13603868136662, 629.0995192574842, 336.91687500821297, 525.635744570644, 142.34597207902996, 204.5419228762638, 863.0336079093865, 389.1808236915413, 290.6215544233606, 124.14134808505628, 217.4201206901874, 162.33949844469183, 26.525132889069233, 676.4609469000237, 100.20366733908772, 304.6268964629782, 215.0188547436499, 215.06650134535428, 349.20335779557894, 385.8593256534287, 564.9693670500974, 692.4277535498535, 248.1203513754404, 206.1148491436508, 94.13811130656441, 196.73984938453358, 198.1677071313532, 229.99544885547428, 45.09157743783933, 1220.763193039062, 226.1297123973214, 53.727197046368005, 289.40483545571817, 386.3452564841956, 599.9923923886213, 360.78236786500094, 237.35015891885178, 351.9286268024513, 273.9228269047427, 514.6750792255311, 565.626914398885, 238.72717189742286, 372.906067693771, 272.7277841274048, 448.86268567354387, 313.329920286966, 189.28753971608495, 230.82572646182982, 661.7114856238255, 15.451869910957754, 713.8390827434357, 714.1885695592954, 409.78309206212145, 136.27784361697638, 110.13940850215792, 644.4867027084877, 427.4473259985441, 824.7485214680132, 407.1167052477792, 159.20657723107615, 55.661825330220815, 232.20967996629008, 896.4180283853876, 235.82286067914046, 100.84175990612542, 622.8683435941912, 200.8658847064552, 132.37478237501466, 1102.0192918898845, 111.45192262531194, 986.712929773719, 402.3613065126999, 565.2680380599758, 459.18424576625137, 90.536289244136, 84.97490252273174, 305.2063667254253, 155.406024094477, 412.257424654741, 238.79597453320366, 128.22144233937064, 223.20679690867289, 1289.2059325011387, 104.91003057216392, 52.942671904463815, 270.4303011830782, 376.5047480666486, 386.4040900834523, 213.57927227156563, 1041.83477266785, 13.620431824682058, 116.15053871047292, 54.93790528598018, 334.2532614471853, 429.5559251100148, 14.167756858206353, 41.90325658244338, 167.8365310651554, 67.74628482591079, 23.790947131499657, 254.72079349894764, 359.0703063082394, 227.8171984069736, 78.8596345943387, 70.43617806854476, 228.50583450082203, 658.633823504006, 329.57057116940706, 1255.6530748874009, 397.8342462462863, 232.0932670728322, 704.2007747886577, 34.42454666977293, 1026.3595791401428, 972.383834003987, 74.52437872713155, 0.0, 71.24620554740059, 633.9209199386507, 156.61470411592626, 20.561669995997157, 882.0223990380606, 390.9516823355055, 444.325686757532, 197.5056299792921, 348.75230659893487, 135.73606905100735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.840313802686703, "mean_inference_ms": 4.4786213800414, "mean_action_processing_ms": 1.4897712483760128, "mean_env_wait_ms": 10.558547468310815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007308244705200195, "StateBufferConnector_ms": 0.006300687789916992, "ViewRequirementAgentConnector_ms": 0.237388014793396}, "num_episodes": 13, "episode_return_max": 830.8996795706444, "episode_return_min": -35.43363958116312, "episode_return_mean": 156.81425350015468, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 24.070445564050324, "num_env_steps_trained_throughput_per_sec": 24.070445564050324, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 64380.587, "restore_workers_time_ms": 0.014, "training_step_time_ms": 64380.471, "sample_time_ms": 3013.476, "learn_time_ms": 61337.826, "learn_throughput": 65.213, "synch_weights_time_ms": 22.547}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "35fb9_00000", "date": "2024-08-22_09-13-27", "timestamp": 1724298207, "time_this_iter_s": 166.2489960193634, "time_total_s": 4784.963730573654, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0f73e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4784.963730573654, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 69.83456221198156, "ram_util_percent": 89.98341013824886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.694409196843544, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.998341407346978, "policy_loss": -0.020960388143877032, "vf_loss": 4.016547674855227, "vf_explained_var": 0.4779360358361845, "kl": 0.013770628359203261, "entropy": 0.7899868492726927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.218096688437084, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.7801043002063004, "policy_loss": -0.02181464908644557, "vf_loss": 3.799524823319975, "vf_explained_var": 0.34173638647195526, "kl": 0.011970611111995167, "entropy": 0.655284080366609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 830.8996795706444, "episode_reward_min": -35.43363958116312, "episode_reward_mean": 147.98803533392217, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1547.726097544591, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 380.84347102509196, "predator_policy": 1546.6258354389745}, "policy_reward_mean": {"prey_policy": -307.44518584054686, "predator_policy": 381.4392035075085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [204.69872101529307, -18.40756858784433, 43.02563940232515, 124.55479284219462, 76.88621301765029, 386.8319692723352, 247.29999999999788, 87.48864655819915, 204.16625214516534, 232.24359288207503, 54.55622028826161, 13.725830214967651, 364.34405902069636, 84.25090012714571, 365.0691682089804, 294.30000000000604, 57.93684587964413, 67.00000000000047, 111.36180992510764, 70.50000000000018, 9.025103087664043, 444.4547781900025, 124.33656119625475, 177.05537892758537, -7.808445730422971, 249.73260356218665, 216.86464495645606, 412.7795097064589, 142.26561438557135, 191.69153496987542, -35.43363958116312, 38.16822013958303, 66.2000000000005, 87.98958473543472, 64.95224314538166, 111.70071140378577, 63.74684062937235, 73.49683974713618, 35.85661747703209, 369.6605120994634, 59.80000000000057, 75.7723282572432, 109.40266627697126, 106.91761683224883, 234.485313011826, 500.03746705219237, 500.33302651356536, 118.51620499634667, 250.68887656032888, 316.091428996378, 106.8373249382522, 438.41246498877916, 61.90000000000061, 131.45958248068035, 63.02209258649139, 184.31370344275373, 119.27404357867398, 160.83292239484652, 108.871943035849, 52.069171197434805, 149.93872739675277, 48.400000000000425, 111.33289031567783, 131.57899744882738, 114.6819965281934, 61.312106740927035, 69.42673469954602, 137.90841780116997, 64.01302849688028, 69.44561034197876, 286.00146386939684, 53.68606797750017, 52.074102353045205, 70.93041885596368, 34.88424215965815, 76.49999999999993, 115.00503441820858, 65.50000000000055, 130.77892213987656, 78.29678158579691, 483.85641934667444, 122.37257025560491, 226.5578698693928, 81.79999999999954, 830.8996795706444, 52.193259317277935, 62.94561976304472, 70.40000000000026, 63.03278219070302, 251.49254255590134, 63.32778986933799, 49.47793991772259, 73.77371535811189, 55.00000000000054, 54.27490949891673, 98.84075784617615, 327.7905202186138, 161.05661845332978, 95.60851383064144, 44.80000000000037], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-276.6448461423045, -529.6245278287456, -676.8916594824578, -33.49214102154252, -339.2978769878869, -238.82651017558925, -417.59727661823104, -123.46811565818916, -238.80480631196292, -53.352254168870665, 35.324156926946344, -728.663080180929, -110.96910756469353, 167.79585220374878, -651.0182891129087, -661.0515811670176, -1002.3339569628894, -24.98794890229798, -580.9602165570298, -601.300004170106, -1005.2324648096343, -438.6346484564281, -426.21792555122414, -354.3553086594439, 65.61173018342578, -442.7677235039272, -1139.4533757373717, -165.6778756944886, -261.3379887317922, -107.15056127555374, 265.0000000000017, -121.3980787490602, -136.29142580096504, -932.8033136847426, -59.14920034782863, -195.8940988260051, 33.949797926410284, -50.596962995655126, -118.74605220725687, -140.50500724142543, -738.593712785601, -651.8090676369465, -75.48120900571854, -644.3325737115834, -886.6436436391327, -222.50397239651204, -143.6070584323904, -871.4170250612524, -251.61319538086582, -297.6219064723521, -724.0892563711659, -460.93642822224655, -543.0710630399401, -542.7186271969075, -456.9258222418897, 380.84347102509196, -698.4903558568285, -125.26042402329676, -369.0357445706438, -107.25443710915576, -872.3031973705337, -230.70597299628034, -239.2054095140743, -402.4287484612415, -89.14134808505827, -186.22012069018916, 35.270123075147126, -136.14516967347427, -682.8285663113206, -28.883804782408177, -316.23692993747886, -91.70810986535896, -184.24804680644738, -316.2749717051111, -253.0295978848285, -624.3022550715601, -684.3277535498518, -220.36373389841006, 232.05029037171266, -162.6427387224675, -167.13984938453476, -167.96770713135493, -213.87852338714083, 14.563825351069527, -375.5755844645924, -961.9146546948149, -218.20713452750374, -18.007281142331443, -242.11748851822966, -509.7348473427553, 154.2883684438157, -252.38342817547718, 69.63205508322665, -195.15048227685838, -408.5092109116641, -553.2765777164008, -10.138295337093211, -350.80606769376595, -247.7999200824008, -157.69912072216653, -335.5943024290453, -60.18583263575257, -707.3949592406872, 253.2702121438129, 23.54813008904228, -690.9390827434307, -688.3723274065155, -304.13975173421403, -106.75075354133682, -76.64440599131008, -750.6144464396547, -137.00587882462477, -833.7444518424979, -278.84673129462084, -130.03548016644854, 75.99999999999964, -290.72375250392014, -729.0320128119065, -126.27328781922674, -158.32216156860827, -667.6099998068263, -6.185501097066558, -101.17478237501561, -1084.8192918899, -3.5549201243625457, -983.2770419589846, -525.8331365589269, -310.2172105649164, -501.1102391892948, 66.07170070710677, -37.14362055186532, -291.72554195536065, -348.3600052564796, -149.87670879318927, -65.4491614872403, -163.6598375841644, -158.87574182350218, -1289.5239590894296, -74.40601593516803, -14.00107619948259, -468.9697098479102, 108.03612446758399, -375.20063537417656, -171.09665900334014, -1041.43477266785, 38.053670528363, -80.45053871047463, -19.70748643001624, -327.04897660294483, -401.8759677945909, 24.432243141793695, -4.003256582443058, -147.03835928513686, 26.460577812280643, 14.509052868500378, -227.5207934989492, -335.6790720976474, -120.42951047768281, -43.774129024283916, -27.224902052802584, 307.4633167542156, -710.746555412369, -146.78738474998872, -1316.0636910512164, -391.83247461670305, -11.53716883301548, -681.0007747886524, 24.175453330227135, -174.04276080195135, -993.8009727715413, 13.570703969395522, -35.9018233792496, -25.195072852495024, -617.0264328705083, -22.67597503643264, -84.10039907549054, -884.5950861356904, -325.34621304716626, -105.82694329749563, -284.5118308834212, -201.19260167207722, -219.96798410853089, -25.56110033200666, -1547.726097544591, -64.50857398041228, -91.94347094703858, -98.5779916690843, -417.5206392431006, 25.284847837342614, -502.8857426292492, -361.29444614092125, -196.9820874615567, 244.62264063390705, -537.1010612177689, -929.8232581331245, -50.11803927013437, -192.84176243735567, -498.3733714512965, -52.16274947106832, -1448.2104117095498], "policy_predator_policy_reward": [402.2158706391004, 608.7522243472462, 493.7705542767878, 198.20567763936717, 383.4836829630921, 237.66634360271186, 412.53329914413, 253.08688597449097, 206.08084983520703, 162.96242366327633, 466.1720592602472, 613.9988332660687, 144.16910756469164, 46.30414779625062, 389.28524527766905, 1010.2732715604642, 938.9274398859739, 292.5607181243813, 603.745148716609, 810.7586648926051, 969.7712584909445, 528.6520750633819, 6.80769499336664, 787.4913694322735, 269.4149618541754, 472.0850904870247, 1138.4856803200253, 250.89647123897973, 596.142238754558, 137.41547946176942, 0.0, 150.69807874905865, 223.35896202004815, 903.6726233453018, 92.54920034782715, 229.4940988260034, 42.1120119986999, 85.89696299565408, 159.34605220725538, 170.4050072414241, 722.4677342128939, 676.9601492973184, 567.5792665942099, 596.6892943130924, 439.2333851036899, 794.2507921282097, 961.8045083516677, 230.27495406956075, 532.7855654656275, 8.641090657173569, 586.8732267502501, 847.8850614053557, 557.2227661376722, 745.4315690556332, 467.72582224189006, 21.13603868136662, 629.0995192574842, 336.91687500821297, 525.635744570644, 142.34597207902996, 204.5419228762638, 863.0336079093865, 389.1808236915413, 290.6215544233606, 124.14134808505628, 217.4201206901874, 162.33949844469183, 26.525132889069233, 676.4609469000237, 100.20366733908772, 304.6268964629782, 215.0188547436499, 215.06650134535428, 349.20335779557894, 385.8593256534287, 564.9693670500974, 692.4277535498535, 248.1203513754404, 206.1148491436508, 94.13811130656441, 196.73984938453358, 198.1677071313532, 229.99544885547428, 45.09157743783933, 1220.763193039062, 226.1297123973214, 53.727197046368005, 289.40483545571817, 386.3452564841956, 599.9923923886213, 360.78236786500094, 237.35015891885178, 351.9286268024513, 273.9228269047427, 514.6750792255311, 565.626914398885, 238.72717189742286, 372.906067693771, 272.7277841274048, 448.86268567354387, 313.329920286966, 189.28753971608495, 230.82572646182982, 661.7114856238255, 15.451869910957754, 713.8390827434357, 714.1885695592954, 409.78309206212145, 136.27784361697638, 110.13940850215792, 644.4867027084877, 427.4473259985441, 824.7485214680132, 407.1167052477792, 159.20657723107615, 55.661825330220815, 232.20967996629008, 896.4180283853876, 235.82286067914046, 100.84175990612542, 622.8683435941912, 200.8658847064552, 132.37478237501466, 1102.0192918898845, 111.45192262531194, 986.712929773719, 402.3613065126999, 565.2680380599758, 459.18424576625137, 90.536289244136, 84.97490252273174, 305.2063667254253, 155.406024094477, 412.257424654741, 238.79597453320366, 128.22144233937064, 223.20679690867289, 1289.2059325011387, 104.91003057216392, 52.942671904463815, 270.4303011830782, 376.5047480666486, 386.4040900834523, 213.57927227156563, 1041.83477266785, 13.620431824682058, 116.15053871047292, 54.93790528598018, 334.2532614471853, 429.5559251100148, 14.167756858206353, 41.90325658244338, 167.8365310651554, 67.74628482591079, 23.790947131499657, 254.72079349894764, 359.0703063082394, 227.8171984069736, 78.8596345943387, 70.43617806854476, 228.50583450082203, 658.633823504006, 329.57057116940706, 1255.6530748874009, 397.8342462462863, 232.0932670728322, 704.2007747886577, 34.42454666977293, 1026.3595791401428, 972.383834003987, 74.52437872713155, 0.0, 71.24620554740059, 633.9209199386507, 156.61470411592626, 20.561669995997157, 882.0223990380606, 390.9516823355055, 444.325686757532, 197.5056299792921, 348.75230659893487, 135.73606905100735, 76.139302355345, 1546.6258354389745, 115.11345614184394, 115.11230414371532, 132.07799166908273, 439.0206392431055, 356.4584312626824, 175.4173730281425, 273.32524179894136, 383.79204964971404, 58.267879584706236, 562.0010612177741, 906.3737579758142, 234.62415788077547, 507.46732018732916, 279.3563275319659, 85.36274947106727, 1459.8104117095395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.8446615423152775, "mean_inference_ms": 4.491632785540761, "mean_action_processing_ms": 1.4866223205046445, "mean_env_wait_ms": 10.571471252586823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008208036422729492, "StateBufferConnector_ms": 0.006736159324645996, "ViewRequirementAgentConnector_ms": 0.23553907871246338}, "num_episodes": 9, "episode_return_max": 830.8996795706444, "episode_return_min": -35.43363958116312, "episode_return_mean": 147.98803533392217, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.17086889299249, "num_env_steps_trained_throughput_per_sec": 79.17086889299249, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 64323.769, "restore_workers_time_ms": 0.015, "training_step_time_ms": 64323.669, "sample_time_ms": 2976.944, "learn_time_ms": 61317.76, "learn_throughput": 65.234, "synch_weights_time_ms": 23.12}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "35fb9_00000", "date": "2024-08-22_09-14-18", "timestamp": 1724298258, "time_this_iter_s": 50.59548306465149, "time_total_s": 4835.559213638306, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc83af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4835.559213638306, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 35.99027777777778, "ram_util_percent": 83.49305555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.073417706464333, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.0357087907337, "policy_loss": -0.020629728387883572, "vf_loss": 4.053935281940238, "vf_explained_var": 0.5325875786561814, "kl": 0.012016200029572087, "entropy": 0.798430723361868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.040594159421467, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.664703461354372, "policy_loss": -0.023518520907779773, "vf_loss": 3.685490772459242, "vf_explained_var": 0.4256209851572753, "kl": 0.013656065317742999, "entropy": 0.6708573504730507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 830.8996795706444, "episode_reward_min": -35.43363958116312, "episode_reward_mean": 152.1169491912057, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1547.726097544591, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9, "predator_policy": 1546.6258354389745}, "policy_reward_mean": {"prey_policy": -284.4639028510467, "predator_policy": 360.5223774466499}, "custom_metrics": {}, "hist_stats": {"episode_reward": [365.0691682089804, 294.30000000000604, 57.93684587964413, 67.00000000000047, 111.36180992510764, 70.50000000000018, 9.025103087664043, 444.4547781900025, 124.33656119625475, 177.05537892758537, -7.808445730422971, 249.73260356218665, 216.86464495645606, 412.7795097064589, 142.26561438557135, 191.69153496987542, -35.43363958116312, 38.16822013958303, 66.2000000000005, 87.98958473543472, 64.95224314538166, 111.70071140378577, 63.74684062937235, 73.49683974713618, 35.85661747703209, 369.6605120994634, 59.80000000000057, 75.7723282572432, 109.40266627697126, 106.91761683224883, 234.485313011826, 500.03746705219237, 500.33302651356536, 118.51620499634667, 250.68887656032888, 316.091428996378, 106.8373249382522, 438.41246498877916, 61.90000000000061, 131.45958248068035, 63.02209258649139, 184.31370344275373, 119.27404357867398, 160.83292239484652, 108.871943035849, 52.069171197434805, 149.93872739675277, 48.400000000000425, 111.33289031567783, 131.57899744882738, 114.6819965281934, 61.312106740927035, 69.42673469954602, 137.90841780116997, 64.01302849688028, 69.44561034197876, 286.00146386939684, 53.68606797750017, 52.074102353045205, 70.93041885596368, 34.88424215965815, 76.49999999999993, 115.00503441820858, 65.50000000000055, 130.77892213987656, 78.29678158579691, 483.85641934667444, 122.37257025560491, 226.5578698693928, 81.79999999999954, 830.8996795706444, 52.193259317277935, 62.94561976304472, 70.40000000000026, 63.03278219070302, 251.49254255590134, 63.32778986933799, 49.47793991772259, 73.77371535811189, 55.00000000000054, 54.27490949891673, 98.84075784617615, 327.7905202186138, 161.05661845332978, 95.60851383064144, 44.80000000000037, 193.98670780450567, 114.4646090214728, 73.27234662255026, 228.75058277576963, 45.568598355500185, 47.24792001887298, 425.90000000000254, 73.70149167074884, 56.242532133097264, 440.61372902990956, 134.8158773514298, 51.99777445752859, 146.39089686489342, 485.60358782053345], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-261.3379887317922, -107.15056127555374, 265.0000000000017, -121.3980787490602, -136.29142580096504, -932.8033136847426, -59.14920034782863, -195.8940988260051, 33.949797926410284, -50.596962995655126, -118.74605220725687, -140.50500724142543, -738.593712785601, -651.8090676369465, -75.48120900571854, -644.3325737115834, -886.6436436391327, -222.50397239651204, -143.6070584323904, -871.4170250612524, -251.61319538086582, -297.6219064723521, -724.0892563711659, -460.93642822224655, -543.0710630399401, -542.7186271969075, -456.9258222418897, 380.84347102509196, -698.4903558568285, -125.26042402329676, -369.0357445706438, -107.25443710915576, -872.3031973705337, -230.70597299628034, -239.2054095140743, -402.4287484612415, -89.14134808505827, -186.22012069018916, 35.270123075147126, -136.14516967347427, -682.8285663113206, -28.883804782408177, -316.23692993747886, -91.70810986535896, -184.24804680644738, -316.2749717051111, -253.0295978848285, -624.3022550715601, -684.3277535498518, -220.36373389841006, 232.05029037171266, -162.6427387224675, -167.13984938453476, -167.96770713135493, -213.87852338714083, 14.563825351069527, -375.5755844645924, -961.9146546948149, -218.20713452750374, -18.007281142331443, -242.11748851822966, -509.7348473427553, 154.2883684438157, -252.38342817547718, 69.63205508322665, -195.15048227685838, -408.5092109116641, -553.2765777164008, -10.138295337093211, -350.80606769376595, -247.7999200824008, -157.69912072216653, -335.5943024290453, -60.18583263575257, -707.3949592406872, 253.2702121438129, 23.54813008904228, -690.9390827434307, -688.3723274065155, -304.13975173421403, -106.75075354133682, -76.64440599131008, -750.6144464396547, -137.00587882462477, -833.7444518424979, -278.84673129462084, -130.03548016644854, 75.99999999999964, -290.72375250392014, -729.0320128119065, -126.27328781922674, -158.32216156860827, -667.6099998068263, -6.185501097066558, -101.17478237501561, -1084.8192918899, -3.5549201243625457, -983.2770419589846, -525.8331365589269, -310.2172105649164, -501.1102391892948, 66.07170070710677, -37.14362055186532, -291.72554195536065, -348.3600052564796, -149.87670879318927, -65.4491614872403, -163.6598375841644, -158.87574182350218, -1289.5239590894296, -74.40601593516803, -14.00107619948259, -468.9697098479102, 108.03612446758399, -375.20063537417656, -171.09665900334014, -1041.43477266785, 38.053670528363, -80.45053871047463, -19.70748643001624, -327.04897660294483, -401.8759677945909, 24.432243141793695, -4.003256582443058, -147.03835928513686, 26.460577812280643, 14.509052868500378, -227.5207934989492, -335.6790720976474, -120.42951047768281, -43.774129024283916, -27.224902052802584, 307.4633167542156, -710.746555412369, -146.78738474998872, -1316.0636910512164, -391.83247461670305, -11.53716883301548, -681.0007747886524, 24.175453330227135, -174.04276080195135, -993.8009727715413, 13.570703969395522, -35.9018233792496, -25.195072852495024, -617.0264328705083, -22.67597503643264, -84.10039907549054, -884.5950861356904, -325.34621304716626, -105.82694329749563, -284.5118308834212, -201.19260167207722, -219.96798410853089, -25.56110033200666, -1547.726097544591, -64.50857398041228, -91.94347094703858, -98.5779916690843, -417.5206392431006, 25.284847837342614, -502.8857426292492, -361.29444614092125, -196.9820874615567, 244.62264063390705, -537.1010612177689, -929.8232581331245, -50.11803927013437, -192.84176243735567, -498.3733714512965, -52.16274947106832, -1448.2104117095498, -20.838243600446276, -421.68831201120724, -396.0895769042891, -715.9936719714716, -52.00087012932978, -414.01640823298766, -351.19809475097327, -397.04020860924516, -182.25396970480074, -497.6527917572471, -214.6826889515058, -1173.870119119693, 391.9, -54.71988488174372, -113.89966108506968, -31.005900235042027, -1211.1910073504498, -112.63745011852444, -100.88988762519985, 206.83274397184388, -156.18812702447852, -151.24254614662485, -28.620166161254744, -39.13638237759232, -424.0269790733642, -54.95489294135951, 388.2517354034877, -67.78182282344684], "policy_predator_policy_reward": [596.142238754558, 137.41547946176942, 0.0, 150.69807874905865, 223.35896202004815, 903.6726233453018, 92.54920034782715, 229.4940988260034, 42.1120119986999, 85.89696299565408, 159.34605220725538, 170.4050072414241, 722.4677342128939, 676.9601492973184, 567.5792665942099, 596.6892943130924, 439.2333851036899, 794.2507921282097, 961.8045083516677, 230.27495406956075, 532.7855654656275, 8.641090657173569, 586.8732267502501, 847.8850614053557, 557.2227661376722, 745.4315690556332, 467.72582224189006, 21.13603868136662, 629.0995192574842, 336.91687500821297, 525.635744570644, 142.34597207902996, 204.5419228762638, 863.0336079093865, 389.1808236915413, 290.6215544233606, 124.14134808505628, 217.4201206901874, 162.33949844469183, 26.525132889069233, 676.4609469000237, 100.20366733908772, 304.6268964629782, 215.0188547436499, 215.06650134535428, 349.20335779557894, 385.8593256534287, 564.9693670500974, 692.4277535498535, 248.1203513754404, 206.1148491436508, 94.13811130656441, 196.73984938453358, 198.1677071313532, 229.99544885547428, 45.09157743783933, 1220.763193039062, 226.1297123973214, 53.727197046368005, 289.40483545571817, 386.3452564841956, 599.9923923886213, 360.78236786500094, 237.35015891885178, 351.9286268024513, 273.9228269047427, 514.6750792255311, 565.626914398885, 238.72717189742286, 372.906067693771, 272.7277841274048, 448.86268567354387, 313.329920286966, 189.28753971608495, 230.82572646182982, 661.7114856238255, 15.451869910957754, 713.8390827434357, 714.1885695592954, 409.78309206212145, 136.27784361697638, 110.13940850215792, 644.4867027084877, 427.4473259985441, 824.7485214680132, 407.1167052477792, 159.20657723107615, 55.661825330220815, 232.20967996629008, 896.4180283853876, 235.82286067914046, 100.84175990612542, 622.8683435941912, 200.8658847064552, 132.37478237501466, 1102.0192918898845, 111.45192262531194, 986.712929773719, 402.3613065126999, 565.2680380599758, 459.18424576625137, 90.536289244136, 84.97490252273174, 305.2063667254253, 155.406024094477, 412.257424654741, 238.79597453320366, 128.22144233937064, 223.20679690867289, 1289.2059325011387, 104.91003057216392, 52.942671904463815, 270.4303011830782, 376.5047480666486, 386.4040900834523, 213.57927227156563, 1041.83477266785, 13.620431824682058, 116.15053871047292, 54.93790528598018, 334.2532614471853, 429.5559251100148, 14.167756858206353, 41.90325658244338, 167.8365310651554, 67.74628482591079, 23.790947131499657, 254.72079349894764, 359.0703063082394, 227.8171984069736, 78.8596345943387, 70.43617806854476, 228.50583450082203, 658.633823504006, 329.57057116940706, 1255.6530748874009, 397.8342462462863, 232.0932670728322, 704.2007747886577, 34.42454666977293, 1026.3595791401428, 972.383834003987, 74.52437872713155, 0.0, 71.24620554740059, 633.9209199386507, 156.61470411592626, 20.561669995997157, 882.0223990380606, 390.9516823355055, 444.325686757532, 197.5056299792921, 348.75230659893487, 135.73606905100735, 76.139302355345, 1546.6258354389745, 115.11345614184394, 115.11230414371532, 132.07799166908273, 439.0206392431055, 356.4584312626824, 175.4173730281425, 273.32524179894136, 383.79204964971404, 58.267879584706236, 562.0010612177741, 906.3737579758142, 234.62415788077547, 507.46732018732916, 279.3563275319659, 85.36274947106727, 1459.8104117095395, 229.7471840842181, 406.7660793319471, 450.6753522960616, 775.8725056011783, 117.99978885654286, 421.2898361283295, 675.6918531840655, 301.29703295192945, 246.06669959516165, 479.4086602223863, 255.7020197775167, 1180.0987083125538, 0.0, 88.71988488174252, 154.7127013619649, 63.894351628894626, 126.88825135217255, 1253.1827382498964, 151.62598183099644, 183.04489085226402, 166.16793814112287, 276.07861238141, 42.41374201794263, 77.34058097843281, 435.8078868655362, 189.56488201408627, 63.41028774682486, 101.72338749366196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.860554774421431, "mean_inference_ms": 4.489766071590514, "mean_action_processing_ms": 1.4929041646665229, "mean_env_wait_ms": 10.580638797425655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008185982704162598, "StateBufferConnector_ms": 0.0066558122634887695, "ViewRequirementAgentConnector_ms": 0.2582496404647827}, "num_episodes": 14, "episode_return_max": 830.8996795706444, "episode_return_min": -35.43363958116312, "episode_return_mean": 152.1169491912057, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.12405950300828, "num_env_steps_trained_throughput_per_sec": 80.12405950300828, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 64221.661, "restore_workers_time_ms": 0.015, "training_step_time_ms": 64221.559, "sample_time_ms": 3057.298, "learn_time_ms": 61135.807, "learn_throughput": 65.428, "synch_weights_time_ms": 22.684}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "35fb9_00000", "date": "2024-08-22_09-15-08", "timestamp": 1724298308, "time_this_iter_s": 49.98077416419983, "time_total_s": 4885.5399878025055, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc8bc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4885.5399878025055, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 33.19577464788732, "ram_util_percent": 83.39436619718307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.245415127403522, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.321576471177359, "policy_loss": -0.01901366193292209, "vf_loss": 4.3382674628464635, "vf_explained_var": 0.5997114627764969, "kl": 0.011613327537407044, "entropy": 0.7688370528675261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.274247910610583, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.126812420446406, "policy_loss": -0.02591760165117208, "vf_loss": 4.150038059047921, "vf_explained_var": 0.4036218701847016, "kl": 0.013459813365683197, "entropy": 0.6131070150742455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 830.8996795706444, "episode_reward_min": -35.43363958116312, "episode_reward_mean": 146.78553091922137, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1547.726097544591, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9, "predator_policy": 1546.6258354389745}, "policy_reward_mean": {"prey_policy": -274.54456262621903, "predator_policy": 347.93732808583013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.73260356218665, 216.86464495645606, 412.7795097064589, 142.26561438557135, 191.69153496987542, -35.43363958116312, 38.16822013958303, 66.2000000000005, 87.98958473543472, 64.95224314538166, 111.70071140378577, 63.74684062937235, 73.49683974713618, 35.85661747703209, 369.6605120994634, 59.80000000000057, 75.7723282572432, 109.40266627697126, 106.91761683224883, 234.485313011826, 500.03746705219237, 500.33302651356536, 118.51620499634667, 250.68887656032888, 316.091428996378, 106.8373249382522, 438.41246498877916, 61.90000000000061, 131.45958248068035, 63.02209258649139, 184.31370344275373, 119.27404357867398, 160.83292239484652, 108.871943035849, 52.069171197434805, 149.93872739675277, 48.400000000000425, 111.33289031567783, 131.57899744882738, 114.6819965281934, 61.312106740927035, 69.42673469954602, 137.90841780116997, 64.01302849688028, 69.44561034197876, 286.00146386939684, 53.68606797750017, 52.074102353045205, 70.93041885596368, 34.88424215965815, 76.49999999999993, 115.00503441820858, 65.50000000000055, 130.77892213987656, 78.29678158579691, 483.85641934667444, 122.37257025560491, 226.5578698693928, 81.79999999999954, 830.8996795706444, 52.193259317277935, 62.94561976304472, 70.40000000000026, 63.03278219070302, 251.49254255590134, 63.32778986933799, 49.47793991772259, 73.77371535811189, 55.00000000000054, 54.27490949891673, 98.84075784617615, 327.7905202186138, 161.05661845332978, 95.60851383064144, 44.80000000000037, 193.98670780450567, 114.4646090214728, 73.27234662255026, 228.75058277576963, 45.568598355500185, 47.24792001887298, 425.90000000000254, 73.70149167074884, 56.242532133097264, 440.61372902990956, 134.8158773514298, 51.99777445752859, 146.39089686489342, 485.60358782053345, 87.87433386661934, 279.1630298949465, 36.603454709272825, 26.666632210479058, 107.24492855919759, 66.30000000000051, 201.05790791746543, 74.10000000000007, 122.94335475267879, 68.40000000000039, 109.73573057573265], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-724.0892563711659, -460.93642822224655, -543.0710630399401, -542.7186271969075, -456.9258222418897, 380.84347102509196, -698.4903558568285, -125.26042402329676, -369.0357445706438, -107.25443710915576, -872.3031973705337, -230.70597299628034, -239.2054095140743, -402.4287484612415, -89.14134808505827, -186.22012069018916, 35.270123075147126, -136.14516967347427, -682.8285663113206, -28.883804782408177, -316.23692993747886, -91.70810986535896, -184.24804680644738, -316.2749717051111, -253.0295978848285, -624.3022550715601, -684.3277535498518, -220.36373389841006, 232.05029037171266, -162.6427387224675, -167.13984938453476, -167.96770713135493, -213.87852338714083, 14.563825351069527, -375.5755844645924, -961.9146546948149, -218.20713452750374, -18.007281142331443, -242.11748851822966, -509.7348473427553, 154.2883684438157, -252.38342817547718, 69.63205508322665, -195.15048227685838, -408.5092109116641, -553.2765777164008, -10.138295337093211, -350.80606769376595, -247.7999200824008, -157.69912072216653, -335.5943024290453, -60.18583263575257, -707.3949592406872, 253.2702121438129, 23.54813008904228, -690.9390827434307, -688.3723274065155, -304.13975173421403, -106.75075354133682, -76.64440599131008, -750.6144464396547, -137.00587882462477, -833.7444518424979, -278.84673129462084, -130.03548016644854, 75.99999999999964, -290.72375250392014, -729.0320128119065, -126.27328781922674, -158.32216156860827, -667.6099998068263, -6.185501097066558, -101.17478237501561, -1084.8192918899, -3.5549201243625457, -983.2770419589846, -525.8331365589269, -310.2172105649164, -501.1102391892948, 66.07170070710677, -37.14362055186532, -291.72554195536065, -348.3600052564796, -149.87670879318927, -65.4491614872403, -163.6598375841644, -158.87574182350218, -1289.5239590894296, -74.40601593516803, -14.00107619948259, -468.9697098479102, 108.03612446758399, -375.20063537417656, -171.09665900334014, -1041.43477266785, 38.053670528363, -80.45053871047463, -19.70748643001624, -327.04897660294483, -401.8759677945909, 24.432243141793695, -4.003256582443058, -147.03835928513686, 26.460577812280643, 14.509052868500378, -227.5207934989492, -335.6790720976474, -120.42951047768281, -43.774129024283916, -27.224902052802584, 307.4633167542156, -710.746555412369, -146.78738474998872, -1316.0636910512164, -391.83247461670305, -11.53716883301548, -681.0007747886524, 24.175453330227135, -174.04276080195135, -993.8009727715413, 13.570703969395522, -35.9018233792496, -25.195072852495024, -617.0264328705083, -22.67597503643264, -84.10039907549054, -884.5950861356904, -325.34621304716626, -105.82694329749563, -284.5118308834212, -201.19260167207722, -219.96798410853089, -25.56110033200666, -1547.726097544591, -64.50857398041228, -91.94347094703858, -98.5779916690843, -417.5206392431006, 25.284847837342614, -502.8857426292492, -361.29444614092125, -196.9820874615567, 244.62264063390705, -537.1010612177689, -929.8232581331245, -50.11803927013437, -192.84176243735567, -498.3733714512965, -52.16274947106832, -1448.2104117095498, -20.838243600446276, -421.68831201120724, -396.0895769042891, -715.9936719714716, -52.00087012932978, -414.01640823298766, -351.19809475097327, -397.04020860924516, -182.25396970480074, -497.6527917572471, -214.6826889515058, -1173.870119119693, 391.9, -54.71988488174372, -113.89966108506968, -31.005900235042027, -1211.1910073504498, -112.63745011852444, -100.88988762519985, 206.83274397184388, -156.18812702447852, -151.24254614662485, -28.620166161254744, -39.13638237759232, -424.0269790733642, -54.95489294135951, 388.2517354034877, -67.78182282344684, -226.80682323563235, -107.0656603041931, 200.8073521120427, -2.1500998549073356, -890.6251537029748, -73.0203261240484, -460.00968302174806, -497.1306377999669, -89.82642877954254, -463.20564442842993, -132.60120099591552, -113.94279809074487, -400.88204293979294, -97.00801916280881, 16.161965489769976, -36.799005153579266, -837.8798887572201, 33.035570637102445, 23.97284226351379, -382.1326059099092, 35.230794357462344, -122.80071808916702], "policy_predator_policy_reward": [586.8732267502501, 847.8850614053557, 557.2227661376722, 745.4315690556332, 467.72582224189006, 21.13603868136662, 629.0995192574842, 336.91687500821297, 525.635744570644, 142.34597207902996, 204.5419228762638, 863.0336079093865, 389.1808236915413, 290.6215544233606, 124.14134808505628, 217.4201206901874, 162.33949844469183, 26.525132889069233, 676.4609469000237, 100.20366733908772, 304.6268964629782, 215.0188547436499, 215.06650134535428, 349.20335779557894, 385.8593256534287, 564.9693670500974, 692.4277535498535, 248.1203513754404, 206.1148491436508, 94.13811130656441, 196.73984938453358, 198.1677071313532, 229.99544885547428, 45.09157743783933, 1220.763193039062, 226.1297123973214, 53.727197046368005, 289.40483545571817, 386.3452564841956, 599.9923923886213, 360.78236786500094, 237.35015891885178, 351.9286268024513, 273.9228269047427, 514.6750792255311, 565.626914398885, 238.72717189742286, 372.906067693771, 272.7277841274048, 448.86268567354387, 313.329920286966, 189.28753971608495, 230.82572646182982, 661.7114856238255, 15.451869910957754, 713.8390827434357, 714.1885695592954, 409.78309206212145, 136.27784361697638, 110.13940850215792, 644.4867027084877, 427.4473259985441, 824.7485214680132, 407.1167052477792, 159.20657723107615, 55.661825330220815, 232.20967996629008, 896.4180283853876, 235.82286067914046, 100.84175990612542, 622.8683435941912, 200.8658847064552, 132.37478237501466, 1102.0192918898845, 111.45192262531194, 986.712929773719, 402.3613065126999, 565.2680380599758, 459.18424576625137, 90.536289244136, 84.97490252273174, 305.2063667254253, 155.406024094477, 412.257424654741, 238.79597453320366, 128.22144233937064, 223.20679690867289, 1289.2059325011387, 104.91003057216392, 52.942671904463815, 270.4303011830782, 376.5047480666486, 386.4040900834523, 213.57927227156563, 1041.83477266785, 13.620431824682058, 116.15053871047292, 54.93790528598018, 334.2532614471853, 429.5559251100148, 14.167756858206353, 41.90325658244338, 167.8365310651554, 67.74628482591079, 23.790947131499657, 254.72079349894764, 359.0703063082394, 227.8171984069736, 78.8596345943387, 70.43617806854476, 228.50583450082203, 658.633823504006, 329.57057116940706, 1255.6530748874009, 397.8342462462863, 232.0932670728322, 704.2007747886577, 34.42454666977293, 1026.3595791401428, 972.383834003987, 74.52437872713155, 0.0, 71.24620554740059, 633.9209199386507, 156.61470411592626, 20.561669995997157, 882.0223990380606, 390.9516823355055, 444.325686757532, 197.5056299792921, 348.75230659893487, 135.73606905100735, 76.139302355345, 1546.6258354389745, 115.11345614184394, 115.11230414371532, 132.07799166908273, 439.0206392431055, 356.4584312626824, 175.4173730281425, 273.32524179894136, 383.79204964971404, 58.267879584706236, 562.0010612177741, 906.3737579758142, 234.62415788077547, 507.46732018732916, 279.3563275319659, 85.36274947106727, 1459.8104117095395, 229.7471840842181, 406.7660793319471, 450.6753522960616, 775.8725056011783, 117.99978885654286, 421.2898361283295, 675.6918531840655, 301.29703295192945, 246.06669959516165, 479.4086602223863, 255.7020197775167, 1180.0987083125538, 0.0, 88.71988488174252, 154.7127013619649, 63.894351628894626, 126.88825135217255, 1253.1827382498964, 151.62598183099644, 183.04489085226402, 166.16793814112287, 276.07861238141, 42.41374201794263, 77.34058097843281, 435.8078868655362, 189.56488201408627, 63.41028774682486, 101.72338749366196, 240.97518271900287, 180.77163468743953, 35.69469781924871, 44.811079818557836, 907.5492384464129, 92.69969608988283, 632.2899817405114, 351.5169712916827, 184.10211384183395, 476.1748879253433, 164.90120099591368, 147.94279809074294, 300.4107959113474, 398.53717410872343, 22.138034510230025, 72.59900515357917, 817.8830242201459, 109.9046486526573, 14.927157736486247, 411.6326059099157, 53.98841878772546, 143.31723551971274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.865355581637242, "mean_inference_ms": 4.531241511042306, "mean_action_processing_ms": 1.4869176650165037, "mean_env_wait_ms": 10.622931432615879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076105594635009766, "StateBufferConnector_ms": 0.006270885467529297, "ViewRequirementAgentConnector_ms": 0.2428452968597412}, "num_episodes": 11, "episode_return_max": 830.8996795706444, "episode_return_min": -35.43363958116312, "episode_return_mean": 146.78553091922137, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.20894103153942, "num_env_steps_trained_throughput_per_sec": 83.20894103153942, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 63872.226, "restore_workers_time_ms": 0.015, "training_step_time_ms": 63872.125, "sample_time_ms": 2967.035, "learn_time_ms": 60877.562, "learn_throughput": 65.706, "synch_weights_time_ms": 22.156}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "35fb9_00000", "date": "2024-08-22_09-15-56", "timestamp": 1724298356, "time_this_iter_s": 48.143821001052856, "time_total_s": 4933.683808803558, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b630430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4933.683808803558, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 29.873529411764707, "ram_util_percent": 83.39999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.249457958829467, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.703113822962242, "policy_loss": -0.01871963464482515, "vf_loss": 4.719324382146199, "vf_explained_var": 0.45019162855451067, "kl": 0.01254541970217827, "entropy": 0.7519902334011421, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.678778958951355, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.380498796291453, "policy_loss": -0.02676381254260719, "vf_loss": 4.404345248489784, "vf_explained_var": 0.2564408430346736, "kl": 0.014586821822301735, "entropy": 0.599156575622382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 830.8996795706444, "episode_reward_min": -43.67699783327669, "episode_reward_mean": 154.99505278332174, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1547.726097544591, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.1056880492409, "predator_policy": 1546.6258354389745}, "policy_reward_mean": {"prey_policy": -267.08899117953, "predator_policy": 344.5865175711912}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.49683974713618, 35.85661747703209, 369.6605120994634, 59.80000000000057, 75.7723282572432, 109.40266627697126, 106.91761683224883, 234.485313011826, 500.03746705219237, 500.33302651356536, 118.51620499634667, 250.68887656032888, 316.091428996378, 106.8373249382522, 438.41246498877916, 61.90000000000061, 131.45958248068035, 63.02209258649139, 184.31370344275373, 119.27404357867398, 160.83292239484652, 108.871943035849, 52.069171197434805, 149.93872739675277, 48.400000000000425, 111.33289031567783, 131.57899744882738, 114.6819965281934, 61.312106740927035, 69.42673469954602, 137.90841780116997, 64.01302849688028, 69.44561034197876, 286.00146386939684, 53.68606797750017, 52.074102353045205, 70.93041885596368, 34.88424215965815, 76.49999999999993, 115.00503441820858, 65.50000000000055, 130.77892213987656, 78.29678158579691, 483.85641934667444, 122.37257025560491, 226.5578698693928, 81.79999999999954, 830.8996795706444, 52.193259317277935, 62.94561976304472, 70.40000000000026, 63.03278219070302, 251.49254255590134, 63.32778986933799, 49.47793991772259, 73.77371535811189, 55.00000000000054, 54.27490949891673, 98.84075784617615, 327.7905202186138, 161.05661845332978, 95.60851383064144, 44.80000000000037, 193.98670780450567, 114.4646090214728, 73.27234662255026, 228.75058277576963, 45.568598355500185, 47.24792001887298, 425.90000000000254, 73.70149167074884, 56.242532133097264, 440.61372902990956, 134.8158773514298, 51.99777445752859, 146.39089686489342, 485.60358782053345, 87.87433386661934, 279.1630298949465, 36.603454709272825, 26.666632210479058, 107.24492855919759, 66.30000000000051, 201.05790791746543, 74.10000000000007, 122.94335475267879, 68.40000000000039, 109.73573057573265, -43.67699783327669, 125.91309386821109, 521.2883393252789, 47.600000000000406, 66.92753945270947, 79.62898777700381, 58.625837761863615, 340.60000000000076, 374.6248975002572, 386.08146947706155, 239.37514896387552, 234.62173816998924], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-253.0295978848285, -624.3022550715601, -684.3277535498518, -220.36373389841006, 232.05029037171266, -162.6427387224675, -167.13984938453476, -167.96770713135493, -213.87852338714083, 14.563825351069527, -375.5755844645924, -961.9146546948149, -218.20713452750374, -18.007281142331443, -242.11748851822966, -509.7348473427553, 154.2883684438157, -252.38342817547718, 69.63205508322665, -195.15048227685838, -408.5092109116641, -553.2765777164008, -10.138295337093211, -350.80606769376595, -247.7999200824008, -157.69912072216653, -335.5943024290453, -60.18583263575257, -707.3949592406872, 253.2702121438129, 23.54813008904228, -690.9390827434307, -688.3723274065155, -304.13975173421403, -106.75075354133682, -76.64440599131008, -750.6144464396547, -137.00587882462477, -833.7444518424979, -278.84673129462084, -130.03548016644854, 75.99999999999964, -290.72375250392014, -729.0320128119065, -126.27328781922674, -158.32216156860827, -667.6099998068263, -6.185501097066558, -101.17478237501561, -1084.8192918899, -3.5549201243625457, -983.2770419589846, -525.8331365589269, -310.2172105649164, -501.1102391892948, 66.07170070710677, -37.14362055186532, -291.72554195536065, -348.3600052564796, -149.87670879318927, -65.4491614872403, -163.6598375841644, -158.87574182350218, -1289.5239590894296, -74.40601593516803, -14.00107619948259, -468.9697098479102, 108.03612446758399, -375.20063537417656, -171.09665900334014, -1041.43477266785, 38.053670528363, -80.45053871047463, -19.70748643001624, -327.04897660294483, -401.8759677945909, 24.432243141793695, -4.003256582443058, -147.03835928513686, 26.460577812280643, 14.509052868500378, -227.5207934989492, -335.6790720976474, -120.42951047768281, -43.774129024283916, -27.224902052802584, 307.4633167542156, -710.746555412369, -146.78738474998872, -1316.0636910512164, -391.83247461670305, -11.53716883301548, -681.0007747886524, 24.175453330227135, -174.04276080195135, -993.8009727715413, 13.570703969395522, -35.9018233792496, -25.195072852495024, -617.0264328705083, -22.67597503643264, -84.10039907549054, -884.5950861356904, -325.34621304716626, -105.82694329749563, -284.5118308834212, -201.19260167207722, -219.96798410853089, -25.56110033200666, -1547.726097544591, -64.50857398041228, -91.94347094703858, -98.5779916690843, -417.5206392431006, 25.284847837342614, -502.8857426292492, -361.29444614092125, -196.9820874615567, 244.62264063390705, -537.1010612177689, -929.8232581331245, -50.11803927013437, -192.84176243735567, -498.3733714512965, -52.16274947106832, -1448.2104117095498, -20.838243600446276, -421.68831201120724, -396.0895769042891, -715.9936719714716, -52.00087012932978, -414.01640823298766, -351.19809475097327, -397.04020860924516, -182.25396970480074, -497.6527917572471, -214.6826889515058, -1173.870119119693, 391.9, -54.71988488174372, -113.89966108506968, -31.005900235042027, -1211.1910073504498, -112.63745011852444, -100.88988762519985, 206.83274397184388, -156.18812702447852, -151.24254614662485, -28.620166161254744, -39.13638237759232, -424.0269790733642, -54.95489294135951, 388.2517354034877, -67.78182282344684, -226.80682323563235, -107.0656603041931, 200.8073521120427, -2.1500998549073356, -890.6251537029748, -73.0203261240484, -460.00968302174806, -497.1306377999669, -89.82642877954254, -463.20564442842993, -132.60120099591552, -113.94279809074487, -400.88204293979294, -97.00801916280881, 16.161965489769976, -36.799005153579266, -837.8798887572201, 33.035570637102445, 23.97284226351379, -382.1326059099092, 35.230794357462344, -122.80071808916702, -245.32733982139317, -788.7568445851963, -105.1539637771773, -452.38654212982954, -100.25104005573988, 398.1056880492409, 18.013322356580414, -1029.2672511692717, -375.57248423480087, -136.35363222863378, -34.448905199531836, -962.8179191540316, -435.2135890622842, -54.59793139084608, -152.70259838484588, 55.55057677811663, -161.85250516239674, -349.7729171177309, -13.882354867494245, -218.7517170370792, -517.2546921127574, -50.52096376253605, -243.89188624208992, 60.22281891872007], "policy_predator_policy_reward": [385.8593256534287, 564.9693670500974, 692.4277535498535, 248.1203513754404, 206.1148491436508, 94.13811130656441, 196.73984938453358, 198.1677071313532, 229.99544885547428, 45.09157743783933, 1220.763193039062, 226.1297123973214, 53.727197046368005, 289.40483545571817, 386.3452564841956, 599.9923923886213, 360.78236786500094, 237.35015891885178, 351.9286268024513, 273.9228269047427, 514.6750792255311, 565.626914398885, 238.72717189742286, 372.906067693771, 272.7277841274048, 448.86268567354387, 313.329920286966, 189.28753971608495, 230.82572646182982, 661.7114856238255, 15.451869910957754, 713.8390827434357, 714.1885695592954, 409.78309206212145, 136.27784361697638, 110.13940850215792, 644.4867027084877, 427.4473259985441, 824.7485214680132, 407.1167052477792, 159.20657723107615, 55.661825330220815, 232.20967996629008, 896.4180283853876, 235.82286067914046, 100.84175990612542, 622.8683435941912, 200.8658847064552, 132.37478237501466, 1102.0192918898845, 111.45192262531194, 986.712929773719, 402.3613065126999, 565.2680380599758, 459.18424576625137, 90.536289244136, 84.97490252273174, 305.2063667254253, 155.406024094477, 412.257424654741, 238.79597453320366, 128.22144233937064, 223.20679690867289, 1289.2059325011387, 104.91003057216392, 52.942671904463815, 270.4303011830782, 376.5047480666486, 386.4040900834523, 213.57927227156563, 1041.83477266785, 13.620431824682058, 116.15053871047292, 54.93790528598018, 334.2532614471853, 429.5559251100148, 14.167756858206353, 41.90325658244338, 167.8365310651554, 67.74628482591079, 23.790947131499657, 254.72079349894764, 359.0703063082394, 227.8171984069736, 78.8596345943387, 70.43617806854476, 228.50583450082203, 658.633823504006, 329.57057116940706, 1255.6530748874009, 397.8342462462863, 232.0932670728322, 704.2007747886577, 34.42454666977293, 1026.3595791401428, 972.383834003987, 74.52437872713155, 0.0, 71.24620554740059, 633.9209199386507, 156.61470411592626, 20.561669995997157, 882.0223990380606, 390.9516823355055, 444.325686757532, 197.5056299792921, 348.75230659893487, 135.73606905100735, 76.139302355345, 1546.6258354389745, 115.11345614184394, 115.11230414371532, 132.07799166908273, 439.0206392431055, 356.4584312626824, 175.4173730281425, 273.32524179894136, 383.79204964971404, 58.267879584706236, 562.0010612177741, 906.3737579758142, 234.62415788077547, 507.46732018732916, 279.3563275319659, 85.36274947106727, 1459.8104117095395, 229.7471840842181, 406.7660793319471, 450.6753522960616, 775.8725056011783, 117.99978885654286, 421.2898361283295, 675.6918531840655, 301.29703295192945, 246.06669959516165, 479.4086602223863, 255.7020197775167, 1180.0987083125538, 0.0, 88.71988488174252, 154.7127013619649, 63.894351628894626, 126.88825135217255, 1253.1827382498964, 151.62598183099644, 183.04489085226402, 166.16793814112287, 276.07861238141, 42.41374201794263, 77.34058097843281, 435.8078868655362, 189.56488201408627, 63.41028774682486, 101.72338749366196, 240.97518271900287, 180.77163468743953, 35.69469781924871, 44.811079818557836, 907.5492384464129, 92.69969608988283, 632.2899817405114, 351.5169712916827, 184.10211384183395, 476.1748879253433, 164.90120099591368, 147.94279809074294, 300.4107959113474, 398.53717410872343, 22.138034510230025, 72.59900515357917, 817.8830242201459, 109.9046486526573, 14.927157736486247, 411.6326059099157, 53.98841878772546, 143.31723551971274, 174.0245712334238, 816.382615339888, 203.32814021335128, 480.12545956187273, 98.48486158707131, 124.94882974469995, 20.686677643419593, 1038.1672511692657, 387.1836816131405, 191.66997430300717, 131.22958504847466, 945.6662270820959, 463.18942682415246, 85.24793139084485, 187.7025983848439, 250.0494232218833, 299.10062814740644, 587.1496916329779, 225.15046843739847, 393.5650729442323, 703.2173854096945, 103.93341942947457, 319.1633986686542, 99.12740682470498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.875486717778345, "mean_inference_ms": 4.527367137076501, "mean_action_processing_ms": 1.4927130600975296, "mean_env_wait_ms": 10.635488586363925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010294795036315918, "StateBufferConnector_ms": 0.006490468978881836, "ViewRequirementAgentConnector_ms": 0.25405752658843994}, "num_episodes": 12, "episode_return_max": 830.8996795706444, "episode_return_min": -43.67699783327669, "episode_return_mean": 154.99505278332174, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.46456495100416, "num_env_steps_trained_throughput_per_sec": 81.46456495100416, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 62907.159, "restore_workers_time_ms": 0.015, "training_step_time_ms": 62907.058, "sample_time_ms": 2963.046, "learn_time_ms": 59917.171, "learn_throughput": 66.759, "synch_weights_time_ms": 21.809}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "35fb9_00000", "date": "2024-08-22_09-16-46", "timestamp": 1724298406, "time_this_iter_s": 49.16760182380676, "time_total_s": 4982.851410627365, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcbd160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4982.851410627365, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 30.561428571428568, "ram_util_percent": 83.23285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.418832862187944, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.35688390757041, "policy_loss": -0.021697778065095128, "vf_loss": 5.375581825725616, "vf_explained_var": 0.5153508605465057, "kl": 0.014999310110533048, "entropy": 0.8001955415836718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.837668593598421, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.642054163211237, "policy_loss": -0.02566549140558376, "vf_loss": 4.664553283131312, "vf_explained_var": 0.1558507793794864, "kl": 0.015831822080774202, "entropy": 0.5789874677935606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 830.8996795706444, "episode_reward_min": -43.67699783327669, "episode_reward_mean": 153.108366063803, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1547.726097544591, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.1056880492409, "predator_policy": 1546.6258354389745}, "policy_reward_mean": {"prey_policy": -265.53037990420705, "predator_policy": 342.0845629361091}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.7723282572432, 109.40266627697126, 106.91761683224883, 234.485313011826, 500.03746705219237, 500.33302651356536, 118.51620499634667, 250.68887656032888, 316.091428996378, 106.8373249382522, 438.41246498877916, 61.90000000000061, 131.45958248068035, 63.02209258649139, 184.31370344275373, 119.27404357867398, 160.83292239484652, 108.871943035849, 52.069171197434805, 149.93872739675277, 48.400000000000425, 111.33289031567783, 131.57899744882738, 114.6819965281934, 61.312106740927035, 69.42673469954602, 137.90841780116997, 64.01302849688028, 69.44561034197876, 286.00146386939684, 53.68606797750017, 52.074102353045205, 70.93041885596368, 34.88424215965815, 76.49999999999993, 115.00503441820858, 65.50000000000055, 130.77892213987656, 78.29678158579691, 483.85641934667444, 122.37257025560491, 226.5578698693928, 81.79999999999954, 830.8996795706444, 52.193259317277935, 62.94561976304472, 70.40000000000026, 63.03278219070302, 251.49254255590134, 63.32778986933799, 49.47793991772259, 73.77371535811189, 55.00000000000054, 54.27490949891673, 98.84075784617615, 327.7905202186138, 161.05661845332978, 95.60851383064144, 44.80000000000037, 193.98670780450567, 114.4646090214728, 73.27234662255026, 228.75058277576963, 45.568598355500185, 47.24792001887298, 425.90000000000254, 73.70149167074884, 56.242532133097264, 440.61372902990956, 134.8158773514298, 51.99777445752859, 146.39089686489342, 485.60358782053345, 87.87433386661934, 279.1630298949465, 36.603454709272825, 26.666632210479058, 107.24492855919759, 66.30000000000051, 201.05790791746543, 74.10000000000007, 122.94335475267879, 68.40000000000039, 109.73573057573265, -43.67699783327669, 125.91309386821109, 521.2883393252789, 47.600000000000406, 66.92753945270947, 79.62898777700381, 58.625837761863615, 340.60000000000076, 374.6248975002572, 386.08146947706155, 239.37514896387552, 234.62173816998924, 49.50000000000043, 77.19999999999989, 60.00000000000059, 163.44529737176026], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-213.87852338714083, 14.563825351069527, -375.5755844645924, -961.9146546948149, -218.20713452750374, -18.007281142331443, -242.11748851822966, -509.7348473427553, 154.2883684438157, -252.38342817547718, 69.63205508322665, -195.15048227685838, -408.5092109116641, -553.2765777164008, -10.138295337093211, -350.80606769376595, -247.7999200824008, -157.69912072216653, -335.5943024290453, -60.18583263575257, -707.3949592406872, 253.2702121438129, 23.54813008904228, -690.9390827434307, -688.3723274065155, -304.13975173421403, -106.75075354133682, -76.64440599131008, -750.6144464396547, -137.00587882462477, -833.7444518424979, -278.84673129462084, -130.03548016644854, 75.99999999999964, -290.72375250392014, -729.0320128119065, -126.27328781922674, -158.32216156860827, -667.6099998068263, -6.185501097066558, -101.17478237501561, -1084.8192918899, -3.5549201243625457, -983.2770419589846, -525.8331365589269, -310.2172105649164, -501.1102391892948, 66.07170070710677, -37.14362055186532, -291.72554195536065, -348.3600052564796, -149.87670879318927, -65.4491614872403, -163.6598375841644, -158.87574182350218, -1289.5239590894296, -74.40601593516803, -14.00107619948259, -468.9697098479102, 108.03612446758399, -375.20063537417656, -171.09665900334014, -1041.43477266785, 38.053670528363, -80.45053871047463, -19.70748643001624, -327.04897660294483, -401.8759677945909, 24.432243141793695, -4.003256582443058, -147.03835928513686, 26.460577812280643, 14.509052868500378, -227.5207934989492, -335.6790720976474, -120.42951047768281, -43.774129024283916, -27.224902052802584, 307.4633167542156, -710.746555412369, -146.78738474998872, -1316.0636910512164, -391.83247461670305, -11.53716883301548, -681.0007747886524, 24.175453330227135, -174.04276080195135, -993.8009727715413, 13.570703969395522, -35.9018233792496, -25.195072852495024, -617.0264328705083, -22.67597503643264, -84.10039907549054, -884.5950861356904, -325.34621304716626, -105.82694329749563, -284.5118308834212, -201.19260167207722, -219.96798410853089, -25.56110033200666, -1547.726097544591, -64.50857398041228, -91.94347094703858, -98.5779916690843, -417.5206392431006, 25.284847837342614, -502.8857426292492, -361.29444614092125, -196.9820874615567, 244.62264063390705, -537.1010612177689, -929.8232581331245, -50.11803927013437, -192.84176243735567, -498.3733714512965, -52.16274947106832, -1448.2104117095498, -20.838243600446276, -421.68831201120724, -396.0895769042891, -715.9936719714716, -52.00087012932978, -414.01640823298766, -351.19809475097327, -397.04020860924516, -182.25396970480074, -497.6527917572471, -214.6826889515058, -1173.870119119693, 391.9, -54.71988488174372, -113.89966108506968, -31.005900235042027, -1211.1910073504498, -112.63745011852444, -100.88988762519985, 206.83274397184388, -156.18812702447852, -151.24254614662485, -28.620166161254744, -39.13638237759232, -424.0269790733642, -54.95489294135951, 388.2517354034877, -67.78182282344684, -226.80682323563235, -107.0656603041931, 200.8073521120427, -2.1500998549073356, -890.6251537029748, -73.0203261240484, -460.00968302174806, -497.1306377999669, -89.82642877954254, -463.20564442842993, -132.60120099591552, -113.94279809074487, -400.88204293979294, -97.00801916280881, 16.161965489769976, -36.799005153579266, -837.8798887572201, 33.035570637102445, 23.97284226351379, -382.1326059099092, 35.230794357462344, -122.80071808916702, -245.32733982139317, -788.7568445851963, -105.1539637771773, -452.38654212982954, -100.25104005573988, 398.1056880492409, 18.013322356580414, -1029.2672511692717, -375.57248423480087, -136.35363222863378, -34.448905199531836, -962.8179191540316, -435.2135890622842, -54.59793139084608, -152.70259838484588, 55.55057677811663, -161.85250516239674, -349.7729171177309, -13.882354867494245, -218.7517170370792, -517.2546921127574, -50.52096376253605, -243.89188624208992, 60.22281891872007, -264.1576061676127, -139.91637126803786, 25.212889016363967, 17.783671017259028, -357.2878161666416, -105.02128246378754, -543.9956909611664, -368.6188832130826], "policy_predator_policy_reward": [229.99544885547428, 45.09157743783933, 1220.763193039062, 226.1297123973214, 53.727197046368005, 289.40483545571817, 386.3452564841956, 599.9923923886213, 360.78236786500094, 237.35015891885178, 351.9286268024513, 273.9228269047427, 514.6750792255311, 565.626914398885, 238.72717189742286, 372.906067693771, 272.7277841274048, 448.86268567354387, 313.329920286966, 189.28753971608495, 230.82572646182982, 661.7114856238255, 15.451869910957754, 713.8390827434357, 714.1885695592954, 409.78309206212145, 136.27784361697638, 110.13940850215792, 644.4867027084877, 427.4473259985441, 824.7485214680132, 407.1167052477792, 159.20657723107615, 55.661825330220815, 232.20967996629008, 896.4180283853876, 235.82286067914046, 100.84175990612542, 622.8683435941912, 200.8658847064552, 132.37478237501466, 1102.0192918898845, 111.45192262531194, 986.712929773719, 402.3613065126999, 565.2680380599758, 459.18424576625137, 90.536289244136, 84.97490252273174, 305.2063667254253, 155.406024094477, 412.257424654741, 238.79597453320366, 128.22144233937064, 223.20679690867289, 1289.2059325011387, 104.91003057216392, 52.942671904463815, 270.4303011830782, 376.5047480666486, 386.4040900834523, 213.57927227156563, 1041.83477266785, 13.620431824682058, 116.15053871047292, 54.93790528598018, 334.2532614471853, 429.5559251100148, 14.167756858206353, 41.90325658244338, 167.8365310651554, 67.74628482591079, 23.790947131499657, 254.72079349894764, 359.0703063082394, 227.8171984069736, 78.8596345943387, 70.43617806854476, 228.50583450082203, 658.633823504006, 329.57057116940706, 1255.6530748874009, 397.8342462462863, 232.0932670728322, 704.2007747886577, 34.42454666977293, 1026.3595791401428, 972.383834003987, 74.52437872713155, 0.0, 71.24620554740059, 633.9209199386507, 156.61470411592626, 20.561669995997157, 882.0223990380606, 390.9516823355055, 444.325686757532, 197.5056299792921, 348.75230659893487, 135.73606905100735, 76.139302355345, 1546.6258354389745, 115.11345614184394, 115.11230414371532, 132.07799166908273, 439.0206392431055, 356.4584312626824, 175.4173730281425, 273.32524179894136, 383.79204964971404, 58.267879584706236, 562.0010612177741, 906.3737579758142, 234.62415788077547, 507.46732018732916, 279.3563275319659, 85.36274947106727, 1459.8104117095395, 229.7471840842181, 406.7660793319471, 450.6753522960616, 775.8725056011783, 117.99978885654286, 421.2898361283295, 675.6918531840655, 301.29703295192945, 246.06669959516165, 479.4086602223863, 255.7020197775167, 1180.0987083125538, 0.0, 88.71988488174252, 154.7127013619649, 63.894351628894626, 126.88825135217255, 1253.1827382498964, 151.62598183099644, 183.04489085226402, 166.16793814112287, 276.07861238141, 42.41374201794263, 77.34058097843281, 435.8078868655362, 189.56488201408627, 63.41028774682486, 101.72338749366196, 240.97518271900287, 180.77163468743953, 35.69469781924871, 44.811079818557836, 907.5492384464129, 92.69969608988283, 632.2899817405114, 351.5169712916827, 184.10211384183395, 476.1748879253433, 164.90120099591368, 147.94279809074294, 300.4107959113474, 398.53717410872343, 22.138034510230025, 72.59900515357917, 817.8830242201459, 109.9046486526573, 14.927157736486247, 411.6326059099157, 53.98841878772546, 143.31723551971274, 174.0245712334238, 816.382615339888, 203.32814021335128, 480.12545956187273, 98.48486158707131, 124.94882974469995, 20.686677643419593, 1038.1672511692657, 387.1836816131405, 191.66997430300717, 131.22958504847466, 945.6662270820959, 463.18942682415246, 85.24793139084485, 187.7025983848439, 250.0494232218833, 299.10062814740644, 587.1496916329779, 225.15046843739847, 393.5650729442323, 703.2173854096945, 103.93341942947457, 319.1633986686542, 99.12740682470498, 286.4576061676167, 167.11637126803632, 13.787110983636092, 20.41632898274098, 382.6878161666474, 139.62128246378558, 541.0409318239067, 535.0189397221085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.884634507621211, "mean_inference_ms": 4.534490088602407, "mean_action_processing_ms": 1.4900164022246134, "mean_env_wait_ms": 10.644390274223815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014217257499694824, "StateBufferConnector_ms": 0.0066204071044921875, "ViewRequirementAgentConnector_ms": 0.27026939392089844}, "num_episodes": 4, "episode_return_max": 830.8996795706444, "episode_return_min": -43.67699783327669, "episode_return_mean": 153.108366063803, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 34.571456204923024, "num_env_steps_trained_throughput_per_sec": 34.571456204923024, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 69018.354, "restore_workers_time_ms": 0.016, "training_step_time_ms": 69018.281, "sample_time_ms": 3169.375, "learn_time_ms": 65822.143, "learn_throughput": 60.77, "synch_weights_time_ms": 22.277}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "35fb9_00000", "date": "2024-08-22_09-18-41", "timestamp": 1724298521, "time_this_iter_s": 115.80847311019897, "time_total_s": 5098.659883737564, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcd00d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5098.659883737564, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 43.75061728395061, "ram_util_percent": 83.07407407407408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.4691012421613, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.373714687836864, "policy_loss": -0.01807433351327384, "vf_loss": 4.3890966710590185, "vf_explained_var": 0.5346975992596339, "kl": 0.013461726516110713, "entropy": 0.8354378543833576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.252837516328015, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.083762462050826, "policy_loss": -0.02567467730179449, "vf_loss": 4.106466334332865, "vf_explained_var": 0.26869855542031545, "kl": 0.014854049787698954, "entropy": 0.5970070429422237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 830.8996795706444, "episode_reward_min": -43.67699783327669, "episode_reward_mean": 146.02296220178695, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1547.726097544591, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.1056880492409, "predator_policy": 1546.6258354389745}, "policy_reward_mean": {"prey_policy": -261.0070771763733, "predator_policy": 334.0185582772673}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.091428996378, 106.8373249382522, 438.41246498877916, 61.90000000000061, 131.45958248068035, 63.02209258649139, 184.31370344275373, 119.27404357867398, 160.83292239484652, 108.871943035849, 52.069171197434805, 149.93872739675277, 48.400000000000425, 111.33289031567783, 131.57899744882738, 114.6819965281934, 61.312106740927035, 69.42673469954602, 137.90841780116997, 64.01302849688028, 69.44561034197876, 286.00146386939684, 53.68606797750017, 52.074102353045205, 70.93041885596368, 34.88424215965815, 76.49999999999993, 115.00503441820858, 65.50000000000055, 130.77892213987656, 78.29678158579691, 483.85641934667444, 122.37257025560491, 226.5578698693928, 81.79999999999954, 830.8996795706444, 52.193259317277935, 62.94561976304472, 70.40000000000026, 63.03278219070302, 251.49254255590134, 63.32778986933799, 49.47793991772259, 73.77371535811189, 55.00000000000054, 54.27490949891673, 98.84075784617615, 327.7905202186138, 161.05661845332978, 95.60851383064144, 44.80000000000037, 193.98670780450567, 114.4646090214728, 73.27234662255026, 228.75058277576963, 45.568598355500185, 47.24792001887298, 425.90000000000254, 73.70149167074884, 56.242532133097264, 440.61372902990956, 134.8158773514298, 51.99777445752859, 146.39089686489342, 485.60358782053345, 87.87433386661934, 279.1630298949465, 36.603454709272825, 26.666632210479058, 107.24492855919759, 66.30000000000051, 201.05790791746543, 74.10000000000007, 122.94335475267879, 68.40000000000039, 109.73573057573265, -43.67699783327669, 125.91309386821109, 521.2883393252789, 47.600000000000406, 66.92753945270947, 79.62898777700381, 58.625837761863615, 340.60000000000076, 374.6248975002572, 386.08146947706155, 239.37514896387552, 234.62173816998924, 49.50000000000043, 77.19999999999989, 60.00000000000059, 163.44529737176026, 413.230154368537, 84.81992135188995, 144.89351308835518, 28.697468108106662, 164.78817290574207, 74.60000000000004, 71.5838834764834, 204.9999999999995], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-247.7999200824008, -157.69912072216653, -335.5943024290453, -60.18583263575257, -707.3949592406872, 253.2702121438129, 23.54813008904228, -690.9390827434307, -688.3723274065155, -304.13975173421403, -106.75075354133682, -76.64440599131008, -750.6144464396547, -137.00587882462477, -833.7444518424979, -278.84673129462084, -130.03548016644854, 75.99999999999964, -290.72375250392014, -729.0320128119065, -126.27328781922674, -158.32216156860827, -667.6099998068263, -6.185501097066558, -101.17478237501561, -1084.8192918899, -3.5549201243625457, -983.2770419589846, -525.8331365589269, -310.2172105649164, -501.1102391892948, 66.07170070710677, -37.14362055186532, -291.72554195536065, -348.3600052564796, -149.87670879318927, -65.4491614872403, -163.6598375841644, -158.87574182350218, -1289.5239590894296, -74.40601593516803, -14.00107619948259, -468.9697098479102, 108.03612446758399, -375.20063537417656, -171.09665900334014, -1041.43477266785, 38.053670528363, -80.45053871047463, -19.70748643001624, -327.04897660294483, -401.8759677945909, 24.432243141793695, -4.003256582443058, -147.03835928513686, 26.460577812280643, 14.509052868500378, -227.5207934989492, -335.6790720976474, -120.42951047768281, -43.774129024283916, -27.224902052802584, 307.4633167542156, -710.746555412369, -146.78738474998872, -1316.0636910512164, -391.83247461670305, -11.53716883301548, -681.0007747886524, 24.175453330227135, -174.04276080195135, -993.8009727715413, 13.570703969395522, -35.9018233792496, -25.195072852495024, -617.0264328705083, -22.67597503643264, -84.10039907549054, -884.5950861356904, -325.34621304716626, -105.82694329749563, -284.5118308834212, -201.19260167207722, -219.96798410853089, -25.56110033200666, -1547.726097544591, -64.50857398041228, -91.94347094703858, -98.5779916690843, -417.5206392431006, 25.284847837342614, -502.8857426292492, -361.29444614092125, -196.9820874615567, 244.62264063390705, -537.1010612177689, -929.8232581331245, -50.11803927013437, -192.84176243735567, -498.3733714512965, -52.16274947106832, -1448.2104117095498, -20.838243600446276, -421.68831201120724, -396.0895769042891, -715.9936719714716, -52.00087012932978, -414.01640823298766, -351.19809475097327, -397.04020860924516, -182.25396970480074, -497.6527917572471, -214.6826889515058, -1173.870119119693, 391.9, -54.71988488174372, -113.89966108506968, -31.005900235042027, -1211.1910073504498, -112.63745011852444, -100.88988762519985, 206.83274397184388, -156.18812702447852, -151.24254614662485, -28.620166161254744, -39.13638237759232, -424.0269790733642, -54.95489294135951, 388.2517354034877, -67.78182282344684, -226.80682323563235, -107.0656603041931, 200.8073521120427, -2.1500998549073356, -890.6251537029748, -73.0203261240484, -460.00968302174806, -497.1306377999669, -89.82642877954254, -463.20564442842993, -132.60120099591552, -113.94279809074487, -400.88204293979294, -97.00801916280881, 16.161965489769976, -36.799005153579266, -837.8798887572201, 33.035570637102445, 23.97284226351379, -382.1326059099092, 35.230794357462344, -122.80071808916702, -245.32733982139317, -788.7568445851963, -105.1539637771773, -452.38654212982954, -100.25104005573988, 398.1056880492409, 18.013322356580414, -1029.2672511692717, -375.57248423480087, -136.35363222863378, -34.448905199531836, -962.8179191540316, -435.2135890622842, -54.59793139084608, -152.70259838484588, 55.55057677811663, -161.85250516239674, -349.7729171177309, -13.882354867494245, -218.7517170370792, -517.2546921127574, -50.52096376253605, -243.89188624208992, 60.22281891872007, -264.1576061676127, -139.91637126803786, 25.212889016363967, 17.783671017259028, -357.2878161666416, -105.02128246378754, -543.9956909611664, -368.6188832130826, -554.6804925170062, 315.6109256636293, -348.4359695844243, 21.690923705551878, -379.3422851664236, -392.7271095318998, -535.225978797584, -280.1590755903729, -708.9750114205226, -106.15650799056073, 15.569589352983025, -39.55034165545788, -106.84582073237763, 36.98632035581255, 98.9714001257929, -203.2853479609039], "policy_predator_policy_reward": [272.7277841274048, 448.86268567354387, 313.329920286966, 189.28753971608495, 230.82572646182982, 661.7114856238255, 15.451869910957754, 713.8390827434357, 714.1885695592954, 409.78309206212145, 136.27784361697638, 110.13940850215792, 644.4867027084877, 427.4473259985441, 824.7485214680132, 407.1167052477792, 159.20657723107615, 55.661825330220815, 232.20967996629008, 896.4180283853876, 235.82286067914046, 100.84175990612542, 622.8683435941912, 200.8658847064552, 132.37478237501466, 1102.0192918898845, 111.45192262531194, 986.712929773719, 402.3613065126999, 565.2680380599758, 459.18424576625137, 90.536289244136, 84.97490252273174, 305.2063667254253, 155.406024094477, 412.257424654741, 238.79597453320366, 128.22144233937064, 223.20679690867289, 1289.2059325011387, 104.91003057216392, 52.942671904463815, 270.4303011830782, 376.5047480666486, 386.4040900834523, 213.57927227156563, 1041.83477266785, 13.620431824682058, 116.15053871047292, 54.93790528598018, 334.2532614471853, 429.5559251100148, 14.167756858206353, 41.90325658244338, 167.8365310651554, 67.74628482591079, 23.790947131499657, 254.72079349894764, 359.0703063082394, 227.8171984069736, 78.8596345943387, 70.43617806854476, 228.50583450082203, 658.633823504006, 329.57057116940706, 1255.6530748874009, 397.8342462462863, 232.0932670728322, 704.2007747886577, 34.42454666977293, 1026.3595791401428, 972.383834003987, 74.52437872713155, 0.0, 71.24620554740059, 633.9209199386507, 156.61470411592626, 20.561669995997157, 882.0223990380606, 390.9516823355055, 444.325686757532, 197.5056299792921, 348.75230659893487, 135.73606905100735, 76.139302355345, 1546.6258354389745, 115.11345614184394, 115.11230414371532, 132.07799166908273, 439.0206392431055, 356.4584312626824, 175.4173730281425, 273.32524179894136, 383.79204964971404, 58.267879584706236, 562.0010612177741, 906.3737579758142, 234.62415788077547, 507.46732018732916, 279.3563275319659, 85.36274947106727, 1459.8104117095395, 229.7471840842181, 406.7660793319471, 450.6753522960616, 775.8725056011783, 117.99978885654286, 421.2898361283295, 675.6918531840655, 301.29703295192945, 246.06669959516165, 479.4086602223863, 255.7020197775167, 1180.0987083125538, 0.0, 88.71988488174252, 154.7127013619649, 63.894351628894626, 126.88825135217255, 1253.1827382498964, 151.62598183099644, 183.04489085226402, 166.16793814112287, 276.07861238141, 42.41374201794263, 77.34058097843281, 435.8078868655362, 189.56488201408627, 63.41028774682486, 101.72338749366196, 240.97518271900287, 180.77163468743953, 35.69469781924871, 44.811079818557836, 907.5492384464129, 92.69969608988283, 632.2899817405114, 351.5169712916827, 184.10211384183395, 476.1748879253433, 164.90120099591368, 147.94279809074294, 300.4107959113474, 398.53717410872343, 22.138034510230025, 72.59900515357917, 817.8830242201459, 109.9046486526573, 14.927157736486247, 411.6326059099157, 53.98841878772546, 143.31723551971274, 174.0245712334238, 816.382615339888, 203.32814021335128, 480.12545956187273, 98.48486158707131, 124.94882974469995, 20.686677643419593, 1038.1672511692657, 387.1836816131405, 191.66997430300717, 131.22958504847466, 945.6662270820959, 463.18942682415246, 85.24793139084485, 187.7025983848439, 250.0494232218833, 299.10062814740644, 587.1496916329779, 225.15046843739847, 393.5650729442323, 703.2173854096945, 103.93341942947457, 319.1633986686542, 99.12740682470498, 286.4576061676167, 167.11637126803632, 13.787110983636092, 20.41632898274098, 382.6878161666474, 139.62128246378558, 541.0409318239067, 535.0189397221085, 327.3341609514854, 324.9655602704302, 319.4421988993636, 92.12276833140587, 380.76783574546704, 536.1950720412256, 696.614270522953, 147.46825197311523, 648.9803579493865, 330.9393343674391, 22.63041064701699, 75.95034165545769, 137.84582073237587, 3.5975631206708867, 63.78194139806979, 245.53200643704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.896070211678268, "mean_inference_ms": 4.539845950084257, "mean_action_processing_ms": 1.4988971324845326, "mean_env_wait_ms": 10.651418120370263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016315698623657227, "StateBufferConnector_ms": 0.0066765546798706055, "ViewRequirementAgentConnector_ms": 0.2420344352722168}, "num_episodes": 8, "episode_return_max": 830.8996795706444, "episode_return_min": -43.67699783327669, "episode_return_mean": 146.02296220178695, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.5928135948254, "num_env_steps_trained_throughput_per_sec": 73.5928135948254, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 68653.571, "restore_workers_time_ms": 0.016, "training_step_time_ms": 68653.496, "sample_time_ms": 2925.832, "learn_time_ms": 65701.529, "learn_throughput": 60.881, "synch_weights_time_ms": 21.756}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "35fb9_00000", "date": "2024-08-22_09-19-36", "timestamp": 1724298576, "time_this_iter_s": 54.43519616127014, "time_total_s": 5153.095079898834, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc8b4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5153.095079898834, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 39.272727272727266, "ram_util_percent": 83.31168831168831}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.143356501803826, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.463644074889087, "policy_loss": -0.024881633325534128, "vf_loss": 4.485819115083684, "vf_explained_var": 0.5537869793712777, "kl": 0.01353298880359424, "entropy": 0.829684208435987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.548361224787575, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.209895006689445, "policy_loss": -0.025412276816657847, "vf_loss": 4.232664095661628, "vf_explained_var": 0.3765564359369732, "kl": 0.013215955851042752, "entropy": 0.5479742038186896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 830.8996795706444, "episode_reward_min": -43.67699783327669, "episode_reward_mean": 146.60313671004894, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1547.726097544591, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.1056880492409, "predator_policy": 1546.6258354389745}, "policy_reward_mean": {"prey_policy": -250.13319064974232, "predator_policy": 323.43475900476733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.93872739675277, 48.400000000000425, 111.33289031567783, 131.57899744882738, 114.6819965281934, 61.312106740927035, 69.42673469954602, 137.90841780116997, 64.01302849688028, 69.44561034197876, 286.00146386939684, 53.68606797750017, 52.074102353045205, 70.93041885596368, 34.88424215965815, 76.49999999999993, 115.00503441820858, 65.50000000000055, 130.77892213987656, 78.29678158579691, 483.85641934667444, 122.37257025560491, 226.5578698693928, 81.79999999999954, 830.8996795706444, 52.193259317277935, 62.94561976304472, 70.40000000000026, 63.03278219070302, 251.49254255590134, 63.32778986933799, 49.47793991772259, 73.77371535811189, 55.00000000000054, 54.27490949891673, 98.84075784617615, 327.7905202186138, 161.05661845332978, 95.60851383064144, 44.80000000000037, 193.98670780450567, 114.4646090214728, 73.27234662255026, 228.75058277576963, 45.568598355500185, 47.24792001887298, 425.90000000000254, 73.70149167074884, 56.242532133097264, 440.61372902990956, 134.8158773514298, 51.99777445752859, 146.39089686489342, 485.60358782053345, 87.87433386661934, 279.1630298949465, 36.603454709272825, 26.666632210479058, 107.24492855919759, 66.30000000000051, 201.05790791746543, 74.10000000000007, 122.94335475267879, 68.40000000000039, 109.73573057573265, -43.67699783327669, 125.91309386821109, 521.2883393252789, 47.600000000000406, 66.92753945270947, 79.62898777700381, 58.625837761863615, 340.60000000000076, 374.6248975002572, 386.08146947706155, 239.37514896387552, 234.62173816998924, 49.50000000000043, 77.19999999999989, 60.00000000000059, 163.44529737176026, 413.230154368537, 84.81992135188995, 144.89351308835518, 28.697468108106662, 164.78817290574207, 74.60000000000004, 71.5838834764834, 204.9999999999995, 120.1154692138981, 146.39848029360851, 334.7020970674512, 416.70000000000243, 36.014614828633526, 79.14440631892272, 229.6469012666065, 170.5886629261644, 67.92986855623137, 100.20498994227675, 99.65663805254398], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-667.6099998068263, -6.185501097066558, -101.17478237501561, -1084.8192918899, -3.5549201243625457, -983.2770419589846, -525.8331365589269, -310.2172105649164, -501.1102391892948, 66.07170070710677, -37.14362055186532, -291.72554195536065, -348.3600052564796, -149.87670879318927, -65.4491614872403, -163.6598375841644, -158.87574182350218, -1289.5239590894296, -74.40601593516803, -14.00107619948259, -468.9697098479102, 108.03612446758399, -375.20063537417656, -171.09665900334014, -1041.43477266785, 38.053670528363, -80.45053871047463, -19.70748643001624, -327.04897660294483, -401.8759677945909, 24.432243141793695, -4.003256582443058, -147.03835928513686, 26.460577812280643, 14.509052868500378, -227.5207934989492, -335.6790720976474, -120.42951047768281, -43.774129024283916, -27.224902052802584, 307.4633167542156, -710.746555412369, -146.78738474998872, -1316.0636910512164, -391.83247461670305, -11.53716883301548, -681.0007747886524, 24.175453330227135, -174.04276080195135, -993.8009727715413, 13.570703969395522, -35.9018233792496, -25.195072852495024, -617.0264328705083, -22.67597503643264, -84.10039907549054, -884.5950861356904, -325.34621304716626, -105.82694329749563, -284.5118308834212, -201.19260167207722, -219.96798410853089, -25.56110033200666, -1547.726097544591, -64.50857398041228, -91.94347094703858, -98.5779916690843, -417.5206392431006, 25.284847837342614, -502.8857426292492, -361.29444614092125, -196.9820874615567, 244.62264063390705, -537.1010612177689, -929.8232581331245, -50.11803927013437, -192.84176243735567, -498.3733714512965, -52.16274947106832, -1448.2104117095498, -20.838243600446276, -421.68831201120724, -396.0895769042891, -715.9936719714716, -52.00087012932978, -414.01640823298766, -351.19809475097327, -397.04020860924516, -182.25396970480074, -497.6527917572471, -214.6826889515058, -1173.870119119693, 391.9, -54.71988488174372, -113.89966108506968, -31.005900235042027, -1211.1910073504498, -112.63745011852444, -100.88988762519985, 206.83274397184388, -156.18812702447852, -151.24254614662485, -28.620166161254744, -39.13638237759232, -424.0269790733642, -54.95489294135951, 388.2517354034877, -67.78182282344684, -226.80682323563235, -107.0656603041931, 200.8073521120427, -2.1500998549073356, -890.6251537029748, -73.0203261240484, -460.00968302174806, -497.1306377999669, -89.82642877954254, -463.20564442842993, -132.60120099591552, -113.94279809074487, -400.88204293979294, -97.00801916280881, 16.161965489769976, -36.799005153579266, -837.8798887572201, 33.035570637102445, 23.97284226351379, -382.1326059099092, 35.230794357462344, -122.80071808916702, -245.32733982139317, -788.7568445851963, -105.1539637771773, -452.38654212982954, -100.25104005573988, 398.1056880492409, 18.013322356580414, -1029.2672511692717, -375.57248423480087, -136.35363222863378, -34.448905199531836, -962.8179191540316, -435.2135890622842, -54.59793139084608, -152.70259838484588, 55.55057677811663, -161.85250516239674, -349.7729171177309, -13.882354867494245, -218.7517170370792, -517.2546921127574, -50.52096376253605, -243.89188624208992, 60.22281891872007, -264.1576061676127, -139.91637126803786, 25.212889016363967, 17.783671017259028, -357.2878161666416, -105.02128246378754, -543.9956909611664, -368.6188832130826, -554.6804925170062, 315.6109256636293, -348.4359695844243, 21.690923705551878, -379.3422851664236, -392.7271095318998, -535.225978797584, -280.1590755903729, -708.9750114205226, -106.15650799056073, 15.569589352983025, -39.55034165545788, -106.84582073237763, 36.98632035581255, 98.9714001257929, -203.2853479609039, -5.996164884188289, -314.1986417762221, -486.3033500116913, 6.486734863194762, -28.63923893013626, -339.48343028330834, 376.14204778387676, 2.5846874095723558, -451.1512917270642, -245.08189432129757, -71.35507461569007, -554.1164887521662, -381.70347956531816, -259.1988628084198, -145.53049922196533, -363.46127699676936, -26.062300191581144, -375.51418868362236, -344.3104708732281, -142.5740931655494, -191.60257167603083, 58.54683618829076], "policy_predator_policy_reward": [622.8683435941912, 200.8658847064552, 132.37478237501466, 1102.0192918898845, 111.45192262531194, 986.712929773719, 402.3613065126999, 565.2680380599758, 459.18424576625137, 90.536289244136, 84.97490252273174, 305.2063667254253, 155.406024094477, 412.257424654741, 238.79597453320366, 128.22144233937064, 223.20679690867289, 1289.2059325011387, 104.91003057216392, 52.942671904463815, 270.4303011830782, 376.5047480666486, 386.4040900834523, 213.57927227156563, 1041.83477266785, 13.620431824682058, 116.15053871047292, 54.93790528598018, 334.2532614471853, 429.5559251100148, 14.167756858206353, 41.90325658244338, 167.8365310651554, 67.74628482591079, 23.790947131499657, 254.72079349894764, 359.0703063082394, 227.8171984069736, 78.8596345943387, 70.43617806854476, 228.50583450082203, 658.633823504006, 329.57057116940706, 1255.6530748874009, 397.8342462462863, 232.0932670728322, 704.2007747886577, 34.42454666977293, 1026.3595791401428, 972.383834003987, 74.52437872713155, 0.0, 71.24620554740059, 633.9209199386507, 156.61470411592626, 20.561669995997157, 882.0223990380606, 390.9516823355055, 444.325686757532, 197.5056299792921, 348.75230659893487, 135.73606905100735, 76.139302355345, 1546.6258354389745, 115.11345614184394, 115.11230414371532, 132.07799166908273, 439.0206392431055, 356.4584312626824, 175.4173730281425, 273.32524179894136, 383.79204964971404, 58.267879584706236, 562.0010612177741, 906.3737579758142, 234.62415788077547, 507.46732018732916, 279.3563275319659, 85.36274947106727, 1459.8104117095395, 229.7471840842181, 406.7660793319471, 450.6753522960616, 775.8725056011783, 117.99978885654286, 421.2898361283295, 675.6918531840655, 301.29703295192945, 246.06669959516165, 479.4086602223863, 255.7020197775167, 1180.0987083125538, 0.0, 88.71988488174252, 154.7127013619649, 63.894351628894626, 126.88825135217255, 1253.1827382498964, 151.62598183099644, 183.04489085226402, 166.16793814112287, 276.07861238141, 42.41374201794263, 77.34058097843281, 435.8078868655362, 189.56488201408627, 63.41028774682486, 101.72338749366196, 240.97518271900287, 180.77163468743953, 35.69469781924871, 44.811079818557836, 907.5492384464129, 92.69969608988283, 632.2899817405114, 351.5169712916827, 184.10211384183395, 476.1748879253433, 164.90120099591368, 147.94279809074294, 300.4107959113474, 398.53717410872343, 22.138034510230025, 72.59900515357917, 817.8830242201459, 109.9046486526573, 14.927157736486247, 411.6326059099157, 53.98841878772546, 143.31723551971274, 174.0245712334238, 816.382615339888, 203.32814021335128, 480.12545956187273, 98.48486158707131, 124.94882974469995, 20.686677643419593, 1038.1672511692657, 387.1836816131405, 191.66997430300717, 131.22958504847466, 945.6662270820959, 463.18942682415246, 85.24793139084485, 187.7025983848439, 250.0494232218833, 299.10062814740644, 587.1496916329779, 225.15046843739847, 393.5650729442323, 703.2173854096945, 103.93341942947457, 319.1633986686542, 99.12740682470498, 286.4576061676167, 167.11637126803632, 13.787110983636092, 20.41632898274098, 382.6878161666474, 139.62128246378558, 541.0409318239067, 535.0189397221085, 327.3341609514854, 324.9655602704302, 319.4421988993636, 92.12276833140587, 380.76783574546704, 536.1950720412256, 696.614270522953, 147.46825197311523, 648.9803579493865, 330.9393343674391, 22.63041064701699, 75.95034165545769, 137.84582073237587, 3.5975631206708867, 63.78194139806979, 245.53200643704, 226.64806538630924, 213.66221048800222, 391.8437356640783, 234.37135977803194, 369.016303949934, 333.80846233096486, 3.757952216123224, 34.215312590427864, 209.71842191689547, 522.5293789601017, 343.3734224490698, 361.2425472377078, 483.4268814274001, 387.12236221294836, 299.13914322847455, 380.4412959164293, 371.5617971710717, 97.9445602603676, 408.25626637858363, 178.83328760247755, 222.02189630675628, 10.690477233528133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9046692054965835, "mean_inference_ms": 4.551931632936364, "mean_action_processing_ms": 1.500506508349584, "mean_env_wait_ms": 10.652169833228415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014784812927246094, "StateBufferConnector_ms": 0.006426215171813965, "ViewRequirementAgentConnector_ms": 0.20695710182189941}, "num_episodes": 11, "episode_return_max": 830.8996795706444, "episode_return_min": -43.67699783327669, "episode_return_mean": 146.60313671004894, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.53911029067888, "num_env_steps_trained_throughput_per_sec": 75.53911029067888, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 68815.815, "restore_workers_time_ms": 0.017, "training_step_time_ms": 68815.739, "sample_time_ms": 3074.157, "learn_time_ms": 65714.758, "learn_throughput": 60.869, "synch_weights_time_ms": 21.709}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "35fb9_00000", "date": "2024-08-22_09-20-29", "timestamp": 1724298629, "time_this_iter_s": 52.98790788650513, "time_total_s": 5206.082987785339, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b5e7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5206.082987785339, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 35.13733333333333, "ram_util_percent": 82.60933333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.91546665852663, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.8013301415418193, "policy_loss": -0.016649651660450866, "vf_loss": 3.8162029343307333, "vf_explained_var": 0.500478099389051, "kl": 0.00888425917684953, "entropy": 0.8154831533078795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.508370206217286, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.5907065209888276, "policy_loss": -0.024617979577225117, "vf_loss": 3.6128166633938985, "vf_explained_var": 0.285072547386563, "kl": 0.012539181484786607, "entropy": 0.5838220854915639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 830.8996795706444, "episode_reward_min": -131.35493925864745, "episode_reward_mean": 151.2662068150568, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1547.726097544591, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.1056880492409, "predator_policy": 1546.6258354389745}, "policy_reward_mean": {"prey_policy": -240.16749760248888, "predator_policy": 315.80060101001783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.68606797750017, 52.074102353045205, 70.93041885596368, 34.88424215965815, 76.49999999999993, 115.00503441820858, 65.50000000000055, 130.77892213987656, 78.29678158579691, 483.85641934667444, 122.37257025560491, 226.5578698693928, 81.79999999999954, 830.8996795706444, 52.193259317277935, 62.94561976304472, 70.40000000000026, 63.03278219070302, 251.49254255590134, 63.32778986933799, 49.47793991772259, 73.77371535811189, 55.00000000000054, 54.27490949891673, 98.84075784617615, 327.7905202186138, 161.05661845332978, 95.60851383064144, 44.80000000000037, 193.98670780450567, 114.4646090214728, 73.27234662255026, 228.75058277576963, 45.568598355500185, 47.24792001887298, 425.90000000000254, 73.70149167074884, 56.242532133097264, 440.61372902990956, 134.8158773514298, 51.99777445752859, 146.39089686489342, 485.60358782053345, 87.87433386661934, 279.1630298949465, 36.603454709272825, 26.666632210479058, 107.24492855919759, 66.30000000000051, 201.05790791746543, 74.10000000000007, 122.94335475267879, 68.40000000000039, 109.73573057573265, -43.67699783327669, 125.91309386821109, 521.2883393252789, 47.600000000000406, 66.92753945270947, 79.62898777700381, 58.625837761863615, 340.60000000000076, 374.6248975002572, 386.08146947706155, 239.37514896387552, 234.62173816998924, 49.50000000000043, 77.19999999999989, 60.00000000000059, 163.44529737176026, 413.230154368537, 84.81992135188995, 144.89351308835518, 28.697468108106662, 164.78817290574207, 74.60000000000004, 71.5838834764834, 204.9999999999995, 120.1154692138981, 146.39848029360851, 334.7020970674512, 416.70000000000243, 36.014614828633526, 79.14440631892272, 229.6469012666065, 170.5886629261644, 67.92986855623137, 100.20498994227675, 99.65663805254398, 254.77616211160407, -131.35493925864745, 83.08850562719526, 108.30575329552448, 657.9964006226248, 78.02725740465874, 39.43203605286373, 264.4548275627366, 42.39246591268474, 107.14441496669367, 206.08409984219833], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-375.20063537417656, -171.09665900334014, -1041.43477266785, 38.053670528363, -80.45053871047463, -19.70748643001624, -327.04897660294483, -401.8759677945909, 24.432243141793695, -4.003256582443058, -147.03835928513686, 26.460577812280643, 14.509052868500378, -227.5207934989492, -335.6790720976474, -120.42951047768281, -43.774129024283916, -27.224902052802584, 307.4633167542156, -710.746555412369, -146.78738474998872, -1316.0636910512164, -391.83247461670305, -11.53716883301548, -681.0007747886524, 24.175453330227135, -174.04276080195135, -993.8009727715413, 13.570703969395522, -35.9018233792496, -25.195072852495024, -617.0264328705083, -22.67597503643264, -84.10039907549054, -884.5950861356904, -325.34621304716626, -105.82694329749563, -284.5118308834212, -201.19260167207722, -219.96798410853089, -25.56110033200666, -1547.726097544591, -64.50857398041228, -91.94347094703858, -98.5779916690843, -417.5206392431006, 25.284847837342614, -502.8857426292492, -361.29444614092125, -196.9820874615567, 244.62264063390705, -537.1010612177689, -929.8232581331245, -50.11803927013437, -192.84176243735567, -498.3733714512965, -52.16274947106832, -1448.2104117095498, -20.838243600446276, -421.68831201120724, -396.0895769042891, -715.9936719714716, -52.00087012932978, -414.01640823298766, -351.19809475097327, -397.04020860924516, -182.25396970480074, -497.6527917572471, -214.6826889515058, -1173.870119119693, 391.9, -54.71988488174372, -113.89966108506968, -31.005900235042027, -1211.1910073504498, -112.63745011852444, -100.88988762519985, 206.83274397184388, -156.18812702447852, -151.24254614662485, -28.620166161254744, -39.13638237759232, -424.0269790733642, -54.95489294135951, 388.2517354034877, -67.78182282344684, -226.80682323563235, -107.0656603041931, 200.8073521120427, -2.1500998549073356, -890.6251537029748, -73.0203261240484, -460.00968302174806, -497.1306377999669, -89.82642877954254, -463.20564442842993, -132.60120099591552, -113.94279809074487, -400.88204293979294, -97.00801916280881, 16.161965489769976, -36.799005153579266, -837.8798887572201, 33.035570637102445, 23.97284226351379, -382.1326059099092, 35.230794357462344, -122.80071808916702, -245.32733982139317, -788.7568445851963, -105.1539637771773, -452.38654212982954, -100.25104005573988, 398.1056880492409, 18.013322356580414, -1029.2672511692717, -375.57248423480087, -136.35363222863378, -34.448905199531836, -962.8179191540316, -435.2135890622842, -54.59793139084608, -152.70259838484588, 55.55057677811663, -161.85250516239674, -349.7729171177309, -13.882354867494245, -218.7517170370792, -517.2546921127574, -50.52096376253605, -243.89188624208992, 60.22281891872007, -264.1576061676127, -139.91637126803786, 25.212889016363967, 17.783671017259028, -357.2878161666416, -105.02128246378754, -543.9956909611664, -368.6188832130826, -554.6804925170062, 315.6109256636293, -348.4359695844243, 21.690923705551878, -379.3422851664236, -392.7271095318998, -535.225978797584, -280.1590755903729, -708.9750114205226, -106.15650799056073, 15.569589352983025, -39.55034165545788, -106.84582073237763, 36.98632035581255, 98.9714001257929, -203.2853479609039, -5.996164884188289, -314.1986417762221, -486.3033500116913, 6.486734863194762, -28.63923893013626, -339.48343028330834, 376.14204778387676, 2.5846874095723558, -451.1512917270642, -245.08189432129757, -71.35507461569007, -554.1164887521662, -381.70347956531816, -259.1988628084198, -145.53049922196533, -363.46127699676936, -26.062300191581144, -375.51418868362236, -344.3104708732281, -142.5740931655494, -191.60257167603083, 58.54683618829076, -276.9150927395951, -488.7013784802857, -578.7224108163156, -444.81921921806475, -533.0944636416779, -336.5970279052859, -177.12112685231762, -340.2460634022517, 246.92547140198616, 181.56107835131857, -119.46736321738891, -2.523696138233673, -312.5602748731448, -192.36105911619225, -238.53506914422226, -198.83050153346937, -353.92331604593693, -270.43299806515006, -83.09597161058277, -133.70280542898385, -39.19616479694644, -386.1676141909618], "policy_predator_policy_reward": [386.4040900834523, 213.57927227156563, 1041.83477266785, 13.620431824682058, 116.15053871047292, 54.93790528598018, 334.2532614471853, 429.5559251100148, 14.167756858206353, 41.90325658244338, 167.8365310651554, 67.74628482591079, 23.790947131499657, 254.72079349894764, 359.0703063082394, 227.8171984069736, 78.8596345943387, 70.43617806854476, 228.50583450082203, 658.633823504006, 329.57057116940706, 1255.6530748874009, 397.8342462462863, 232.0932670728322, 704.2007747886577, 34.42454666977293, 1026.3595791401428, 972.383834003987, 74.52437872713155, 0.0, 71.24620554740059, 633.9209199386507, 156.61470411592626, 20.561669995997157, 882.0223990380606, 390.9516823355055, 444.325686757532, 197.5056299792921, 348.75230659893487, 135.73606905100735, 76.139302355345, 1546.6258354389745, 115.11345614184394, 115.11230414371532, 132.07799166908273, 439.0206392431055, 356.4584312626824, 175.4173730281425, 273.32524179894136, 383.79204964971404, 58.267879584706236, 562.0010612177741, 906.3737579758142, 234.62415788077547, 507.46732018732916, 279.3563275319659, 85.36274947106727, 1459.8104117095395, 229.7471840842181, 406.7660793319471, 450.6753522960616, 775.8725056011783, 117.99978885654286, 421.2898361283295, 675.6918531840655, 301.29703295192945, 246.06669959516165, 479.4086602223863, 255.7020197775167, 1180.0987083125538, 0.0, 88.71988488174252, 154.7127013619649, 63.894351628894626, 126.88825135217255, 1253.1827382498964, 151.62598183099644, 183.04489085226402, 166.16793814112287, 276.07861238141, 42.41374201794263, 77.34058097843281, 435.8078868655362, 189.56488201408627, 63.41028774682486, 101.72338749366196, 240.97518271900287, 180.77163468743953, 35.69469781924871, 44.811079818557836, 907.5492384464129, 92.69969608988283, 632.2899817405114, 351.5169712916827, 184.10211384183395, 476.1748879253433, 164.90120099591368, 147.94279809074294, 300.4107959113474, 398.53717410872343, 22.138034510230025, 72.59900515357917, 817.8830242201459, 109.9046486526573, 14.927157736486247, 411.6326059099157, 53.98841878772546, 143.31723551971274, 174.0245712334238, 816.382615339888, 203.32814021335128, 480.12545956187273, 98.48486158707131, 124.94882974469995, 20.686677643419593, 1038.1672511692657, 387.1836816131405, 191.66997430300717, 131.22958504847466, 945.6662270820959, 463.18942682415246, 85.24793139084485, 187.7025983848439, 250.0494232218833, 299.10062814740644, 587.1496916329779, 225.15046843739847, 393.5650729442323, 703.2173854096945, 103.93341942947457, 319.1633986686542, 99.12740682470498, 286.4576061676167, 167.11637126803632, 13.787110983636092, 20.41632898274098, 382.6878161666474, 139.62128246378558, 541.0409318239067, 535.0189397221085, 327.3341609514854, 324.9655602704302, 319.4421988993636, 92.12276833140587, 380.76783574546704, 536.1950720412256, 696.614270522953, 147.46825197311523, 648.9803579493865, 330.9393343674391, 22.63041064701699, 75.95034165545769, 137.84582073237587, 3.5975631206708867, 63.78194139806979, 245.53200643704, 226.64806538630924, 213.66221048800222, 391.8437356640783, 234.37135977803194, 369.016303949934, 333.80846233096486, 3.757952216123224, 34.215312590427864, 209.71842191689547, 522.5293789601017, 343.3734224490698, 361.2425472377078, 483.4268814274001, 387.12236221294836, 299.13914322847455, 380.4412959164293, 371.5617971710717, 97.9445602603676, 408.25626637858363, 178.83328760247755, 222.02189630675628, 10.690477233528133, 539.2402971218069, 481.15233620967797, 534.3586868684517, 357.8280039072823, 542.1286568772243, 410.6513402969389, 269.6790807204423, 355.99386282965725, 91.07092922063859, 138.43892164868137, 132.60104338140317, 67.41727337887713, 315.2742619990711, 229.0791080431315, 376.1245776617765, 325.69582057864915, 347.6439023917779, 319.1048776320002, 0.0, 323.9431920062587, 323.94655787253186, 307.5013209575756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.921317600212267, "mean_inference_ms": 4.56537681230549, "mean_action_processing_ms": 1.4918917023472256, "mean_env_wait_ms": 10.663671007373816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014135122299194336, "StateBufferConnector_ms": 0.00510096549987793, "ViewRequirementAgentConnector_ms": 0.2296353578567505}, "num_episodes": 11, "episode_return_max": 830.8996795706444, "episode_return_min": -131.35493925864745, "episode_return_mean": 151.2662068150568, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.53897013501823, "num_env_steps_trained_throughput_per_sec": 82.53897013501823, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 68413.161, "restore_workers_time_ms": 0.016, "training_step_time_ms": 68413.084, "sample_time_ms": 3007.861, "learn_time_ms": 65379.692, "learn_throughput": 61.181, "synch_weights_time_ms": 20.497}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "35fb9_00000", "date": "2024-08-22_09-21-17", "timestamp": 1724298677, "time_this_iter_s": 48.50967073440552, "time_total_s": 5254.592658519745, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b630430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5254.592658519745, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 27.926086956521733, "ram_util_percent": 82.92173913043479}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.055614238062862, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.5482701108569192, "policy_loss": -0.019087896906652503, "vf_loss": 3.5655039973990625, "vf_explained_var": 0.5858784562065488, "kl": 0.009270052247121437, "entropy": 0.8166271385061677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.650109585315462, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.720010600771223, "policy_loss": -0.02568837482588139, "vf_loss": 3.7431075663793654, "vf_explained_var": 0.33486207102341625, "kl": 0.012957105434144892, "entropy": 0.5826060433394064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 830.8996795706444, "episode_reward_min": -131.35493925864745, "episode_reward_mean": 154.5005604263092, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1547.726097544591, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.1056880492409, "predator_policy": 1546.6258354389745}, "policy_reward_mean": {"prey_policy": -241.35352461593953, "predator_policy": 318.6038048290948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.29678158579691, 483.85641934667444, 122.37257025560491, 226.5578698693928, 81.79999999999954, 830.8996795706444, 52.193259317277935, 62.94561976304472, 70.40000000000026, 63.03278219070302, 251.49254255590134, 63.32778986933799, 49.47793991772259, 73.77371535811189, 55.00000000000054, 54.27490949891673, 98.84075784617615, 327.7905202186138, 161.05661845332978, 95.60851383064144, 44.80000000000037, 193.98670780450567, 114.4646090214728, 73.27234662255026, 228.75058277576963, 45.568598355500185, 47.24792001887298, 425.90000000000254, 73.70149167074884, 56.242532133097264, 440.61372902990956, 134.8158773514298, 51.99777445752859, 146.39089686489342, 485.60358782053345, 87.87433386661934, 279.1630298949465, 36.603454709272825, 26.666632210479058, 107.24492855919759, 66.30000000000051, 201.05790791746543, 74.10000000000007, 122.94335475267879, 68.40000000000039, 109.73573057573265, -43.67699783327669, 125.91309386821109, 521.2883393252789, 47.600000000000406, 66.92753945270947, 79.62898777700381, 58.625837761863615, 340.60000000000076, 374.6248975002572, 386.08146947706155, 239.37514896387552, 234.62173816998924, 49.50000000000043, 77.19999999999989, 60.00000000000059, 163.44529737176026, 413.230154368537, 84.81992135188995, 144.89351308835518, 28.697468108106662, 164.78817290574207, 74.60000000000004, 71.5838834764834, 204.9999999999995, 120.1154692138981, 146.39848029360851, 334.7020970674512, 416.70000000000243, 36.014614828633526, 79.14440631892272, 229.6469012666065, 170.5886629261644, 67.92986855623137, 100.20498994227675, 99.65663805254398, 254.77616211160407, -131.35493925864745, 83.08850562719526, 108.30575329552448, 657.9964006226248, 78.02725740465874, 39.43203605286373, 264.4548275627366, 42.39246591268474, 107.14441496669367, 206.08409984219833, 54.84283478454476, 55.40000000000052, 404.6000000000021, 183.05494382374377, 49.26309298541025, 47.19654529072786, 74.70071452503726, 53.73601762002983], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-43.774129024283916, -27.224902052802584, 307.4633167542156, -710.746555412369, -146.78738474998872, -1316.0636910512164, -391.83247461670305, -11.53716883301548, -681.0007747886524, 24.175453330227135, -174.04276080195135, -993.8009727715413, 13.570703969395522, -35.9018233792496, -25.195072852495024, -617.0264328705083, -22.67597503643264, -84.10039907549054, -884.5950861356904, -325.34621304716626, -105.82694329749563, -284.5118308834212, -201.19260167207722, -219.96798410853089, -25.56110033200666, -1547.726097544591, -64.50857398041228, -91.94347094703858, -98.5779916690843, -417.5206392431006, 25.284847837342614, -502.8857426292492, -361.29444614092125, -196.9820874615567, 244.62264063390705, -537.1010612177689, -929.8232581331245, -50.11803927013437, -192.84176243735567, -498.3733714512965, -52.16274947106832, -1448.2104117095498, -20.838243600446276, -421.68831201120724, -396.0895769042891, -715.9936719714716, -52.00087012932978, -414.01640823298766, -351.19809475097327, -397.04020860924516, -182.25396970480074, -497.6527917572471, -214.6826889515058, -1173.870119119693, 391.9, -54.71988488174372, -113.89966108506968, -31.005900235042027, -1211.1910073504498, -112.63745011852444, -100.88988762519985, 206.83274397184388, -156.18812702447852, -151.24254614662485, -28.620166161254744, -39.13638237759232, -424.0269790733642, -54.95489294135951, 388.2517354034877, -67.78182282344684, -226.80682323563235, -107.0656603041931, 200.8073521120427, -2.1500998549073356, -890.6251537029748, -73.0203261240484, -460.00968302174806, -497.1306377999669, -89.82642877954254, -463.20564442842993, -132.60120099591552, -113.94279809074487, -400.88204293979294, -97.00801916280881, 16.161965489769976, -36.799005153579266, -837.8798887572201, 33.035570637102445, 23.97284226351379, -382.1326059099092, 35.230794357462344, -122.80071808916702, -245.32733982139317, -788.7568445851963, -105.1539637771773, -452.38654212982954, -100.25104005573988, 398.1056880492409, 18.013322356580414, -1029.2672511692717, -375.57248423480087, -136.35363222863378, -34.448905199531836, -962.8179191540316, -435.2135890622842, -54.59793139084608, -152.70259838484588, 55.55057677811663, -161.85250516239674, -349.7729171177309, -13.882354867494245, -218.7517170370792, -517.2546921127574, -50.52096376253605, -243.89188624208992, 60.22281891872007, -264.1576061676127, -139.91637126803786, 25.212889016363967, 17.783671017259028, -357.2878161666416, -105.02128246378754, -543.9956909611664, -368.6188832130826, -554.6804925170062, 315.6109256636293, -348.4359695844243, 21.690923705551878, -379.3422851664236, -392.7271095318998, -535.225978797584, -280.1590755903729, -708.9750114205226, -106.15650799056073, 15.569589352983025, -39.55034165545788, -106.84582073237763, 36.98632035581255, 98.9714001257929, -203.2853479609039, -5.996164884188289, -314.1986417762221, -486.3033500116913, 6.486734863194762, -28.63923893013626, -339.48343028330834, 376.14204778387676, 2.5846874095723558, -451.1512917270642, -245.08189432129757, -71.35507461569007, -554.1164887521662, -381.70347956531816, -259.1988628084198, -145.53049922196533, -363.46127699676936, -26.062300191581144, -375.51418868362236, -344.3104708732281, -142.5740931655494, -191.60257167603083, 58.54683618829076, -276.9150927395951, -488.7013784802857, -578.7224108163156, -444.81921921806475, -533.0944636416779, -336.5970279052859, -177.12112685231762, -340.2460634022517, 246.92547140198616, 181.56107835131857, -119.46736321738891, -2.523696138233673, -312.5602748731448, -192.36105911619225, -238.53506914422226, -198.83050153346937, -353.92331604593693, -270.43299806515006, -83.09597161058277, -133.70280542898385, -39.19616479694644, -386.1676141909618, -309.2805950522651, -188.01747593216436, -510.64357665371324, -144.96643785377242, 316.50103873583475, -6.680260760883019, -135.55649467219732, 132.2452589451011, -357.5305426864023, -333.96473330308464, -192.3386555428621, -443.005569181945, -453.4495399240564, -26.70784376866088, -239.60512984560938, -492.2353293677752], "policy_predator_policy_reward": [78.8596345943387, 70.43617806854476, 228.50583450082203, 658.633823504006, 329.57057116940706, 1255.6530748874009, 397.8342462462863, 232.0932670728322, 704.2007747886577, 34.42454666977293, 1026.3595791401428, 972.383834003987, 74.52437872713155, 0.0, 71.24620554740059, 633.9209199386507, 156.61470411592626, 20.561669995997157, 882.0223990380606, 390.9516823355055, 444.325686757532, 197.5056299792921, 348.75230659893487, 135.73606905100735, 76.139302355345, 1546.6258354389745, 115.11345614184394, 115.11230414371532, 132.07799166908273, 439.0206392431055, 356.4584312626824, 175.4173730281425, 273.32524179894136, 383.79204964971404, 58.267879584706236, 562.0010612177741, 906.3737579758142, 234.62415788077547, 507.46732018732916, 279.3563275319659, 85.36274947106727, 1459.8104117095395, 229.7471840842181, 406.7660793319471, 450.6753522960616, 775.8725056011783, 117.99978885654286, 421.2898361283295, 675.6918531840655, 301.29703295192945, 246.06669959516165, 479.4086602223863, 255.7020197775167, 1180.0987083125538, 0.0, 88.71988488174252, 154.7127013619649, 63.894351628894626, 126.88825135217255, 1253.1827382498964, 151.62598183099644, 183.04489085226402, 166.16793814112287, 276.07861238141, 42.41374201794263, 77.34058097843281, 435.8078868655362, 189.56488201408627, 63.41028774682486, 101.72338749366196, 240.97518271900287, 180.77163468743953, 35.69469781924871, 44.811079818557836, 907.5492384464129, 92.69969608988283, 632.2899817405114, 351.5169712916827, 184.10211384183395, 476.1748879253433, 164.90120099591368, 147.94279809074294, 300.4107959113474, 398.53717410872343, 22.138034510230025, 72.59900515357917, 817.8830242201459, 109.9046486526573, 14.927157736486247, 411.6326059099157, 53.98841878772546, 143.31723551971274, 174.0245712334238, 816.382615339888, 203.32814021335128, 480.12545956187273, 98.48486158707131, 124.94882974469995, 20.686677643419593, 1038.1672511692657, 387.1836816131405, 191.66997430300717, 131.22958504847466, 945.6662270820959, 463.18942682415246, 85.24793139084485, 187.7025983848439, 250.0494232218833, 299.10062814740644, 587.1496916329779, 225.15046843739847, 393.5650729442323, 703.2173854096945, 103.93341942947457, 319.1633986686542, 99.12740682470498, 286.4576061676167, 167.11637126803632, 13.787110983636092, 20.41632898274098, 382.6878161666474, 139.62128246378558, 541.0409318239067, 535.0189397221085, 327.3341609514854, 324.9655602704302, 319.4421988993636, 92.12276833140587, 380.76783574546704, 536.1950720412256, 696.614270522953, 147.46825197311523, 648.9803579493865, 330.9393343674391, 22.63041064701699, 75.95034165545769, 137.84582073237587, 3.5975631206708867, 63.78194139806979, 245.53200643704, 226.64806538630924, 213.66221048800222, 391.8437356640783, 234.37135977803194, 369.016303949934, 333.80846233096486, 3.757952216123224, 34.215312590427864, 209.71842191689547, 522.5293789601017, 343.3734224490698, 361.2425472377078, 483.4268814274001, 387.12236221294836, 299.13914322847455, 380.4412959164293, 371.5617971710717, 97.9445602603676, 408.25626637858363, 178.83328760247755, 222.02189630675628, 10.690477233528133, 539.2402971218069, 481.15233620967797, 534.3586868684517, 357.8280039072823, 542.1286568772243, 410.6513402969389, 269.6790807204423, 355.99386282965725, 91.07092922063859, 138.43892164868137, 132.60104338140317, 67.41727337887713, 315.2742619990711, 229.0791080431315, 376.1245776617765, 325.69582057864915, 347.6439023917779, 319.1048776320002, 0.0, 323.9431920062587, 323.94655787253186, 307.5013209575756, 303.57484887470423, 248.56605689427226, 534.7435766537187, 176.26643785377064, 51.39896126416527, 43.380260760883374, 34.831524303603835, 151.53465524723504, 70.77101815224037, 669.9873508226626, 224.43520083358806, 458.10556918194754, 225.480862640263, 329.37723557749354, 268.43567539390403, 517.140801439517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9202444890266, "mean_inference_ms": 4.562891111791283, "mean_action_processing_ms": 1.5036467768092783, "mean_env_wait_ms": 10.659176041524496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014158844947814941, "StateBufferConnector_ms": 0.005086183547973633, "ViewRequirementAgentConnector_ms": 0.2317647933959961}, "num_episodes": 8, "episode_return_max": 830.8996795706444, "episode_return_min": -131.35493925864745, "episode_return_mean": 154.5005604263092, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.58504717108208, "num_env_steps_trained_throughput_per_sec": 81.58504717108208, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 68429.688, "restore_workers_time_ms": 0.016, "training_step_time_ms": 68429.621, "sample_time_ms": 2965.043, "learn_time_ms": 65437.755, "learn_throughput": 61.127, "synch_weights_time_ms": 21.002}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "35fb9_00000", "date": "2024-08-22_09-22-07", "timestamp": 1724298727, "time_this_iter_s": 49.061731815338135, "time_total_s": 5303.654390335083, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc8ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5303.654390335083, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 29.231428571428577, "ram_util_percent": 83.00428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.979699561835595, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.581655502697778, "policy_loss": -0.018476244879679547, "vf_loss": 3.597486178837125, "vf_explained_var": 0.4024304276736325, "kl": 0.013227860942894406, "entropy": 0.849666682689909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.623605756532578, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.2845359621855317, "policy_loss": -0.03018208875828398, "vf_loss": 3.3119159533863978, "vf_explained_var": 0.17266329533208616, "kl": 0.014010395159915326, "entropy": 0.59239405458251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 657.9964006226248, "episode_reward_min": -131.35493925864745, "episode_reward_mean": 149.17265225297183, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1448.2104117095498, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 1459.8104117095395}, "policy_reward_mean": {"prey_policy": -227.21120507288558, "predator_policy": 301.79753119937214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.00000000000054, 54.27490949891673, 98.84075784617615, 327.7905202186138, 161.05661845332978, 95.60851383064144, 44.80000000000037, 193.98670780450567, 114.4646090214728, 73.27234662255026, 228.75058277576963, 45.568598355500185, 47.24792001887298, 425.90000000000254, 73.70149167074884, 56.242532133097264, 440.61372902990956, 134.8158773514298, 51.99777445752859, 146.39089686489342, 485.60358782053345, 87.87433386661934, 279.1630298949465, 36.603454709272825, 26.666632210479058, 107.24492855919759, 66.30000000000051, 201.05790791746543, 74.10000000000007, 122.94335475267879, 68.40000000000039, 109.73573057573265, -43.67699783327669, 125.91309386821109, 521.2883393252789, 47.600000000000406, 66.92753945270947, 79.62898777700381, 58.625837761863615, 340.60000000000076, 374.6248975002572, 386.08146947706155, 239.37514896387552, 234.62173816998924, 49.50000000000043, 77.19999999999989, 60.00000000000059, 163.44529737176026, 413.230154368537, 84.81992135188995, 144.89351308835518, 28.697468108106662, 164.78817290574207, 74.60000000000004, 71.5838834764834, 204.9999999999995, 120.1154692138981, 146.39848029360851, 334.7020970674512, 416.70000000000243, 36.014614828633526, 79.14440631892272, 229.6469012666065, 170.5886629261644, 67.92986855623137, 100.20498994227675, 99.65663805254398, 254.77616211160407, -131.35493925864745, 83.08850562719526, 108.30575329552448, 657.9964006226248, 78.02725740465874, 39.43203605286373, 264.4548275627366, 42.39246591268474, 107.14441496669367, 206.08409984219833, 54.84283478454476, 55.40000000000052, 404.6000000000021, 183.05494382374377, 49.26309298541025, 47.19654529072786, 74.70071452503726, 53.73601762002983, 137.06154509635175, 298.8433224665131, 425.0000000000029, 18.703454709272663, 347.1921418542746, 63.40549289872996, 256.17139615483416, -13.368082827401498, 66.5560133221836, 86.00378716901443, 67.37301798954434, 57.116987167442865, 47.88839291377256, 119.68868335194013], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-98.5779916690843, -417.5206392431006, 25.284847837342614, -502.8857426292492, -361.29444614092125, -196.9820874615567, 244.62264063390705, -537.1010612177689, -929.8232581331245, -50.11803927013437, -192.84176243735567, -498.3733714512965, -52.16274947106832, -1448.2104117095498, -20.838243600446276, -421.68831201120724, -396.0895769042891, -715.9936719714716, -52.00087012932978, -414.01640823298766, -351.19809475097327, -397.04020860924516, -182.25396970480074, -497.6527917572471, -214.6826889515058, -1173.870119119693, 391.9, -54.71988488174372, -113.89966108506968, -31.005900235042027, -1211.1910073504498, -112.63745011852444, -100.88988762519985, 206.83274397184388, -156.18812702447852, -151.24254614662485, -28.620166161254744, -39.13638237759232, -424.0269790733642, -54.95489294135951, 388.2517354034877, -67.78182282344684, -226.80682323563235, -107.0656603041931, 200.8073521120427, -2.1500998549073356, -890.6251537029748, -73.0203261240484, -460.00968302174806, -497.1306377999669, -89.82642877954254, -463.20564442842993, -132.60120099591552, -113.94279809074487, -400.88204293979294, -97.00801916280881, 16.161965489769976, -36.799005153579266, -837.8798887572201, 33.035570637102445, 23.97284226351379, -382.1326059099092, 35.230794357462344, -122.80071808916702, -245.32733982139317, -788.7568445851963, -105.1539637771773, -452.38654212982954, -100.25104005573988, 398.1056880492409, 18.013322356580414, -1029.2672511692717, -375.57248423480087, -136.35363222863378, -34.448905199531836, -962.8179191540316, -435.2135890622842, -54.59793139084608, -152.70259838484588, 55.55057677811663, -161.85250516239674, -349.7729171177309, -13.882354867494245, -218.7517170370792, -517.2546921127574, -50.52096376253605, -243.89188624208992, 60.22281891872007, -264.1576061676127, -139.91637126803786, 25.212889016363967, 17.783671017259028, -357.2878161666416, -105.02128246378754, -543.9956909611664, -368.6188832130826, -554.6804925170062, 315.6109256636293, -348.4359695844243, 21.690923705551878, -379.3422851664236, -392.7271095318998, -535.225978797584, -280.1590755903729, -708.9750114205226, -106.15650799056073, 15.569589352983025, -39.55034165545788, -106.84582073237763, 36.98632035581255, 98.9714001257929, -203.2853479609039, -5.996164884188289, -314.1986417762221, -486.3033500116913, 6.486734863194762, -28.63923893013626, -339.48343028330834, 376.14204778387676, 2.5846874095723558, -451.1512917270642, -245.08189432129757, -71.35507461569007, -554.1164887521662, -381.70347956531816, -259.1988628084198, -145.53049922196533, -363.46127699676936, -26.062300191581144, -375.51418868362236, -344.3104708732281, -142.5740931655494, -191.60257167603083, 58.54683618829076, -276.9150927395951, -488.7013784802857, -578.7224108163156, -444.81921921806475, -533.0944636416779, -336.5970279052859, -177.12112685231762, -340.2460634022517, 246.92547140198616, 181.56107835131857, -119.46736321738891, -2.523696138233673, -312.5602748731448, -192.36105911619225, -238.53506914422226, -198.83050153346937, -353.92331604593693, -270.43299806515006, -83.09597161058277, -133.70280542898385, -39.19616479694644, -386.1676141909618, -309.2805950522651, -188.01747593216436, -510.64357665371324, -144.96643785377242, 316.50103873583475, -6.680260760883019, -135.55649467219732, 132.2452589451011, -357.5305426864023, -333.96473330308464, -192.3386555428621, -443.005569181945, -453.4495399240564, -26.70784376866088, -239.60512984560938, -492.2353293677752, -49.77005697547682, -332.41274388348967, 145.42823020817238, -133.40945481068252, -178.65168761588387, 399.1, -380.8134396228005, -453.9858173025338, 106.33826821702178, -353.9479624473666, -77.334231138548, -109.05366318440363, 102.45846377118002, -136.95507600174003, -407.02667014953664, -843.7495374560265, -211.42195549350504, -124.2560329382134, -18.147821312892795, -323.6921778491348, -77.40839946911103, -683.6002623465154, -336.51408693262755, -267.6555656374989, -368.80629745541626, -87.86140998746852, -157.71477658778255, -498.3528721982186], "policy_predator_policy_reward": [132.07799166908273, 439.0206392431055, 356.4584312626824, 175.4173730281425, 273.32524179894136, 383.79204964971404, 58.267879584706236, 562.0010612177741, 906.3737579758142, 234.62415788077547, 507.46732018732916, 279.3563275319659, 85.36274947106727, 1459.8104117095395, 229.7471840842181, 406.7660793319471, 450.6753522960616, 775.8725056011783, 117.99978885654286, 421.2898361283295, 675.6918531840655, 301.29703295192945, 246.06669959516165, 479.4086602223863, 255.7020197775167, 1180.0987083125538, 0.0, 88.71988488174252, 154.7127013619649, 63.894351628894626, 126.88825135217255, 1253.1827382498964, 151.62598183099644, 183.04489085226402, 166.16793814112287, 276.07861238141, 42.41374201794263, 77.34058097843281, 435.8078868655362, 189.56488201408627, 63.41028774682486, 101.72338749366196, 240.97518271900287, 180.77163468743953, 35.69469781924871, 44.811079818557836, 907.5492384464129, 92.69969608988283, 632.2899817405114, 351.5169712916827, 184.10211384183395, 476.1748879253433, 164.90120099591368, 147.94279809074294, 300.4107959113474, 398.53717410872343, 22.138034510230025, 72.59900515357917, 817.8830242201459, 109.9046486526573, 14.927157736486247, 411.6326059099157, 53.98841878772546, 143.31723551971274, 174.0245712334238, 816.382615339888, 203.32814021335128, 480.12545956187273, 98.48486158707131, 124.94882974469995, 20.686677643419593, 1038.1672511692657, 387.1836816131405, 191.66997430300717, 131.22958504847466, 945.6662270820959, 463.18942682415246, 85.24793139084485, 187.7025983848439, 250.0494232218833, 299.10062814740644, 587.1496916329779, 225.15046843739847, 393.5650729442323, 703.2173854096945, 103.93341942947457, 319.1633986686542, 99.12740682470498, 286.4576061676167, 167.11637126803632, 13.787110983636092, 20.41632898274098, 382.6878161666474, 139.62128246378558, 541.0409318239067, 535.0189397221085, 327.3341609514854, 324.9655602704302, 319.4421988993636, 92.12276833140587, 380.76783574546704, 536.1950720412256, 696.614270522953, 147.46825197311523, 648.9803579493865, 330.9393343674391, 22.63041064701699, 75.95034165545769, 137.84582073237587, 3.5975631206708867, 63.78194139806979, 245.53200643704, 226.64806538630924, 213.66221048800222, 391.8437356640783, 234.37135977803194, 369.016303949934, 333.80846233096486, 3.757952216123224, 34.215312590427864, 209.71842191689547, 522.5293789601017, 343.3734224490698, 361.2425472377078, 483.4268814274001, 387.12236221294836, 299.13914322847455, 380.4412959164293, 371.5617971710717, 97.9445602603676, 408.25626637858363, 178.83328760247755, 222.02189630675628, 10.690477233528133, 539.2402971218069, 481.15233620967797, 534.3586868684517, 357.8280039072823, 542.1286568772243, 410.6513402969389, 269.6790807204423, 355.99386282965725, 91.07092922063859, 138.43892164868137, 132.60104338140317, 67.41727337887713, 315.2742619990711, 229.0791080431315, 376.1245776617765, 325.69582057864915, 347.6439023917779, 319.1048776320002, 0.0, 323.9431920062587, 323.94655787253186, 307.5013209575756, 303.57484887470423, 248.56605689427226, 534.7435766537187, 176.26643785377064, 51.39896126416527, 43.380260760883374, 34.831524303603835, 151.53465524723504, 70.77101815224037, 669.9873508226626, 224.43520083358806, 458.10556918194754, 225.480862640263, 329.37723557749354, 268.43567539390403, 517.140801439517, 111.69781048906528, 407.54653546625576, 164.24339849164153, 122.58114857738012, 204.5516876158824, 0.0, 770.7661557955811, 82.73655583902696, 416.4547357354963, 178.34710034912766, 113.53423113854595, 136.2591560831312, 85.9638753684939, 204.7041330168995, 1042.3719910617924, 195.03613371637343, 82.73126350171417, 319.50273825218414, 85.90160848190872, 341.9421778491392, 219.62964054767986, 608.752039257489, 363.4682458161946, 297.8183939213799, 63.85270012409205, 440.7034002325662, 205.85254591736037, 569.9037862205817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.931074771547535, "mean_inference_ms": 4.582945539285044, "mean_action_processing_ms": 1.4952720465102625, "mean_env_wait_ms": 10.68344563160824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018086910247802734, "StateBufferConnector_ms": 0.004633665084838867, "ViewRequirementAgentConnector_ms": 0.2117077112197876}, "num_episodes": 14, "episode_return_max": 657.9964006226248, "episode_return_min": -131.35493925864745, "episode_return_mean": 149.17265225297183, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.34107160413204, "num_env_steps_trained_throughput_per_sec": 81.34107160413204, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 56729.364, "restore_workers_time_ms": 0.016, "training_step_time_ms": 56729.3, "sample_time_ms": 2956.754, "learn_time_ms": 53749.21, "learn_throughput": 74.42, "synch_weights_time_ms": 17.835}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "35fb9_00000", "date": "2024-08-22_09-22-56", "timestamp": 1724298776, "time_this_iter_s": 49.21578097343445, "time_total_s": 5352.8701713085175, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcda4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5352.8701713085175, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 29.44428571428572, "ram_util_percent": 82.76142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.097422249607305, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.4681576581228346, "policy_loss": -0.021765392156202032, "vf_loss": 3.486966991550708, "vf_explained_var": 0.45394656232425146, "kl": 0.014780281118866274, "entropy": 0.8275553845539295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.83597143163126, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.202807274445024, "policy_loss": -0.02201092393253314, "vf_loss": 3.2227672054654075, "vf_explained_var": 0.272509654867586, "kl": 0.010254968409475786, "entropy": 0.642749347352477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 690.4399824135313, "episode_reward_min": -131.35493925864745, "episode_reward_mean": 152.08941027953554, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1211.1910073504498, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 1253.1827382498964}, "policy_reward_mean": {"prey_policy": -206.7489509400748, "predator_policy": 282.7936560798433}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.70149167074884, 56.242532133097264, 440.61372902990956, 134.8158773514298, 51.99777445752859, 146.39089686489342, 485.60358782053345, 87.87433386661934, 279.1630298949465, 36.603454709272825, 26.666632210479058, 107.24492855919759, 66.30000000000051, 201.05790791746543, 74.10000000000007, 122.94335475267879, 68.40000000000039, 109.73573057573265, -43.67699783327669, 125.91309386821109, 521.2883393252789, 47.600000000000406, 66.92753945270947, 79.62898777700381, 58.625837761863615, 340.60000000000076, 374.6248975002572, 386.08146947706155, 239.37514896387552, 234.62173816998924, 49.50000000000043, 77.19999999999989, 60.00000000000059, 163.44529737176026, 413.230154368537, 84.81992135188995, 144.89351308835518, 28.697468108106662, 164.78817290574207, 74.60000000000004, 71.5838834764834, 204.9999999999995, 120.1154692138981, 146.39848029360851, 334.7020970674512, 416.70000000000243, 36.014614828633526, 79.14440631892272, 229.6469012666065, 170.5886629261644, 67.92986855623137, 100.20498994227675, 99.65663805254398, 254.77616211160407, -131.35493925864745, 83.08850562719526, 108.30575329552448, 657.9964006226248, 78.02725740465874, 39.43203605286373, 264.4548275627366, 42.39246591268474, 107.14441496669367, 206.08409984219833, 54.84283478454476, 55.40000000000052, 404.6000000000021, 183.05494382374377, 49.26309298541025, 47.19654529072786, 74.70071452503726, 53.73601762002983, 137.06154509635175, 298.8433224665131, 425.0000000000029, 18.703454709272663, 347.1921418542746, 63.40549289872996, 256.17139615483416, -13.368082827401498, 66.5560133221836, 86.00378716901443, 67.37301798954434, 57.116987167442865, 47.88839291377256, 119.68868335194013, 78.09999999999984, 161.25915744509743, 648.4576438692284, 51.83975937904582, -23.214362788684138, 64.6000000000006, 3.6517542723939096, -61.58579380815454, 60.396545290728035, 48.681616400240756, 690.4399824135313, 33.21873677792421, 414.0000000000025, 88.39284785136866], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-113.89966108506968, -31.005900235042027, -1211.1910073504498, -112.63745011852444, -100.88988762519985, 206.83274397184388, -156.18812702447852, -151.24254614662485, -28.620166161254744, -39.13638237759232, -424.0269790733642, -54.95489294135951, 388.2517354034877, -67.78182282344684, -226.80682323563235, -107.0656603041931, 200.8073521120427, -2.1500998549073356, -890.6251537029748, -73.0203261240484, -460.00968302174806, -497.1306377999669, -89.82642877954254, -463.20564442842993, -132.60120099591552, -113.94279809074487, -400.88204293979294, -97.00801916280881, 16.161965489769976, -36.799005153579266, -837.8798887572201, 33.035570637102445, 23.97284226351379, -382.1326059099092, 35.230794357462344, -122.80071808916702, -245.32733982139317, -788.7568445851963, -105.1539637771773, -452.38654212982954, -100.25104005573988, 398.1056880492409, 18.013322356580414, -1029.2672511692717, -375.57248423480087, -136.35363222863378, -34.448905199531836, -962.8179191540316, -435.2135890622842, -54.59793139084608, -152.70259838484588, 55.55057677811663, -161.85250516239674, -349.7729171177309, -13.882354867494245, -218.7517170370792, -517.2546921127574, -50.52096376253605, -243.89188624208992, 60.22281891872007, -264.1576061676127, -139.91637126803786, 25.212889016363967, 17.783671017259028, -357.2878161666416, -105.02128246378754, -543.9956909611664, -368.6188832130826, -554.6804925170062, 315.6109256636293, -348.4359695844243, 21.690923705551878, -379.3422851664236, -392.7271095318998, -535.225978797584, -280.1590755903729, -708.9750114205226, -106.15650799056073, 15.569589352983025, -39.55034165545788, -106.84582073237763, 36.98632035581255, 98.9714001257929, -203.2853479609039, -5.996164884188289, -314.1986417762221, -486.3033500116913, 6.486734863194762, -28.63923893013626, -339.48343028330834, 376.14204778387676, 2.5846874095723558, -451.1512917270642, -245.08189432129757, -71.35507461569007, -554.1164887521662, -381.70347956531816, -259.1988628084198, -145.53049922196533, -363.46127699676936, -26.062300191581144, -375.51418868362236, -344.3104708732281, -142.5740931655494, -191.60257167603083, 58.54683618829076, -276.9150927395951, -488.7013784802857, -578.7224108163156, -444.81921921806475, -533.0944636416779, -336.5970279052859, -177.12112685231762, -340.2460634022517, 246.92547140198616, 181.56107835131857, -119.46736321738891, -2.523696138233673, -312.5602748731448, -192.36105911619225, -238.53506914422226, -198.83050153346937, -353.92331604593693, -270.43299806515006, -83.09597161058277, -133.70280542898385, -39.19616479694644, -386.1676141909618, -309.2805950522651, -188.01747593216436, -510.64357665371324, -144.96643785377242, 316.50103873583475, -6.680260760883019, -135.55649467219732, 132.2452589451011, -357.5305426864023, -333.96473330308464, -192.3386555428621, -443.005569181945, -453.4495399240564, -26.70784376866088, -239.60512984560938, -492.2353293677752, -49.77005697547682, -332.41274388348967, 145.42823020817238, -133.40945481068252, -178.65168761588387, 399.1, -380.8134396228005, -453.9858173025338, 106.33826821702178, -353.9479624473666, -77.334231138548, -109.05366318440363, 102.45846377118002, -136.95507600174003, -407.02667014953664, -843.7495374560265, -211.42195549350504, -124.2560329382134, -18.147821312892795, -323.6921778491348, -77.40839946911103, -683.6002623465154, -336.51408693262755, -267.6555656374989, -368.80629745541626, -87.86140998746852, -157.71477658778255, -498.3528721982186, 4.459409366739525, 8.71593977854945, -17.762099647249194, 14.717954340423018, 113.95637793216699, 188.62706781825014, -221.52345262221345, -857.1685334292545, -255.84946115806895, -843.3336044189898, 33.417505270771535, -344.5635557149995, -162.928731391161, -484.77378111099335, -294.2824916077809, -247.54395000102173, -496.8719184158971, -60.93078741574519, -254.53711170975183, -258.45681673720236, 377.1787780947102, -355.3130447718237, -480.39599900443125, -386.59940019539505, -135.57215079551634, 383.8, -11.472429164939907, -378.67179971492186], "policy_predator_policy_reward": [154.7127013619649, 63.894351628894626, 126.88825135217255, 1253.1827382498964, 151.62598183099644, 183.04489085226402, 166.16793814112287, 276.07861238141, 42.41374201794263, 77.34058097843281, 435.8078868655362, 189.56488201408627, 63.41028774682486, 101.72338749366196, 240.97518271900287, 180.77163468743953, 35.69469781924871, 44.811079818557836, 907.5492384464129, 92.69969608988283, 632.2899817405114, 351.5169712916827, 184.10211384183395, 476.1748879253433, 164.90120099591368, 147.94279809074294, 300.4107959113474, 398.53717410872343, 22.138034510230025, 72.59900515357917, 817.8830242201459, 109.9046486526573, 14.927157736486247, 411.6326059099157, 53.98841878772546, 143.31723551971274, 174.0245712334238, 816.382615339888, 203.32814021335128, 480.12545956187273, 98.48486158707131, 124.94882974469995, 20.686677643419593, 1038.1672511692657, 387.1836816131405, 191.66997430300717, 131.22958504847466, 945.6662270820959, 463.18942682415246, 85.24793139084485, 187.7025983848439, 250.0494232218833, 299.10062814740644, 587.1496916329779, 225.15046843739847, 393.5650729442323, 703.2173854096945, 103.93341942947457, 319.1633986686542, 99.12740682470498, 286.4576061676167, 167.11637126803632, 13.787110983636092, 20.41632898274098, 382.6878161666474, 139.62128246378558, 541.0409318239067, 535.0189397221085, 327.3341609514854, 324.9655602704302, 319.4421988993636, 92.12276833140587, 380.76783574546704, 536.1950720412256, 696.614270522953, 147.46825197311523, 648.9803579493865, 330.9393343674391, 22.63041064701699, 75.95034165545769, 137.84582073237587, 3.5975631206708867, 63.78194139806979, 245.53200643704, 226.64806538630924, 213.66221048800222, 391.8437356640783, 234.37135977803194, 369.016303949934, 333.80846233096486, 3.757952216123224, 34.215312590427864, 209.71842191689547, 522.5293789601017, 343.3734224490698, 361.2425472377078, 483.4268814274001, 387.12236221294836, 299.13914322847455, 380.4412959164293, 371.5617971710717, 97.9445602603676, 408.25626637858363, 178.83328760247755, 222.02189630675628, 10.690477233528133, 539.2402971218069, 481.15233620967797, 534.3586868684517, 357.8280039072823, 542.1286568772243, 410.6513402969389, 269.6790807204423, 355.99386282965725, 91.07092922063859, 138.43892164868137, 132.60104338140317, 67.41727337887713, 315.2742619990711, 229.0791080431315, 376.1245776617765, 325.69582057864915, 347.6439023917779, 319.1048776320002, 0.0, 323.9431920062587, 323.94655787253186, 307.5013209575756, 303.57484887470423, 248.56605689427226, 534.7435766537187, 176.26643785377064, 51.39896126416527, 43.380260760883374, 34.831524303603835, 151.53465524723504, 70.77101815224037, 669.9873508226626, 224.43520083358806, 458.10556918194754, 225.480862640263, 329.37723557749354, 268.43567539390403, 517.140801439517, 111.69781048906528, 407.54653546625576, 164.24339849164153, 122.58114857738012, 204.5516876158824, 0.0, 770.7661557955811, 82.73655583902696, 416.4547357354963, 178.34710034912766, 113.53423113854595, 136.2591560831312, 85.9638753684939, 204.7041330168995, 1042.3719910617924, 195.03613371637343, 82.73126350171417, 319.50273825218414, 85.90160848190872, 341.9421778491392, 219.62964054767986, 608.752039257489, 363.4682458161946, 297.8183939213799, 63.85270012409205, 440.7034002325662, 205.85254591736037, 569.9037862205817, 35.84059063326066, 29.08406022145068, 58.815428654534486, 105.48787409739292, 203.20126593706138, 142.67293218174984, 865.505256951107, 265.0264884794045, 278.4521080893031, 797.5165946990709, 15.279040019956142, 360.467010424277, 162.64466376921837, 488.70960300533096, 272.0176550749941, 208.22299272566187, 518.203201914089, 99.9960492082841, 285.5162481426866, 276.15929670451686, 329.88891479507294, 338.6853342955718, 454.9194545792107, 445.29468139854646, 37.647570211495506, 128.12458058401933, 85.02795514149186, 393.50912158974546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.936427756215147, "mean_inference_ms": 4.604554453267169, "mean_action_processing_ms": 1.488485519684667, "mean_env_wait_ms": 10.714352234822803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022680997848510742, "StateBufferConnector_ms": 0.004598855972290039, "ViewRequirementAgentConnector_ms": 0.19678592681884766}, "num_episodes": 14, "episode_return_max": 690.4399824135313, "episode_return_min": -131.35493925864745, "episode_return_mean": 152.08941027953554, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.73984267273109, "num_env_steps_trained_throughput_per_sec": 81.73984267273109, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 56570.574, "restore_workers_time_ms": 0.016, "training_step_time_ms": 56570.508, "sample_time_ms": 2918.77, "learn_time_ms": 53628.809, "learn_throughput": 74.587, "synch_weights_time_ms": 17.516}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "35fb9_00000", "date": "2024-08-22_09-23-45", "timestamp": 1724298825, "time_this_iter_s": 48.99121427536011, "time_total_s": 5401.861385583878, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcd4160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5401.861385583878, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 29.71594202898551, "ram_util_percent": 82.74202898550725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.583620476218126, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.750745135514194, "policy_loss": -0.020417163108546958, "vf_loss": 3.767952939442226, "vf_explained_var": 0.4613633484121353, "kl": 0.016046755171316877, "entropy": 0.8834439238543232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.98884242713136, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.6230070748657144, "policy_loss": -0.02895771079455261, "vf_loss": 3.64971000416569, "vf_explained_var": 0.14858061879400222, "kl": 0.011273911693034861, "entropy": 0.5933616769692255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 690.4399824135313, "episode_reward_min": -131.35493925864745, "episode_reward_mean": 151.5154170274866, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1029.2672511692717, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 1042.3719910617924}, "policy_reward_mean": {"prey_policy": -206.01194059052168, "predator_policy": 281.7696491042658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [485.60358782053345, 87.87433386661934, 279.1630298949465, 36.603454709272825, 26.666632210479058, 107.24492855919759, 66.30000000000051, 201.05790791746543, 74.10000000000007, 122.94335475267879, 68.40000000000039, 109.73573057573265, -43.67699783327669, 125.91309386821109, 521.2883393252789, 47.600000000000406, 66.92753945270947, 79.62898777700381, 58.625837761863615, 340.60000000000076, 374.6248975002572, 386.08146947706155, 239.37514896387552, 234.62173816998924, 49.50000000000043, 77.19999999999989, 60.00000000000059, 163.44529737176026, 413.230154368537, 84.81992135188995, 144.89351308835518, 28.697468108106662, 164.78817290574207, 74.60000000000004, 71.5838834764834, 204.9999999999995, 120.1154692138981, 146.39848029360851, 334.7020970674512, 416.70000000000243, 36.014614828633526, 79.14440631892272, 229.6469012666065, 170.5886629261644, 67.92986855623137, 100.20498994227675, 99.65663805254398, 254.77616211160407, -131.35493925864745, 83.08850562719526, 108.30575329552448, 657.9964006226248, 78.02725740465874, 39.43203605286373, 264.4548275627366, 42.39246591268474, 107.14441496669367, 206.08409984219833, 54.84283478454476, 55.40000000000052, 404.6000000000021, 183.05494382374377, 49.26309298541025, 47.19654529072786, 74.70071452503726, 53.73601762002983, 137.06154509635175, 298.8433224665131, 425.0000000000029, 18.703454709272663, 347.1921418542746, 63.40549289872996, 256.17139615483416, -13.368082827401498, 66.5560133221836, 86.00378716901443, 67.37301798954434, 57.116987167442865, 47.88839291377256, 119.68868335194013, 78.09999999999984, 161.25915744509743, 648.4576438692284, 51.83975937904582, -23.214362788684138, 64.6000000000006, 3.6517542723939096, -61.58579380815454, 60.396545290728035, 48.681616400240756, 690.4399824135313, 33.21873677792421, 414.0000000000025, 88.39284785136866, 120.6023648702496, 23.807154169868962, 81.26661418222284, 233.2326453773549, 125.99999999999649, 261.45419770301817], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [388.2517354034877, -67.78182282344684, -226.80682323563235, -107.0656603041931, 200.8073521120427, -2.1500998549073356, -890.6251537029748, -73.0203261240484, -460.00968302174806, -497.1306377999669, -89.82642877954254, -463.20564442842993, -132.60120099591552, -113.94279809074487, -400.88204293979294, -97.00801916280881, 16.161965489769976, -36.799005153579266, -837.8798887572201, 33.035570637102445, 23.97284226351379, -382.1326059099092, 35.230794357462344, -122.80071808916702, -245.32733982139317, -788.7568445851963, -105.1539637771773, -452.38654212982954, -100.25104005573988, 398.1056880492409, 18.013322356580414, -1029.2672511692717, -375.57248423480087, -136.35363222863378, -34.448905199531836, -962.8179191540316, -435.2135890622842, -54.59793139084608, -152.70259838484588, 55.55057677811663, -161.85250516239674, -349.7729171177309, -13.882354867494245, -218.7517170370792, -517.2546921127574, -50.52096376253605, -243.89188624208992, 60.22281891872007, -264.1576061676127, -139.91637126803786, 25.212889016363967, 17.783671017259028, -357.2878161666416, -105.02128246378754, -543.9956909611664, -368.6188832130826, -554.6804925170062, 315.6109256636293, -348.4359695844243, 21.690923705551878, -379.3422851664236, -392.7271095318998, -535.225978797584, -280.1590755903729, -708.9750114205226, -106.15650799056073, 15.569589352983025, -39.55034165545788, -106.84582073237763, 36.98632035581255, 98.9714001257929, -203.2853479609039, -5.996164884188289, -314.1986417762221, -486.3033500116913, 6.486734863194762, -28.63923893013626, -339.48343028330834, 376.14204778387676, 2.5846874095723558, -451.1512917270642, -245.08189432129757, -71.35507461569007, -554.1164887521662, -381.70347956531816, -259.1988628084198, -145.53049922196533, -363.46127699676936, -26.062300191581144, -375.51418868362236, -344.3104708732281, -142.5740931655494, -191.60257167603083, 58.54683618829076, -276.9150927395951, -488.7013784802857, -578.7224108163156, -444.81921921806475, -533.0944636416779, -336.5970279052859, -177.12112685231762, -340.2460634022517, 246.92547140198616, 181.56107835131857, -119.46736321738891, -2.523696138233673, -312.5602748731448, -192.36105911619225, -238.53506914422226, -198.83050153346937, -353.92331604593693, -270.43299806515006, -83.09597161058277, -133.70280542898385, -39.19616479694644, -386.1676141909618, -309.2805950522651, -188.01747593216436, -510.64357665371324, -144.96643785377242, 316.50103873583475, -6.680260760883019, -135.55649467219732, 132.2452589451011, -357.5305426864023, -333.96473330308464, -192.3386555428621, -443.005569181945, -453.4495399240564, -26.70784376866088, -239.60512984560938, -492.2353293677752, -49.77005697547682, -332.41274388348967, 145.42823020817238, -133.40945481068252, -178.65168761588387, 399.1, -380.8134396228005, -453.9858173025338, 106.33826821702178, -353.9479624473666, -77.334231138548, -109.05366318440363, 102.45846377118002, -136.95507600174003, -407.02667014953664, -843.7495374560265, -211.42195549350504, -124.2560329382134, -18.147821312892795, -323.6921778491348, -77.40839946911103, -683.6002623465154, -336.51408693262755, -267.6555656374989, -368.80629745541626, -87.86140998746852, -157.71477658778255, -498.3528721982186, 4.459409366739525, 8.71593977854945, -17.762099647249194, 14.717954340423018, 113.95637793216699, 188.62706781825014, -221.52345262221345, -857.1685334292545, -255.84946115806895, -843.3336044189898, 33.417505270771535, -344.5635557149995, -162.928731391161, -484.77378111099335, -294.2824916077809, -247.54395000102173, -496.8719184158971, -60.93078741574519, -254.53711170975183, -258.45681673720236, 377.1787780947102, -355.3130447718237, -480.39599900443125, -386.59940019539505, -135.57215079551634, 383.8, -11.472429164939907, -378.67179971492186, -239.55419231243084, 10.345651892798925, -429.916713954707, -428.08428520795786, -135.07663651989427, 33.39085480136527, -414.4949671182607, -19.66761465476369, -161.79269189506286, 58.065717069296156, -379.50765708687084, 36.734348729997286], "policy_predator_policy_reward": [63.41028774682486, 101.72338749366196, 240.97518271900287, 180.77163468743953, 35.69469781924871, 44.811079818557836, 907.5492384464129, 92.69969608988283, 632.2899817405114, 351.5169712916827, 184.10211384183395, 476.1748879253433, 164.90120099591368, 147.94279809074294, 300.4107959113474, 398.53717410872343, 22.138034510230025, 72.59900515357917, 817.8830242201459, 109.9046486526573, 14.927157736486247, 411.6326059099157, 53.98841878772546, 143.31723551971274, 174.0245712334238, 816.382615339888, 203.32814021335128, 480.12545956187273, 98.48486158707131, 124.94882974469995, 20.686677643419593, 1038.1672511692657, 387.1836816131405, 191.66997430300717, 131.22958504847466, 945.6662270820959, 463.18942682415246, 85.24793139084485, 187.7025983848439, 250.0494232218833, 299.10062814740644, 587.1496916329779, 225.15046843739847, 393.5650729442323, 703.2173854096945, 103.93341942947457, 319.1633986686542, 99.12740682470498, 286.4576061676167, 167.11637126803632, 13.787110983636092, 20.41632898274098, 382.6878161666474, 139.62128246378558, 541.0409318239067, 535.0189397221085, 327.3341609514854, 324.9655602704302, 319.4421988993636, 92.12276833140587, 380.76783574546704, 536.1950720412256, 696.614270522953, 147.46825197311523, 648.9803579493865, 330.9393343674391, 22.63041064701699, 75.95034165545769, 137.84582073237587, 3.5975631206708867, 63.78194139806979, 245.53200643704, 226.64806538630924, 213.66221048800222, 391.8437356640783, 234.37135977803194, 369.016303949934, 333.80846233096486, 3.757952216123224, 34.215312590427864, 209.71842191689547, 522.5293789601017, 343.3734224490698, 361.2425472377078, 483.4268814274001, 387.12236221294836, 299.13914322847455, 380.4412959164293, 371.5617971710717, 97.9445602603676, 408.25626637858363, 178.83328760247755, 222.02189630675628, 10.690477233528133, 539.2402971218069, 481.15233620967797, 534.3586868684517, 357.8280039072823, 542.1286568772243, 410.6513402969389, 269.6790807204423, 355.99386282965725, 91.07092922063859, 138.43892164868137, 132.60104338140317, 67.41727337887713, 315.2742619990711, 229.0791080431315, 376.1245776617765, 325.69582057864915, 347.6439023917779, 319.1048776320002, 0.0, 323.9431920062587, 323.94655787253186, 307.5013209575756, 303.57484887470423, 248.56605689427226, 534.7435766537187, 176.26643785377064, 51.39896126416527, 43.380260760883374, 34.831524303603835, 151.53465524723504, 70.77101815224037, 669.9873508226626, 224.43520083358806, 458.10556918194754, 225.480862640263, 329.37723557749354, 268.43567539390403, 517.140801439517, 111.69781048906528, 407.54653546625576, 164.24339849164153, 122.58114857738012, 204.5516876158824, 0.0, 770.7661557955811, 82.73655583902696, 416.4547357354963, 178.34710034912766, 113.53423113854595, 136.2591560831312, 85.9638753684939, 204.7041330168995, 1042.3719910617924, 195.03613371637343, 82.73126350171417, 319.50273825218414, 85.90160848190872, 341.9421778491392, 219.62964054767986, 608.752039257489, 363.4682458161946, 297.8183939213799, 63.85270012409205, 440.7034002325662, 205.85254591736037, 569.9037862205817, 35.84059063326066, 29.08406022145068, 58.815428654534486, 105.48787409739292, 203.20126593706138, 142.67293218174984, 865.505256951107, 265.0264884794045, 278.4521080893031, 797.5165946990709, 15.279040019956142, 360.467010424277, 162.64466376921837, 488.70960300533096, 272.0176550749941, 208.22299272566187, 518.203201914089, 99.9960492082841, 285.5162481426866, 276.15929670451686, 329.88891479507294, 338.6853342955718, 454.9194545792107, 445.29468139854646, 37.647570211495506, 128.12458058401933, 85.02795514149186, 393.50912158974546, 265.19533191481446, 84.61557337507125, 340.0638257287668, 541.744327603771, 106.90329872019451, 76.04909718055664, 440.17352780845084, 227.2216993419333, 194.392691895061, 35.33428293070424, 441.1930034165698, 163.03450264332292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.935280719789121, "mean_inference_ms": 4.603310627349166, "mean_action_processing_ms": 1.4912650231170588, "mean_env_wait_ms": 10.703060739666707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022669076919555664, "StateBufferConnector_ms": 0.004608035087585449, "ViewRequirementAgentConnector_ms": 0.18294382095336914}, "num_episodes": 6, "episode_return_max": 690.4399824135313, "episode_return_min": -131.35493925864745, "episode_return_mean": 151.5154170274866, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.12105310516635, "num_env_steps_trained_throughput_per_sec": 80.12105310516635, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 56570.761, "restore_workers_time_ms": 0.015, "training_step_time_ms": 56570.698, "sample_time_ms": 2850.453, "learn_time_ms": 53696.504, "learn_throughput": 74.493, "synch_weights_time_ms": 18.209}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "35fb9_00000", "date": "2024-08-22_09-24-35", "timestamp": 1724298875, "time_this_iter_s": 49.96465301513672, "time_total_s": 5451.826038599014, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcd7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5451.826038599014, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 37.481690140845075, "ram_util_percent": 82.84366197183097}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.721321846568394, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.526264400078506, "policy_loss": -0.01631000679896075, "vf_loss": 3.5398662297183243, "vf_explained_var": 0.48178493276474965, "kl": 0.0135408983390936, "entropy": 0.8862752853877961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.669686449015582, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.333706320278228, "policy_loss": -0.02316235219259012, "vf_loss": 3.354574181730785, "vf_explained_var": 0.3545741156295494, "kl": 0.011472399797039253, "entropy": 0.6095276546225976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 690.4399824135313, "episode_reward_min": -131.35493925864745, "episode_reward_mean": 149.6144868485743, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1029.2672511692717, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 1042.3719910617924}, "policy_reward_mean": {"prey_policy": -196.37440712667637, "predator_policy": 271.1816505509643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.94335475267879, 68.40000000000039, 109.73573057573265, -43.67699783327669, 125.91309386821109, 521.2883393252789, 47.600000000000406, 66.92753945270947, 79.62898777700381, 58.625837761863615, 340.60000000000076, 374.6248975002572, 386.08146947706155, 239.37514896387552, 234.62173816998924, 49.50000000000043, 77.19999999999989, 60.00000000000059, 163.44529737176026, 413.230154368537, 84.81992135188995, 144.89351308835518, 28.697468108106662, 164.78817290574207, 74.60000000000004, 71.5838834764834, 204.9999999999995, 120.1154692138981, 146.39848029360851, 334.7020970674512, 416.70000000000243, 36.014614828633526, 79.14440631892272, 229.6469012666065, 170.5886629261644, 67.92986855623137, 100.20498994227675, 99.65663805254398, 254.77616211160407, -131.35493925864745, 83.08850562719526, 108.30575329552448, 657.9964006226248, 78.02725740465874, 39.43203605286373, 264.4548275627366, 42.39246591268474, 107.14441496669367, 206.08409984219833, 54.84283478454476, 55.40000000000052, 404.6000000000021, 183.05494382374377, 49.26309298541025, 47.19654529072786, 74.70071452503726, 53.73601762002983, 137.06154509635175, 298.8433224665131, 425.0000000000029, 18.703454709272663, 347.1921418542746, 63.40549289872996, 256.17139615483416, -13.368082827401498, 66.5560133221836, 86.00378716901443, 67.37301798954434, 57.116987167442865, 47.88839291377256, 119.68868335194013, 78.09999999999984, 161.25915744509743, 648.4576438692284, 51.83975937904582, -23.214362788684138, 64.6000000000006, 3.6517542723939096, -61.58579380815454, 60.396545290728035, 48.681616400240756, 690.4399824135313, 33.21873677792421, 414.0000000000025, 88.39284785136866, 120.6023648702496, 23.807154169868962, 81.26661418222284, 233.2326453773549, 125.99999999999649, 261.45419770301817, 87.9296371002291, 87.65212620876466, 211.79999999999794, 71.36535687470162, 362.9137607013191, 67.40000000000045, 160.35997620227317, 63.20000000000063, 61.90000000000061], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-837.8798887572201, 33.035570637102445, 23.97284226351379, -382.1326059099092, 35.230794357462344, -122.80071808916702, -245.32733982139317, -788.7568445851963, -105.1539637771773, -452.38654212982954, -100.25104005573988, 398.1056880492409, 18.013322356580414, -1029.2672511692717, -375.57248423480087, -136.35363222863378, -34.448905199531836, -962.8179191540316, -435.2135890622842, -54.59793139084608, -152.70259838484588, 55.55057677811663, -161.85250516239674, -349.7729171177309, -13.882354867494245, -218.7517170370792, -517.2546921127574, -50.52096376253605, -243.89188624208992, 60.22281891872007, -264.1576061676127, -139.91637126803786, 25.212889016363967, 17.783671017259028, -357.2878161666416, -105.02128246378754, -543.9956909611664, -368.6188832130826, -554.6804925170062, 315.6109256636293, -348.4359695844243, 21.690923705551878, -379.3422851664236, -392.7271095318998, -535.225978797584, -280.1590755903729, -708.9750114205226, -106.15650799056073, 15.569589352983025, -39.55034165545788, -106.84582073237763, 36.98632035581255, 98.9714001257929, -203.2853479609039, -5.996164884188289, -314.1986417762221, -486.3033500116913, 6.486734863194762, -28.63923893013626, -339.48343028330834, 376.14204778387676, 2.5846874095723558, -451.1512917270642, -245.08189432129757, -71.35507461569007, -554.1164887521662, -381.70347956531816, -259.1988628084198, -145.53049922196533, -363.46127699676936, -26.062300191581144, -375.51418868362236, -344.3104708732281, -142.5740931655494, -191.60257167603083, 58.54683618829076, -276.9150927395951, -488.7013784802857, -578.7224108163156, -444.81921921806475, -533.0944636416779, -336.5970279052859, -177.12112685231762, -340.2460634022517, 246.92547140198616, 181.56107835131857, -119.46736321738891, -2.523696138233673, -312.5602748731448, -192.36105911619225, -238.53506914422226, -198.83050153346937, -353.92331604593693, -270.43299806515006, -83.09597161058277, -133.70280542898385, -39.19616479694644, -386.1676141909618, -309.2805950522651, -188.01747593216436, -510.64357665371324, -144.96643785377242, 316.50103873583475, -6.680260760883019, -135.55649467219732, 132.2452589451011, -357.5305426864023, -333.96473330308464, -192.3386555428621, -443.005569181945, -453.4495399240564, -26.70784376866088, -239.60512984560938, -492.2353293677752, -49.77005697547682, -332.41274388348967, 145.42823020817238, -133.40945481068252, -178.65168761588387, 399.1, -380.8134396228005, -453.9858173025338, 106.33826821702178, -353.9479624473666, -77.334231138548, -109.05366318440363, 102.45846377118002, -136.95507600174003, -407.02667014953664, -843.7495374560265, -211.42195549350504, -124.2560329382134, -18.147821312892795, -323.6921778491348, -77.40839946911103, -683.6002623465154, -336.51408693262755, -267.6555656374989, -368.80629745541626, -87.86140998746852, -157.71477658778255, -498.3528721982186, 4.459409366739525, 8.71593977854945, -17.762099647249194, 14.717954340423018, 113.95637793216699, 188.62706781825014, -221.52345262221345, -857.1685334292545, -255.84946115806895, -843.3336044189898, 33.417505270771535, -344.5635557149995, -162.928731391161, -484.77378111099335, -294.2824916077809, -247.54395000102173, -496.8719184158971, -60.93078741574519, -254.53711170975183, -258.45681673720236, 377.1787780947102, -355.3130447718237, -480.39599900443125, -386.59940019539505, -135.57215079551634, 383.8, -11.472429164939907, -378.67179971492186, -239.55419231243084, 10.345651892798925, -429.916713954707, -428.08428520795786, -135.07663651989427, 33.39085480136527, -414.4949671182607, -19.66761465476369, -161.79269189506286, 58.065717069296156, -379.50765708687084, 36.734348729997286, -66.82296022838452, -74.51517426423226, -49.90971097563506, -208.82274087942216, 51.56006707283631, -108.61125552293063, -79.87502429323557, -34.85109717084818, -62.23407476799213, 266.2140048320206, -57.53638916642503, -44.880396916465415, -198.56676041086322, 11.390864871445727, -241.56605144920408, -4.46369283137647, -27.614983895535858, -195.02222464712565], "policy_predator_policy_reward": [817.8830242201459, 109.9046486526573, 14.927157736486247, 411.6326059099157, 53.98841878772546, 143.31723551971274, 174.0245712334238, 816.382615339888, 203.32814021335128, 480.12545956187273, 98.48486158707131, 124.94882974469995, 20.686677643419593, 1038.1672511692657, 387.1836816131405, 191.66997430300717, 131.22958504847466, 945.6662270820959, 463.18942682415246, 85.24793139084485, 187.7025983848439, 250.0494232218833, 299.10062814740644, 587.1496916329779, 225.15046843739847, 393.5650729442323, 703.2173854096945, 103.93341942947457, 319.1633986686542, 99.12740682470498, 286.4576061676167, 167.11637126803632, 13.787110983636092, 20.41632898274098, 382.6878161666474, 139.62128246378558, 541.0409318239067, 535.0189397221085, 327.3341609514854, 324.9655602704302, 319.4421988993636, 92.12276833140587, 380.76783574546704, 536.1950720412256, 696.614270522953, 147.46825197311523, 648.9803579493865, 330.9393343674391, 22.63041064701699, 75.95034165545769, 137.84582073237587, 3.5975631206708867, 63.78194139806979, 245.53200643704, 226.64806538630924, 213.66221048800222, 391.8437356640783, 234.37135977803194, 369.016303949934, 333.80846233096486, 3.757952216123224, 34.215312590427864, 209.71842191689547, 522.5293789601017, 343.3734224490698, 361.2425472377078, 483.4268814274001, 387.12236221294836, 299.13914322847455, 380.4412959164293, 371.5617971710717, 97.9445602603676, 408.25626637858363, 178.83328760247755, 222.02189630675628, 10.690477233528133, 539.2402971218069, 481.15233620967797, 534.3586868684517, 357.8280039072823, 542.1286568772243, 410.6513402969389, 269.6790807204423, 355.99386282965725, 91.07092922063859, 138.43892164868137, 132.60104338140317, 67.41727337887713, 315.2742619990711, 229.0791080431315, 376.1245776617765, 325.69582057864915, 347.6439023917779, 319.1048776320002, 0.0, 323.9431920062587, 323.94655787253186, 307.5013209575756, 303.57484887470423, 248.56605689427226, 534.7435766537187, 176.26643785377064, 51.39896126416527, 43.380260760883374, 34.831524303603835, 151.53465524723504, 70.77101815224037, 669.9873508226626, 224.43520083358806, 458.10556918194754, 225.480862640263, 329.37723557749354, 268.43567539390403, 517.140801439517, 111.69781048906528, 407.54653546625576, 164.24339849164153, 122.58114857738012, 204.5516876158824, 0.0, 770.7661557955811, 82.73655583902696, 416.4547357354963, 178.34710034912766, 113.53423113854595, 136.2591560831312, 85.9638753684939, 204.7041330168995, 1042.3719910617924, 195.03613371637343, 82.73126350171417, 319.50273825218414, 85.90160848190872, 341.9421778491392, 219.62964054767986, 608.752039257489, 363.4682458161946, 297.8183939213799, 63.85270012409205, 440.7034002325662, 205.85254591736037, 569.9037862205817, 35.84059063326066, 29.08406022145068, 58.815428654534486, 105.48787409739292, 203.20126593706138, 142.67293218174984, 865.505256951107, 265.0264884794045, 278.4521080893031, 797.5165946990709, 15.279040019956142, 360.467010424277, 162.64466376921837, 488.70960300533096, 272.0176550749941, 208.22299272566187, 518.203201914089, 99.9960492082841, 285.5162481426866, 276.15929670451686, 329.88891479507294, 338.6853342955718, 454.9194545792107, 445.29468139854646, 37.647570211495506, 128.12458058401933, 85.02795514149186, 393.50912158974546, 265.19533191481446, 84.61557337507125, 340.0638257287668, 541.744327603771, 106.90329872019451, 76.04909718055664, 440.17352780845084, 227.2216993419333, 194.392691895061, 35.33428293070424, 441.1930034165698, 163.03450264332292, 127.71025206340629, 101.55751952943666, 240.65907345292467, 105.72550461089644, 129.33993292716383, 139.5112555229289, 65.26075003670398, 120.83072830207924, 75.69602011929933, 83.23781051798667, 91.03638916642362, 78.7803969164649, 211.8161902717095, 135.719681469983, 268.1660514492056, 41.063692831376784, 64.11498389553637, 220.4222246471242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.940636276776343, "mean_inference_ms": 4.606473327611549, "mean_action_processing_ms": 1.488452530559964, "mean_env_wait_ms": 10.717688435920996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02261936664581299, "StateBufferConnector_ms": 0.004570722579956055, "ViewRequirementAgentConnector_ms": 0.18105709552764893}, "num_episodes": 9, "episode_return_max": 690.4399824135313, "episode_return_min": -131.35493925864745, "episode_return_mean": 149.6144868485743, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.38724154005612, "num_env_steps_trained_throughput_per_sec": 79.38724154005612, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 56802.18, "restore_workers_time_ms": 0.017, "training_step_time_ms": 56802.113, "sample_time_ms": 2871.654, "learn_time_ms": 53905.936, "learn_throughput": 74.203, "synch_weights_time_ms": 18.238}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "35fb9_00000", "date": "2024-08-22_09-25-25", "timestamp": 1724298925, "time_this_iter_s": 50.43562698364258, "time_total_s": 5502.261665582657, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc7bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5502.261665582657, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 47.81944444444444, "ram_util_percent": 82.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.143063328568896, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.3032812823694218, "policy_loss": -0.015252086882991962, "vf_loss": 3.316168411635848, "vf_explained_var": 0.4440442663336557, "kl": 0.011824792528047015, "entropy": 0.88482287122459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.138915168040644, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.1457031557799646, "policy_loss": -0.026707541539392893, "vf_loss": 3.1693457138601433, "vf_explained_var": 0.2535388038902686, "kl": 0.015324928858144968, "entropy": 0.6037960665724265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 690.4399824135313, "episode_reward_min": -131.35493925864745, "episode_reward_mean": 153.68035851604049, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -857.1685334292545, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 1042.3719910617924}, "policy_reward_mean": {"prey_policy": -187.98360559582062, "predator_policy": 264.8237848538417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.625837761863615, 340.60000000000076, 374.6248975002572, 386.08146947706155, 239.37514896387552, 234.62173816998924, 49.50000000000043, 77.19999999999989, 60.00000000000059, 163.44529737176026, 413.230154368537, 84.81992135188995, 144.89351308835518, 28.697468108106662, 164.78817290574207, 74.60000000000004, 71.5838834764834, 204.9999999999995, 120.1154692138981, 146.39848029360851, 334.7020970674512, 416.70000000000243, 36.014614828633526, 79.14440631892272, 229.6469012666065, 170.5886629261644, 67.92986855623137, 100.20498994227675, 99.65663805254398, 254.77616211160407, -131.35493925864745, 83.08850562719526, 108.30575329552448, 657.9964006226248, 78.02725740465874, 39.43203605286373, 264.4548275627366, 42.39246591268474, 107.14441496669367, 206.08409984219833, 54.84283478454476, 55.40000000000052, 404.6000000000021, 183.05494382374377, 49.26309298541025, 47.19654529072786, 74.70071452503726, 53.73601762002983, 137.06154509635175, 298.8433224665131, 425.0000000000029, 18.703454709272663, 347.1921418542746, 63.40549289872996, 256.17139615483416, -13.368082827401498, 66.5560133221836, 86.00378716901443, 67.37301798954434, 57.116987167442865, 47.88839291377256, 119.68868335194013, 78.09999999999984, 161.25915744509743, 648.4576438692284, 51.83975937904582, -23.214362788684138, 64.6000000000006, 3.6517542723939096, -61.58579380815454, 60.396545290728035, 48.681616400240756, 690.4399824135313, 33.21873677792421, 414.0000000000025, 88.39284785136866, 120.6023648702496, 23.807154169868962, 81.26661418222284, 233.2326453773549, 125.99999999999649, 261.45419770301817, 87.9296371002291, 87.65212620876466, 211.79999999999794, 71.36535687470162, 362.9137607013191, 67.40000000000045, 160.35997620227317, 63.20000000000063, 61.90000000000061, 98.55788754337709, 57.300000000000544, 391.89774383770913, 253.38976807528667, 378.6000000000036, 235.99999999999827, 50.14819984542862, -90.91510457741423, 130.3687199405641], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-435.2135890622842, -54.59793139084608, -152.70259838484588, 55.55057677811663, -161.85250516239674, -349.7729171177309, -13.882354867494245, -218.7517170370792, -517.2546921127574, -50.52096376253605, -243.89188624208992, 60.22281891872007, -264.1576061676127, -139.91637126803786, 25.212889016363967, 17.783671017259028, -357.2878161666416, -105.02128246378754, -543.9956909611664, -368.6188832130826, -554.6804925170062, 315.6109256636293, -348.4359695844243, 21.690923705551878, -379.3422851664236, -392.7271095318998, -535.225978797584, -280.1590755903729, -708.9750114205226, -106.15650799056073, 15.569589352983025, -39.55034165545788, -106.84582073237763, 36.98632035581255, 98.9714001257929, -203.2853479609039, -5.996164884188289, -314.1986417762221, -486.3033500116913, 6.486734863194762, -28.63923893013626, -339.48343028330834, 376.14204778387676, 2.5846874095723558, -451.1512917270642, -245.08189432129757, -71.35507461569007, -554.1164887521662, -381.70347956531816, -259.1988628084198, -145.53049922196533, -363.46127699676936, -26.062300191581144, -375.51418868362236, -344.3104708732281, -142.5740931655494, -191.60257167603083, 58.54683618829076, -276.9150927395951, -488.7013784802857, -578.7224108163156, -444.81921921806475, -533.0944636416779, -336.5970279052859, -177.12112685231762, -340.2460634022517, 246.92547140198616, 181.56107835131857, -119.46736321738891, -2.523696138233673, -312.5602748731448, -192.36105911619225, -238.53506914422226, -198.83050153346937, -353.92331604593693, -270.43299806515006, -83.09597161058277, -133.70280542898385, -39.19616479694644, -386.1676141909618, -309.2805950522651, -188.01747593216436, -510.64357665371324, -144.96643785377242, 316.50103873583475, -6.680260760883019, -135.55649467219732, 132.2452589451011, -357.5305426864023, -333.96473330308464, -192.3386555428621, -443.005569181945, -453.4495399240564, -26.70784376866088, -239.60512984560938, -492.2353293677752, -49.77005697547682, -332.41274388348967, 145.42823020817238, -133.40945481068252, -178.65168761588387, 399.1, -380.8134396228005, -453.9858173025338, 106.33826821702178, -353.9479624473666, -77.334231138548, -109.05366318440363, 102.45846377118002, -136.95507600174003, -407.02667014953664, -843.7495374560265, -211.42195549350504, -124.2560329382134, -18.147821312892795, -323.6921778491348, -77.40839946911103, -683.6002623465154, -336.51408693262755, -267.6555656374989, -368.80629745541626, -87.86140998746852, -157.71477658778255, -498.3528721982186, 4.459409366739525, 8.71593977854945, -17.762099647249194, 14.717954340423018, 113.95637793216699, 188.62706781825014, -221.52345262221345, -857.1685334292545, -255.84946115806895, -843.3336044189898, 33.417505270771535, -344.5635557149995, -162.928731391161, -484.77378111099335, -294.2824916077809, -247.54395000102173, -496.8719184158971, -60.93078741574519, -254.53711170975183, -258.45681673720236, 377.1787780947102, -355.3130447718237, -480.39599900443125, -386.59940019539505, -135.57215079551634, 383.8, -11.472429164939907, -378.67179971492186, -239.55419231243084, 10.345651892798925, -429.916713954707, -428.08428520795786, -135.07663651989427, 33.39085480136527, -414.4949671182607, -19.66761465476369, -161.79269189506286, 58.065717069296156, -379.50765708687084, 36.734348729997286, -66.82296022838452, -74.51517426423226, -49.90971097563506, -208.82274087942216, 51.56006707283631, -108.61125552293063, -79.87502429323557, -34.85109717084818, -62.23407476799213, 266.2140048320206, -57.53638916642503, -44.880396916465415, -198.56676041086322, 11.390864871445727, -241.56605144920408, -4.46369283137647, -27.614983895535858, -195.02222464712565, -335.68608463942064, -98.06265531392367, -89.21874564471142, -174.98950638455514, 315.32711327920964, 2.730323018180122, -131.49251045471087, -33.50481324592342, 36.30746872552951, 321.41439221552446, -113.04249927092474, -150.8043719017444, -335.1283165159043, -663.4710387487613, -715.9726988388339, -373.6871467365271, -264.75393460420645, -582.595586215151], "policy_predator_policy_reward": [463.18942682415246, 85.24793139084485, 187.7025983848439, 250.0494232218833, 299.10062814740644, 587.1496916329779, 225.15046843739847, 393.5650729442323, 703.2173854096945, 103.93341942947457, 319.1633986686542, 99.12740682470498, 286.4576061676167, 167.11637126803632, 13.787110983636092, 20.41632898274098, 382.6878161666474, 139.62128246378558, 541.0409318239067, 535.0189397221085, 327.3341609514854, 324.9655602704302, 319.4421988993636, 92.12276833140587, 380.76783574546704, 536.1950720412256, 696.614270522953, 147.46825197311523, 648.9803579493865, 330.9393343674391, 22.63041064701699, 75.95034165545769, 137.84582073237587, 3.5975631206708867, 63.78194139806979, 245.53200643704, 226.64806538630924, 213.66221048800222, 391.8437356640783, 234.37135977803194, 369.016303949934, 333.80846233096486, 3.757952216123224, 34.215312590427864, 209.71842191689547, 522.5293789601017, 343.3734224490698, 361.2425472377078, 483.4268814274001, 387.12236221294836, 299.13914322847455, 380.4412959164293, 371.5617971710717, 97.9445602603676, 408.25626637858363, 178.83328760247755, 222.02189630675628, 10.690477233528133, 539.2402971218069, 481.15233620967797, 534.3586868684517, 357.8280039072823, 542.1286568772243, 410.6513402969389, 269.6790807204423, 355.99386282965725, 91.07092922063859, 138.43892164868137, 132.60104338140317, 67.41727337887713, 315.2742619990711, 229.0791080431315, 376.1245776617765, 325.69582057864915, 347.6439023917779, 319.1048776320002, 0.0, 323.9431920062587, 323.94655787253186, 307.5013209575756, 303.57484887470423, 248.56605689427226, 534.7435766537187, 176.26643785377064, 51.39896126416527, 43.380260760883374, 34.831524303603835, 151.53465524723504, 70.77101815224037, 669.9873508226626, 224.43520083358806, 458.10556918194754, 225.480862640263, 329.37723557749354, 268.43567539390403, 517.140801439517, 111.69781048906528, 407.54653546625576, 164.24339849164153, 122.58114857738012, 204.5516876158824, 0.0, 770.7661557955811, 82.73655583902696, 416.4547357354963, 178.34710034912766, 113.53423113854595, 136.2591560831312, 85.9638753684939, 204.7041330168995, 1042.3719910617924, 195.03613371637343, 82.73126350171417, 319.50273825218414, 85.90160848190872, 341.9421778491392, 219.62964054767986, 608.752039257489, 363.4682458161946, 297.8183939213799, 63.85270012409205, 440.7034002325662, 205.85254591736037, 569.9037862205817, 35.84059063326066, 29.08406022145068, 58.815428654534486, 105.48787409739292, 203.20126593706138, 142.67293218174984, 865.505256951107, 265.0264884794045, 278.4521080893031, 797.5165946990709, 15.279040019956142, 360.467010424277, 162.64466376921837, 488.70960300533096, 272.0176550749941, 208.22299272566187, 518.203201914089, 99.9960492082841, 285.5162481426866, 276.15929670451686, 329.88891479507294, 338.6853342955718, 454.9194545792107, 445.29468139854646, 37.647570211495506, 128.12458058401933, 85.02795514149186, 393.50912158974546, 265.19533191481446, 84.61557337507125, 340.0638257287668, 541.744327603771, 106.90329872019451, 76.04909718055664, 440.17352780845084, 227.2216993419333, 194.392691895061, 35.33428293070424, 441.1930034165698, 163.03450264332292, 127.71025206340629, 101.55751952943666, 240.65907345292467, 105.72550461089644, 129.33993292716383, 139.5112555229289, 65.26075003670398, 120.83072830207924, 75.69602011929933, 83.23781051798667, 91.03638916642362, 78.7803969164649, 211.8161902717095, 135.719681469983, 268.1660514492056, 41.063692831376784, 64.11498389553637, 220.4222246471242, 142.3654620061323, 389.9411654905929, 121.2187456447096, 200.2895063845537, 33.872886720790355, 39.96742081952736, 308.47581234997284, 109.91127942594916, 3.392531274470741, 17.48560778447622, 171.82503666642884, 328.02183450623835, 554.1939939347195, 494.5535611753816, 875.1888214558163, 123.55591954213331, 333.10153369408937, 644.6167070658336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.948960341862429, "mean_inference_ms": 4.604481723316477, "mean_action_processing_ms": 1.4905918533013474, "mean_env_wait_ms": 10.707936236574897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022614121437072754, "StateBufferConnector_ms": 0.004484653472900391, "ViewRequirementAgentConnector_ms": 0.21057164669036865}, "num_episodes": 9, "episode_return_max": 690.4399824135313, "episode_return_min": -131.35493925864745, "episode_return_mean": 153.68035851604049, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.78284660352384, "num_env_steps_trained_throughput_per_sec": 79.78284660352384, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 56905.678, "restore_workers_time_ms": 0.017, "training_step_time_ms": 56905.613, "sample_time_ms": 2919.967, "learn_time_ms": 53961.376, "learn_throughput": 74.127, "synch_weights_time_ms": 18.064}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "35fb9_00000", "date": "2024-08-22_09-26-15", "timestamp": 1724298975, "time_this_iter_s": 50.15212869644165, "time_total_s": 5552.4137942790985, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0f5cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5552.4137942790985, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 44.981428571428566, "ram_util_percent": 82.80857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.876665384807286, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.145242400522585, "policy_loss": -0.02029620149929234, "vf_loss": 4.163334573513616, "vf_explained_var": 0.5731982407431123, "kl": 0.011020115929256592, "entropy": 0.8357806558646853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.298138658521037, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.8923238494408823, "policy_loss": -0.025282592856985513, "vf_loss": 3.9150460291161107, "vf_explained_var": 0.3800154676828435, "kl": 0.012802107491229892, "entropy": 0.555673556936481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 970.9599999999919}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 690.4399824135313, "episode_reward_min": -131.35493925864745, "episode_reward_mean": 152.38484073187007, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -857.1685334292545, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 1042.3719910617924}, "policy_reward_mean": {"prey_policy": -174.51658628879798, "predator_policy": 250.70900665473368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [413.230154368537, 84.81992135188995, 144.89351308835518, 28.697468108106662, 164.78817290574207, 74.60000000000004, 71.5838834764834, 204.9999999999995, 120.1154692138981, 146.39848029360851, 334.7020970674512, 416.70000000000243, 36.014614828633526, 79.14440631892272, 229.6469012666065, 170.5886629261644, 67.92986855623137, 100.20498994227675, 99.65663805254398, 254.77616211160407, -131.35493925864745, 83.08850562719526, 108.30575329552448, 657.9964006226248, 78.02725740465874, 39.43203605286373, 264.4548275627366, 42.39246591268474, 107.14441496669367, 206.08409984219833, 54.84283478454476, 55.40000000000052, 404.6000000000021, 183.05494382374377, 49.26309298541025, 47.19654529072786, 74.70071452503726, 53.73601762002983, 137.06154509635175, 298.8433224665131, 425.0000000000029, 18.703454709272663, 347.1921418542746, 63.40549289872996, 256.17139615483416, -13.368082827401498, 66.5560133221836, 86.00378716901443, 67.37301798954434, 57.116987167442865, 47.88839291377256, 119.68868335194013, 78.09999999999984, 161.25915744509743, 648.4576438692284, 51.83975937904582, -23.214362788684138, 64.6000000000006, 3.6517542723939096, -61.58579380815454, 60.396545290728035, 48.681616400240756, 690.4399824135313, 33.21873677792421, 414.0000000000025, 88.39284785136866, 120.6023648702496, 23.807154169868962, 81.26661418222284, 233.2326453773549, 125.99999999999649, 261.45419770301817, 87.9296371002291, 87.65212620876466, 211.79999999999794, 71.36535687470162, 362.9137607013191, 67.40000000000045, 160.35997620227317, 63.20000000000063, 61.90000000000061, 98.55788754337709, 57.300000000000544, 391.89774383770913, 253.38976807528667, 378.6000000000036, 235.99999999999827, 50.14819984542862, -90.91510457741423, 130.3687199405641, 446.2714508058917, 159.19061804290212, 378.8409797473222, 63.41523356135211, 62.50000000000062, 380.10000000000167, 112.05077215254319, 52.61571302544898, 65.40000000000056, 134.13784349230633], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-554.6804925170062, 315.6109256636293, -348.4359695844243, 21.690923705551878, -379.3422851664236, -392.7271095318998, -535.225978797584, -280.1590755903729, -708.9750114205226, -106.15650799056073, 15.569589352983025, -39.55034165545788, -106.84582073237763, 36.98632035581255, 98.9714001257929, -203.2853479609039, -5.996164884188289, -314.1986417762221, -486.3033500116913, 6.486734863194762, -28.63923893013626, -339.48343028330834, 376.14204778387676, 2.5846874095723558, -451.1512917270642, -245.08189432129757, -71.35507461569007, -554.1164887521662, -381.70347956531816, -259.1988628084198, -145.53049922196533, -363.46127699676936, -26.062300191581144, -375.51418868362236, -344.3104708732281, -142.5740931655494, -191.60257167603083, 58.54683618829076, -276.9150927395951, -488.7013784802857, -578.7224108163156, -444.81921921806475, -533.0944636416779, -336.5970279052859, -177.12112685231762, -340.2460634022517, 246.92547140198616, 181.56107835131857, -119.46736321738891, -2.523696138233673, -312.5602748731448, -192.36105911619225, -238.53506914422226, -198.83050153346937, -353.92331604593693, -270.43299806515006, -83.09597161058277, -133.70280542898385, -39.19616479694644, -386.1676141909618, -309.2805950522651, -188.01747593216436, -510.64357665371324, -144.96643785377242, 316.50103873583475, -6.680260760883019, -135.55649467219732, 132.2452589451011, -357.5305426864023, -333.96473330308464, -192.3386555428621, -443.005569181945, -453.4495399240564, -26.70784376866088, -239.60512984560938, -492.2353293677752, -49.77005697547682, -332.41274388348967, 145.42823020817238, -133.40945481068252, -178.65168761588387, 399.1, -380.8134396228005, -453.9858173025338, 106.33826821702178, -353.9479624473666, -77.334231138548, -109.05366318440363, 102.45846377118002, -136.95507600174003, -407.02667014953664, -843.7495374560265, -211.42195549350504, -124.2560329382134, -18.147821312892795, -323.6921778491348, -77.40839946911103, -683.6002623465154, -336.51408693262755, -267.6555656374989, -368.80629745541626, -87.86140998746852, -157.71477658778255, -498.3528721982186, 4.459409366739525, 8.71593977854945, -17.762099647249194, 14.717954340423018, 113.95637793216699, 188.62706781825014, -221.52345262221345, -857.1685334292545, -255.84946115806895, -843.3336044189898, 33.417505270771535, -344.5635557149995, -162.928731391161, -484.77378111099335, -294.2824916077809, -247.54395000102173, -496.8719184158971, -60.93078741574519, -254.53711170975183, -258.45681673720236, 377.1787780947102, -355.3130447718237, -480.39599900443125, -386.59940019539505, -135.57215079551634, 383.8, -11.472429164939907, -378.67179971492186, -239.55419231243084, 10.345651892798925, -429.916713954707, -428.08428520795786, -135.07663651989427, 33.39085480136527, -414.4949671182607, -19.66761465476369, -161.79269189506286, 58.065717069296156, -379.50765708687084, 36.734348729997286, -66.82296022838452, -74.51517426423226, -49.90971097563506, -208.82274087942216, 51.56006707283631, -108.61125552293063, -79.87502429323557, -34.85109717084818, -62.23407476799213, 266.2140048320206, -57.53638916642503, -44.880396916465415, -198.56676041086322, 11.390864871445727, -241.56605144920408, -4.46369283137647, -27.614983895535858, -195.02222464712565, -335.68608463942064, -98.06265531392367, -89.21874564471142, -174.98950638455514, 315.32711327920964, 2.730323018180122, -131.49251045471087, -33.50481324592342, 36.30746872552951, 321.41439221552446, -113.04249927092474, -150.8043719017444, -335.1283165159043, -663.4710387487613, -715.9726988388339, -373.6871467365271, -264.75393460420645, -582.595586215151, 391.9448276621356, -66.58799884325067, 16.43046587716639, 40.0000000000003, 189.02045023113698, -131.89032570220013, -33.883413900304376, -98.32532189747472, -156.6941161506897, -40.18202109536218, -112.62727918180303, 330.9529534186013, -9.616720787837266, -127.62724948816276, -742.2688622409067, -273.15770919573873, -77.23652471096047, -169.9707501434595, 32.69337089898422, -86.23876299526981], "policy_predator_policy_reward": [327.3341609514854, 324.9655602704302, 319.4421988993636, 92.12276833140587, 380.76783574546704, 536.1950720412256, 696.614270522953, 147.46825197311523, 648.9803579493865, 330.9393343674391, 22.63041064701699, 75.95034165545769, 137.84582073237587, 3.5975631206708867, 63.78194139806979, 245.53200643704, 226.64806538630924, 213.66221048800222, 391.8437356640783, 234.37135977803194, 369.016303949934, 333.80846233096486, 3.757952216123224, 34.215312590427864, 209.71842191689547, 522.5293789601017, 343.3734224490698, 361.2425472377078, 483.4268814274001, 387.12236221294836, 299.13914322847455, 380.4412959164293, 371.5617971710717, 97.9445602603676, 408.25626637858363, 178.83328760247755, 222.02189630675628, 10.690477233528133, 539.2402971218069, 481.15233620967797, 534.3586868684517, 357.8280039072823, 542.1286568772243, 410.6513402969389, 269.6790807204423, 355.99386282965725, 91.07092922063859, 138.43892164868137, 132.60104338140317, 67.41727337887713, 315.2742619990711, 229.0791080431315, 376.1245776617765, 325.69582057864915, 347.6439023917779, 319.1048776320002, 0.0, 323.9431920062587, 323.94655787253186, 307.5013209575756, 303.57484887470423, 248.56605689427226, 534.7435766537187, 176.26643785377064, 51.39896126416527, 43.380260760883374, 34.831524303603835, 151.53465524723504, 70.77101815224037, 669.9873508226626, 224.43520083358806, 458.10556918194754, 225.480862640263, 329.37723557749354, 268.43567539390403, 517.140801439517, 111.69781048906528, 407.54653546625576, 164.24339849164153, 122.58114857738012, 204.5516876158824, 0.0, 770.7661557955811, 82.73655583902696, 416.4547357354963, 178.34710034912766, 113.53423113854595, 136.2591560831312, 85.9638753684939, 204.7041330168995, 1042.3719910617924, 195.03613371637343, 82.73126350171417, 319.50273825218414, 85.90160848190872, 341.9421778491392, 219.62964054767986, 608.752039257489, 363.4682458161946, 297.8183939213799, 63.85270012409205, 440.7034002325662, 205.85254591736037, 569.9037862205817, 35.84059063326066, 29.08406022145068, 58.815428654534486, 105.48787409739292, 203.20126593706138, 142.67293218174984, 865.505256951107, 265.0264884794045, 278.4521080893031, 797.5165946990709, 15.279040019956142, 360.467010424277, 162.64466376921837, 488.70960300533096, 272.0176550749941, 208.22299272566187, 518.203201914089, 99.9960492082841, 285.5162481426866, 276.15929670451686, 329.88891479507294, 338.6853342955718, 454.9194545792107, 445.29468139854646, 37.647570211495506, 128.12458058401933, 85.02795514149186, 393.50912158974546, 265.19533191481446, 84.61557337507125, 340.0638257287668, 541.744327603771, 106.90329872019451, 76.04909718055664, 440.17352780845084, 227.2216993419333, 194.392691895061, 35.33428293070424, 441.1930034165698, 163.03450264332292, 127.71025206340629, 101.55751952943666, 240.65907345292467, 105.72550461089644, 129.33993292716383, 139.5112555229289, 65.26075003670398, 120.83072830207924, 75.69602011929933, 83.23781051798667, 91.03638916642362, 78.7803969164649, 211.8161902717095, 135.719681469983, 268.1660514492056, 41.063692831376784, 64.11498389553637, 220.4222246471242, 142.3654620061323, 389.9411654905929, 121.2187456447096, 200.2895063845537, 33.872886720790355, 39.96742081952736, 308.47581234997284, 109.91127942594916, 3.392531274470741, 17.48560778447622, 171.82503666642884, 328.02183450623835, 554.1939939347195, 494.5535611753816, 875.1888214558163, 123.55591954213331, 333.10153369408937, 644.6167070658336, 25.894795811121224, 95.01982617588062, 82.76761665760085, 19.99253550813706, 163.8899468985996, 157.8209083197824, 68.48387724158275, 127.14009211754703, 184.4941161506883, 74.8820210953619, 148.12727918180136, 13.647046581398744, 104.79588864420187, 144.4988537843425, 621.7198320819017, 446.32245238019607, 109.93652471095864, 202.67075014345764, 58.906629101015994, 128.77660648757768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.937559714075467, "mean_inference_ms": 4.607447616487821, "mean_action_processing_ms": 1.493509137427587, "mean_env_wait_ms": 10.697905147586086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01597905158996582, "StateBufferConnector_ms": 0.0041893720626831055, "ViewRequirementAgentConnector_ms": 0.18568289279937744}, "num_episodes": 10, "episode_return_max": 690.4399824135313, "episode_return_min": -131.35493925864745, "episode_return_mean": 152.38484073187007, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.68102473474724, "num_env_steps_trained_throughput_per_sec": 82.68102473474724, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 50173.306, "restore_workers_time_ms": 0.016, "training_step_time_ms": 50173.244, "sample_time_ms": 2706.469, "learn_time_ms": 47442.296, "learn_throughput": 84.313, "synch_weights_time_ms": 17.841}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "35fb9_00000", "date": "2024-08-22_09-27-04", "timestamp": 1724299024, "time_this_iter_s": 48.40028190612793, "time_total_s": 5600.814076185226, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc833a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5600.814076185226, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 37.37536231884057, "ram_util_percent": 82.13188405797102}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.022732113656545, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.116988521908957, "policy_loss": -0.0188417066723877, "vf_loss": 4.13367711198393, "vf_explained_var": 0.5058416545706451, "kl": 0.010765555901600728, "entropy": 0.8879217370477303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.92051233078437, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.4384995394913607, "policy_loss": -0.028442431158489653, "vf_loss": 3.464706266367877, "vf_explained_var": 0.2642328854591127, "kl": 0.01117846830674107, "entropy": 0.5290225156558254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 690.4399824135313, "episode_reward_min": -131.35493925864745, "episode_reward_mean": 155.66543093551456, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -857.1685334292545, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 1042.3719910617924}, "policy_reward_mean": {"prey_policy": -164.67031568990905, "predator_policy": 242.5030311576668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.7020970674512, 416.70000000000243, 36.014614828633526, 79.14440631892272, 229.6469012666065, 170.5886629261644, 67.92986855623137, 100.20498994227675, 99.65663805254398, 254.77616211160407, -131.35493925864745, 83.08850562719526, 108.30575329552448, 657.9964006226248, 78.02725740465874, 39.43203605286373, 264.4548275627366, 42.39246591268474, 107.14441496669367, 206.08409984219833, 54.84283478454476, 55.40000000000052, 404.6000000000021, 183.05494382374377, 49.26309298541025, 47.19654529072786, 74.70071452503726, 53.73601762002983, 137.06154509635175, 298.8433224665131, 425.0000000000029, 18.703454709272663, 347.1921418542746, 63.40549289872996, 256.17139615483416, -13.368082827401498, 66.5560133221836, 86.00378716901443, 67.37301798954434, 57.116987167442865, 47.88839291377256, 119.68868335194013, 78.09999999999984, 161.25915744509743, 648.4576438692284, 51.83975937904582, -23.214362788684138, 64.6000000000006, 3.6517542723939096, -61.58579380815454, 60.396545290728035, 48.681616400240756, 690.4399824135313, 33.21873677792421, 414.0000000000025, 88.39284785136866, 120.6023648702496, 23.807154169868962, 81.26661418222284, 233.2326453773549, 125.99999999999649, 261.45419770301817, 87.9296371002291, 87.65212620876466, 211.79999999999794, 71.36535687470162, 362.9137607013191, 67.40000000000045, 160.35997620227317, 63.20000000000063, 61.90000000000061, 98.55788754337709, 57.300000000000544, 391.89774383770913, 253.38976807528667, 378.6000000000036, 235.99999999999827, 50.14819984542862, -90.91510457741423, 130.3687199405641, 446.2714508058917, 159.19061804290212, 378.8409797473222, 63.41523356135211, 62.50000000000062, 380.10000000000167, 112.05077215254319, 52.61571302544898, 65.40000000000056, 134.13784349230633, 46.2534423312178, -7.888504471541049, 113.3551012058372, 51.176114912680994, 380.4507851522068, 69.24129079737695, 395.80000000000194, 72.70000000000014, 114.30175647526688, 546.7960967680259], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-28.63923893013626, -339.48343028330834, 376.14204778387676, 2.5846874095723558, -451.1512917270642, -245.08189432129757, -71.35507461569007, -554.1164887521662, -381.70347956531816, -259.1988628084198, -145.53049922196533, -363.46127699676936, -26.062300191581144, -375.51418868362236, -344.3104708732281, -142.5740931655494, -191.60257167603083, 58.54683618829076, -276.9150927395951, -488.7013784802857, -578.7224108163156, -444.81921921806475, -533.0944636416779, -336.5970279052859, -177.12112685231762, -340.2460634022517, 246.92547140198616, 181.56107835131857, -119.46736321738891, -2.523696138233673, -312.5602748731448, -192.36105911619225, -238.53506914422226, -198.83050153346937, -353.92331604593693, -270.43299806515006, -83.09597161058277, -133.70280542898385, -39.19616479694644, -386.1676141909618, -309.2805950522651, -188.01747593216436, -510.64357665371324, -144.96643785377242, 316.50103873583475, -6.680260760883019, -135.55649467219732, 132.2452589451011, -357.5305426864023, -333.96473330308464, -192.3386555428621, -443.005569181945, -453.4495399240564, -26.70784376866088, -239.60512984560938, -492.2353293677752, -49.77005697547682, -332.41274388348967, 145.42823020817238, -133.40945481068252, -178.65168761588387, 399.1, -380.8134396228005, -453.9858173025338, 106.33826821702178, -353.9479624473666, -77.334231138548, -109.05366318440363, 102.45846377118002, -136.95507600174003, -407.02667014953664, -843.7495374560265, -211.42195549350504, -124.2560329382134, -18.147821312892795, -323.6921778491348, -77.40839946911103, -683.6002623465154, -336.51408693262755, -267.6555656374989, -368.80629745541626, -87.86140998746852, -157.71477658778255, -498.3528721982186, 4.459409366739525, 8.71593977854945, -17.762099647249194, 14.717954340423018, 113.95637793216699, 188.62706781825014, -221.52345262221345, -857.1685334292545, -255.84946115806895, -843.3336044189898, 33.417505270771535, -344.5635557149995, -162.928731391161, -484.77378111099335, -294.2824916077809, -247.54395000102173, -496.8719184158971, -60.93078741574519, -254.53711170975183, -258.45681673720236, 377.1787780947102, -355.3130447718237, -480.39599900443125, -386.59940019539505, -135.57215079551634, 383.8, -11.472429164939907, -378.67179971492186, -239.55419231243084, 10.345651892798925, -429.916713954707, -428.08428520795786, -135.07663651989427, 33.39085480136527, -414.4949671182607, -19.66761465476369, -161.79269189506286, 58.065717069296156, -379.50765708687084, 36.734348729997286, -66.82296022838452, -74.51517426423226, -49.90971097563506, -208.82274087942216, 51.56006707283631, -108.61125552293063, -79.87502429323557, -34.85109717084818, -62.23407476799213, 266.2140048320206, -57.53638916642503, -44.880396916465415, -198.56676041086322, 11.390864871445727, -241.56605144920408, -4.46369283137647, -27.614983895535858, -195.02222464712565, -335.68608463942064, -98.06265531392367, -89.21874564471142, -174.98950638455514, 315.32711327920964, 2.730323018180122, -131.49251045471087, -33.50481324592342, 36.30746872552951, 321.41439221552446, -113.04249927092474, -150.8043719017444, -335.1283165159043, -663.4710387487613, -715.9726988388339, -373.6871467365271, -264.75393460420645, -582.595586215151, 391.9448276621356, -66.58799884325067, 16.43046587716639, 40.0000000000003, 189.02045023113698, -131.89032570220013, -33.883413900304376, -98.32532189747472, -156.6941161506897, -40.18202109536218, -112.62727918180303, 330.9529534186013, -9.616720787837266, -127.62724948816276, -742.2688622409067, -273.15770919573873, -77.23652471096047, -169.9707501434595, 32.69337089898422, -86.23876299526981, -138.52988465285523, -177.32556311154107, -809.3646033359919, -123.51141723470283, -6.667432938746426, -61.92315223587696, -243.78953690599744, -125.10931582890424, 72.576714373795, -370.72630284236925, -35.43153104947996, -84.00687750360025, -13.051903034256188, 302.55139268485595, -13.939757768128588, -16.96544075490271, -234.4931641134462, -35.985224661590486, -245.60022450250307, 363.98114164136035], "policy_predator_policy_reward": [369.016303949934, 333.80846233096486, 3.757952216123224, 34.215312590427864, 209.71842191689547, 522.5293789601017, 343.3734224490698, 361.2425472377078, 483.4268814274001, 387.12236221294836, 299.13914322847455, 380.4412959164293, 371.5617971710717, 97.9445602603676, 408.25626637858363, 178.83328760247755, 222.02189630675628, 10.690477233528133, 539.2402971218069, 481.15233620967797, 534.3586868684517, 357.8280039072823, 542.1286568772243, 410.6513402969389, 269.6790807204423, 355.99386282965725, 91.07092922063859, 138.43892164868137, 132.60104338140317, 67.41727337887713, 315.2742619990711, 229.0791080431315, 376.1245776617765, 325.69582057864915, 347.6439023917779, 319.1048776320002, 0.0, 323.9431920062587, 323.94655787253186, 307.5013209575756, 303.57484887470423, 248.56605689427226, 534.7435766537187, 176.26643785377064, 51.39896126416527, 43.380260760883374, 34.831524303603835, 151.53465524723504, 70.77101815224037, 669.9873508226626, 224.43520083358806, 458.10556918194754, 225.480862640263, 329.37723557749354, 268.43567539390403, 517.140801439517, 111.69781048906528, 407.54653546625576, 164.24339849164153, 122.58114857738012, 204.5516876158824, 0.0, 770.7661557955811, 82.73655583902696, 416.4547357354963, 178.34710034912766, 113.53423113854595, 136.2591560831312, 85.9638753684939, 204.7041330168995, 1042.3719910617924, 195.03613371637343, 82.73126350171417, 319.50273825218414, 85.90160848190872, 341.9421778491392, 219.62964054767986, 608.752039257489, 363.4682458161946, 297.8183939213799, 63.85270012409205, 440.7034002325662, 205.85254591736037, 569.9037862205817, 35.84059063326066, 29.08406022145068, 58.815428654534486, 105.48787409739292, 203.20126593706138, 142.67293218174984, 865.505256951107, 265.0264884794045, 278.4521080893031, 797.5165946990709, 15.279040019956142, 360.467010424277, 162.64466376921837, 488.70960300533096, 272.0176550749941, 208.22299272566187, 518.203201914089, 99.9960492082841, 285.5162481426866, 276.15929670451686, 329.88891479507294, 338.6853342955718, 454.9194545792107, 445.29468139854646, 37.647570211495506, 128.12458058401933, 85.02795514149186, 393.50912158974546, 265.19533191481446, 84.61557337507125, 340.0638257287668, 541.744327603771, 106.90329872019451, 76.04909718055664, 440.17352780845084, 227.2216993419333, 194.392691895061, 35.33428293070424, 441.1930034165698, 163.03450264332292, 127.71025206340629, 101.55751952943666, 240.65907345292467, 105.72550461089644, 129.33993292716383, 139.5112555229289, 65.26075003670398, 120.83072830207924, 75.69602011929933, 83.23781051798667, 91.03638916642362, 78.7803969164649, 211.8161902717095, 135.719681469983, 268.1660514492056, 41.063692831376784, 64.11498389553637, 220.4222246471242, 142.3654620061323, 389.9411654905929, 121.2187456447096, 200.2895063845537, 33.872886720790355, 39.96742081952736, 308.47581234997284, 109.91127942594916, 3.392531274470741, 17.48560778447622, 171.82503666642884, 328.02183450623835, 554.1939939347195, 494.5535611753816, 875.1888214558163, 123.55591954213331, 333.10153369408937, 644.6167070658336, 25.894795811121224, 95.01982617588062, 82.76761665760085, 19.99253550813706, 163.8899468985996, 157.8209083197824, 68.48387724158275, 127.14009211754703, 184.4941161506883, 74.8820210953619, 148.12727918180136, 13.647046581398744, 104.79588864420187, 144.4988537843425, 621.7198320819017, 446.32245238019607, 109.93652471095864, 202.67075014345764, 58.906629101015994, 128.77660648757768, 175.21666638675455, 186.89222370885577, 833.9200465959464, 91.06746950320813, 71.87040920535452, 110.0752771751077, 65.90550717546529, 354.16946047211616, 453.36848308501044, 225.23189053577408, 71.23153104947995, 117.44816830097511, 51.25190303425664, 55.04860731514405, 49.83975776812906, 53.76544075490323, 260.11985221195664, 124.66029303834928, 270.15943523709234, 158.25574439207293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.935565374468296, "mean_inference_ms": 4.605093495913788, "mean_action_processing_ms": 1.4954790838634018, "mean_env_wait_ms": 10.692460653435118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013518571853637695, "StateBufferConnector_ms": 0.004381418228149414, "ViewRequirementAgentConnector_ms": 0.18136096000671387}, "num_episodes": 10, "episode_return_max": 690.4399824135313, "episode_return_min": -131.35493925864745, "episode_return_mean": 155.66543093551456, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.93117269979251, "num_env_steps_trained_throughput_per_sec": 79.93117269979251, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 49742.296, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49742.234, "sample_time_ms": 2754.191, "learn_time_ms": 46962.904, "learn_throughput": 85.174, "synch_weights_time_ms": 18.109}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "35fb9_00000", "date": "2024-08-22_09-27-54", "timestamp": 1724299074, "time_this_iter_s": 50.078827142715454, "time_total_s": 5650.892903327942, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcd79d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5650.892903327942, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 36.894366197183096, "ram_util_percent": 83.09014084507045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.44344378325044, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.144494841843055, "policy_loss": -0.020532004188539253, "vf_loss": 4.1620628170235445, "vf_explained_var": 0.4458394317084519, "kl": 0.014820092893082393, "entropy": 0.9081273749707237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.043779090851073, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.455221925336848, "policy_loss": -0.025462039348807326, "vf_loss": 3.478476775638641, "vf_explained_var": 0.026048199840323635, "kl": 0.011035942441103832, "entropy": 0.5199682811580638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 690.4399824135313, "episode_reward_min": -90.91510457741423, "episode_reward_mean": 165.39045315465282, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -857.1685334292545, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 1042.3719910617924}, "policy_reward_mean": {"prey_policy": -151.45534563138636, "predator_policy": 234.15057220871324}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.08850562719526, 108.30575329552448, 657.9964006226248, 78.02725740465874, 39.43203605286373, 264.4548275627366, 42.39246591268474, 107.14441496669367, 206.08409984219833, 54.84283478454476, 55.40000000000052, 404.6000000000021, 183.05494382374377, 49.26309298541025, 47.19654529072786, 74.70071452503726, 53.73601762002983, 137.06154509635175, 298.8433224665131, 425.0000000000029, 18.703454709272663, 347.1921418542746, 63.40549289872996, 256.17139615483416, -13.368082827401498, 66.5560133221836, 86.00378716901443, 67.37301798954434, 57.116987167442865, 47.88839291377256, 119.68868335194013, 78.09999999999984, 161.25915744509743, 648.4576438692284, 51.83975937904582, -23.214362788684138, 64.6000000000006, 3.6517542723939096, -61.58579380815454, 60.396545290728035, 48.681616400240756, 690.4399824135313, 33.21873677792421, 414.0000000000025, 88.39284785136866, 120.6023648702496, 23.807154169868962, 81.26661418222284, 233.2326453773549, 125.99999999999649, 261.45419770301817, 87.9296371002291, 87.65212620876466, 211.79999999999794, 71.36535687470162, 362.9137607013191, 67.40000000000045, 160.35997620227317, 63.20000000000063, 61.90000000000061, 98.55788754337709, 57.300000000000544, 391.89774383770913, 253.38976807528667, 378.6000000000036, 235.99999999999827, 50.14819984542862, -90.91510457741423, 130.3687199405641, 446.2714508058917, 159.19061804290212, 378.8409797473222, 63.41523356135211, 62.50000000000062, 380.10000000000167, 112.05077215254319, 52.61571302544898, 65.40000000000056, 134.13784349230633, 46.2534423312178, -7.888504471541049, 113.3551012058372, 51.176114912680994, 380.4507851522068, 69.24129079737695, 395.80000000000194, 72.70000000000014, 114.30175647526688, 546.7960967680259, 188.04272923191354, 135.111664238704, 200.40740180522909, 86.07888698860297, 112.41824598668163, 624.8396518143601, 202.29489382960932, 329.18830266700365, 84.92309824691657, 419.6000000000024, 247.60674891658903], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-533.0944636416779, -336.5970279052859, -177.12112685231762, -340.2460634022517, 246.92547140198616, 181.56107835131857, -119.46736321738891, -2.523696138233673, -312.5602748731448, -192.36105911619225, -238.53506914422226, -198.83050153346937, -353.92331604593693, -270.43299806515006, -83.09597161058277, -133.70280542898385, -39.19616479694644, -386.1676141909618, -309.2805950522651, -188.01747593216436, -510.64357665371324, -144.96643785377242, 316.50103873583475, -6.680260760883019, -135.55649467219732, 132.2452589451011, -357.5305426864023, -333.96473330308464, -192.3386555428621, -443.005569181945, -453.4495399240564, -26.70784376866088, -239.60512984560938, -492.2353293677752, -49.77005697547682, -332.41274388348967, 145.42823020817238, -133.40945481068252, -178.65168761588387, 399.1, -380.8134396228005, -453.9858173025338, 106.33826821702178, -353.9479624473666, -77.334231138548, -109.05366318440363, 102.45846377118002, -136.95507600174003, -407.02667014953664, -843.7495374560265, -211.42195549350504, -124.2560329382134, -18.147821312892795, -323.6921778491348, -77.40839946911103, -683.6002623465154, -336.51408693262755, -267.6555656374989, -368.80629745541626, -87.86140998746852, -157.71477658778255, -498.3528721982186, 4.459409366739525, 8.71593977854945, -17.762099647249194, 14.717954340423018, 113.95637793216699, 188.62706781825014, -221.52345262221345, -857.1685334292545, -255.84946115806895, -843.3336044189898, 33.417505270771535, -344.5635557149995, -162.928731391161, -484.77378111099335, -294.2824916077809, -247.54395000102173, -496.8719184158971, -60.93078741574519, -254.53711170975183, -258.45681673720236, 377.1787780947102, -355.3130447718237, -480.39599900443125, -386.59940019539505, -135.57215079551634, 383.8, -11.472429164939907, -378.67179971492186, -239.55419231243084, 10.345651892798925, -429.916713954707, -428.08428520795786, -135.07663651989427, 33.39085480136527, -414.4949671182607, -19.66761465476369, -161.79269189506286, 58.065717069296156, -379.50765708687084, 36.734348729997286, -66.82296022838452, -74.51517426423226, -49.90971097563506, -208.82274087942216, 51.56006707283631, -108.61125552293063, -79.87502429323557, -34.85109717084818, -62.23407476799213, 266.2140048320206, -57.53638916642503, -44.880396916465415, -198.56676041086322, 11.390864871445727, -241.56605144920408, -4.46369283137647, -27.614983895535858, -195.02222464712565, -335.68608463942064, -98.06265531392367, -89.21874564471142, -174.98950638455514, 315.32711327920964, 2.730323018180122, -131.49251045471087, -33.50481324592342, 36.30746872552951, 321.41439221552446, -113.04249927092474, -150.8043719017444, -335.1283165159043, -663.4710387487613, -715.9726988388339, -373.6871467365271, -264.75393460420645, -582.595586215151, 391.9448276621356, -66.58799884325067, 16.43046587716639, 40.0000000000003, 189.02045023113698, -131.89032570220013, -33.883413900304376, -98.32532189747472, -156.6941161506897, -40.18202109536218, -112.62727918180303, 330.9529534186013, -9.616720787837266, -127.62724948816276, -742.2688622409067, -273.15770919573873, -77.23652471096047, -169.9707501434595, 32.69337089898422, -86.23876299526981, -138.52988465285523, -177.32556311154107, -809.3646033359919, -123.51141723470283, -6.667432938746426, -61.92315223587696, -243.78953690599744, -125.10931582890424, 72.576714373795, -370.72630284236925, -35.43153104947996, -84.00687750360025, -13.051903034256188, 302.55139268485595, -13.939757768128588, -16.96544075490271, -234.4931641134462, -35.985224661590486, -245.60022450250307, 363.98114164136035, -386.54356452257247, -48.78956221287277, 8.815929931339575, -104.80561964544108, -744.1435694058571, -195.49544049339997, 17.35391540192908, -350.40327587621204, -630.6614427251734, -14.620685281380531, 263.52856804633575, 240.61087758578844, -362.16478535921925, -63.682370984196965, -81.91510360631874, 142.00802224594602, -328.79099714587124, 1.8071249316704343, -26.815908889227764, 355.9964953706385, 23.821912059219276, -343.7861994052642], "policy_predator_policy_reward": [542.1286568772243, 410.6513402969389, 269.6790807204423, 355.99386282965725, 91.07092922063859, 138.43892164868137, 132.60104338140317, 67.41727337887713, 315.2742619990711, 229.0791080431315, 376.1245776617765, 325.69582057864915, 347.6439023917779, 319.1048776320002, 0.0, 323.9431920062587, 323.94655787253186, 307.5013209575756, 303.57484887470423, 248.56605689427226, 534.7435766537187, 176.26643785377064, 51.39896126416527, 43.380260760883374, 34.831524303603835, 151.53465524723504, 70.77101815224037, 669.9873508226626, 224.43520083358806, 458.10556918194754, 225.480862640263, 329.37723557749354, 268.43567539390403, 517.140801439517, 111.69781048906528, 407.54653546625576, 164.24339849164153, 122.58114857738012, 204.5516876158824, 0.0, 770.7661557955811, 82.73655583902696, 416.4547357354963, 178.34710034912766, 113.53423113854595, 136.2591560831312, 85.9638753684939, 204.7041330168995, 1042.3719910617924, 195.03613371637343, 82.73126350171417, 319.50273825218414, 85.90160848190872, 341.9421778491392, 219.62964054767986, 608.752039257489, 363.4682458161946, 297.8183939213799, 63.85270012409205, 440.7034002325662, 205.85254591736037, 569.9037862205817, 35.84059063326066, 29.08406022145068, 58.815428654534486, 105.48787409739292, 203.20126593706138, 142.67293218174984, 865.505256951107, 265.0264884794045, 278.4521080893031, 797.5165946990709, 15.279040019956142, 360.467010424277, 162.64466376921837, 488.70960300533096, 272.0176550749941, 208.22299272566187, 518.203201914089, 99.9960492082841, 285.5162481426866, 276.15929670451686, 329.88891479507294, 338.6853342955718, 454.9194545792107, 445.29468139854646, 37.647570211495506, 128.12458058401933, 85.02795514149186, 393.50912158974546, 265.19533191481446, 84.61557337507125, 340.0638257287668, 541.744327603771, 106.90329872019451, 76.04909718055664, 440.17352780845084, 227.2216993419333, 194.392691895061, 35.33428293070424, 441.1930034165698, 163.03450264332292, 127.71025206340629, 101.55751952943666, 240.65907345292467, 105.72550461089644, 129.33993292716383, 139.5112555229289, 65.26075003670398, 120.83072830207924, 75.69602011929933, 83.23781051798667, 91.03638916642362, 78.7803969164649, 211.8161902717095, 135.719681469983, 268.1660514492056, 41.063692831376784, 64.11498389553637, 220.4222246471242, 142.3654620061323, 389.9411654905929, 121.2187456447096, 200.2895063845537, 33.872886720790355, 39.96742081952736, 308.47581234997284, 109.91127942594916, 3.392531274470741, 17.48560778447622, 171.82503666642884, 328.02183450623835, 554.1939939347195, 494.5535611753816, 875.1888214558163, 123.55591954213331, 333.10153369408937, 644.6167070658336, 25.894795811121224, 95.01982617588062, 82.76761665760085, 19.99253550813706, 163.8899468985996, 157.8209083197824, 68.48387724158275, 127.14009211754703, 184.4941161506883, 74.8820210953619, 148.12727918180136, 13.647046581398744, 104.79588864420187, 144.4988537843425, 621.7198320819017, 446.32245238019607, 109.93652471095864, 202.67075014345764, 58.906629101015994, 128.77660648757768, 175.21666638675455, 186.89222370885577, 833.9200465959464, 91.06746950320813, 71.87040920535452, 110.0752771751077, 65.90550717546529, 354.16946047211616, 453.36848308501044, 225.23189053577408, 71.23153104947995, 117.44816830097511, 51.25190303425664, 55.04860731514405, 49.83975776812906, 53.76544075490323, 260.11985221195664, 124.66029303834928, 270.15943523709234, 158.25574439207293, 419.8052620404662, 203.5705939268966, 141.5000559597024, 89.60129799310498, 707.4342007204366, 432.6122109840484, 56.49935587187133, 362.62889159102104, 687.0756500175761, 70.6247239756625, 120.7002061822356, 0.0, 225.91559258496855, 402.2264575880564, 122.02507969847196, 147.07030432890178, 270.6741086294183, 141.2328618317027, 62.41590888922827, 28.00350462936147, 337.32744027962906, 230.24359598300688]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9347787437431325, "mean_inference_ms": 4.589593158160397, "mean_action_processing_ms": 1.4907326098950973, "mean_env_wait_ms": 10.680437957042692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0134199857711792, "StateBufferConnector_ms": 0.0042449235916137695, "ViewRequirementAgentConnector_ms": 0.1722017526626587}, "num_episodes": 11, "episode_return_max": 690.4399824135313, "episode_return_min": -90.91510457741423, "episode_return_mean": 165.39045315465282, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.01979516483954, "num_env_steps_trained_throughput_per_sec": 80.01979516483954, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 49445.789, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49445.727, "sample_time_ms": 2489.918, "learn_time_ms": 46931.477, "learn_throughput": 85.231, "synch_weights_time_ms": 18.018}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "35fb9_00000", "date": "2024-08-22_09-28-44", "timestamp": 1724299124, "time_this_iter_s": 50.03453493118286, "time_total_s": 5700.927438259125, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0f718b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5700.927438259125, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 37.89142857142858, "ram_util_percent": 83.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.876921511579443, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.048584903358782, "policy_loss": -0.020438375738178374, "vf_loss": 4.066496688222128, "vf_explained_var": 0.5515938040125307, "kl": 0.012632995286572074, "entropy": 0.8769193160155463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.609327499260978, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.6598641598666157, "policy_loss": -0.02764984353731273, "vf_loss": 3.684708955931285, "vf_explained_var": 0.24745459263286892, "kl": 0.014025256242824807, "entropy": 0.5621440152011851, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 690.4399824135313, "episode_reward_min": -90.91510457741423, "episode_reward_mean": 167.92101969191276, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -857.1685334292545, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 399.1, "predator_policy": 1042.3719910617924}, "policy_reward_mean": {"prey_policy": -145.0328826200923, "predator_policy": 228.99339246604907}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.26309298541025, 47.19654529072786, 74.70071452503726, 53.73601762002983, 137.06154509635175, 298.8433224665131, 425.0000000000029, 18.703454709272663, 347.1921418542746, 63.40549289872996, 256.17139615483416, -13.368082827401498, 66.5560133221836, 86.00378716901443, 67.37301798954434, 57.116987167442865, 47.88839291377256, 119.68868335194013, 78.09999999999984, 161.25915744509743, 648.4576438692284, 51.83975937904582, -23.214362788684138, 64.6000000000006, 3.6517542723939096, -61.58579380815454, 60.396545290728035, 48.681616400240756, 690.4399824135313, 33.21873677792421, 414.0000000000025, 88.39284785136866, 120.6023648702496, 23.807154169868962, 81.26661418222284, 233.2326453773549, 125.99999999999649, 261.45419770301817, 87.9296371002291, 87.65212620876466, 211.79999999999794, 71.36535687470162, 362.9137607013191, 67.40000000000045, 160.35997620227317, 63.20000000000063, 61.90000000000061, 98.55788754337709, 57.300000000000544, 391.89774383770913, 253.38976807528667, 378.6000000000036, 235.99999999999827, 50.14819984542862, -90.91510457741423, 130.3687199405641, 446.2714508058917, 159.19061804290212, 378.8409797473222, 63.41523356135211, 62.50000000000062, 380.10000000000167, 112.05077215254319, 52.61571302544898, 65.40000000000056, 134.13784349230633, 46.2534423312178, -7.888504471541049, 113.3551012058372, 51.176114912680994, 380.4507851522068, 69.24129079737695, 395.80000000000194, 72.70000000000014, 114.30175647526688, 546.7960967680259, 188.04272923191354, 135.111664238704, 200.40740180522909, 86.07888698860297, 112.41824598668163, 624.8396518143601, 202.29489382960932, 329.18830266700365, 84.92309824691657, 419.6000000000024, 247.60674891658903, 89.19294591335138, 204.4000000000002, 69.20000000000034, 168.85647192171683, 309.4157143322698, 521.837498707628, 63.40000000000063, 364.01568118594827, 86.60807066281411, 60.400000000000574, 101.85242240067191, 272.56584948773275, 226.13553900933158], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-357.5305426864023, -333.96473330308464, -192.3386555428621, -443.005569181945, -453.4495399240564, -26.70784376866088, -239.60512984560938, -492.2353293677752, -49.77005697547682, -332.41274388348967, 145.42823020817238, -133.40945481068252, -178.65168761588387, 399.1, -380.8134396228005, -453.9858173025338, 106.33826821702178, -353.9479624473666, -77.334231138548, -109.05366318440363, 102.45846377118002, -136.95507600174003, -407.02667014953664, -843.7495374560265, -211.42195549350504, -124.2560329382134, -18.147821312892795, -323.6921778491348, -77.40839946911103, -683.6002623465154, -336.51408693262755, -267.6555656374989, -368.80629745541626, -87.86140998746852, -157.71477658778255, -498.3528721982186, 4.459409366739525, 8.71593977854945, -17.762099647249194, 14.717954340423018, 113.95637793216699, 188.62706781825014, -221.52345262221345, -857.1685334292545, -255.84946115806895, -843.3336044189898, 33.417505270771535, -344.5635557149995, -162.928731391161, -484.77378111099335, -294.2824916077809, -247.54395000102173, -496.8719184158971, -60.93078741574519, -254.53711170975183, -258.45681673720236, 377.1787780947102, -355.3130447718237, -480.39599900443125, -386.59940019539505, -135.57215079551634, 383.8, -11.472429164939907, -378.67179971492186, -239.55419231243084, 10.345651892798925, -429.916713954707, -428.08428520795786, -135.07663651989427, 33.39085480136527, -414.4949671182607, -19.66761465476369, -161.79269189506286, 58.065717069296156, -379.50765708687084, 36.734348729997286, -66.82296022838452, -74.51517426423226, -49.90971097563506, -208.82274087942216, 51.56006707283631, -108.61125552293063, -79.87502429323557, -34.85109717084818, -62.23407476799213, 266.2140048320206, -57.53638916642503, -44.880396916465415, -198.56676041086322, 11.390864871445727, -241.56605144920408, -4.46369283137647, -27.614983895535858, -195.02222464712565, -335.68608463942064, -98.06265531392367, -89.21874564471142, -174.98950638455514, 315.32711327920964, 2.730323018180122, -131.49251045471087, -33.50481324592342, 36.30746872552951, 321.41439221552446, -113.04249927092474, -150.8043719017444, -335.1283165159043, -663.4710387487613, -715.9726988388339, -373.6871467365271, -264.75393460420645, -582.595586215151, 391.9448276621356, -66.58799884325067, 16.43046587716639, 40.0000000000003, 189.02045023113698, -131.89032570220013, -33.883413900304376, -98.32532189747472, -156.6941161506897, -40.18202109536218, -112.62727918180303, 330.9529534186013, -9.616720787837266, -127.62724948816276, -742.2688622409067, -273.15770919573873, -77.23652471096047, -169.9707501434595, 32.69337089898422, -86.23876299526981, -138.52988465285523, -177.32556311154107, -809.3646033359919, -123.51141723470283, -6.667432938746426, -61.92315223587696, -243.78953690599744, -125.10931582890424, 72.576714373795, -370.72630284236925, -35.43153104947996, -84.00687750360025, -13.051903034256188, 302.55139268485595, -13.939757768128588, -16.96544075490271, -234.4931641134462, -35.985224661590486, -245.60022450250307, 363.98114164136035, -386.54356452257247, -48.78956221287277, 8.815929931339575, -104.80561964544108, -744.1435694058571, -195.49544049339997, 17.35391540192908, -350.40327587621204, -630.6614427251734, -14.620685281380531, 263.52856804633575, 240.61087758578844, -362.16478535921925, -63.682370984196965, -81.91510360631874, 142.00802224594602, -328.79099714587124, 1.8071249316704343, -26.815908889227764, 355.9964953706385, 23.821912059219276, -343.7861994052642, -20.159979560330385, -129.92085303546529, -346.67984498345885, 37.94268278828395, -222.49665234206478, -0.16501669565516472, -196.52702669673212, 17.505464452939833, -75.38825918227224, -125.616117368407, 289.29587430503665, -421.69341679276346, -75.12380575123669, -276.38462209465416, 136.93439446373534, -130.62230986933673, -403.41683677236887, -83.111807522041, -323.8015138584678, 3.541910910196687, -149.2697817452848, -20.6086004827297, -44.46099032108971, 118.04789229159967, -132.60806271232195, -276.4876286197939], "policy_predator_policy_reward": [70.77101815224037, 669.9873508226626, 224.43520083358806, 458.10556918194754, 225.480862640263, 329.37723557749354, 268.43567539390403, 517.140801439517, 111.69781048906528, 407.54653546625576, 164.24339849164153, 122.58114857738012, 204.5516876158824, 0.0, 770.7661557955811, 82.73655583902696, 416.4547357354963, 178.34710034912766, 113.53423113854595, 136.2591560831312, 85.9638753684939, 204.7041330168995, 1042.3719910617924, 195.03613371637343, 82.73126350171417, 319.50273825218414, 85.90160848190872, 341.9421778491392, 219.62964054767986, 608.752039257489, 363.4682458161946, 297.8183939213799, 63.85270012409205, 440.7034002325662, 205.85254591736037, 569.9037862205817, 35.84059063326066, 29.08406022145068, 58.815428654534486, 105.48787409739292, 203.20126593706138, 142.67293218174984, 865.505256951107, 265.0264884794045, 278.4521080893031, 797.5165946990709, 15.279040019956142, 360.467010424277, 162.64466376921837, 488.70960300533096, 272.0176550749941, 208.22299272566187, 518.203201914089, 99.9960492082841, 285.5162481426866, 276.15929670451686, 329.88891479507294, 338.6853342955718, 454.9194545792107, 445.29468139854646, 37.647570211495506, 128.12458058401933, 85.02795514149186, 393.50912158974546, 265.19533191481446, 84.61557337507125, 340.0638257287668, 541.744327603771, 106.90329872019451, 76.04909718055664, 440.17352780845084, 227.2216993419333, 194.392691895061, 35.33428293070424, 441.1930034165698, 163.03450264332292, 127.71025206340629, 101.55751952943666, 240.65907345292467, 105.72550461089644, 129.33993292716383, 139.5112555229289, 65.26075003670398, 120.83072830207924, 75.69602011929933, 83.23781051798667, 91.03638916642362, 78.7803969164649, 211.8161902717095, 135.719681469983, 268.1660514492056, 41.063692831376784, 64.11498389553637, 220.4222246471242, 142.3654620061323, 389.9411654905929, 121.2187456447096, 200.2895063845537, 33.872886720790355, 39.96742081952736, 308.47581234997284, 109.91127942594916, 3.392531274470741, 17.48560778447622, 171.82503666642884, 328.02183450623835, 554.1939939347195, 494.5535611753816, 875.1888214558163, 123.55591954213331, 333.10153369408937, 644.6167070658336, 25.894795811121224, 95.01982617588062, 82.76761665760085, 19.99253550813706, 163.8899468985996, 157.8209083197824, 68.48387724158275, 127.14009211754703, 184.4941161506883, 74.8820210953619, 148.12727918180136, 13.647046581398744, 104.79588864420187, 144.4988537843425, 621.7198320819017, 446.32245238019607, 109.93652471095864, 202.67075014345764, 58.906629101015994, 128.77660648757768, 175.21666638675455, 186.89222370885577, 833.9200465959464, 91.06746950320813, 71.87040920535452, 110.0752771751077, 65.90550717546529, 354.16946047211616, 453.36848308501044, 225.23189053577408, 71.23153104947995, 117.44816830097511, 51.25190303425664, 55.04860731514405, 49.83975776812906, 53.76544075490323, 260.11985221195664, 124.66029303834928, 270.15943523709234, 158.25574439207293, 419.8052620404662, 203.5705939268966, 141.5000559597024, 89.60129799310498, 707.4342007204366, 432.6122109840484, 56.49935587187133, 362.62889159102104, 687.0756500175761, 70.6247239756625, 120.7002061822356, 0.0, 225.91559258496855, 402.2264575880564, 122.02507969847196, 147.07030432890178, 270.6741086294183, 141.2328618317027, 62.41590888922827, 28.00350462936147, 337.32744027962906, 230.24359598300688, 98.91593502914287, 140.35784348000402, 465.20740093199885, 47.9297612631772, 254.1966523420632, 37.66501669565543, 112.4847832226985, 235.3932509428131, 201.9419660579168, 308.47812482503207, 376.5849392679652, 277.6501019273896, 110.92035104196232, 303.98807680393367, 187.01201601643527, 170.69158057510973, 204.29073575984668, 368.84597919738184, 17.56935647142952, 363.09024647684595, 87.59819571086236, 184.13260891782187, 83.04487379757231, 115.93407371965029, 260.2110228090195, 375.0202075324274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.938333022032281, "mean_inference_ms": 4.591306712602463, "mean_action_processing_ms": 1.483292566842299, "mean_env_wait_ms": 10.682088137916475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013569235801696777, "StateBufferConnector_ms": 0.005849719047546387, "ViewRequirementAgentConnector_ms": 0.16117441654205322}, "num_episodes": 13, "episode_return_max": 690.4399824135313, "episode_return_min": -90.91510457741423, "episode_return_mean": 167.92101969191276, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.18494593762576, "num_env_steps_trained_throughput_per_sec": 78.18494593762576, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 49715.668, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49715.597, "sample_time_ms": 2551.287, "learn_time_ms": 47139.43, "learn_throughput": 84.855, "synch_weights_time_ms": 18.599}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "35fb9_00000", "date": "2024-08-22_09-29-35", "timestamp": 1724299175, "time_this_iter_s": 51.211705923080444, "time_total_s": 5752.139144182205, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fc83ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5752.139144182205, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 41.97671232876713, "ram_util_percent": 83.06301369863014}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.793104824691852, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.008467469518147, "policy_loss": -0.019131178254010305, "vf_loss": 4.025531294989207, "vf_explained_var": 0.5269755274215072, "kl": 0.01033680052816789, "entropy": 0.8843419084788631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.12212759975403, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.7630202086514264, "policy_loss": -0.025432326405052903, "vf_loss": 3.786082692499514, "vf_explained_var": 0.23750778934942982, "kl": 0.01184922828543537, "entropy": 0.5510332701067445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 690.4399824135313, "episode_reward_min": -90.91510457741423, "episode_reward_mean": 163.9849233698743, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -857.1685334292545, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9448276621356, "predator_policy": 1042.3719910617924}, "policy_reward_mean": {"prey_policy": -150.78446706187543, "predator_policy": 232.77692874681304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.40549289872996, 256.17139615483416, -13.368082827401498, 66.5560133221836, 86.00378716901443, 67.37301798954434, 57.116987167442865, 47.88839291377256, 119.68868335194013, 78.09999999999984, 161.25915744509743, 648.4576438692284, 51.83975937904582, -23.214362788684138, 64.6000000000006, 3.6517542723939096, -61.58579380815454, 60.396545290728035, 48.681616400240756, 690.4399824135313, 33.21873677792421, 414.0000000000025, 88.39284785136866, 120.6023648702496, 23.807154169868962, 81.26661418222284, 233.2326453773549, 125.99999999999649, 261.45419770301817, 87.9296371002291, 87.65212620876466, 211.79999999999794, 71.36535687470162, 362.9137607013191, 67.40000000000045, 160.35997620227317, 63.20000000000063, 61.90000000000061, 98.55788754337709, 57.300000000000544, 391.89774383770913, 253.38976807528667, 378.6000000000036, 235.99999999999827, 50.14819984542862, -90.91510457741423, 130.3687199405641, 446.2714508058917, 159.19061804290212, 378.8409797473222, 63.41523356135211, 62.50000000000062, 380.10000000000167, 112.05077215254319, 52.61571302544898, 65.40000000000056, 134.13784349230633, 46.2534423312178, -7.888504471541049, 113.3551012058372, 51.176114912680994, 380.4507851522068, 69.24129079737695, 395.80000000000194, 72.70000000000014, 114.30175647526688, 546.7960967680259, 188.04272923191354, 135.111664238704, 200.40740180522909, 86.07888698860297, 112.41824598668163, 624.8396518143601, 202.29489382960932, 329.18830266700365, 84.92309824691657, 419.6000000000024, 247.60674891658903, 89.19294591335138, 204.4000000000002, 69.20000000000034, 168.85647192171683, 309.4157143322698, 521.837498707628, 63.40000000000063, 364.01568118594827, 86.60807066281411, 60.400000000000574, 101.85242240067191, 272.56584948773275, 226.13553900933158, 140.55933774414117, 78.86662025157369, 257.6999999999991, 73.91297797590575, 84.17826993995963, -49.92973053157165, 294.7838370860947, 139.3538370353959, 38.66205284227359], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-77.334231138548, -109.05366318440363, 102.45846377118002, -136.95507600174003, -407.02667014953664, -843.7495374560265, -211.42195549350504, -124.2560329382134, -18.147821312892795, -323.6921778491348, -77.40839946911103, -683.6002623465154, -336.51408693262755, -267.6555656374989, -368.80629745541626, -87.86140998746852, -157.71477658778255, -498.3528721982186, 4.459409366739525, 8.71593977854945, -17.762099647249194, 14.717954340423018, 113.95637793216699, 188.62706781825014, -221.52345262221345, -857.1685334292545, -255.84946115806895, -843.3336044189898, 33.417505270771535, -344.5635557149995, -162.928731391161, -484.77378111099335, -294.2824916077809, -247.54395000102173, -496.8719184158971, -60.93078741574519, -254.53711170975183, -258.45681673720236, 377.1787780947102, -355.3130447718237, -480.39599900443125, -386.59940019539505, -135.57215079551634, 383.8, -11.472429164939907, -378.67179971492186, -239.55419231243084, 10.345651892798925, -429.916713954707, -428.08428520795786, -135.07663651989427, 33.39085480136527, -414.4949671182607, -19.66761465476369, -161.79269189506286, 58.065717069296156, -379.50765708687084, 36.734348729997286, -66.82296022838452, -74.51517426423226, -49.90971097563506, -208.82274087942216, 51.56006707283631, -108.61125552293063, -79.87502429323557, -34.85109717084818, -62.23407476799213, 266.2140048320206, -57.53638916642503, -44.880396916465415, -198.56676041086322, 11.390864871445727, -241.56605144920408, -4.46369283137647, -27.614983895535858, -195.02222464712565, -335.68608463942064, -98.06265531392367, -89.21874564471142, -174.98950638455514, 315.32711327920964, 2.730323018180122, -131.49251045471087, -33.50481324592342, 36.30746872552951, 321.41439221552446, -113.04249927092474, -150.8043719017444, -335.1283165159043, -663.4710387487613, -715.9726988388339, -373.6871467365271, -264.75393460420645, -582.595586215151, 391.9448276621356, -66.58799884325067, 16.43046587716639, 40.0000000000003, 189.02045023113698, -131.89032570220013, -33.883413900304376, -98.32532189747472, -156.6941161506897, -40.18202109536218, -112.62727918180303, 330.9529534186013, -9.616720787837266, -127.62724948816276, -742.2688622409067, -273.15770919573873, -77.23652471096047, -169.9707501434595, 32.69337089898422, -86.23876299526981, -138.52988465285523, -177.32556311154107, -809.3646033359919, -123.51141723470283, -6.667432938746426, -61.92315223587696, -243.78953690599744, -125.10931582890424, 72.576714373795, -370.72630284236925, -35.43153104947996, -84.00687750360025, -13.051903034256188, 302.55139268485595, -13.939757768128588, -16.96544075490271, -234.4931641134462, -35.985224661590486, -245.60022450250307, 363.98114164136035, -386.54356452257247, -48.78956221287277, 8.815929931339575, -104.80561964544108, -744.1435694058571, -195.49544049339997, 17.35391540192908, -350.40327587621204, -630.6614427251734, -14.620685281380531, 263.52856804633575, 240.61087758578844, -362.16478535921925, -63.682370984196965, -81.91510360631874, 142.00802224594602, -328.79099714587124, 1.8071249316704343, -26.815908889227764, 355.9964953706385, 23.821912059219276, -343.7861994052642, -20.159979560330385, -129.92085303546529, -346.67984498345885, 37.94268278828395, -222.49665234206478, -0.16501669565516472, -196.52702669673212, 17.505464452939833, -75.38825918227224, -125.616117368407, 289.29587430503665, -421.69341679276346, -75.12380575123669, -276.38462209465416, 136.93439446373534, -130.62230986933673, -403.41683677236887, -83.111807522041, -323.8015138584678, 3.541910910196687, -149.2697817452848, -20.6086004827297, -44.46099032108971, 118.04789229159967, -132.60806271232195, -276.4876286197939, -293.1686876507688, -548.2382555453569, -4.022586465375248, -416.32156805212213, -230.9343963062881, -132.75979192817152, -503.55941895576365, -228.30757886502022, -253.72131512211368, -574.5342556752067, -151.04840868773266, -496.7557669973964, -152.05241973825053, 9.885908909711112, 43.63781598402281, -499.93574549684956, -4.653150760575965, -484.78927485680407], "policy_predator_policy_reward": [113.53423113854595, 136.2591560831312, 85.9638753684939, 204.7041330168995, 1042.3719910617924, 195.03613371637343, 82.73126350171417, 319.50273825218414, 85.90160848190872, 341.9421778491392, 219.62964054767986, 608.752039257489, 363.4682458161946, 297.8183939213799, 63.85270012409205, 440.7034002325662, 205.85254591736037, 569.9037862205817, 35.84059063326066, 29.08406022145068, 58.815428654534486, 105.48787409739292, 203.20126593706138, 142.67293218174984, 865.505256951107, 265.0264884794045, 278.4521080893031, 797.5165946990709, 15.279040019956142, 360.467010424277, 162.64466376921837, 488.70960300533096, 272.0176550749941, 208.22299272566187, 518.203201914089, 99.9960492082841, 285.5162481426866, 276.15929670451686, 329.88891479507294, 338.6853342955718, 454.9194545792107, 445.29468139854646, 37.647570211495506, 128.12458058401933, 85.02795514149186, 393.50912158974546, 265.19533191481446, 84.61557337507125, 340.0638257287668, 541.744327603771, 106.90329872019451, 76.04909718055664, 440.17352780845084, 227.2216993419333, 194.392691895061, 35.33428293070424, 441.1930034165698, 163.03450264332292, 127.71025206340629, 101.55751952943666, 240.65907345292467, 105.72550461089644, 129.33993292716383, 139.5112555229289, 65.26075003670398, 120.83072830207924, 75.69602011929933, 83.23781051798667, 91.03638916642362, 78.7803969164649, 211.8161902717095, 135.719681469983, 268.1660514492056, 41.063692831376784, 64.11498389553637, 220.4222246471242, 142.3654620061323, 389.9411654905929, 121.2187456447096, 200.2895063845537, 33.872886720790355, 39.96742081952736, 308.47581234997284, 109.91127942594916, 3.392531274470741, 17.48560778447622, 171.82503666642884, 328.02183450623835, 554.1939939347195, 494.5535611753816, 875.1888214558163, 123.55591954213331, 333.10153369408937, 644.6167070658336, 25.894795811121224, 95.01982617588062, 82.76761665760085, 19.99253550813706, 163.8899468985996, 157.8209083197824, 68.48387724158275, 127.14009211754703, 184.4941161506883, 74.8820210953619, 148.12727918180136, 13.647046581398744, 104.79588864420187, 144.4988537843425, 621.7198320819017, 446.32245238019607, 109.93652471095864, 202.67075014345764, 58.906629101015994, 128.77660648757768, 175.21666638675455, 186.89222370885577, 833.9200465959464, 91.06746950320813, 71.87040920535452, 110.0752771751077, 65.90550717546529, 354.16946047211616, 453.36848308501044, 225.23189053577408, 71.23153104947995, 117.44816830097511, 51.25190303425664, 55.04860731514405, 49.83975776812906, 53.76544075490323, 260.11985221195664, 124.66029303834928, 270.15943523709234, 158.25574439207293, 419.8052620404662, 203.5705939268966, 141.5000559597024, 89.60129799310498, 707.4342007204366, 432.6122109840484, 56.49935587187133, 362.62889159102104, 687.0756500175761, 70.6247239756625, 120.7002061822356, 0.0, 225.91559258496855, 402.2264575880564, 122.02507969847196, 147.07030432890178, 270.6741086294183, 141.2328618317027, 62.41590888922827, 28.00350462936147, 337.32744027962906, 230.24359598300688, 98.91593502914287, 140.35784348000402, 465.20740093199885, 47.9297612631772, 254.1966523420632, 37.66501669565543, 112.4847832226985, 235.3932509428131, 201.9419660579168, 308.47812482503207, 376.5849392679652, 277.6501019273896, 110.92035104196232, 303.98807680393367, 187.01201601643527, 170.69158057510973, 204.29073575984668, 368.84597919738184, 17.56935647142952, 363.09024647684595, 87.59819571086236, 184.13260891782187, 83.04487379757231, 115.93407371965029, 260.2110228090195, 375.0202075324274, 466.4042084140002, 515.5620725262738, 134.01455568095616, 365.1962190881171, 261.13439630628784, 360.25979192817186, 372.09126210107314, 433.68871369562345, 325.6424731187329, 586.7913676185497, 39.281449518087, 558.5929956354701, 38.8616073509282, 398.08874056370627, 56.87403724957999, 538.7777292986449, 517.8286800875176, 10.275798372139034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.927491070313434, "mean_inference_ms": 4.586454728479739, "mean_action_processing_ms": 1.4869843630178037, "mean_env_wait_ms": 10.68387413264867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014218449592590332, "StateBufferConnector_ms": 0.006028652191162109, "ViewRequirementAgentConnector_ms": 0.16096937656402588}, "num_episodes": 9, "episode_return_max": 690.4399824135313, "episode_return_min": -90.91510457741423, "episode_return_mean": 163.9849233698743, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.16699635439102, "num_env_steps_trained_throughput_per_sec": 80.16699635439102, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 49802.393, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49802.323, "sample_time_ms": 2626.374, "learn_time_ms": 47153.059, "learn_throughput": 84.83, "synch_weights_time_ms": 17.861}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "35fb9_00000", "date": "2024-08-22_09-30-25", "timestamp": 1724299225, "time_this_iter_s": 49.94300198554993, "time_total_s": 5802.082146167755, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0f5cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5802.082146167755, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 40.21, "ram_util_percent": 82.5914285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.014533091348316, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.0106455286343894, "policy_loss": -0.014205664443221713, "vf_loss": 3.022443671390493, "vf_explained_var": 0.5347303151138245, "kl": 0.012037612135625549, "entropy": 0.9718257342381452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.434905578471996, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.8451651599041368, "policy_loss": -0.024681252239656355, "vf_loss": 2.867656541816772, "vf_explained_var": 0.33711811039182876, "kl": 0.010949345217726968, "entropy": 0.5790470354140751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 690.4399824135313, "episode_reward_min": -90.91510457741423, "episode_reward_mean": 171.35932720940846, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -857.1685334292545, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9448276621356, "predator_policy": 875.1888214558163}, "policy_reward_mean": {"prey_policy": -136.5678438413393, "predator_policy": 222.24750744604393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [119.68868335194013, 78.09999999999984, 161.25915744509743, 648.4576438692284, 51.83975937904582, -23.214362788684138, 64.6000000000006, 3.6517542723939096, -61.58579380815454, 60.396545290728035, 48.681616400240756, 690.4399824135313, 33.21873677792421, 414.0000000000025, 88.39284785136866, 120.6023648702496, 23.807154169868962, 81.26661418222284, 233.2326453773549, 125.99999999999649, 261.45419770301817, 87.9296371002291, 87.65212620876466, 211.79999999999794, 71.36535687470162, 362.9137607013191, 67.40000000000045, 160.35997620227317, 63.20000000000063, 61.90000000000061, 98.55788754337709, 57.300000000000544, 391.89774383770913, 253.38976807528667, 378.6000000000036, 235.99999999999827, 50.14819984542862, -90.91510457741423, 130.3687199405641, 446.2714508058917, 159.19061804290212, 378.8409797473222, 63.41523356135211, 62.50000000000062, 380.10000000000167, 112.05077215254319, 52.61571302544898, 65.40000000000056, 134.13784349230633, 46.2534423312178, -7.888504471541049, 113.3551012058372, 51.176114912680994, 380.4507851522068, 69.24129079737695, 395.80000000000194, 72.70000000000014, 114.30175647526688, 546.7960967680259, 188.04272923191354, 135.111664238704, 200.40740180522909, 86.07888698860297, 112.41824598668163, 624.8396518143601, 202.29489382960932, 329.18830266700365, 84.92309824691657, 419.6000000000024, 247.60674891658903, 89.19294591335138, 204.4000000000002, 69.20000000000034, 168.85647192171683, 309.4157143322698, 521.837498707628, 63.40000000000063, 364.01568118594827, 86.60807066281411, 60.400000000000574, 101.85242240067191, 272.56584948773275, 226.13553900933158, 140.55933774414117, 78.86662025157369, 257.6999999999991, 73.91297797590575, 84.17826993995963, -49.92973053157165, 294.7838370860947, 139.3538370353959, 38.66205284227359, 80.79548431547327, 116.70000000000014, 66.30000000000051, 340.0044102539732, 74.95603685954654, 75.45796821991966, 203.57348909262384, 410.80000000000325], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-157.71477658778255, -498.3528721982186, 4.459409366739525, 8.71593977854945, -17.762099647249194, 14.717954340423018, 113.95637793216699, 188.62706781825014, -221.52345262221345, -857.1685334292545, -255.84946115806895, -843.3336044189898, 33.417505270771535, -344.5635557149995, -162.928731391161, -484.77378111099335, -294.2824916077809, -247.54395000102173, -496.8719184158971, -60.93078741574519, -254.53711170975183, -258.45681673720236, 377.1787780947102, -355.3130447718237, -480.39599900443125, -386.59940019539505, -135.57215079551634, 383.8, -11.472429164939907, -378.67179971492186, -239.55419231243084, 10.345651892798925, -429.916713954707, -428.08428520795786, -135.07663651989427, 33.39085480136527, -414.4949671182607, -19.66761465476369, -161.79269189506286, 58.065717069296156, -379.50765708687084, 36.734348729997286, -66.82296022838452, -74.51517426423226, -49.90971097563506, -208.82274087942216, 51.56006707283631, -108.61125552293063, -79.87502429323557, -34.85109717084818, -62.23407476799213, 266.2140048320206, -57.53638916642503, -44.880396916465415, -198.56676041086322, 11.390864871445727, -241.56605144920408, -4.46369283137647, -27.614983895535858, -195.02222464712565, -335.68608463942064, -98.06265531392367, -89.21874564471142, -174.98950638455514, 315.32711327920964, 2.730323018180122, -131.49251045471087, -33.50481324592342, 36.30746872552951, 321.41439221552446, -113.04249927092474, -150.8043719017444, -335.1283165159043, -663.4710387487613, -715.9726988388339, -373.6871467365271, -264.75393460420645, -582.595586215151, 391.9448276621356, -66.58799884325067, 16.43046587716639, 40.0000000000003, 189.02045023113698, -131.89032570220013, -33.883413900304376, -98.32532189747472, -156.6941161506897, -40.18202109536218, -112.62727918180303, 330.9529534186013, -9.616720787837266, -127.62724948816276, -742.2688622409067, -273.15770919573873, -77.23652471096047, -169.9707501434595, 32.69337089898422, -86.23876299526981, -138.52988465285523, -177.32556311154107, -809.3646033359919, -123.51141723470283, -6.667432938746426, -61.92315223587696, -243.78953690599744, -125.10931582890424, 72.576714373795, -370.72630284236925, -35.43153104947996, -84.00687750360025, -13.051903034256188, 302.55139268485595, -13.939757768128588, -16.96544075490271, -234.4931641134462, -35.985224661590486, -245.60022450250307, 363.98114164136035, -386.54356452257247, -48.78956221287277, 8.815929931339575, -104.80561964544108, -744.1435694058571, -195.49544049339997, 17.35391540192908, -350.40327587621204, -630.6614427251734, -14.620685281380531, 263.52856804633575, 240.61087758578844, -362.16478535921925, -63.682370984196965, -81.91510360631874, 142.00802224594602, -328.79099714587124, 1.8071249316704343, -26.815908889227764, 355.9964953706385, 23.821912059219276, -343.7861994052642, -20.159979560330385, -129.92085303546529, -346.67984498345885, 37.94268278828395, -222.49665234206478, -0.16501669565516472, -196.52702669673212, 17.505464452939833, -75.38825918227224, -125.616117368407, 289.29587430503665, -421.69341679276346, -75.12380575123669, -276.38462209465416, 136.93439446373534, -130.62230986933673, -403.41683677236887, -83.111807522041, -323.8015138584678, 3.541910910196687, -149.2697817452848, -20.6086004827297, -44.46099032108971, 118.04789229159967, -132.60806271232195, -276.4876286197939, -293.1686876507688, -548.2382555453569, -4.022586465375248, -416.32156805212213, -230.9343963062881, -132.75979192817152, -503.55941895576365, -228.30757886502022, -253.72131512211368, -574.5342556752067, -151.04840868773266, -496.7557669973964, -152.05241973825053, 9.885908909711112, 43.63781598402281, -499.93574549684956, -4.653150760575965, -484.78927485680407, -210.42857411520558, -168.3149855379935, 59.37455886112897, 19.046149764379354, -63.57887709969078, -194.51455244612606, -464.6705584927206, 195.22022408612958, 40.0000000000003, -103.75019481809377, 3.179675056525839, -267.8714903807041, -77.60722980763327, -32.15673729583802, -213.4937661105945, 351.86627886220174], "policy_predator_policy_reward": [205.85254591736037, 569.9037862205817, 35.84059063326066, 29.08406022145068, 58.815428654534486, 105.48787409739292, 203.20126593706138, 142.67293218174984, 865.505256951107, 265.0264884794045, 278.4521080893031, 797.5165946990709, 15.279040019956142, 360.467010424277, 162.64466376921837, 488.70960300533096, 272.0176550749941, 208.22299272566187, 518.203201914089, 99.9960492082841, 285.5162481426866, 276.15929670451686, 329.88891479507294, 338.6853342955718, 454.9194545792107, 445.29468139854646, 37.647570211495506, 128.12458058401933, 85.02795514149186, 393.50912158974546, 265.19533191481446, 84.61557337507125, 340.0638257287668, 541.744327603771, 106.90329872019451, 76.04909718055664, 440.17352780845084, 227.2216993419333, 194.392691895061, 35.33428293070424, 441.1930034165698, 163.03450264332292, 127.71025206340629, 101.55751952943666, 240.65907345292467, 105.72550461089644, 129.33993292716383, 139.5112555229289, 65.26075003670398, 120.83072830207924, 75.69602011929933, 83.23781051798667, 91.03638916642362, 78.7803969164649, 211.8161902717095, 135.719681469983, 268.1660514492056, 41.063692831376784, 64.11498389553637, 220.4222246471242, 142.3654620061323, 389.9411654905929, 121.2187456447096, 200.2895063845537, 33.872886720790355, 39.96742081952736, 308.47581234997284, 109.91127942594916, 3.392531274470741, 17.48560778447622, 171.82503666642884, 328.02183450623835, 554.1939939347195, 494.5535611753816, 875.1888214558163, 123.55591954213331, 333.10153369408937, 644.6167070658336, 25.894795811121224, 95.01982617588062, 82.76761665760085, 19.99253550813706, 163.8899468985996, 157.8209083197824, 68.48387724158275, 127.14009211754703, 184.4941161506883, 74.8820210953619, 148.12727918180136, 13.647046581398744, 104.79588864420187, 144.4988537843425, 621.7198320819017, 446.32245238019607, 109.93652471095864, 202.67075014345764, 58.906629101015994, 128.77660648757768, 175.21666638675455, 186.89222370885577, 833.9200465959464, 91.06746950320813, 71.87040920535452, 110.0752771751077, 65.90550717546529, 354.16946047211616, 453.36848308501044, 225.23189053577408, 71.23153104947995, 117.44816830097511, 51.25190303425664, 55.04860731514405, 49.83975776812906, 53.76544075490323, 260.11985221195664, 124.66029303834928, 270.15943523709234, 158.25574439207293, 419.8052620404662, 203.5705939268966, 141.5000559597024, 89.60129799310498, 707.4342007204366, 432.6122109840484, 56.49935587187133, 362.62889159102104, 687.0756500175761, 70.6247239756625, 120.7002061822356, 0.0, 225.91559258496855, 402.2264575880564, 122.02507969847196, 147.07030432890178, 270.6741086294183, 141.2328618317027, 62.41590888922827, 28.00350462936147, 337.32744027962906, 230.24359598300688, 98.91593502914287, 140.35784348000402, 465.20740093199885, 47.9297612631772, 254.1966523420632, 37.66501669565543, 112.4847832226985, 235.3932509428131, 201.9419660579168, 308.47812482503207, 376.5849392679652, 277.6501019273896, 110.92035104196232, 303.98807680393367, 187.01201601643527, 170.69158057510973, 204.29073575984668, 368.84597919738184, 17.56935647142952, 363.09024647684595, 87.59819571086236, 184.13260891782187, 83.04487379757231, 115.93407371965029, 260.2110228090195, 375.0202075324274, 466.4042084140002, 515.5620725262738, 134.01455568095616, 365.1962190881171, 261.13439630628784, 360.25979192817186, 372.09126210107314, 433.68871369562345, 325.6424731187329, 586.7913676185497, 39.281449518087, 558.5929956354701, 38.8616073509282, 398.08874056370627, 56.87403724957999, 538.7777292986449, 517.8286800875176, 10.275798372139034, 214.31054282251225, 245.22850114615693, 18.92544113887099, 19.353850235620644, 97.47887709968889, 226.91455244612422, 282.6030311190166, 326.85171354154954, 50.90499215529764, 87.80123952234113, 47.946060116360435, 292.2037234277437, 110.01458439205054, 203.32287180404495, 267.8937661105934, 4.5337211377983815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.934081375395188, "mean_inference_ms": 4.577456013297609, "mean_action_processing_ms": 1.479209501627491, "mean_env_wait_ms": 10.676086024331607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010197639465332031, "StateBufferConnector_ms": 0.011341452598571777, "ViewRequirementAgentConnector_ms": 0.16166210174560547}, "num_episodes": 8, "episode_return_max": 690.4399824135313, "episode_return_min": -90.91510457741423, "episode_return_mean": 171.35932720940846, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.12264324215425, "num_env_steps_trained_throughput_per_sec": 81.12264324215425, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 49815.634, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49815.565, "sample_time_ms": 2669.537, "learn_time_ms": 47122.266, "learn_throughput": 84.886, "synch_weights_time_ms": 18.533}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "35fb9_00000", "date": "2024-08-22_09-31-15", "timestamp": 1724299275, "time_this_iter_s": 49.35883402824402, "time_total_s": 5851.440980195999, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b3a51f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5851.440980195999, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 40.57571428571428, "ram_util_percent": 82.43857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.335929589296775, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.1370515694063177, "policy_loss": -0.02380177213597264, "vf_loss": 3.157685332575803, "vf_explained_var": 0.5349419799431291, "kl": 0.015840026500225854, "entropy": 0.9714332002811331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.580591271983252, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.29503548397589, "policy_loss": -0.024993402499178297, "vf_loss": 3.3177454554845416, "vf_explained_var": 0.2948970838829323, "kl": 0.011417140764869237, "entropy": 0.552192531533973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 624.8396518143601, "episode_reward_min": -90.91510457741423, "episode_reward_mean": 174.36899630300957, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -809.3646033359919, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9448276621356, "predator_policy": 875.1888214558163}, "policy_reward_mean": {"prey_policy": -123.0247394553499, "predator_policy": 210.2092376068549}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.21873677792421, 414.0000000000025, 88.39284785136866, 120.6023648702496, 23.807154169868962, 81.26661418222284, 233.2326453773549, 125.99999999999649, 261.45419770301817, 87.9296371002291, 87.65212620876466, 211.79999999999794, 71.36535687470162, 362.9137607013191, 67.40000000000045, 160.35997620227317, 63.20000000000063, 61.90000000000061, 98.55788754337709, 57.300000000000544, 391.89774383770913, 253.38976807528667, 378.6000000000036, 235.99999999999827, 50.14819984542862, -90.91510457741423, 130.3687199405641, 446.2714508058917, 159.19061804290212, 378.8409797473222, 63.41523356135211, 62.50000000000062, 380.10000000000167, 112.05077215254319, 52.61571302544898, 65.40000000000056, 134.13784349230633, 46.2534423312178, -7.888504471541049, 113.3551012058372, 51.176114912680994, 380.4507851522068, 69.24129079737695, 395.80000000000194, 72.70000000000014, 114.30175647526688, 546.7960967680259, 188.04272923191354, 135.111664238704, 200.40740180522909, 86.07888698860297, 112.41824598668163, 624.8396518143601, 202.29489382960932, 329.18830266700365, 84.92309824691657, 419.6000000000024, 247.60674891658903, 89.19294591335138, 204.4000000000002, 69.20000000000034, 168.85647192171683, 309.4157143322698, 521.837498707628, 63.40000000000063, 364.01568118594827, 86.60807066281411, 60.400000000000574, 101.85242240067191, 272.56584948773275, 226.13553900933158, 140.55933774414117, 78.86662025157369, 257.6999999999991, 73.91297797590575, 84.17826993995963, -49.92973053157165, 294.7838370860947, 139.3538370353959, 38.66205284227359, 80.79548431547327, 116.70000000000014, 66.30000000000051, 340.0044102539732, 74.95603685954654, 75.45796821991966, 203.57348909262384, 410.80000000000325, 282.75846325507564, 143.42821941605996, 370.90000000000146, 54.29279585301929, 317.523681591263, 74.51988033739258, 78.23111075099256, 55.386771731669, 51.037785098964214, 98.84736756209438, 263.60182712849326, 352.753992460448], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-480.39599900443125, -386.59940019539505, -135.57215079551634, 383.8, -11.472429164939907, -378.67179971492186, -239.55419231243084, 10.345651892798925, -429.916713954707, -428.08428520795786, -135.07663651989427, 33.39085480136527, -414.4949671182607, -19.66761465476369, -161.79269189506286, 58.065717069296156, -379.50765708687084, 36.734348729997286, -66.82296022838452, -74.51517426423226, -49.90971097563506, -208.82274087942216, 51.56006707283631, -108.61125552293063, -79.87502429323557, -34.85109717084818, -62.23407476799213, 266.2140048320206, -57.53638916642503, -44.880396916465415, -198.56676041086322, 11.390864871445727, -241.56605144920408, -4.46369283137647, -27.614983895535858, -195.02222464712565, -335.68608463942064, -98.06265531392367, -89.21874564471142, -174.98950638455514, 315.32711327920964, 2.730323018180122, -131.49251045471087, -33.50481324592342, 36.30746872552951, 321.41439221552446, -113.04249927092474, -150.8043719017444, -335.1283165159043, -663.4710387487613, -715.9726988388339, -373.6871467365271, -264.75393460420645, -582.595586215151, 391.9448276621356, -66.58799884325067, 16.43046587716639, 40.0000000000003, 189.02045023113698, -131.89032570220013, -33.883413900304376, -98.32532189747472, -156.6941161506897, -40.18202109536218, -112.62727918180303, 330.9529534186013, -9.616720787837266, -127.62724948816276, -742.2688622409067, -273.15770919573873, -77.23652471096047, -169.9707501434595, 32.69337089898422, -86.23876299526981, -138.52988465285523, -177.32556311154107, -809.3646033359919, -123.51141723470283, -6.667432938746426, -61.92315223587696, -243.78953690599744, -125.10931582890424, 72.576714373795, -370.72630284236925, -35.43153104947996, -84.00687750360025, -13.051903034256188, 302.55139268485595, -13.939757768128588, -16.96544075490271, -234.4931641134462, -35.985224661590486, -245.60022450250307, 363.98114164136035, -386.54356452257247, -48.78956221287277, 8.815929931339575, -104.80561964544108, -744.1435694058571, -195.49544049339997, 17.35391540192908, -350.40327587621204, -630.6614427251734, -14.620685281380531, 263.52856804633575, 240.61087758578844, -362.16478535921925, -63.682370984196965, -81.91510360631874, 142.00802224594602, -328.79099714587124, 1.8071249316704343, -26.815908889227764, 355.9964953706385, 23.821912059219276, -343.7861994052642, -20.159979560330385, -129.92085303546529, -346.67984498345885, 37.94268278828395, -222.49665234206478, -0.16501669565516472, -196.52702669673212, 17.505464452939833, -75.38825918227224, -125.616117368407, 289.29587430503665, -421.69341679276346, -75.12380575123669, -276.38462209465416, 136.93439446373534, -130.62230986933673, -403.41683677236887, -83.111807522041, -323.8015138584678, 3.541910910196687, -149.2697817452848, -20.6086004827297, -44.46099032108971, 118.04789229159967, -132.60806271232195, -276.4876286197939, -293.1686876507688, -548.2382555453569, -4.022586465375248, -416.32156805212213, -230.9343963062881, -132.75979192817152, -503.55941895576365, -228.30757886502022, -253.72131512211368, -574.5342556752067, -151.04840868773266, -496.7557669973964, -152.05241973825053, 9.885908909711112, 43.63781598402281, -499.93574549684956, -4.653150760575965, -484.78927485680407, -210.42857411520558, -168.3149855379935, 59.37455886112897, 19.046149764379354, -63.57887709969078, -194.51455244612606, -464.6705584927206, 195.22022408612958, 40.0000000000003, -103.75019481809377, 3.179675056525839, -267.8714903807041, -77.60722980763327, -32.15673729583802, -213.4937661105945, 351.86627886220174, -230.23204519914722, 176.1042156736313, -175.07578390021166, 15.557882615217073, 224.30334205338042, -68.22361896597134, -326.2176643508229, -134.78117682054562, -310.1671128444363, 11.475924018869819, -158.1167358734095, -133.57734819523637, -137.47441414943148, -183.40578924835674, -177.2341515922365, -85.22105301151352, -285.00214452420636, -107.26611496048453, -90.2848430348905, -21.24977171199631, -58.29711238826897, -250.84607527018056, 138.0294304731155, 4.989082068470468], "policy_predator_policy_reward": [454.9194545792107, 445.29468139854646, 37.647570211495506, 128.12458058401933, 85.02795514149186, 393.50912158974546, 265.19533191481446, 84.61557337507125, 340.0638257287668, 541.744327603771, 106.90329872019451, 76.04909718055664, 440.17352780845084, 227.2216993419333, 194.392691895061, 35.33428293070424, 441.1930034165698, 163.03450264332292, 127.71025206340629, 101.55751952943666, 240.65907345292467, 105.72550461089644, 129.33993292716383, 139.5112555229289, 65.26075003670398, 120.83072830207924, 75.69602011929933, 83.23781051798667, 91.03638916642362, 78.7803969164649, 211.8161902717095, 135.719681469983, 268.1660514492056, 41.063692831376784, 64.11498389553637, 220.4222246471242, 142.3654620061323, 389.9411654905929, 121.2187456447096, 200.2895063845537, 33.872886720790355, 39.96742081952736, 308.47581234997284, 109.91127942594916, 3.392531274470741, 17.48560778447622, 171.82503666642884, 328.02183450623835, 554.1939939347195, 494.5535611753816, 875.1888214558163, 123.55591954213331, 333.10153369408937, 644.6167070658336, 25.894795811121224, 95.01982617588062, 82.76761665760085, 19.99253550813706, 163.8899468985996, 157.8209083197824, 68.48387724158275, 127.14009211754703, 184.4941161506883, 74.8820210953619, 148.12727918180136, 13.647046581398744, 104.79588864420187, 144.4988537843425, 621.7198320819017, 446.32245238019607, 109.93652471095864, 202.67075014345764, 58.906629101015994, 128.77660648757768, 175.21666638675455, 186.89222370885577, 833.9200465959464, 91.06746950320813, 71.87040920535452, 110.0752771751077, 65.90550717546529, 354.16946047211616, 453.36848308501044, 225.23189053577408, 71.23153104947995, 117.44816830097511, 51.25190303425664, 55.04860731514405, 49.83975776812906, 53.76544075490323, 260.11985221195664, 124.66029303834928, 270.15943523709234, 158.25574439207293, 419.8052620404662, 203.5705939268966, 141.5000559597024, 89.60129799310498, 707.4342007204366, 432.6122109840484, 56.49935587187133, 362.62889159102104, 687.0756500175761, 70.6247239756625, 120.7002061822356, 0.0, 225.91559258496855, 402.2264575880564, 122.02507969847196, 147.07030432890178, 270.6741086294183, 141.2328618317027, 62.41590888922827, 28.00350462936147, 337.32744027962906, 230.24359598300688, 98.91593502914287, 140.35784348000402, 465.20740093199885, 47.9297612631772, 254.1966523420632, 37.66501669565543, 112.4847832226985, 235.3932509428131, 201.9419660579168, 308.47812482503207, 376.5849392679652, 277.6501019273896, 110.92035104196232, 303.98807680393367, 187.01201601643527, 170.69158057510973, 204.29073575984668, 368.84597919738184, 17.56935647142952, 363.09024647684595, 87.59819571086236, 184.13260891782187, 83.04487379757231, 115.93407371965029, 260.2110228090195, 375.0202075324274, 466.4042084140002, 515.5620725262738, 134.01455568095616, 365.1962190881171, 261.13439630628784, 360.25979192817186, 372.09126210107314, 433.68871369562345, 325.6424731187329, 586.7913676185497, 39.281449518087, 558.5929956354701, 38.8616073509282, 398.08874056370627, 56.87403724957999, 538.7777292986449, 517.8286800875176, 10.275798372139034, 214.31054282251225, 245.22850114615693, 18.92544113887099, 19.353850235620644, 97.47887709968889, 226.91455244612422, 282.6030311190166, 326.85171354154954, 50.90499215529764, 87.80123952234113, 47.946060116360435, 292.2037234277437, 110.01458439205054, 203.32287180404495, 267.8937661105934, 4.5337211377983815, 265.91003323607805, 70.9762595445127, 171.84469802791952, 131.1014226731368, 111.4966579466194, 103.32361896596935, 370.0208740331148, 145.2707629912781, 341.6116156329313, 274.6032547839049, 180.79405798648676, 185.41990641954823, 316.51798333408505, 82.59333081469286, 217.63055221485976, 100.21142412055592, 189.60552075824413, 253.7005238254085, 79.4464966849333, 130.93548562404808, 120.69922819797817, 452.04578658896594, 155.30374699391487, 54.4317329249461]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9381469772937905, "mean_inference_ms": 4.563993889927343, "mean_action_processing_ms": 1.4843338701379993, "mean_env_wait_ms": 10.651284277494952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01032567024230957, "StateBufferConnector_ms": 0.011294960975646973, "ViewRequirementAgentConnector_ms": 0.16036784648895264}, "num_episodes": 12, "episode_return_max": 624.8396518143601, "episode_return_min": -90.91510457741423, "episode_return_mean": 174.36899630300957, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.3698559362889, "num_env_steps_trained_throughput_per_sec": 83.3698559362889, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 49719.957, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49719.892, "sample_time_ms": 2645.999, "learn_time_ms": 47051.366, "learn_throughput": 85.013, "synch_weights_time_ms": 17.442}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "35fb9_00000", "date": "2024-08-22_09-32-03", "timestamp": 1724299323, "time_this_iter_s": 48.018378019332886, "time_total_s": 5899.459358215332, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0f5ca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5899.459358215332, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 40.03088235294118, "ram_util_percent": 83.12647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.213529748071437, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.3654224067137988, "policy_loss": -0.014551962651780477, "vf_loss": 3.377834308904315, "vf_explained_var": 0.5602800446843345, "kl": 0.010700295750721895, "entropy": 0.9188700340412281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.563583537195095, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.353245099070211, "policy_loss": -0.02767138344361373, "vf_loss": 3.3786242600471255, "vf_explained_var": 0.19138475319065115, "kl": 0.011461122744228868, "entropy": 0.5177928041371088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 624.8396518143601, "episode_reward_min": -90.91510457741423, "episode_reward_mean": 177.08146095509454, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -809.3646033359919, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9448276621356, "predator_policy": 875.1888214558163}, "policy_reward_mean": {"prey_policy": -119.33703420508523, "predator_policy": 207.8777646826327}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.807154169868962, 81.26661418222284, 233.2326453773549, 125.99999999999649, 261.45419770301817, 87.9296371002291, 87.65212620876466, 211.79999999999794, 71.36535687470162, 362.9137607013191, 67.40000000000045, 160.35997620227317, 63.20000000000063, 61.90000000000061, 98.55788754337709, 57.300000000000544, 391.89774383770913, 253.38976807528667, 378.6000000000036, 235.99999999999827, 50.14819984542862, -90.91510457741423, 130.3687199405641, 446.2714508058917, 159.19061804290212, 378.8409797473222, 63.41523356135211, 62.50000000000062, 380.10000000000167, 112.05077215254319, 52.61571302544898, 65.40000000000056, 134.13784349230633, 46.2534423312178, -7.888504471541049, 113.3551012058372, 51.176114912680994, 380.4507851522068, 69.24129079737695, 395.80000000000194, 72.70000000000014, 114.30175647526688, 546.7960967680259, 188.04272923191354, 135.111664238704, 200.40740180522909, 86.07888698860297, 112.41824598668163, 624.8396518143601, 202.29489382960932, 329.18830266700365, 84.92309824691657, 419.6000000000024, 247.60674891658903, 89.19294591335138, 204.4000000000002, 69.20000000000034, 168.85647192171683, 309.4157143322698, 521.837498707628, 63.40000000000063, 364.01568118594827, 86.60807066281411, 60.400000000000574, 101.85242240067191, 272.56584948773275, 226.13553900933158, 140.55933774414117, 78.86662025157369, 257.6999999999991, 73.91297797590575, 84.17826993995963, -49.92973053157165, 294.7838370860947, 139.3538370353959, 38.66205284227359, 80.79548431547327, 116.70000000000014, 66.30000000000051, 340.0044102539732, 74.95603685954654, 75.45796821991966, 203.57348909262384, 410.80000000000325, 282.75846325507564, 143.42821941605996, 370.90000000000146, 54.29279585301929, 317.523681591263, 74.51988033739258, 78.23111075099256, 55.386771731669, 51.037785098964214, 98.84736756209438, 263.60182712849326, 352.753992460448, 350.7000000000012, 386.5994333653813, 104.87246054728858, 85.28852079537788], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-429.916713954707, -428.08428520795786, -135.07663651989427, 33.39085480136527, -414.4949671182607, -19.66761465476369, -161.79269189506286, 58.065717069296156, -379.50765708687084, 36.734348729997286, -66.82296022838452, -74.51517426423226, -49.90971097563506, -208.82274087942216, 51.56006707283631, -108.61125552293063, -79.87502429323557, -34.85109717084818, -62.23407476799213, 266.2140048320206, -57.53638916642503, -44.880396916465415, -198.56676041086322, 11.390864871445727, -241.56605144920408, -4.46369283137647, -27.614983895535858, -195.02222464712565, -335.68608463942064, -98.06265531392367, -89.21874564471142, -174.98950638455514, 315.32711327920964, 2.730323018180122, -131.49251045471087, -33.50481324592342, 36.30746872552951, 321.41439221552446, -113.04249927092474, -150.8043719017444, -335.1283165159043, -663.4710387487613, -715.9726988388339, -373.6871467365271, -264.75393460420645, -582.595586215151, 391.9448276621356, -66.58799884325067, 16.43046587716639, 40.0000000000003, 189.02045023113698, -131.89032570220013, -33.883413900304376, -98.32532189747472, -156.6941161506897, -40.18202109536218, -112.62727918180303, 330.9529534186013, -9.616720787837266, -127.62724948816276, -742.2688622409067, -273.15770919573873, -77.23652471096047, -169.9707501434595, 32.69337089898422, -86.23876299526981, -138.52988465285523, -177.32556311154107, -809.3646033359919, -123.51141723470283, -6.667432938746426, -61.92315223587696, -243.78953690599744, -125.10931582890424, 72.576714373795, -370.72630284236925, -35.43153104947996, -84.00687750360025, -13.051903034256188, 302.55139268485595, -13.939757768128588, -16.96544075490271, -234.4931641134462, -35.985224661590486, -245.60022450250307, 363.98114164136035, -386.54356452257247, -48.78956221287277, 8.815929931339575, -104.80561964544108, -744.1435694058571, -195.49544049339997, 17.35391540192908, -350.40327587621204, -630.6614427251734, -14.620685281380531, 263.52856804633575, 240.61087758578844, -362.16478535921925, -63.682370984196965, -81.91510360631874, 142.00802224594602, -328.79099714587124, 1.8071249316704343, -26.815908889227764, 355.9964953706385, 23.821912059219276, -343.7861994052642, -20.159979560330385, -129.92085303546529, -346.67984498345885, 37.94268278828395, -222.49665234206478, -0.16501669565516472, -196.52702669673212, 17.505464452939833, -75.38825918227224, -125.616117368407, 289.29587430503665, -421.69341679276346, -75.12380575123669, -276.38462209465416, 136.93439446373534, -130.62230986933673, -403.41683677236887, -83.111807522041, -323.8015138584678, 3.541910910196687, -149.2697817452848, -20.6086004827297, -44.46099032108971, 118.04789229159967, -132.60806271232195, -276.4876286197939, -293.1686876507688, -548.2382555453569, -4.022586465375248, -416.32156805212213, -230.9343963062881, -132.75979192817152, -503.55941895576365, -228.30757886502022, -253.72131512211368, -574.5342556752067, -151.04840868773266, -496.7557669973964, -152.05241973825053, 9.885908909711112, 43.63781598402281, -499.93574549684956, -4.653150760575965, -484.78927485680407, -210.42857411520558, -168.3149855379935, 59.37455886112897, 19.046149764379354, -63.57887709969078, -194.51455244612606, -464.6705584927206, 195.22022408612958, 40.0000000000003, -103.75019481809377, 3.179675056525839, -267.8714903807041, -77.60722980763327, -32.15673729583802, -213.4937661105945, 351.86627886220174, -230.23204519914722, 176.1042156736313, -175.07578390021166, 15.557882615217073, 224.30334205338042, -68.22361896597134, -326.2176643508229, -134.78117682054562, -310.1671128444363, 11.475924018869819, -158.1167358734095, -133.57734819523637, -137.47441414943148, -183.40578924835674, -177.2341515922365, -85.22105301151352, -285.00214452420636, -107.26611496048453, -90.2848430348905, -21.24977171199631, -58.29711238826897, -250.84607527018056, 138.0294304731155, 4.989082068470468, 251.2467000240019, -96.14838743053926, 19.30338105291193, -127.71634763812818, 22.676533366314246, -340.93242656244126, -189.16821266032582, -39.84050939369499], "policy_predator_policy_reward": [340.0638257287668, 541.744327603771, 106.90329872019451, 76.04909718055664, 440.17352780845084, 227.2216993419333, 194.392691895061, 35.33428293070424, 441.1930034165698, 163.03450264332292, 127.71025206340629, 101.55751952943666, 240.65907345292467, 105.72550461089644, 129.33993292716383, 139.5112555229289, 65.26075003670398, 120.83072830207924, 75.69602011929933, 83.23781051798667, 91.03638916642362, 78.7803969164649, 211.8161902717095, 135.719681469983, 268.1660514492056, 41.063692831376784, 64.11498389553637, 220.4222246471242, 142.3654620061323, 389.9411654905929, 121.2187456447096, 200.2895063845537, 33.872886720790355, 39.96742081952736, 308.47581234997284, 109.91127942594916, 3.392531274470741, 17.48560778447622, 171.82503666642884, 328.02183450623835, 554.1939939347195, 494.5535611753816, 875.1888214558163, 123.55591954213331, 333.10153369408937, 644.6167070658336, 25.894795811121224, 95.01982617588062, 82.76761665760085, 19.99253550813706, 163.8899468985996, 157.8209083197824, 68.48387724158275, 127.14009211754703, 184.4941161506883, 74.8820210953619, 148.12727918180136, 13.647046581398744, 104.79588864420187, 144.4988537843425, 621.7198320819017, 446.32245238019607, 109.93652471095864, 202.67075014345764, 58.906629101015994, 128.77660648757768, 175.21666638675455, 186.89222370885577, 833.9200465959464, 91.06746950320813, 71.87040920535452, 110.0752771751077, 65.90550717546529, 354.16946047211616, 453.36848308501044, 225.23189053577408, 71.23153104947995, 117.44816830097511, 51.25190303425664, 55.04860731514405, 49.83975776812906, 53.76544075490323, 260.11985221195664, 124.66029303834928, 270.15943523709234, 158.25574439207293, 419.8052620404662, 203.5705939268966, 141.5000559597024, 89.60129799310498, 707.4342007204366, 432.6122109840484, 56.49935587187133, 362.62889159102104, 687.0756500175761, 70.6247239756625, 120.7002061822356, 0.0, 225.91559258496855, 402.2264575880564, 122.02507969847196, 147.07030432890178, 270.6741086294183, 141.2328618317027, 62.41590888922827, 28.00350462936147, 337.32744027962906, 230.24359598300688, 98.91593502914287, 140.35784348000402, 465.20740093199885, 47.9297612631772, 254.1966523420632, 37.66501669565543, 112.4847832226985, 235.3932509428131, 201.9419660579168, 308.47812482503207, 376.5849392679652, 277.6501019273896, 110.92035104196232, 303.98807680393367, 187.01201601643527, 170.69158057510973, 204.29073575984668, 368.84597919738184, 17.56935647142952, 363.09024647684595, 87.59819571086236, 184.13260891782187, 83.04487379757231, 115.93407371965029, 260.2110228090195, 375.0202075324274, 466.4042084140002, 515.5620725262738, 134.01455568095616, 365.1962190881171, 261.13439630628784, 360.25979192817186, 372.09126210107314, 433.68871369562345, 325.6424731187329, 586.7913676185497, 39.281449518087, 558.5929956354701, 38.8616073509282, 398.08874056370627, 56.87403724957999, 538.7777292986449, 517.8286800875176, 10.275798372139034, 214.31054282251225, 245.22850114615693, 18.92544113887099, 19.353850235620644, 97.47887709968889, 226.91455244612422, 282.6030311190166, 326.85171354154954, 50.90499215529764, 87.80123952234113, 47.946060116360435, 292.2037234277437, 110.01458439205054, 203.32287180404495, 267.8937661105934, 4.5337211377983815, 265.91003323607805, 70.9762595445127, 171.84469802791952, 131.1014226731368, 111.4966579466194, 103.32361896596935, 370.0208740331148, 145.2707629912781, 341.6116156329313, 274.6032547839049, 180.79405798648676, 185.41990641954823, 316.51798333408505, 82.59333081469286, 217.63055221485976, 100.21142412055592, 189.60552075824413, 253.7005238254085, 79.4464966849333, 130.93548562404808, 120.69922819797817, 452.04578658896594, 155.30374699391487, 54.4317329249461, 68.85329997599806, 126.7483874305376, 191.7675753904713, 303.2448245601224, 63.2287316122657, 359.89962213115564, 148.01398223720648, 166.28326061219124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.927848717491553, "mean_inference_ms": 4.552825004495576, "mean_action_processing_ms": 1.4914994152451024, "mean_env_wait_ms": 10.641050739537192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004785299301147461, "StateBufferConnector_ms": 0.011280059814453125, "ViewRequirementAgentConnector_ms": 0.15519368648529053}, "num_episodes": 4, "episode_return_max": 624.8396518143601, "episode_return_min": -90.91510457741423, "episode_return_mean": 177.08146095509454, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.78556915552964, "num_env_steps_trained_throughput_per_sec": 83.78556915552964, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 49501.603, "restore_workers_time_ms": 0.016, "training_step_time_ms": 49501.539, "sample_time_ms": 2579.103, "learn_time_ms": 46900.367, "learn_throughput": 85.287, "synch_weights_time_ms": 16.894}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "35fb9_00000", "date": "2024-08-22_09-32-51", "timestamp": 1724299371, "time_this_iter_s": 47.778762102127075, "time_total_s": 5947.238120317459, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16fcd7790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5947.238120317459, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 38.43582089552239, "ram_util_percent": 82.49701492537314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.7342130938535, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.886815732118314, "policy_loss": -0.01794937507596813, "vf_loss": 2.902232313913012, "vf_explained_var": 0.4490270003439888, "kl": 0.012664024006062872, "entropy": 0.9938277891388646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.557876616810995, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.5554391104077534, "policy_loss": -0.027203906937465366, "vf_loss": 2.580445395890998, "vf_explained_var": 0.2090053983466335, "kl": 0.01098809450527249, "entropy": 0.5883656272654811, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 701.8176855550084, "episode_reward_min": -90.91510457741423, "episode_reward_mean": 192.90309203536228, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -809.3646033359919, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9448276621356, "predator_policy": 875.1888214558163}, "policy_reward_mean": {"prey_policy": -109.93583319550609, "predator_policy": 206.3873792131874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.90000000000061, 98.55788754337709, 57.300000000000544, 391.89774383770913, 253.38976807528667, 378.6000000000036, 235.99999999999827, 50.14819984542862, -90.91510457741423, 130.3687199405641, 446.2714508058917, 159.19061804290212, 378.8409797473222, 63.41523356135211, 62.50000000000062, 380.10000000000167, 112.05077215254319, 52.61571302544898, 65.40000000000056, 134.13784349230633, 46.2534423312178, -7.888504471541049, 113.3551012058372, 51.176114912680994, 380.4507851522068, 69.24129079737695, 395.80000000000194, 72.70000000000014, 114.30175647526688, 546.7960967680259, 188.04272923191354, 135.111664238704, 200.40740180522909, 86.07888698860297, 112.41824598668163, 624.8396518143601, 202.29489382960932, 329.18830266700365, 84.92309824691657, 419.6000000000024, 247.60674891658903, 89.19294591335138, 204.4000000000002, 69.20000000000034, 168.85647192171683, 309.4157143322698, 521.837498707628, 63.40000000000063, 364.01568118594827, 86.60807066281411, 60.400000000000574, 101.85242240067191, 272.56584948773275, 226.13553900933158, 140.55933774414117, 78.86662025157369, 257.6999999999991, 73.91297797590575, 84.17826993995963, -49.92973053157165, 294.7838370860947, 139.3538370353959, 38.66205284227359, 80.79548431547327, 116.70000000000014, 66.30000000000051, 340.0044102539732, 74.95603685954654, 75.45796821991966, 203.57348909262384, 410.80000000000325, 282.75846325507564, 143.42821941605996, 370.90000000000146, 54.29279585301929, 317.523681591263, 74.51988033739258, 78.23111075099256, 55.386771731669, 51.037785098964214, 98.84736756209438, 263.60182712849326, 352.753992460448, 350.7000000000012, 386.5994333653813, 104.87246054728858, 85.28852079537788, 361.2000000000022, 474.4396784449684, 446.1163730252416, -2.8946366331641773, 373.29999999999916, 108.93320345724734, 49.260454087038525, 317.01111700353465, 701.8176855550084, 61.98982841378134, 132.02813552391294, 342.7939527262605, 54.548784942690496], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-27.614983895535858, -195.02222464712565, -335.68608463942064, -98.06265531392367, -89.21874564471142, -174.98950638455514, 315.32711327920964, 2.730323018180122, -131.49251045471087, -33.50481324592342, 36.30746872552951, 321.41439221552446, -113.04249927092474, -150.8043719017444, -335.1283165159043, -663.4710387487613, -715.9726988388339, -373.6871467365271, -264.75393460420645, -582.595586215151, 391.9448276621356, -66.58799884325067, 16.43046587716639, 40.0000000000003, 189.02045023113698, -131.89032570220013, -33.883413900304376, -98.32532189747472, -156.6941161506897, -40.18202109536218, -112.62727918180303, 330.9529534186013, -9.616720787837266, -127.62724948816276, -742.2688622409067, -273.15770919573873, -77.23652471096047, -169.9707501434595, 32.69337089898422, -86.23876299526981, -138.52988465285523, -177.32556311154107, -809.3646033359919, -123.51141723470283, -6.667432938746426, -61.92315223587696, -243.78953690599744, -125.10931582890424, 72.576714373795, -370.72630284236925, -35.43153104947996, -84.00687750360025, -13.051903034256188, 302.55139268485595, -13.939757768128588, -16.96544075490271, -234.4931641134462, -35.985224661590486, -245.60022450250307, 363.98114164136035, -386.54356452257247, -48.78956221287277, 8.815929931339575, -104.80561964544108, -744.1435694058571, -195.49544049339997, 17.35391540192908, -350.40327587621204, -630.6614427251734, -14.620685281380531, 263.52856804633575, 240.61087758578844, -362.16478535921925, -63.682370984196965, -81.91510360631874, 142.00802224594602, -328.79099714587124, 1.8071249316704343, -26.815908889227764, 355.9964953706385, 23.821912059219276, -343.7861994052642, -20.159979560330385, -129.92085303546529, -346.67984498345885, 37.94268278828395, -222.49665234206478, -0.16501669565516472, -196.52702669673212, 17.505464452939833, -75.38825918227224, -125.616117368407, 289.29587430503665, -421.69341679276346, -75.12380575123669, -276.38462209465416, 136.93439446373534, -130.62230986933673, -403.41683677236887, -83.111807522041, -323.8015138584678, 3.541910910196687, -149.2697817452848, -20.6086004827297, -44.46099032108971, 118.04789229159967, -132.60806271232195, -276.4876286197939, -293.1686876507688, -548.2382555453569, -4.022586465375248, -416.32156805212213, -230.9343963062881, -132.75979192817152, -503.55941895576365, -228.30757886502022, -253.72131512211368, -574.5342556752067, -151.04840868773266, -496.7557669973964, -152.05241973825053, 9.885908909711112, 43.63781598402281, -499.93574549684956, -4.653150760575965, -484.78927485680407, -210.42857411520558, -168.3149855379935, 59.37455886112897, 19.046149764379354, -63.57887709969078, -194.51455244612606, -464.6705584927206, 195.22022408612958, 40.0000000000003, -103.75019481809377, 3.179675056525839, -267.8714903807041, -77.60722980763327, -32.15673729583802, -213.4937661105945, 351.86627886220174, -230.23204519914722, 176.1042156736313, -175.07578390021166, 15.557882615217073, 224.30334205338042, -68.22361896597134, -326.2176643508229, -134.78117682054562, -310.1671128444363, 11.475924018869819, -158.1167358734095, -133.57734819523637, -137.47441414943148, -183.40578924835674, -177.2341515922365, -85.22105301151352, -285.00214452420636, -107.26611496048453, -90.2848430348905, -21.24977171199631, -58.29711238826897, -250.84607527018056, 138.0294304731155, 4.989082068470468, 251.2467000240019, -96.14838743053926, 19.30338105291193, -127.71634763812818, 22.676533366314246, -340.93242656244126, -189.16821266032582, -39.84050939369499, 183.77579663640853, -32.18337909456164, -176.96240343341773, 366.6767465904391, 378.4, -133.66339209925695, -82.59366185920352, -99.37454889130669, 239.44787356557632, 73.48303618019185, -34.70715150696383, -221.19597759676563, -228.46229631816368, -303.33713278268505, -27.614968081931117, 11.849057636120023, 312.3432210138707, 251.66990985713164, -196.17319335658183, -345.96452562362316, -146.61396553305693, -572.9562622421072, 94.30861021196714, -9.869710638548813, -68.33034046927271, -95.55117818600408], "policy_predator_policy_reward": [64.11498389553637, 220.4222246471242, 142.3654620061323, 389.9411654905929, 121.2187456447096, 200.2895063845537, 33.872886720790355, 39.96742081952736, 308.47581234997284, 109.91127942594916, 3.392531274470741, 17.48560778447622, 171.82503666642884, 328.02183450623835, 554.1939939347195, 494.5535611753816, 875.1888214558163, 123.55591954213331, 333.10153369408937, 644.6167070658336, 25.894795811121224, 95.01982617588062, 82.76761665760085, 19.99253550813706, 163.8899468985996, 157.8209083197824, 68.48387724158275, 127.14009211754703, 184.4941161506883, 74.8820210953619, 148.12727918180136, 13.647046581398744, 104.79588864420187, 144.4988537843425, 621.7198320819017, 446.32245238019607, 109.93652471095864, 202.67075014345764, 58.906629101015994, 128.77660648757768, 175.21666638675455, 186.89222370885577, 833.9200465959464, 91.06746950320813, 71.87040920535452, 110.0752771751077, 65.90550717546529, 354.16946047211616, 453.36848308501044, 225.23189053577408, 71.23153104947995, 117.44816830097511, 51.25190303425664, 55.04860731514405, 49.83975776812906, 53.76544075490323, 260.11985221195664, 124.66029303834928, 270.15943523709234, 158.25574439207293, 419.8052620404662, 203.5705939268966, 141.5000559597024, 89.60129799310498, 707.4342007204366, 432.6122109840484, 56.49935587187133, 362.62889159102104, 687.0756500175761, 70.6247239756625, 120.7002061822356, 0.0, 225.91559258496855, 402.2264575880564, 122.02507969847196, 147.07030432890178, 270.6741086294183, 141.2328618317027, 62.41590888922827, 28.00350462936147, 337.32744027962906, 230.24359598300688, 98.91593502914287, 140.35784348000402, 465.20740093199885, 47.9297612631772, 254.1966523420632, 37.66501669565543, 112.4847832226985, 235.3932509428131, 201.9419660579168, 308.47812482503207, 376.5849392679652, 277.6501019273896, 110.92035104196232, 303.98807680393367, 187.01201601643527, 170.69158057510973, 204.29073575984668, 368.84597919738184, 17.56935647142952, 363.09024647684595, 87.59819571086236, 184.13260891782187, 83.04487379757231, 115.93407371965029, 260.2110228090195, 375.0202075324274, 466.4042084140002, 515.5620725262738, 134.01455568095616, 365.1962190881171, 261.13439630628784, 360.25979192817186, 372.09126210107314, 433.68871369562345, 325.6424731187329, 586.7913676185497, 39.281449518087, 558.5929956354701, 38.8616073509282, 398.08874056370627, 56.87403724957999, 538.7777292986449, 517.8286800875176, 10.275798372139034, 214.31054282251225, 245.22850114615693, 18.92544113887099, 19.353850235620644, 97.47887709968889, 226.91455244612422, 282.6030311190166, 326.85171354154954, 50.90499215529764, 87.80123952234113, 47.946060116360435, 292.2037234277437, 110.01458439205054, 203.32287180404495, 267.8937661105934, 4.5337211377983815, 265.91003323607805, 70.9762595445127, 171.84469802791952, 131.1014226731368, 111.4966579466194, 103.32361896596935, 370.0208740331148, 145.2707629912781, 341.6116156329313, 274.6032547839049, 180.79405798648676, 185.41990641954823, 316.51798333408505, 82.59333081469286, 217.63055221485976, 100.21142412055592, 189.60552075824413, 253.7005238254085, 79.4464966849333, 130.93548562404808, 120.69922819797817, 452.04578658896594, 155.30374699391487, 54.4317329249461, 68.85329997599806, 126.7483874305376, 191.7675753904713, 303.2448245601224, 63.2287316122657, 359.89962213115564, 148.01398223720648, 166.28326061219124, 142.02420336359154, 67.58337909456199, 196.50964109754304, 88.2156941903986, 108.22400670944909, 93.15575841504506, 89.14884761982744, 89.9247264975149, 56.686518642083854, 3.6825716121480774, 108.4819390064887, 256.35439355448875, 211.7900394254684, 369.26984376242274, 98.2531910280097, 234.52383642133643, 45.362120573483864, 92.44243411052224, 278.5933783070519, 325.5341690869357, 266.2547791821504, 585.3435841169285, 203.27293506132696, 55.0821180915145, 2.3657708265760977, 216.0645327713877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.912720265278165, "mean_inference_ms": 4.550340185372252, "mean_action_processing_ms": 1.4925951236547172, "mean_env_wait_ms": 10.632310292105531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006006002426147461, "StateBufferConnector_ms": 0.01224815845489502, "ViewRequirementAgentConnector_ms": 0.1569654941558838}, "num_episodes": 13, "episode_return_max": 701.8176855550084, "episode_return_min": -90.91510457741423, "episode_return_mean": 192.90309203536228, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.7563629584901, "num_env_steps_trained_throughput_per_sec": 82.7563629584901, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 49296.474, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49296.414, "sample_time_ms": 2572.706, "learn_time_ms": 46703.038, "learn_throughput": 85.648, "synch_weights_time_ms": 16.21}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "35fb9_00000", "date": "2024-08-22_09-33-39", "timestamp": 1724299419, "time_this_iter_s": 48.40205502510071, "time_total_s": 5995.64017534256, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cbc820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5995.64017534256, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 39.37246376811595, "ram_util_percent": 82.83623188405798}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.838768147791505, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.4121768304279874, "policy_loss": -0.018711041082953295, "vf_loss": 3.428661135138658, "vf_explained_var": 0.5980250506804734, "kl": 0.011133653800762085, "entropy": 0.9638429328247353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.205216839893785, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.9209025485174998, "policy_loss": -0.026811517364710137, "vf_loss": 2.944804536980927, "vf_explained_var": 0.18404591644882526, "kl": 0.01454767724745488, "entropy": 0.5979956605762401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 701.8176855550084, "episode_reward_min": -49.92973053157165, "episode_reward_mean": 201.6764318059315, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -809.3646033359919, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.9448276621356, "predator_policy": 833.9200465959464}, "policy_reward_mean": {"prey_policy": -100.0398185707875, "predator_policy": 200.87803447375327}, "custom_metrics": {}, "hist_stats": {"episode_reward": [446.2714508058917, 159.19061804290212, 378.8409797473222, 63.41523356135211, 62.50000000000062, 380.10000000000167, 112.05077215254319, 52.61571302544898, 65.40000000000056, 134.13784349230633, 46.2534423312178, -7.888504471541049, 113.3551012058372, 51.176114912680994, 380.4507851522068, 69.24129079737695, 395.80000000000194, 72.70000000000014, 114.30175647526688, 546.7960967680259, 188.04272923191354, 135.111664238704, 200.40740180522909, 86.07888698860297, 112.41824598668163, 624.8396518143601, 202.29489382960932, 329.18830266700365, 84.92309824691657, 419.6000000000024, 247.60674891658903, 89.19294591335138, 204.4000000000002, 69.20000000000034, 168.85647192171683, 309.4157143322698, 521.837498707628, 63.40000000000063, 364.01568118594827, 86.60807066281411, 60.400000000000574, 101.85242240067191, 272.56584948773275, 226.13553900933158, 140.55933774414117, 78.86662025157369, 257.6999999999991, 73.91297797590575, 84.17826993995963, -49.92973053157165, 294.7838370860947, 139.3538370353959, 38.66205284227359, 80.79548431547327, 116.70000000000014, 66.30000000000051, 340.0044102539732, 74.95603685954654, 75.45796821991966, 203.57348909262384, 410.80000000000325, 282.75846325507564, 143.42821941605996, 370.90000000000146, 54.29279585301929, 317.523681591263, 74.51988033739258, 78.23111075099256, 55.386771731669, 51.037785098964214, 98.84736756209438, 263.60182712849326, 352.753992460448, 350.7000000000012, 386.5994333653813, 104.87246054728858, 85.28852079537788, 361.2000000000022, 474.4396784449684, 446.1163730252416, -2.8946366331641773, 373.29999999999916, 108.93320345724734, 49.260454087038525, 317.01111700353465, 701.8176855550084, 61.98982841378134, 132.02813552391294, 342.7939527262605, 54.548784942690496, 259.08179715911285, 324.4000000000005, 34.9455228414727, 208.7777542624375, 444.2934496094682, 143.42183284534974, 173.7235002938712, 364.14952446562614, 418.57874456359923, 73.20906568093235], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [391.9448276621356, -66.58799884325067, 16.43046587716639, 40.0000000000003, 189.02045023113698, -131.89032570220013, -33.883413900304376, -98.32532189747472, -156.6941161506897, -40.18202109536218, -112.62727918180303, 330.9529534186013, -9.616720787837266, -127.62724948816276, -742.2688622409067, -273.15770919573873, -77.23652471096047, -169.9707501434595, 32.69337089898422, -86.23876299526981, -138.52988465285523, -177.32556311154107, -809.3646033359919, -123.51141723470283, -6.667432938746426, -61.92315223587696, -243.78953690599744, -125.10931582890424, 72.576714373795, -370.72630284236925, -35.43153104947996, -84.00687750360025, -13.051903034256188, 302.55139268485595, -13.939757768128588, -16.96544075490271, -234.4931641134462, -35.985224661590486, -245.60022450250307, 363.98114164136035, -386.54356452257247, -48.78956221287277, 8.815929931339575, -104.80561964544108, -744.1435694058571, -195.49544049339997, 17.35391540192908, -350.40327587621204, -630.6614427251734, -14.620685281380531, 263.52856804633575, 240.61087758578844, -362.16478535921925, -63.682370984196965, -81.91510360631874, 142.00802224594602, -328.79099714587124, 1.8071249316704343, -26.815908889227764, 355.9964953706385, 23.821912059219276, -343.7861994052642, -20.159979560330385, -129.92085303546529, -346.67984498345885, 37.94268278828395, -222.49665234206478, -0.16501669565516472, -196.52702669673212, 17.505464452939833, -75.38825918227224, -125.616117368407, 289.29587430503665, -421.69341679276346, -75.12380575123669, -276.38462209465416, 136.93439446373534, -130.62230986933673, -403.41683677236887, -83.111807522041, -323.8015138584678, 3.541910910196687, -149.2697817452848, -20.6086004827297, -44.46099032108971, 118.04789229159967, -132.60806271232195, -276.4876286197939, -293.1686876507688, -548.2382555453569, -4.022586465375248, -416.32156805212213, -230.9343963062881, -132.75979192817152, -503.55941895576365, -228.30757886502022, -253.72131512211368, -574.5342556752067, -151.04840868773266, -496.7557669973964, -152.05241973825053, 9.885908909711112, 43.63781598402281, -499.93574549684956, -4.653150760575965, -484.78927485680407, -210.42857411520558, -168.3149855379935, 59.37455886112897, 19.046149764379354, -63.57887709969078, -194.51455244612606, -464.6705584927206, 195.22022408612958, 40.0000000000003, -103.75019481809377, 3.179675056525839, -267.8714903807041, -77.60722980763327, -32.15673729583802, -213.4937661105945, 351.86627886220174, -230.23204519914722, 176.1042156736313, -175.07578390021166, 15.557882615217073, 224.30334205338042, -68.22361896597134, -326.2176643508229, -134.78117682054562, -310.1671128444363, 11.475924018869819, -158.1167358734095, -133.57734819523637, -137.47441414943148, -183.40578924835674, -177.2341515922365, -85.22105301151352, -285.00214452420636, -107.26611496048453, -90.2848430348905, -21.24977171199631, -58.29711238826897, -250.84607527018056, 138.0294304731155, 4.989082068470468, 251.2467000240019, -96.14838743053926, 19.30338105291193, -127.71634763812818, 22.676533366314246, -340.93242656244126, -189.16821266032582, -39.84050939369499, 183.77579663640853, -32.18337909456164, -176.96240343341773, 366.6767465904391, 378.4, -133.66339209925695, -82.59366185920352, -99.37454889130669, 239.44787356557632, 73.48303618019185, -34.70715150696383, -221.19597759676563, -228.46229631816368, -303.33713278268505, -27.614968081931117, 11.849057636120023, 312.3432210138707, 251.66990985713164, -196.17319335658183, -345.96452562362316, -146.61396553305693, -572.9562622421072, 94.30861021196714, -9.869710638548813, -68.33034046927271, -95.55117818600408, 141.01972100515383, -154.468831509303, -70.9476743735496, 96.30032363440523, -185.51770289183895, -105.13501569464145, -228.68441291490757, -44.96813746042332, -100.08347221671534, 386.56942339505207, -500.89270043506883, -70.56270231999592, -532.4402109628168, 10.126608490317201, 175.91152288138306, -564.7935923964587, -23.848544553982016, 366.6296155375891, -194.31926552765006, -29.959846562343706], "policy_predator_policy_reward": [25.894795811121224, 95.01982617588062, 82.76761665760085, 19.99253550813706, 163.8899468985996, 157.8209083197824, 68.48387724158275, 127.14009211754703, 184.4941161506883, 74.8820210953619, 148.12727918180136, 13.647046581398744, 104.79588864420187, 144.4988537843425, 621.7198320819017, 446.32245238019607, 109.93652471095864, 202.67075014345764, 58.906629101015994, 128.77660648757768, 175.21666638675455, 186.89222370885577, 833.9200465959464, 91.06746950320813, 71.87040920535452, 110.0752771751077, 65.90550717546529, 354.16946047211616, 453.36848308501044, 225.23189053577408, 71.23153104947995, 117.44816830097511, 51.25190303425664, 55.04860731514405, 49.83975776812906, 53.76544075490323, 260.11985221195664, 124.66029303834928, 270.15943523709234, 158.25574439207293, 419.8052620404662, 203.5705939268966, 141.5000559597024, 89.60129799310498, 707.4342007204366, 432.6122109840484, 56.49935587187133, 362.62889159102104, 687.0756500175761, 70.6247239756625, 120.7002061822356, 0.0, 225.91559258496855, 402.2264575880564, 122.02507969847196, 147.07030432890178, 270.6741086294183, 141.2328618317027, 62.41590888922827, 28.00350462936147, 337.32744027962906, 230.24359598300688, 98.91593502914287, 140.35784348000402, 465.20740093199885, 47.9297612631772, 254.1966523420632, 37.66501669565543, 112.4847832226985, 235.3932509428131, 201.9419660579168, 308.47812482503207, 376.5849392679652, 277.6501019273896, 110.92035104196232, 303.98807680393367, 187.01201601643527, 170.69158057510973, 204.29073575984668, 368.84597919738184, 17.56935647142952, 363.09024647684595, 87.59819571086236, 184.13260891782187, 83.04487379757231, 115.93407371965029, 260.2110228090195, 375.0202075324274, 466.4042084140002, 515.5620725262738, 134.01455568095616, 365.1962190881171, 261.13439630628784, 360.25979192817186, 372.09126210107314, 433.68871369562345, 325.6424731187329, 586.7913676185497, 39.281449518087, 558.5929956354701, 38.8616073509282, 398.08874056370627, 56.87403724957999, 538.7777292986449, 517.8286800875176, 10.275798372139034, 214.31054282251225, 245.22850114615693, 18.92544113887099, 19.353850235620644, 97.47887709968889, 226.91455244612422, 282.6030311190166, 326.85171354154954, 50.90499215529764, 87.80123952234113, 47.946060116360435, 292.2037234277437, 110.01458439205054, 203.32287180404495, 267.8937661105934, 4.5337211377983815, 265.91003323607805, 70.9762595445127, 171.84469802791952, 131.1014226731368, 111.4966579466194, 103.32361896596935, 370.0208740331148, 145.2707629912781, 341.6116156329313, 274.6032547839049, 180.79405798648676, 185.41990641954823, 316.51798333408505, 82.59333081469286, 217.63055221485976, 100.21142412055592, 189.60552075824413, 253.7005238254085, 79.4464966849333, 130.93548562404808, 120.69922819797817, 452.04578658896594, 155.30374699391487, 54.4317329249461, 68.85329997599806, 126.7483874305376, 191.7675753904713, 303.2448245601224, 63.2287316122657, 359.89962213115564, 148.01398223720648, 166.28326061219124, 142.02420336359154, 67.58337909456199, 196.50964109754304, 88.2156941903986, 108.22400670944909, 93.15575841504506, 89.14884761982744, 89.9247264975149, 56.686518642083854, 3.6825716121480774, 108.4819390064887, 256.35439355448875, 211.7900394254684, 369.26984376242274, 98.2531910280097, 234.52383642133643, 45.362120573483864, 92.44243411052224, 278.5933783070519, 325.5341690869357, 266.2547791821504, 585.3435841169285, 203.27293506132696, 55.0821180915145, 2.3657708265760977, 216.0645327713877, 91.59865623926783, 180.93225142399228, 105.74767437354791, 193.29967636559473, 213.57973236554417, 112.01850906240534, 221.0761652191182, 261.35413941864965, 76.35850306221612, 81.44899536891057, 516.5540796846196, 198.32315591580107, 520.1386666391306, 175.89843612724627, 380.5347764512205, 372.496817529483, 61.848544553982556, 13.949129026007453, 224.63307246020818, 72.85510531071641]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.908851314715242, "mean_inference_ms": 4.53586346189933, "mean_action_processing_ms": 1.495823470506138, "mean_env_wait_ms": 10.620282763767593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006043076515197754, "StateBufferConnector_ms": 0.01749706268310547, "ViewRequirementAgentConnector_ms": 0.12426185607910156}, "num_episodes": 10, "episode_return_max": 701.8176855550084, "episode_return_min": -49.92973053157165, "episode_return_mean": 201.6764318059315, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.20278963777822, "num_env_steps_trained_throughput_per_sec": 82.20278963777822, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 49148.887, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49148.817, "sample_time_ms": 2490.46, "learn_time_ms": 46637.719, "learn_throughput": 85.767, "synch_weights_time_ms": 16.0}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "35fb9_00000", "date": "2024-08-22_09-34-28", "timestamp": 1724299468, "time_this_iter_s": 48.7075469493866, "time_total_s": 6044.347722291946, "pid": 68690, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32b630e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6044.347722291946, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 40.550000000000004, "ram_util_percent": 82.79411764705881}}
